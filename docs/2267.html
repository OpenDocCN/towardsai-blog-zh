<html>
<head>
<title>3 Different Approaches for Train/Test Splitting of a Pandas Dataframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据帧训练/测试分割的3种不同方法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/3-different-approaches-for-train-test-splitting-of-a-pandas-dataframe-d5e544a5316?source=collection_archive---------0-----------------------#2021-10-21">https://pub.towardsai.net/3-different-approaches-for-train-test-splitting-of-a-pandas-dataframe-d5e544a5316?source=collection_archive---------0-----------------------#2021-10-21</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="4dee" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="0136" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">关于如何通过scikit-learn、pandas或NumPy内置函数将数据集分割成训练集和测试集的简短教程</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/25c505caafa13747d7d0b6c6e986b5fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwf6OQLk18Rt02EWOoupBQ.jpeg"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</figcaption></figure><p id="9d2c" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated"><strong class="lm jg">通常，训练/测试拆分过程是理所当然的机器学习任务之一</strong>。事实上，数据科学家更关注数据预处理或功能工程，将数据集划分为一行代码的过程委托给其他人。</p><p id="632d" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">在这篇短文中，我描述了三种训练/测试分割技术，利用了三个不同的Python库:</p><ul class=""><li id="d8f1" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated">sci kit-学习</li><li id="9f2d" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated">熊猫</li><li id="2db5" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated">NumPy</li></ul><p id="c741" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">在本教程中，我假设整个数据集以CSV文件的形式提供，该文件以Pandas数据帧的形式加载。我考虑一下<code class="fe mu mv mw mx b">heart.csv</code>数据集，它有303行和14列:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="a6cf" class="nc nd iw mx b gz ne nf l ng nh">import pandas as pd</span><span id="ce79" class="nc nd iw mx b gz ni nf l ng nh">df = pd.read_csv('source/heart.csv')</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj nj"><img src="../Images/c36bf2e80e349433c4a3c938fcaadf81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNGookD8GyElqpb9vw1BZg.png"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</figcaption></figure><p id="4f06" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated"><em class="nk">输出</em>列对应目标列，所有剩余列对应输入特征:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="21ba" class="nc nd iw mx b gz ne nf l ng nh">Y_col = 'output'<br/>X_cols = df.<strong class="mx jg">loc</strong>[:, df.columns != Y_col].columns</span></pre><h1 id="0f69" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">1 sci kit-学习</h1><p id="0a1f" class="pw-post-body-paragraph lk ll iw lm b ln oc kg lp lq od kj ls lt oe lv lw lx of lz ma mb og md me mf ip bi translated">Scikit-learn提供了一个名为<code class="fe mu mv mw mx b">train_test_split()</code>的函数，该函数自动将数据集分割成训练集和测试集。作为函数的输入参数，可以传递列表或数据帧。</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="f1cd" class="nc nd iw mx b gz ne nf l ng nh">from sklearn.model_selection import train_test_split</span><span id="246d" class="nc nd iw mx b gz ni nf l ng nh">X_train, X_test, y_train, y_test = <strong class="mx jg">train_test_split</strong>(df[X_cols], df[Y_col],test_size=0.2, random_state=42)</span></pre><p id="4b03" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">其他输入参数包括:</p><ul class=""><li id="cb88" class="mg mh iw lm b ln lo lq lr lt mi lx mj mb mk mf ml mm mn mo bi translated"><code class="fe mu mv mw mx b">test_size</code>:测试数据集中包含的数据集的比例。</li><li id="e7f2" class="mg mh iw lm b ln mp lq mq lt mr lx ms mb mt mf ml mm mn mo bi translated"><code class="fe mu mv mw mx b">random_state</code>:要传递给随机操作的种子号，从而使实验可重复。</li></ul><p id="da1f" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">原始数据集包含303条记录，带有<code class="fe mu mv mw mx b">test_size=0.20</code>的<code class="fe mu mv mw mx b">train_test_split()</code>函数将242条记录分配给训练集，61条分配给测试集。</p><h1 id="91ae" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">两只熊猫</h1><p id="e3f4" class="pw-post-body-paragraph lk ll iw lm b ln oc kg lp lq od kj ls lt oe lv lw lx of lz ma mb og md me mf ip bi translated">Pandas提供了一个名为<code class="fe mu mv mw mx b">sample()</code>的Dataframe函数，可以用来将一个数据帧分割成训练集和测试集。该函数接收<code class="fe mu mv mw mx b">frac</code>参数作为输入，该参数对应于包含在结果中的数据集的比例。与scikit-learn <code class="fe mu mv mw mx b">train_test_split()</code>类似，<code class="fe mu mv mw mx b">sample()</code>功能也提供了<code class="fe mu mv mw mx b">random_state</code>输入参数。</p><p id="2f82" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated"><code class="fe mu mv mw mx b">sample()</code>该函数可用于提取训练集:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="a8dd" class="nc nd iw mx b gz ne nf l ng nh">df_train = df.<strong class="mx jg">sample</strong>(frac=0.8, random_state=1)</span></pre><p id="8b92" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">虽然可以通过从原始数据集中删除训练集来提取测试集:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="b3e5" class="nc nd iw mx b gz ne nf l ng nh">df_test=df.<strong class="mx jg">drop</strong>(df_train.index)</span></pre><p id="0c1c" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">可以通过从训练集和测试集中选择相关列来提取X和Y变量:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="c700" class="nc nd iw mx b gz ne nf l ng nh">X_train = df_train[X_cols]<br/>X_test = df_test[X_cols]</span><span id="6894" class="nc nd iw mx b gz ni nf l ng nh">y_train = df_train[Y_col]<br/>y_test = df_test[Y_col]3 <!-- -->np.random.rand()</span></pre><p id="2c27" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">与<code class="fe mu mv mw mx b">train_test_split()</code>函数类似，带有<code class="fe mu mv mw mx b">frac=0.8</code>的sample()函数将242条记录分配给训练集，将61条记录分配给测试集。显然，<code class="fe mu mv mw mx b">sample()</code>产生的数据集中包含的记录与<code class="fe mu mv mw mx b">train_test_split()</code>产生的不同。</p><h1 id="ceb2" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">3元</h1><p id="119a" class="pw-post-body-paragraph lk ll iw lm b ln oc kg lp lq od kj ls lt oe lv lw lx of lz ma mb og md me mf ip bi translated">在Numpy包中，我们可以利用<code class="fe mu mv mw mx b">rand()</code>函数来生成0到1之间的随机元素列表。更准确地说，我们可以生成一个与数据帧长度相同的列表。然后，我们可以创建一个值为&lt; 0.8的掩码，然后使用该掩码构建训练集和测试集:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="bde3" class="nc nd iw mx b gz ne nf l ng nh">import numpy as np</span><span id="eefe" class="nc nd iw mx b gz ni nf l ng nh">mask = np.random.rand(len(df)) &lt; 0.8</span><span id="6b87" class="nc nd iw mx b gz ni nf l ng nh">df_train = df[mask]<br/>df_test = df[~mask]</span></pre><p id="5398" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">与<code class="fe mu mv mw mx b">train_test_split()</code>和<code class="fe mu mv mw mx b">sample()</code>不同，这种策略不会为训练集和测试集生成固定数量的样本。在这个具体的例子中，训练集中的样本数是256(而其他策略是242)，测试集中的样本数是47。</p><h1 id="3671" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">摘要</h1><p id="69d9" class="pw-post-body-paragraph lk ll iw lm b ln oc kg lp lq od kj ls lt oe lv lw lx of lz ma mb og md me mf ip bi translated">在这篇短文中，我展示了三种策略来将作为Pandas数据帧提供的数据集分割成训练集和测试集。</p><p id="e33c" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated"><strong class="lm jg">最佳解决方案？</strong>看你最熟悉哪个库了。</p><blockquote class="oh"><p id="7728" class="oi oj iw bd ok ol om on oo op oq mf dk translated">你呢？你知道执行训练/测试分割的其他库或技术吗？如果是这样，给我留言吧！</p></blockquote><p id="b6a1" class="pw-post-body-paragraph lk ll iw lm b ln or kg lp lq os kj ls lt ot lv lw lx ou lz ma mb ov md me mf ip bi translated">如果你已经走了这么远来阅读，对我来说今天已经很多了。谢谢！你可以在<a class="ae ow" href="https://alod83.medium.com/which-topics-would-you-like-to-read-c68314dc6813" rel="noopener">这篇文章</a>里读到更多关于我的内容。</p><h1 id="d549" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">你愿意支持我的研究吗？</h1><p id="d412" class="pw-post-body-paragraph lk ll iw lm b ln oc kg lp lq od kj ls lt oe lv lw lx of lz ma mb og md me mf ip bi translated">你可以每月订阅几美元，并解锁无限的文章。</p><h1 id="89c8" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">额外奖金</h1><p id="c4ed" class="pw-post-body-paragraph lk ll iw lm b ln oc kg lp lq od kj ls lt oe lv lw lx of lz ma mb og md me mf ip bi translated">在所有情况下，生成的数据集仍然是熊猫数据帧。因此，您可以将它们导出为CSV文件，只需利用熊猫提供的<code class="fe mu mv mw mx b">to_csv()</code>功能:</p><pre class="kv kw kx ky gu my mx mz na aw nb bi"><span id="62fe" class="nc nd iw mx b gz ne nf l ng nh">X_train.to_csv('output/X_train.csv')<br/>X_test.to_csv('output/X_test.csv')<br/>y_train.to_csv('output/y_train.csv')<br/>y_test.to_csv('output/y_test.csv')</span></pre><p id="0372" class="pw-post-body-paragraph lk ll iw lm b ln lo kg lp lq lr kj ls lt lu lv lw lx ly lz ma mb mc md me mf ip bi translated">本文中使用的所有代码都可以在我的<a class="ae ow" href="https://github.com/alod83/data-science/blob/master/DataAnalysis/TrainTest%20Split.ipynb" rel="noopener ugc nofollow" target="_blank"> Github资源库</a>中找到。</p><h1 id="e2cd" class="nl nd iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">相关文章</h1><div class="ox oy gq gs oz pa"><a href="https://towardsdatascience.com/a-complete-data-analysis-workflow-in-python-pycaret-9a13c0fa51d4" rel="noopener follow" target="_blank"><div class="pb ab fp"><div class="pc ab pd cl cj pe"><h2 class="bd jg gz z fq pf fs ft pg fv fx jf bi translated">Python PyCaret中的完整数据分析工作流</h2><div class="ph l"><h3 class="bd b gz z fq pf fs ft pg fv fx dk translated">这是一个现成的教程，利用了我用过的最好的机器学习库。</h3></div><div class="pi l"><p class="bd b dl z fq pf fs ft pg fv fx dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po le pa"/></div></div></a></div><div class="ox oy gq gs oz pa"><a href="https://towardsdatascience.com/how-to-check-if-a-classification-model-is-overfitted-using-scikit-learn-148b6b19af8b" rel="noopener follow" target="_blank"><div class="pb ab fp"><div class="pc ab pd cl cj pe"><h2 class="bd jg gz z fq pf fs ft pg fv fx jf bi translated">如何使用scikit-learn检查分类模型是否过度拟合</h2><div class="pi l"><p class="bd b dl z fq pf fs ft pg fv fx dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po le pa"/></div></div></a></div><div class="ox oy gq gs oz pa"><a href="https://towardsdatascience.com/how-to-deal-with-imbalanced-multiclass-datasets-in-python-fe0bb3f2b669" rel="noopener follow" target="_blank"><div class="pb ab fp"><div class="pc ab pd cl cj pe"><h2 class="bd jg gz z fq pf fs ft pg fv fx jf bi translated">如何在Python中处理不平衡的多类数据集</h2><div class="pi l"><p class="bd b dl z fq pf fs ft pg fv fx dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pq l pl pm pn pj po le pa"/></div></div></a></div></div></div>    
</body>
</html>