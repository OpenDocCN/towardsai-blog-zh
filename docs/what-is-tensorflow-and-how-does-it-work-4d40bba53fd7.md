# 什么是张量流，它是如何工作的？

> 原文：<https://pub.towardsai.net/what-is-tensorflow-and-how-does-it-work-4d40bba53fd7?source=collection_archive---------1----------------------->

## [深度学习](https://towardsai.net/p/category/machine-learning/deep-learning)

# **什么是张量流？**

![](img/f4a70cd9f47d53fc92af01a2a7857aaf.png)

TensorFlow 是一个开源的端到端框架，用于构建机器学习应用。这是一个符号数学工具包，执行各种任务，包括使用数据流和微分编程进行深度神经网络训练和推理。它使程序员能够利用各种工具、框架和社区资源来构建机器学习应用程序。

谷歌的 TensorFlow 现在是这个星球上最知名的深度学习包。谷歌在其所有产品中使用机器学习来增强搜索、翻译、图片说明和推荐。

例如，谷歌用户可能会受益于更快、更精确的人工智能辅助搜索。当用户在谷歌的搜索栏中输入一个关键词时，搜索引擎会对下一个词给出建议。

![](img/d29336b89c2b4300dcaeb1e6847e61a9.png)

谷歌旨在利用机器学习来充分利用其庞大的数据集，以便为消费者提供尽可能好的体验。机器学习被三个不同的组织使用。研究人员、程序员和数据科学家。

他们可以通过使用同一个工具箱进行合作并提高效率。

张量流是按比例发展的，因为谷歌拥有的不仅仅是数据；他们还拥有世界上最强大的计算机。TensorFlow 是由谷歌大脑团队创建的机器学习和深度神经网络研究库。

它被设计为在多个 CPU 或 GPU 上工作，在某些情况下也可以在移动操作系统上工作，它包括 Python、C++和 Java 中的包装器。

# 张量流的历史

当给定大量数据时，深度学习在几年前开始超越所有其他机器学习算法。谷歌意识到，深度神经网络可能会帮助它改善服务。

他们创建了 Tensorflow 框架，允许学者和开发人员在人工智能模型上进行合作。在创建和扩展之后，它可以被大量的个人使用。

它最初于 2015 年底发布，第一个稳定版本于 2017 年发布。由于 Apache 开源许可，它是免费和开源的。无需向 Google 支付任何费用，您就可以使用、修改和有偿重新发布更新版本。

# 它是如何工作的？

通过接受称为张量的多维数组的输入，TensorFlow 允许您创建数据流图和结构，以指定数据如何在图中传输。它可以让你创建一个流程图，可以对这些输入进行操作，这些输入从一个方向传到另一个方向。

# 张量流结构

数据预处理，建立模型，最后训练和估计模型是张量流结构的三个要素。

Tensorflow 得名于它以多维数组的形式接受输入，通常称为 tensors。您可以创建一个流程图，显示您希望在该输入上运行的操作。输入从一端进入，通过这个由各种过程组成的系统，在另一端作为输出出现。

张量进去，经过一组运算，然后从另一边出来，这就是为什么叫张量流。

# 运行 Tensorflow 需要什么？

TensorFlow 硬件和软件要求可分为三类。

该模式(人工智能的类型)在开发阶段被训练。大多数培训都是在电脑或笔记本电脑上进行的。

训练阶段结束后，Tensorflow 可用于各种平台。它可以在 Windows、macOS 或 Linux 桌面上使用，可以作为 web 服务在云中使用，也可以在 iOS 和 Android 等移动平台上使用。

你可以在几台计算机上训练它，然后在训练完成后在一台单独的机器上运行它。

GPU 和 CPU 都可以用来训练和运行模型。GPU 是为视频游戏设计的。斯坦福大学的研究人员在 2010 年末发现，GPU 在矩阵运算和代数方面也非常强大，这使得它们在处理这类任务时速度非常快。深度学习中大量使用矩阵乘法。因为 TensorFlow 是用 C++开发的，所以在执行矩阵乘法时速度极快。TensorFlow 虽然是用 C++编写的，但可以用各种语言访问和控制，最著名的是 Python。

最后，TensorBoard 是 TensorFlow 的重要元素。张量流可以用张量板以图形和视觉方式监控。

# 什么是 Tensorflow 组件？

## **张量**

Tensorflow 因其底层框架 Tensor 而得名。张量在张量流的每一次计算中都要用到。张量是一个 n 维向量或矩阵，可以表示任何形式的数据。张量的值都具有相同的数据类型和已知(或部分已知)的形式。矩阵或数组的维数决定了数据的形式。

张量可能来自输入数据，也可能来自计算的输出。TensorFlow 中的所有操作都是在一个图形内进行的。该图是一系列按顺序发生的计算。每个操作被称为一个 op 节点，它们都被链接在一起。

该图描述了节点之间存在的操作和关系。但是，它不显示值。张量，或为运算提供数据的手段，是节点的边。

## 图表

TensorFlow 使用了一个图形框架。该图表收集并总结了所有训练的系列计算。该图提供了许多好处:

1.  它被设计成可以在许多 CPU 或 GPU 上工作，也可以在移动设备上工作。
2.  图形的可移植性使得计算结果可以保存下来，以备不时之需。该图表可以保存并在以后运行。
3.  图形的计算都是通过将张量连接在一起完成的。
4.  张量中有一个节点和一条边。节点执行数学处理，从而产生端点输出。节点输入/输出连接由边来解释。

# 为什么那么多人喜欢 Tensorflow？

TensorFlow 是其中最好的库，因为它的设计是用户友好的。Tensorflow 库包括各种用于创建大规模深度学习架构的 API，如 CNN 和 RNNs。TensorFlow 是一种基于图形的编程语言，允许开发人员使用 Tensorboad 查看神经网络的创建。这个软件调试工具真的很有用。最后，Tensorflow 旨在用于大规模部署。它同时运行在 CPU 和 GPU 上。

与其他深度学习框架相比，Tensorflow 在 GitHub 上也最受欢迎。

# Tensorflow 中可以使用的不同算法

以下是支持的算法:

1.  线性回归:tf.estimator.LinearRegressor
2.  分类:TF . estimator . line classifier
3.  深度学习分类:tf.estimator.DNNClassifier
4.  深度学习擦除和深度:TF . estimator . dnnlinearcombinedclassifier
5.  Booster 树回归:TF . estimator . boosted trees regressor
6.  提升树分类:TF . estimator . boosted trees classifier

# 张量流示例

```
import tensorflow as tf
import numpy as np
```

Tensorflow 在前两行代码中作为 tf 导入。Python 中的标准做法是给库取一个短名称。好处是我们不必每次需要使用时都键入库的全名。例如，当我们希望使用 TensorFlow 函数时，我们可以将 TensorFlow 作为 tf 导入并使用 tf。

下面用一些简单的 Tensorflow 例子来练习 TensorFlow 的基本流程。让我们建立一个将两个整数相乘的计算网络。

在这种情况下，我们将 v1 和 v2 相乘。为了链接操作，Tensorflow 将构建一个节点。我们称之为乘法。Tensorflow 计算引擎会在图建立后将 V_1 和 V_2 相乘。

最后，我们将启动一个 TensorFlow 会话，使用 V_1 和 V_2 值运行计算图形，并打印乘法结果。

让我们从定义 V_1 和 V_2 输入节点开始。当我们在 Tensorflow 中构造一个节点时，首先要决定我们要做什么类型的节点。节点 V1 和 V2 将作为占位符。每次我们执行计算时，占位符都会分配一个新值。作为一个 TF 点占位符节点，我们将使它们。

## 步骤 1:建立变量

```
V_1 = tf.placeholder(tf.float32, name='V_1')
V_2 = tf.placeholder(tf.float32, name='V_2')
```

当我们构造一个占位符节点时，我们必须提供数据类型。我们将把数字放在这里，所以我们将选择 tf.float32 作为我们的数据类型。我们还需要命名这个节点。当我们检查模型的图形表示时，这个名称将会出现。让我们给这个节点命名为 V_1，为它提供一个带有值 V_1 的名称参数，然后让我们对 V_2 做同样的事情。

## 步骤 2:定义计算

```
multiply = tf.multiply(V_1, V_2, name='x_multiply')
```

现在我们可以指定执行乘法的节点。我们可以在 Tensorflow 中通过添加一个 tf.multiply 节点来实现这一点。

v1 和 v2 节点将被发送到乘法节点。它指示 TensorFlow 连接计算图中的这些节点，因此我们要求它将 x 和 y 的值相乘。也将乘法节点命名为 x_multiply。这是我们基本的计算图的全部定义。

## 步骤 3:执行操作

为了在图中执行操作，我们必须首先构造一个会话。由 tf 处理。Tensorflow 中的会话()。现在我们有了一个会话，通过调用这个会话，我们可以让它在我们的计算图上进行操作。我们必须使用 run 命令来完成计算。

当加法操作完成时，它会注意到它必须获取 V_1 和 V_2 节点的值，因此我们必须额外输入 V_1 和 V_2 的值。我们可以通过将 feed dict 作为参数传递来实现这一点。我们给 V _ 1 取值 1，2，3，给 V_2 取值 4，5，6。

对于 1x4、2x5 和 3x6，我们应该看到 4、10 和 18。

```
## Input:V_1 = tf.placeholder(tf.float32, name = "V_1")
V_2 = tf.placeholder(tf.float32, name = "V_2")

multiply = tf.multiply(V_1, V_2, name = "x_multiply")

with tf.Session() as session:
    vr = session.run(multiply, feed_dict={V_1:[1,2,3], V_2:[4,5,6]})
    print(vr)## Output:[ 4\. 10\. 18.]
```

# 如何将数据加载到 Tensorflow

加载数据是训练机器学习算法的初始阶段。有两种典型的数据加载方法:

1.  将数据加载到内存中:这是最简单的技术。所有数据都作为一个数组加载到内存中。你能够编写 Python 代码。此代码与 Tensorflow 无关。
2.  基于张量流的数据管道。Tensorflow 有一个 API，可以简化数据导入、操作和机器学习算法。这种方法在处理大数据集时非常有用。例如，众所周知，图像记录非常大，很难存储在内存中。存储器由数据流水线自行管理。

那么，你应该用什么呢？

**将数据加载到内存:**

如果数据集不是很大，比如小于 10gb，可以使用第一种方法。信息可以存储在存储器中。要导入 CSV 文件，您可以使用 Pandas，这是一个著名的库。

**用 Tensorflow 管道加载数据:**

如果您有一个巨大的数据集，第二种技术是最好的。例如，如果您有一个 50 千兆字节的数据集，而您的计算机只有 16 千兆字节的内存，计算机将会崩溃。

在这种情况下，您需要创建一个 Tensorflow 管道。数据将通过管道成批或小块加载。每一批都将被添加到管道中，并可用于培训。构建管道是一个非常好的选择，因为它支持并行处理。Tensorflow 将使用几个 CPU 来训练模型。它促进了计算，并允许开发强大的神经网络。

总之，如果你有一个很小的数据集，你可以使用 Pandas 库把它加载到内存中。

如果您有一个巨大的数据集，并希望利用许多 CPU，Tensorflow 管道将更方便使用。

# 结论

TensorFlow 定义:近年来，TensorFlow 已经成为最知名的深度学习库。任何深度学习结构，如 CNN、RNN 或基本人工神经网络，都可以使用 TensorFlow 来构建。

学术机构、创业公司和大公司是 TensorFlow 最常见的用户。TensorFlow 几乎用于所有谷歌产品，包括 Gmail、照片和谷歌搜索引擎。

TensorFlow 是由谷歌大脑团队创建的，旨在弥合研究人员和产品开发人员之间的差距。TensorFlow 于 2015 年向公众发布，并迅速受到欢迎。TensorFlow 是目前拥有最多 GitHub 知识库的深度学习库。