<html>
<head>
<title>Text Classification using Transformers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用变压器的文本分类</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/text-classification-using-transformers-a2c6b3395ce3?source=collection_archive---------3-----------------------#2021-03-12">https://pub.towardsai.net/text-classification-using-transformers-a2c6b3395ce3?source=collection_archive---------3-----------------------#2021-03-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1dcd" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><div class=""><h2 id="c0c4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从头开始构建一个变压器</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c888d6af245253ccfce9df8c3558fc34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*00aVgzclEUin-CvutXLPOA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">来源:<a class="ae lh" href="https://pixabay.com/vectors/pixel-cells-techbot-teach-o-bot-3947912/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><h1 id="8b0c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">1.PyTorch中的变压器网络编码</h1><p id="d10b" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这一部分，我们将通过PyTorch中的一些代码来尝试理解多头自关注变压器网络的<strong class="mc jd">编码器-解码器</strong>架构。不会涉及任何理论(更好的理论版本可以在这里找到),只是网络的框架，以及如何用PyTorch自己编写这个网络。</p><p id="caf0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">构成变压器模型的架构分为两部分——编码器<strong class="mc jd"> <em class="nb">部分和解码器<strong class="mc jd"><em class="nb"/></strong>部分。几个其他的东西结合起来形成编码器和解码器部分。让我们从编码器开始。</em></strong></p><h2 id="df9f" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">编码器</h2><p id="4615" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><em class="nb">与解码器部分相比，编码器部分非常简单。编码器包含</em> <code class="fe nn no np nq b"><em class="nb">N</em></code> <em class="nb">编码器，每个编码器包含</em> <code class="fe nn no np nq b"><em class="nb">M</em></code> <em class="nb">自聚焦头。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nr"><img src="../Images/02619a3a40f5ded7210f1918ca2757f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ojVsAxXHcxG80GBpvIdSNA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="0975" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">让我们把</em>的每一部分都编码出来<code class="fe nn no np nq b"><em class="nb">Encoder</em></code></p><ul class=""><li id="2398" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">编码器模块</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/9ead971ca9cbdf1f152ed15eab51a396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AHbKzB0POc3FcQZKKqPTNg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="595a" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">位置编码</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/1c20be131fe5ef7bfe28b7999fb425f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3fmfzDxBZ6Tb2Zp8mk5Cw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="d1e4" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">编码器层</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/7546e94c0256986443c7f08744ca20f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H27WAPsHo1-2x7p21y8dCA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="e5bc" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">多头自关注与缩放点积</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/71b2bf502e2261df657232a5c71feafc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luV3bhXhhnlC1lpkC_SlDw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="37e6" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">位置前馈层</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/972cc8171bda38bc29f67321a3fee954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V51rNUg-Ij5x-ENXqMk2Sg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="127e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果你看到代码片段你会明白<strong class="mc jd">编码器</strong>模块是由<em class="nb">位置编码</em>和<em class="nb">编码器层</em>组成的；编码器层有一个利用<em class="nb">缩放点积</em>的<em class="nb">多头自关注</em>模块，编码器层还有一个<strong class="mc jd">位置式前馈层</strong>。下面给出的图表显示了成批的文本如何转换为记号，然后转换为张量，并流经网络的<strong class="mc jd">编码器</strong>部分，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/f982b0a19e9bbf348d61831a2ac7e691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNZaQ1KaVDHw57Kyakvaxg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h2 id="4ef2" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">解码器</h2><p id="57e6" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">对于分类任务，解码器输入为:</p><ol class=""><li id="df3b" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv of ny nz oa bi translated">编码器的输出(编码器输出)</li><li id="f25a" class="ns nt it mc b md og mg oh mj oi mn oj mr ok mv of ny nz oa bi translated"><code class="fe nn no np nq b">CLS</code>索引令牌</li></ol><p id="a338" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果是一个<strong class="mc jd">序列2序列</strong>任务，它将获取<em class="nb">编码器输出</em>，并且<code class="fe nn no np nq b">CLS</code>索引令牌将被<em class="nb">目标序列</em>替换</p><p id="16d4" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">与<em class="nb">编码器不同，</em>在输入标记中计算关注度；在<strong class="mc jd">解码器中，</strong>在目标序列中计算关注度，也与编码器输出一起计算</p><p id="3a96" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">解码器</strong>包含<code class="fe nn no np nq b">N</code> <em class="nb">解码器</em>和<code class="fe nn no np nq b">2 x M</code>自关注头。第一组<code class="fe nn no np nq b">M</code>自关注头用于计算解码器关注度，即目标序列之间的关注度，第二组<code class="fe nn no np nq b">M</code>自关注头用于计算编码器输出的关注度，即目标序列关注度和编码器输出的输出。</p><p id="6f80" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">与<em class="nb">编码器</em>类似，<strong class="mc jd">解码器</strong>也有<em class="nb">嵌入层和位置编码层。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/64525d52b47f8a1e6e78d464790a4092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QmJGVxQh3CDJS_eczFw2-g.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="f672" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">让我们对</em>的每一部分进行编码<code class="fe nn no np nq b"><em class="nb">Decoder</em></code></p><p id="f362" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">位置编码</em><strong class="mc jd"><em class="nb"/></strong><em class="nb"/><strong class="mc jd"><em class="nb">多头注意</em> </strong> <em class="nb">使用</em> <strong class="mc jd"> <em class="nb">缩放点积</em></strong><strong class="mc jd"><em class="nb">位置明智前馈层</em> </strong> <em class="nb">保持不变为</em> <strong class="mc jd"> <em class="nb">解码器</em> </strong> <em class="nb"/>代替<strong class="mc jd">编码器内的<em class="nb">编码器</em>，</strong>解码器有一个<em class="nb">解码器</em>，它有一个<strong class="mc jd"> 2 </strong> x <code class="fe nn no np nq b"><strong class="mc jd">M</strong></code>自关注头，采用<em class="nb">比例点积</em>计算关注度、<em class="nb">位置编码</em>和<em class="nb">位置前馈层。</em></p><ul class=""><li id="655f" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">解码器</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/8fa4ed368233736ba5d88e96d88e1d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ctDocl3E6FoK5pK4YeWa-Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="682d" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">解码层</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/39bf6983b7a3b0059599922e4b8359a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77mJlJqsGCt3YfTXnBNofg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="a7e5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">与编码器中的数据流一样，下图表示了解码器中批量张量的流以及编码器的输出是如何合并的。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/5201ec455e5daf293dc2ffff823be386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jVRv6C_PltPHzEZKFmaTsQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="eeac" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">与<em class="nb">编码器</em>不同，<strong class="mc jd">解码器</strong>有三个不同的输出，</p><ol class=""><li id="86fa" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv of ny nz oa bi translated"><em class="nb">解码器输出</em></li><li id="9597" class="ns nt it mc b md og mg oh mj oi mn oj mr ok mv of ny nz oa bi translated"><em class="nb">解码器关注度</em>列表，即在每个<strong class="mc jd"> <em class="nb">解码器</em> </strong>的目标序列值中计算的关注度</li><li id="d191" class="ns nt it mc b md og mg oh mj oi mn oj mr ok mv of ny nz oa bi translated"><em class="nb">解码器编码器关注度</em>列表，即<em class="nb">编码器</em>的输出为<em class="nb">编码器输出</em>和<em class="nb">查询</em>为目标序列关注度计算的输出之间计算的关注度</li></ol><p id="8701" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">采用我们从<strong class="mc jd">解码器(<em class="nb">解码器输出</em> ) </strong>接收的输出，我们将<strong class="mc jd">展平</strong>它，并将其通过<em class="nb">全连接层</em>，该层具有每个类的<code class="fe nn no np nq b">N</code>输出神经元。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/a36e850e8e20c86879eec170edb76337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SztiWWjS54tpeMvR8Z0d3w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h2 id="0791" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">分类变压器</h2><p id="4461" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">要将一些数据分成<em class="nb"> n </em>类，可以使用以下模型代码。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/62b2dc99be5f7442e91c63d9157e5a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pB6J3qL7szh4vU327M2Vg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="75d2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">下图显示了通过</em> <code class="fe nn no np nq b"><em class="nb">ClassificationTransformer</em></code>各部分的批量数据流程</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/6d4b734d01b6871e924f5de81dde5d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEREH_yxcculY613fuI9lw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="9aab" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这是关于如何在PyTorch中从头开始编写自我关注转换器的构建模块。现在让我们转到一个真实世界的数据集，我们将使用它来训练一个分类转换器，将一个问题分为两类。问题所属的类别是<code class="fe nn no np nq b">class</code>和<code class="fe nn no np nq b">subclass</code>。</p><h1 id="c872" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">2.数据集和数据准备介绍</h1><p id="d00a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">有许多方法可以实现将句子或段落分类成不同类别的良好准确性。正如标题所暗示的，在这一系列的博客中，我们将讨论一个最受关注和使用的模型架构。我们将使用PyTorch编写一个多头自我关注变形金刚，而不是使用HuggingFace的变形金刚库或任何其他预先训练好的模型。为了让事情变得更加有趣和复杂，我们将训练的数据集有两组类别，我们将讨论和实现不同的方法来实现一个良好的分类模型，该模型可以将文本分类到两组不同的类别中，每组都有几个类。</p><p id="4cdb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们将使用的数据集是一个问题分类数据集。这两组类别提供了关于所提问题需要哪种类型的答案的信息。你可以在这里找到数据集<a class="ae lh" href="https://cogcomp.seas.upenn.edu/Data/QA/QC/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="feb0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">比如问的问题是什么是肝酶？这个问题需要一个<em class="nb">描述性的</em>文本，最合适的是一个<em class="nb">定义</em>。所以这里的<em class="nb">类</em>是<strong class="mc jd"> <em class="nb">描述性文字</em> </strong>而<em class="nb">子类</em>是<strong class="mc jd"> <em class="nb">定义</em> </strong>。</p><h2 id="4631" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">数据看起来怎么样？</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/b8a1db9cd9b65a3b7fb3082d9a56b353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pnujAo3pLb9_qtuVwQrQ3Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h2 id="3816" class="nc lj it bd lk nd ne dn lo nf ng dp ls mj nh ni lu mn nj nk lw mr nl nm ly iz bi translated">数据准备</h2><p id="154d" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">你可以用下载文件的链接地址做一个<code class="fe nn no np nq b">wget</code>来下载数据。我们将使用<code class="fe nn no np nq b">toknizers</code>库将问题文本转换成标记。因为拥抱脸标记器库是用<code class="fe nn no np nq b">rust</code>写的，比任何python实现都快，所以我们正在利用它。你也可以尝试使用<code class="fe nn no np nq b">BytePairEncoding</code>库可用<a class="ae lh" href="https://github.com/vatsalsaglani/BytePairEncoding" rel="noopener ugc nofollow" target="_blank">这里</a>把问题转换成令牌。比抱脸令牌化器慢多了。</p><p id="f935" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">一旦您下载了数据，我们将使用以下步骤清理句子并获得我们的类和子类标签，</p><ul class=""><li id="c1a6" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">导入和数据加载</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/172adf76e3bfd924e6fbef0e8de743e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y6ghVS8D9Scql2xVSo-d7Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="fe8a" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">将一行字节解码为字符串</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/620220a8cb966e932071970c08166e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6BukAOU-uZMGCnbWiWY2Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="8ea5" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">列出所有问题</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/672065edbfc500b09499b490fe59e08f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MvbjP3VZ3aBs8AH5kkMbDA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="35f4" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">类、子类和问题的字符串</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/1f00bd8427924de873e179cd3e1f929f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZ0KcW5o9Q1A5N0-n4437w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="0492" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">现在的数据会是什么样子？</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/559d1572f56e182beb9fe5cbc3140dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUknDSABf8y0r1A0OZE_hw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="ce69" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">将字典列表转换为数据帧</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/27f68126cc1de7b9d5eed86ff279d51f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4V_zUxMN3AWaRNxNtSB6kQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="d4f3" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">类名到索引，反之亦然</em></li></ul><p id="2e45" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">总共有6个班</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/a9dc007d2d8eb140cb45dac2dc67bf7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*owjEi2i1PALcrkz4wp2T1A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="1c76" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">保存</em> <code class="fe nn no np nq b"><em class="nb">classtoidx</em></code> <em class="nb">和</em> <code class="fe nn no np nq b"><em class="nb">idxtoclass</em></code></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/ac49e6b6182de1b6d09abe34a08482f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJ_vRvVQk8SAncSusC6iUA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="9c37" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">对子类重复上述两个步骤</em></li></ul><p id="50ac" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="nb">总共有47个子类</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/aafb4634c8c00b8ed56e68a8e088f8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgGhbGXQuzF3lrJbmH0tVQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="c180" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">将数据帧中的类和子类映射到它们的索引</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/a0eecd9393f83b6cacb5288922c69561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zCITxyQyZDQa8Wwtk11cw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="b8d2" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">对问题文本进行标记</em></li></ul><p id="56cc" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们将把文本转换成计算机可理解的数字，就像我们对标签所做的那样。这个词汇文件是在wikitext数据上训练<code class="fe nn no np nq b">BertWordPieceTokenizer</code>之后获得的，词汇大小为10k。你可以从<a class="ae lh" href="https://drive.google.com/file/d/13DDbLxG2iLBEzOpCYkPs7mEgMI0I_e6H/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/6997dac322aa4a5d14d408432f0ec68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OU0urWSNi6GJyb-2v0sWhA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="f86e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">让我们开始标记化，我们分别有一个列表，存储每个问题的标记数。最长的序列有52个构成问题的记号。我们可以将最大序列长度设为100。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/53a8dd71d5cff52e1f32046ed8ea2cd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KfpUCZIasqUQ0i68hyoaw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="a3c3" class="ns nt it mc b md mw mg mx mj nu mn nv mr nw mv nx ny nz oa bi translated"><em class="nb">将输出列表保存到pickle </em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/6668977ae2a8f1520dc8fed489ef168c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vi-HpHsuGUP3w7pg41OMMg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="f005" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这个<a class="ae lh" href="https://github.com/vatsalsaglani/QuestionClassification/blob/branch_1/notebooks/DataDownloadExploreNotebook.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>可以跟着实现以上所有。所有零件的代码都可以在<a class="ae lh" href="https://github.com/vatsalsaglani/QuestionClassification" rel="noopener ugc nofollow" target="_blank">这个GitHub repo </a>中找到。</p><blockquote class="pb pc pd"><p id="567b" class="ma mb nb mc b md mw kd mf mg mx kg mi pe my ml mm pf mz mp mq pg na mt mu mv im bi translated"><em class="it">如果这篇文章以任何可能的方式帮助了你，并且你喜欢它，请在你的社区中分享它。如果有任何错误，请在下面评论指出来。</em></p></blockquote></div></div>    
</body>
</html>