<html>
<head>
<title>Automate Excel tasks with Openpyxl and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Openpyxl和Python自动执行Excel任务</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/automate-excel-tasks-with-openpyxl-and-python-dc60b59b4cde?source=collection_archive---------0-----------------------#2021-11-23">https://pub.towardsai.net/automate-excel-tasks-with-openpyxl-and-python-dc60b59b4cde?source=collection_archive---------0-----------------------#2021-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1236" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><p id="3ab7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">自动化excel任务</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/4640939da054241e2ea142007d3d1181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSbjAr2kBjxP6OVs00b6mw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">作者的照片</figcaption></figure><p id="7b91" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在本文中，我们将借助jupyter notebook上的python库openpyxl来处理excel表格。</p><p id="902d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用一个示例excel文件，并在下面提到的库的帮助下，使用python执行各种任务来自动化这些任务。</p><p id="a547" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">要安装该库，请打开anaconda提示符并编写如下所示的命令:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="90ef" class="ls lt it lo b gy lu lv l lw lx">pip install openpyxl</span></pre><p id="856c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">样张的视图如下所示，底部有几个样张。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/1612f582b6df5e17133f5288bcb62ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*NWzbW-8qUx4bvgTweov2EA.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">作者图片</figcaption></figure><p id="5113" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，我们将在库的帮助下加载excel文件。</p><p id="f926" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">导入openpyxl库。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="590a" class="ls lt it lo b gy lu lv l lw lx">import openpyxl</span></pre><p id="4546" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">工作簿内的第一个工作表包含关于类别、记录等的一般信息。另外两张是测试和样品的空白纸。</p><p id="b627" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，在python解释器的帮助下，关闭我们将要处理的excel文件，以避免任何与权限相关的问题。不过，不要担心，无论何时我们想从文件中读取某些内容，或者无论何时我们要从python中对文件进行更改，我们都会打开文件，然后检查更改。</p><p id="0641" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，创建变量对象，将excel文件加载到其中，以进行进一步的操作。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="c2a1" class="ls lt it lo b gy lu lv l lw lx">#In brackets we need to write the path of the workbook<br/>wb = openpyxl.load_workbook("sample_openpyxl.xlsx")</span></pre><blockquote class="lz ma mb"><p id="bd2c" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">阅读工作簿基本信息</em> </strong></p></blockquote><p id="72b4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">wb是一个变量，我们可以用它进行多种运算。现在，用<strong class="kb jd"> <em class="mc">属性</em> </strong>方法读取关于工作簿的各种信息。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="b62c" class="ls lt it lo b gy lu lv l lw lx">wb.properties</span><span id="10af" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>&lt;openpyxl.packaging.core.DocumentProperties object&gt;<br/>Parameters:<br/>creator='Amit', title=None, description=None, subject=None, identifier=None, language=None, created=datetime.datetime(2021, 11, 20, 9, 55, 18), modified=datetime.datetime(2021, 11, 20, 10, 1, 16), lastModifiedBy='Amit', category=None, contentStatus=None, version=None, revision=None, keywords=None, lastPrinted=None</span></pre><p id="ef6f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在这个输出中，我们得到了很多信息，</p><ul class=""><li id="5495" class="mh mi it kb b kc kd kg kh kk mj ko mk ks ml kw mm mn mo mp bi translated">工作簿的创建者。</li><li id="46c3" class="mh mi it kb b kc mq kg mr kk ms ko mt ks mu kw mm mn mo mp bi translated">工作簿的创建日期和修改日期。</li></ul><blockquote class="lz ma mb"><p id="c12d" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">查找工作簿中工作表名称和活动工作表的数量</em> </strong></p></blockquote><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="1121" class="ls lt it lo b gy lu lv l lw lx">wb.sheetnames</span><span id="0e3e" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>['sample1', 'sample2', 'Sheet3']</span></pre><p id="72ca" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">输出显示了工作簿中的工作表名称，如上图所示。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="b415" class="ls lt it lo b gy lu lv l lw lx">wb.active</span><span id="6c45" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>&lt;Worksheet "sample1"&gt;</span></pre><blockquote class="lz ma mb"><p id="4df6" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">创建新的工作表并从python中删除工作表</em> </strong></p></blockquote><h2 id="aea3" class="ls lt it bd mv mw mx dn my mz na dp nb kk nc nd ne ko nf ng nh ks ni nj nk iz bi translated">创建新工作表</h2><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="6f8c" class="ls lt it lo b gy lu lv l lw lx">wb.create_sheet('new_sheet')</span><span id="32b5" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>&lt;Worksheet "new_sheet"&gt;</span></pre><p id="876c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">要进行更改，我们需要保存工作簿。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="e704" class="ls lt it lo b gy lu lv l lw lx">wb.save(“sample_openpyxl.xlsx”)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nl"><img src="../Images/37db564996aa9c9873d6aff24bb3e3d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pgMqA86AHEbI0amLpPC3w.png"/></div></div></figure><h2 id="7daa" class="ls lt it bd mv mw mx dn my mz na dp nb kk nc nd ne ko nf ng nh ks ni nj nk iz bi translated">移除新的或任何工作表</h2><p id="54df" class="pw-post-body-paragraph jz ka it kb b kc nm ke kf kg nn ki kj kk no km kn ko np kq kr ks nq ku kv kw im bi translated">要移除工作表，我们必须给出该特定工作表的名称。</p><p id="0ee4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">选项1</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="5eb0" class="ls lt it lo b gy lu lv l lw lx">sheet = wb['new_sheet']<br/>wb.remove(sheet)</span></pre><p id="7db5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">选项2</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="7d6d" class="ls lt it lo b gy lu lv l lw lx">del wb['new_sheet']</span></pre><p id="d6f4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们可以使用上述选项中的任何一种方法。</p><div class="nr ns gp gr nt nu"><a rel="noopener  ugc nofollow" target="_blank" href="/are-you-switching-careers-to-data-science-and-machine-learning-5fab0b75470e"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd jd gy z fp nz fr fs oa fu fw jc bi translated">你要转行做数据科学和机器学习吗？</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">分析角色和成为数据科学家的路线图</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">pub.towardsai.net</p></div></div><div class="od l"><div class="oe l of og oh od oi lh nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a rel="noopener  ugc nofollow" target="_blank" href="/why-what-who-is-data-scientist-a7a9ac98bc96"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd jd gy z fp nz fr fs oa fu fw jc bi translated">为什么，什么，谁是数据科学家？</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">能够对数据进行分析和技术处理</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">pub.towardsai.net</p></div></div><div class="od l"><div class="oj l of og oh od oi lh nu"/></div></div></a></div><blockquote class="lz ma mb"><p id="c398" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">处理工作表的方法</em> </strong></p></blockquote><p id="8dbf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">选择我们要处理的工作表名称。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="a1fb" class="ls lt it lo b gy lu lv l lw lx">sheet = wb['sample1']<br/>sheet.title</span><span id="cd27" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>'sample1'</span></pre><p id="3785" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">用<strong class="kb jd"> <em class="mc">的dir </em> </strong>的方法来了解所有的方法来做操作。<strong class="kb jd"> <em class="mc"> dir </em> </strong>方法显示了我们可以在工作表中操作的所有方法。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="2386" class="ls lt it lo b gy lu lv l lw lx">dir(sheet)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ok"><img src="../Images/aa1f75da0f66f4676f7b6d0b22f71114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40FkYl4WThcsodEbPOv2uQ.png"/></div></div></figure><p id="c675" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">示例:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="c069" class="ls lt it lo b gy lu lv l lw lx">sheet.active_cell</span><span id="052a" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>F11</span><span id="de57" class="ls lt it lo b gy mg lv l lw lx">sheet.dimensions</span><span id="eca1" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>'A1:E13'</span></pre><p id="6f59" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">活动单元格意味着鼠标箭头点击了F11单元格。表的总填充区域是从A1到E13。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="09f2" class="ls lt it lo b gy lu lv l lw lx">sheet.max_row<br/>sheet.max_column</span><span id="b256" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>13<br/>5</span><span id="1332" class="ls lt it lo b gy mg lv l lw lx">--------------------------------------------------------<br/>for i in sheet.values:<br/>    print(i)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ol"><img src="../Images/25df1d2fffaf32db1a40ddbe3ed5abd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBSWZKKlST39TgkkVHqPwg.png"/></div></div></figure><blockquote class="lz ma mb"><p id="cf1b" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">查找工作表中的值</em> </strong></p></blockquote><p id="8c69" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们可以通过单元格名称或者通过提及行和列的值来找到单元格数据。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="ce53" class="ls lt it lo b gy lu lv l lw lx">sheet['A4'].value</span><span id="fb5a" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>'Office Supplies'</span><span id="3f17" class="ls lt it lo b gy mg lv l lw lx">--------------------------------------------------------<br/>sheet.cell(row = 3, column = 5).value</span><span id="ba3b" class="ls lt it lo b gy mg lv l lw lx">#output:<br/>'Home Office'</span></pre><blockquote class="lz ma mb"><p id="ab0e" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">改变单元格的值</em> </strong></p></blockquote><p id="9387" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们还可以更改单元格数据的值，如下例所示:</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="7043" class="ls lt it lo b gy lu lv l lw lx">cell = sheet['A4']<br/>cell.value = 'Home Supplies'<br/>wb.save("sample_openpyxl.xlsx")</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi om"><img src="../Images/d191519bd1cfe11711636181287bae52.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*bi9ReKjkMBc9XTbPBSVluQ.png"/></div></figure><blockquote class="lz ma mb"><p id="20a4" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">单元格样式</em> </strong></p></blockquote><p id="318d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们在excel中工作，忘记了单元格和数据的样式，这是不可能的。在这里，我们可以做许多样式，如粗体、斜体、字体颜色、单元格填充颜色等。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="12fd" class="ls lt it lo b gy lu lv l lw lx">cell = sheet['A5']<br/>font = Font(color = colors.RED, bold = True, italic = True)<br/>cell.font = font<br/>wb.save("sample_openpyxl.xlsx")</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi on"><img src="../Images/8b48177744bd54f5cefe5c4528b080a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*W7rtMh_6FHgAS5jjDtcf5g.png"/></div></figure><blockquote class="lz ma mb"><p id="59ab" class="jz ka mc kb b kc kd ke kf kg kh ki kj md kl km kn me kp kq kr mf kt ku kv kw im bi translated"><strong class="kb jd"> <em class="it">结论</em> </strong></p></blockquote><p id="0af4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本文介绍了用python编程在excel中使用的基本方法。</p><p id="1ac7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae oo" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae oo" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="8300" class="op lt it bd mv oq or os my ot ou ov nb ow ox oy ne oz pa pb nh pc pd pe nk pf bi translated">推荐文章</h1><p id="169a" class="pw-post-body-paragraph jz ka it kb b kc nm ke kf kg nn ki kj kk no km kn ko np kq kr ks nq ku kv kw im bi translated">1.<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/8-active-learning-insights-of-python-collection-module-6c9e0cc16f6b?source=friends_link&amp;sk=4a5c9f9ad552005636ae720a658281b1">8 Python的主动学习见解收集模块</a> <br/> 2。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/numpy-linear-algebra-on-images-ed3180978cdb?source=friends_link&amp;sk=d9afa4a1206971f9b1f64862f6291ac0"> NumPy:图像上的线性代数</a>T5】3。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/exception-handling-concepts-in-python-4d5116decac3?source=friends_link&amp;sk=a0ed49d9fdeaa67925eac34ecb55ea30">Python中的异常处理概念</a> <br/> 4。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/pandas-dealing-with-categorical-data-7547305582ff?source=friends_link&amp;sk=11c6809f6623dd4f6dd74d43727297cf">熊猫:处理分类数据</a> <br/> 5。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/hyper-parameters-randomseachcv-and-gridsearchcv-in-machine-learning-b7d091cf56f4?source=friends_link&amp;sk=cab337083fb09601114a6e466ec59689">超参数:机器学习中的RandomSeachCV和GridSearchCV</a><br/>6。<a class="ae oo" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python </a> <br/> 7全面讲解了线性回归。<a class="ae oo" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python </a> <br/>充分解释了Logistic回归8。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/data-distribution-using-numpy-with-python-3b64aae6f9d6?source=friends_link&amp;sk=809e75802cbd25ddceb5f0f6496c9803">数据分发使用Numpy与Python </a> <br/> 9。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/decision-trees-vs-random-forests-in-machine-learning-be56c093b0f?source=friends_link&amp;sk=91377248a43b62fe7aeb89a69e590860">机器学习中的决策树vs随机森林</a> <br/> 10。<a class="ae oo" rel="noopener ugc nofollow" target="_blank" href="/standardization-in-data-preprocessing-with-python-96ae89d2f658?source=friends_link&amp;sk=f348435582e8fbb47407e9b359787e41">用Python实现数据预处理的标准化</a></p></div></div>    
</body>
</html>