<html>
<head>
<title>How to Build and Train Your First Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立和训练你的第一个神经网络</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-build-and-train-your-first-neural-network-9a07d020c4bb?source=collection_archive---------0-----------------------#2020-06-02">https://pub.towardsai.net/how-to-build-and-train-your-first-neural-network-9a07d020c4bb?source=collection_archive---------0-----------------------#2020-06-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="37ea" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/3c7621a519e43e0ec9f0b7372d8862a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tQMk238ThG_YWqkJ.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">来源:<a class="ae kl" href="https://pythonprogramming.net/introduction-deep-learning-neural-network-pytorch/" rel="noopener ugc nofollow" target="_blank">python编程</a></figcaption></figure><p id="68f7" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我们开始构建神经网络之前，有几个先决条件你需要知道。</p><ol class=""><li id="cfe8" class="lk ll iq ko b kp kq kt ku kx lm lb ln lf lo lj lp lq lr ls bi translated"><a class="ae kl" href="https://en.wikipedia.org/wiki/Tensor" rel="noopener ugc nofollow" target="_blank">张量</a></li><li id="36fb" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated"><a class="ae kl" href="https://machinelearningmastery.com/introduction-to-tensors-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">张量运算</a></li><li id="7ab3" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated"><a class="ae kl" href="https://www.khanacademy.org/math/ap-calculus-ab/ab-differentiation-1-new" rel="noopener ugc nofollow" target="_blank">差异化</a></li><li id="1ebb" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">渐变下降</li></ol><p id="2942" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了更好地理解这个概念，请务必阅读这些主题。</p><h1 id="dd0c" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">什么是神经网络？</h1><p id="f0ab" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">神经网络是一组用于识别非结构化数据中的模式的算法。这些神经网络试图模仿人脑，因为它们模仿人脑。</p><p id="1671" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">神经网络的类型有:</p><ol class=""><li id="6f73" class="lk ll iq ko b kp kq kt ku kx lm lb ln lf lo lj lp lq lr ls bi translated">人工神经网络</li><li id="d5ef" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">卷积神经网络(CNN)</li><li id="7769" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">递归神经网络(RNN)</li></ol><h2 id="437e" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">神经网络的优势:</h2><ol class=""><li id="9d3c" class="lk ll iq ko b kp mw kt mx kx nm lb nn lf no lj lp lq lr ls bi translated">他们可以从给出的训练数据中学习，并很容易找到相似之处。</li><li id="3eb6" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">即使一个神经元没有反应，它仍然可以设法得到输出。</li><li id="fadf" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">并行进程可以在不影响整体性能的情况下运行。</li></ol><h2 id="fc95" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">神经网络的应用:</h2><ol class=""><li id="8ae5" class="lk ll iq ko b kp mw kt mx kx nm lb nn lf no lj lp lq lr ls bi translated">图像处理</li><li id="7785" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">语音识别</li><li id="9bd1" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">模式预测</li><li id="26f9" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">聚类等。</li></ol><p id="822b" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">作为一个初学者，安将是非常容易和简单的理解。所以，我会更加关注安。</p><h2 id="ba7d" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">什么是人工神经网络？</h2><p id="d72c" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">这些是最简单的神经网络形式。在输入节点的帮助下，信息只在一个方向上传递，直到它到达输出。这种类型的神经网络也称为前馈神经网络。</p><p id="8581" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们来看看简单的安。</p><figure class="nq nr ns nt gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi np"><img src="../Images/75f415451c2ef1ed89e36035dc53f939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HByuNjKgdVf9LaV_g4fZzA.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">来源:<a class="ae kl" href="https://www.smartsheet.com/sites/default/files/IC-simplified-artificial-neural-networks-corrected.svg" rel="noopener ugc nofollow" target="_blank">智能表</a></figcaption></figure><p id="306b" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">ANN由三个主要层组成，即输入层、隐藏层和输出层。人工神经网络主要解决与图像、文本和表格数据相关的问题。</p><h2 id="9ba5" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">人工神经网络的工作</h2><p id="e6e9" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">输入层接收来自外部的信息，并通过两个或多个隐藏层。这些隐藏层将输入转换为输出。</p><p id="a73d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我们深入之前。让我们看一个实际的用法。</p><p id="db49" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我将使用MNIST样本数字数据集来解释安的。我们将使用人工神经网络将图像分为10类。</p><h2 id="c541" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤1:导入所有需要的库</h2><p id="44ad" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated"><em class="nu">你可以在下面的</em> <a class="ae kl" href="https://www.liquidweb.com/kb/how-to-install-keras/" rel="noopener ugc nofollow" target="_blank"> <em class="nu">链接</em> </a> <em class="nu">中找到Keras的安装程序。</em></p><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="f6a4" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤2:加载MNIST数据集</h2><p id="ee33" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">MNIST数据集以Numpy数组的形式预装在Keras中。</p><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="111e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">数据集被分成测试集和训练集。</p><p id="f67d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">看一看训练和测试数据集。</p><figure class="nq nr ns nt gt ka gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/b65ad2ea714b96457e55aa5532479162.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*G6NMT3qg2WMnwRbPBsS9Ow.png"/></div></figure><h2 id="6618" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤3:创建神经网络</h2><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="e8d2" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">层是神经网络最重要的组成部分。你可以把它们看作是数据的过滤器。看看我们的网络。我们有一系列两个紧密相连的层，它们是完全相连的。最后一层是10路softmax层，它返回10个概率得分的数组。</p><h2 id="0e39" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">激活是什么意思？</h2><p id="b5bb" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">这些是决定神经网络输出的数学函数。这些决定了深度学习模型的输出，其准确性，以及模型的计算效率。</p><h2 id="72f1" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">5激活功能的基本类型有:</h2><ol class=""><li id="c7f9" class="lk ll iq ko b kp mw kt mx kx nm lb nn lf no lj lp lq lr ls bi translated">热卢</li><li id="de13" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">乙状结肠的</li><li id="9f64" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">Softmax</li><li id="c640" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated">线性的</li></ol><h2 id="c51f" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤4:网络编译</h2><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="9341" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">compile函数有三个参数:优化器、损失和指标。</p><ol class=""><li id="ee43" class="lk ll iq ko b kp kq kt ku kx lm lb ln lf lo lj lp lq lr ls bi translated"><strong class="ko ja">优化器</strong>:这些是某些算法，用来改变神经网络的属性，以降低损失率。</li><li id="0e7c" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated"><strong class="ko ja">损失</strong>:用于计算模型在训练过程中应该寻求最小化的数量。</li><li id="7271" class="lk ll iq ko b kp lt kt lu kx lv lb lw lf lx lj lp lq lr ls bi translated"><strong class="ko ja">指标</strong>:用于判断模型的表现。</li></ol><h2 id="6dc2" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤5:重塑输入数据</h2><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7917" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们必须通过整形和缩放来预处理数据，使值从0到1。</p><p id="da90" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">数据的原始形状是类型单元8的(60000，28，28)。我们要把它转换成float类型的(10000，28 * 28)。</p><h2 id="baa3" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤6:准备标签</h2><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="a451" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">测试和训练标签被转换成分类值。</p><h2 id="fcc0" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤7:训练模型</h2><figure class="nq nr ns nt gt ka"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="e327" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">fit函数将训练图像、训练标签、时期和批量大小作为参数。</p><p id="a21f" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">时期:</strong>fit函数将训练图像、训练标签、时期和批量大小作为参数。<br/> <br/>使用这行代码来检查网络上测试数据的准确性。</p><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="b6b6" class="nb lz iq nz b gy od oe l of og">test_loss, test_acc = network.evaluate(test_images, test_labels)<br/>print('test_acc:', test_acc)</span></pre><p id="ea64" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">测试准确率约为98.9%。</p><h2 id="e9ee" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤8:保存你的模型</h2><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="ea07" class="nb lz iq nz b gy od oe l of og">network.save("model.h5")</span></pre><p id="881e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">保存模型后，您可以重用它。你不需要从一开始就训练模型。</p><h2 id="9200" class="nb lz iq bd ma nc nd dn me ne nf dp mi kx ng nh mm lb ni nj mq lf nk nl mu iw bi translated">步骤9:如何加载模型</h2><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="b736" class="nb lz iq nz b gy od oe l of og">from keras.models import load_model</span><span id="240d" class="nb lz iq nz b gy oh oe l of og"># load model</span><span id="5450" class="nb lz iq nz b gy oh oe l of og">model = load_model('model.h5')</span></pre><p id="a2db" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">加载模型后，它的过程与您在步骤7中所做的相同。</p><h1 id="ece3" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">结论:</h1><p id="9e5b" class="pw-post-body-paragraph km kn iq ko b kp mw kr ks kt mx kv kw kx my kz la lb mz ld le lf na lh li lj ij bi translated">我希望你理解了基础知识，对神经网络有了一点了解。感谢阅读到最后，敬请期待更多有趣的文章。</p><p id="3928" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">请不要忘记鼓掌并跟着做。</p></div></div>    
</body>
</html>