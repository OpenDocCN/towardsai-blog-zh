<html>
<head>
<title>Custom Object Detection using EfficientDet- The Simplest way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用EfficientDet的自定义对象检测-最简单的方法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/custom-object-detection-using-efficientdet-the-simplest-way-32749fb93359?source=collection_archive---------0-----------------------#2020-02-18">https://pub.towardsai.net/custom-object-detection-using-efficientdet-the-simplest-way-32749fb93359?source=collection_archive---------0-----------------------#2020-02-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/e92986bd9244a77955bbc420af9275a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*ybxvQ7RlYM05sN68KyKQnQ.gif"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">目标检测</figcaption></figure><p id="5f08" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我将向你展示如何使用<a class="ae kw" href="https://github.com/Tessellate-Imaging/Monk_Object_Detection" rel="noopener ugc nofollow" target="_blank"> Monk </a>的EfficientDet创建你的自定义对象检测器。</p><p id="6a1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我假设你已经知道深度学习计算机视觉的基本知识。在深入研究之前，请确保您知道什么是对象检测，什么是迁移学习，以及其他一些深度学习术语。</p><p id="5ea3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你对这些都不了解，是时候回去学习基础知识，然后再来看这篇文章了。当然，你可以在没有任何知识的情况下使用<a class="ae kw" href="https://github.com/Tessellate-Imaging/Monk_Object_Detection" rel="noopener ugc nofollow" target="_blank">僧侣</a>来做这些事情，但是最好是让你的基础知识清晰明了。我会在这篇文章的最后部分放一些学习资源。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="0270" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">目录</h1><ol class=""><li id="258e" class="mc md iq ka b kb me kf mf kj mg kn mh kr mi kv mj mk ml mm bi translated"><strong class="ka ir">数据采集</strong></li><li id="00a8" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated"><strong class="ka ir">转换为COCO格式</strong></li><li id="5a73" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated"><strong class="ka ir">培训模式</strong></li><li id="36c3" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated"><strong class="ka ir">测试对象检测器</strong></li></ol></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="5d33" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">数据采集</h1><p id="4489" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">在本文中，我们使用的数据来自<a class="ae kw" href="https://github.com/cs-chan/Exclusively-Dark-Image-Dataset" rel="noopener ugc nofollow" target="_blank">专门的暗图像数据集</a>。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="635d" class="ne lf iq na b gy nf ng l nh ni">wget <a class="ae kw" href="http://web.fsktm.um.edu.my/~cschan/source/CVIU/ExDark.zip" rel="noopener ugc nofollow" target="_blank">http://web.fsktm.um.edu.my/~cschan/source/CVIU/ExDark.zip</a></span><span id="f778" class="ne lf iq na b gy nj ng l nh ni">wget --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=1FfEuDUdRbOFTtL8GioPceFghshMvfX7S' -O ExDark_Annno.zip</span></pre></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="3b78" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">转换为COCO格式</h1><p id="b986" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">下载数据的当前格式是</p><p id="6953" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">数据集目录结构</strong></p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="c5f0" class="ne lf iq na b gy nf ng l nh ni">Dark (root_dir)<br/>      |<br/>      |------Images (img_dir) <br/>      |         |<br/>      |         |----Bicycle<br/>      |                 |<br/>      |                 |---------img1.jpg<br/>      |                 |---------img2.jpg<br/>      |                 |---------..........(and so on)<br/>      |<br/>      |         |-----Boat<br/>      |                 |<br/>      |                 |---------img1.jpg<br/>      |                 |---------img2.jpg<br/>      |                 |---------..........(and so on)<br/>      |<br/>      |         |-----...........(and so on)<br/>      |<br/>      |<br/>      |<br/>      |------Annotations (anno_dir) <br/>      |         |<br/>      |         |----Bicycle<br/>      |                 |<br/>      |                 |---------img1.jpg.txt<br/>      |                 |---------img2.jpg.txt<br/>      |                 |---------..........(and so on)<br/>      |<br/>      |         |-----Boat<br/>      |                 |<br/>      |                 |---------img1.jpg.txt<br/>      |                 |---------img2.jpg.txt<br/>      |                 |---------..........(and so on)<br/>      |<br/>      |         |------............(and so on)</span></pre><p id="3adc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们通过Monk格式转换成COCO格式</p><ol class=""><li id="b701" class="mc md iq ka b kb kc kf kg kj nk kn nl kr nm kv mj mk ml mm bi translated">从当前格式转换为Monk格式</li></ol><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e6fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">和尚格式</strong></p><p id="0860" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">数据集目录结构</strong></p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="27a0" class="ne lf iq na b gy nf ng l nh ni">Dark (root)<br/>      |<br/>      |------Images (img_dir)<br/>      |         |<br/>      |         |----Bicycle<br/>      |                 |<br/>      |                 |---------img1.jpg<br/>      |                 |---------img2.jpg<br/>      |                 |---------..........(and so on)<br/>      |<br/>      |         |-----Boat<br/>      |                 |<br/>      |                 |---------img1.jpg<br/>      |                 |---------img2.jpg<br/>      |                 |---------..........(and so on)<br/>      |<br/>      |         |-----...........(and so on)<br/>      |<br/>      |<br/>      |------train_labels.csv (anno_file)</span></pre><p id="6cd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">标注文件格式</strong></p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="b599" class="ne lf iq na b gy nf ng l nh ni">| Id         | Labels                                 |<br/>| img1.jpg   | x1 y1 x2 y2 label1 x1 y1 x2 y2 label2  |</span></pre><ul class=""><li id="07a2" class="mc md iq ka b kb kc kf kg kj nk kn nl kr nm kv np mk ml mm bi translated">标签:xmin ymin xmax ymax标签</li><li id="616a" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv np mk ml mm bi translated">xmin，ymin边界框的左上角</li></ul><p id="d2ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> COCO格式</strong></p><p id="1b7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">数据集目录结构</strong></p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="424e" class="ne lf iq na b gy nf ng l nh ni">./ (root_dir)<br/>      |<br/>      |------Dark (coco_dir) <br/>              |<br/>              |------Images (set_dir)<br/>              |         |<br/>              |         |----Bicycle<br/>              |                 |<br/>              |                 |---------img1.jpg<br/>              |                 |---------img2.jpg<br/>              |                 |---------..........(and so on)<br/>              |<br/>              |         |-----Boat<br/>              |                 |<br/>              |                 |---------img1.jpg<br/>              |                 |---------img2.jpg<br/>              |                 |---------..........(and so on)<br/>              |<br/>              |         |-----...........(and so on)<br/>              |<br/>              |<br/>              |<br/>              |------annotations <br/>              |----------|<br/>                         |--------------------instances_Images.json  (instances_&lt;set_dir&gt;.json)<br/>                         |--------------------classes.txt</span></pre><ul class=""><li id="de58" class="mc md iq ka b kb kc kf kg kj nk kn nl kr nm kv np mk ml mm bi translated">instances_Train.json -&gt;正确的COCO格式</li><li id="5d4e" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv np mk ml mm bi translated">classes.txt -&gt;按字母顺序排列的类列表</li></ul><p id="fb50" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于车列</p><ul class=""><li id="8b15" class="mc md iq ka b kb kc kf kg kj nk kn nl kr nm kv np mk ml mm bi translated">root_dir = "。/";</li><li id="d7dd" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv np mk ml mm bi translated">coco _ dir = " Dark</li><li id="1c9f" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv np mk ml mm bi translated">img_dir = "。/";</li><li id="202a" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv np mk ml mm bi translated">set _ dir = " Images</li></ul><p id="f35c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意:注释文件名也与set_dir一致</p><p id="1646" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Annotations文件夹包含两个文件classes.txt、instances_Images.json</p><p id="e064" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.从Monk格式转换到COCO格式。</p><p id="e673" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行classes.txt</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="fe1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">For instances_Images.json运行</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="a845" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">培训模式</h1><p id="89f8" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">在训练中选择合适的批量大小，学习速率，设置目录路径。也可以在多个GPU上训练。例如，如果您使用2个GPU，请将line8更改为gtf.model( gpu_devices=[0，1])</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h1 id="18af" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">测试对象检测器</h1><p id="9d9e" class="pw-post-body-paragraph jy jz iq ka b kb me kd ke kf mf kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">训练完模型后，我们可以在训练好的文件夹中得到权重文件。</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="d295" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在下面看到一些图像推论:</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi nq"><img src="../Images/af78c9183c0253e0ebe734add3b14389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PnzPbNnZ1l1sbwc7lcFFng.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">推论1</figcaption></figure><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi nv"><img src="../Images/8aa61f33aec88b0cf0b5d5a363615841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RalsoYaW06zIr0NkyCpq-Q.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">推论2</figcaption></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="2f65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kw" href="https://github.com/Tessellate-Imaging/Monk_Object_Detection/blob/master/application_model_zoo/Example%20-%20Object%20Detection%20in%20low%20lighting%20conditions.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到完整的代码。</p><p id="8f9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果有任何问题，可以联系<a class="ae kw" href="https://www.linkedin.com/in/abhishek-kumar-annamraju/" rel="noopener ugc nofollow" target="_blank">阿布舍克</a>和<a class="ae kw" href="https://www.linkedin.com/in/akashdeepsingh01/" rel="noopener ugc nofollow" target="_blank">阿卡什</a>。请随意联系他们。</p><p id="f2ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="nw">【谢谢】</em> </strong></p><h1 id="429c" class="le lf iq bd lg lh nx lj lk ll ny ln lo lp nz lr ls lt oa lv lw lx ob lz ma mb bi translated">证明人和信用</h1><ol class=""><li id="1806" class="mc md iq ka b kb me kf mf kj mg kn mh kr mi kv mj mk ml mm bi translated"><a class="ae kw" href="https://arxiv.org/abs/1911.09070" rel="noopener ugc nofollow" target="_blank">关于效率的论文</a></li><li id="ff1f" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated"><a class="ae kw" href="https://github.com/signatrix/efficientdet" rel="noopener ugc nofollow" target="_blank">https://github.com/signatrix/efficientdet</a></li><li id="88e4" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated"><a class="ae kw" href="https://towardsdatascience.com/efficientdet-scalable-and-efficient-object-detection-review-4472ffc34fd9" rel="noopener" target="_blank"> EfficientDet博客</a></li><li id="8701" class="mc md iq ka b kb mn kf mo kj mp kn mq kr mr kv mj mk ml mm bi translated"><a class="ae kw" href="https://medium.com/analytics-vidhya/custom-object-detection-with-yolov3-8f72fe8ced79" rel="noopener">https://medium . com/analytics-vid hya/custom-object-detection-with-yolov 3-8f 72 Fe 8 ced 79</a></li></ol></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi oc"><img src="../Images/f1d27c0178e89872961964bef27ec694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*42ttxjPnIWsMHM_CZf06lA.jpeg"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">照片由<a class="ae kw" href="https://www.instagram.com/_fernwehd_._/" rel="noopener ugc nofollow" target="_blank"> Srilekha </a>拍摄</figcaption></figure></div></div>    
</body>
</html>