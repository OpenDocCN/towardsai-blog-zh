<html>
<head>
<title>Building a Recommender System With Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫构建推荐系统</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/building-a-recommender-system-with-pandas-1ca0bb03fdce?source=collection_archive---------0-----------------------#2019-05-24">https://pub.towardsai.net/building-a-recommender-system-with-pandas-1ca0bb03fdce?source=collection_archive---------0-----------------------#2019-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="4b39" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">全指南打造推荐系统| <a class="ae ep" href="https://towardsai.net" rel="noopener ugc nofollow" target="_blank">走向AI </a></h2><div class=""/><p id="5a2b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi ku translated"><span class="l kv kw kx bm ky kz la lb lc di">H</span><strong class="jy ja">T5】ello World</strong>，在短短几分钟内，我将向你展示一些使用熊猫进行数据科学的非常有效的方法。</p><p id="6b5d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我假设您经常使用Pandas，并且对Pandas系列和数据框的结构和常用方法有基本的了解。</p><p id="619f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">因此，我们将探索一些现实生活中的数据，并建立一个<strong class="jy ja">基于内容的电影推荐系统</strong>，专门使用熊猫<em class="ld">。</em></p><h2 id="da0d" class="le lf iq bd lg lh li dn lj lk ll dp lm kh ln lo lp kl lq lr ls kp lt lu lv iw bi translated">目录</h2><ul class=""><li id="dbcf" class="lw lx iq jy b jz ly kd lz kh ma kl mb kp mc kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#a46b" rel="noopener">数据:</a></li><li id="2b4a" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#a493" rel="noopener">推荐系统的定义:</a></li><li id="2203" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#577b" rel="noopener">读取数据:</a></li><li id="b0d7" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#4356" rel="noopener">数据清理和预处理:</a></li><li id="e1ae" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#3dac" rel="noopener">基于内容的推荐系统:</a></li><li id="bc44" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#523b" rel="noopener">最终输出:</a></li><li id="ddff" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#978a" rel="noopener">利弊:</a></li><li id="01e8" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated"><a class="ae mh" href="https://medium.com/p/1ca0bb03fdce#abf8" rel="noopener">概要:</a></li></ul><blockquote class="mn mo mp"><p id="97d6" class="jw jx ld jy b jz ka kb kc kd ke kf kg mq ki kj kk mr km kn ko ms kq kr ks kt ij bi translated">事不宜迟，让我们开始吧！</p></blockquote><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi mt"><img src="../Images/6495c1888256e5fff3ee00f61f085ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x7Cdm0ASyi-rOhFDW-bh6Q.jpeg"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated"><em class="nj">来源:</em><a class="ae mh" href="https://hips.hearstapps.com/hmg-prod.s3.amazonaws.com/images/best-kids-movies-netflix-2019-1558104198.jpg" rel="noopener ugc nofollow" target="_blank"><em class="nj">img _ credit</em></a></figcaption></figure><p id="a122" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们把熊猫进口到Colab。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="42b4" class="le lf iq nl b gy np nq l nr ns"># Dataframe manipulation library.<br/>import pandas as pd</span></pre><h1 id="a46b" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">数据:</h1><p id="6190" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated">我们将使用来自<a class="ae mh" href="https://grouplens.org/datasets/movielens/" rel="noopener ugc nofollow" target="_blank"><strong class="jy ja"><em class="ld">【Grouplens.org</em></strong></a>的电影分级公共数据集。这是一个<a class="ae mh" href="http://files.grouplens.org/datasets/movielens/ml-latest-small.zip" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">压缩文件</em> </strong> </a>，我从其中提取了两个文件用于这个练习。原始文件在Github中为<a class="ae mh" href="https://raw.githubusercontent.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/master/ratings.csv" rel="noopener ugc nofollow" target="_blank"><strong class="jy ja"><em class="ld">ratings . CSV</em></strong></a>和<a class="ae mh" href="https://raw.githubusercontent.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/master/movies.csv" rel="noopener ugc nofollow" target="_blank"><strong class="jy ja"><em class="ld">movies . CSV</em></strong></a><em class="ld">。</em></p><p id="3349" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">该数据是更大的电影镜头数据集  的子集<a class="ae mh" href="https://grouplens.org/datasets/movielens/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">，其用于构建混合电影推荐系统，部署内容和协同过滤。</em></strong></a></p><p id="018f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">movies.csv包含来自600个用户的9742部电影，ratings.csv有100836个电影评级。</p><blockquote class="mn mo mp"><p id="9921" class="jw jx ld jy b jz ka kb kc kd ke kf kg mq ki kj kk mr km kn ko ms kq kr ks kt ij bi translated">在我们构建基于内容的推荐系统时，让我们来研究这些数据。</p></blockquote><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi on"><img src="../Images/b7235c7f8f60c42942f69166df0e3858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9NHUSohmVJvcVMCqyEgjA.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">基于内容的推荐系统—来源:<a class="ae mh" href="https://www.researchgate.net/profile/Alan_Eckhardt/publication/220827211/figure/fig2/AS:394007092973580@1470950019808/Structure-of-a-recommender-system.png" rel="noopener ugc nofollow" target="_blank"> <em class="nj"> img_credit </em> </a></figcaption></figure><blockquote class="mn mo mp"><p id="8532" class="jw jx ld jy b jz ka kb kc kd ke kf kg mq ki kj kk mr km kn ko ms kq kr ks kt ij bi translated">嘿，劳伦斯！等等……什么是基于内容的推荐系统？</p></blockquote><p id="3128" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">哎呀！原谅我动作太快…</p><h1 id="a493" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">推荐系统的定义:</h1><p id="1aae" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated"><a class="ae mh" href="https://courses.cognitiveclass.ai/courses/course-v1:CognitiveClass+ML0101ENv3+2018/courseware/c6143d9ff5764057a91e53fa8a3a6dff/0b487a2c255f4c95a9ba58d5f8ebf041/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">推荐系统</em> </strong> </a>是用于基于从用户处获取的信息向用户推荐项目的算法集合。这些系统在网上商店、电影数据库和求职者中随处可见。</p><p id="b682" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">例如，下次网飞向你推荐一部电影时，这就是推荐系统算法在起作用。</p><blockquote class="mn mo mp"><p id="de3b" class="jw jx ld jy b jz ka kb kc kd ke kf kg mq ki kj kk mr km kn ko ms kq kr ks kt ij bi translated">基于内容的推荐系统试图根据用户的简档向用户推荐项目。用户简档围绕用户的偏好和口味，或者基于用户评级。</p></blockquote><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi oo"><img src="../Images/26d1e57d139a082e89b69e04594283c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3L8TPrUV5BhtSQB7MKRwqQ.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">两大类推荐系统是基于内容和协同过滤系统。</figcaption></figure><p id="e646" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><a class="ae mh" href="https://courses.cognitiveclass.ai/courses/course-v1:CognitiveClass+ML0101ENv3+2018/courseware/c6143d9ff5764057a91e53fa8a3a6dff/0b487a2c255f4c95a9ba58d5f8ebf041/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld"> IBM链接了解更多详情</em> </strong> </a></p><p id="4450" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">那就是说…让我们继续前进。</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi op"><img src="../Images/eb7d22cf61028811da28b198f4471332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vsTsE4HOSvaSPnCJs5j-Sg.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">计划就是坚持计划… Lol |来源:<a class="ae mh" href="https://www.google.com/url?sa=i&amp;source=images&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiVv9-T87DiAhVLExoKHXtUCywQjRx6BAgBEAU&amp;url=%2Furl%3Fsa%3Di%26source%3Dimages%26cd%3D%26ved%3D%26url%3Dhttps%253A%252F%252Fwww.whatstheplanstan.govt.nz%252F%26psig%3DAOvVaw16huAXqd2_77HOTCzN1Md2%26ust%3D1558674790598522&amp;psig=AOvVaw16huAXqd2_77HOTCzN1Md2&amp;ust=1558674790598522" rel="noopener ugc nofollow" target="_blank"> <em class="nj"> img_credit </em> </a></figcaption></figure><h1 id="577b" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">读取数据:</h1><p id="4fc6" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated">首先，我们保存来自Github的原始文件</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="4e7e" class="le lf iq nl b gy np nq l nr ns">movies_data = '<a class="ae mh" href="https://raw.githubusercontent.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/master/movies.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/master/movies.csv</a><a class="ae mh" href="https://raw.githubusercontent.com/Blackman9t/EDA/master/movies.csv'" rel="noopener ugc nofollow" target="_blank">'</a><br/>ratings_data = '<a class="ae mh" href="https://raw.githubusercontent.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/master/ratings.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/master/ratings.csv</a><a class="ae mh" href="https://raw.githubusercontent.com/Blackman9t/EDA/master/ratings.csv'" rel="noopener ugc nofollow" target="_blank">'</a></span></pre><p id="43e4" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们设置选项，将任何给定时间显示的最大行数限制为20</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="395b" class="le lf iq nl b gy np nq l nr ns"># Setting max-row display option to 20 rows.<br/>pd.set_option('max_rows', 20)</span></pre><p id="bcc5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">接下来，我们定义缺失值的另一种可能的表示。这些在实景数据中经常出现，但是<a class="ae mh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">熊猫默认不会全部发现</em> </strong> </a> <strong class="jy ja"> <em class="ld">。</em>T9】</strong></p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="9dc9" class="le lf iq nl b gy np nq l nr ns"># Defining additional NaN identifiers.<br/>missing_values = ['na','--','?','-','None','none','non']</span><span id="54ca" class="le lf iq nl b gy oq nq l nr ns"># Then we read the data into pandas data frames.<br/>movies_df = pd.read_csv(movies_data, na_values=missing_values)<br/>ratings_df = pd.read_csv(ratings_data, na_values=missing_values)</span></pre><p id="bdda" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们看看每个数据框的形状和前几行</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="0a63" class="le lf iq nl b gy np nq l nr ns">print('Movies_df Shape:',movies_df.shape)<br/>movies_df.head()</span></pre><p id="d963" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">用于评级_df </strong></p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi or"><img src="../Images/2f6ec9e7dbcc6bf943ddecc27ccd6b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BkzqE4Xq6r2PFVZsk50d8w.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">显示ratings_df的形状和前5个观察值</figcaption></figure><p id="0489" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">对于电影_df </strong></p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi os"><img src="../Images/b70ce8d0e3534d94872000814703ffd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vpYcKwAWnXrJSQk0deJMRA.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">展示电影的形状和前5个观察结果_df</figcaption></figure><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ot"><img src="../Images/4cc247d09758f85d25c901a9ee418b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJJjpCHMNVyfM3UIJZyYcw.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">解剖熊猫数据框，礼貌:-熊猫食谱。</figcaption></figure><h1 id="4356" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">数据清理和预处理:</h1><p id="c217" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated"><strong class="jy ja"> movies_df数据集:</strong></p><p id="c58b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们使用pandas的便捷的<a class="ae mh" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.extract.html#pandas.Series.str.extract" rel="noopener ugc nofollow" target="_blank"> <em class="ld">提取</em> </a>功能，将年份从标题列中移除，放入它自己的列中。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="f6e7" class="le lf iq nl b gy np nq l nr ns">#Using regular expressions to find a year stored between parentheses<br/>#We specify the parentheses so we don't conflict with movies that have years in their titles.</span><span id="5002" class="le lf iq nl b gy oq nq l nr ns">movies_df['year'] = movies_df.title.str.extract('(\(\d\d\d\d\))',expand=False)</span><span id="a29b" class="le lf iq nl b gy oq nq l nr ns">#Removing the parentheses.<br/>movies_df['year'] = movies_df.year.str.extract('(\d\d\d\d)',expand=False)</span><span id="8754" class="le lf iq nl b gy oq nq l nr ns"># Note that expand=False simply means do not add this adjustment as an additional column to the data frame.</span><span id="20e9" class="le lf iq nl b gy oq nq l nr ns">#Removing the years from the 'title' column.<br/>movies_df['title'] = movies_df.title.str.replace('(\(\d\d\d\d\))', '')</span><span id="be9a" class="le lf iq nl b gy oq nq l nr ns">#Applying the strip function to get rid of any ending white space characters that may have appeared, using lambda function.</span><span id="e3f4" class="le lf iq nl b gy oq nq l nr ns">movies_df['title'] = movies_df['title'].apply(lambda x: x.strip())</span></pre><p id="cbe2" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我们来看看结果吧！</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ou"><img src="../Images/41d6815c47d37a0b72c322323db0ba09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLC6KWk3uAzLWteP-G8hIw.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">年份现在是一个独特的列。</figcaption></figure><p id="ba4a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">为了方便起见，让我们将<strong class="jy ja">流派</strong>列中的值拆分成一个<strong class="jy ja">流派列表</strong>。使用Python的拆分字符串函数。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="2e24" class="le lf iq nl b gy np nq l nr ns">#Every genre is separated by a | so we simply have to call the split function on |.</span><span id="f7df" class="le lf iq nl b gy oq nq l nr ns">movies_df['genres'] = movies_df.genres.str.split('|')<br/>movies_df.head()</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ov"><img src="../Images/1b2ed5ee95a8bcc1b57c64a4d99e789b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNYUZ4tne0Yx-S7WpruV4w.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">将熊猫系列拆分成一个字符串列表。</figcaption></figure><p id="12f3" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们来查看数据摘要，</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="fd37" class="le lf iq nl b gy np nq l nr ns">movies_df.info()<br/>&gt;&gt;</span><span id="3c02" class="le lf iq nl b gy oq nq l nr ns">&lt;class 'pandas.core.frame.DataFrame'&gt; <br/>RangeIndex: 9742 entries, 0 to 9741                              Data columns (total 4 columns):                               movieId    9742 non-null int64                                  title      9742 non-null object                                genres     9742 non-null object                                  year       9729 non-null object                               dtypes: int64(1), object(3) memory usage: 304.5+ KB</span></pre><p id="5985" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们检查缺失的值</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="a73f" class="le lf iq nl b gy np nq l nr ns">movies_df.isna().sum()<br/>&gt;&gt;</span><span id="c3c6" class="le lf iq nl b gy oq nq l nr ns">movieId     0 <br/>title       0 <br/>genres      0 <br/>year       13 <br/>dtype: int64</span></pre><p id="6e4f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">year列中只有13个缺失值，让我们用零(0)填充它们，并将year列从object type转换为<em class="ld"> int </em>。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="ff32" class="le lf iq nl b gy np nq l nr ns"># Filling year NaN values with zeros.<br/>movies_df.year.fillna(0, inplace=True)</span><span id="796a" class="le lf iq nl b gy oq nq l nr ns"># Converting columns year from obj to int16 and movieId from int64 to int32 to save memory.</span><span id="38f1" class="le lf iq nl b gy oq nq l nr ns">movies_df.year = movies_df.year.astype('int16')<br/>movies_df.movieId = movies_df.movieId.astype('int32')</span></pre><p id="3472" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们再次查看数据类型的汇总。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="e313" class="le lf iq nl b gy np nq l nr ns"># Checking the data types.<br/>movies_df.dtypes<br/>&gt;&gt;</span><span id="399b" class="le lf iq nl b gy oq nq l nr ns">movieId      int32 <br/>title      object <br/>genres     object <br/>year         int16 <br/>dtype: object</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ow"><img src="../Images/740acef64ac646eaab2a719e5d722a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYeaCrHwFIwTVNCHLmzxAA.jpeg"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">数据预处理… |来源:<a class="ae mh" href="http://www.datapreparator.com/_Media/kddpicture-3.jpeg" rel="noopener ugc nofollow" target="_blank"> <em class="nj"> img_credit </em> </a></figcaption></figure><p id="ed81" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在，让我们将<a class="ae mh" href="https://hackernoon.com/what-is-one-hot-encoding-why-and-when-do-you-have-to-use-it-e3c6186d008f" rel="noopener ugc nofollow" target="_blank"><strong class="jy ja"><em class="ld"/></strong></a>这几个流派一一编码。这种编码是输入分类数据所必需的。我们在包含1或0的列中存储每个不同的流派。1表示电影有那种类型，0表示没有。让我们将这个数据框存储在另一个变量中，以防我们在某个时候需要没有流派的数据框。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="ae20" class="le lf iq nl b gy np nq l nr ns"># First let's make a copy of the movies_df.<br/>movies_with_genres = movies_df.copy(deep=True)</span><span id="8021" class="le lf iq nl b gy oq nq l nr ns"># Let's iterate through movies_df, then append the movie genres as columns of 1s or 0s.<br/># 1 if that column contains movies in the genre at the present index and 0 if not.</span><span id="3bf8" class="le lf iq nl b gy oq nq l nr ns">x = []<br/>for index, row in movies_df.iterrows():<br/>    x.append(index)<br/>    for genre in row['genres']:<br/>        movies_with_genres.at[index, genre] = 1</span><span id="1207" class="le lf iq nl b gy oq nq l nr ns"># Confirm that every row has been iterated and acted upon.<br/>print(len(x) == len(movies_df))</span><span id="b74c" class="le lf iq nl b gy oq nq l nr ns">movies_with_genres.head(3)</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ox"><img src="../Images/74f6fa21112f691804cd6b39ce28856e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_vT9Uf9kH8LrMZkKu0P0A.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">显示电影类型栏的输出。如果电影类型存在，每个索引填充1，否则填充NaN。</figcaption></figure><p id="9687" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们简单地用零填充NaNs，以表明一部电影不属于该列的类型。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="6461" class="le lf iq nl b gy np nq l nr ns">#Filling in the NaN values with 0 to show that a movie doesn't have that column's genre.<br/>movies_with_genres = movies_with_genres.fillna(0)<br/>movies_with_genres.head(3)</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ox"><img src="../Images/cba0b7a42f75971e3a1ab4ecb0aaccd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyTsl3wus_hySesXdLYe8A.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">用1或0填充的电影类型列。</figcaption></figure><p id="49d7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">评分_df数据集:</strong></p><p id="22a6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们再次查看前5行。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="d4a1" class="le lf iq nl b gy np nq l nr ns"># print out the shape and first five rows of ratings data.<br/>print('Ratings_df shape:',ratings_df.shape)          ratings_df.head()</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi or"><img src="../Images/2f6ec9e7dbcc6bf943ddecc27ccd6b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BkzqE4Xq6r2PFVZsk50d8w.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">收视率数据集的前五个观察值。</figcaption></figure><p id="849f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">分级数据框中的每一行都有一个与至少一个电影Id相关联的用户Id、一个分级和显示他们何时观看它的时间戳。我们不需要时间戳，所以为了节省内存，我们放弃它。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="0b0b" class="le lf iq nl b gy np nq l nr ns"># Dropping the timestamp column<br/>ratings_df.drop('timestamp', axis=1, inplace=True)</span><span id="5676" class="le lf iq nl b gy oq nq l nr ns"># Confirming the drop<br/>ratings_df.head(3)</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/6536d0a31875cc95bb627462a4228e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*07gX-J7pnhPcLg7_HS2fDQ.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">没有时间戳列的ratings_df。</figcaption></figure><p id="bc08" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们确认评级数据集中的每一列都存在正确的数据类型</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="cc3a" class="le lf iq nl b gy np nq l nr ns"># Let's confirm the right data types exist per column in ratings data_set</span><span id="6334" class="le lf iq nl b gy oq nq l nr ns">ratings_df.dtypes<br/>&gt;&gt;<br/>userId       int64 <br/>movieId      int64 <br/>rating     float64 <br/>dtype: object</span><span id="4636" class="le lf iq nl b gy oq nq l nr ns"># All data types are correct.</span></pre><p id="017d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们检查丢失的值，</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="095d" class="le lf iq nl b gy np nq l nr ns"># Let's check for missing values</span><span id="a44a" class="le lf iq nl b gy oq nq l nr ns">ratings_df.isna().sum()<br/>&gt;&gt;<br/>userId     0 <br/>movieId    0 <br/>rating     0 <br/>dtype: int64</span><span id="2903" class="le lf iq nl b gy oq nq l nr ns"># No missing values</span></pre><p id="97a0" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">数据清理和预处理已经完成！让我们开始构建…</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi oz"><img src="../Images/deca9f21df80f1425dbba63b0ae04db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2sroFtPdoTC7B7zC6MhsA.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated"><a class="ae mh" href="https://sigmoidal.io/wp-content/uploads/2017/09/Recommendation-systems.jpg" rel="noopener ugc nofollow" target="_blank"> img_credit </a></figcaption></figure><h1 id="3dac" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">基于内容的推荐系统；</h1><p id="4f69" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated">让我们实现一个基于内容或条目的推荐系统。我们会根据用户看过的电影和对电影的评价，找出用户喜欢的电影类型。</p><p id="192d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们从创建一个推荐电影的输入用户开始。用户的名字将会是<strong class="jy ja">劳伦斯<em class="ld">。</em> </strong></p><p id="3bd6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">注意:</strong>请随意在下面的词典列表中添加或删除电影！一定要用大写字母写，如果一部电影以“The”开头，比如“复仇者联盟”，那么就像这样写:“复仇者联盟，The”。</p><blockquote class="mn mo mp"><p id="3250" class="jw jx ld jy b jz ka kb kc kd ke kf kg mq ki kj kk mr km kn ko ms kq kr ks kt ij bi translated">如果您添加的电影不在这里，那么它可能不在原始的<br/> movies_df中，或者它的拼写可能不同，请检查大小写。</p></blockquote><p id="233b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">步骤1 </strong>:创建<em class="ld">劳伦斯的个人资料</em></p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="54e2" class="le lf iq nl b gy np nq l nr ns"># so on a scale of 0 to 5, with 0 min and 5 max, see Lawrence's movie ratings below.<br/>Lawrence_movie_ratings = [<br/>            {'title':'Predator', 'rating':4.9},<br/>            {'title':'Final Destination', 'rating':4.9},<br/>            {'title':'Mission Impossible', 'rating':4},<br/>            {'title':"Beverly Hills Cop", 'rating':3},<br/>            {'title':'Exorcist, The', 'rating':4.8},<br/>            {'title':'Waiting to Exhale', 'rating':3.9},<br/>            {'title':'Avengers, The', 'rating':4.5},<br/>            {'title':'Omen, The', 'rating':5.0}<br/>         ] <br/>Lawrence_movie_ratings = pd.DataFrame(Lawrence_movie_ratings)<br/>Lawrence_movie_ratings</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/56ce171ea7001a05710a11e70206c7dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*-G7QAdvWmR6ZQCZbYxP4Hg.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">劳伦斯看过并评价过的电影精选。</figcaption></figure><p id="dc98" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们从上面的movies_df数据帧中提取电影Id，将电影Id添加到Lawrence_movie_ratings中。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="d996" class="le lf iq nl b gy np nq l nr ns"># Extracting movie Ids from movies_df and updating lawrence_movie_ratings with movie Ids.</span><span id="beec" class="le lf iq nl b gy oq nq l nr ns">Lawrence_movie_Id = movies_df[movies_df['title'].isin(Lawrence_movie_ratings['title'])]</span><span id="a19b" class="le lf iq nl b gy oq nq l nr ns"># Merging Lawrence movie Id and ratings into the lawrence_movie_ratings data frame. <br/># This action implicitly merges both data frames by the title column.</span><span id="1bd7" class="le lf iq nl b gy oq nq l nr ns">Lawrence_movie_ratings = pd.merge(Lawrence_movie_Id, Lawrence_movie_ratings)</span><span id="d8ee" class="le lf iq nl b gy oq nq l nr ns"># Display the merged and updated data frame.</span><span id="dbbf" class="le lf iq nl b gy oq nq l nr ns">Lawrence_movie_ratings</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi pb"><img src="../Images/07219ef0032f74b4e74dbc9fe8c233db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKaty-y5hS1qSKO-Z7XtpA.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">将电影id添加到电影选择中。</figcaption></figure><p id="4295" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">步骤1的最后一步是删除不相关的列</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="f9db" class="le lf iq nl b gy np nq l nr ns">#Dropping information we don't need such as year and genres<br/>Lawrence_movie_ratings = Lawrence_movie_ratings.drop(['genres','year'], 1)</span><span id="550a" class="le lf iq nl b gy oq nq l nr ns"># Final profile for Lawrence<br/>Lawrence_movie_ratings</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/df242c5ade2806f9ccae863db3477a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*XGuSK0LX2JAjqKsepKJrkQ.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">劳伦斯电影评级的最终看法。</figcaption></figure><p id="9d92" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">第二步</strong> : <em class="ld">学习劳伦斯的简介</em></p><p id="24a8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们从包含具有二进制值的类型的movies _ with _ genres数据帧中获得Lawrence已经评级的电影的子集。我们姑且称这个子集为劳伦斯_流派_df。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="fbd2" class="le lf iq nl b gy np nq l nr ns"># filter the selection by outputing movies that exist in both Lawrence_movie_ratings and movies_with_genres.</span><span id="3a51" class="le lf iq nl b gy oq nq l nr ns">Lawrence_genres_df = movies_with_genres[movies_with_genres.movieId.isin(Lawrence_movie_ratings.movieId)]</span><span id="3c2e" class="le lf iq nl b gy oq nq l nr ns">Lawrence_genres_df</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi pd"><img src="../Images/f3eab3d9b16d5628d59e8a81286f3bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHRNcnmAJfJfrv9ELU4f1A.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">Lawrence _ genres _ df显示他已评级的电影类型</figcaption></figure><p id="8bee" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们稍微清理一下Lawrence _ genres _ df，重置索引，删除我们不需要的列。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="9499" class="le lf iq nl b gy np nq l nr ns"># First, let's reset index to default and drop the existing index.<br/>Lawrence_genres_df.reset_index(drop=True, inplace=True)</span><span id="5cd4" class="le lf iq nl b gy oq nq l nr ns"># Next, let's drop redundant columns<br/>Lawrence_genres_df.drop(['movieId','title','genres','year'], axis=1, inplace=True)</span><span id="d439" class="le lf iq nl b gy oq nq l nr ns"># Let's view changes</span><span id="b6d9" class="le lf iq nl b gy oq nq l nr ns">Lawrence_genres_df</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ox"><img src="../Images/7ff5d5a4a667e2a8748cc8f4bf74e2ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EYmQ6uXn7trSV75jeMhs-Q.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">更新后的Lawrence _ genres _ df仅包含电影类型和1或0，表示电影是否属于该类型。</figcaption></figure><p id="ba4c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">第三步</strong>:建立劳伦斯的个人资料</p><p id="c836" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">要做到这一点，我们要把每个流派变成权重，通过劳伦斯_流派_df表的转置乘以劳伦斯的电影评级。然后按列对结果表求和。这个操作实际上是一个矩阵和一个向量之间的<a class="ae mh" href="https://stattrek.com/matrix-algebra/vector-multiplication.aspx?Tutorial=matrix" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">点积。</em> </strong> </a></p><p id="316d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">首先，让我们确认一下我们最近定义的数据框的形状。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="2cfa" class="le lf iq nl b gy np nq l nr ns"># let's confirm the shapes of our data frames to guide us as we do matrix multiplication.</span><span id="510a" class="le lf iq nl b gy oq nq l nr ns">print('Shape of Lawrence_movie_ratings is:',Lawrence_movie_ratings.shape)<br/>print('Shape of Lawrence_genres_df is:',Lawrence_genres_df.shape)<br/>&gt;&gt;<br/>Shape of Lawrence_movie_ratings is: (9, 3) Shape of Lawrence_genres_df is: (9, 20)</span></pre><p id="7e3b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">配置文件本身…</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="5743" class="le lf iq nl b gy np nq l nr ns"># Let's find the dot product of transpose of Lawrence_genres_df by Lawrence rating column.<br/>Lawrence_profile = Lawrence_genres_df.T.dot(Lawrence_movie_ratings.rating)</span><span id="3431" class="le lf iq nl b gy oq nq l nr ns"># Let's see the result<br/>Lawrence_profile</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/2291eb8088c89872a2d37080a96617dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*-Z48Kdt0nLzDehfDtjRN0A.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">劳伦斯的完整个人资料，显示他的电影类型偏好。</figcaption></figure><p id="f44e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">仅仅从他的简介就可以看出，劳伦斯最喜欢“惊悚片”、“动作片”和“恐怖片”。</p><h1 id="523b" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">最终输出:</h1><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi pf"><img src="../Images/c90b87fa60aacf7badce6799454360f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOdTfnVjcvMdZfstpjIZHQ.jpeg"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">部署基于内容的推荐系统。</figcaption></figure><p id="4602" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">第四步</strong> : <em class="ld">部署基于内容的推荐系统</em>。</p><p id="3ccb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在，我们有了他所有偏好的权重。这就是所谓的<strong class="jy ja">用户档案</strong>。我们现在可以推荐符合劳伦斯档案的电影。</p><p id="febb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们首先编辑包含所有电影及其流派列的原始movies _ with _ genres数据框。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="ce7e" class="le lf iq nl b gy np nq l nr ns"># let's set the index to the movieId.<br/>movies_with_genres = movies_with_genres.set_index(movies_with_genres.movieId)</span><span id="5424" class="le lf iq nl b gy oq nq l nr ns"># let's view the head.<br/>movies_with_genres.head()</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ox"><img src="../Images/6b1b45f41edd5267deda549d1de618f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-xGRhGZepkfQHuWIc6-iMQ.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">让我们再清理一下…</figcaption></figure><p id="1bc5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们从包含所有9742部电影和不同类型列的movies _ with _ genres数据框中删除不相关的列。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="b571" class="le lf iq nl b gy np nq l nr ns"># Deleting four unnecessary columns.<br/>movies_with_genres.drop(['movieId','title','genres','year'], axis=1, inplace=True)</span><span id="bdb2" class="le lf iq nl b gy oq nq l nr ns"># Viewing changes.<br/>movies_with_genres.head()</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ox"><img src="../Images/d6c33747202d776cb4e39a351eca5376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wpZSAVzFZH39XKpayLf8Cw.png"/></div></div></figure><p id="e1fe" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">有了劳伦斯的简介和电影及其流派的完整列表，我们将定义一个<strong class="jy ja">推荐表</strong>。根据他的个人资料对每部电影进行加权平均，并推荐符合他偏好的前二十部电影…</p><p id="4c5d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这或多或少是Lawrence_profile的movies _ with _ genres数据帧的点积除以Lawrence_profile的总和。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="4cbd" class="le lf iq nl b gy np nq l nr ns"># Multiply the genres by the weights and then take the weighted average.<br/>recommendation_table_df = (movies_with_genres.dot(Lawrence_profile)) / Lawrence_profile.sum()</span></pre><p id="1f33" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们按降序排列推荐_表_df。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="bc43" class="le lf iq nl b gy np nq l nr ns"># Let's sort values from great to small<br/>recommendation_table_df.sort_values(ascending=False, inplace=True)</span><span id="6338" class="le lf iq nl b gy oq nq l nr ns">#Just a peek at the values<br/>recommendation_table_df.head()</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/e9b83278623007c9a35cf727d7e79dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*zmHVpSioQTXO5NbDYqmCDg.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">显示劳伦斯的前20部电影id/分级的推荐表</figcaption></figure><p id="7d8d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在下面是推荐表！按照与劳伦斯的档案匹配的偏好降序排列的前20部电影的电影细节和类型。</p><pre class="mu mv mw mx gt nk nl nm nn aw no bi"><span id="a824" class="le lf iq nl b gy np nq l nr ns"># first we make a copy of the original movies_df<br/>copy = movies_df.copy(deep=True)</span><span id="5fd9" class="le lf iq nl b gy oq nq l nr ns"># Then we set its index to movieId<br/>copy = copy.set_index('movieId', drop=True)</span><span id="08f9" class="le lf iq nl b gy oq nq l nr ns"># Next we enlist the top 20 recommended movieIds we defined above<br/>top_20_index = recommendation_table_df.index[:20].tolist()</span><span id="1cb0" class="le lf iq nl b gy oq nq l nr ns"># finally we slice these indices from the copied movies df and save in a variable<br/>recommended_movies = copy.loc[top_20_index, :]</span><span id="eb0e" class="le lf iq nl b gy oq nq l nr ns"># Now we can display the top 20 movies in descending order of preference<br/>recommended_movies</span></pre><figure class="mu mv mw mx gt my gh gi paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="gh gi ph"><img src="../Images/5ee217fbab3ddf0dea55f10d5501f69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kdzl7P_LqSl2BNBnMzlVmw.png"/></div></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">劳伦斯的前20部电影，基于他的个人资料，喜好和评分。</figcaption></figure><h1 id="978a" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">利弊:</h1><p id="7285" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated">赞成的意见</p><ul class=""><li id="9318" class="lw lx iq jy b jz ka kd ke kh pi kl pj kp pk kt md me mf mg bi translated">了解用户的偏好</li><li id="b45b" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated">高度个性化的用户</li></ul><p id="bd89" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">骗局</p><ul class=""><li id="1377" class="lw lx iq jy b jz ka kd ke kh pi kl pj kp pk kt md me mf mg bi translated">没有考虑到其他人对商品的看法，因此可能会出现低质量的商品推荐</li><li id="be48" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated">提取数据并不总是直观的</li><li id="2888" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated">确定用户不喜欢或喜欢项目的什么特征并不总是显而易见的</li><li id="c55c" class="lw lx iq jy b jz mi kd mj kh mk kl ml kp mm kt md me mf mg bi translated">没有新的电影类型会被推荐给用户，除非用户评价或表明他/她对该类型的偏好。</li></ul><p id="aabf" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><a class="ae mh" href="https://courses.cognitiveclass.ai/courses/course-v1:CognitiveClass+ML0101ENv3+2018/courseware/c6143d9ff5764057a91e53fa8a3a6dff/00c2cd249d94403688ae979661e8eebf/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">参见此处链接</em> </strong> </a></p><h1 id="abf8" class="nt lf iq bd lg nu nv nw lj nx ny nz lm oa ob oc lp od oe of ls og oh oi lv oj bi translated">总结:</h1><p id="f093" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated">感谢您耐心阅读这篇文章。我希望你已经学会了一两件事…学习最好是通过做，请随意在Github的  这里浏览<a class="ae mh" href="https://github.com/Lawrence-Krukrubo/Building-a-Content-Based-Movie-Recommender-System/blob/master/building_a_content_based_recommendation_system.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> <em class="ld">笔记本，并在下面发表评论或观察。</em></strong></a></p><p id="7a6b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">如需进一步学习，请查看IBM<a class="ae mh" href="https://cognitiveclass.ai/badges/machine-learning-python/" rel="noopener ugc nofollow" target="_blank"><strong class="jy ja"><em class="ld">cognitive class . ai</em></strong>T5】的免费课程</a></p><p id="230b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">干杯！</strong></p><h2 id="8052" class="le lf iq bd lg lh li dn lj lk ll dp lm kh ln lo lp kl lq lr ls kp lt lu lv iw bi translated">关于我:</h2><p id="2a6d" class="pw-post-body-paragraph jw jx iq jy b jz ly kb kc kd lz kf kg kh ok kj kk kl ol kn ko kp om kr ks kt ij bi translated">劳伦斯是技术层的数据专家，对公平和可解释的人工智能和数据科学充满热情。我持有IBM的 <strong class="jy ja"> <em class="ld">数据科学专业</em> </strong> <em class="ld">和</em> <strong class="jy ja"> <em class="ld">高级数据科学专业</em> </strong> <em class="ld">证书。我已经使用ML和DL库进行了几个项目，我喜欢尽可能多地编写函数代码，即使现有的库比比皆是。最后，我从未停止学习和实验，是的，我拥有几个数据科学和人工智能认证，并且我已经写了几篇强烈推荐的文章。</em></p><p id="2aed" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">请随时在以下网址找到我</p><p id="31dd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><a class="ae mh" href="https://github.com/Lawrence-Krukrubo" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> Github </strong> </a></p><p id="f239" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><a class="ae mh" href="https://www.linkedin.com/in/lawrencekrukrubo/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja">领英</strong> </a></p><p id="4257" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><a class="ae mh" href="https://twitter.com/LKrukrubo" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja">推特</strong> </a></p></div></div>    
</body>
</html>