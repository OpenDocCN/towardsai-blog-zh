<html>
<head>
<title>Statistical Forecasting for Time Series Data Part 6: Forecasting Non-Stationary Time Series using ARIMA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列数据的统计预测第6部分:用ARIMA预测非平稳时间序列</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/statistical-forecasting-for-time-series-data-part-6-forecasting-non-stationary-time-series-using-9acc28c39db9?source=collection_archive---------1-----------------------#2020-12-25">https://pub.towardsai.net/statistical-forecasting-for-time-series-data-part-6-forecasting-non-stationary-time-series-using-9acc28c39db9?source=collection_archive---------1-----------------------#2020-12-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="396d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/0fe04eb1817695d82f7aa8988142cbcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L_hsV4S74YvoqIZ6"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">照片由<a class="ae kl" href="https://unsplash.com/@chrisliverani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·利维拉尼</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="eea4" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这一系列文章中，标准普尔500市场指数使用流行的统计模型进行分析:<strong class="ko ja"> SARIMA </strong>(季节性自回归综合移动平均线)，和<strong class="ko ja"> GARCH </strong>(广义自回归条件异方差)。</p><p id="1a29" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在第一部分中，该系列从python中的<code class="fe lk ll lm ln b">yfinance</code> API中废弃。它被清理并用于导出<strong class="ko ja"> S &amp; P 500收益</strong>(连续价格的百分比变化)和<strong class="ko ja">波动率</strong>(收益的大小)。在第二部分中，使用了一些时间序列探索技术来从数据中获得关于趋势、季节性、平稳性等特征的见解。有了这些认识，第三和第四部分介绍了SARIMA和GARCH类模型。在第五部分中，两个模型(SARIMA和GARCH)结合起来生成有意义的预测，并对未来数据得出准确的见解。所有这些部分的链接都在本文的末尾。</p><p id="1c84" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这最后一部分中，介绍了使用SARIMA模型类对非平稳数据建模的技术。本文中使用的代码来自这个<a class="ae kl" href="https://github.com/yashveersinghsohi/Statistical_Modeling_for_Time_Series_Forecasting" rel="noopener ugc nofollow" target="_blank">资源库</a>中的<strong class="ko ja">Prices Models/ARMA Model for SPX Prices . ipynb</strong>笔记本</p><h1 id="5c44" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">目录</h1><ol class=""><li id="b78d" class="mm mn iq ko b kp mo kt mp kx mq lb mr lf ms lj mt mu mv mw bi translated">导入数据</li><li id="b3d4" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">列车测试分离</li><li id="8f66" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">标准普尔500价格的平稳性</li><li id="0831" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">将标准普尔500价格转换为平稳序列</li><li id="1e2d" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">对转换后的序列建模</li><li id="1efd" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">用ARMA模型预测标准普尔500价格</li><li id="9d33" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">评估预测</li><li id="c1c8" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">结论</li><li id="b70e" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">链接到本系列的其他部分</li><li id="a235" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">参考</li></ol></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="334d" class="lo lp iq bd lq lr nj lt lu lv nk lx ly lz nl mb mc md nm mf mg mh nn mj mk ml bi translated">导入数据</h1><p id="78e4" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">这里，我们导入在本系列的第1部分中被废弃和预处理的数据集。参考第1部分准备好数据，或者从这个<a class="ae kl" href="https://github.com/yashveersinghsohi/Statistical_Modeling_for_Time_Series_Forecasting" rel="noopener ugc nofollow" target="_blank">库</a>下载<strong class="ko ja"> data.csv </strong>文件。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">从本系列的第1部分导入标准包和预处理数据集的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/e8ada2238edf6ec641c1f7d8a8cdb4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*Hs8ScyWxMhgqIkXjJIyQFQ.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">显示数据集前5行的前一个代码单元格的输出</figcaption></figure><p id="ff18" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">因为这与本系列前面部分中使用的代码相同，所以为了简洁起见，这里不再详细解释每一行。</p><h1 id="4da9" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">列车测试分离</h1><p id="43fc" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">像以前一样，我们现在将数据分成训练测试集。这里所有来自<code class="fe lk ll lm ln b">2019–01–01</code>的观测值构成了测试集，之前的所有观测值就是训练集。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">将数据分成训练集和测试集的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/1b832eb52c1ff3c20c710c687c274511.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*3tDWhR-cwVwh5dheM28IEg.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">显示训练集和测试集形状的前一个代码单元的输出</figcaption></figure><h1 id="dfc5" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">标准普尔500价格的平稳性</h1><p id="1adf" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">在拟合ARIMA系列的任何模型之前，应该检查输入序列的平稳性。这是因为在一个平稳序列中，产生数据的基本过程(ARIMA试图模拟的过程)在未来不会改变。因此，该模型将有一个合理的机会成功与稳定的数据。</p><p id="d7ae" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要检查系列是否稳定，可使用以下3种方法:</p><ul class=""><li id="9fb8" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated">使用折线图检查数据是否没有明显的趋势(汇总统计数据不随时间变化)。</li><li id="fe2c" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">使用ACF和PACF图检查该图与其自身滞后版本的相关性。</li><li id="75d4" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">检查ADF(增强的Dickey Fuller)测试的结果。零假设表明序列是非平稳的。如果返回的p值大于所有的临界水平，则不能拒绝零假设，序列不是平稳的。(本系列的第2部分提供了更深入的描述。)</li></ul><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">检验标准普尔500价格的平稳性</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi od"><img src="../Images/aca5affc6ded59bbb2c2fe1fb9f8e24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vb7Ckg5BXiLIt_AlvHBCMQ.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">标准普尔500价格的相关图、线图和ADF测试结果</figcaption></figure><p id="c3de" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">相关图和线图显示了该系列中的明显趋势。此外，ADF检验的p值大于所有的临界水平，因此该序列是非平稳的。</p><h1 id="d8a1" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">将标准普尔500价格转换为平稳序列</h1><p id="3d6d" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">有许多技术可用于将非平稳序列转换为平稳序列。以下两条可能是最常见的:</p><ul class=""><li id="e9da" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated"><strong class="ko ja">差异:</strong>在这里，这个数列与它自身的滞后版本有差异。在这种转换中，通常会删除序列的趋势部分。</li><li id="6fa4" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><strong class="ko ja">对数变换:</strong>这里计算系列的对数。在这种变换中，级数的规模减小了，变化也减弱了。</li></ul><p id="4cb6" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这种情况下，使用另一种常见的方法，即结合上述两种方法:<strong class="ko ja">对数差分变换</strong>。在这种情况下，首先计算序列的对数，然后将该序列与其自身的滞后版本进行差分(这里，滞后是1个时间段)。</p><p id="8e04" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这种方法的数学公式是:</p><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/c8f52ab76324eb4c51f63052852a5cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*mG4uMN7vd08YGLefpYNspw.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">上述变换的数学公式</figcaption></figure><p id="474e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">执行此操作的代码如下:</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">执行对数差变换的代码</figcaption></figure><p id="38aa" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这个新系列的平稳性可以用检验原来系列的同样方法来检验。<code class="fe lk ll lm ln b">train_df[“spx”]</code>系列将被<code class="fe lk ll lm ln b">train_df[“spx_log_diff”]</code>系列取代。其余代码可以与S &amp; P 500价格部分的<strong class="ko ja">平稳性中的代码相同。</strong></p><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi od"><img src="../Images/dcd9becc60048e1c1178e7b4e7265e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcQrB854FQD6A8gEOw2w3w.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">转换后的标准普尔500价格的相关图、线图和ADF测试结果</figcaption></figure><p id="211e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">相关图和线图表明该序列是平稳的(没有任何明显的趋势)。ADF检验的p值进一步证明该序列是平稳的。</p><h1 id="44db" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">对转换后的序列建模</h1><p id="123d" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">由于序列是平稳的，我们可以使用ARIMA模型的非整合变量:AR、MA或ARMA。在这种情况下，选择ARMA。ARMA的参数用<strong class="ko ja"> ARMA(p，q) </strong>表示:</p><ul class=""><li id="d201" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated"><strong class="ko ja"> p: </strong>控制过去滞后的影响(通过统计<strong class="ko ja"> PACF </strong>图中的显著滞后来估计)</li><li id="f8cc" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><strong class="ko ja">问:</strong>控制过去残差的影响(通过计算<strong class="ko ja"> ACF </strong>图中的显著滞后来估计)</li></ul><p id="b8db" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">查看上一节的ACF和PACF图，这些参数的初始估计值可以是:<code class="fe lk ll lm ln b">p=1</code>或<code class="fe lk ll lm ln b">p=2</code>，以及，<code class="fe lk ll lm ln b">q=1</code>或<code class="fe lk ll lm ln b">q=2</code>。让我们考虑最简单的模型:<strong class="ko ja"> ARMA(1，1) </strong>。</p><p id="589e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">以下代码单元用于构建ARMA(1，1)模型:</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">变换标准普尔500价格的ARMA(1，1)模型拟合</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi of"><img src="../Images/af5ac36655da832604e5e2baa200936e.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*S9r1FlN0dVpC8do8BUoWlQ.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">上面训练的ARMA(1，1)模型的汇总表。</figcaption></figure><p id="49bf" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe lk ll lm ln b">SARIMAX()</code>函数用于定义ARMA(1，1)模型，方法是将转换后的S &amp; P 500价格序列和适当的订单作为参数进行传递。使用模型定义上的<code class="fe lk ll lm ln b">fit()</code>方法训练模型。使用<code class="fe lk ll lm ln b">summary()</code>方法在装配模型上显示汇总表。</p><p id="f3a7" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">汇总表的<strong class="ko ja"> P &lt; |Z| </strong>栏显示该模型的所有系数都是显著的。接下来，该模型用于为转换后的序列生成预测，然后为原始价格序列生成预测。</p><h1 id="4b16" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">用ARMA模型预测标准普尔500价格</h1><p id="00c0" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">为了预测标准普尔500价格，之前构建的ARMA(1，1)模型将用于预测转换后的(对数差分)标准普尔500价格值。然后对预测值(和置信区间)进行反向转换，以获得标准普尔500价格所需的值。</p><p id="8a46" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">参考上面提到的变换方程，我们可以使用下面的数学方程导出逆变换:</p><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c6938863d3f0eab97401f09d4764684f.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*IiSGV9qagWAmD6JIGee_bg.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">对标准普尔500价格进行对数差分转换的逆转换</figcaption></figure><p id="0ab5" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">获得标准普尔500价格预测的代码如下:</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">根据ARMA(1，1)模型构建标准普尔500价格预测的代码</figcaption></figure><ul class=""><li id="120e" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated">首先，定义一个数据框架(<code class="fe lk ll lm ln b">pred_df</code>)，它存储了推导标准普尔500价格预测所需的所有重要序列。</li><li id="a535" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">接下来，将<code class="fe lk ll lm ln b">spx</code>系列和该系列的滞后版本存储在数据帧中。滞后为1个时间周期。这两个系列代表上图公式中的<code class="fe lk ll lm ln b">y(t)</code>和<code class="fe lk ll lm ln b">y(t-1)</code>系列。</li><li id="9509" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">现在，使用<code class="fe lk ll lm ln b">predict()</code>方法生成模型预测，在拟合的模型上指定<code class="fe lk ll lm ln b">start</code>和<code class="fe lk ll lm ln b">end</code>日期。同样，这些预测的置信区间是使用<code class="fe lk ll lm ln b">conf_int()</code>方法在<code class="fe lk ll lm ln b">get_forecast()</code>函数的输出上生成的。这些系列代表<code class="fe lk ll lm ln b">y_new(t)</code>系列和上式中该系列的置信区间。</li><li id="58e6" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">指数函数用于这些预测及其置信区间，以便从上面的公式生成<code class="fe lk ll lm ln b">exp(y_new(t))</code>序列。</li><li id="a5ab" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">最后将滞后的<code class="fe lk ll lm ln b">spx</code>值(<code class="fe lk ll lm ln b">y(t-1)</code>)和之前生成的<code class="fe lk ll lm ln b">exp(y_new(t))</code>序列相乘，得到期望的预测:<code class="fe lk ll lm ln b">y(t)</code>。</li></ul><h1 id="524a" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">评估预测</h1><p id="e1fb" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">有两种方法可以评估先前生成的预测:</p><ul class=""><li id="1ce9" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated">预测值和实际值的折线图</li><li id="e57e" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">计算均方根误差(RMSE)度量</li></ul><p id="72a3" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">生成折线图和RMSE指标的代码如下所示:</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">计算RMSE和绘制ARMA(1，1)模型预测的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oh"><img src="../Images/7c59bc8f0433442b85cda721507682af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vaETHaFCHFpH3l5R5w47rQ.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">ARMA(1，1)模型生成的标准普尔500预测值与实际值的曲线图</figcaption></figure><p id="181e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，使用<code class="fe lk ll lm ln b">sklearn.metrics</code>中的<code class="fe lk ll lm ln b">mean_squared_error()</code>函数计算RMSE度量。然后，预测值(蓝色)与标准普尔500指数的实际价格(红色)相对照，并标上置信区间(绿色)。</p><h1 id="1666" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">结论</h1><p id="01de" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">在这一系列文章中，我们使用统计时间序列预测模型(如SARIMA和GARCH)对标准普尔500市场指数进行了分析和建模。本系列文章首先介绍了获取此类数据的方法，并对其进行了探索以便更好地理解。接下来，介绍了几个统计模型并应用于这些数据。使用这些模型，我们能够预测未来值以及与这些预测相关的误差幅度。</p><h1 id="1991" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">链接到本系列的其他部分</h1><ul class=""><li id="a6f7" class="mm mn iq ko b kp mo kt mp kx mq lb mr lf ms lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-modeling-of-time-series-data-part-1-data-preparation-and-preprocessing-b52f26f6213c" rel="noopener">时间序列数据的统计建模第一部分:预处理</a></li><li id="cede" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-modeling-of-time-series-data-part-2-exploratory-data-analysis-5c3aaedc04b7" rel="noopener">时间序列数据的统计建模第二部分:探索性数据分析</a></li><li id="be2b" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-modeling-of-time-series-data-part-3-forecasting-stationary-time-series-using-sarima-f0ff1284bebb" rel="noopener">时间序列数据的统计建模第三部分:利用SARIMA预测平稳时间序列</a></li><li id="48d7" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-forecasting-of-time-series-data-part-4-forecasting-volatility-using-garch-1e9ff832f7e5" rel="noopener">时间序列数据的统计建模第4部分:利用GARCH预测波动率</a></li><li id="2944" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-forecasting-for-time-series-data-part-5-arma-garch-model-for-time-series-forecasting-98beeedcfba8" rel="noopener">时间序列数据的统计建模第5部分:时间序列预测的ARMA+GARCH模型。</a></li><li id="02f3" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">时间序列数据的统计建模第六部分:用ARMA预测非平稳时间序列</li></ul><h1 id="b1c7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">参考</h1><p id="1a1f" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">[1]<a class="ae kl" href="https://365datascience.com/courses/time-series-analysis-in-python/" rel="noopener ugc nofollow" target="_blank">365数据科学</a>时间序列分析课程</p><p id="de85" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[2]<a class="ae kl" href="https://machinelearningmastery.com/time-series-forecasting/" rel="noopener ugc nofollow" target="_blank">machine learning mastery</a>关于时序分析的博客</p><p id="4346" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[3] <a class="ae kl" href="https://en.wikipedia.org/wiki/Autoregressive_conditional_heteroskedasticity" rel="noopener ugc nofollow" target="_blank">维基百科</a>关于GARCH的文章</p><p id="8876" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">GARCH模型上的YouTube视频。</p><p id="f2ce" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[5] <a class="ae kl" href="https://www.youtube.com/watch?v=JntA9XaTebs" rel="noopener ugc nofollow" target="_blank"> Tamara Louie:应用统计建模&amp;机器学习进行时间序列预测</a></p><p id="11d6" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">罗布·J·海曼和乔治·阿萨纳索普洛斯的《预测:原则与实践》</p><p id="f592" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[7] <a class="ae kl" href="https://www.analyticsvidhya.com/blog/2018/09/non-stationary-time-series-python/" rel="noopener ugc nofollow" target="_blank">用Python处理非平稳时间序列的温和介绍</a>来自Analytics Vidhya</p></div></div>    
</body>
</html>