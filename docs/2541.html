<html>
<head>
<title>Feature Transformation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征转换</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/feature-transformation-3306c7ac9dd5?source=collection_archive---------0-----------------------#2022-02-08">https://pub.towardsai.net/feature-transformation-3306c7ac9dd5?source=collection_archive---------0-----------------------#2022-02-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="aab3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak">根据数据，何时使用哪个特征转换。</strong></h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/469fc0ec53812ccdb866753c3579f79a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwxyFTY_qkva6rZZCWkfCg.jpeg"/></div></div></figure><p id="aa5e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">机器学习模型的生命周期可以分为以下几个步骤。</p><ol class=""><li id="0e4b" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">数据收集</li><li id="e1cf" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">数据预处理</li><li id="f898" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">特征工程</li><li id="a53d" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">特征选择</li><li id="ca70" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">模型结构</li><li id="b4cf" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">超参数调谐</li><li id="a09b" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">模型部署</li></ol><p id="af8e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了建立一个模型，我们必须预处理数据。特征转换是这一过程中最重要的任务之一。在数据集中，大部分时间都会有不同量级的数据。因此，为了使我们的预测更好，我们必须将不同的特征缩小到相同的震级范围或一些特定的数据分布。因为大多数算法将给予具有高容量的特征更多的重要性，而不是给予所有特征相同的重要性。这将导致错误的预测和错误的模型，我们不希望这样。</p><h1 id="eaca" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated"><strong class="ak">何时使用特征变换</strong></h1><ol class=""><li id="3e3b" class="ln lo iq kt b ku mt kx mu la mv le mw li mx lm ls lt lu lv bi translated">在K-最近邻、SVM和K-均值等基于距离的算法中，它们会赋予值大的要素更大的权重，因为距离是通过数据点的值计算的，以找出它们之间的相似性。如果我们给算法输入未缩放的特征，预测将会受到严重影响。</li><li id="a784" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">因为我们缩小了功能，所以计算的范围也将缩小，花费在计算上的时间也将减少。因此模型训练更快。</li><li id="7881" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">在基于梯度下降优化的线性回归和逻辑回归等算法中，特征缩放变得至关重要，因为如果我们输入不同大小的数据，将很难收敛到全局最小值。对于相同范围的值，算法学习的负担变得更小。</li></ol><h1 id="95d7" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated"><strong class="ak">何时不使用特征变换</strong></h1><p id="3bba" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">大多数集成方法不需要特征缩放，因为即使我们执行特征变换，分布的深度也不会改变太多。所以在这样的算法中，除非特别需要，否则不需要缩放。</p><h2 id="9839" class="nb mc iq bd md nc nd dn mh ne nf dp ml la ng nh mn le ni nj mp li nk nl mr nm bi translated">特征变换的方法有很多种，我们将讨论最有用和最流行的方法。</h2><ol class=""><li id="98ee" class="ln lo iq kt b ku mt kx mu la mv le mw li mx lm ls lt lu lv bi translated">标准化</li><li id="4590" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">最小-最大缩放/标准化</li><li id="81c8" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">鲁棒定标器</li><li id="7fe9" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">对数变换</li><li id="af20" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">相互转化</li><li id="2fcf" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">平方根平移</li><li id="4a54" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">博克斯-考克斯变换</li><li id="f3b8" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">约翰逊变换</li></ol><h1 id="930d" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated"><strong class="ak"> 1。标准化</strong></h1><p id="c158" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">当输入数据集的要素在范围之间存在较大差异，或者使用不同的测量单位(如身高、体重、米、英里等)进行测量时，应使用标准化。</p><p id="9844" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将所有的变量或特征放在一个相似的尺度上。其中平均值为0，标准偏差为1。</p><p id="7065" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在标准化中，我们用平均值减去特征值，然后除以标准偏差，这就精确地给出了标准正态分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/65bf92022ba686d51eb0028f1eaf6d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j6OzIO9rp1kJ3QqN"/></div></div></figure><h1 id="a167" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated"><strong class="ak"> 2。最小—最大缩放/标准化</strong></h1><p id="8a7f" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">简单来说，最小-最大缩放将特征值降低到0到1的范围内。直到我们指定了我们想要缩小的范围。</p><p id="ee1a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在归一化中，我们将特征值减去其最小值，然后除以特征的范围(特征的范围=特征的最大值-特征的最小值)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/b11d25250da661c500823d32d5103ea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/0*VMPqdwzK4Ub_-9k3"/></div></figure><h1 id="ef70" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated"><strong class="ak"> 3。鲁棒定标器</strong></h1><p id="c008" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">如果数据集有太多的异常值，标准化和规范化都很难实现，在这种情况下，您可以使用鲁棒的缩放器进行要素缩放。</p><p id="b3f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你也可以说鲁棒定标器对异常值是鲁棒的😂。</p><p id="4ae7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它使用中位数和四分位数范围来缩放值，因此不会受到非常大或非常小的要素值的影响。</p><p id="98e4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">鲁棒缩放器通过中值减去特征值，然后除以其IQR。</p><ul class=""><li id="07ed" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm np lt lu lv bi translated">第25个百分位数=第1个四分位数</li><li id="5a0b" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm np lt lu lv bi translated">第50百分位=第二个四分位(也称为中位数)</li><li id="ef7f" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm np lt lu lv bi translated">第75个百分位数=第3个四分位数</li><li id="6c57" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm np lt lu lv bi translated">第100个百分位数=第4个四分位数(也称为最大值)</li><li id="e8af" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm np lt lu lv bi translated">IQR=四分位数间距</li><li id="d564" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm np lt lu lv bi translated">IQR=第三个四分位数—第一个四分位数</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/8eb729e58261db60bf82f16a58e03140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6LA3GPU4ll7BxPd5"/></div></div></figure><h1 id="95e0" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">4.高斯变换</h1><p id="cb29" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">一些机器学习算法，如线性和逻辑回归，假设我们提供给它们的数据是正态分布的。如果数据是正态分布的，这种算法往往表现更好，并给出更高的准确性。标准化一个偏斜的分布在这里成为一个重要的部分。</p><p id="c216" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但大多数情况下，数据会有偏差，因此您必须使用以下算法将其转换为高斯分布，在选择方法之前，您可能需要尝试几种方法，因为不同的数据集往往有不同的要求，我们无法让一种方法适用于所有数据。</p><p id="5904" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文的其余部分，我们将使用这个函数来绘制数据。我将只使用titanic数据集中的年龄特征来绘制直方图和QQ图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/9902a8b0e33c860ebc861b3403fea98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzCalriDyB6GgjDTBrhqzQ.jpeg"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/3498db428c962dfd654b6fff87c9c64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0M8jG8Ujrzbn7m57w9xng.jpeg"/></div></div></figure><p id="8362" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">图表下方是特征缩放前的年龄特征</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b8102cf509794d5b1978c0d5183d278d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*tLTuz_vkE0Yn9R1wBTdQhA.jpeg"/></div></figure><h1 id="a8a1" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">A.对数变换</h1><p id="fe27" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">在对数变换中，我们将使用NumPy对所有要素值应用log，并将其存储在新要素中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/373fe864a4a1cdaf20030f663987ddec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*QErX6WchiyN4miBqmHr0nw.jpeg"/></div></figure><p id="e10b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用对数变换似乎不太适合这个数据集，它甚至会使数据向左倾斜，从而恶化分布。所以我们不得不依靠其他方法来实现正态分布。</p><h1 id="f44c" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">B.相互转化</h1><p id="ef92" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">在倒数变换中，我们将一个特性的每个值除以1(倒数)，并将其存储在新特性中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/dad3717509207a99e7075e5a0f058222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*juVBvIMC0Re8z8jWTXUp_g.jpeg"/></div></figure><p id="b856" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">倒数变换不适用于这种数据，它不能给出正态分布，反而使数据更加右偏。</p><h1 id="2c86" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">C.平方根平移</h1><p id="bdd7" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">在平方根变换中，我们将特征值提升到分数的幂(1/2)以获得某个值的平方根。我们也可以使用NumPy进行这种转换。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/7e48fe253f4f267542f81f21894a183a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWyR94EkQXhF1Xat8myiFg.jpeg"/></div></div></figure><p id="6850" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于这种数据，平方根转换似乎比倒数和对数转换执行得更好，但它有点向左倾斜。</p><h1 id="cbcc" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">D.博克斯-考克斯变换</h1><p id="8c69" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">Box-Cox变换是将数据分布转换为正态分布的最有用的缩放技术之一。</p><p id="18e5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Box-Cox变换可以定义为:</p><p id="5818" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">t(Y)=(Y exp(λ)-1)/λ</p><p id="3bad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">其中Y是响应变量，λ是转换参数。λ从-5到5不等。在变换中，考虑λ的所有值，并选择给定变量的最佳值。</p><p id="ceda" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以使用来自SciPy模块的统计数据来计算box cox变换。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/2d1cc66f4bb6d09f031649375b86c3d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*41LEGLeS_sb7LJT8C6Yaqg.jpeg"/></div></div></figure><p id="1337" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">到目前为止，box cox变换似乎是最适合年龄特征的变换。</p><h1 id="9c08" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结论</h1><p id="4ca0" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la my lc ld le mz lg lh li na lk ll lm ij bi translated">还有其他方法可以用来获得高斯分布，但大多数情况下，这些方法中的一种似乎很适合数据集。</p></div></div>    
</body>
</html>