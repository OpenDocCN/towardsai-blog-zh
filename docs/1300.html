<html>
<head>
<title>Time-Series Forecasting: Predicting Stock Prices Using An LSTM Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测:使用LSTM模型预测股票价格</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/time-series-forecasting-predicting-stock-prices-using-an-lstm-model-e10c3f62ac8a?source=collection_archive---------2-----------------------#2020-12-25">https://pub.towardsai.net/time-series-forecasting-predicting-stock-prices-using-an-lstm-model-e10c3f62ac8a?source=collection_archive---------2-----------------------#2020-12-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3455" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="98d1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在这篇文章中，我将向你展示如何使用预测LSTM模型来预测股票价格</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/e43e11f17a02503f2b03097befd1fcbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGz5qx3EefIG7CJ4mfZBOg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者创作的人物。</figcaption></figure><h1 id="eb08" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">1.介绍</h1><h2 id="5f31" class="lz li it bd lj ma mb dn ln mc md dp lr me mf mg lt mh mi mj lv mk ml mm lx iz bi translated">1.1.时间序列和预测模型</h2><p id="dfb2" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated">传统上大多数机器学习(ML)模型使用一些观察值(样本/例子)，但是数据中没有<strong class="mp jd">时间</strong> <strong class="mp jd">维度</strong>。</p><p id="f306" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">时间序列预测</strong>模型是能够根据<strong class="mp jd">先前</strong> <strong class="mp jd">观测</strong> <strong class="mp jd">值</strong>预测 <strong class="mp jd">未来值</strong>的模型。时间序列预测广泛用于<strong class="mp jd">非平稳数据</strong>。<strong class="mp jd">非平稳数据</strong>被称为其统计属性(例如，平均值和标准偏差)不随时间保持不变，而是随时间变化的数据。</p><p id="0d02" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">这些非平稳输入数据(用作这些模型的输入)通常被称为<strong class="mp jd">时间序列。一些时间序列的例子包括随时间变化的温度值、随时间变化的股票价格、随时间变化的房屋价格等。因此，输入是一个由在时间</strong>上连续获得的观察值定义的<strong class="mp jd">信号</strong>(时间序列)<strong class="mp jd">。</strong></p><blockquote class="nl"><p id="1b1c" class="nm nn it bd no np nq nr ns nt nu nf dk translated">时间序列是按时间顺序进行的一系列观察。</p></blockquote><figure class="nw nx ny nz oa kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/c1f817b09e401ba3c29023c4fddd2e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SULcaLxjHsAVmhxG7Xo0cA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">时间序列的一个例子。作者用Python创作了这个情节。</figcaption></figure><p id="24f6" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">观察:时序</strong>数据记录在<strong class="mp jd">离散</strong>时间<strong class="mp jd">时间</strong>刻度<strong class="mp jd">刻度</strong>上。</p><p id="431d" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">免责声明</strong>(在我们继续之前):已经有人尝试使用时间序列分析算法来预测股票价格，尽管它们仍然不能用于在真实市场中下注。这只是一篇教程文章，不包括以任何方式“指导”人们购买股票的意图。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="7f88" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">如果你想在交互式路线图和活跃的学习社区的支持下自学数据科学，看看这个资源:<a class="ae oi" href="https://aigents.co/learn" rel="noopener ugc nofollow" target="_blank">https://aigents.co/learn</a></p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="b22d" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">2.LSTM模式</h1><p id="5d9c" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated"><strong class="mp jd">长短期记忆</strong> ( <strong class="mp jd"> LSTM </strong>)是一种用于深度学习领域的人工递归神经网络(RNN)架构。与标准的前馈神经网络不同，LSTM有反馈连接。它不仅可以处理单个数据点(例如图像)，还可以处理整个数据序列(例如语音或视频输入)。</p><p id="a068" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd"> LSTM型号</strong>能够储存一段时间的信息。</p><blockquote class="nl"><p id="9048" class="nm nn it bd no np nq nr ns nt nu nf dk translated">换句话说，它们有记忆能力。记住LSTM代表长短期记忆模型。</p></blockquote><p id="0d5b" class="pw-post-body-paragraph mn mo it mp b mq oo kd ms mt op kg mv me oq mx my mh or na nb mk os nd ne nf im bi translated">当我们处理时间序列或顺序数据时，这个特性是非常有用的。当使用LSTM模型时，我们可以自由地决定存储什么信息，丢弃什么信息。我们用“门”来做这件事对LSTM的深入了解超出了这篇文章的范围，但是如果你有兴趣了解更多，可以看看这篇文章末尾的参考资料。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="19d3" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">3.获取股票价格历史数据</h1><p id="6c9a" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated">感谢<strong class="mp jd">雅虎财经，</strong>我们可以免费<strong class="mp jd">获得</strong>的数据。使用以下链接获取<strong class="mp jd">特斯拉</strong>的股价历史记录:<a class="ae oi" href="https://finance.yahoo.com/quote/TSLA/history?period1=1436486400&amp;period2=1594339200&amp;interval=1d&amp;filter=history&amp;frequency=1d" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/TSLA/history?周期1=1436486400 &amp;周期2=1594339200 &amp;间隔=1d &amp;过滤器=历史&amp;频率=1d </a></p><p id="fde0" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">您应该看到以下内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/22b7285dc102e7cfce06bd36a9656f65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ClLXfFKG6zL3RsZI1jrZaw.png"/></div></div></figure><p id="5df7" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">点击<strong class="mp jd">下载</strong>并保存<strong class="mp jd">。csv </strong>文件本地保存在您的计算机上。</p><p id="0fc3" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">数据是从<strong class="mp jd"> 2015 </strong>到现在(<strong class="mp jd"> 2020 </strong>)！</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="3ea1" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">4.Python工作示例</h1><p id="c79f" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated"><em class="ou">所需模块:Keras、Tensorflow、Pandas、Scikit-Learn &amp; Numpy </em></p><p id="c5e8" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">我们将构建一个<strong class="mp jd">多层LSTM递归神经网络</strong>来<strong class="mp jd">预测</strong>一系列值中的<strong class="mp jd">最后一个值，</strong>即本例中的特斯拉股票价格。</p><p id="4ae6" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">让<strong class="mp jd">加载</strong>和<strong class="mp jd">数据</strong>和<strong class="mp jd">检查</strong>它们:</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="a100" class="lz li it ow b gy pa pb l pc pd">import math<br/>import matplotlib.pyplot as plt<br/>import keras<br/>import pandas as pd<br/>import numpy as np<br/>from keras.models import Sequential<br/>from keras.layers import Dense<br/>from keras.layers import LSTM<br/>from keras.layers import Dropout<br/>from keras.layers import *<br/>from sklearn.preprocessing import MinMaxScaler<br/>from sklearn.metrics import mean_squared_error<br/>from sklearn.metrics import mean_absolute_error<br/>from sklearn.model_selection import train_test_split<br/>from keras.callbacks import EarlyStopping</span><span id="f3f6" class="lz li it ow b gy pe pb l pc pd">df=pd.read_csv("TSLA.csv")<br/>print(‘Number of rows and columns:’, df.shape)<br/>df.head(5)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/4c487bb125bc10e7aa9146a34010388b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fB29WXKDO6Y8zSsj87OTBg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">上面代码的输出</figcaption></figure><p id="7ee4" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">下一步是<strong class="mp jd">将</strong>数据分割成<strong class="mp jd">训练</strong>和<strong class="mp jd">测试</strong>集合，以避免<strong class="mp jd">过度拟合</strong>，并能够调查我们模型的泛化能力。要了解有关过度拟合的更多信息，请阅读本文:</p><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/is-your-model-overfitting-or-maybe-underfitting-an-example-using-a-neural-network-in-python-4faf155398d2" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">你的模型是否过拟合？或者不合身？python中使用神经网络的示例</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">过拟合，欠拟合，泛化能力，交叉验证。一切都简单解释了。我还提供了一个…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com。</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px lb pj"/></div></div></a></div><p id="b2e5" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">要预测的目标值将是“<strong class="mp jd">收盘时</strong>的股价值。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="a015" class="lz li it ow b gy pa pb l pc pd">training_set = df.iloc[:800, 1:2].values<br/>test_set = df.iloc[800:, 1:2].values</span></pre><p id="be54" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">在<strong class="mp jd">模型</strong> <strong class="mp jd">拟合</strong>之前，<strong class="mp jd">归一化</strong>数据不失为一个好主意。这将提高性能。您可以在此阅读更多关于<strong class="mp jd">最小-最大缩放器</strong>的信息:</p><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">关于Python中的最小-最大规范化，您需要知道的一切</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我解释了什么是最小-最大缩放，何时使用它，以及如何使用scikit-learn在Python中实现它</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="py l pu pv pw ps px lb pj"/></div></div></a></div><p id="c310" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">让我们以1天的时间<strong class="mp jd">滞后(滞后1)构建输入要素:</strong></p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="ae88" class="lz li it ow b gy pa pb l pc pd"># Feature Scaling<br/>sc = MinMaxScaler(feature_range = (0, 1))<br/>training_set_scaled = sc.fit_transform(training_set)</span><span id="91b1" class="lz li it ow b gy pe pb l pc pd"># Creating a data structure with 60 time-steps and 1 output<br/>X_train = []<br/>y_train = []<br/>for i in range(60, 800):<br/>    X_train.append(training_set_scaled[i-60:i, 0])<br/>    y_train.append(training_set_scaled[i, 0])<br/>X_train, y_train = np.array(X_train), np.array(y_train)</span><span id="cc50" class="lz li it ow b gy pe pb l pc pd">X_train = np.reshape(X_train, (X_train.shape[0], X_train.shape[1], 1))<br/>#(740, 60, 1)</span></pre><p id="7de1" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">现在<strong class="mp jd">我们已经将</strong>数据整形为以下格式(#值、#时间步长、#1维输出)。</p><p id="814e" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">现在，该建立模型了。</strong>我们将建立有50个神经元的<strong class="mp jd"> LSTM </strong>和<strong class="mp jd"> 4个隐含层</strong>。最后，我们将在输出层分配1个神经元用于预测标准化的股票价格。我们将使用MSE损失函数和Adam随机梯度下降优化器。</p><p id="f674" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">注意</strong>:以下需要一些时间(~ 5分钟)。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="cc8a" class="lz li it ow b gy pa pb l pc pd">model = Sequential()</span><span id="c205" class="lz li it ow b gy pe pb l pc pd">#Adding the first LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50, return_sequences = True, input_shape = (X_train.shape[1], 1)))<br/>model.add(Dropout(0.2))</span><span id="657b" class="lz li it ow b gy pe pb l pc pd"># Adding a second LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50, return_sequences = True))<br/>model.add(Dropout(0.2))</span><span id="8c4d" class="lz li it ow b gy pe pb l pc pd"># Adding a third LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50, return_sequences = True))<br/>model.add(Dropout(0.2))</span><span id="1881" class="lz li it ow b gy pe pb l pc pd"># Adding a fourth LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50))<br/>model.add(Dropout(0.2))</span><span id="591c" class="lz li it ow b gy pe pb l pc pd"># Adding the output layer<br/>model.add(Dense(units = 1))</span><span id="b840" class="lz li it ow b gy pe pb l pc pd"># Compiling the RNN<br/>model.compile(optimizer = 'adam', loss = 'mean_squared_error')</span><span id="d504" class="lz li it ow b gy pe pb l pc pd"># Fitting the RNN to the Training set<br/>model.fit(X_train, y_train, epochs = 100, batch_size = 32)</span></pre><p id="f916" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">装配完成后，您应该会看到类似这样的内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pz"><img src="../Images/218d1f71cde6c0e43f7d1e4880b8e190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fmQ6ePlJjvRoRAJCFGDbew.png"/></div></div></figure><p id="3cec" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">准备测试数据(重塑它们):</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="2538" class="lz li it ow b gy pa pb l pc pd"># Getting the predicted stock price of 2017<br/>dataset_train = df.iloc[:800, 1:2]<br/>dataset_test = df.iloc[800:, 1:2]</span><span id="68d5" class="lz li it ow b gy pe pb l pc pd">dataset_total = pd.concat((dataset_train, dataset_test), axis = 0)</span><span id="ba78" class="lz li it ow b gy pe pb l pc pd">inputs = dataset_total[len(dataset_total) - len(dataset_test) - 60:].values</span><span id="f7be" class="lz li it ow b gy pe pb l pc pd">inputs = inputs.reshape(-1,1)<br/>inputs = sc.transform(inputs)<br/>X_test = []<br/>for i in range(60, 519):<br/>    X_test.append(inputs[i-60:i, 0])<br/>X_test = np.array(X_test)<br/>X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))</span><span id="56ee" class="lz li it ow b gy pe pb l pc pd">print(X_test.shape)<br/># (459, 60, 1)</span></pre><p id="878a" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">使用测试集进行预测。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="8572" class="lz li it ow b gy pa pb l pc pd">predicted_stock_price = model.predict(X_test)<br/>predicted_stock_price = sc.inverse_transform(predicted_stock_price)</span></pre><p id="b50f" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">现在让我们来看看结果:</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="4bed" class="lz li it ow b gy pa pb l pc pd"># Visualising the results<br/>plt.plot(df.loc[800:, ‘Date’],dataset_test.values, color = ‘red’, label = ‘Real TESLA Stock Price’)<br/>plt.plot(df.loc[800:, ‘Date’],predicted_stock_price, color = ‘blue’, label = ‘Predicted TESLA Stock Price’)<br/>plt.xticks(np.arange(0,459,50))<br/>plt.title('TESLA Stock Price Prediction')<br/>plt.xlabel('Time')<br/>plt.ylabel('TESLA Stock Price')<br/>plt.legend()<br/>plt.show()</span></pre><h1 id="9b94" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">5.结果</h1><p id="6003" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated"><strong class="mp jd">使用滞后1(即一天的步长):</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qa"><img src="../Images/85a0e09f82c534473e2d091aade3843f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-NC8uK5gEoq4ZN_iM9xlw.png"/></div></div></figure><p id="67d8" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">观察</strong>:2020年3月因新冠肺炎封锁而大幅下跌！</p><p id="9a37" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">我们可以清楚地看到，我们的模型表现得非常好。它能够精确地跟随大多数不可接受的跳跃/下落；但是，对于最近的日期戳，我们可以看到，与股票价格的实际值相比，模型预期(预测)的值较低。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="197e" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">关于滞后的一个注记</h1><p id="ef15" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated"><strong class="mp jd">本文中最初选择的延迟为1，即使用1天的步长</strong>。这可以通过修改构建3D输入的代码来轻松改变。</p><p id="76cc" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">示例</strong>:可以更改以下两个代码块:</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="b359" class="lz li it ow b gy pa pb l pc pd">X_train = []<br/>y_train = []<br/>for i in range(60, 800):<br/>    X_train.append(training_set_scaled[i-60:i, 0])<br/>    y_train.append(training_set_scaled[i, 0])</span></pre><p id="af26" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">和</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="8348" class="lz li it ow b gy pa pb l pc pd">X_test = []<br/>y_test = []<br/>for i in range(60, 519):<br/>    X_test.append(inputs[i-60:i, 0])<br/>X_test = np.array(X_test)<br/>X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))</span></pre><p id="79f2" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">采用以下新代码:</strong></p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="cac8" class="lz li it ow b gy pa pb l pc pd">X_train = []<br/>y_train = []<br/>for i in range(60, 800):<br/>    X_train.append(training_set_scaled[i-50:i, 0])<br/>    y_train.append(training_set_scaled[i, 0])</span></pre><p id="dc81" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated"><strong class="mp jd">和</strong></p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="bf72" class="lz li it ow b gy pa pb l pc pd">X_test = []<br/>y_test = []<br/>for i in range(60, 519):<br/>    X_test.append(inputs[i-50:i, 0])<br/>X_test = np.array(X_test)<br/>X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))</span></pre><p id="d01f" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">在这种情况下，结果如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qb"><img src="../Images/81b609fced950d8bf3553aa8b258f7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywlBzNk1gQUj2JVsLJO2Gw.png"/></div></div></figure></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="412d" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">就这些了，伙计们！我希望你喜欢这篇文章！</p><h2 id="3fab" class="lz li it bd lj ma mb dn ln mc md dp lr me mf mg lt mh mi mj lv mk ml mm lx iz bi translated">看看我在另一篇文章中用来预测谷歌股价的脸书先知模型。</h2><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">时间序列预测:用脸书的先知模型预测股票价格</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">使用可从《先知脸书》公开获得的预测模型预测股票价格</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qc l pu pv pw ps px lb pj"/></div></div></a></div><h2 id="2788" class="lz li it bd lj ma mb dn ln mc md dp lr me mf mg lt mh mi mj lv mk ml mm lx iz bi translated">也可以看看我最近用ARIMA模型写的文章:</h2><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-an-arima-model-2e3b3080bd70" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">时间序列预测:使用ARIMA模型预测股票价格</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我将向你展示如何使用预测ARIMA模型来预测特斯拉的股票价格</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qd l pu pv pw ps px lb pj"/></div></div></a></div></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="8779" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">参考</h1><p id="04f2" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated">[1]<a class="ae oi" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p><p id="0758" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">[2]https://en.wikipedia.org/wiki/Long_short-term_memory<a class="ae oi" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="d4cf" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">敬请关注并支持这一努力</h1><p id="db8b" class="pw-post-body-paragraph mn mo it mp b mq mr kd ms mt mu kg mv me mw mx my mh mz na nb mk nc nd ne nf im bi translated">如果你喜欢这篇文章并且觉得它有用，<strong class="mp jd">关注</strong>我就可以看到我所有的新帖子。</p><p id="032c" class="pw-post-body-paragraph mn mo it mp b mq ng kd ms mt nh kg mv me ni mx my mh nj na nb mk nk nd ne nf im bi translated">有问题吗？把它们作为评论贴出来，我会尽快回复。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="98d4" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">最新帖子</h1><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">时间序列预测:用脸书的先知模型预测股票价格</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">使用可从《先知脸书》公开获得的预测模型预测股票价格</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qc l pu pv pw ps px lb pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://medium.com/@seralouk/the-best-free-data-science-resources-free-books-online-courses-9c4a2df194e5" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">最佳免费数据科学资源:免费书籍和在线课程</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">最有用的免费书籍和在线课程，适合想了解更多数据科学知识的人。</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">medium.com</p></div></div><div class="ps l"><div class="qe l pu pv pw ps px lb pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/roc-curve-explained-using-a-covid-19-hypothetical-example-binary-multi-class-classification-bab188ea869c" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">用新冠肺炎假设的例子解释ROC曲线:二分类和多分类…</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我清楚地解释了什么是ROC曲线以及如何阅读它。我用一个新冠肺炎的例子来说明我的观点，我…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qf l pu pv pw ps px lb pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/support-vector-machines-svm-clearly-explained-a-python-tutorial-for-classification-problems-29c539f3ad8" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">支持向量机(SVM)解释清楚:分类问题的python教程…</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我解释了支持向量机的核心，为什么以及如何使用它们。此外，我还展示了如何绘制支持…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qg l pu pv pw ps px lb pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/pca-clearly-explained-how-when-why-to-use-it-and-feature-importance-a-guide-in-python-7c274582c37e" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">PCA清楚地解释了——如何、何时、为什么使用它以及特性的重要性:Python指南</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我解释了什么是PCA，何时以及为什么使用它，以及如何使用scikit-learn在Python中实现它。还有…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qh l pu pv pw ps px lb pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">关于Python中的最小-最大规范化，您需要知道的一切</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我解释了什么是最小-最大缩放，何时使用它，以及如何使用scikit-learn在Python中实现它</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="py l pu pv pw ps px lb pj"/></div></div></a></div><div class="pg ph gp gr pi pj"><a href="https://towardsdatascience.com/how-and-why-to-standardize-your-data-996926c2c832" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jd gy z fp po fr fs pp fu fw jc bi translated">Scikit-Learn的标准定标器如何工作</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在这篇文章中，我将解释为什么以及如何使用scikit-learn应用标准化</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="qi l pu pv pw ps px lb pj"/></div></div></a></div></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="7cae" class="lh li it bd lj lk oj lm ln lo ok lq lr ki ol kj lt kl om km lv ko on kp lx ly bi translated">和我联系</h1><ul class=""><li id="45ab" class="qj qk it mp b mq mr mt mu me ql mh qm mk qn nf qo qp qq qr bi translated"><strong class="mp jd">LinkedIn</strong>:<a class="ae oi" href="https://www.linkedin.com/in/serafeim-loukas/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/serafeim-loukas/</a></li><li id="5962" class="qj qk it mp b mq qs mt qt me qu mh qv mk qw nf qo qp qq qr bi translated"><strong class="mp jd">研究之门</strong>:<a class="ae oi" href="https://www.researchgate.net/profile/Serafeim_Loukas" rel="noopener ugc nofollow" target="_blank">https://www.researchgate.net/profile/Serafeim_Loukas</a></li><li id="31d2" class="qj qk it mp b mq qs mt qt me qu mh qv mk qw nf qo qp qq qr bi translated"><strong class="mp jd">https://people.epfl.ch/serafeim.loukas</strong>EPFL<strong class="mp jd">简介</strong> : <a class="ae oi" href="https://people.epfl.ch/serafeim.loukas" rel="noopener ugc nofollow" target="_blank">美国</a></li><li id="2a52" class="qj qk it mp b mq qs mt qt me qu mh qv mk qw nf qo qp qq qr bi translated"><strong class="mp jd">堆栈</strong>溢出<strong class="mp jd">溢出</strong>:<a class="ae oi" href="https://stackoverflow.com/users/5025009/seralouk" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/users/5025009/seralouk</a></li></ul></div></div>    
</body>
</html>