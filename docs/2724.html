<html>
<head>
<title>Duplicate Column Names In Pandas: Updated</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pandas中的重复列名:已更新</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/duplicate-column-names-in-pandas-updated-c1cf80e95e12?source=collection_archive---------2-----------------------#2022-05-02">https://pub.towardsai.net/duplicate-column-names-in-pandas-updated-c1cf80e95e12?source=collection_archive---------2-----------------------#2022-05-02</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="8f15" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">熊猫仍然允许重复的列名，下面是你能做的</h2></div><h1 id="db22" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">概观</h1><p id="a579" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">本文展示了在Pandas中无意中生成一个具有重复列名但没有抛出错误的数据框是多么容易。在同一主题的上一篇文章之后的一次重要更新中，本文提供了两种管理有无重复列名的方法。</p><h1 id="7cb5" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">数据</h1><p id="e11c" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">考虑以下设置。</p><pre class="lx ly lz ma gu mb mc md me aw mf bi"><span id="6a95" class="mg kk iu mc b gz mh mi l mj mk">import pandas as pd</span><span id="d258" class="mg kk iu mc b gz ml mi l mj mk">data = {'first_name':['Adam','Tom','Sue','Pandi'],<br/>        'last_name':['Nelson','Jones','Pak','Sun'],<br/>        'topic_1':[1,2,1,1],<br/>        'topic_2':[2,2,2,1]}</span><span id="0046" class="mg kk iu mc b gz ml mi l mj mk">df = pd.DataFrame(data)</span></pre><p id="8d80" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">生成以下数据:</p><figure class="lx ly lz ma gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj mr"><img src="../Images/21a28c5e871baca8e52384861665cc16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1vG9ezMLF3t87g7lMGH3w.png"/></div></div><figcaption class="mz na gk gi gj nb nc bd b be z dk translated">图片来源:作者使用本文中的代码生成的数据表。</figcaption></figure><p id="d98d" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">然后考虑在无意中创建了重复的列名时，您可能会如何决定更改列名。</p><pre class="lx ly lz ma gu mb mc md me aw mf bi"><span id="7cc7" class="mg kk iu mc b gz mh mi l mj mk">df.rename(columns={'topic_1':'topic', <br/>                   'topic_2':'topic'}, inplace=True)</span><span id="acb3" class="mg kk iu mc b gz ml mi l mj mk">df</span></pre><p id="0ced" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">令人惊讶的是，这里没有错误。你会得到下面的结果。</p><figure class="lx ly lz ma gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj nd"><img src="../Images/9d9e3ab428bde39277e15034c92d6e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u9xLtM1V_MiXgxEb37R_9Q.png"/></div></div><figcaption class="mz na gk gi gj nb nc bd b be z dk translated">图片来源:作者使用本文中的代码生成的数据表</figcaption></figure><p id="ea39" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">这不应该引起错误吗？</p><div class="ne nf gq gs ng nh"><a href="https://www.linkedin.com/posts/arnelson_datascience-advancedanalytics-github-activity-6744422877795229696-BLA7" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fp"><div class="nj ab nk cl cj nl"><h2 class="bd iv gz z fq nm fs ft nn fv fx it bi translated">这个数据科学社区是一个社区:# data science # advanced analytics # GitHub</h2><div class="no l"><h3 class="bd b gz z fq nm fs ft nn fv fx dk translated">有几次我摔坏了熊猫…</h3></div><div class="np l"><p class="bd b dl z fq nm fs ft nn fv fx dk translated">www.linkedin.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv mx nh"/></div></div></a></div><h2 id="d6e4" class="mg kk iu bd kl nw nx dn kp ny nz dp kt lk oa ob kv lo oc od kx ls oe of kz og bi translated">第一个解决方案:不允许重复标签</h2><p id="6d9b" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">在一次实验性更新中，熊猫社区增加了以下功能<code class="fe oh oi oj mc b">.set_flags(allows_duplicate_labels=False)</code>。</p><p id="ea57" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">为了避免破碎的熊猫(如下图所示),防止带有此标志的重复标签。例如:</p><pre class="lx ly lz ma gu mb mc md me aw mf bi"><span id="0cd2" class="mg kk iu mc b gz mh mi l mj mk">import pandas as pd</span><span id="2696" class="mg kk iu mc b gz ml mi l mj mk">data = {'first_name':['Adam','Tom','Sue','Pandi'],<br/>        'last_name':['Nelson','Jones','Pak','Sun'],<br/>         'topic_1':[1,2,1,1],<br/>         'topic_2':[2,2,2,1]}</span><span id="f28c" class="mg kk iu mc b gz ml mi l mj mk">df = pd.DataFrame(data).set_flags(allows_duplicate_labels=False)</span></pre><figure class="lx ly lz ma gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj ok"><img src="../Images/f3e4743fa2e1b76a9b68d58b51ddcb85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DlVaYhC9eSn8X_WudkioIQ.png"/></div></div><figcaption class="mz na gk gi gj nb nc bd b be z dk translated">图片鸣谢:作者。“破熊猫。”图片来源:“Via Design Pickle”——更多关于属性的<a class="ae ol" href="https://adamrossnelson.medium.com/image-credit-attributions-a24efcc730ad" rel="noopener"/>。</figcaption></figure><p id="5a55" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">一旦你设置了<code class="fe oh oi oj mc b">.set_flags(allows_duplicate_labels=False)</code>,下面的代码就会抛出一个错误。</p><pre class="lx ly lz ma gu mb mc md me aw mf bi"><span id="ef1e" class="mg kk iu mc b gz mh mi l mj mk">df.rename(columns={'topic_1':'topic', <br/>                   'topic_2':'topic'}, inplace=True)</span></pre><figure class="lx ly lz ma gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj om"><img src="../Images/fbf734343fcd3d81bf6c4f1b460e1d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_q9HLkOPjFtfrqN8t80ByA.png"/></div></div><figcaption class="mz na gk gi gj nb nc bd b be z dk translated">image Credit:value尝试指定重复的列名后输出错误。</figcaption></figure><p id="f85e" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">当进行依赖于唯一列名的分析时，这个<code class="fe oh oi oj mc b">ValueError: Cannot specify 'inplace=True' when 'self.flags.allows_duplicate_lables' is False</code>消息很有帮助。</p><h2 id="266c" class="mg kk iu bd kl nw nx dn kp ny nz dp kt lk oa ob kv lo oc od kx ls oe of kz og bi translated">第二个解决方案:愚蠢的错误容易解决</h2><p id="ef11" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">当您发现有重复的标签时，最简单的解决方案是从头开始指定一组新的标签。</p><pre class="lx ly lz ma gu mb mc md me aw mf bi"><span id="23c6" class="mg kk iu mc b gz mh mi l mj mk">df.rename(columns={'topic_1':'topic', <br/>                   'topic_2':'topic'}, inplace=True)</span><span id="7ded" class="mg kk iu mc b gz ml mi l mj mk">df.columns</span></pre><figure class="lx ly lz ma gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj on"><img src="../Images/28276f309b718cf82f7bbbbf56e5e58c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6nhdrP1Pc5_07_AVTVMVXw.png"/></div></div><figcaption class="mz na gk gi gj nb nc bd b be z dk translated">Image Credit:作者用本文中的代码生成的输出。</figcaption></figure><pre class="lx ly lz ma gu mb mc md me aw mf bi"><span id="1aa5" class="mg kk iu mc b gz mh mi l mj mk">df.columns = ['first_name', 'last_name',<br/>              'topic_1', 'topic_2']</span></pre><figure class="lx ly lz ma gu ms gi gj paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gi gj on"><img src="../Images/621bfd3b5b6ac92274ddf89c111371b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZpcCgFKR3GOmNA5XClTvnA.png"/></div></div><figcaption class="mz na gk gi gj nb nc bd b be z dk translated">Image Credit:作者用本文中的代码生成的输出。</figcaption></figure><h1 id="75d8" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">了解这些也很有用</h1><p id="c5d2" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">在上面的数据帧中，通常会返回熊猫系列的代码<code class="fe oh oi oj mc b">df['topic']</code>实际上返回了一个数据帧。</p><p id="4c2e" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">您可以使用<code class="fe oh oi oj mc b">df.columns.is_unique</code>和<code class="fe oh oi oj mc b">df.index.is_unique</code>来检测重复的列名。您可以使用<code class="fe oh oi oj mc b">df.index.duplicated()</code>和<code class="fe oh oi oj mc b">df.columns.duplicated()</code>来定位重复的列名(或索引条目)。</p><h1 id="150d" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">结论</h1><p id="8225" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">本文展示了创建具有重复列名的Pandas数据框是多么容易。基于Pandas最近的一个重要更新，本文还展示了两个选项，这两个选项将帮助用户避免由于重复的列名而遇到问题——或者如何解决遇到的问题。</p><div class="ne nf gq gs ng nh"><a href="https://adamrossnelson.medium.com/membership" rel="noopener follow" target="_blank"><div class="ni ab fp"><div class="nj ab nk cl cj nl"><h2 class="bd iv gz z fq nm fs ft nn fv fx it bi translated">加入我的介绍链接媒体-亚当罗斯纳尔逊</h2><div class="no l"><h3 class="bd b gz z fq nm fs ft nn fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="np l"><p class="bd b dl z fq nm fs ft nn fv fx dk translated">adamrossnelson.medium.com</p></div></div><div class="nq l"><div class="oo l ns nt nu nq nv mx nh"/></div></div></a></div><h1 id="c8be" class="kj kk iu bd kl km kn ko kp kq kr ks kt ka ku kb kv kd kw ke kx kg ky kh kz la bi translated">感谢阅读</h1><p id="58de" class="pw-post-body-paragraph lb lc iu ld b le lf jv lg lh li jy lj lk ll lm ln lo lp lq lr ls lt lu lv lw in bi translated">你准备好了解更多关于数据科学职业的信息了吗？我进行一对一的职业辅导，并有一份每周电子邮件列表，帮助专业求职者获取数据。联系我了解更多信息。</p><p id="2e40" class="pw-post-body-paragraph lb lc iu ld b le mm jv lg lh mn jy lj lk mo lm ln lo mp lq lr ls mq lu lv lw in bi translated">把你的想法和主意发给我。你可以写信只是为了说声嗨。如果你真的需要告诉我是怎么错的，我期待着尽快和你聊天。推特:<a class="ae ol" href="https://twitter.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">@ adamrossnelson</a>LinkedIn:<a class="ae ol" href="https://www.linkedin.com/in/arnelson/" rel="noopener ugc nofollow" target="_blank">亚当罗斯尼尔森</a>。</p></div></div>    
</body>
</html>