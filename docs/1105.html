<html>
<head>
<title>Different Approaches to handle categorical values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理分类值的不同方法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/different-approaches-to-handle-categorical-values-a2e35fbd6128?source=collection_archive---------3-----------------------#2020-11-01">https://pub.towardsai.net/different-approaches-to-handle-categorical-values-a2e35fbd6128?source=collection_archive---------3-----------------------#2020-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="151f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="4406" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">特征工程第二部分</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/d6e9bd3bdd376463f698661e75fca15f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A2RKP80iELDYa86I"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@etaplus?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> ETA+ </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="4ff6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated">机器学习是让计算机自己明确学习的艺术。在ML中，我们研究通过经验自动改进的不同类型的算法。在每个机器学习任务中，我们都有一些数据，然后我们应用机器学习算法，并创建一个可以预测新的即将到来的数据的模型。在整个过程中，数据是机器学习模型生命周期中最重要的一部分。数据可以是任何多种形式，并且很有可能我们的数据也没有准备好提供给机器学习算法，为此我们需要执行一些特征工程和数据探索。在我之前的博客中，我解释了处理数据中缺失值的不同方法。</p><p id="8ec3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇博客中，我们将看到机器学习中处理分类数据的不同方法。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="b7dc" class="mu mv it bd mw mx my dn mz na nb dp nc lr nd ne nf lv ng nh ni lz nj nk nl iz bi translated">什么是分类数据？</h2><p id="6658" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">分类数据是一种包含标签值而非数值的变量。这些通常被称为名义。一些例子<br/> -第一、第二、第三<br/> -男性、女性</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="a0bb" class="mu mv it bd mw mx my dn mz na nb dp nc lr nd ne nf lv ng nh ni lz nj nk nl iz bi translated">为什么处理？</h2><p id="10e3" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">这是我们脑海中最常见的问题之一，为什么我们需要处理分类值如果机器学习是如此强大，那么我们为什么要在特征工程上花费大量时间。答案很简单，每个机器学习模型都是基于一些需要数字数据来执行任何类型计算的数学模型。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><blockquote class="nr ns nt"><p id="249b" class="li lj nu lk b ll lm kd ln lo lp kg lq nv ls lt lu nw lw lx ly nx ma mb mc md im bi translated">我们将使用Kaggle上的泰坦尼克号数据集。我们已经对数据进行了预处理，并处理了先前博客<strong class="lk jd"> </strong> <a class="ae lh" href="https://medium.com/towards-artificial-intelligence/9-ways-to-handle-missing-values-in-machine-learning-1bbda345699a" rel="noopener"> <strong class="lk jd">中的所有空值</strong> </a> <strong class="lk jd">，</strong>，因此我们使用的数据不包含任何空值。<br/> <strong class="lk jd">代号:</strong> <a class="ae lh" href="https://github.com/Abhayparashar31/feature-engineering" rel="noopener ugc nofollow" target="_blank"> Github </a></p></blockquote></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="c784" class="mu mv it bd mw mx my dn mz na nb dp nc lr nd ne nf lv ng nh ni lz nj nk nl iz bi translated">编码类型</h2><ol class=""><li id="8c11" class="ny nz it lk b ll nm lo nn lr oa lv ob lz oc md od oe of og bi translated"><strong class="lk jd">名义编码:</strong>当数据没有固有的顺序时<br/> 1.1一个热编码<br/> 1.2一个热编码多特征<br/> 1.3表示编码</li><li id="8159" class="ny nz it lk b ll oh lo oi lr oj lv ok lz ol md od oe of og bi translated"><strong class="lk jd">顺序编码:</strong>当数据有一个固有的顺序时<br/> 2.1标签编码<br/> 2.2目标导向编码</li><li id="9133" class="ny nz it lk b ll oh lo oi lr oj lv ok lz ol md od oe of og bi translated"><strong class="lk jd">计数编码</strong></li></ol></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="5c9f" class="om mv it bd mw on oo op mz oq or os nc ki ot kj nf kl ou km ni ko ov kp nl ow bi translated">1.1-一个热编码</h1><p id="db10" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">在一个热编码中，我们根据它们的类别将所有的数据点转换成0和1。它被用在性、性别、州等栏目中。在python中，我们用<code class="fe ox oy oz pa b">pandas.get_dummies()</code>转换成一键编码<br/> <strong class="lk jd">例子:</strong></p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="47db" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">SEX         One Hot Representation     <br/></strong>Male            1  1<br/>Female          0  0<br/>Female          0  1<br/>Male            1  0</span><span id="9b24" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">COUNTRY     One Hot Representation<br/></strong>India          1 0 0 0<br/>USA            0 1 0 0<br/>UK             0 0 1 0<br/>China          0 0 0 1<br/>USA            0 1 0 0</span></pre><p id="b1d1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">优点<br/> </strong> 1)比其他编码技术更快。<br/> 2)使数据处理速度非常快。</p><p id="eb45" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">缺点<br/> </strong> 1)为大量类别增加维度，导致维度诅咒问题。</p><p id="1d5d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">代码</strong></p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="03ec" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">pd.get_dummies(df['Sex']).head()</strong> <br/>## It will return two columns(female,male)</span><span id="3490" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">pd.get_dummies(df['Sex'],drop_first=True).head()</strong></span><span id="294d" class="mu mv it pa b gy pj pg l ph pi">##<em class="nu">It will only return on column(male, which saves us from linear dependency</em></span></pre><h1 id="4974" class="om mv it bd mw on pk op mz oq pl os nc ki pm kj nf kl pn km ni ko po kp nl ow bi translated">1.2-具有许多分类特征的一个热编码</h1><p id="71ac" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">随着特征数量的增加，列的数量也增加，这导致了维数灾难问题。为了避免这种情况，我们只使用前10或前20个特性，并对它们应用一次性编码。这种方法用于密码、房间号、船舱号等。</p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="b7d3" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">### STEP:1- Find the top 20 most frequent features</strong><br/><br/>top20=[x for x in df['Cabin'].value_counts().sort_values(ascending=False).head(20).index]<br/>print(top20)</span><span id="0d62" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:2- Use Top 20 and apply on the data</strong><br/>import numpy as np<br/>for label in top20:<br/>    df[label]=np.where(df['Cabin']==label,1,0)<br/>df = df.drop("Cabin",axis=1)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/9857c82375b048d1b8743c83fed10117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*erMCW2CznUHxI0SEC0J8QQ.png"/></div></figure><h1 id="1dc4" class="om mv it bd mw on pk op mz oq pl os nc ki pm kj nf kl pn km ni ko po kp nl ow bi translated">1.3-平均编码</h1><p id="34b8" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">在这种类型的编码中，我们用计数的平均值替换所有的分类值。均值编码表示目标变量的概率，取决于特征的每个值。</p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="97ac" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">### STEP:1- Counting Each Feature value respect to length of column<br/></strong>temp=df['Cabin'].value_counts()/len(df['Cabin'])</span><span id="286f" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:2- Converting all the data into a dict<br/></strong>mean_encoding=temp.to_dict()</span><span id="1e83" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:3- Finding the most common 5 or 10 mean values<br/></strong>from collections import Counter<br/>Counter(mean_encoding).most_common(5)</span><span id="3bfc" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:4- Mapping the most common values with the dataframe<br/></strong>df['mean_encoding']=df['Cabin'].map(mean_encoding)<br/>df[['Cabin','mean_encoding']].head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/65346f93bf52476cbc92ba25fe06fc49.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*AeMXQ5gFpnq_nNW_ziiq3g.png"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="675a" class="om mv it bd mw on oo op mz oq or os nc ki ot kj nf kl ou km ni ko ov kp nl ow bi translated">2.1-标签编码</h1><p id="d58e" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">在这种类型的编码中，我们根据类别的重要性和权重，给每一类赋予不同的标签。</p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="1248" class="mu mv it pa b gy pf pg l ph pi">        <strong class="pa jd">Weekday                 Encoding<br/></strong>0        Sunday                   7<br/>1      Saturday                   6     <br/>2        Friday                   5<br/>3      Thursday                   4   <br/>4     Wednesday                   3<br/>5       Tuesday                   2<br/>6        Monday                   1 <br/>7        Sunday                   7<br/>8      Saturday                   6   </span></pre><p id="e8b1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为此，我们首先创建一个编码字典，然后使用map()将字典与数据集进行映射。</p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="d8c2" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">### STEP:1- Creating a dictionary of encoding</strong><br/>dict_map = {'male':1,"female":0}</span><span id="8059" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:2- Mapping dictionary with the columns<br/></strong>df["Sex_num"] = df['Sex'].map(dict_map)<br/>df.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/2475e1d6709f363a7350f3f4b315dca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*6pUVCzifaqGVOcGflgh2WA.png"/></div></figure><h1 id="77c9" class="om mv it bd mw on pk op mz oq pl os nc ki pm kj nf kl pn km ni ko po kp nl ow bi translated">2.2目标导向的顺序编码</h1><p id="e8b4" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">它几乎与均值编码相同，主要区别在于，我们计算的是相对于目标列的计数。</p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="7024" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">### STEP:1- Counting Each Feature value respect to the target column<br/></strong>temp=df.groupby(['Cabin'])['Survived'].mean()</span><span id="d688" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:2- Converting all the data into a dict<br/></strong>encoding=temp.to_dict()</span><span id="2e6d" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:3- Finding the most common 5 or 10 mean values<br/></strong>from collections import Counter<br/>Counter(encoding).most_common(10)</span><span id="5905" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">### STEP:4- Mapping the most common values with the dataframe<br/></strong>df['encoded_cabin']=df['Cabin'].map(encoding)<br/>df[['Cabin','encoded_cabin']].head()</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="15c4" class="om mv it bd mw on oo op mz oq or os nc ki ot kj nf kl ou km ni ko ov kp nl ow bi translated">3)计数编码</h1><p id="d8f2" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">在这种情况下，我们用计数替换分类值。这样做的主要优点是不会产生任何额外的特性，一个主要缺点是，如果频率相同，它将提供相同的权重。</p><pre class="ks kt ku kv gt pb pa pc pd aw pe bi"><span id="68f6" class="mu mv it pa b gy pf pg l ph pi"><strong class="pa jd">#### STEP:1- Find the count of features<br/></strong>count = df["Cabin"].value_counts().to_dict()</span><span id="de4d" class="mu mv it pa b gy pj pg l ph pi"><strong class="pa jd">#### STEP:2- Replace Featues with the count<br/></strong>df["cabin_count"]=df["Cabin"].map(count)<br/>df.head()</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="5108" class="mu mv it bd mw mx my dn mz na nb dp nc lr nd ne nf lv ng nh ni lz nj nk nl iz bi translated">关于作者</h2><p id="26df" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">我是阿沛·帕拉沙尔，一名计算机科学学生，对数据科学和人工智能感兴趣。我写与数据科学、机器学习和人工智能相关的文章。如果你愿意，你可以在Linkedin上联系我。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt ps"><a href="https://medium.com/towards-artificial-intelligence/9-ways-to-handle-missing-values-in-machine-learning-1bbda345699a" rel="noopener follow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd jd gy z fp px fr fs py fu fw jc bi translated">机器学习中处理缺失值的9种方法</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">简单但有效</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">medium.com</p></div></div><div class="qb l"><div class="qc l qd qe qf qb qg lb ps"/></div></div></a></div><div class="qh qi gp gr qj ps"><a href="https://parasharabhay13.medium.com/different-feature-selection-techniques-f47ec43f71b8" rel="noopener follow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd jd gy z fp px fr fs py fu fw jc bi translated">不同的特征选择技术</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">查找建模的最佳特征</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">parasharabhay13.medium.com</p></div></div><div class="qb l"><div class="qk l qd qe qf qb qg lb ps"/></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="debc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">【参考文献】https://www.youtube.com/user/krishnaik06<br/>【1】<a class="ae lh" href="https://www.youtube.com/user/krishnaik06" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>