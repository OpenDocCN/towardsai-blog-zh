<html>
<head>
<title>A Comprehensive Guide to T-Tests in Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel中T测试的综合指南</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/a-comprehensive-guide-to-t-tests-in-excel-b4ecad31319e?source=collection_archive---------2-----------------------#2021-03-21">https://pub.towardsai.net/a-comprehensive-guide-to-t-tests-in-excel-b4ecad31319e?source=collection_archive---------2-----------------------#2021-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6d14" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/statistics" rel="noopener ugc nofollow" target="_blank">统计数据</a></h2><div class=""/><div class=""><h2 id="8138" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">两件事真的不一样吗？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c14152376ca48b5501d84ca755c0f057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4CXzd7D3Kb3HRsF-r__zA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由Geran de Klerk在Unsplash上拍摄；作者编辑</figcaption></figure><blockquote class="le"><p id="db35" class="lf lg iq bd lh li lj lk ll lm ln lo dk translated">=T.TEST(数组1，数组2，tails，type)</p></blockquote><p id="c08e" class="pw-post-body-paragraph lp lq iq lr b ls lt ka lu lv lw kd lx ly lz ma mb mc md me mf mg mh mi mj lo ij bi translated">excel中的t-test函数非常强大。没有操作Python或R所必需的编码，每个人都可以计算出两组数据实际不同的可能性。这个功能为包括我自己的论文和科学发现提供了动力！遗憾的是，很多人仍然不了解t检验，不知道如何使用这个函数，也不知道如何解释函数的结果。</p><p id="bb81" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">通过这篇文章，我们将检查这个函数的每一部分，并让您准备好充分发挥这个函数的潜力。</p><h1 id="4329" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">什么是T检验？</h1><p id="7df9" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">当您有两组数据时，您可以计算这些数据集的平均值。举个例子，假设我们正在测量20个2岁和3岁孩子的体重。并不是所有两岁的孩子和三岁的孩子都一样重。因此，如果我们计算两组的平均值，我们需要知道平均值在统计上是否不同。例如，考虑下面的数据。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/05f69d0cefa1de06dfb4f09f76fadd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*ZbIfa6qMNAY2-5X2KHnyDw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者提供的截图</figcaption></figure><p id="7789" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">总的来说，看起来2岁的体重比3岁的体重要低。如果我们计算平均值，我们会看到2岁儿童的平均体重是22.35磅，3岁儿童的平均体重是37.85磅。虽然平均值不同，但我们不知道这种差异是否只是随机的。如果我们给更多的孩子称重，他们的体重会更接近吗？</p><p id="cb79" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">这就是t检验的用武之地。t检验允许我们说平均水平的差异是随机的，即我们碰巧随机抽样了较轻的2岁儿童和较重的3岁儿童。</p><h2 id="c18a" class="nn mq iq bd mr no np dn mv nq nr dp mz ly ns nt nb mc nu nv nd mg nw nx nf iw bi translated">假设和零假设</h2><p id="1b66" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">t检验专门用于假设检验。假设是对两个事物之间的关系或区别的有根据的猜测。</p><p id="7bee" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">例如，在我们上面的问题中，我们的假设是3岁的孩子和2岁的孩子体重不同。</p><p id="a6c9" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">如果我们想更具体一点，我们可以说3岁的孩子比2岁的孩子重。在这种情况下，我们已经为我们小组的预期变化指明了方向。</p><p id="94bd" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">每个假设都有一个无效假设。零假设是指没有任何变化，没有差异的假设。</p><p id="2e05" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">例如，我们的零假设是3岁的孩子和2岁的孩子一样重。</p><p id="2c7a" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">t检验给了我们一个可测量的百分比，我们可以支持我们的假设，拒绝我们的零假设。我们稍后将讨论如何使用t检验的结果来拒绝或接受零假设。</p><h1 id="afda" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">该功能</h1><p id="7ad2" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">现在你已经知道t-test是做什么的了，重要的是理解这个函数是如何工作的。这个函数的返回被称为p值，它给出了两个事实上不同的东西的意义。</p><blockquote class="ny nz oa"><p id="6536" class="lp lq ob lr b ls mk ka lu lv ml kd lx oc mm ma mb od mn me mf oe mo mi mj lo ij bi translated">=T.Test(数组1，数组2，tails，type)</p></blockquote><p id="3700" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">函数中有4个变量或输入:数组1、数组2、尾部和类型。</p><h2 id="5364" class="nn mq iq bd mr no np dn mv nq nr dp mz ly ns nt nb mc nu nv nd mg nw nx nf iw bi translated">阵列1和阵列2</h2><p id="3413" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">函数的前两个参数是您想要测试的数据。您希望在数组1中包含第一个集合的所有数据，在数组2中包含第二个集合的所有数据。这些是可以互换的。</p><h2 id="7fec" class="nn mq iq bd mr no np dn mv nq nr dp mz ly ns nt nb mc nu nv nd mg nw nx nf iw bi translated">尾部</h2><p id="7cb6" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">第三个输入是尾部。这个输入只有两个参数:</p><p id="619e" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">1 —单尾分布<br/> 2 —双尾分布</p><p id="20cf" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">单尾和双尾的<a class="ae of" href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" rel="noopener ugc nofollow" target="_blank">选择</a>取决于预期机会的方向。最常见的检验是双尾分布。</p><p id="8c95" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">双尾分布不如单尾分布强大，这意味着所有被认为是双尾分布的事物都比单尾分布具有更低的显著性。</p><p id="9620" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">只有当您知道感知的变化方向，并且错过另一个方向的变化的后果可以忽略不计时，才应该选择单尾分布。这很大程度上取决于我们提出的问题。如果我们问3岁的孩子是否比2岁的孩子重，并且我们不在乎3岁的孩子可能更轻，那么我们可以进行单尾t检验。</p><p id="d987" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">例如，上述数据的单尾和双尾t检验结果分别为4.92倍10^(-8和9.82倍10^(-8。由于4.92小于9.82，这意味着单尾检验比双尾检验更有意义。</p><p id="937a" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated"><strong class="lr ja">重要的是，不应该使用单尾t检验，因为双尾t检验发现样本不显著。</strong></p><h2 id="c4b1" class="nn mq iq bd mr no np dn mv nq nr dp mz ly ns nt nb mc nu nv nd mg nw nx nf iw bi translated">类型</h2><p id="66b4" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">第四个也是最后一个输入是确定要执行的t检验的类型。此输入有三个参数:</p><p id="7899" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">1 —配对t检验<br/> 2 —两样本等方差<br/> 3 —两样本不等方差</p><p id="00ca" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">由于决定t检验的类型相当复杂，我们将在下面更详细地解释它。然而，最常见的检验是两样本不等方差检验(3)。</p><h1 id="465d" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">T检验的类型</h1><p id="175f" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">在考察应该使用哪种类型的t检验时，你要问两个问题:成对的<em class="ob"> vs </em>。两次采样然后等方差<em class="ob"> vs </em>。不等方差。</p><h2 id="7435" class="nn mq iq bd mr no np dn mv nq nr dp mz ly ns nt nb mc nu nv nd mg nw nx nf iw bi translated">成对与双样本</h2><p id="e9f5" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">你应该问的第一个问题是，你的数据和你的研究问题是否自然配对。如果每组中的一个样本彼此之间的关系比组中的其他样本更密切，并且您正在研究这种特定关系，则应使用<a class="ae of" href="https://www.scribbr.com/statistics/t-test/#:~:text=A%20t%2Dtest%20is%20a,are%20different%20from%20one%20another." rel="noopener ugc nofollow" target="_blank">成对t检验</a>。</p><p id="3bf1" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">就拿上面的例子数据来说吧。如果我们的问题是“3岁的孩子和2岁的孩子体重不同吗？”，那么我们需要执行一个双样本测试(输入2或3)。这个问题没有假设2岁和3岁儿童的个体样本之间有任何关系。</p><p id="18f0" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">另一方面，如果我们问，“3岁的孩子和他们2岁的兄弟姐妹体重不同吗？”，现在我们将执行配对t检验(输入1)。在这种情况下，我们会将数据排列在兄弟姐妹相对的位置。例如，每组中的第一个样本将是兄弟姐妹，依此类推。如果我们在第一个问题中包括非同胞的数据，我们需要在配对t检验中去掉这些数据。</p><p id="b3f1" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">这些测试之间的区别在于你测试的是零假设。</p><p id="0199" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">第一种情况，你的零假设是，3岁儿童的平均体重与2岁儿童的平均体重相同。</p><p id="6791" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">第二种情况你的零假设是2岁和3岁的兄弟姐妹之间的体重差异为零。</p><p id="eacc" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">一种类型的测试不一定比另一种给你更高的重要性，因为它们回答的是根本不同的问题。例如，在上面的数据集中，配对t检验和双样本t检验得出的p值为2.99 x 10^(-7和9.84 x 10^(-8，其中配对t检验的显著性水平低于独立双样本t检验。</p><h2 id="0edc" class="nn mq iq bd mr no np dn mv nq nr dp mz ly ns nt nb mc nu nv nd mg nw nx nf iw bi translated">不等方差与等方差</h2><p id="cf8d" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">如果您知道要使用双样本t检验，那么您需要决定是应该使用等方差还是不等方差t检验。双样本等方差(输入= 2)和双样本不等方差(输入= 3)之间的差异基于总体中的方差或偏差。</p><p id="8814" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">简而言之，如果你有关于整个人口变化的数据，并且知道这是相等的，你应该只选择一个相等的方差。你的总体变异不等于你的子集的标准差。在大多数情况下，这些信息是不可用的，因此，应该最少使用双样本等方差t检验。</p><p id="4b72" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">事实上，如果您的方差实际上相等，那么<a class="ae of" href="https://academic.oup.com/beheco/article/17/4/688/215960" rel="noopener ugc nofollow" target="_blank">双样本不等方差将与双样本等方差t检验</a>表现相同。因此，一般来说，您应该选择两样本不等方差，以确保不会出现假阳性错误。</p><h1 id="06b4" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">解释您的T检验结果</h1><p id="b271" class="pw-post-body-paragraph lp lq iq lr b ls nh ka lu lv ni kd lx ly nj ma mb mc nk me mf mg nl mi mj lo ij bi translated">一旦在excel中运行t-test，它将给出的输出称为p值。<a class="ae of" href="https://www.statisticshowto.com/probability-and-statistics/statistics-definitions/p-value/#:~:text=The%20p%20value%20is%20the,value%20of%200.0254%20is%202.54%25." rel="noopener ugc nofollow" target="_blank"> p值</a> (p)是两组数据的平均值之间的差异是由于随机机会造成的概率。在更多的统计学术语中，p值是零假设实际上为真，但随机机会使其看起来不为真的概率。</p><p id="b01c" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">例如，如果儿童体重差异的p值为0.01，那么2岁儿童确实与3岁儿童体重相同的可能性为1%。</p><p id="c361" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">因此，你需要有一个选择的置信水平来支持或拒绝你的零假设。置信水平告诉你真实总体与你的样本相匹配的百分比。</p><p id="b6a9" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">置信度=(1-p值)x 100%</p><p id="5d17" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">例如，如果我们的数据在95%的置信水平下是显著的(p &lt; 0.05)，那么你可以95%确定两岁的孩子比三岁的孩子轻。</p><p id="0f39" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">常见的置信水平分别为95%、99%和99.9%，或者p值等于0.05、0.01或0.001。</p><p id="8153" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">一旦设置了置信水平，就可以使用p值来接受或拒绝该置信水平下的零假设。</p><p id="b97e" class="pw-post-body-paragraph lp lq iq lr b ls mk ka lu lv ml kd lx ly mm ma mb mc mn me mf mg mo mi mj lo ij bi translated">例如，如果我们的置信水平是95%，p = 0.028，那么我们可以拒绝我们的零假设，并以95%的确定性支持我们的假设。</p></div></div>    
</body>
</html>