<html>
<head>
<title>R Project — Web Scraping with R — using R and rvest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R项目—使用R进行Web抓取—使用R和rvest</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/web-scraping-with-r-using-r-and-rvest-7e717eff694c?source=collection_archive---------1-----------------------#2021-01-29">https://pub.towardsai.net/web-scraping-with-r-using-r-and-rvest-7e717eff694c?source=collection_archive---------1-----------------------#2021-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f37c" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming/r" rel="noopener ugc nofollow" target="_blank"> R </a>，<a class="ae ep" href="https://towardsai.net/p/category/web-scraping" rel="noopener ugc nofollow" target="_blank">网页抓取</a></h2><div class=""/><div class=""><h2 id="8a28" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">了解如何使用R从互联网上抓取数据并将其导出为CSV格式！</h2></div><p id="3b9f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja"> <em class="lk">免责声明:</em> </strong> <em class="lk">本文仅出于教育目的。我们不鼓励任何人抓取网站，尤其是那些可能有条款和条件反对此类行为的网站。</em></p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="eee7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi ls translated">信息无处不在。互联网上的信息流是连续不断的。随着技术的进步，收集、记录、存储和访问数据变得更加容易。因此，互联网上充斥着大量的数据集，您可以将其用于您的个人项目。有时，你可能足够幸运，可以获得一个完整、整洁、干净的数据集。其他时候，你就没那么幸运了，你将无法访问一个完整的数据集。在这种情况下，你将不得不做网页抓取。在本文中，我将告诉您如何使用R编程语言以简单的步骤从互联网上收集数据。</p><p id="c5b0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在本文中，我们将涵盖以下内容—</p><ol class=""><li id="9c5c" class="mb mc iq kq b kr ks ku kv kx md lb me lf mf lj mg mh mi mj bi translated">什么是网页抓取？</li><li id="59d3" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">网页抓取方法</li><li id="af77" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">用R抓取数据的先决条件</li><li id="d631" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">用R进行网页抓取</li><li id="efc2" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">用R分析数据</li></ol><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mp"><img src="../Images/93690763ee5289e8df67a1aa93ed59c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lHVz-zbOMa2kYmZ8rbauTA.jpeg"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated"><a class="ae nf" href="https://unsplash.com/@austinchan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">奥斯汀·陈</a>在<a class="ae nf" href="https://unsplash.com/s/photos/website?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="5f1a" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated">1.什么是网页抓取？</h1><p id="0707" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">Web抓取或web采集是从不同网站收集数据的过程。它是一种用于将非结构化数据(HTML格式)转换为结构化格式的方法，可以方便地进一步访问和使用。在这种技术中，数据可以很容易地收集并存储在数据库或电子表格中，以供进一步分析。总的来说，世界各地的人、组织和企业都使用web采集，他们希望使用大量公开可用的数据来做出更好、更有见地的决策。</p><h1 id="770d" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated">2.网页抓取方法</h1><p id="38e7" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">有各种各样的方法从互联网上搜集数据。一些方法是—</p><ol class=""><li id="ade4" class="mb mc iq kq b kr ks ku kv kx md lb me lf mf lj mg mh mi mj bi translated">文本模式匹配</li><li id="9afa" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">人类复制粘贴</li><li id="f6ad" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">HTTP编程</li><li id="ea71" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">HTML解析</li><li id="0d23" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">DOM解析</li></ol><h1 id="6da4" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated">3.用R抓取数据的先决条件</h1><p id="f364" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">要开始使用web抓取，您应该具备R编程语言的工作知识。r非常容易学习和使用。在本文中，我们将使用由著名的Hadley Wickham创建的<em class="lk"> rvest </em>包。您首先需要安装这个软件包。你可以在这里查看文档<a class="ae nf" href="https://cran.r-project.org/web/packages/rvest/rvest.pdf" rel="noopener ugc nofollow" target="_blank">。此外，增加HTML和CSS的知识会有所帮助。互联网上有很多学习这两种语言的资源。</a></p><p id="416c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">由于HTML和CSS不是成为数据科学家所必需的基本技能，我们将在这里使用选择器小工具扩展来收集数据。Selector Gadget是一个免费的开源CSS选择器扩展，可以在Google Chrome网络商店中找到。你可以在这里下载并安装<a class="ae nf" href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb?utm_source=chrome-ntp-icon" rel="noopener ugc nofollow" target="_blank">。请确保您在开始网页抓取之前已经安装了它。通过使用这个扩展，您可以选择网站的任何部分，并获得相关的标签，只需点击网站的这一部分即可访问该部分。但是，如果你真的想掌握网页抓取的艺术，我建议你学习HTML和CSS。</a></p><h1 id="fd21" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated">4.用R进行网页抓取</h1><p id="8099" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">现在，让我们开始在IMDB网站上搜索1927年至2019年的最佳图片获奖者。你可以点击访问网站<a class="ae nf" href="https://www.imdb.com/search/title/?count=100&amp;groups=oscar_best_picture_winners&amp;sort=year%2Cdesc&amp;ref_=nv_ch_osc" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="c8fe" class="oi nh iq oe b gy oj ok l ol om"># Lets fist install rvest package for parsing of HTML and / or XML files</span><span id="433c" class="oi nh iq oe b gy on ok l ol om">install.packages("rvest")</span></pre><p id="a95e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们安装其他软件包—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="aa76" class="oi nh iq oe b gy oj ok l ol om">#lets install lubridate and tidyverse package for date and time manipulation</span><span id="a4c8" class="oi nh iq oe b gy on ok l ol om">install.packages(c("lubridate", "tidyverse"))</span></pre><p id="2fab" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们已经安装了必要的软件包。让我们装载它们。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="4456" class="oi nh iq oe b gy oj ok l ol om"># load all the necessary packages</span><span id="6786" class="oi nh iq oe b gy on ok l ol om">library(tidyverse)<br/>library(lubridate)<br/>library(rvest)</span></pre><p id="e9a6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">加载完包后，就该指定要抓取的网站的URL了。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="f451" class="oi nh iq oe b gy oj ok l ol om"># now specify the url for desired website to be scraped</span><span id="9515" class="oi nh iq oe b gy on ok l ol om">link &lt;- "<a class="ae nf" href="https://www.imdb.com/search/title/?count=100&amp;groups=oscar_best_picture_winners&amp;sort=year%2Cdesc&amp;ref_=nv_ch_osc" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/search/title/?count=100&amp;groups=oscar_best_picture_winners&amp;sort=year%2Cdesc&amp;ref_=nv_ch_osc</a>"</span><span id="1b5e" class="oi nh iq oe b gy on ok l ol om">#Read the HTML code from the website</span><span id="a611" class="oi nh iq oe b gy on ok l ol om">website &lt;- read_html(link)</span><span id="7764" class="oi nh iq oe b gy on ok l ol om">website<br/>str(website)</span></pre><p id="378a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得以下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="6252" class="oi nh iq oe b gy oj ok l ol om">{html_document}<br/>&lt;html xmlns:og="<a class="ae nf" href="http://ogp.me/ns#" rel="noopener ugc nofollow" target="_blank">http://ogp.me/ns#</a>" xmlns:fb="<a class="ae nf" href="http://www.facebook.com/2008/fbml" rel="noopener ugc nofollow" target="_blank">http://www.facebook.com/2008/fbml</a>"&gt;<br/>[1] &lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;\n&lt;script type="text/javascript"&gt;var ue ...<br/>[2] &lt;body id="styleguide-v2" class="fixed"&gt;\n            &lt;img height="1" width="1" style="display:none;visibility:hidd ...<br/>&gt; str(website)<br/>List of 2<br/> $ node:&lt;externalptr&gt; <br/> $ doc :&lt;externalptr&gt; <br/> - attr(*, "class")= chr [1:2] "xml_document" "xml_node"</span></pre><p id="1a54" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将从网站上收集以下数据-</p><ol class=""><li id="5004" class="mb mc iq kq b kr ks ku kv kx md lb me lf mf lj mg mh mi mj bi translated">军阶</li><li id="3af2" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">标题</li><li id="20ca" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">描述</li><li id="01d7" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">运行时间</li><li id="c47c" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">类型</li><li id="8f15" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">评级</li><li id="65df" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">Metascore</li><li id="3c71" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">投票</li><li id="92ae" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">总收入</li><li id="a99d" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">行动者</li><li id="e58d" class="mb mc iq kq b kr mk ku ml kx mm lb mn lf mo lj mg mh mi mj bi translated">导演</li></ol><p id="d442" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将从清除等级字段开始。为此，我们将使用选择器小工具扩展。使用此扩展来指定包含网页排名部分的CSS选择器。只需点击浏览器中的扩展，用光标选择排名字段。这看起来会像这样—</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi oo"><img src="../Images/eb1e6cd6718c251a994c78fba868562f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxVxI-h3eAYjM-6Y0kggFw.jpeg"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">按作者</figcaption></figure><p id="9f32" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">请确保所有排名都选对了。一旦你选择了所有的排名，复制底部给出的相应的CSS选择器。在这种情况下，其<em class="lk">。文本-主要。</em></p><h2 id="e2e2" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在我们知道了CSS选择器。我们将使用这个简单的R代码来获得所有的排名—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="a607" class="oi nh iq oe b gy oj ok l ol om"># using CSS selectors to scrape the rankings selection</span><span id="9ec5" class="oi nh iq oe b gy on ok l ol om">rankings_html &lt;- html_nodes(website, ".text-primary")</span><span id="4358" class="oi nh iq oe b gy on ok l ol om">#converting the rankings data to the text format</span><span id="e221" class="oi nh iq oe b gy on ok l ol om">ranks_data &lt;- html_text(rankings_html)</span><span id="88d9" class="oi nh iq oe b gy on ok l ol om">#now lets have a look at our data</span><span id="cd3f" class="oi nh iq oe b gy on ok l ol om">View(ranks_data)</span><span id="ddf7" class="oi nh iq oe b gy on ok l ol om">#lets view some top elements</span><span id="4342" class="oi nh iq oe b gy on ok l ol om">head(ranks_data)</span></pre><p id="3da1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">运行此代码后，您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="2619" class="oi nh iq oe b gy oj ok l ol om">[1] "1." "2." "3." "4." "5." "6."</span></pre><p id="c87f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">一旦获得了数据，请确保它是所需的格式。所以，让我们把数据转换成数字格式—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="da10" class="oi nh iq oe b gy oj ok l ol om"># lets convert rankings data to numerical format</span><span id="4b56" class="oi nh iq oe b gy on ok l ol om">ranks_data &lt;- as.numeric(ranks_data)</span><span id="e897" class="oi nh iq oe b gy on ok l ol om">head(ranks_data)</span></pre><p id="8718" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，我们的输出看起来像这样—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="9480" class="oi nh iq oe b gy oj ok l ol om">[1] 1 2 3 4 5 6</span></pre><p id="672c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，我们将清除之前的选择并选择所有标题。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="14f8" class="oi nh iq oe b gy oj ok l ol om"># using CSS selectors to scrape the title selection</span><span id="2f46" class="oi nh iq oe b gy on ok l ol om">title_html &lt;- html_nodes(website, ".lister-item-header a")</span><span id="4881" class="oi nh iq oe b gy on ok l ol om">#converting the title data to the text format</span><span id="a033" class="oi nh iq oe b gy on ok l ol om">title_data &lt;- html_text(title_html)</span><span id="0195" class="oi nh iq oe b gy on ok l ol om">#now lets have a look at our data</span><span id="c06c" class="oi nh iq oe b gy on ok l ol om">View(title_data)</span><span id="3af4" class="oi nh iq oe b gy on ok l ol om"># lets look at some top elements</span><span id="a2bc" class="oi nh iq oe b gy on ok l ol om">head(title_data)</span></pre><p id="3f61" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出会是这样的—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="bb15" class="oi nh iq oe b gy oj ok l ol om">[1] "Gisaengchung"                                    "Green Book"                                     <br/>[3] "The Shape of Water"                              "Moonlight"                                      <br/>[5] "Spotlight"                                       "Birdman or (The Unexpected Virtue of Ignorance)"</span></pre><h2 id="8fa4" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在让我们对描述数据这样做—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="4ec5" class="oi nh iq oe b gy oj ok l ol om"># using CSS selectors to scrape the description selection</span><span id="ddc0" class="oi nh iq oe b gy on ok l ol om">description_html &lt;- html_nodes(website, ".ratings-bar+ .text-muted")</span><span id="3477" class="oi nh iq oe b gy on ok l ol om">#converting the description data to the text format</span><span id="d706" class="oi nh iq oe b gy on ok l ol om">description_data &lt;- html_text(description_html)</span><span id="5349" class="oi nh iq oe b gy on ok l ol om"># lets look at some top elements</span><span id="6eae" class="oi nh iq oe b gy on ok l ol om">head(description_data)</span></pre><p id="b694" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="5e06" class="oi nh iq oe b gy oj ok l ol om">[1] "\n    Greed and class discrimination threaten the newly formed symbiotic relationship between the wealthy Park family and the destitute Kim clan."                                                  <br/>[2] "\n    A working-class Italian-American bouncer becomes the driver of an African-American classical pianist on a tour of venues through the 1960s American South."                                   <br/>[3] "\n    At a top secret research facility in the 1960s, a lonely janitor forms a unique relationship with an amphibious creature that is being held in captivity."                                    <br/>[4] "\n    A young African-American man grapples with his identity and sexuality while experiencing the everyday struggles of childhood, adolescence, and burgeoning adulthood."                         <br/>[5] "\n    The true story of how the Boston Globe uncovered the massive scandal of child molestation and cover-up within the local Catholic Archdiocese, shaking the entire Catholic Church to its core."<br/>[6] "\n    A washed-up superhero actor attempts to revive his fading career by writing, directing, and starring in a Broadway production."</span></pre><p id="6e3f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="3462" class="oi nh iq oe b gy oj ok l ol om">#lets process this data and remove "\n"</span><span id="f408" class="oi nh iq oe b gy on ok l ol om">description_data &lt;- gsub("\n", "", description_data)</span><span id="2310" class="oi nh iq oe b gy on ok l ol om">#lets have another look at description data</span><span id="2886" class="oi nh iq oe b gy on ok l ol om">head(description_data)</span></pre><p id="9022" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="757e" class="oi nh iq oe b gy oj ok l ol om">[1] "Greed and class discrimination threaten the newly formed symbiotic relationship between the wealthy Park family and the destitute Kim clan."                                                  <br/>[2] "A working-class Italian-American bouncer becomes the driver of an African-American classical pianist on a tour of venues through the 1960s American South."                                   <br/>[3] "At a top secret research facility in the 1960s, a lonely janitor forms a unique relationship with an amphibious creature that is being held in captivity."                                    <br/>[4] "A young African-American man grapples with his identity and sexuality while experiencing the everyday struggles of childhood, adolescence, and burgeoning adulthood."                         <br/>[5] "The true story of how the Boston Globe uncovered the massive scandal of child molestation and cover-up within the local Catholic Archdiocese, shaking the entire Catholic Church to its core."<br/>[6] "A washed-up superhero actor attempts to revive his fading career by writing, directing, and starring in a Broadway production."</span></pre><h2 id="1e8f" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">让我们执行这段代码来进行运行时选择—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="eb3a" class="oi nh iq oe b gy oj ok l ol om">#using CSS selectors to scrape the movie run time section</span><span id="8d40" class="oi nh iq oe b gy on ok l ol om"><strong class="oe ja">runtime_html </strong>&lt;<strong class="oe ja">- html_nodes(website, ".runtime")</strong></span><span id="4283" class="oi nh iq oe b gy on ok l ol om">#converting the run time data to text format</span><span id="98f7" class="oi nh iq oe b gy on ok l ol om">runtime_data &lt;- html_text(runtime_html)</span><span id="f49d" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements</span><span id="1ac5" class="oi nh iq oe b gy on ok l ol om">head(runtime_data)</span></pre><p id="661d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="3a64" class="oi nh iq oe b gy oj ok l ol om">[1] "132 min" "130 min" "123 min" "111 min" "129 min" "119 min"</span></pre><p id="1a86" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="65a6" class="oi nh iq oe b gy oj ok l ol om">#lets remove the min and convert it to numerical value</span><span id="a931" class="oi nh iq oe b gy on ok l ol om">runtime_data &lt;- gsub("min", "", runtime_data)<br/>runtime_data &lt;- as.numeric(runtime_data)</span><span id="2575" class="oi nh iq oe b gy on ok l ol om">#lets have another look at the data</span><span id="85aa" class="oi nh iq oe b gy on ok l ol om">head(runtime_data)</span></pre><p id="37ca" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="f7f4" class="oi nh iq oe b gy oj ok l ol om">[1] 132 130 123 111 129 119</span></pre><h2 id="d6bb" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看流派选择—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="f88e" class="oi nh iq oe b gy oj ok l ol om">##Using CSS selectors to scrape the Movie genre section</span><span id="c8bf" class="oi nh iq oe b gy on ok l ol om">genre_html &lt;- html_nodes(website, ".genre")</span><span id="280b" class="oi nh iq oe b gy on ok l ol om">#lets convert genre data to text format</span><span id="efbf" class="oi nh iq oe b gy on ok l ol om">genre_data &lt;- html_text(genre_html)</span><span id="fdea" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements of the data</span><span id="cbc5" class="oi nh iq oe b gy on ok l ol om">head(genre_data)</span></pre><p id="05f9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="14d4" class="oi nh iq oe b gy oj ok l ol om">[1] "\nComedy, Drama, Thriller            "   "\nBiography, Comedy, Drama            " <br/>[3] "\nAdventure, Drama, Fantasy            " "\nDrama            "                    <br/>[5] "\nBiography, Crime, Drama            "   "\nComedy, Drama</span></pre><p id="e85f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="be1e" class="oi nh iq oe b gy oj ok l ol om">#lets process this data and remove "\n", excess spaces and keeping only first genre of the data</span><span id="add3" class="oi nh iq oe b gy on ok l ol om">genre_data &lt;- gsub("\n", "", genre_data)<br/>genre_data&lt;-gsub(" ","",genre_data)<br/>genre_data&lt;-gsub(",.*","",genre_data)</span><span id="d4dd" class="oi nh iq oe b gy on ok l ol om">#Converting each genre from text to factor</span><span id="b07c" class="oi nh iq oe b gy on ok l ol om">genre_data &lt;- as.factor(genre_data)</span><span id="c5f5" class="oi nh iq oe b gy on ok l ol om">#lets have another look at the data</span><span id="cc49" class="oi nh iq oe b gy on ok l ol om">head(genre_data)</span></pre><p id="f249" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="45d0" class="oi nh iq oe b gy oj ok l ol om">[1] Comedy    Biography Adventure Drama     Biography Comedy</span></pre><h2 id="e5b0" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看IMDB评级选择—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="059d" class="oi nh iq oe b gy oj ok l ol om">#Using CSS selectors to scrape the IMDB rating section</span><span id="5abf" class="oi nh iq oe b gy on ok l ol om">IMDB_ratings_html &lt;- html_nodes(website, ".ratings-imdb-rating")</span><span id="a495" class="oi nh iq oe b gy on ok l ol om">#lets convert html data to text data</span><span id="c784" class="oi nh iq oe b gy on ok l ol om">IMDB_ratings_data &lt;- html_text(IMDB_ratings_html)</span><span id="0511" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements of the data</span><span id="b71f" class="oi nh iq oe b gy on ok l ol om">head(IMDB_ratings_data)</span></pre><p id="2f20" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="0ef9" class="oi nh iq oe b gy oj ok l ol om">[1] "\n        \n        8.6\n    " "\n        \n        8.2\n    " "\n        \n        7.3\n    "<br/>[4] "\n        \n        7.4\n    " "\n        \n        8.1\n    " "\n        \n        7.7\n    "</span></pre><p id="e19c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="cae2" class="oi nh iq oe b gy oj ok l ol om">#lets convert the strings data to numerical data and convert it to numeric</span><span id="4dd5" class="oi nh iq oe b gy on ok l ol om">IMDB_ratings_data &lt;- gsub("\n", "", IMDB_ratings_data)</span><span id="c7f4" class="oi nh iq oe b gy on ok l ol om">IMDB_ratings_data &lt;- as.numeric(IMDB_ratings_data)</span><span id="8e57" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements of the data</span><span id="c7d5" class="oi nh iq oe b gy on ok l ol om">head(IMDB_ratings_data)</span></pre><p id="985e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="55c5" class="oi nh iq oe b gy oj ok l ol om">[1] 8.6 8.2 7.3 7.4 8.1 7.7</span></pre><h2 id="c49a" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看投票的选择—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="b46d" class="oi nh iq oe b gy oj ok l ol om">#Using CSS selectors to scrape the votes section</span><span id="a089" class="oi nh iq oe b gy on ok l ol om">votes_html &lt;- html_nodes(website, ".sort-num_votes-visible span:nth-child(2)")</span><span id="03df" class="oi nh iq oe b gy on ok l ol om">#lets convert votes data to text data</span><span id="3a9b" class="oi nh iq oe b gy on ok l ol om">votes_data &lt;- html_text(votes_html)</span><span id="15fc" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements of the data</span><span id="27a0" class="oi nh iq oe b gy on ok l ol om">head(votes_data)</span></pre><p id="9ea2" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="b6bf" class="oi nh iq oe b gy oj ok l ol om">[1] "550,381" "376,701" "370,690" "273,379" "419,883" "579,887"</span></pre><p id="4886" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="5637" class="oi nh iq oe b gy oj ok l ol om">#lets remove the commas and convert votes to numerical</span><span id="a02b" class="oi nh iq oe b gy on ok l ol om">votes_data &lt;- gsub(",", "", votes_data)<br/>votes_data &lt;- as.numeric(votes_data)</span><span id="ae0a" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements of the data</span><span id="f8bd" class="oi nh iq oe b gy on ok l ol om">head(votes_data)</span></pre><p id="9fbd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="14b0" class="oi nh iq oe b gy oj ok l ol om">[1] 550381 376701 370690 273379 419883 579887</span></pre><h2 id="a093" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看导演的选择—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="2135" class="oi nh iq oe b gy oj ok l ol om">#Using CSS selectors to scrape the directors names</span><span id="970c" class="oi nh iq oe b gy on ok l ol om">directors_html &lt;- html_nodes(website, ".text-muted+ p a:nth-child(1)")</span><span id="4aaa" class="oi nh iq oe b gy on ok l ol om">#lets convert directors data to text</span><span id="c734" class="oi nh iq oe b gy on ok l ol om">directors_data &lt;- html_text(directors_html)</span><span id="7bfd" class="oi nh iq oe b gy on ok l ol om">#lets look a some of the top elements</span><span id="0c5a" class="oi nh iq oe b gy on ok l ol om">head(directors_data)</span></pre><p id="de70" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="4b8c" class="oi nh iq oe b gy oj ok l ol om">[1] "Bong Joon Ho"          "Peter Farrelly"        "Guillermo del Toro"    "Barry Jenkins"        <br/>[5] "Tom McCarthy"          "Alejandro G. Iñárritu"</span></pre><p id="8118" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="f228" class="oi nh iq oe b gy oj ok l ol om">#lets convert directors data into factors</span><span id="1435" class="oi nh iq oe b gy on ok l ol om">directors_data &lt;- as.factor(directors_data)</span><span id="7440" class="oi nh iq oe b gy on ok l ol om">#lets look a some of the top elements</span><span id="d6dd" class="oi nh iq oe b gy on ok l ol om">head(directors_data)</span></pre><p id="730a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="fd69" class="oi nh iq oe b gy oj ok l ol om">[1] Bong Joon Ho          Peter Farrelly        Guillermo del Toro    Barry Jenkins         Tom McCarthy         <br/>[6] Alejandro G. Iñárritu</span></pre><h2 id="d4e5" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看演员的选择—</h2><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="13ed" class="oi nh iq oe b gy oj ok l ol om">#Using CSS selectors to scrape the actors section</span><span id="c0b1" class="oi nh iq oe b gy on ok l ol om">actors_html &lt;- html_nodes(website, ".lister-item-content .ghost+ a")</span><span id="e469" class="oi nh iq oe b gy on ok l ol om">#lets convert actors data to text data</span><span id="8242" class="oi nh iq oe b gy on ok l ol om">actors_data &lt;- html_text(actors_html)</span><span id="1a74" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements</span><span id="6ff8" class="oi nh iq oe b gy on ok l ol om">head(actors_data)</span></pre><p id="de79" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="bb26" class="oi nh iq oe b gy oj ok l ol om">[1] "Kang-ho Song"    "Viggo Mortensen" "Sally Hawkins"   "Mahershala Ali"  "Mark Ruffalo"    "Michael Keaton"</span></pre><p id="c5dc" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="ec14" class="oi nh iq oe b gy oj ok l ol om">#lets convert data to factors</span><span id="13fc" class="oi nh iq oe b gy on ok l ol om">actors_data &lt;- as.factor(actors_data)</span><span id="783b" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements again</span><span id="8615" class="oi nh iq oe b gy on ok l ol om">head(actors_data)</span></pre><p id="31d2" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="884b" class="oi nh iq oe b gy oj ok l ol om">[1] Kang-ho Song    Viggo Mortensen Sally Hawkins   Mahershala Ali  Mark Ruffalo    Michael Keaton</span></pre><h2 id="2762" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看Metascore选择—</h2><p id="7f5f" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">我希望大家仔细看看Metascore数据。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="47c4" class="oi nh iq oe b gy oj ok l ol om">#Using CSS selectors to scrape the meta score section</span><span id="c6a0" class="oi nh iq oe b gy on ok l ol om">metascore_html &lt;- html_nodes(website, ".metascore")</span><span id="2c55" class="oi nh iq oe b gy on ok l ol om">#lets convert meta score data to text data</span><span id="f93c" class="oi nh iq oe b gy on ok l ol om">metascore_data &lt;- html_text(metascore_html)</span><span id="28de" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements</span><span id="c244" class="oi nh iq oe b gy on ok l ol om">head(metascore_data)</span></pre><p id="6370" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="a077" class="oi nh iq oe b gy oj ok l ol om">[1] "96        " "69        " "87        " "99        " "93        " "87        "</span></pre><p id="fda9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="cd2a" class="oi nh iq oe b gy oj ok l ol om">#lets remove the extra space from the data and convert them as factors</span><span id="e7a1" class="oi nh iq oe b gy on ok l ol om">metascore_data&lt;-gsub(" ","",metascore_data)</span><span id="d5ef" class="oi nh iq oe b gy on ok l ol om">metascore_data &lt;- as.factor(metascore_data)</span><span id="88a3" class="oi nh iq oe b gy on ok l ol om">#lets look at some of the top elements</span><span id="7f6d" class="oi nh iq oe b gy on ok l ol om">head(metascore_data)</span></pre><p id="c3c2" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你会得到这样的输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="85d2" class="oi nh iq oe b gy oj ok l ol om">[1] 96 69 87 99 93 87</span></pre><p id="0753" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，仔细看—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="06fb" class="oi nh iq oe b gy oj ok l ol om"># lets view the metascore data</span><span id="9522" class="oi nh iq oe b gy on ok l ol om">View(metascore_data)</span><span id="2ced" class="oi nh iq oe b gy on ok l ol om"># after looking at the data, you will see that this section has only 76 rows wile we are scraping the data for 93 movies</span><span id="64d6" class="oi nh iq oe b gy on ok l ol om">#lets check the length of the meta score data</span><span id="9c47" class="oi nh iq oe b gy on ok l ol om">length(metascore_data)</span></pre><p id="74ec" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="dc05" class="oi nh iq oe b gy oj ok l ol om">[1] 76</span></pre><p id="4330" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">发生这种情况是因为一些电影没有相应的Metascore字段，如下面的屏幕截图所示，因此，我们将NAs放入其余的条目中，并继续进行</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/2cae0f3017842b999d5e3c982691b63d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*HVRJAd9My51VB0aW0jDD1A.jpeg"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">按作者</figcaption></figure><p id="eae5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这是你应该做的—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="1a08" class="oi nh iq oe b gy oj ok l ol om"># from the output we can see that the length of metascore data is only 76 while we are scarping data for 93 movies.<br/>#This is because some of the movies do not have the metascore fields as shown in the screen shot below.</span><span id="2866" class="oi nh iq oe b gy on ok l ol om"># so lets put NAs into the rest of the field.</span><span id="b091" class="oi nh iq oe b gy on ok l ol om">for (i in c(64,65,68,71,73,75,76,77,79,82,83,84,87,88,91,92,93)){<br/>  a &lt;- metascore_data[1:(i-1)]<br/>  b &lt;- metascore_data[i:length(metascore_data)]<br/>  metascore_data &lt;- append(a, list("NA"))<br/>  metascore_data &lt;- append(metascore_data, b)<br/>}</span><span id="d5ed" class="oi nh iq oe b gy on ok l ol om">metascore_data &lt;- as.numeric(unlist(metascore_data))</span><span id="c46a" class="oi nh iq oe b gy on ok l ol om"># lets check the length again</span><span id="531d" class="oi nh iq oe b gy on ok l ol om">length(metascore_data)</span><span id="655b" class="oi nh iq oe b gy on ok l ol om"># we can see that it has 94 entries now. so lets remove extra one</span><span id="f29b" class="oi nh iq oe b gy on ok l ol om">metascore_data &lt;- metascore_data[-94]</span><span id="e7f5" class="oi nh iq oe b gy on ok l ol om">#lets check the length again</span><span id="13da" class="oi nh iq oe b gy on ok l ol om">length(metascore_data)</span></pre><p id="683c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">完成这一步后，您将获得93个条目的输出。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="535e" class="oi nh iq oe b gy oj ok l ol om">#lets look at some of the top elements again</span><span id="51df" class="oi nh iq oe b gy on ok l ol om">head(metascore_data)</span><span id="ae1e" class="oi nh iq oe b gy on ok l ol om"># lets look at the summary statistics</span><span id="1e37" class="oi nh iq oe b gy on ok l ol om">summary(metascore_data)</span></pre><p id="723e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="f1b9" class="oi nh iq oe b gy oj ok l ol om">[1] 31  7 22 34 28 22</span><span id="f886" class="oi nh iq oe b gy on ok l ol om">Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's <br/>   1.00   12.75   20.00   18.62   25.25   34.00      17</span></pre><h2 id="9821" class="oi nh iq bd ni op oq dn nm or os dp nq kx ot ou ns lb ov ow nu lf ox oy nw iw bi translated">现在，让我们看看总收入选择—</h2><p id="1a65" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">总收入数据也是如此。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="52a4" class="oi nh iq oe b gy oj ok l ol om">#Using CSS selectors to scrape the gross revenue section</span><span id="ef30" class="oi nh iq oe b gy on ok l ol om">gross_revenue_html &lt;- html_nodes(website, ".ghost~ .text-muted+ span")</span><span id="a20b" class="oi nh iq oe b gy on ok l ol om"># lets convert gross revenue data to text data</span><span id="1c50" class="oi nh iq oe b gy on ok l ol om">gross_revenue_data &lt;- html_text(gross_revenue_html)</span><span id="5be5" class="oi nh iq oe b gy on ok l ol om"># lets look at some of the top elements</span><span id="8078" class="oi nh iq oe b gy on ok l ol om">head(gross_revenue_data)</span></pre><p id="3715" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="d3fc" class="oi nh iq oe b gy oj ok l ol om">[1] "$53.37M" "$85.08M" "$63.86M" "$27.85M" "$45.06M" "$42.34M"</span></pre><p id="dd2f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，让我们清理数据—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="813e" class="oi nh iq oe b gy oj ok l ol om"># lets remove the $ and M signs</span><span id="ec8b" class="oi nh iq oe b gy on ok l ol om">gross_revenue_data &lt;- gsub("M", "", gross_revenue_data)</span><span id="4932" class="oi nh iq oe b gy on ok l ol om">gross_revenue_data &lt;- substring(gross_revenue_data, 2,6)</span><span id="ded7" class="oi nh iq oe b gy on ok l ol om">head(gross_revenue_data)</span></pre><p id="c88e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们再次清理数据——</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="e9ec" class="oi nh iq oe b gy oj ok l ol om"># lets check the length of the data</span><span id="17d1" class="oi nh iq oe b gy on ok l ol om">length(gross_revenue_data)</span><span id="1638" class="oi nh iq oe b gy on ok l ol om">#after checking the lenght of the data, you will notice the same thing which happened with metascore data.</span><span id="3ea6" class="oi nh iq oe b gy on ok l ol om">#so lets put NAs into all the missing values</span><span id="d670" class="oi nh iq oe b gy on ok l ol om"># lets fill missing values with NA</span><span id="a00c" class="oi nh iq oe b gy on ok l ol om">for (i in c(62,65,71,72,73,79,83,84,85,89)){<br/>  s &lt;- gross_revenue_data[1:(i-1)]<br/>  d &lt;- gross_revenue_data[i:length(gross_revenue_data)]<br/>  gross_revenue_data &lt;- append(s, list("NA"))<br/>  gross_revenue_data &lt;- append(gross_revenue_data, d)<br/>}</span><span id="d6a7" class="oi nh iq oe b gy on ok l ol om">#lets convert gross data to numerical</span><span id="63a1" class="oi nh iq oe b gy on ok l ol om">gross_revenue_data &lt;- as.numeric(gross_revenue_data)</span><span id="8cab" class="oi nh iq oe b gy on ok l ol om">head(gross_revenue_data)</span><span id="41e6" class="oi nh iq oe b gy on ok l ol om">#Let's have another look at the length of gross revenue data</span><span id="315e" class="oi nh iq oe b gy on ok l ol om">length(gross_revenue_data)</span><span id="28ed" class="oi nh iq oe b gy on ok l ol om">summary(gross_revenue_data)</span></pre><p id="793f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="05a5" class="oi nh iq oe b gy oj ok l ol om">[1] 93</span><span id="d43f" class="oi nh iq oe b gy on ok l ol om">Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's <br/>   0.01   24.02   54.58   81.70  110.20  659.30      10</span></pre><p id="3269" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们现在已经成功地刮出了1927年至2019年的93部最佳影片的所有11个元素。现在，让我们创建连接上述要素的数据框。</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="84f7" class="oi nh iq oe b gy oj ok l ol om"># combining all the lists to form the new data frame</span><span id="1a1e" class="oi nh iq oe b gy on ok l ol om">best_movies_data &lt;- data.frame(Rank = ranks_data, Title = title_data, Description = description_data, Runtime = runtime_data, Genre = genre_data, IMDB_Ratings = IMDB_ratings_data, Votes = votes_data, Directors = directors_data, Actors = actors_data, Metascore = metascore_data, Gross_Revenue = gross_revenue_data)</span><span id="ea51" class="oi nh iq oe b gy on ok l ol om">View(best_movies_data)</span><span id="cf1f" class="oi nh iq oe b gy on ok l ol om"># lets look at structure of the data frame</span><span id="ffde" class="oi nh iq oe b gy on ok l ol om">str(best_movies_data)</span></pre><p id="6f23" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="4f8a" class="oi nh iq oe b gy oj ok l ol om">'data.frame': 93 obs. of  11 variables:<br/> $ Rank         : num  1 2 3 4 5 6 7 8 9 10 ...<br/> $ Title        : chr  "Gisaengchung" "Green Book" "The Shape of Water" "Moonlight" ...<br/> $ Description  : chr  "     Greed and class discrimination threaten the newly formed symbiotic relationship between the wealthy Park f"| __truncated__ "     A working-class Italian-American bouncer becomes the driver of an African-American classical pianist on a "| __truncated__ "     At a top secret research facility in the 1960s, a lonely janitor forms a unique relationship with an amphi"| __truncated__ "     A young African-American man grapples with his identity and sexuality while experiencing the everyday stru"| __truncated__ ...<br/> $ Runtime      : num  132 130 123 111 129 119 134 120 100 118 ...<br/> $ Genre        : Factor w/ 6 levels "Action","Adventure",..: 4 3 2 6 3 4 3 3 4 3 ...<br/> $ IMDB_Ratings : num  8.6 8.2 7.3 7.4 8.1 7.7 8.1 7.7 7.9 8 ...<br/> $ Votes        : num  550381 376701 370690 273379 419883 ...<br/> $ Directors    : Factor w/ 81 levels "Alejandro G. Iñárritu",..: 9 55 28 4 72 1 68 6 50 71 ...<br/> $ Actors       : Factor w/ 86 levels "Al Pacino","Albert Finney",..: 48 82 76 56 58 62 15 4 43 19 ...<br/> $ Metascore    : num  31 7 22 34 28 22 31 21 24 23 ...<br/> $ Gross_Revenue: num  53.4 85.1 63.9 27.9 45.1 ...</span></pre><p id="ffd6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，最重要的一步。让我们将数据帧从R导出为CSV格式。我们会这样做—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="1eb5" class="oi nh iq oe b gy oj ok l ol om"># lets export this data to a csv file</span><span id="daf6" class="oi nh iq oe b gy on ok l ol om">write.csv(best_movies_data, "C:\\Users\\Kunal Kulkarni\\Desktop\\R data\\bestmoviesdata.csv", row.names = FALSE)</span></pre><p id="927a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">我们来看看平均运行时间是多少— </strong></p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="38f6" class="oi nh iq oe b gy oj ok l ol om"># average runtime</span><span id="4dea" class="oi nh iq oe b gy on ok l ol om">print(avg &lt;- mean(best_movies_data$Runtime))</span></pre><p id="b343" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="904e" class="oi nh iq oe b gy oj ok l ol om">[1] 137.6129</span></pre><p id="e911" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">我们来看看摘要— </strong></p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="01e4" class="oi nh iq oe b gy oj ok l ol om">summary(best_movies_data)</span></pre><p id="f36e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将得到如下输出—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="62f1" class="oi nh iq oe b gy oj ok l ol om">Rank       Title           Description           Runtime            Genre     IMDB_Ratings       Votes        <br/> Min.   : 1   Length:93          Length:93          Min.   : 90.0   Action   : 3   Min.   :5.700   Min.   :   4584  <br/> 1st Qu.:24   Class :character   Class :character   1st Qu.:118.0   Adventure: 8   1st Qu.:7.500   1st Qu.:  34774  <br/> Median :47   Mode  :character   Mode  :character   Median :129.0   Biography:18   Median :7.900   Median : 178591  <br/> Mean   :47                                         Mean   :137.6   Comedy   :13   Mean   :7.788   Mean   : 343034  <br/> 3rd Qu.:70                                         3rd Qu.:155.0   Crime    : 9   3rd Qu.:8.100   3rd Qu.: 472817  <br/> Max.   :93                                         Max.   :238.0   Drama    :42   Max.   :9.200   Max.   :1807653  <br/>                                                                                                                    <br/>                Directors                Actors     Metascore     Gross_Revenue   <br/> William Wyler       : 3   Dustin Hoffman   : 3   Min.   : 1.00   Min.   :  0.01  <br/> Billy Wilder        : 2   Clark Gable      : 2   1st Qu.:12.75   1st Qu.: 24.02  <br/> Clint Eastwood      : 2   Laurence Olivier : 2   Median :20.00   Median : 54.58  <br/> David Lean          : 2   Leonardo DiCaprio: 2   Mean   :18.62   Mean   : 81.70  <br/> Elia Kazan          : 2   Marlon Brando    : 2   3rd Qu.:25.25   3rd Qu.:110.20  <br/> Francis Ford Coppola: 2   Russell Crowe    : 2   Max.   :34.00   Max.   :659.30  <br/> (Other)             :80   (Other)          :80   NA's   :17      NA's   :10</span></pre><h1 id="18e5" class="ng nh iq bd ni nj nk nl nm nn no np nq kf nr kg ns ki nt kj nu kl nv km nw nx bi translated"><strong class="ak">让我们分析一下从网上搜集来的数据— </strong></h1><p id="7572" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">一旦您获得了想要的数据，您就可以执行各种任务，例如分析数据、清理数据、可视化数据以及从中得出重要的见解。因此，让我们分析我们刚刚收集的数据，并通过可视化这些数据从中得出一些有意义的见解。</p><p id="d734" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们将从安装和加载<em class="lk"> ggplot2 </em>包开始。ggplot2包是Tidyverse包家族的一部分，它是一个为数据可视化而构建的非常强大的包。它通常被认为是图形的语法。点击阅读更多关于ggplot2包<a class="ae nf" href="https://ggplot2.tidyverse.org/reference/" rel="noopener ugc nofollow" target="_blank">的信息。另外，您可以使用ggplot2备忘单作为参考。它可以在RStudio中免费下载，或者您也可以在</a><a class="ae nf" href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>下载。所以，让我们开始吧—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="f482" class="oi nh iq oe b gy oj ok l ol om"># The easiest way to install ggplot2 package is to install the whole tidyverse package:</span><span id="717e" class="oi nh iq oe b gy on ok l ol om">install.packages("tidyverse")</span><span id="95be" class="oi nh iq oe b gy on ok l ol om"># Alternatively, you can just install just ggplot2 package from CRAN :</span><span id="6e83" class="oi nh iq oe b gy on ok l ol om">install.packages("ggplot2")</span><span id="e20b" class="oi nh iq oe b gy on ok l ol om"># load the library</span><span id="3a36" class="oi nh iq oe b gy on ok l ol om">library(tidyverse)</span><span id="6217" class="oi nh iq oe b gy on ok l ol om">#or</span><span id="68b3" class="oi nh iq oe b gy on ok l ol om">library(ggplot2)</span></pre><p id="725e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">基于这些数据，我们只是粗略地看了一下，让我们看看哪个流派的哪部电影播放时间最长</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="7386" class="oi nh iq oe b gy oj ok l ol om"># now lets analyze our data</span><span id="9775" class="oi nh iq oe b gy on ok l ol om">#lets check which genre has the the longest runtime by plotting a graph of it</span><span id="d834" class="oi nh iq oe b gy on ok l ol om">best_movies_data %&gt;% ggplot(aes(Runtime, IMDB_Ratings, color = Genre, size = Votes, bins = 50)) + geom_point(aes(size = IMDB_Ratings)) + xlab("Runtime in minutes") + ylab("Ratings") + ggtitle("Genre with the longest runtime")</span></pre><p id="60e3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pa"><img src="../Images/64d708029f96e65021b843fbf9c22529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wMEbEC4b45DTXg0Fbz279Q.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">按作者</figcaption></figure><p id="a825" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们看看哪部电影赚得最多—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="1662" class="oi nh iq oe b gy oj ok l ol om">best_movies_data %&gt;% ggplot(aes(Runtime, Gross_Revenue, color = Genre)) + geom_point() + ggtitle("Movie with the highest earning")</span></pre><p id="a24e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pb"><img src="../Images/abfcfb2f41756cdb84ba8e7afbceb291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmIH1pOxgwZTSODR4dmrMw.png"/></div></div></figure><p id="9ae7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">根据数据，我们刚刚刮，让我们看看哪种类型的收入最高，以百万计—</p><pre class="mq mr ms mt gt od oe of og aw oh bi"><span id="ecbc" class="oi nh iq oe b gy oj ok l ol om"># lets plot the graph of gross revenue and genre</span><span id="891e" class="oi nh iq oe b gy on ok l ol om">best_movies_data %&gt;% ggplot(aes(Genre, Gross_Revenue, color = Genre)) + geom_line() + ggtitle("Genre with the highest earnings")</span></pre><p id="9329" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您将获得如下输出—</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pb"><img src="../Images/a70961dbbc824bd6a0f5c7fa1800f12f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HUumC9cnjLspzT6BYFT_EQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">按作者</figcaption></figure></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h1 id="fd68" class="ng nh iq bd ni nj pc nl nm nn pd np nq kf pe kg ns ki pf kj nu kl pg km nw nx bi translated">结论</h1><p id="1481" class="pw-post-body-paragraph ko kp iq kq b kr ny ka kt ku nz kd kw kx oa kz la lb ob ld le lf oc lh li lj ij bi translated">我希望这篇文章能让你对如何用R从网上刮下数据以及如何分析数据有一个基本的了解。由于互联网上的大部分数据都是非结构化格式的，因此网络抓取对于任何数据科学家来说都是一项非常重要的必备技能。如果你对这篇文章有任何疑问，请在下面的评论区告诉我。</p><p id="65a4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">谢谢大家！</p></div></div>    
</body>
</html>