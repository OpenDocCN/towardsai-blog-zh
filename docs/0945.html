<html>
<head>
<title>Regression Feature Selection using the Kydavra LassoSelector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Kydavra LassoSelector进行回归特征选择</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/regression-feature-selection-using-the-kydavra-lassoselector-81a95cdae570?source=collection_archive---------4-----------------------#2020-09-18">https://pub.towardsai.net/regression-feature-selection-using-the-kydavra-lassoselector-81a95cdae570?source=collection_archive---------4-----------------------#2020-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="cb97" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/d7396cedab8f845c4dcafe6258624427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yoefKQo-D4BgyxHIlu-LwA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">这幅图片是由公众协会“Sigmoid”创作的</figcaption></figure><p id="5fd2" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们都知道奥卡姆剃刀:</p><p id="d81f" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">从一组解决方案中选择一个最简单的。</p><p id="68c9" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">该原理应用于机器学习中线性模型的正则化。L1正则化(也称为LASSO)倾向于将线性模型的权重收缩到0，而L2正则化(也称为Ridge)倾向于通过最小化模型的向量权重的范数来尽可能地保持整体复杂性。Kydavra的选择器之一使用套索来选择最佳特征。所以我们来看看怎么应用。</p><h2 id="d7f6" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md iz bi translated">使用Kydavra LassoSelector。</h2><p id="7a19" class="pw-post-body-paragraph ko kp it kq b kr me kt ku kv mf kx ky kz mg lb lc ld mh lf lg lh mi lj lk ll im bi translated">如果你还没有安装Kydavra，只需在命令行中输入以下命令。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="c8ac" class="lm ln it mo b gy ms mt l mu mv">pip install kydavra</span></pre><p id="2a2c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">接下来，我们需要导入模型，创建选择器，并将其应用于我们的数据:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="da3f" class="lm ln it mo b gy ms mt l mu mv">from kydavra import LassoSelector</span><span id="0b0c" class="lm ln it mo b gy mw mt l mu mv">selector = LassoSelector()</span><span id="4b34" class="lm ln it mo b gy mw mt l mu mv">selected_cols = selector.select(df, ‘target’)</span></pre><p id="840d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">select函数将panda的数据框和目标列的名称作为参数。此外，它还有一个默认参数“cv”(默认设置为5)，表示交叉验证中使用的折叠次数。LassoSelector()接受下面的参数:</p><ul class=""><li id="4dbe" class="mx my it kq b kr ks kv kw kz mz ld na lh nb ll nc nd ne nf bi translated">alpha_start (float，默认值= 0)alpha的起始值。</li><li id="8a58" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated">alpha_finish (float，默认值= 2)alpha的最终值。这两个参数定义了算法的搜索空间。</li><li id="0538" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated">n_alphas (int，default = 300)搜索过程中将测试的alpha数。</li><li id="7678" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated">extend_step (int，default=20)如果算法将推断出α的最佳值是α_ start或α_ finish，它将使用extend_step扩展搜索范围，以这种方式确保它不会卡住，并将最终找到最佳值。</li><li id="bac1" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated">公式10^-power中使用的power (int，default = 2)将最大可接受值定义为0。</li></ul><p id="a87d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以算法在找到α的最优值后，将会看到哪个权重高于10^-power.</p><h2 id="54a9" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md iz bi translated"><strong class="ak">让我们看一个例子:</strong></h2><p id="dd1e" class="pw-post-body-paragraph ko kp it kq b kr me kt ku kv mf kx ky kz mg lb lc ld mh lf lg lh mi lj lk ll im bi translated">为了展示它的性能，我选择了<a class="ae nl" href="https://www.kaggle.com/neuromusic/avocado-prices" rel="noopener ugc nofollow" target="_blank">鳄梨价格</a>数据集。</p><p id="a857" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">经过一点清理和培训，它的下一个功能:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="c783" class="lm ln it mo b gy ms mt l mu mv">'Total Volume', '4046', '4225', '4770', 'Small Bags', 'Large Bags', 'XLarge Bags', 'type', 'year'</span></pre><p id="93d2" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">线性回归的平均绝对误差等于<strong class="kq jd">0.249683103736682。</strong></p><p id="7905" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">当LassoSelector应用于此数据集时，它会选择以下要素:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="da9f" class="lm ln it mo b gy ms mt l mu mv">'type', 'year'</span></pre><p id="202d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">仅使用这些特征，我们得到了一个MAE = 0。49660 . 68686868661</p><p id="859d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一个相当好的结果(记住，我们只使用了2个特性)。</p><blockquote class="nm nn no"><p id="f283" class="ko kp np kq b kr ks kt ku kv kw kx ky nq la lb lc nr le lf lg ns li lj lk ll im bi translated"><strong class="kq jd"> <em class="it">注意:</em> </strong>有时建议在缩放数据上应用套索。在这种情况下，应用于数据，选择器没有丢弃任何特征。我们邀请您尝试缩放值和非缩放值。</p></blockquote><h2 id="d914" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md iz bi translated"><strong class="ak">奖金。</strong></h2><p id="7921" class="pw-post-body-paragraph ko kp it kq b kr me kt ku kv mf kx ky kz mg lb lc ld mh lf lg lh mi lj lk ll im bi translated">该模块还具有绘图功能。应用选择功能后，您可以看到为什么选择器选择了一些功能，而没有选择其他功能。要绘制，只需键入:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="1aea" class="lm ln it mo b gy ms mt l mu mv">selector.plot_process()</span></pre><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/34fa5e556fe9575f7ac3549ccf133000.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/0*UNh4gBUBAQPVug9l"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">这是Kydavra LassoSelector在鳄梨价格数据集上创建的图</figcaption></figure><p id="b0cb" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">虚线是因为权重太接近0而被丢弃的要素。中间垂直的虚线是算法找到的alpha的最佳值。</p><p id="ca66" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">plot_process()函数有以下参数:</p><ul class=""><li id="015a" class="mx my it kq b kr ks kv kw kz mz ld na lh nb ll nc nd ne nf bi translated"><strong class="kq jd"> eps </strong> ( <em class="np">浮动</em>，<em class="np">默认= 5e-3 </em>)路径的长度。</li><li id="d110" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated"><strong class="kq jd">标题</strong> ( <em class="np">字符串</em>，<em class="np">默认= 'Lasso coef Plot' </em> ) —绘图的标题。</li><li id="cb8c" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated"><strong class="kq jd">保存</strong> ( <em class="np">布尔</em>，<em class="np">默认=假</em>)如果设置为真，将尝试保存绘图。</li><li id="e6f1" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated"><strong class="kq jd">file _ path</strong>(<em class="np">string</em>，<em class="np"> default = None </em>)如果保存参数设置为true，将使用该路径保存绘图。</li></ul><h2 id="ea58" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md iz bi translated"><strong class="ak">结论</strong></h2><p id="2ebf" class="pw-post-body-paragraph ko kp it kq b kr me kt ku kv mf kx ky kz mg lb lc ld mh lf lg lh mi lj lk ll im bi translated">LassoSelector是一个选择器，它使用LASSO算法来选择最有用的特征。有时缩放功能会很有用，我们强烈建议您两者都尝试一下。</p><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7609140a52ef290cbe605902efa4abbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*Lb6Hu_Kqq8f1QdMvPgasRg.gif"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">来源tenor.com</figcaption></figure><p id="c944" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果您尝试过kydavra，我们邀请您通过填写此<a class="ae nl" href="https://vpapaluta.typeform.com/to/g1EXxlSf" rel="noopener ugc nofollow" target="_blank">表格</a>来分享您的印象。</p><p id="16f2" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">西格蒙德用❤做的。</p><p id="f0de" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有用的链接:</p><ul class=""><li id="1b1a" class="mx my it kq b kr ks kv kw kz mz ld na lh nb ll nc nd ne nf bi translated"><a class="ae nl" href="https://en.wikipedia.org/wiki/Lasso_(statistics)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Lasso _(统计数据)</a></li><li id="c94a" class="mx my it kq b kr ng kv nh kz ni ld nj lh nk ll nc nd ne nf bi translated"><a class="ae nl" href="https://towardsdatascience.com/feature-selection-using-regularisation-a3678b71e499" rel="noopener" target="_blank">https://towards data science . com/feature-selection-using-regular ization-a 3678 b 71 e 499</a></li></ul></div></div>    
</body>
</html>