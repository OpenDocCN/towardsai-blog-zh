<html>
<head>
<title>Identify the Best Regression Model for Your Marketing Use Case</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的营销用例确定最佳回归模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/identify-the-best-regression-model-for-your-marketing-use-case-c76bc4991722?source=collection_archive---------1-----------------------#2022-11-02">https://pub.towardsai.net/identify-the-best-regression-model-for-your-marketing-use-case-c76bc4991722?source=collection_archive---------1-----------------------#2022-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="03d7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用基于树的回归模型捕捉非线性趋势</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d4df3e8b62cd3b947333a77d82e1afd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5mFPh0CEfkVrC-QT"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">布鲁克·拉克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="afaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当建立一个企业，服务，或只是一个网站，我们考虑不同的客户人口统计属性，如性别，收入，年龄，家庭规模，教育等。其中，客户年龄起着至关重要的作用，但有时可能会被忽视。了解客户年龄对业务的影响可能非常重要。例如，如果你经营一家服装公司，你需要考虑时尚随着时间和个人年龄的变化而变化。不同年龄组在服装上的花费不同。根据2021年的统计，随着年龄的增长，支出持续上升，直到40多岁，然后逐渐放缓。有趣的是，在不同的顾客年龄组中，35至44岁的年龄组是服装消费最高的年龄组，无论男女。</p><p id="4f57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，在保险业，老年人口通常比年轻人口看医生更频繁，在药物上花费更多。正因为如此，保险费用也随着年龄的增长而增加。</p><p id="b2fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为什么在构建产品和服务时，拥有一个包含未来客户年龄的模型对企业成功至关重要。</p><p id="d737" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将评估不同的机器学习算法，以发现客户随着年龄增长的消费趋势。为此，我们将评估线性回归和决策树。</p><p id="93ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的代码可以在<a class="ae ky" href="https://deepnote.com/workspace/asish-biswas-a599-b6cca607-3c12-4ae6-b54d-32861e7e9438/project/analyticsoul-e10ea3a1-7bbf-415b-a1f8-e1884fe5241b/%2F07.%20Regression%20Models.ipynb" rel="noopener ugc nofollow" target="_blank">的Deepnote笔记本</a>中找到。</p><h2 id="9c9f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">线性回归</h2><p id="4134" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><strong class="lb iu">线性回归</strong>描述了一个或多个特征与标量响应(也称为自变量和因变量)之间的线性关系。这是现有的最简单、最容易解释的模型之一。正因为如此，它是商业和学术界最常用的模型。线性回归用于预测未来的产品销售、房价、GDP增长、健康指标等。</p><p id="fcc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下图中，我们可以看到电视广告成本和销售额之间存在线性关系(<a class="ae ky" href="https://www.kaggle.com/datasets/thorgodofthunder/tvradionewspaperadvertising" rel="noopener ugc nofollow" target="_blank">数据集链接</a>)。由此，你可以很容易地预测，如果你增加或减少电视广告的支出，你将获得多少收入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/a003da34e9ff101c8e2a23360a34d8fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hsk-I0uwUzVnxECiCRpivg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">与电视广告相关的收入(图片由作者提供)</figcaption></figure><h2 id="251e" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">决策图表</h2><p id="2aa9" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">决策树是一种基于树的算法，可用于分类和回归问题。它将数据集转换为单向条件控制语句的树状结构，并通过遵循树的条件步骤到叶节点来进行预测。<br/>通过这个<a class="ae ky" href="https://www.youtube.com/watch?v=_L39rN6gz7Y" rel="noopener ugc nofollow" target="_blank"> statquest视频</a>了解更多关于决策树的知识。</p><p id="8b07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图说明了回归树的结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/8ff8e62021a15d7446fe2ba0ab588017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*FVNJnYjR-Kk7LQhpJ2x9DQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">通过决策树评估新的工作机会(图片由作者提供)</figcaption></figure><p id="b8c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">线性回归和决策树都有许多用例，其中一个可能比另一个表现得更好。在本帖中，我们将考察这样的场景，评估这两种模型，并确定适合我们用例的方法。</p><p id="748b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了评估我们的模型，我们将使用均方根误差(RMSE)，这是回归问题的一种常见性能度量。</p><blockquote class="mv mw mx"><p id="104b" class="kz la my lb b lc ld ju le lf lg jx lh mz lj lk ll na ln lo lp nb lr ls lt lu im bi translated">尽管RMSE是回归问题的首选性能测量方法，但在一些存在大量异常值的情况下，您可以考虑使用平均绝对误差(MAE)进行模型评估。</p></blockquote><p id="ca28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想更深入地了解RMSE和MAE是如何计算的，我建议你参考《Scikit-Learn、Keras和TensorFlow 的机器学习实践》一书的第二章。</p><h2 id="013c" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">实验</h2><p id="d33d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们想弄清楚消费习惯如何随着年龄的增长而演变，以及不同的模型如何预测这种关系。</p><p id="546c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将从导入一个样本数据集开始，该数据集包含个人的年龄支出，并拆分测试和训练数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="d2e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将使用训练数据集训练一个线性回归模型，并使用测试数据集计算RMSE分数。</p><p id="6103" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在散点图中看到的，回归模型已经确定了随着年龄的增长支出略有下降的趋势。但它未能发现消费者生命早期阶段的支出上升趋势。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf nd l"/></div></figure><p id="23a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了。我们的基准模型的RMSE得分是157.19。让我们看看决策树是否能做得更好。</p><p id="a2b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您现在可能已经知道，决策树的性能会因树的深度而异。这就是为什么我们将创建最大深度为2和5的两个模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf nd l"/></div></figure><p id="8d43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RMSE说明了一切。深度为2的决策树已经将错误率从157降低到115，提高了26%，深度为5的决策树表现更好(RMSE 102，提高了35%)。<br/>年龄和消费行为之间的关系在散点图中显而易见。我们可以看到最老或最年轻人口的支出急剧下降。</p><h2 id="dc75" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">结论</h2><p id="6025" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">了解你的客户是当今商业中最重要的事情，年龄是最关键的客户属性之一。有时候年龄并不像我们想象的那样是一个简单的参数。因此，最好尝试不同的算法，找出最适合您客户的算法。</p><p id="d781" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<a class="ae ky" href="https://deepnote.com/workspace/asish-biswas-a599-b6cca607-3c12-4ae6-b54d-32861e7e9438/project/analyticsoul-e10ea3a1-7bbf-415b-a1f8-e1884fe5241b/%2F07.%20Regression%20Models.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>中的代码，并用您的数据进行实验。</p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="2930" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="my">感谢阅读！如果你喜欢这篇文章一定要</em> <strong class="lb iu"> <em class="my">鼓掌(最多50！)</em> </strong> <em class="my">和让我们</em> <strong class="lb iu"> <em class="my">连接上</em></strong><em class="my"/><a class="ae ky" href="https://www.linkedin.com/in/asish-biswas/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="my">LinkedIn</em></strong></a><em class="my"/><strong class="lb iu"><em class="my">在Medium上关注我</em> </strong> <em class="my">保持更新我的新文章</em></p></div></div>    
</body>
</html>