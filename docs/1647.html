<html>
<head>
<title>How To Write a Statistical Learning Model in Excel To Predict Whether a Bank Note Is Fake or Not</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Excel中写一个统计学习模型来预测一张钞票是不是假钞</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-write-a-statistical-learning-model-in-excel-to-predict-whether-a-bank-note-is-fake-or-not-992c996ef883?source=collection_archive---------5-----------------------#2021-03-09">https://pub.towardsai.net/how-to-write-a-statistical-learning-model-in-excel-to-predict-whether-a-bank-note-is-fake-or-not-992c996ef883?source=collection_archive---------5-----------------------#2021-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/0db3def1f7246d25eb45da211ce00c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rgls2mmQ_JKNI-NYdhPq5A.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@gobankingrates?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">在<a class="ae jg" href="https://unsplash.com/s/photos/bank-note?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的</a>直播</figcaption></figure><h2 id="1c99" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="2942" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jt">数据集来源:</strong></p><p id="73aa" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这个数据集可以在UCI机器学习知识库的以下链接中找到:<a class="ae jg" href="https://archive.ics.uci.edu/ml/datasets/banknote+authentication" rel="noopener ugc nofollow" target="_blank">https://archive . ics . UCI . edu/ml/datasets/banknote+authentic ation</a></p><p id="07d3" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是所提供的数据集描述:</p><p id="406d" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">“数据是从真钞和伪钞样本的图像中提取的。对于数字化，使用通常用于印刷检查的工业相机。最终图像的像素为400x 400。由于物镜和到所研究物体的距离，获得了分辨率约为660 dpi的灰度图像。小波变换工具被用来从图像中提取特征</p><h2 id="c66a" class="ln lo jj bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me jp bi translated">数据</h2><p id="9d59" class="pw-post-body-paragraph kp kq jj kr b ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">网站上列出了该数据集中的四种要素/属性及其类型:</p><p id="fd3a" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">1 .小波变换图像的方差(连续)<br/> 2 .小波变换图像的偏斜度(连续)<br/> 3 .小波变换图像的曲率(连续)<br/> 4 .图像的熵(连续)<br/> 5 .类别(整数)</p><h2 id="b8d3" class="ln lo jj bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me jp bi translated">任务:</h2><p id="f50d" class="pw-post-body-paragraph kp kq jj kr b ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">任务是预测采用0或1形式的类别</p><p id="4ca3" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">将数据导入Excel:</p><p id="042b" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">银行票据数据集来自一个. txt文件。事实上，它是一个逗号分隔的txt文件。这意味着您可以像导入. csv文件一样导入它。</p><p id="952a" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">单击excel左上角的文件按钮。</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/c321837058e9d98bedb64043cb71abe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*Ll8JGkYPKIh5kTfr15Gt8A.png"/></div></figure><p id="07b8" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在点击打开按钮</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/a591c9a5ca55fe07932684606b84987c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*YjUo3ayYB6qMxHqKXo1MZg.png"/></div></figure><p id="d0f8" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在这之后点击浏览按钮，并前往。txt文件。当你打开文本文件时，它会给你一个菜单，像这样分割列。确保已选中“分隔”,然后单击“下一步”:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mq"><img src="../Images/e92a5bfb4ef2248353632f4c59174ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l6iO0xwBob3Fm09IfzGVQg.png"/></div></div></figure><p id="073d" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">接下来你会看到下图。取消选中所有内容，但单击逗号框。它将拆分列:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mr"><img src="../Images/4a0bbb14b2888107fa98983610324bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Zf5ByCPfal_OcQweNo76A.png"/></div></div></figure><p id="796f" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">单击Finish，它会将数据导入到您的文件中。现在在顶部插入一行，并为四列逐个输入前面提到的标题。</p><h1 id="ed7f" class="ms lo jj bd lp mt mu mv ls mw mx my lv mz na nb ly nc nd ne mb nf ng nh me ni bi translated">为分析和预测准备数据:</h1><h2 id="cb29" class="ln lo jj bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me jp bi translated">I .随机化和拆分您的数据:</h2><p id="4564" class="pw-post-body-paragraph kp kq jj kr b ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li mj lk ll lm im bi translated">为了使数据随机化，请在数据的开头插入一列。</p><p id="d003" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在将它输入到单元格A2中，这是数据开始的单元格(第一行应该是您的标题)。</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="aebd" class="ln lo jj nk b gy no np l nq nr">=RAND()</span></pre><p id="1e52" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这会以随机方式生成一个介于0和1之间的数字(伪随机发生器)</p><p id="32ee" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在通过按CTRL + A突出显示全部数据。</p><p id="6fdf" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">单击excel顶部的数据功能区，然后单击“筛选”,或者您可以依次按alt、a、t。这两种方法都会将筛选添加到数据的顶部。</p><p id="8ca9" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">使用第一列中的filter按钮，按任意顺序对数据集进行排序。因为数字是随机的，它会随机化你的数据。</p><p id="9e2c" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jt">二。添加百分比列来拆分您的数据</strong></p><p id="0526" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在G列中，写出以下公式:</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="f0db" class="ln lo jj nk b gy no np l nq nr">=ROW()/COUNT($F$2:$F$1373)</span></pre><p id="7151" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此公式将告诉您，当您向下移动数据集时，包含的所有记录的百分比。</p><p id="e3c6" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在监督学习分类任务中，通常可以使用66%训练33%测试的分割。</p><p id="71b1" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这就是我们将要做的。低头直到你得到66%,然后把66%之后的所有内容复制到数据的底部。剪切所有行并粘贴到一个新的选项卡中。复制列名，并将其添加到顶部。</p><p id="d3b7" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jt">三世。使用探索性统计训练模型</strong></p><p id="2b86" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">回到包含66%行的第一个选项卡。在每一行上，用以下公式创建一列:</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="6621" class="ln lo jj nk b gy no np l nq nr">=AVERAGE(B2:E2)</span></pre><p id="7a93" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">一旦你有了每一行的平均值，让我们来看看第1类的平均值:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/246c4f51e04c3fc2cae5c5ea2852e377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*KHJq5wxHP7GuQoLBkoIwTg.png"/></div></figure><p id="969f" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">以下是0类的外观:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/cb6b276868c8552e24fedc79397661fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*1Yn0ImALGogFLsQwYeX_vg.png"/></div></figure><p id="25d7" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正如你所看到的，这两个类在范围上有一个分割，在0附近有一些重叠。类别1的平均值大多为负值，类别0的平均值为正值。</p><p id="35e6" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在让我们对这些信息进行建模。</p><p id="6f4a" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">使用您的训练数据，获取以下信息:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/de8fc46f1245485b8cfc23b45bd221dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*Hprimh-dixrC_5hAoKikBA.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">桌子</figcaption></figure><p id="5b73" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">获取此信息的方法示例:</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="b900" class="ln lo jj nk b gy no np l nq nr">=AVERAGE(FILTER(G:G,F:F=J3)) --&gt; G:G is Averages, F:F is Class in the data and J3 is the class indicator 0<br/>=AVERAGE(FILTER(G:G,F:F=J4))--&gt; G:G is Averages, F:F is Class in the data and J4 is the class indicator 1<br/>=STDEV(FILTER(G:G,F:F=J3)) --&gt; G:G is Averages, F:F is Class in the data and J3 is the class indicator 0<br/>=STDEV(FILTER(G:G,F:F=J4)) --&gt; G:G is Averages, F:F is Class in the data and J4 is the class indicator 1</span></pre><p id="f439" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jt">四世。测试:</strong></p><p id="4237" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">将这些乘数与每个类别的标准偏差相加，得到这些高/低范围:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/b74d086eaf492b34e4d39abab8e9dc95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*m6ecqgVN1mKCG6zooeUEwQ.png"/></div></figure><p id="cab7" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，您可以使用if语句对该类进行编码。本质上，如果它落在那个范围内，你就得到那个类作为预测。</p><p id="f16f" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在转到您的<strong class="kr jt">测试数据</strong>选项卡，添加if语句以获得预测的类:</p><p id="14ab" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">显示这一点的IF语句示例如下:</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="4b12" class="ln lo jj nk b gy no np l nq nr">=IF(AND(G2&lt;data_banknote_authentication!$M$3,G2&gt;data_banknote_authentication!$N$3),data_banknote_authentication!$J$3,IF(AND(G2&lt;data_banknote_authentication!$M$4,G2&gt;data_banknote_authentication!$N$4),data_banknote_authentication!$J$4,"unpred"))</span></pre><p id="e084" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">注意“未预测”是没有预测到的。3%的1最终未被选中。</p><p id="993f" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我想对unpreds进行分类，而3%只是1，所以我在上面的语句后使用了另一个if语句:</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="6d2c" class="ln lo jj nk b gy no np l nq nr">=IF(H2=”unpred”,IF(G2&lt;0,1),H2)</span></pre><p id="cfab" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">请注意，这不是必需的，但它有助于消除3%的不可预测性，这是一个很低的数字。G2&lt;0 condition is derived is from the distribution of 1s:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/246c4f51e04c3fc2cae5c5ea2852e377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*KHJq5wxHP7GuQoLBkoIwTg.png"/></div></figure><p id="362d" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Now that we are done it is time to make the confusion matrix:</p><figure class="ml mm mn mo gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/2176349cf56bffd1828bcd30da962664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*kCTq-nJuQ-som56-2dnvlA.png"/></div></figure><p id="8ce5" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">You can use countifs to make a matrix:</p><p id="30b7" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">The confusion matrix above is made by the formula below in which F:F is the original class, I:I is the predicted class column. K and L, the criteria refer to the actual and pred class criteria value of 0 and 1.</p><pre class="ml mm mn mo gt nj nk nl nm aw nn bi"><span id="963b" class="ln lo jj nk b gy no np l nq nr">Starting at top left, and moving right then down and right again:</span><span id="27fa" class="ln lo jj nk b gy nx np l nq nr">=COUNTIFS(F:F,$K4,I:I,L$3)</span><span id="63d3" class="ln lo jj nk b gy nx np l nq nr">=COUNTIFS(F:F,$K4,I:I,M$3)</span><span id="9ef7" class="ln lo jj nk b gy nx np l nq nr">=COUNTIFS(F:F,$K4,I:I,N$3)</span><span id="425d" class="ln lo jj nk b gy nx np l nq nr">=COUNTIFS(F:F,$K5,I:I,L$3)</span><span id="3543" class="ln lo jj nk b gy nx np l nq nr">=COUNTIFS(F:F,$K5,I:I,M$3)</span><span id="4517" class="ln lo jj nk b gy nx np l nq nr">=COUNTIFS(F:F,$K5,I:I,N$3)</span></pre><p id="5880" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">When you divide these same values by 461, which is the number of testing records, you get the percentages.</p><p id="403c" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Thank you for reading.</p><p id="edad" class="pw-post-body-paragraph kp kq jj kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">References:</p><ol class=""><li id="8379" class="ny nz jj kr b ks kt kw kx la oa le ob li oc lm od oe of og bi translated">UCI Machine Learning Repository: BANKNOTE authentication data set. (n.d.). Retrieved March 08, 2021, from <a class="ae jg" href="https://archive.ics.uci.edu/ml/datasets/banknote+authentication" rel="noopener ugc nofollow" target="_blank">https://archive . ics . UCI . edu/ml/datasets/banknote+认证的方式</a></li><li id="df47" class="ny nz jj kr b ks oh kw oi la oj le ok li ol lm od oe of og bi translated">数据库所有者:Volker Lohweg(应用科学大学，Ostwestfalen-Lippe，Volker . loh weg<strong class="kr jt">' @ '</strong>hs-owl . de)<br/>数据库提供者:海伦·DÃ·洛克森(应用科学大学，Ostwestfalen-Lippe，海伦·多克森<strong class="kr jt"> '@' </strong> hs-owl.de) <br/>接收日期:2012年8月</li></ol></div></div>    
</body>
</html>