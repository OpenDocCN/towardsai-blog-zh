<html>
<head>
<title>A Beginner’s Guide to Predicting Stock Prices with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测股票价格的初学者指南</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/a-beginners-guide-to-predicting-stock-prices-with-machine-learning-f5a870f6b846?source=collection_archive---------2-----------------------#2022-12-19">https://pub.towardsai.net/a-beginners-guide-to-predicting-stock-prices-with-machine-learning-f5a870f6b846?source=collection_archive---------2-----------------------#2022-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1dd9b9d95155f60b11da21f9f122c3e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4GxN1z1jv4Ja14UG0vlxQ.jpeg"/></div></div></figure><h1 id="cfe4" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h1><p id="044d" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">预测股票价格是金融领域的一项热门任务。它包括根据过去的数据和市场趋势预测公司股票的未来价值。许多投资者利用股票价格预测来做出明智的决定，决定是否买入、卖出或持有某一特定股票。</p><p id="137c" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">在本教程中，我们将使用机器学习算法来预测股票的未来价格。机器学习是一种人工智能，涉及训练计算机学习数据模式，并基于这些模式进行预测。有许多不同类型的机器学习算法，我们将使用一种称为“回归算法”的特定类型来进行股票价格预测。</p><p id="1a4f" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">我们将使用<code class="fe mc md me mf b">yahoo_fin</code>库从雅虎财经中抓取股票数据，使用<code class="fe mc md me mf b">pandas</code>和<code class="fe mc md me mf b">sklearn</code>库对数据进行预处理和分析。</p><h1 id="5b1e" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">步骤1:收集数据</h1><p id="bdbb" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">创建机器学习模型的第一步是收集数据。在这种情况下，我们需要收集我们想要预测的股票的过去价格的数据。这些数据可以从股票市场数据库或提供历史股票价格信息的金融网站获得。</p><p id="703f" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">重要的是收集尽可能多的数据，以使我们的模型有最好的机会准确预测未来的股票价格。然而，确保数据干净无误也很重要。</p><p id="9bc7" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">下面是一个例子，说明我们如何使用Python中的<code class="fe mc md me mf b">yahoo_fin</code>和<code class="fe mc md me mf b">pandas</code>库来收集股票过去价格的数据:</p><pre class="mg mh mi mj gt mk mf ml bn mm mn bi"><span id="025a" class="mo kc it mf b be mp mq l mr ms">from yahoo_fin import stock_info as si<br/>import pandas as pd<br/><br/># Scrape stock data from Yahoo Finance<br/>stock_data = si.get_data("AAPL")<br/><br/># Print the first few rows of the data<br/>print(stock_data.head())</span></pre><p id="ae12" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">这段代码使用<code class="fe mc md me mf b">yahoo_fin</code>库中的<code class="fe mc md me mf b">get_data()</code>函数来抓取指定股票代码(在本例中，苹果公司的“AAPL”)的股票数据，并将其存储在<code class="fe mc md me mf b">pandas</code> DataFrame中。DataFrame是包含行和列的二维数据表。我们可以使用<code class="fe mc md me mf b">head()</code>方法打印数据帧的前几行，这将允许我们看到数据的结构。</p><h1 id="73fc" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">步骤2:预处理数据</h1><p id="ffda" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">一旦我们收集了数据，下一步就是对其进行预处理。预处理包括清理和格式化数据，以便它可以用于训练我们的机器学习模型。</p><p id="e535" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">这可能涉及以下任务:</p><ul class=""><li id="dcea" class="mt mu it lb b lc lx lg ly lk mv lo mw ls mx lw my mz na nb bi translated">删除任何缺失或不完整的数据点</li><li id="9c5c" class="mt mu it lb b lc nc lg nd lk ne lo nf ls ng lw my mz na nb bi translated">标准化数据(将其缩放到一致的范围)</li><li id="cc7c" class="mt mu it lb b lc nc lg nd lk ne lo nf ls ng lw my mz na nb bi translated">将数据分成训练集和测试集(下一步将详细介绍)</li></ul><p id="3e19" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">下面是一个例子，说明我们如何使用Python中的<code class="fe mc md me mf b">pandas</code>和<code class="fe mc md me mf b">sklearn</code>库预处理股票价格数据:</p><pre class="mg mh mi mj gt mk mf ml bn mm mn bi"><span id="50e0" class="mo kc it mf b be mp mq l mr ms">import pandas as pd<br/>from sklearn.preprocessing import MinMaxScaler<br/><br/># Read in stock price data from a CSV file<br/>stock_data = pd.read_csv("stock_prices.csv")<br/><br/># Drop any rows with missing data<br/>stock_data.dropna(inplace=True)<br/><br/># Normalize the data using the MinMaxScaler<br/>scaler = MinMaxScaler()<br/>stock_data_scaled = scaler.fit_transform(stock_data)<br/><br/># Split the data into training and testing sets<br/>training_data = stock_data_scaled[:int(len(stock_data_scaled) * 0.8)]<br/>testing_data = stock_data_scaled[int(len(stock_data_scaled) * 0.8):]</span></pre><p id="527c" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">在这段代码中，我们使用<code class="fe mc md me mf b">dropna()</code>方法从DataFrame中删除任何缺少数据的行。然后，我们从<code class="fe mc md me mf b">sklearn</code>库中创建了一个<code class="fe mc md me mf b">MinMaxScaler</code>类的实例，并使用它通过将数据缩放到0和1之间的一致范围来规范化数据。这有助于提高机器学习模型的性能。</p><p id="fc7c" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">最后，我们使用索引将规范化的数据分成训练集和测试集。训练集将用于训练模型，测试集将用于评估模型的性能。</p><h1 id="a48d" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">第三步:训练模型</h1><p id="f962" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">既然我们已经预处理了数据，我们就可以开始训练我们的机器学习模型了。这包括将数据输入到模型中，并调整模型的内部参数以优化其性能。</p><p id="08d2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">为了训练机器学习模型，我们通常将数据分成两组:训练集和测试集。训练集用于训练模型，测试集用于评估模型的性能。</p><p id="d1ef" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">在这种情况下，我们将使用回归算法来预测股票价格。回归算法用于预测连续值，如股票价格。有许多不同类型的回归算法，包括线性回归、岭回归和套索回归。</p><p id="17d2" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">下面是我们如何使用Python中的<code class="fe mc md me mf b">sklearn</code>库训练线性回归模型的例子:</p><pre class="mg mh mi mj gt mk mf ml bn mm mn bi"><span id="b7c1" class="mo kc it mf b be mp mq l mr ms">from sklearn.linear_model import LinearRegression<br/><br/># Create a linear regression model<br/>model = LinearRegression()<br/><br/># Train the model on the training data<br/>model.fit(training_data, training_targets)</span></pre><p id="4faf" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">在这段代码中，我们创建了一个<code class="fe mc md me mf b">LinearRegression</code>类的实例，并使用<code class="fe mc md me mf b">fit()</code>方法根据训练数据训练模型。训练数据由过去的股票价格组成，训练目标是我们要预测的未来股票价格。</p><h1 id="2f09" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">步骤4:测试模型</h1><p id="1289" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">一旦模型被训练，我们可以使用测试集来评估它的性能。这包括将测试集输入到模型中，并将模型的预测与实际股票价格进行比较。</p><p id="cd25" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">我们可以使用几个指标来评估模型的性能，例如平均绝对误差和均方根误差。这些指标告诉我们模型的预测有多准确，我们可以使用它们来微调模型并提高其性能。</p><p id="fbee" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">下面是一个例子，说明我们如何使用Python中的<code class="fe mc md me mf b">sklearn</code>库来评估线性回归模型的性能:</p><pre class="mg mh mi mj gt mk mf ml bn mm mn bi"><span id="1901" class="mo kc it mf b be mp mq l mr ms">from sklearn.metrics import mean_absolute_error, mean_squared_error<br/><br/># Make predictions on the testing data<br/>predictions = model.predict(testing_data)<br/><br/># Calculate the mean absolute error and mean squared error<br/>mae = mean_absolute_error(testing_targets, predictions)<br/>mse = mean_squared_error(testing_targets, predictions)<br/><br/># Print the results<br/>print(f"Mean Absolute Error: {mae:.2f}")<br/>print(f"Mean Squared Error: {mse:.2f}")</span></pre><p id="7cea" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">在这段代码中，我们使用<code class="fe mc md me mf b">predict()</code>方法对测试数据进行预测，使用<code class="fe mc md me mf b">sklearn</code>库中的<code class="fe mc md me mf b">mean_absolute_error()</code>和<code class="fe mc md me mf b">mean_squared_error()</code>函数计算模型的平均绝对误差(MAE)和均方误差(MSE)。</p><p id="30b0" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">MAE是模型预测中误差的平均大小的度量，而MSE是误差的平均平方大小的度量。这两个指标对于评估回归模型的性能都很有用。</p><h1 id="59a3" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">第五步:做预测</h1><p id="7a0c" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在我们训练和测试了我们的模型之后，我们可以用它来对新数据进行预测。这可能包括输入当前股票价格，并使用模型预测未来价格。</p><p id="9192" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">重要的是要记住，股票价格预测并不总是准确的，有许多因素可以影响股票的价格。因此，在使用机器学习模型进行投资决策时，谨慎使用非常重要。</p><p id="5088" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">以下是我们如何使用训练好的线性回归模型对新数据进行预测的示例:</p><pre class="mg mh mi mj gt mk mf ml bn mm mn bi"><span id="0dc1" class="mo kc it mf b be mp mq l mr ms"># Make predictions on new data<br/>new_data = [[100, 200, 300]]<br/>predictions = model.predict(new_data)<br/><br/># Print the predictions<br/>print(predictions)</span></pre><p id="052d" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">在这段代码中，我们使用<code class="fe mc md me mf b">predict()</code>方法对包含过去股票价格的新数据集进行预测。该模型将使用它在训练中学习的模式来预测未来的股票价格。</p><h1 id="cac5" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h1><p id="3315" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在本教程中，我们介绍了使用机器学习算法预测股票价格的步骤。我们收集数据，对其进行预处理，训练线性回归模型，测试该模型，并使用该模型进行预测。虽然机器学习可以成为预测股价的强大工具，但重要的是要记住，有许多因素可以影响股票的价格，没有模型是完美的。</p><p id="c0e3" class="pw-post-body-paragraph kz la it lb b lc lx le lf lg ly li lj lk lz lm ln lo ma lq lr ls mb lu lv lw im bi translated">作为最后一点，重要的是要记住，本教程只是使用机器学习算法预测股票价格的过程的概述。在建立和使用机器学习模型时，需要更多的细节和考虑，在做出投资决定之前，做进一步的研究和寻求专家的建议总是一个好主意。</p></div></div>    
</body>
</html>