<html>
<head>
<title>Detecting Fake News with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习检测假新闻</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/detecting-fake-news-with-machine-learning-88761ec6d251?source=collection_archive---------4-----------------------#2021-12-31">https://pub.towardsai.net/detecting-fake-news-with-machine-learning-88761ec6d251?source=collection_archive---------4-----------------------#2021-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="8078" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="d37e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">“假新闻和谣言在网上盛行，因为很少有人核实什么是真实的，并且总是偏向于强化他们自己偏见的内容”。</p><p id="535d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="kx"> - </em>瑞安·比嘉</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/47f8054ecd35ea2a78be7d79afc6d9ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isXVz6sQ2PkDLpFytHbqiA.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">iStockphoto的Getty Images</figcaption></figure><p id="2325" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">什么是假新闻？</strong></p><p id="81a7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">假新闻可以定义为以文章、故事、图像或视频的形式分享的虚假报道或错误信息，这些报道或信息以“真实新闻”的形式呈现，但实际上是为了操纵人们的观点。这些新闻故事没有可核实的事实或可信的来源。有时，这些故事被用于宣传，旨在误导读者，或者可能被用作经济刺激的“点击诱饵”，作者从点击故事的人数中获利。</p><p id="1e59" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">假新闻可能是由个人或团体为了他们自己或第三方的利益而制造的。假新闻通过社交媒体用户和隐藏的社交机器人迅速传播，这些社交机器人评论、转发和转发新闻文章。</p><p id="7400" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">假新闻的种类</strong></p><p id="9b1a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">《媒体更新》的执行主编阿诗玲·麦卡锡描述了五种最常见的假新闻。其中包括以下内容:</p><p id="86eb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.讽刺或戏仿——讽刺文章旨在通过使用幽默、讽刺、夸张和嘲笑来尝试真实的新闻。它经常被用作一种社会或政治评论的形式。通常，讽刺性新闻网站被制作得看起来像真实的新闻网站，并试图模仿它们。然而，正是这一事实往往会导致读者上当受骗。</p><p id="2a6c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.在某些情况下是真实的误导性新闻——把这想成是部分真实的事实，但是用在了错误的情况下。这些都是经过选择的事实，只是为了成为头条新闻而被报道——但它们往往是对事实的曲解。</p><p id="7fb5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.制造虚假联系的报道——这种类型的假新闻将两件或更多不相关的事情联系在一起，其中一篇报道的照片、说明或标题与内容不符。它通常与clickbait联系在一起，标题是“你不知道的名人已经去世”,上面还有一张名人的照片。一旦你点击阅读了这篇文章，你会意识到文章中根本没有提到图片中的人。</p><p id="91a7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.被操纵的内容——这种类型的假新闻是事情真正变得邪恶的地方。这些内容确实呈现了真实的信息——通常甚至是照片和视频——但却被以某种方式操纵了。这类内容很大程度上依赖于“fauxtography”。</p><p id="f278" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.有意欺骗的内容—这是专门为误导人们而设计的内容<em class="kx"> </em>。这类新闻是为了通过获得大量点击来赚钱，或者作为耸人听闻的宣传来引起混乱或不满而捏造的。这些故事通常通过看起来像“真正的”新闻品牌的网站传播，通常包含被操纵来推动议程的图形和视频。</p><p id="5125" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">假新闻的例子</strong></p><p id="dfdb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="kx">冠状病毒假新闻:</em>新冠肺炎疫情为网上虚假信息提供了沃土，在整个危机中假新闻的例子数不胜数。社交媒体中假新闻的一个持久例子是声称5G技术与病毒的传播有关——据说是因为5G抑制了免疫系统，而病毒通过无线电波传播。这些说法是不真实的，<a class="ae lo" href="https://www.bbc.co.uk/news/52168096" rel="noopener ugc nofollow" target="_blank">被官方来源</a>多次揭穿，但仍被广泛分享。</p><p id="78cf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="kx">2016年美国总统大选:</em>假新闻和错误信息成为2016年美国大选期间的一个大问题，虚假和误导性的说法遍布整个政治光谱。一项分析表明，选举中产生的很大一部分假新闻是由马其顿的青少年创造的，他们发现他们创造的超党派故事越多，点击和分享的人就越多，结果他们赚的钱就越多。</p><p id="2d8d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="kx">波士顿马拉松爆炸案:</em>2013年波士顿马拉松爆炸案发生后，网上流传着关于爆炸是美国政府精心策划的骗局的虚假说法。随着世界各地许多恐怖事件的发生，阴谋论经常盛行。认为它们是“假旗”行动的概念——即由国家或秘密阴谋集团实施，以将责任归咎于他人或为其他活动提供掩护——是一个常见的比喻。</p><p id="093c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">金正恩——当今最性感的男人？2012年，讽刺网站The Onion刊登了一篇文章，声称朝鲜独裁者金正恩被选为最性感的男人，并宣称“这个在平壤长大的万人迷是每个女人的梦想成真”讽刺有时会被不同文化误解的一个例子是，中国的出版物——包括中国共产党报纸的网络版——报道了这种说法，好像它是真的一样。</p><p id="6348" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">假新闻有哪些危害？</strong></p><p id="3f07" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下面列举了假新闻产生的一些危害。</p><p id="f9de" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.研究表明，许多美国人分不清哪些新闻是假的，哪些是真的。许多假新闻旨在扰乱和加剧社会冲突。当争论的不同方面有自己的一套“事实”时，这将导致社会内部更大的两极分化，并可能影响选举结果和导致暴力。</p><p id="79d2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.有许多虚假和误导性的新闻故事与医学治疗或癌症或糖尿病等重大疾病有关。相信这些故事会导致人们做出错误的决定，这对他们的健康有不利影响。</p><p id="c638" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.假新闻让认识真相变得更加困难。一项<a class="ae lo" href="https://www.theatlantic.com/ideas/archive/2019/06/fake-news-republicans-democrats/591211/" rel="noopener ugc nofollow" target="_blank">皮尤研究中心</a>的研究发现，政治光谱中的左派和右派对“假新闻”的定义有不同的看法。“皮尤的研究表明，假新闻恐慌，而不是驱使人们放弃意识形态渠道和边缘，实际上可能正在加速两极分化的过程:它驱使消费者放弃一些渠道，只是总体上消费更少的信息，甚至切断社会关系。”</p><p id="0fa0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">人们尽可能不带偏见地寻找新闻来源是非常重要的。像美联社和路透社这样的新闻服务机构努力提供准确、中立的重大新闻事件报道。</p><p id="ec00" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">一个潜在的解决方案</strong></p><p id="8b69" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">假新闻的威胁和危险是严重的，需要立即解决。我相信我们可以<strong class="kb jd"> </strong>使用自然语言处理和机器学习模型来分析新闻文章的内容，确定它们是真实的还是虚假的。这需要高度准确地完成和证明。一旦完成，媒体源(即脸书、Twitter和YouTube)需要在生产中实施这些模型，并识别和丢弃任何被确定为虚假或错误信息的文章、消息或文本。</p><p id="c2fc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">路线图</strong></p><p id="df54" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本文的剩余部分将展示一个程序，该程序将尝试根据新闻文章中的文本来预测新闻文章是真是假。以下步骤将使用机器学习和Python来执行。</p><p id="a5c2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.导入所需的软件库。</p><p id="647c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.加载数据。</p><p id="5a8b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.数据分析和探索。</p><p id="1fcb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.将文本转换为数字。</p><p id="045b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.将数据分为训练数据集和测试数据集。</p><p id="b68f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">6.根据训练数据训练模型。</p><p id="36ef" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">7.根据测试数据进行预测。</p><p id="8646" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">8.评估模型的性能。</p><p id="83b6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">9.从评估中得出结论。</p><p id="2907" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">程序</strong></p><p id="3363" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用机器学习模型从新闻文章中检测假新闻的程序如下所示。</p><p id="66d6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">导入所需的软件库</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="d23b" class="lu lv it lq b gy lw lx l ly lz"><strong class="lq jd">import</strong> numpy <strong class="lq jd">as</strong> np<br/><strong class="lq jd">import</strong> pandas <strong class="lq jd">as</strong> pd<br/><strong class="lq jd">import</strong> matplotlib.pyplot <strong class="lq jd">as</strong> plt<br/><strong class="lq jd">import</strong> seaborn <strong class="lq jd">as</strong> sns<br/><strong class="lq jd">import</strong> itertools<br/><strong class="lq jd">from</strong> sklearn.model_selection <strong class="lq jd">import</strong> train_test_split<br/><strong class="lq jd">from</strong> sklearn.feature_extraction.text <strong class="lq jd">import</strong> TfidfVectorizer<br/><strong class="lq jd">from</strong> sklearn.linear_model <strong class="lq jd">import</strong> PassiveAggressiveClassifier<br/><strong class="lq jd">from</strong> sklearn.linear_model <strong class="lq jd">import</strong> LogisticRegression<br/><strong class="lq jd">from</strong> sklearn.svm <strong class="lq jd">import</strong> SVC<br/><strong class="lq jd">from</strong> sklearn.ensemble <strong class="lq jd">import</strong> RandomForestClassifier<br/><strong class="lq jd">from</strong> sklearn.metrics <strong class="lq jd">import</strong> accuracy_score, classification_report</span></pre><p id="0563" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">加载数据</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="0788" class="lu lv it lq b gy lw lx l ly lz"><strong class="lq jd">from</strong> google.colab <strong class="lq jd">import</strong> files <em class="kx"># Use to load data on Google Colab</em><br/>uploaded <strong class="lq jd">=</strong> files<strong class="lq jd">.</strong>upload()      <em class="kx"># Use to load data on Google Colab</em></span></pre><p id="9adc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">将数据存储到数据帧中</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="2a4c" class="lu lv it lq b gy lw lx l ly lz">news <strong class="lq jd">=</strong> pd<strong class="lq jd">.</strong>read_csv('news.csv')</span></pre><p id="582c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据分析与探索</strong></p><p id="f28c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">过滤数据并重命名一些列以使其更有意义。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="22d5" class="lu lv it lq b gy lw lx l ly lz">news <strong class="lq jd">=</strong> news[['Unnamed: 0', 'title', 'text', 'label']]<strong class="lq jd">.</strong>copy()<br/>news<strong class="lq jd">.</strong>rename(columns <strong class="lq jd">=</strong> {'Unnamed: 0':'ID'}, inplace <strong class="lq jd">=</strong> <strong class="lq jd">True</strong>)<br/>news<strong class="lq jd">.</strong>rename(columns <strong class="lq jd">=</strong> {'label':'news_type'}, inplace <strong class="lq jd">=</strong> <strong class="lq jd">True</strong>)</span></pre><p id="42aa" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">打印数据框的前5行。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="544b" class="lu lv it lq b gy lw lx l ly lz">news<strong class="lq jd">.</strong>head()</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ma"><img src="../Images/d7e2149fc9dc02831d1b68853173c5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywnRGkniyJ6lyNUJr5LuBg.png"/></div></div></figure><p id="84c1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">这些数据来自Kaggle的网站。点击<a class="ae lo" href="https://www.kaggle.com/shubh0799/fake-news" rel="noopener ugc nofollow" target="_blank">链接</a>可以找到数据</p><p id="08eb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下面列出了列和定义。应该注意的是，每篇新闻文章的“假”或“真”的新闻类型在分配之前都经过了研究和核实。</p><ol class=""><li id="05b6" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mg mh mi mj bi translated">ID —新闻标识符。</li><li id="35e6" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mg mh mi mj bi translated">标题—文章的标题。</li><li id="0677" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mg mh mi mj bi translated">文本—文章的文本。</li><li id="8888" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mg mh mi mj bi translated">news_type —新闻的一种类型(“假”或“真”)。</li></ol><p id="50ed" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示有关数据列的信息。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="fa32" class="lu lv it lq b gy lw lx l ly lz">news<strong class="lq jd">.</strong>info()<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 7795 entries, 0 to 7794<br/>Data columns (total 4 columns):<br/> #   Column     Non-Null Count  Dtype <br/>---  ------     --------------  ----- <br/> 0   ID         7576 non-null   object<br/> 1   title      7185 non-null   object<br/> 2   text       6929 non-null   object<br/> 3   news_type  6755 non-null   object<br/>dtypes: object(4)<br/>memory usage: 243.7+ KB</span></pre><p id="8e75" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">有7，795篇文章和4个专栏。所有变量都是字母数字，包含空值或缺失值。</p><p id="7043" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">某些数据在新闻类型列中的值不是真实的或虚假的。因此，有必要过滤数据框，使其仅包含新闻类型等于真实或虚假的行。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="15e9" class="lu lv it lq b gy lw lx l ly lz">options <strong class="lq jd">=</strong> ['REAL', 'FAKE'] <br/>news <strong class="lq jd">=</strong> news<strong class="lq jd">.</strong>loc[news['news_type']<strong class="lq jd">.</strong>isin(options)]</span></pre><p id="a17d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示新闻类型和每种新闻类型的数量。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="e5b0" class="lu lv it lq b gy lw lx l ly lz">news['news_type']<strong class="lq jd">.</strong>value_counts()</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mp"><img src="../Images/b7bc9d5ddddaa3e8e91d4174d735ae2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FBxR7q4RXJpDlDkYhQRenQ.png"/></div></div></figure><p id="297b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化新闻类型分布。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="9285" class="lu lv it lq b gy lw lx l ly lz">news<strong class="lq jd">.</strong>news_type<strong class="lq jd">.</strong>value_counts()<strong class="lq jd">.</strong>plot(kind<strong class="lq jd">=</strong>'pie', autopct<strong class="lq jd">=</strong>'%1.0f%%',  fontsize<strong class="lq jd">=</strong>12, figsize<strong class="lq jd">=</strong>(9,6), colors<strong class="lq jd">=</strong>["red", "blue"])<br/>plt<strong class="lq jd">.</strong>ylabel('News Type', size<strong class="lq jd">=</strong>14)</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mq"><img src="../Images/83d0c84b4f6b279e25810a8b325876ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8Q-zxedbZCyA-0bC2WMKA.png"/></div></div></figure><p id="65b2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">这很好，因为新闻文章平均分布在真实新闻和虚假新闻之间。</p><p id="734e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们现在需要将数据集分为要素数据集和标注数据集。特征数据集将仅包括第三列或索引2中的新闻文章文本。标签数据集将包括我们希望在第4列或第3索引中预测的文章的新闻类型。我们将对新闻数据框使用分块方法来创建要素和标注数据集。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="bead" class="lu lv it lq b gy lw lx l ly lz">features <strong class="lq jd">=</strong> news<strong class="lq jd">.</strong>iloc[:, 2]<strong class="lq jd">.</strong>values<br/>labels <strong class="lq jd">=</strong> news<strong class="lq jd">.</strong>iloc[:, 3]<strong class="lq jd">.</strong>values</span></pre><p id="4e1d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">将数据分成训练和测试数据集</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="3ff2" class="lu lv it lq b gy lw lx l ly lz"># Use train_test_split function to generate training data and test data. Test data set will be 20% of the original data set.<br/><br/>x_training_data, x_test_data, y_training_data, y_test_data <strong class="lq jd">=</strong> train_test_split(news['text'], labels, test_size<strong class="lq jd">=</strong>0.2, random_state<strong class="lq jd">=</strong>7)</span></pre><p id="a7ce" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">将文本转换成数字</strong></p><p id="6698" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">统计算法使用数学来训练机器学习模型，而数学只对数字有效。因此，为了使统计算法能够处理文本，我们需要将文本转换成数字。为了做到这一点，我们将使用TF-IDF，它代表词频—逆文档频率。TF-IDF方法背后的思想是，在所有文章中出现较少而在单个文章中出现较多的单词对分类贡献更大。TF-IDF是应用于我们数据集中每篇文章中每个词的分数。并且对于每一个单词，TF-IDF值随着该单词在一篇文章中的每一次出现而增加，但是会随着在其他文章中的每一次出现而逐渐减少。</p><p id="f6fc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">TF和IDF计算如下:</p><ul class=""><li id="336d" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mr mh mi mj bi translated">TF =(文档中单词的频率)/(文档中的总单词数)</li><li id="5531" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mr mh mi mj bi translated">IDF = Log((文档总数)/(包含该单词的文档数))</li></ul><p id="673a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用Python的Scikit-Learn库，其中包含TfidfVectorizer类，用于将文本特征转换为TF-IDF特征向量。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="35c5" class="lu lv it lq b gy lw lx l ly lz"><strong class="lq jd">import</strong> nltk <br/><strong class="lq jd">from</strong> nltk.corpus <strong class="lq jd">import</strong> stopwords<br/>nltk<strong class="lq jd">.</strong>download('stopwords')<br/><strong class="lq jd">from</strong> sklearn.feature_extraction.text <strong class="lq jd">import</strong> TfidfVectorizer<br/># Initialize TfidfVectorizer<br/>vectorizer <strong class="lq jd">=</strong> TfidfVectorizer (stop_words<strong class="lq jd">=</strong>('english'), max_df<strong class="lq jd">=</strong>0.7)<br/><br/># Fit and transform training and test data sets.<br/>tfidf_train <strong class="lq jd">=</strong> vectorizer<strong class="lq jd">.</strong>fit_transform((x_training_data)<strong class="lq jd">.</strong>astype('U'))<br/>tfidf_test <strong class="lq jd">=</strong> vectorizer<strong class="lq jd">.</strong>transform(x_test_data)</span></pre><ul class=""><li id="34d6" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mr mh mi mj bi translated">max_df设置为0.7，指定只使用在最多70%的新闻文章中出现的那些词。在所有新闻文章中出现的单词对分类没有用处。</li></ul><p id="4c58" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，我们将训练模型，进行预测，并评估四种不同模型的性能。</p><p id="7316" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">被动攻击性量词</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="e77e" class="lu lv it lq b gy lw lx l ly lz"># Create model object.<br/>pa <strong class="lq jd">=</strong> PassiveAggressiveClassifier(max_iter<strong class="lq jd">=</strong>50)<br/># Train the model on the training data.<br/>pa<strong class="lq jd">.</strong>fit(tfidf_train, y_training_data) <br/># Make predictions on the test data. <br/>predictions_pa <strong class="lq jd">=</strong> pa<strong class="lq jd">.</strong>predict(tfidf_test)</span></pre><p id="4936" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="2baf" class="lu lv it lq b gy lw lx l ly lz">pa <strong class="lq jd">=</strong> accuracy_score(y_test_data, predictions_pa)<br/>print(f'Accuracy: {round(pa<strong class="lq jd">*</strong>100,2)}%')</span></pre><p id="642a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:92.56%</p><p id="59ee" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="1a81" class="lu lv it lq b gy lw lx l ly lz">print(classification_report(y_test_data, predictions_pa))</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ms"><img src="../Images/d5136e82d7df3481b260da4d42bbeba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hknpEvbGTn1Q-kEXMvk6mw.png"/></div></div></figure><p id="a375" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">被动-主动分类器模型准确预测了93%的新闻文章是假的还是真的。</p><ul class=""><li id="050d" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mr mh mi mj bi translated">91%正确预测假新闻。</li><li id="850c" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mr mh mi mj bi translated">94%正确预测了真实新闻。</li></ul><p id="adbd" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">逻辑回归模型</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="c322" class="lu lv it lq b gy lw lx l ly lz"># Create model object.<em class="kx"> </em><br/>model_lr <strong class="lq jd">=</strong> LogisticRegression(max_iter<strong class="lq jd">=</strong>150)<br/># Train the model on the training data.<br/>model_lr<strong class="lq jd">.</strong>fit(tfidf_train, y_training_data)<br/># Make predictions on the test data. <br/>predictions_lr <strong class="lq jd">=</strong> model_lr<strong class="lq jd">.</strong>predict(tfidf_test)</span></pre><p id="6358" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="1a2a" class="lu lv it lq b gy lw lx l ly lz">lr <strong class="lq jd">=</strong> accuracy_score(y_test_data, predictions_lr)<br/>print(f'Accuracy: {round(lr<strong class="lq jd">*</strong>100,2)}%')</span></pre><p id="b5a5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:90.42%</p><p id="4da3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="4283" class="lu lv it lq b gy lw lx l ly lz">print(classification_report(y_test_data, predictions_lr))</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mt"><img src="../Images/3473801a3391791c42730deb149965be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XW5-rD6gx70x6bqt6qsChw.png"/></div></div></figure><p id="9c27" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">逻辑回归模型准确地预测了90%的新闻文章是假的还是真的。</p><ul class=""><li id="1668" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mr mh mi mj bi translated">87%正确预测假新闻。</li><li id="768d" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mr mh mi mj bi translated">94%正确预测了真实新闻。</li></ul><p id="9d14" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">支持向量机模型</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="89dd" class="lu lv it lq b gy lw lx l ly lz"># Create model object. <br/>model_sv <strong class="lq jd">=</strong> SVC()<br/># Train the model on the training data.<br/>model_sv<strong class="lq jd">.</strong>fit(tfidf_train, y_training_data)<br/># Make predictions on the test data. <br/>predictions_sv <strong class="lq jd">=</strong> model_sv<strong class="lq jd">.</strong>predict(tfidf_test)</span></pre><p id="c341" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="7822" class="lu lv it lq b gy lw lx l ly lz">sv <strong class="lq jd">=</strong> accuracy_score(y_test_data, predictions_sv)<br/>print(f'Accuracy: {round(sv<strong class="lq jd">*</strong>100,2)}%')</span></pre><p id="afac" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:91.37%</p><p id="ae1e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="1fb8" class="lu lv it lq b gy lw lx l ly lz">print(classification_report(y_test_data, predictions_sv))</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mu"><img src="../Images/3fc604e0c8df3b62b31b892d82b78e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ryB9ogWf1kH4uIw6gLgbpg.png"/></div></div></figure><p id="2ff9" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">支持向量机模型准确预测了91%的新闻文章是假的还是真的。</p><ul class=""><li id="b2f7" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mr mh mi mj bi translated">88%正确预测假新闻。</li><li id="1455" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mr mh mi mj bi translated">95%正确预测了真实新闻。</li></ul><p id="b13e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">随机福里斯特模型</strong></p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="a69b" class="lu lv it lq b gy lw lx l ly lz"># Create model object.<em class="kx"> </em><br/>model_rf <strong class="lq jd">=</strong> RandomForestClassifier(n_estimators <strong class="lq jd">=</strong> 200, random_state<strong class="lq jd">=</strong>0)<br/># Train the model on the training data.<br/>model_rf<strong class="lq jd">.</strong>fit(tfidf_train, y_training_data)<br/># Make predictions on the test data.<em class="kx"> </em><br/>predictions_rf <strong class="lq jd">=</strong> model_rf<strong class="lq jd">.</strong>predict(tfidf_test)</span></pre><p id="84c0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="68a3" class="lu lv it lq b gy lw lx l ly lz">rf <strong class="lq jd">=</strong> accuracy_score(y_test_data, predictions_rf)<br/>print(f'Accuracy: {round(rf<strong class="lq jd">*</strong>100,2)}%')</span></pre><p id="9c07" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:90.58%</p><p id="9321" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="b16f" class="lu lv it lq b gy lw lx l ly lz">print(classification_report(y_test_data, predictions_rf))</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mv"><img src="../Images/07e3ddd4ecf4f5bd2482ff574053515b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E7O_BZbKiMXI2D5kyqf8Jg.png"/></div></div></figure><p id="5c8e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">随机森林模型准确地预测了91%的新闻文章是假的还是真的。</p><ul class=""><li id="1bc1" class="mb mc it kb b kc kd kg kh kk md ko me ks mf kw mr mh mi mj bi translated">89%正确预测假新闻。</li><li id="2e73" class="mb mc it kb b kc mk kg ml kk mm ko mn ks mo kw mr mh mi mj bi translated">92%正确预测了真实新闻。</li></ul><p id="c54c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示每个模型的准确度分数。</p><pre class="kz la lb lc gt lp lq lr ls aw lt bi"><span id="9aa8" class="lu lv it lq b gy lw lx l ly lz">models <strong class="lq jd">=</strong> pd<strong class="lq jd">.</strong>DataFrame({<br/>    'Model':['Passive Aggresive Classifier', 'Logistic Regression', 'Support Vector Machine', 'Random Forrest'],<br/>    'Accuracy_score' :[pa, lr, sv, rf]<br/>})<br/>models<br/>sns<strong class="lq jd">.</strong>barplot(x<strong class="lq jd">=</strong>'Accuracy_score', y<strong class="lq jd">=</strong>'Model', data<strong class="lq jd">=</strong>models)<br/><br/>models<strong class="lq jd">.</strong>sort_values(by<strong class="lq jd">=</strong>'Accuracy_score', ascending<strong class="lq jd">=False</strong>)</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mw"><img src="../Images/e18986c1fa2d58c7f93b7275644abd23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQq0MpG5UlSkqitFk3dAoA.png"/></div></div></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mx"><img src="../Images/b911ab795692e3b490d3b83d3959cb3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ek-3ewEUnapS6T8pZs8RIQ.png"/></div></div></figure><p id="478f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">结论:新闻出版物分析是自然语言处理中最常执行的任务之一。这种分析有助于确定一篇新闻文章的内容是真实可信还是虚假误导。</p><p id="4897" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">被动-主动分类器模型具有最高的准确度分数。该模型根据文章中的文本正确预测了93%的新闻文章是假的还是真的。紧随其后的是支持向量机模型，它根据文章中的文本正确预测了91%的新闻文章是假的还是真的。被动-主动分类器和支持向量机模型在预测真实新闻方面都略好于假新闻。</p><p id="1b2a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可以通过增加数据集中新闻文章的数量和调整模型的一些超参数来提高模型的准确性。</p><p id="8b84" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">非常感谢你阅读我的文章！如果您有任何意见或反馈，请在下面添加。</p><p id="5349" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。会员资格让你可以无限制地接触媒体上的故事。你可以使用此链接<a class="ae lo" href="https://medium.com/@dniggl/membership" rel="noopener">https://medium.com/@dniggl/membership</a>注册</p></div></div>    
</body>
</html>