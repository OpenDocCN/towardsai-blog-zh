<html>
<head>
<title>Start Using Annotations In Your Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始在Python代码中使用注释</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/start-using-annotations-in-your-python-code-f410bbc61426?source=collection_archive---------0-----------------------#2021-05-09">https://pub.towardsai.net/start-using-annotations-in-your-python-code-f410bbc61426?source=collection_archive---------0-----------------------#2021-05-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="0836" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming/python" rel="noopener ugc nofollow" target="_blank"> PYTHON </a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="26e3" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">理解Python中的函数和变量注释</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/a912194a2b02da0018455f50abf69fb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zRWanhgppRcsJQG7dcLvWA.png"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">作者图片</figcaption></figure></div><div class="ab cl li lj hy lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="in io ip iq ir"><h1 id="2c9f" class="lp lq iu bd lr ls lt lu lv lw lx ly lz kj ma kk mb km mc kn md kp me kq mf mg bi translated">介绍</h1><p id="80d2" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">C、C++、Java等编程语言。是静态类型语言，这意味着在程序中实际使用变量之前，必须声明变量的数据类型。另一方面，Python是一种动态类型语言，这意味着您不必事先声明变量的数据类型。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj nd"><img src="../Images/f3f82837bb172115ea86e9c90d9551f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6nQq7UjYGRs97obALDajWw.png"/></div></div></figure><p id="e82e" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">静态类型语言和动态类型语言各有利弊。动态类型语言的一个问题是类型错误只能在运行时被捕获。Python提供了一种借助<strong class="mj je">注释</strong>来处理这个问题的方法。但是请记住，<strong class="mj je"> Python并不强制注释</strong>，而是向开发人员提示变量的数据类型，以便在运行之前发现类型错误。让我们通过例子来理解什么是注释，不同的类型，以及它们是如何有帮助的。</p></div><div class="ab cl li lj hy lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="in io ip iq ir"><h1 id="b33a" class="lp lq iu bd lr ls lt lu lv lw lx ly lz kj ma kk mb km mc kn md kp me kq mf mg bi translated">什么是注释</h1><p id="d231" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">正如我们刚刚在简介部分所介绍的，注释是Python的特性，它向开发人员提示变量或函数参数的数据类型以及返回类型。它们还增加了Python程序的可读性。</p><p id="cfb1" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">Python中的注释主要有两种:<strong class="mj je">函数注释</strong>和<strong class="mj je">变量(类型)注释</strong>。我们将首先浏览函数注释，然后深入到变量注释。</p><h1 id="637b" class="lp lq iu bd lr ls nj lu lv lw nk ly lz kj nl kk mb km nm kn md kp nn kq mf mg bi translated">函数注释</h1><p id="8d15" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">函数注释的<strong class="mj je">语法</strong>如下所示:</p><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="40dd" class="nt lq iu np b gz nu nv l nw nx">def func(a: &lt;expression&gt;, b: &lt;expression&gt;) -&gt; &lt;expression&gt; :<br/>    pass</span></pre><p id="8e21" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">上面的函数注释语法接受两个参数<strong class="mj je"> a </strong>和<strong class="mj je">b</strong>，函数的返回类型表示为<code class="fe ny nz oa np b"><strong class="mj je">-&gt; &lt;expression&gt;</strong></code>。<strong class="mj je"> &lt;表达式&gt; </strong>可以是任何东西。它可以包含参数的描述或数据类型等。然而，最常见的是，<strong class="mj je">函数注释</strong>用于表示函数参数的数据类型和函数返回类型。</p><p id="0951" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">让我们看几个例子。以下三个示例采用两个参数并返回它们的和。可以看到，<strong class="mj je"> &lt;表达式&gt; </strong>可以是任何东西。这三个都是有效的函数定义，但是它展示了使用函数注释的不同方式。</p><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="d168" class="nt lq iu np b gz nu nv l nw nx">def func1(num1: "1st param", num2: "2nd param") -&gt; "return type":<br/>    return num1 + num2</span><span id="3b27" class="nt lq iu np b gz ob nv l nw nx">def func2(num1: int, num2: int) -&gt; int:<br/>    return num1 + num2</span><span id="529f" class="nt lq iu np b gz ob nv l nw nx">def func3(num1: int, num2: int=10) -&gt; int :<br/>    return num1 + num2</span></pre><p id="777f" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">在第一个例子中，我们使用了一些描述性的文字。在第二个示例中，参数的数据类型，在第三个示例中，参数的数据类型以默认值作为注释。</p><p id="33fc" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">注意，如果有任何参数有默认值，那么注释必须总是在参数的默认值之前，就像你在上面第三个例子中看到的那样。</p><h1 id="ec89" class="lp lq iu bd lr ls nj lu lv lw nk ly lz kj nl kk mb km nm kn md kp nn kq mf mg bi translated">如何访问注释</h1><p id="31e2" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">可以使用函数对象上的<strong class="mj je"> __annotations__ </strong>属性来访问函数注释。<strong class="mj je"> __annotations__ </strong>以字典的形式给出结果，其中键和值分别映射到参数和注释。</p><p id="7b04" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">在下面的例子中，<strong class="mj je"> num1 </strong>和<strong class="mj je"> num2 </strong>是函数参数，其中<strong class="mj je"> int </strong>作为注释，表示参数的预期数据类型。注意，即使<strong class="mj je">返回</strong>不是一个参数，Python还是添加了它来指示函数的返回类型。</p><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="4e31" class="nt lq iu np b gz nu nv l nw nx">def func(num1: int, num2: int=10) -&gt; int :<br/>    return num1 + num2<br/>print(func.__annotations__)</span><span id="5b18" class="nt lq iu np b gz ob nv l nw nx"><strong class="np je">&gt;&gt;&gt; {'num1': int, 'num2': int, 'return': int}</strong></span></pre><p id="4635" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">您可能已经猜到，如果一个函数没有任何注释，那么<strong class="mj je"> __annotations__ </strong>属性将返回一个空字典。</p><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="f657" class="nt lq iu np b gz nu nv l nw nx">def func(num1, num2):<br/>    return num1 + num2<br/>print(func.__annotations__)</span><span id="ba70" class="nt lq iu np b gz ob nv l nw nx"><strong class="np je">&gt;&gt;&gt; {}</strong></span></pre><h1 id="c43c" class="lp lq iu bd lr ls nj lu lv lw nk ly lz kj nl kk mb km nm kn md kp nn kq mf mg bi translated">可变注释</h1><p id="129d" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">类型(变量)注释首次在<strong class="mj je"> PEP 484 </strong>中引入，其中<strong class="mj je">类型注释</strong>用于注释变量。顾名思义，使用的注释表明了变量的数据类型。这种方法并不十分有效，它有自己的缺点，如这里的<a class="ae oc" href="https://www.python.org/dev/peps/pep-0526/#rationale" rel="noopener ugc nofollow" target="_blank"><strong class="mj je"/></a>所列。因此，我们不会详细讨论类型注释。相反，我们将研究Python 3.6中的<strong class="mj je"> PEP 526 </strong>中引入的<strong class="mj je">变量注释</strong>。</p><p id="3c70" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">变量注释最简单的例子如下所示。编写变量注释的一些规则是—</p><ul class=""><li id="d842" class="od oe iu mj b mk ne mn nf mq of mu og my oh nc oi oj ok ol bi translated">冒号前不应有空格。</li><li id="0b93" class="od oe iu mj b mk om mn on mq oo mu op my oq nc oi oj ok ol bi translated">冒号后面应该有一个空格。</li></ul><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="0c74" class="nt lq iu np b gz nu nv l nw nx">my_var: int=1<!-- -->0</span></pre><p id="dcd3" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">现在，让我们再看几个例子。在下面的第一个例子中，名称被注释为字符串类型。在第二个示例中，城市被注释为一个初始值为“Mysore”的字符串。在第三个示例中，age被注释为默认值为35的整数。</p><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="f027" class="nt lq iu np b gz nu nv l nw nx">name: str<br/>print(__annotations__)<br/>&gt;&gt;&gt; {‘name’: &lt;class ‘str’&gt;}</span><span id="35fd" class="nt lq iu np b gz ob nv l nw nx">city: str = ‘Mysore’<br/>print(__annotations__)<br/>&gt;&gt;&gt; {‘city’: &lt;class ‘str’&gt;}</span><span id="5920" class="nt lq iu np b gz ob nv l nw nx">age: int = 35<br/>print(__annotations__)<br/>&gt;&gt;&gt; {'age': 35}</span></pre><h1 id="5adc" class="lp lq iu bd lr ls nj lu lv lw nk ly lz kj nl kk mb km nm kn md kp nn kq mf mg bi translated">使用类型模块的示例</h1><p id="496b" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">在上面三个类型注释的例子中，我们使用了Python的原始数据类型，比如<strong class="mj je"> int </strong>和<strong class="mj je"> string </strong>。对于列表、元组等复杂类型，应该探索<a class="ae oc" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank"> <strong class="mj je">类型化</strong> </a>模块。我们将在另一篇博文中了解<strong class="mj je">键入</strong>模块的用法。然而，让我们来看一个使用类型模块的例子，它同时使用了<em class="or">函数注释</em>和<em class="or">类型注释</em>。</p><p id="b4ea" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">在下面的示例中，<strong class="mj je"> square </strong>函数需要一个整数参数<strong class="mj je"> num </strong>，并返回从0到num的所有数字的平方。变量<strong class="mj je"> <em class="or"> squares </em> </strong>被声明为<strong class="mj je">List【int】</strong>表示它保存一个整数列表。同样，函数的返回类型也是<strong class="mj je">List【int】</strong>。接下来，<strong class="mj je">方。__annotations__ </strong>给出函数的局部注释，<strong class="mj je"> __annotations__ </strong>给出全局注释。关于<strong class="mj je">打字</strong>模块的高级用法，请参考官方文档。</p><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="9017" class="nt lq iu np b gz nu nv l nw nx">from typing import List</span><span id="bc78" class="nt lq iu np b gz ob nv l nw nx">squares: List[int] = []</span><span id="4452" class="nt lq iu np b gz ob nv l nw nx">def square(num: int) -&gt; List[int]:<br/>    for i in range(num):<br/>        squares.append(i**2)<br/>    return squares</span><span id="8325" class="nt lq iu np b gz ob nv l nw nx">print(square(10))<br/>&gt;&gt;&gt; [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span><span id="f137" class="nt lq iu np b gz ob nv l nw nx">print(square.__annotations__)<br/>&gt;&gt;&gt; {'num': int, 'return': typing.List[int]}</span><span id="3df4" class="nt lq iu np b gz ob nv l nw nx">print(__annotations__)<br/>&gt;&gt;&gt; {'squares': typing.List[int]}</span></pre><h1 id="ae60" class="lp lq iu bd lr ls nj lu lv lw nk ly lz kj nl kk mb km nm kn md kp nn kq mf mg bi translated">注释的使用</h1><p id="7d96" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">到目前为止，您已经了解了什么是注释，如何在代码中添加注释，如何访问注释，等等。但是这对开发人员有什么帮助呢？下面是注释的一些用法。</p><ul class=""><li id="1bd1" class="od oe iu mj b mk ne mn nf mq of mu og my oh nc oi oj ok ol bi translated"><strong class="mj je">类型检查:</strong>第三方工具如<strong class="mj je"> mypy </strong>可用于在运行前捕捉类型错误。在下面这个简单的例子中，<strong class="mj je"> <em class="or"> func </em> </strong>接受两个整数参数并返回一个整数。当您保存这段代码并通过<strong class="mj je"> <em class="or"> mypy </em> </strong>运行它时，您将得到一个关于<strong class="mj je"> <em class="or"> num2 </em> </strong>的错误，因为它需要一个整数，而您传递的是一个字符串‘hello’。</li></ul><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj os"><img src="../Images/37e2aac773d610f22dce7c3c482e3486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*poeIxbAOpMNxeyeVtrXUFQ.png"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="0947" class="od oe iu mj b mk ne mn nf mq of mu og my oh nc oi oj ok ol bi translated"><strong class="mj je">IDEs类型提示:</strong>如果注释用于指示参数的数据类型，IDEs会提示参数的数据类型，等等。这将帮助您在IDE(如Pycharm)中编写代码时捕捉类型错误。参考下面的例子。</li></ul><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ot"><img src="../Images/0e4779e8ad5c94cc89fe3a5fba3bca74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hU0cjppS8AwEKZTQDKOmag.png"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="e5b2" class="od oe iu mj b mk ne mn nf mq of mu og my oh nc oi oj ok ol bi translated"><strong class="mj je">自动完成:</strong>注释也有助于自动完成，让您的生活变得轻松。在下面的例子中，<strong class="mj je"> <em class="or">文本</em> </strong>变量被注释为字符串类型。所以，IDE认为它是一个<strong class="mj je"> <em class="or">字符串</em> </strong>数据类型。因此它将开始显示可以应用于string对象的方法。是不是很牛逼？</li></ul><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ou"><img src="../Images/574a52c76ab588f3f003f8f04561ec47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktHdjIinDeZC26b4Z4yuJw.png"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="fb67" class="od oe iu mj b mk ne mn nf mq of mu og my oh nc oi oj ok ol bi translated"><strong class="mj je">可读性</strong>:注释也让你的代码更具可读性。例如，当有人在查看下面的代码时，很明显该函数需要两个整数参数并返回一个整数值。您不必使用文档字符串或注释来解释参数的数据类型。</li></ul><pre class="kt ku kv kw gu no np nq nr aw ns bi"><span id="6cdd" class="nt lq iu np b gz nu nv l nw nx">def func(num1: int, num2: int) -&gt; int:<br/>    return num1 + num2</span></pre><p id="c5e5" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated"><strong class="mj je"> <em class="or">注意:</em> </strong> <em class="or">注释本身对Python没什么用。使用注释的真正好处来自第三方库，如linters、类型检查器、ide等。解析注释并使用它们。例如，mypy是一个第三方类型检查器库，它解析注释的数据类型，并帮助您在运行前捕捉类型错误。</em></p><h1 id="6781" class="lp lq iu bd lr ls nj lu lv lw nk ly lz kj nl kk mb km nm kn md kp nn kq mf mg bi translated">结论</h1><p id="0441" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">希望您对本文中的函数注释和变量注释有了很好的理解。我建议您在下一个Python项目中尝试使用注释，看看它如何提高您的生产率。如果您有任何意见，请在下面的评论区告诉我们。</p><p id="df7a" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">最初发布于2021年4月5日的<a class="ae oc" href="https://pythonsimplified.com/start-using-annotations-in-your-python-code/" rel="noopener ugc nofollow" target="_blank"><strong class="mj je">python简化版</strong> </a>。</p><p id="15d5" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">我希望你喜欢阅读这篇文章。如果你喜欢我的文章并想订阅Medium，你可以在这里这样做: </p><div class="ov ow gq gs ox oy"><a href="https://chetanambi.medium.com/membership" rel="noopener follow" target="_blank"><div class="oz ab fp"><div class="pa ab pb cl cj pc"><h2 class="bd je gz z fq pd fs ft pe fv fx jd bi translated">通过我的推荐链接加入媒体- Chetan Ambi</h2><div class="pf l"><h3 class="bd b gz z fq pd fs ft pe fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pg l"><p class="bd b dl z fq pd fs ft pe fv fx dk translated">chetanambi.medium.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm lc oy"/></div></div></a></div></div><div class="ab cl li lj hy lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="in io ip iq ir"><h1 id="69d0" class="lp lq iu bd lr ls lt lu lv lw lx ly lz kj ma kk mb km mc kn md kp me kq mf mg bi translated">参考</h1><p id="5aa5" class="pw-post-body-paragraph mh mi iu mj b mk ml ke mm mn mo kh mp mq mr ms mt mu mv mw mx my mz na nb nc in bi translated">[1].<a class="ae oc" href="https://www.python.org/dev/peps/pep-3107/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-3107/</a>(功能注释)</p><p id="14e6" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">[2].<a class="ae oc" href="https://www.python.org/dev/peps/pep-0526/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-0526/</a>(变量注释的语法)</p><p id="704d" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">[3].<a class="ae oc" href="https://www.python.org/dev/peps/pep-0484/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-0484/</a>(键入提示)</p><p id="3d52" class="pw-post-body-paragraph mh mi iu mj b mk ne ke mm mn nf kh mp mq ng ms mt mu nh mw mx my ni na nb nc in bi translated">[4].<a class="ae oc" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/typing.html</a></p></div></div>    
</body>
</html>