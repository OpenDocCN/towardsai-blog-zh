<html>
<head>
<title>Recommendation System Tutorial with Python using Collaborative Filtering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用协同过滤的Python推荐系统教程</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/recommendation-system-in-depth-tutorial-with-python-for-netflix-using-collaborative-filtering-533ff8a0e444?source=collection_archive---------0-----------------------#2020-10-13">https://pub.towardsai.net/recommendation-system-in-depth-tutorial-with-python-for-netflix-using-collaborative-filtering-533ff8a0e444?source=collection_archive---------0-----------------------#2020-10-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="51ed" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，<a class="ae ep" href="https://towardsai.net/p/category/editorial" rel="noopener ugc nofollow" target="_blank">编辑</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a>，<a class="ae ep" href="https://towardsai.net/p/category/tutorial" rel="noopener ugc nofollow" target="_blank">教程</a></h2><div class=""/><div class=""><h2 id="48ab" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用Python和协同过滤为网飞用例构建一个<a class="ae kr" href="https://mld.ai/mldcmu" rel="noopener ugc nofollow" target="_blank">机器学习</a>推荐系统教程。</h2></div><p id="3040" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">作者:</strong>萨妮娅·帕维斯，<a class="ae kr" href="https://mktg.best/vguzs" rel="noopener ugc nofollow" target="_blank">罗伯托·伊里翁多</a></p><p id="ffbf" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">最后更新，2021年3月7日</p><div class="lo lp gp gr lq lr"><a href="https://members.towardsai.net/" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jd gy z fp lw fr fs lx fu fw jc bi translated">加入我们吧↓ |面向人工智能成员|数据驱动的社区</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">加入人工智能，成为会员，你将不仅支持人工智能，但你将有机会…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">members.towardsai.net</p></div></div><div class="ma l"><div class="mb l mc md me ma mf mg lr"/></div></div></a></div><h1 id="3fa9" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">什么是推荐系统？</h1><p id="2906" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">推荐系统根据用户对项目的当前选择的相互性，生成用户可能感兴趣的项目的编辑列表。它扩展了用户的建议，没有任何干扰或单调，它不推荐用户已经知道的项目。</p><p id="94f4" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">例如，网飞推荐系统通过匹配和搜索相似用户的习惯来提供推荐，并推荐与用户高度评价的电影有共同特征的电影。</p><p id="0fe6" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在本教程中，我们将致力于为网飞建立一个推荐系统。</p><p id="d079" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">本教程的代码可在</strong><a class="ae kr" href="https://github.com/towardsai/tutorials/tree/master/recommendation_system_tutorial" rel="noopener ugc nofollow" target="_blank"><strong class="ku jd">Github</strong></a><strong class="ku jd">上获得，其完整实现也可在</strong><a class="ae kr" href="https://colab.research.google.com/drive/1eMXGSHMNmekBkyBbHW4RYNZZcVYv5A2U?usp=sharing" rel="noopener ugc nofollow" target="_blank"><strong class="ku jd">Google Colab</strong></a><strong class="ku jd">上获得。</strong></p><blockquote class="ne"><p id="eed9" class="nf ng it bd nh ni nj nk nl nm nn ln dk translated">📚查看我们的<a class="ae kr" href="https://towardsai.net/p/data-science/principal-component-analysis-pca-with-python-examples-tutorial-67a917bae9aa" rel="noopener ugc nofollow" target="_blank">主成分分析</a>教程。📚</p></blockquote><figure class="np nq nr ns nt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi no"><img src="../Images/4f71744ddaa24e5221e80e9254f10e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2cNKn98tsSb8ocLMs6SKg.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图1:网飞推荐工作流。</figcaption></figure><p id="3713" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">上图所示的推荐系统工作流程显示了用户在不同电影或节目评级方面的协作。新用户基于现有用户的推荐获得他们的推荐。</p><p id="278e" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">根据麦肯锡的研究:</p><blockquote class="ne"><p id="2456" class="nf ng it bd nh ni nj nk nl nm nn ln dk translated"><em class="oe">人们在网飞上看的东西，75%来自推荐[ </em> <a class="ae kr" href="https://www.mckinsey.com/industries/retail/our-insights/how-retailers-can-keep-up-with-consumers" rel="noopener ugc nofollow" target="_blank"> <em class="oe"> 1 </em> </a> <em class="oe"> ]。</em></p></blockquote><p id="eec8" class="pw-post-body-paragraph ks kt it ku b kv of kd kx ky og kg la lb oh ld le lf oi lh li lj oj ll lm ln im bi translated">网飞实时数据案例:</p><ul class=""><li id="633d" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">超过20，000部电影和节目。</li><li id="6c14" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">200万用户。</li></ul><h1 id="350e" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">并发症</h1><p id="7689" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">推荐系统是基于机器学习的系统，扫描所有可能的选项并提供预测或推荐。然而，建立推荐系统具有以下复杂性:</p><ul class=""><li id="a5b5" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">用户的数据是可以互换的。</li><li id="d4c0" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">数据量很大，包括大量电影、节目、客户档案和兴趣、评级和其他数据点。</li><li id="47f0" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">新注册的客户过去拥有非常有限的信息。</li><li id="aca6" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">为用户实时预测。</li><li id="dcc2" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">老用户可能有过多的信息。</li><li id="2886" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">它不应该显示非常不同或过于相似的项目。</li><li id="df6b" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">用户可以在改变主意时改变项目的评级。</li></ul><h1 id="f5f1" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">推荐系统的类型</h1><p id="2c44" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">推荐系统有两种类型:</p><ul class=""><li id="ca73" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">内容过滤推荐系统。</li><li id="dfe5" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">基于协同过滤的推荐系统。</li></ul><p id="24fb" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">有趣的事实:网飞的推荐系统过滤架构基于协同过滤[ <a class="ae kr" href="https://help.netflix.com/en/node/100639" rel="noopener ugc nofollow" target="_blank"> 2 </a> ] [ <a class="ae kr" href="https://research.netflix.com/research-area/recommendations" rel="noopener ugc nofollow" target="_blank"> 3 </a> ]。</p><h1 id="7523" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">内容过滤</h1><p id="bcba" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">内容过滤需要附带信息，如歌曲的属性(歌曲名、歌手名、电影名、语言等。).推荐系统表现良好，即使新的项目被添加到库中。推荐系统的算法期望包括其图书馆项目的所有侧面属性。</p><p id="4178" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">内容过滤的一个重要方面:</p><ul class=""><li id="98b8" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">需要项目信息。</li><li id="07eb" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">项目信息应该在文本文档中。</li></ul><h1 id="2711" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">协同过滤</h1><p id="0d07" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">协同过滤背后的思想是考虑用户对不同视频的意见，并根据用户之前的排名和其他类似类型用户的意见向每个用户推荐最佳视频。</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi oy"><img src="../Images/d66b895f31046791a18d39ac21d0d8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YATZdhjWhghHRWye.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图2:协同过滤。</figcaption></figure><h2 id="c750" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">优点:</h2><ul class=""><li id="b8e2" class="ok ol it ku b kv mz ky na lb po lf pp lj pq ln op oq or os bi translated">它不需要一部电影的侧面知识，如类型。</li><li id="1e31" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">它使用从其他用户那里收集的信息向当前用户推荐新商品。</li></ul><h2 id="f580" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">缺点:</h2><ul class=""><li id="fd11" class="ok ol it ku b kv mz ky na lb po lf pp lj pq ln op oq or os bi translated">它不能推荐没有分级的新电影或节目。</li><li id="8292" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">它需要用户社区，并且可能存在稀疏性问题。</li></ul><h2 id="813d" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">不同的协同过滤技术:</h2><p id="1eff" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated"><strong class="ku jd">非概率算法</strong></p><ul class=""><li id="ec10" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">基于用户的最近邻。</li><li id="fc68" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">基于项目的最近邻。</li><li id="68e1" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">降低维度。</li></ul><p id="b929" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">概率算法</strong></p><ul class=""><li id="3bb3" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">贝叶斯网络模型。</li><li id="bafd" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">EM算法。</li></ul><h1 id="40f2" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">协同过滤中的问题</h1><p id="3989" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">协作过滤面临几个挑战，如下所述:</p><h2 id="ca53" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">稀疏</h2><p id="d8c7" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">网飞推荐系统的数据集是庞大的，并且用于该算法的用户-项目矩阵可能是巨大且稀疏的，因此这遇到了性能问题。</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi pr"><img src="../Images/1886ef5e3d74dddf65f30102235ef5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oX8bQOmgwS9r3aL8.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图3:稀疏。</figcaption></figure><p id="4e47" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">数据的稀疏性来源于用户项矩阵中的空记录与总记录之比。</p><p id="1624" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">稀疏度= 1 — |R|/|I|*|U| </strong></p><p id="28f7" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在哪里，</p><p id="cae8" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> R </strong> =评级</p><p id="a8dc" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> I </strong> =物品</p><p id="0bb6" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"/>=用户</p><h2 id="13b8" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">冷启动</h2><p id="ca8c" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">当系统没有信息为新用户提供建议时，就会遇到这个问题。因此，矩阵分解技术不能应用。</p><p id="987a" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这个问题带来两个观察结果:</p><ul class=""><li id="9195" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">如何给用户推荐一个新视频？</li><li id="7f01" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">有什么视频推荐给新用户？</li></ul><p id="63b7" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">解决方案:</strong></p><ul class=""><li id="fb79" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">建议或要求用户给视频评分。</li><li id="5243" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">视频默认投票。</li><li id="b01e" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">在初始阶段使用其他技术，如基于内容的技术或人口统计学技术。</li></ul><h1 id="2803" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">基于用户的最近邻</h1><p id="d0a1" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">基于用户的最邻近用户的基本技术约翰:</p><p id="3d01" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">约翰是网飞的活跃用户，还没有看过视频“<strong class="ku jd"> v </strong>”。这里，基于用户的最近邻算法将如下工作:</p><ul class=""><li id="e9a9" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">该技术找到一组用户或最近邻居，这些用户或最近邻居在过去喜欢与John相同的项目，并且对视频“<strong class="ku jd"> v </strong>”进行了评级</li><li id="ae9e" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">算法预测。</li><li id="42b7" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">执行John没有看过并推荐的所有项目。</li></ul><blockquote class="ne"><p id="1061" class="nf ng it bd nh ni ps pt pu pv pw ln dk translated"><em class="oe">本质上，基于用户的最近邻算法通过分析来自</em> <strong class="ak"> <em class="oe"> u的</em> </strong> <em class="oe">邻域中的用户对</em> <strong class="ak"> <em class="oe"> i </em> </strong> <em class="oe">的评级，生成对项目</em> <strong class="ak"> <em class="oe"> i </em> </strong> <em class="oe">的预测。</em></p></blockquote><p id="1322" class="pw-post-body-paragraph ks kt it ku b kv of kd kx ky og kg la lb oh ld le lf oi lh li lj oj ll lm ln im bi translated">让我们为预测计算用户相似性:</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi px"><img src="../Images/e37b7f523dcec4aedbc8927dc340eab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/0*oxYZH7BYScjHHGeQ.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图4:相似性的计算。</figcaption></figure><p id="f696" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">其中:</p><p id="2d90" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> a，b </strong> =用户</p><p id="9f00" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> r(a，p) </strong> =用户a对项目p的评级</p><p id="2e86" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> P </strong> =一套物品。由用户a和b评级</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi py"><img src="../Images/d957d511e892cbc890e3f0fb8f4793fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R_f6Kd-xjbZ1Vn9C.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图5:相似性计算。</figcaption></figure><p id="8ae8" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">基于相似性函数的预测:</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/b9ede4f13ae2be97a6a3c651c022565c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/0*B7WsiPjWBAalw8Gd.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图6:预测。</figcaption></figure><p id="20e4" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这里，相似用户是指那些喜欢相似电影或视频的人。</p><h2 id="42b0" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">挑战</h2><ul class=""><li id="6db9" class="ok ol it ku b kv mz ky na lb po lf pp lj pq ln op oq or os bi translated">对于大量的数据，该算法遇到了严重的性能和缩放问题。</li><li id="fd0f" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">O(MN) 在最坏的情况下可能遇到的计算扩展性。其中，<strong class="ku jd"> M </strong>是顾客的数量，<strong class="ku jd"> N </strong>是商品的数量。</li><li id="0a02" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">应用降维方法可以提高性能。但是，它会降低推荐系统的质量。</li></ul><h1 id="5842" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">基于项目的最近邻</h1><p id="d473" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">这种技术基于不同视频或电影或项目之间的相似性来生成预测。</p><blockquote class="ne"><p id="3fd7" class="nf ng it bd nh ni nj nk nl nm nn ln dk translated"><em class="oe">对一个用户</em><strong class="ak"><em class="oe"/></strong><em class="oe">和项目</em> <strong class="ak"> <em class="oe"> i </em> </strong> <em class="oe">的预测是由一个用户</em><strong class="ak"><em class="oe"/></strong><em class="oe">对与项目</em> <strong class="ak"> <em class="oe"> i </em> </strong> <em class="oe">最相似的项目的评分的加权和组成。</em></p></blockquote><figure class="np nq nr ns nt nu gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/3d6254b9e4df0a823e6b601455af07f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0XhX_-V0b3yQ-Due.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图7:基于项目的最近邻预测。</figcaption></figure><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi py"><img src="../Images/1da7509e3fb0b0ab289bdc7f4f585025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ljZYLDCME01Q-Y-f.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图8:基于项目的预测。</figcaption></figure><p id="f012" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">如图8所示，寻找与<strong class="ku jd"> video5 </strong>相似的视频。因此，该建议与<strong class="ku jd"> video4 </strong>非常相似。</p><h1 id="12cd" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">余弦相似度在构建推荐器中的作用</h1><p id="d217" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">余弦相似性是一种度量标准，用于找出项目/产品之间的相似性，而不考虑它们的大小。我们通过测量多维空间中任意两个向量之间的距离来计算角度的余弦值。由于尺寸原因，它适用于支持相当大的文件。</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qb"><img src="../Images/8b8696a495a0170343c6a06bc485abcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wmRdOpJ0JglMy2zx"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图9:相似性的计算。</figcaption></figure><p id="437c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">其中:</p><p id="a2e1" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">余弦</strong>是在-1到1之间计算的角度，其中-1表示不相似的项目，1表示正确匹配的项目。</p><p id="4b8c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> cos p. q </strong> —给出向量之间的点积。</p><p id="e568" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">| | p | | | q | |</strong>—表示向量的大小的乘积</p><h1 id="1d8f" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">为什么推荐人的基线预测很重要？</h1><p id="fcc9" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">基线预测值独立于用户的评级，但它们为新用户的评级提供预测</p><h2 id="c69a" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated"><em class="oe">通用基线表</em></h2><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="f05c" class="pd mi it qd b gy qh qi l qj qk">bu,i = µ + bu + bi</span></pre><p id="a86b" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在哪里，</p><p id="f15a" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd"> bu和bi </strong>是用户和项目基线预测器。</p><p id="ad64" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">基线动机</strong></p><ul class=""><li id="8b50" class="ok ol it ku b kv kw ky kz lb om lf on lj oo ln op oq or os bi translated">用基线值对缺失值进行插补。</li><li id="fefb" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated">将精确度与高级模型进行比较</li></ul><h1 id="ca2b" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">网飞电影推荐系统</h1><h2 id="685c" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">问题陈述</h2><p id="43b2" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">网飞是一个提供在线电影和视频流的平台。网飞希望建立一个推荐系统，根据其他电影的好恶为用户预测电影列表。该推荐将基于每个用户的独特兴趣而针对他/她。</p><h2 id="ec71" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">网飞数据集</h2><ul class=""><li id="eda5" class="ok ol it ku b kv mz ky na lb po lf pp lj pq ln op oq or os bi translated"><strong class="ku jd"> combine_data_2.txt </strong>:该文本文件包含电影id、客户id、收视率、日期</li><li id="18fc" class="ok ol it ku b kv ot ky ou lb ov lf ow lj ox ln op oq or os bi translated"><strong class="ku jd"> movie_title.csv </strong>:该csv文件包含movie_id和movie_title</li></ul><h2 id="9ef7" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">加载数据集</h2><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="0717" class="pd mi it qd b gy qh qi l qj qk">from datetime import datetime<br/>import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import os<br/>import random<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>from scipy import sparse<br/>from sklearn.metrics.pairwise import cosine_similarity<br/>from sklearn.metrics import mean_squared_errorimport xgboost as xgb<br/>from surprise import Reader, Dataset<br/>from surprise import BaselineOnly<br/>from surprise import KNNBaseline<br/>from surprise import SVD<br/>from surprise import SVDpp<br/>from surprise.model_selection import GridSearchCVdef load_data():<br/>    netflix_csv_file = open("netflix_rating.csv", mode = "w")<br/>    rating_files = ['combined_data_1.txt']<br/>    for file in rating_files:<br/>        with open(file) as f:<br/>            for line in f:<br/>                line = line.strip()<br/>                if line.endswith(":"):<br/>                    movie_id = line.replace(":", "")<br/>                else:<br/>                    row_data = []<br/>                    row_data = [item for item in line.split(",")]<br/>                    row_data.insert(0, movie_id)<br/>                    netflix_csv_file.write(",".join(row_data))  <br/>                    netflix_csv_file.write('\n')<br/>                    <br/>    netflix_csv_file.close()<br/>    df = pd.read_csv('netflix_rating.csv', sep=",", names = ["movie_id","customer_id", "rating", "date"])<br/>    return dfnetflix_rating_df = load_data()<br/>netflix_rating_df.head()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/4a4c3dc33627869b45eb47806dbaa8c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/0*cnqhx8N83AmQnkBg.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图10:网飞评级数据。</figcaption></figure><h1 id="6e18" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">数据集的分析</h1><p id="1ffc" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">查找重复评分:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="29a5" class="pd mi it qd b gy qh qi l qj qk">netflix_rating_df.duplicated(["movie_id","customer_id", "rating", "date"]).sum()</span></pre><p id="41c0" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">分割训练和测试数据:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="c0ea" class="pd mi it qd b gy qh qi l qj qk">split_value = int(len(netflix_rating_df) * 0.80)<br/>train_data = netflix_rating_df[:split_value]<br/>test_data = netflix_rating_df[split_value:]</span></pre><p id="2a4e" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">计算训练数据集中的评分数:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="7abd" class="pd mi it qd b gy qh qi l qj qk">plt.figure(figsize = (12, 8))<br/>ax = sns.countplot(x="rating", data=train_data)ax.set_yticklabels([num for num in ax.get_yticks()])plt.tick_params(labelsize = 15)<br/>plt.title("Count Ratings in train data", fontsize = 20)<br/>plt.xlabel("Ratings", fontsize = 20)<br/>plt.ylabel("Number of Ratings", fontsize = 20)<br/>plt.show()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qm"><img src="../Images/a344825c6c9d9df9082609b0cd2a6f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fjxqBA02n5uq9dFX.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图11:统计训练数据中的评级数量。</figcaption></figure><p id="7659" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">查找每个用户的分级电影数量:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="145e" class="pd mi it qd b gy qh qi l qj qk">no_rated_movies_per_user = train_data.groupby(by = "customer_id")["rating"].count().sort_values(ascending = False)<br/>no_rated_movies_per_user.head()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qn"><img src="../Images/f5a586cbd7d80f3ed7d923a1023c7a56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UXkEQzRENIxgQtet.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图12:每个用户的分级电影数量。</figcaption></figure><p id="1697" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">查找每部电影的分级数字:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="fb5d" class="pd mi it qd b gy qh qi l qj qk">no_ratings_per_movie = train_data.groupby(by = "movie_id")["rating"].count().sort_values(ascending = False)<br/>no_ratings_per_movie.head()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/a834ab7aa87bc33fd52e73067cb8b04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/0*XMOpmhuZKukHH5JI.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图13:每部电影的收视率。</figcaption></figure><h2 id="a269" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">创建用户项目稀疏矩阵</h2><p id="f4ac" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">在用户-项目稀疏矩阵中，项目的值出现在列中，用户的值出现在行中。用户的评级显示在单元格中。这是一个稀疏矩阵，因为可能存在用户不能对每个电影项目进行评级的可能性，并且许多项目可以是空的或零。</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="1708" class="pd mi it qd b gy qh qi l qj qk">def get_user_item_sparse_matrix(df):<br/>    sparse_data = sparse.csr_matrix((df.rating, (df.customer_id, df.movie_id)))<br/>    return sparse_data</span></pre><p id="940b" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">用户项目训练稀疏矩阵</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="4c10" class="pd mi it qd b gy qh qi l qj qk">train_sparse_data = get_user_item_sparse_matrix(train_data)</span></pre><p id="b761" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">用户项目测试稀疏矩阵</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="eeef" class="pd mi it qd b gy qh qi l qj qk">test_sparse_data = get_user_item_sparse_matrix(test_data)</span></pre><p id="55a8" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">全球平均评级</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="08aa" class="pd mi it qd b gy qh qi l qj qk">global_average_rating = train_sparse_data.sum()/train_sparse_data.count_nonzero()<br/>print("Global Average Rating: {}".format(global_average_rating))</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/30deec41983e50f72aab2202165a8c9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/0*O09eUcUL96umcDkD.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图14:全球平均评级。</figcaption></figure><h2 id="9ceb" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">检查冷启动问题</h2><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qq"><img src="../Images/b63bc42145f55d83cc591aacf393ffcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Axe0QGRlE2ZiQoNiR5jxlg.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">来源:埃里克·麦克林在<a class="ae kr" href="https://unsplash.com/photos/3rWUgxu7RWM" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="bbed" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">计算平均评分</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="bafa" class="pd mi it qd b gy qh qi l qj qk">def get_average_rating(sparse_matrix, is_user):<br/>    ax = 1 if is_user else 0<br/>    sum_of_ratings = sparse_matrix.sum(axis = ax).A1  <br/>    no_of_ratings = (sparse_matrix != 0).sum(axis = ax).A1 <br/>    rows, cols = sparse_matrix.shape<br/>    average_ratings = {i: sum_of_ratings[i]/no_of_ratings[i] for i in range(rows if is_user else cols) if no_of_ratings[i] != 0}<br/>    return average_ratings</span></pre><p id="77b0" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">平均评级用户</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="78cd" class="pd mi it qd b gy qh qi l qj qk">average_rating_user = get_average_rating(train_sparse_data, True)</span></pre><p id="1f87" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">平均分级电影</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="b779" class="pd mi it qd b gy qh qi l qj qk">avg_rating_movie = get_average_rating(train_sparse_data, False)</span></pre><p id="9cf9" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">检查冷启动问题:用户</strong></p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="f89e" class="pd mi it qd b gy qh qi l qj qk">total_users = len(np.unique(netflix_rating_df["customer_id"]))<br/>train_users = len(average_rating_user)<br/>uncommonUsers = total_users - train_users<br/>                  <br/>print("Total no. of Users = {}".format(total_users))<br/>print("No. of Users in train data= {}".format(train_users))<br/>print("No. of Users not present in train data = {}({}%)".format(uncommonUsers, np.round((uncommonUsers/total_users)*100), 2))</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/164f7b4389297b1eaa1c990d91b81261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/0*tm4ih5ehu0cNZi8R.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图15:冷启动问题-用户。</figcaption></figure><p id="d023" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这里，总用户的1%是新用户，他们没有合适的评级。因此，这会带来冷启动问题。</p><p id="fa36" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">检查冷启动问题:电影</strong></p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="1f96" class="pd mi it qd b gy qh qi l qj qk">total_movies = len(np.unique(netflix_rating_df["movie_id"]))<br/>train_movies = len(avg_rating_movie)<br/>uncommonMovies = total_movies - train_movies<br/>                  <br/>print("Total no. of Movies = {}".format(total_movies))<br/>print("No. of Movies in train data= {}".format(train_movies))<br/>print("No. of Movies not present in train data = {}({}%)".format(uncommonMovies, np.round((uncommonMovies/total_movies)*100), 2))</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi qs"><img src="../Images/d53263841d7739e5f16f3d6c96aae2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/0*9298F4uCGuZJPUhf.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图16:冷启动问题-电影。</figcaption></figure><p id="9774" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这里，全部电影的20%是新的，它们的分级可能在数据集中不可用。因此，这会带来冷启动问题。</p><h2 id="f8ac" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">相似矩阵</h2><p id="f7d8" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">相似性矩阵对于测量和计算用户简档和电影之间的相似性以生成推荐是至关重要的。从根本上说，这种矩阵计算两个数据点之间的相似性。</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qt"><img src="../Images/94dfee140cdfa03822daaf1b6e8353d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*N4JY_1Wnd1RWYL2S.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图17:相似性矩阵。</figcaption></figure><p id="e3a0" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在图17所示的矩阵中，视频2和视频5非常相似。相似性矩阵的计算是非常繁琐的工作，因为它需要强大的计算系统。</p><p id="d5b8" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">计算用户相似度矩阵</strong></p><p id="f538" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">计算用户相似性以找到前100个用户的相似性:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="98ae" class="pd mi it qd b gy qh qi l qj qk">def compute_user_similarity(sparse_matrix, limit=100):<br/>    row_index, col_index = sparse_matrix.nonzero()<br/>    rows = np.unique(row_index)<br/>    similar_arr = np.zeros(61700).reshape(617,100)<br/>    <br/>    for row in rows[:limit]:<br/>        sim = cosine_similarity(sparse_matrix.getrow(row), train_sparse_data).ravel()<br/>        similar_indices = sim.argsort()[-limit:]<br/>        similar = sim[similar_indices]<br/>        similar_arr[row] = similar<br/>    <br/>    return similar_arrsimilar_user_matrix = compute_user_similarity(train_sparse_data, 100)</span></pre><p id="303b" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">计算电影相似度矩阵</strong></p><p id="b795" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">加载电影标题数据集</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="f1fb" class="pd mi it qd b gy qh qi l qj qk">movie_titles_df = pd.read_csv("movie_titles.csv",sep = ",", header = None, names=['movie_id', 'year_of_release', 'movie_title'],index_col = "movie_id", encoding = "iso8859_2")movie_titles_df.head()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qu"><img src="../Images/63b60b8cb0a40d349016109d535ec831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8Px9jma_0jVKY6GT.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图18:电影标题列表。</figcaption></figure><p id="fb55" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">计算相似的电影:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="2dca" class="pd mi it qd b gy qh qi l qj qk">def compute_movie_similarity_count(sparse_matrix, movie_titles_df, movie_id):<br/>    similarity = cosine_similarity(sparse_matrix.T, dense_output = False)<br/>    no_of_similar_movies = movie_titles_df.loc[movie_id][1], similarity[movie_id].count_nonzero()<br/>    return no_of_similar_movies</span></pre><p id="b37c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">获取类似的电影列表:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="a198" class="pd mi it qd b gy qh qi l qj qk">similar_movies = compute_movie_similarity_count(train_sparse_data, movie_titles_df, 1775)<br/>print("Similar Movies = {}".format(similar_movies))</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/ad656cad3f8a0dde3a731a139e5716c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*8JolfQ5r8KZff7Wa.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图19:相似电影列表。</figcaption></figure><h1 id="677a" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">构建机器学习模型</h1><h2 id="51f7" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">创建一个样本稀疏矩阵</h2><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="dfb6" class="pd mi it qd b gy qh qi l qj qk">def get_sample_sparse_matrix(sparseMatrix, n_users, n_movies):<br/>    users, movies, ratings = sparse.find(sparseMatrix)<br/>    uniq_users = np.unique(users)<br/>    uniq_movies = np.unique(movies)<br/>    np.random.seed(15) <br/>    userS = np.random.choice(uniq_users, n_users, replace = False)<br/>    movieS = np.random.choice(uniq_movies, n_movies, replace = False)<br/>    mask = np.logical_and(np.isin(users, userS), np.isin(movies, movieS))<br/>    sparse_sample = sparse.csr_matrix((ratings[mask], (users[mask], movies[mask])), <br/>                                                     shape = (max(userS)+1, max(movieS)+1))<br/>    return sparse_sample</span></pre><p id="53bb" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">训练数据的样本稀疏矩阵:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="d60f" class="pd mi it qd b gy qh qi l qj qk">train_sample_sparse_matrix = get_sample_sparse_matrix(train_sparse_data, 400, 40)</span></pre><p id="ca60" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">测试数据的样本稀疏矩阵:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="8d61" class="pd mi it qd b gy qh qi l qj qk">test_sparse_matrix_matrix = get_sample_sparse_matrix(test_sparse_data, 200, 20)</span></pre><h2 id="ad82" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">展示数据</h2><p id="60b6" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">特征是通过添加变量的不同方面来创建新特征的过程。这里，将创建五个相似的简档用户和相似类型的电影特征。这些新功能有助于将不同电影和用户之间的相似之处联系起来。以下新要素将在数据特征化后添加到数据集中:</p><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi qw"><img src="../Images/ba62acecad72ce4fe95befbd3f678047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*yGfsr1OrvCKIy_ZX.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图20:新特性。</figcaption></figure><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="64a0" class="pd mi it qd b gy qh qi l qj qk">def create_new_similar_features(sample_sparse_matrix):<br/>    global_avg_rating = get_average_rating(sample_sparse_matrix, False)<br/>    global_avg_users = get_average_rating(sample_sparse_matrix, True)<br/>    global_avg_movies = get_average_rating(sample_sparse_matrix, False)<br/>    sample_train_users, sample_train_movies, sample_train_ratings = sparse.find(sample_sparse_matrix)<br/>    new_features_csv_file = open("/content/netflix_dataset/new_features.csv", mode = "w")<br/>    <br/>    for user, movie, rating in zip(sample_train_users, sample_train_movies, sample_train_ratings):<br/>        similar_arr = list()<br/>        similar_arr.append(user)<br/>        similar_arr.append(movie)<br/>        similar_arr.append(sample_sparse_matrix.sum()/sample_sparse_matrix.count_nonzero())<br/>        <br/>        similar_users = cosine_similarity(sample_sparse_matrix[user], sample_sparse_matrix).ravel()<br/>        indices = np.argsort(-similar_users)[1:]<br/>        ratings = sample_sparse_matrix[indices, movie].toarray().ravel()<br/>        top_similar_user_ratings = list(ratings[ratings != 0][:5])<br/>        top_similar_user_ratings.extend([global_avg_rating[movie]] * (5 - len(ratings)))<br/>        similar_arr.extend(top_similar_user_ratings)<br/>        <br/>        similar_movies = cosine_similarity(sample_sparse_matrix[:,movie].T, sample_sparse_matrix.T).ravel()<br/>        similar_movies_indices = np.argsort(-similar_movies)[1:]<br/>        similar_movies_ratings = sample_sparse_matrix[user, similar_movies_indices].toarray().ravel()<br/>        top_similar_movie_ratings = list(similar_movies_ratings[similar_movies_ratings != 0][:5])<br/>        top_similar_movie_ratings.extend([global_avg_users[user]] * (5-len(top_similar_movie_ratings)))<br/>        similar_arr.extend(top_similar_movie_ratings)<br/>        <br/>        similar_arr.append(global_avg_users[user])<br/>        similar_arr.append(global_avg_movies[movie])<br/>        similar_arr.append(rating)<br/>        <br/>        new_features_csv_file.write(",".join(map(str, similar_arr)))<br/>        new_features_csv_file.write("\n")<br/>        <br/>    new_features_csv_file.close()<br/>    new_features_df = pd.read_csv('/content/netflix_dataset/new_features.csv', names = ["user_id", "movie_id", "gloabl_average", "similar_user_rating1", <br/>                                                               "similar_user_rating2", "similar_user_rating3", <br/>                                                               "similar_user_rating4", "similar_user_rating5", <br/>                                                               "similar_movie_rating1", "similar_movie_rating2", <br/>                                                               "similar_movie_rating3", "similar_movie_rating4", <br/>                                                               "similar_movie_rating5", "user_average", <br/>                                                               "movie_average", "rating"]) return new_features_df</span></pre><p id="90fb" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">训练数据的特征(添加新的相似特征):</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="d6e3" class="pd mi it qd b gy qh qi l qj qk">train_new_similar_features = create_new_similar_features(train_sample_sparse_matrix)train_new_similar_features.head()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qx"><img src="../Images/64a5ce93ae80e63400bc58a73b61d661.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P6nhdWsHzy8s4qPr.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图21:训练数据集的特征数据集。</figcaption></figure><p id="e07f" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">测试数据的特征(添加新的相似特征):</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="5046" class="pd mi it qd b gy qh qi l qj qk">test_new_similar_features = create_new_similar_features(test_sparse_matrix_matrix)test_new_similar_features.head()</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qy"><img src="../Images/384a40a41158f53f55ec855041d391bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XDliLiHe5cGSyxfa.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图22:测试数据集的特征数据集。</figcaption></figure><h2 id="2a64" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">模型的训练和预测</h2><p id="21ce" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">从similar_features数据集中划分训练和测试数据:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="80bf" class="pd mi it qd b gy qh qi l qj qk">x_train = train_new_similar_features.drop(["user_id", "movie_id", "rating"], axis = 1)x_test = test_new_similar_features.drop(["user_id", "movie_id", "rating"], axis = 1)y_train = train_new_similar_features["rating"]y_test = test_new_similar_features["rating"]</span></pre><p id="0544" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">检查准确性的实用方法:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="45dc" class="pd mi it qd b gy qh qi l qj qk">def error_metrics(y_true, y_pred):<br/>    rmse = np.sqrt(mean_squared_error(y_true, y_pred))<br/>    return rmse</span></pre><p id="32e6" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">适合具有100个估计量的XGBRegressor算法:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="8d89" class="pd mi it qd b gy qh qi l qj qk">clf = xgb.XGBRegressor(n_estimators = 100, silent = False, n_jobs  = 10)clf.fit(x_train, y_train)</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi qz"><img src="../Images/746b81a9ed9787f1e8ab98b1c5568519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QbqYRThRJZ8ksPxC.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图23: XGB回归器算法</figcaption></figure><p id="c42a" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">预测测试数据集的结果:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="7a96" class="pd mi it qd b gy qh qi l qj qk">y_pred_test = clf.predict(x_test)</span></pre><p id="fd60" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">检查预测数据的准确性:</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="7bb4" class="pd mi it qd b gy qh qi l qj qk">rmse_test = error_metrics(y_test, y_pred_test)print("RMSE = {}".format(rmse_test))</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div class="gh gi ra"><img src="../Images/62231c8244d725a7fb194effe2d124fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/0*N4D__aOcuRcWOLQ6.png"/></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图24: RMSE</figcaption></figure><p id="3c79" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">如图24所示，预测模型数据集的RMSE(均方根误差)为0.99。</p><h2 id="86e1" class="pd mi it bd mj pe pf dn mn pg ph dp mr lb pi pj mt lf pk pl mv lj pm pn mx iz bi translated">地块特征重要性</h2><p id="8cb3" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated"><strong class="ku jd">特征重要性</strong>是一项重要的技术，它根据特征在预测目标变量方面的价值来选择输入特征的分数。</p><pre class="oz pa pb pc gt qc qd qe qf aw qg bi"><span id="f95b" class="pd mi it qd b gy qh qi l qj qk">def plot_importance(model, clf):<br/>    fig = plt.figure(figsize = (8, 6))<br/>    ax = fig.add_axes([0,0,1,1])<br/>    model.plot_importance(clf, ax = ax, height = 0.3)<br/>    plt.xlabel("F Score", fontsize = 20)<br/>    plt.ylabel("Features", fontsize = 20)<br/>    plt.title("Feature Importance", fontsize = 20)<br/>    plt.tick_params(labelsize = 15)<br/>    <br/>    plt.show()plot_importance(xgb, clf)</span></pre><figure class="oz pa pb pc gt nu gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi rb"><img src="../Images/b356996b739ec53cf2c30c0987447e3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n9g4gGsxJOyX4pjs.png"/></div></div><figcaption class="oa ob gj gh gi oc od bd b be z dk translated">图25:特性重要性图。</figcaption></figure><p id="09cf" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">图25显示了每个特性的特性重要性。在这里，user_average评级是一个关键特性。它的得分高于其他特征。已经创建了类似用户评级和类似电影评级的其他特征来关联不同用户和电影之间的相似性。</p><h1 id="4e06" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">结论</h1><p id="0936" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">多年来，机器学习已经为网飞、亚马逊、谷歌、脸书等公司解决了几个挑战。网飞的推荐系统帮助用户根据他/她的选择在大量的电影和节目列表中过滤信息。推荐系统必须与用户交互以了解他们的偏好来提供推荐。</p><p id="8428" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">协同过滤(CF)是一种非常流行的推荐系统算法，用于根据其他用户的评分和协作进行预测和推荐。基于用户的协同过滤是第一个自动化的协同过滤机制。它也被称为<em class="rc"> k-NN </em>协同过滤。<em class="rc">协同过滤的问题是在给定一组用户群体的现有选择判断的情况下，预测用户对他尚未评价的项目的喜欢程度[ </em> <a class="ae kr" href="https://pitt.edu/~peterb/2480-122/CollaborativeFiltering.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="rc"> 4 </em> </a> <em class="rc"> ]。</em></p></div><div class="ab cl rd re hx rf" role="separator"><span class="rg bw bk rh ri rj"/><span class="rg bw bk rh ri rj"/><span class="rg bw bk rh ri"/></div><div class="im in io ip iq"><p id="0745" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">免责声明:</strong>本文表达的观点仅代表作者个人观点，不代表卡内基梅隆大学或其他(直接或间接)与作者相关的公司的观点。这些文章并不打算成为最终产品，而是当前思想的反映，同时也是讨论和改进的催化剂。</p><p id="8c70" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">通过<a class="ae kr" href="https://towardsai.net/" rel="noopener ugc nofollow" target="_blank">向AI </a>发布</p><p id="1cbf" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><strong class="ku jd">除非另有说明，所有图片均来自作者。</strong></p><h1 id="5540" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">资源:</h1><p id="2367" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated"><a class="ae kr" href="https://colab.research.google.com/drive/1eMXGSHMNmekBkyBbHW4RYNZZcVYv5A2U?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab实现</a>。</p><p id="e3a5" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><a class="ae kr" href="https://github.com/towardsai/tutorials/tree/master/recommendation_system_tutorial" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p><h1 id="eff7" class="mh mi it bd mj mk ml mm mn mo mp mq mr ki ms kj mt kl mu km mv ko mw kp mx my bi translated">参考资料:</h1><p id="f8e5" class="pw-post-body-paragraph ks kt it ku b kv mz kd kx ky na kg la lb nb ld le lf nc lh li lj nd ll lm ln im bi translated">[1]零售商如何跟上消费者，麦肯锡公司，<a class="ae kr" href="https://www.mckinsey.com/industries/retail/our-insights/how-retailers-can-keep-up-with-consumers" rel="noopener ugc nofollow" target="_blank">https://www . McKinsey . com/industries/retail/our-insights/How-retailers-can-keep-up-consumers</a></p><p id="0ae5" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">[2]https://help.netflix.com/en/node/100639网飞《推荐系统的工作原理》，网飞研究，<a class="ae kr" href="https://help.netflix.com/en/node/100639" rel="noopener ugc nofollow" target="_blank"/></p><p id="1e47" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">[3]建议，弄清楚如何给每个成员带来独特的快乐，https://research.netflix.com/research-area/recommendations网飞研究，<a class="ae kr" href="https://research.netflix.com/research-area/recommendations" rel="noopener ugc nofollow" target="_blank"/></p><p id="0232" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">[4]协同过滤，匹兹堡大学，Peter Brusilovsky，Sue Yeon和Danielle Lee，<a class="ae kr" href="https://pitt.edu/~peterb/2480-122/CollaborativeFiltering.pdf" rel="noopener ugc nofollow" target="_blank">https://Pitt . edu/~ peterb/2480-122/Collaborative Filtering . pdf</a></p></div></div>    
</body>
</html>