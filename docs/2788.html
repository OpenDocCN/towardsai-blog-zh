<html>
<head>
<title>Examples of Information Retrieval Application on Image and Text</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图文信息检索应用实例</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/examples-of-information-retrieval-application-on-image-and-text-388ee229fb6f?source=collection_archive---------2-----------------------#2022-05-26">https://pub.towardsai.net/examples-of-information-retrieval-application-on-image-and-text-388ee229fb6f?source=collection_archive---------2-----------------------#2022-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="acfc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">图像和文本用例中的信息检索</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6c0238e7dbb9f4aeb93439f0d174254b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BWKCnf0_5-Nfm-jE"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">美国宇航局在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的<a class="ae kv" href="https://unsplash.com/@nasa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">照片</a></figcaption></figure><p id="9720" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated">你好，欢迎来到我的第二篇博客。在这篇文章中，我想写下我被邀请作为印度尼西亚大学高级信息检索课程的客座讲师时分享的内容。我分享了几个可以在现实世界中使用的信息检索实现思想。</p><p id="5299" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将在这里写一些高层次的技术细节。所以，我觉得这个帖子是新手友好的，只要你懂信息检索的基础知识。即使上面提到了NLP或者Image，我也会用直觉来描述。</p><p id="e4ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，看我的帖子开心点:)。</p><h1 id="0db9" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">介绍</h1><p id="6ee5" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">信息检索是从资源集合中检索相关资源的过程。流行且广泛使用的信息检索实现之一是像Google、Bing和DuckDuckGo这样的搜索引擎。它们接收来自用户的查询，并根据查询本身返回相关文档。</p><p id="c04c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">IR的算法主要是用评分算法将查询与源的集合进行比较。评分算法用于计算查询和文档本身之间的相关性。将排序后的检索文档返回给用户。</p><p id="cf09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将分享一些基本的工具和算法的信息检索实现与自然语言处理和图像。它们是“自动订单提取”和“图像网站的图像检索”我还将提供每个示例有用性的背景。</p><h1 id="9623" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">自动订单提取</h1><p id="aa5c" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated"><strong class="ky ir">自动订单提取</strong>是一项自动提取和解析收到的订单消息的服务。比如一个卖衣服的，把这个服务部署到一个消息传递app上(我们可以叫它<code class="fe my mz na nb b">chatbot</code>)，自动提取卖家需要的信息。然后，提取的信息用于处理交易。请看下面的例子:</p><pre class="kg kh ki kj gt nc nb nd ne aw nf bi"><span id="09af" class="ng mc iq nb b gy nh ni l nj nk">[BUYER]: <br/>Hi, here is my order:<br/><br/>Name: **Si Meong** &lt;NAME&gt;<br/>Address: **Meow Meow Street** &lt;ADDRESS&gt;<br/><br/>Order:<br/>**1** &lt;Product Quantity&gt; **T-Shirt Meow** &lt;Product Name&gt;<br/><br/>Thank you!<br/><br/>Regards,<br/><br/>Customer</span></pre><blockquote class="nl nm nn"><p id="79f1" class="kw kx no ky b kz la jr lb lc ld ju le np lg lh li nq lk ll lm nr lo lp lq lr ij bi translated"><code class="fe my mz na nb b"><em class="iq">**</em></code> <em class="iq">是提取的信息，</em> <code class="fe my mz na nb b"><em class="iq">&lt; &gt;</em></code> <em class="iq">是提取的信息的标签</em></p></blockquote><h1 id="fed8" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">为什么这个实现很重要？</h1><p id="9c79" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">想象一下，你有一个大商店，允许使用消息应用程序订购产品。一天之内，你有2000份客户订单。我们需要看到数据和产品订单，对它们进行处理和验证。是的，对于大量的请求，手动完成所有这些工作会很麻烦。这就是为什么我们需要一种方法来自动化它。</p><h1 id="14e3" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">如何实施，做些什么？</h1><p id="5f49" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">自动化它的一个简单而常见的做法是使用模板。例如:</p><pre class="kg kh ki kj gt nc nb nd ne aw nf bi"><span id="4805" class="ng mc iq nb b gy nh ni l nj nk">Name: &lt;NAME&gt;<br/>Address: &lt;ADDRESS&gt;<br/>Order:</span><span id="8898" class="ng mc iq nb b gy ns ni l nj nk">&lt;Product Quantity&gt; &lt;Product Name&gt;</span></pre><p id="abc1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它可以通过使用正则表达式(Regex)技术轻松实现。可悲的是，使用它有一些缺点:</p><ol class=""><li id="bd59" class="nt nu iq ky b kz la lc ld lf nv lj nw ln nx lr ny nz oa ob bi translated">刚性，用户应该根据模板来放置消息。错别字或任何附加信息将使服务无法提取信息。</li><li id="a54e" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">产品名称上的错别字会使产品无法被检测，无法提取。</li></ol><p id="0153" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是自然语言处理(NLP)，特别是通过使用命名实体抽取(NER)系统可以解决的第一个问题。第二个问题可以通过使用信息检索系统来解决。首先，我们提取我们想要提取的实体加上产品名称和数量。为了解决打字错误的问题，我们使用信息检索技术来推荐相似的产品。</p><h1 id="29bc" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结束实施</h1><p id="8d5b" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">通常，服务部署在后端服务之后，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/96254010495b650c0b189190b2766c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*teBBP3ieHEg3x02x.jpg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="oi">这种思想的完整体系</em></figcaption></figure><p id="d5d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们将只关注AI服务并返回提取的信息。</p><p id="0dbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于人工智能服务，它看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/8a5d04f431ec9efc79d6592dd5e7f0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RNS6WOy9kx0sJ3fo.jpg"/></div></div></figure><p id="de1c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是服务输入的例子。</p><pre class="kg kh ki kj gt nc nb nd ne aw nf bi"><span id="f338" class="ng mc iq nb b gy nh ni l nj nk">[BUYER]: <br/>Hi, here is my order:<br/><br/>Name: **Si Meong** &lt;NAME&gt;<br/>Address: **Meow Meow Street** &lt;ADDRESS&gt;<br/><br/>Order:<br/>**1** &lt;Product Quantity&gt; **T-Shirt Meow** &lt;Product Name&gt;<br/>**4** &lt;Product Quantity&gt; **Shoet Moew** &lt;Product Name&gt;<br/>Thank you!<br/><br/>Regards,<br/><br/>Customer</span></pre><p id="12f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们假设<code class="fe my mz na nb b">Shoet Moew</code>不在产品列表中，类似的产品是<code class="fe my mz na nb b">Shirt Moew</code>和<code class="fe my mz na nb b">Short Moew</code>。</p><p id="503b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">传递的信息(在JSON中)</p><pre class="kg kh ki kj gt nc nb nd ne aw nf bi"><span id="4edb" class="ng mc iq nb b gy nh ni l nj nk">{<br/>  "name": "Si Meong",<br/>  "address": "Meow Meow Street",<br/>  "order": [<br/>    {<br/>      "qty": 1,<br/>      "product_name": "t_shirt_meow"<br/>    }<br/>  ],<br/>  "suggest": [<br/>    {<br/>      "query": "Shoet Moew",<br/>      "qty": 4,<br/>      "suggest": ["shirt_moew", "short_moew"]<br/>    }<br/>  ]<br/>}</span></pre><p id="f8d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们将进入NER的细节。</p><h1 id="2c73" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">命名实体识别(NER)</h1><p id="6658" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">下面是对NER的描述。</p><blockquote class="nl nm nn"><p id="fc75" class="kw kx no ky b kz la jr lb lc ld ju le np lg lh li nq lk ll lm nr lo lp lq lr ij bi translated"><em class="iq">“命名实体识别(NER)的任务是用相应的类型标记文本中的实体。”—paperswithcode.com</em></p></blockquote><p id="2014" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">NER的输出提取了我们想要的实体。例如:</p><ol class=""><li id="79c6" class="nt nu iq ky b kz la lc ld lf nv lj nw ln nx lr ny nz oa ob bi translated">名字</li><li id="b255" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">地址</li><li id="fc31" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">银行</li><li id="ab16" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">注意</li><li id="274b" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">产品名称</li><li id="ddbe" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">产品数量</li><li id="19f3" class="nt nu iq ky b kz oc lc od lf oe lj of ln og lr ny nz oa ob bi translated">电话号码</li></ol><p id="6c1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的例子中，我们只提取姓名、地址、产品数量和名称。</p><h1 id="a92b" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">NER培训:数据</h1><p id="4c32" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">要制作NER系统，我们要么使用现成的服务(通常不适合您的需求)，要么开发您的NER系统。当前创建NER系统的流行技术是使用机器学习。为了创建它，我们需要<code class="fe my mz na nb b">train</code>一个带有标签NER数据集的NER <code class="fe my mz na nb b">model</code>。您需要一组数据，这些数据包含带有实体标签的成对文本。</p><p id="1cc6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">训练模型时的问题是准备数据。我们需要类似于真实场景分布的数据。如果有数据，可以手动注释。但是，如果你只有很少的数据，或者根本没有数据，</p><p id="41a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以编写代码来生成数据合成，使用数据合成库，或者利用上下文无关语法(CFG)来生成它们。如果使用CFG，可以使用Python中的<code class="fe my mz na nb b">nltk</code>包。它有一个CFG工具。</p><h1 id="e821" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">培训NER:模型</h1><p id="0fbf" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我们需要一个模型，可以根据提供的数据来概括实体提取。机器学习中当前流行的方法是使用深度学习模型。在NLP中，像BERT或ROBERTA这样的预训练模型很受欢迎。我们需要做的是对数据再次训练预训练的模型(我们称之为<code class="fe my mz na nb b">fine-tune</code>)..</p><p id="1fa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于印度尼西亚数据，您可以使用IndoBERT或IndoNLU模型，并根据您的数据对它们进行训练。这将产生一个伟大的质量模型。你可以在<a class="ae kv" href="https://www.huggingface.co" rel="noopener ugc nofollow" target="_blank"> Huggingface </a>上搜索它们，并根据你的数据对模型进行微调。</p><h1 id="cd33" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">信息检索:弹性搜索</h1><p id="f6cd" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">文中一个流行的信息检索是<strong class="ky ir"> elasticsearch </strong>。它是一个建立在Apache Lucene之上的信息检索工具，在Apache Lucene中它被优化来完成检索工作。</p><p id="a82d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它很快，因为它使用倒排索引来做它的搜索系统。它将查询术语与文档术语进行匹配。它不会搜索没有查询术语(或单词)的文档。在选择文档之后，它们将通过评分函数进行排序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/32f1562c59ab0eb5aea9b39de80c01b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iJT3wcOaVPo7bgba.jpg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="oi">弹性搜索的倒排索引。从</em> <a class="ae kv" href="http://elastic.co" rel="noopener ugc nofollow" target="_blank"> <em class="oi">到</em> </a></figcaption></figure><p id="c1c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个问题中，我们有一个错别字问题。因此，精确匹配是不合适的。好在弹性搜索有<code class="fe my mz na nb b">fuzzy query</code>可以解决错别字问题。它将使用<strong class="ky ir"> levenshtein距离</strong>算法来扩展查询中的术语。你可以在这个<a class="ae kv" href="https://en.wikipedia.org/wiki/Levenshtein_distance" rel="noopener ugc nofollow" target="_blank">维基百科页面</a>上阅读更多细节。</p><p id="ec90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">弹性搜索有自己的评分功能，可以对检索到的文档进行排名。它遵循Apache Lucene的实现。更多详情可以访问这个<a class="ae kv" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/practical-scoring-function.html" rel="noopener ugc nofollow" target="_blank">页面</a>。</p><h1 id="c4e3" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">订单自动提取综述</h1><p id="3c31" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我们使用NER模型从消息中提取实体。然后使用IR工具(elasticsearch)将产品与卖家的产品列表进行匹配。</p><p id="e958" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是基于上述输入的聊天机器人响应示例:</p><pre class="kg kh ki kj gt nc nb nd ne aw nf bi"><span id="0ec3" class="ng mc iq nb b gy nh ni l nj nk">[RESPONSE]:<br/><br/>Here is your biodata:<br/>Name: Si Meong<br/>Address: Meow Meow Street<br/><br/>Order:<br/>1 x T shirt Meow = IDR 2.000.000<br/>"Shoet Moew" is not found, did you mean "Shirt Moew", "Short Moew"?</span></pre><h1 id="1a38" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">图像检索</h1><p id="648b" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">如题，它是一种用图像代替文本的信息检索。给定一个查询图像，返回与查询相似的图像。</p><h1 id="c2cd" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">为什么这个实现很重要？</h1><p id="3a52" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">有时，用户会忘记他们想要搜索的东西的名称。假设用户有图像，则可以选择使用图像相似性进行搜索。此外，在某些情况下，用户希望通过图片而不是名称来搜索某样东西。</p><h1 id="7fd4" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">如何实施，做些什么？</h1><p id="7cd0" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我们需要实现一个可以通过使用图像作为查询来检索图像的IR系统。为此，我们可以使用计算机视觉知识。我们需要将图像表示成可以用作相似性评分输入的东西。在一个IR系统中，有一个术语叫做<strong class="ky ir">向量空间模型</strong>，在这里你将文档(在这里是图像)表示为权重向量。所以，我们需要用向量来表示图像。</p><p id="e2c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以通过使用计算机视觉中的深度学习模型，提取出能够代表图像的向量。你可以利用计算机视觉预训练模型。这意味着您可以使用一个模型来输出一个<strong class="ky ir">向量</strong>，用于计算查询和文档(图像)的相关性。通过使用距离或相似性算法，我们可以计算每幅图像之间的距离。</p><p id="26dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是人工智能服务的管道:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/d89a9fb97f2f1e11fda31f6170e5b005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1KX4jguBe1ZBRRcz.jpg"/></div></div></figure><p id="a45d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将深入了解每一个问题的细节</p><h1 id="c91d" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">提取模型</h1><p id="274c" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">正如我上面所说的，我们使用一个模型将图像表示为一个向量。有许多计算机视觉预训练模型可以使用，如VGG网，雷斯网，Eff-net和VIT。我们可以使用其中的一个，无需再次微调，输出向量。这里有一个例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/e8e47cb4a0192ed6267b86c526da37d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*heFYAoaGiOX_nWYp.jpg"/></div></div></figure><p id="e019" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有时，预先训练的模型需要更多的改进以适合你的需要。为此，您可以通过使用ArcFace对其进行微调来再次训练它。你需要带标签的图像数据来训练它，每个类告诉你它们应该有近似的矢量输出。微调会使一个类中的每个图像彼此变得更接近。它具有较高的类内相似性和类间差异。这种技术常用于人脸识别模型。</p><h1 id="27f4" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">行动中的图像提取</h1><p id="a308" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">假设我们有一个图像商店(例如:NFT)并使用图像检索，您选择使用VGGNet作为计算机视觉预训练模型。假设您的数据库集合中有4幅图像:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/0b72b79f155e6b480c4162c83199f0d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GLuVc64aoRSWy925.jpg"/></div></div></figure><p id="3774" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您从图像查询中提取向量。您还可以对数据库中的图像进行同样的操作。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/13eede22d84d86f2c50dbbe7e2442f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JwOY2KsrWEDUZvzo.jpg"/></div></div></figure><p id="e2db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，对这些图像与数据库中的每个图像之间的相似性进行排序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/7f8e0b81b947482245f85eeda31d7662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hsgrBpoB29D8Bmj0.jpg"/></div></div></figure><p id="0a65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了对相似性进行排序，我们可以使用一个简洁的开源软件。它叫做faiss。</p><h1 id="e9fd" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">相似性搜索:faiss</h1><p id="104a" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">Faiss是一个可以对密集向量进行相似性搜索的库。它被广泛用于图像检索。它拥有多种相似性距离算法，如欧几里德相似性和余弦相似性。它可以很快，因为它有一个巧妙的技巧来进行快速索引(相似性计算)。</p><h1 id="87ba" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">Faiss效率:划分为Voronoi单元和量化</h1><p id="8ea3" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">这两个功能在Faiss上都可以有效地做到。第一个是将索引数据库中的向量划分或聚类成Voronoi单元的能力。它把你的数据分成k个簇。执行查询时，将向量与所有聚类的质心(中心)点进行比较。然后你取n个集群，对这n个集群上的数据进行全面搜索。用户选择n和k。参见下面Voronoi单元的图示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/9defe1466980edd58e355c1ec096a0ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xwafUaYPKjrhHiKY.jpg"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/2b2bc9ef6f039e5a4f70c5e619b86962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6YnUiEnqDEian0oY.jpg"/></div></div></figure><p id="0182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一个惊人的技巧是利用Faiss的量子化。它收缩原始向量并量化向量中的值。首先，它将向量分割成子向量。然后，它根据数据库中的所有向量对其向量进行聚类，然后将每个子向量的值更改为cluster-ID。您可以看到下图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/80446fcd90c7b0b7d6c3a62488bb28ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MXK1ZxE8ux9Bl0Fr.jpg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">其中三张照片取自<a class="ae kv" href="https://www.pinecone.io/learn/faiss-tutorial/" rel="noopener ugc nofollow" target="_blank">这里</a></figcaption></figure><p id="af1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上图片和解释摘自这个<a class="ae kv" href="https://www.pinecone.io/learn/faiss-tutorial/" rel="noopener ugc nofollow" target="_blank">博客</a>(感谢精彩的插图)。更多详情请随意访问。</p><h1 id="0d1e" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结论</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/2f02c3127ad137985721e2efbf4b8064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ICSLRwbyBl6XivQq"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="oi">随机猫~。照片由</em><a class="ae kv" href="https://unsplash.com/@madhatterzone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"><em class="oi">Manja Vitolic</em></a><em class="oi">上</em><a class="ae kv" href="https://unsplash.com/s/photos/cat?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"><em class="oi">un splash</em></a><em class="oi">。</em></figcaption></figure><p id="f795" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我编写了两个使用文本和图像信息检索的实现。这里有你可以使用的流行工具，比如<code class="fe my mz na nb b">elasticsearch</code>和<code class="fe my mz na nb b">faiss</code>。这些工具有一些巧妙的技巧来进行有效的搜索。我们可以使用它们在生产中部署IR系统。</p><p id="bfcf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一个关于如何部署红外系统的表面。还有一个额外的步骤，你可以使用，如微调，使模型更好，并重新排名。你可以研究它们来制造一个更强大的红外系统。</p><p id="2d99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">欢迎对下面的帖子发表评论或向我提问。</p><h1 id="8528" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">注意</h1><p id="ae0d" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">这篇文章转自我的博客:<a class="ae kv" href="https://haryoa.github.io/posts/example-ir-systems/" rel="noopener ugc nofollow" target="_blank">https://haryoa.github.io/posts/example-ir-systems/</a>。欢迎参观！</p></div></div>    
</body>
</html>