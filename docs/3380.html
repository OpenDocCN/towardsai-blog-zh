<html>
<head>
<title>Querying Synapse Analytics Delta Lake from Databricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从数据块中查询Synapse Analytics Delta Lake</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/querying-synapse-analytics-delta-lake-from-databricks-aef7473160f4?source=collection_archive---------0-----------------------#2022-12-08">https://pub.towardsai.net/querying-synapse-analytics-delta-lake-from-databricks-aef7473160f4?source=collection_archive---------0-----------------------#2022-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f9c7c487fc9e109bf804c6e2756e4cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mml3jUHvmls1f6G1.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://www.databricks.com/blog/2020/03/06/connect-90-data-sources-to-your-data-lake-with-azure-databricks-and-azure-data-factory.html" rel="noopener ugc nofollow" target="_blank">数据块</a>生成的图像</figcaption></figure><p id="92b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于如何从专用池和无服务器池的数据块中连接(查询)Azure Synapse Analytics Delta Lake数据的分步指南。</p><h1 id="ca71" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">问题陈述</h1><p id="379f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">近年来，特别是随着Delta lake的出现，使用数据块作为处理的主要来源和使用内部服务(如Azure Synapse Analytics)来管理对所述资源的访问变得越来越普遍。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/27614ef817933e0b37d504a81b00ffa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/0*tfzXrDWEf6fi-TYd.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Azure Databricks、Data Lake Gen 2和Synapse Analytics trifactor</figcaption></figure><p id="11ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，要求通过数据块读取存储在Synapse Analytics中的数据变得越来越常见，尤其是当您对通过数据块进行复杂的分析或机器学习感兴趣时。然而，这个过程并不简单，而且在撰写本文时，文档资料严重缺乏。</p><p id="6498" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您通过<a class="ae kc" href="https://learn.microsoft.com/en-us/azure/synapse-analytics/sql/develop-tables-external-tables?tabs=hadoop" rel="noopener ugc nofollow" target="_blank">外部表</a>或<a class="ae kc" href="https://learn.microsoft.com/en-us/azure/synapse-analytics/sql/query-delta-lake-format" rel="noopener ugc nofollow" target="_blank">外部视图</a>抽象您存储的对象——例如，Delta文件——这个需求可能特别重要。</p><h1 id="2284" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">解决办法</h1><p id="5f51" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">该解决方案由三个简单但漫长的步骤组成:</p><ol class=""><li id="a6d1" class="mj mk iq kf b kg kh kk kl ko ml ks mm kw mn la mo mp mq mr bi translated">选择和配置合适的数据块连接器</li><li id="9580" class="mj mk iq kf b kg ms kk mt ko mu ks mv kw mw la mo mp mq mr bi translated">配置Azure Synapse分析</li><li id="e5e0" class="mj mk iq kf b kg ms kk mt ko mu ks mv kw mw la mo mp mq mr bi translated">将数据块连接到Azure Synapse Analytics</li></ol><h2 id="884e" class="mx lc iq bd ld my mz dn lh na nb dp ll ko nc nd lp ks ne nf lt kw ng nh lx ni bi translated">1.选择和配置合适的数据块连接器</h2><p id="0058" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><a class="ae kc" href="https://learn.microsoft.com/en-us/azure/databricks/external-data/synapse-analytics" rel="noopener ugc nofollow" target="_blank">如本指南所述</a>，Databricks为Azure Synapse Analytics提供了一个现成的连接器。然而，这个<strong class="kf ir">连接器只适用于专用的SQL池</strong>。如果你想连接到一个无服务器的SQL池，你将不得不使用<a class="ae kc" href="https://learn.microsoft.com/en-us/sql/connect/spark/connector?view=sql-server-ver16" rel="noopener ugc nofollow" target="_blank">微软的Apache Spark连接器:SQL Server &amp; Azure SQL </a>。</p><p id="ded2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要安装连接器并使其可用于集群实例，可以通过Databricks集群中的安装向导直接安装连接器，或者使用Maven坐标。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/567a4e28518051c187d561c46859a3c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RmiRxAEgAEp49XMGdKtq6w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Maven坐标的数据块依赖项安装向导</figcaption></figure><p id="59af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，这不是一个容易维护的过程，尤其是如果您想要使用<em class="nk"> dbx </em>来部署您的实例。通过使用<em class="nk"> dbx </em>来管理您的部署(CI/CD ),可以简化这个过程。要将它合并到<em class="nk"> dbx </em>中，请将下面一行添加到您的<em class="nk"> deployment.json </em> ( <a class="ae kc" href="https://dbx.readthedocs.io/en/latest/guides/general/dependency_management/#adding-jvm-dependencies-to-your-python-project" rel="noopener ugc nofollow" target="_blank">请参见官方文档，了解如何在这里</a>添加maven依赖项的详细信息):</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="9c0c" class="nq lc iq nm b be nr ns l nt nu">libraries:<br/>  - maven: <br/>    coordinates:"com.microsoft.azure:spark-mssql-connector_2.12:1.2.0"</span></pre><h2 id="6a3e" class="mx lc iq bd ld my mz dn lh na nb dp ll ko nc nd lp ks ne nf lt kw ng nh lx ni bi translated">2.配置Azure Synapse分析</h2><p id="fcb5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">这个过程中最困难的——也可能是最令人困惑的——部分包括配置Azure Synapse Analytics以允许外部实体查询您的对象。</p><p id="a8f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.1-(可选)创建数据库级主密钥</strong></p><p id="11d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一步是确保您的数据库有一个用于保护凭证的主密钥。<br/>注意:如果您已经设置了数据库，可以跳过这一步。</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="0eb2" class="nq lc iq nm b be nr ns l nt nu">USE database_name;<br/>CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'strong_password';</span></pre><p id="9ca7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.2-创建数据库范围的凭据</strong></p><p id="b464" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二步要求我们设置一个限定范围的凭证，该凭证管理对数据湖容器中使用的存储文件的访问。</p><p id="d644" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一步需要一个共享访问签名SAS令牌。</p><p id="5b81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要检索它，请打开您的Azure门户，导航到存储帐户，选择您的存储帐户，然后打开共享访问签名菜单:</p><blockquote class="nv nw nx"><p id="cd79" class="kd ke nk kf b kg kh ki kj kk kl km kn ny kp kq kr nz kt ku kv oa kx ky kz la ij bi translated">Azure门户&gt;存储帐户&gt;存储帐户&gt;容器&gt;共享访问签名</p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/8ab38f487db2370c2044eedf9de477e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*DSCnOYMjsssUpH4ooYLTSQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Azure存储帐户(安全+网络)共享访问签名选项卡</figcaption></figure><p id="cc2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们需要生成一个SAS令牌。确保仅选择所需的权限，并点击“生成服务协议”按钮:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/6a7c163b5e04c5f4efcde0924579c51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E5GOzRy68hL0YZ6WnIXl1Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Azure存储帐户共享访问签名生成器</figcaption></figure><p id="c08a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在底部，您会发现一系列包含我们的SAS令牌的生成块。</p><blockquote class="nv nw nx"><p id="f526" class="kd ke nk kf b kg kh ki kj kk kl km kn ny kp kq kr nz kt ku kv oa kx ky kz la ij bi translated"><strong class="kf ir">注</strong>:令牌格式为“<strong class="kf ir"> <em class="iq">？sv=202******" </em> </strong>，粘贴到SQL脚本时必须忽略问号前缀，<em class="iq">？</em>。意，秘“<em class="iq">？sv=202******" </em>变成了"<strong class="kf ir"> <em class="iq">"</em></strong></p></blockquote><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="4c8e" class="nq lc iq nm b be nr ns l nt nu">CREATE DATABASE SCOPED CREDENTIAL ProdReadAccess<br/>WITH IDENTITY='SHARED ACCESS SIGNATURE',<br/>SECRET='sv=your_secret'<br/>GO</span></pre><p id="ff24" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.3-创建外部数据源</strong></p><p id="3225" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们的数据存在于Azure Blob存储容器中，我们必须通过外部数据源的概念使其对Azure Synapse Analytics可用。<br/>在这种情况下，我们将创建一个名为<em class="nk"> prod_lake </em>的外部数据源，分配<em class="nk"> ProdReadAccess </em>凭证，最后指定Delta Lake存储位置:</p><p id="d60f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:如果您不知道您的存储位置地址，请继续步骤2.3.1。</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="3f13" class="nq lc iq nm b be nr ns l nt nu">IF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'prod_lake')<br/>CREATE EXTERNAL DATA SOURCE [prod_lake]<br/>WITH (<br/>LOCATION = 'https://yourstorage.dfs.core.windows.net/your_container',<br/>CREDENTIAL = ProdReadAccess<br/>)</span></pre><p id="d7d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.3.1-(可选)检索数据湖存储端点</strong></p><p id="a039" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在前面的步骤中，位置参数是在假设它事先已知的情况下插入的。如果您不知道该参数的值，请打开您的存储帐户，转到端点部分并检索数据湖存储链接。</p><blockquote class="nv nw nx"><p id="a0a0" class="kd ke nk kf b kg kh ki kj kk kl km kn ny kp kq kr nz kt ku kv oa kx ky kz la ij bi translated">Azure门户&gt;存储帐户&gt;存储帐户&gt;容器&gt;端点</p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ee8cb093a0094efdaed9b2931879ba91.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*4jET_pXYyae4_4Q2inWXBw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Azure存储帐户(设置)“端点”选项卡</figcaption></figure><p id="3559" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.4-创建认证凭证</strong></p><p id="4080" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.4.1-创建一个登录</strong></p><p id="8489" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先创建一个名为<em class="nk"> databricks_synapse </em>的登录名:</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="04ef" class="nq lc iq nm b be nr ns l nt nu">CREATE LOGIN databricks_synapse WITH PASSWORD = 'your_strong_password';</span></pre><p id="7ea4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.4.2-通过登录</strong>创建一个用户</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="9ccb" class="nq lc iq nm b be nr ns l nt nu">CREATE USER databricks_synapse FROM LOGIN databricks_synapse;</span></pre><p id="11f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.4.3-授予用户读取容器项目的权限</strong></p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="5007" class="nq lc iq nm b be nr ns l nt nu">GRANT REFERENCES ON DATABASE SCOPED CREDENTIAL::[ProdReadAccess] TO [databricks_synapse];</span></pre><p id="79eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.4.3-更改用户角色以允许从SQL实例中读取数据</strong></p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="850f" class="nq lc iq nm b be nr ns l nt nu">ALTER ROLE db_datareader ADD MEMBER [databricks_synapse];</span></pre><p id="f920" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 2.4.4-(可选)在增量资源上创建视图或外部表</strong></p><p id="72e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用创建的数据源<em class="nk"> prod_lake </em>在外部增量资源上创建一个视图(或外部表):</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="3f01" class="nq lc iq nm b be nr ns l nt nu">CREATE VIEW dw.test_view AS<br/>  SELECT *<br/>  FROM OPENROWSET(<br/>  BULK 'test_delta/',<br/>  DATA_SOURCE = 'prod_lake',<br/>  FORMAT = 'DELTA'<br/>  )<br/>  AS [r];</span></pre><h2 id="f7cc" class="mx lc iq bd ld my mz dn lh na nb dp ll ko nc nd lp ks ne nf lt kw ng nh lx ni bi translated"><strong class="ak"> 3。将数据块连接到Azure Synapse Analytics </strong></h2><p id="c0b0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">最后，我们需要指示Databricks连接到Azure Synapse Analytics并查询特定的表——或者执行查询。</p><p id="9e12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 3.1。检索(专用或无服务器)池主机名</strong></p><p id="8f36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了连接到专用或无服务器池，我们需要其特定的SQL端点地址。这允许我们基于所需的工作负载选择池实例。</p><p id="c6e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最简单的检索方法是通过Synapse Analytics工作区。打开SQL pools分隔符并访问所需的SQL池—默认情况下是内置的，或者是无服务器的。</p><blockquote class="nv nw nx"><p id="2db8" class="kd ke nk kf b kg kh ki kj kk kl km kn ny kp kq kr nz kt ku kv oa kx ky kz la ij bi translated">Azure门户&gt; Azure Synapse分析&gt; *选择您的实例* &gt;打开Synapse Studio &gt;管理&gt; SQL池</p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/6d28cfc5877fa986f2fc2c1240797efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*yIkYqzmujZU1OmwcJZhuWg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Synapse Analytics Studio管理分隔符，指向SQL池管理器</figcaption></figure><p id="b6ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过选择所需的SQL池，弹出一个包含所需信息的<em class="nk">属性</em>窗口:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/520a27d0381f30ae9c09bae14f354852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*ptcKR3ynMAcJovCpe7t_XQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">“内置”SQL池的属性窗口</figcaption></figure><p id="2369" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> 3.2。查询Azure Synapse分析端点</strong></p><p id="975c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本微软指南详细介绍了这一部分及其细节。</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="bee3" class="nq lc iq nm b be nr ns l nt nu">spark.conf.set("fs.azure.account.key.&lt;your-storage-account-name&gt;.dfs.core.windows.net",<br/>  "&lt;your-storage-account-access-key&gt;")<br/><br/>hostname: str = "prodsynapse-data-ondemand.sql.azuresynapse.net"<br/>database: str = "your_database_name"<br/>port: int = 1433<br/>user: str = "databricks_synapse"<br/>password:str = "your_strong_password"<br/>table_name: str = "dw.test_view"<br/><br/><br/>display(spark.read<br/>      .format("jdbc")<br/>      .option("driver", "com.microsoft.sqlserver.jdbc.SQLServerDriver")<br/>      .option("url", f"jdbc:sqlserver://{hostname}:{port};database={database}")<br/>      .option("user", user)<br/>      .option("password", password)<br/>      .option("dbtable", table_name)<br/>      .load().limit(10))</span></pre><p id="5a2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想改为执行查询，请用查询和相应的参数替换<em class="nk"> dbtable </em>选项:</p><pre class="mf mg mh mi gt nl nm nn bn no np bi"><span id="4238" class="nq lc iq nm b be nr ns l nt nu">spark.conf.set("fs.azure.account.key.&lt;your-storage-account-name&gt;.dfs.core.windows.net",<br/>  "&lt;your-storage-account-access-key&gt;")<br/><br/>hostname: str = "prodsynapse-data-ondemand.sql.azuresynapse.net"<br/>database: str = "your_database_name"<br/>port: int = 1433<br/>user: str = "databricks_synapse"<br/>password:str = "your_strong_password"<br/>query: str = "select top(10) * from dw.test_view"<br/><br/>display(spark.read<br/>      .format("jdbc")<br/>      .option("driver", "com.microsoft.sqlserver.jdbc.SQLServerDriver")<br/>      .option("url", f"jdbc:sqlserver://{hostname}:{port};database={database}")<br/>      .option("user", user)<br/>      .option("password", password)<br/>      .option("query", query)<br/>      .load().limit(10))</span></pre></div></div>    
</body>
</html>