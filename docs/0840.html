<html>
<head>
<title>How to Create a New Custom Dataset from Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何根据图像创建新的自定义数据集</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-create-a-new-custom-dataset-from-images-9b95977964ab?source=collection_archive---------0-----------------------#2020-08-24">https://pub.towardsai.net/how-to-create-a-new-custom-dataset-from-images-9b95977964ab?source=collection_archive---------0-----------------------#2020-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/6b105338ee8f76c330b736ad608c0b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dspHhcrgwH6G_wfNzAmsEw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><h2 id="46a9" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="dd42" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="lk">如果你和我一样，试图从原始图像中构建你的自定义图像数据集，那么</em> <strong class="ko jq"> <em class="lk">这篇文章就是为你准备的！</em>T11】</strong></p><p id="36d9" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们都已经学会了如何在经典的MNIST/时尚MNIST数据集上建立机器学习模型。但是，如果你想训练一个模型来识别你朋友的脸呢？互联网上没有这方面的数据集。</p><p id="f563" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在公共数据集上工作了几个月后，我想创建一个自定义的面部图像数据集，并使用它们进行面部识别。</p><p id="191a" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">真正的专业知识是通过使用机器学习来解决自己的问题来展示的。构建自己的图像数据集本身就不是一件简单的事情。令人惊讶的是，在大多数在线课程中，它的覆盖面远没有这么全面。</p><p id="f1ce" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我寻找做这件事的方法，最后终于弄明白了。</p><p id="c04e" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在本文中，您将学习如何准备自己的原始图像数据集，然后可以用于自己的图像分类/计算机视觉项目。</p><h2 id="15d9" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">步伐</h2><ol class=""><li id="30be" class="md me jg ko b kp mf kt mg kx mh lb mi lf mj lj mk ml mm mn bi translated">为数据集收集影像</li><li id="d44c" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">根据图片的类别给它们重新命名</li><li id="6d8a" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">将它们合并到一个文件夹中</li><li id="c7ac" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">调整图片大小</li><li id="3c2b" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">将所有图像转换成相同的文件格式</li><li id="9602" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">将图像转换为CSV文件</li><li id="209e" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">对CSV文件的一些调整</li><li id="9062" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">加载CSV(奖金)</li></ol><h2 id="0c46" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">为数据集收集影像</h2><p id="148d" class="pw-post-body-paragraph km kn jg ko b kp mf kr ks kt mg kv kw kx mt kz la lb mu ld le lf mv lh li lj ij bi translated">举个例子，假设我想建立一个模型来区分山谬·里维和我的XD。</p><p id="427d" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你需要创建一个你自己的脸的数据集或者从谷歌上批量下载图片，<a class="ae jd" href="https://www.pyimagesearch.com/2018/06/11/how-to-build-a-custom-face-recognition-dataset/" rel="noopener ugc nofollow" target="_blank">这篇来自<em class="lk"> pyimagesearch </em>的文章</a>将带你完成它。</p><p id="56ba" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">得到图片后，根据图片的类别将图片分类到不同的文件夹中。为了简单起见，我打算每个类只使用五张图片(你可以使用任意多的图片。越多越好)。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a1ef2c456526cda2600162050a16226f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*Lt8pLjgaxcllJutZ8VEGKA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/f782900ff421e652420ca3091852035c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*s_g6iHVqJ8goSSkQZ1CXPg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">文件夹里放着山谬·里维的图片|图片作者<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a66390113900af7e08b42ef488990169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*E3ui1hWZlPdZFjuSX_GQjg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">文件夹包含我的图片|图片作者<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><blockquote class="nb"><p id="261a" class="nc nd jg bd ne nf ng nh ni nj nk lj dk translated">机器学习模型的好坏取决于我们输入的数据。</p></blockquote><p id="075f" class="pw-post-body-paragraph km kn jg ko b kp nl kr ks kt nm kv kw kx nn kz la lb no ld le lf np lh li lj ij bi translated">清理数据。删除重复项。围绕您感兴趣的点裁剪图像(在本例中，是基努和我的脸),以充分利用您的数据。</p><h2 id="345c" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">根据图片的类别给它们重新命名</h2><ol class=""><li id="c419" class="md me jg ko b kp mf kt mg kx mh lb mi lf mj lj mk ml mm mn bi translated">打开文件夹并选择所有图像。</li><li id="ad25" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">右键单击它们。</li><li id="8226" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">根据它们的类别重新命名它们。</li></ol><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/821a845a4aebbb1ff9d52072ba2ac9a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*h2Xkql0HxMJ2ukpW7XnQrg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">重命名后的文件|图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="2833" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">4.对剩余的所有类重复此操作。用至少一个不同的字母表来命名这些类(这在后面的过程中是需要的)。</p><h2 id="0178" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">将所有图像合并到一个文件夹中。</h2><h2 id="c70b" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">调整图片大小</h2><p id="73e5" class="pw-post-body-paragraph km kn jg ko b kp mf kr ks kt mg kv kw kx mt kz la lb mu ld le lf mv lh li lj ij bi translated">我们为此使用的工具是<a class="ae jd" href="https://www.bricelam.net/ImageResizer/" rel="noopener ugc nofollow" target="_blank"><em class="lk">Windows</em></a>的图像缩放器。它是免费的，小巧的，完全没有恶意软件。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/fd106977f5f1ff2b7cda8cea3072446d.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*7s2RcmK4_odkBy238jCsBg.jpeg"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="c7bf" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">下载完成后，点击<strong class="ko jq">安装</strong>。</p><p id="610d" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">一旦程序安装到你的电脑上，你就可以开始了。现在，转到包含您想要调整大小的照片的文件夹。</p><p id="9fb9" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">选择您的照片。然后右击它们，从选项中选择<strong class="ko jq">调整图片</strong>的大小。</p><p id="82ab" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">然后会弹出一个窗口。在这里，您可以修改将要处理的图片的基本设置。</p><p id="3424" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以选择图片的大小。在这种情况下，我将图像的大小调整为48 x 48像素。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/4c8bb71faf0451ea5ec01b339570a88c.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*JynORwddx2dKdM5ciGIHAw.jpeg"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">别忘了从“合身”变成“舒展”。|图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="d0a6" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">注意:有时，较小的图片会被resizer忽略。调整大小后，选择所有图像并验证所有图像的大小是否相同。</p><h2 id="23ef" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">将所有图像转换成相同的文件格式</h2><p id="9197" class="pw-post-body-paragraph km kn jg ko b kp mf kr ks kt mg kv kw kx mt kz la lb mu ld le lf mv lh li lj ij bi translated">这里有一个简单而有效的技巧。你可以选择。png或者。jpg格式。</p><p id="77d6" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko jq">第1步</strong> —在任务栏搜索栏键入<strong class="ko jq"> cmd </strong>并同时按下<strong class="ko jq"> Ctrl + Shift + Enter </strong>键。如果遇到<strong class="ko jq"> UAC </strong>的提示，点击<strong class="ko jq">是</strong>。</p><p id="558d" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko jq">第二步</strong> —在命令提示符下，首先输入保存文件的新文件夹的路径(Spotlight的图像)。为此，请键入–</p><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="83ac" class="ll lm jg nt b gy nx ny l nz oa">cd path of the folder</span></pre><p id="31de" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko jq">注意</strong>——请将<strong class="ko jq">路径文件夹</strong>替换为实际路径。</p><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="0121" class="ll lm jg nt b gy nx ny l nz oa">cd C:\Users\Uday\Desktop\Misc\Medium\Merged</span></pre><p id="acc7" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko jq">第三步</strong> —将图像转换为<strong class="ko jq"> JPG </strong>格式，输入给定的批处理命令，按<strong class="ko jq">键进入</strong>。</p><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="2837" class="ll lm jg nt b gy nx ny l nz oa">Ren *.* *.jpg</span></pre><p id="110d" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko jq">步骤4 </strong> —要将图像转换为<strong class="ko jq"> PNG </strong>格式，使用以下批处理命令—</p><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="ec5c" class="ll lm jg nt b gy nx ny l nz oa">Ren *.* *.png</span></pre><h2 id="8a55" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">将图像转换成CSV格式</h2><p id="a755" class="pw-post-body-paragraph km kn jg ko b kp mf kr ks kt mg kv kw kx mt kz la lb mu ld le lf mv lh li lj ij bi translated">运行以下代码，将所有图像转换为CSV格式，并相应地标记它们。</p><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="dee0" class="ll lm jg nt b gy nx ny l nz oa">from PIL import Image<br/>import numpy as np<br/>import sys<br/>import os<br/>import csv</span><span id="7239" class="ll lm jg nt b gy ob ny l nz oa"># default format can be changed as needed<br/>def createFileList(myDir, format='.jpg'):<br/>    fileList = []<br/>    print(myDir)<br/>    labels = []<br/>    names = []<br/>    keywords = {"K" : "1","U": "0",} # keys and values to be changed as needed</span><span id="494c" class="ll lm jg nt b gy ob ny l nz oa">for root, dirs, files in os.walk(myDir, topdown=True):<br/>        for name in files:<br/>            if name.endswith(format):<br/>                fullName = os.path.join(root, name)<br/>                fileList.append(fullName)<br/>            for keyword in keywords:<br/>                if keyword in name:<br/>                    labels.append(keywords[keyword])<br/>                else:<br/>                    continue<br/>            names.append(name)<br/>    return fileList, labels, names</span><span id="504d" class="ll lm jg nt b gy ob ny l nz oa"># load the original image<br/>myFileList, labels, names  = createFileList('/content/')<br/>i = 0<br/>for file in myFileList:<br/>    print(file)<br/>    img_file = Image.open(file)<br/>    # img_file.show()</span><span id="a93c" class="ll lm jg nt b gy ob ny l nz oa"># get original image parameters...<br/>    width, height = img_file.size<br/>    format = img_file.format<br/>    mode = img_file.mode</span><span id="c13d" class="ll lm jg nt b gy ob ny l nz oa"># Make image Greyscale<br/>    img_grey = img_file.convert('L')<br/>    #img_grey.save('result.png')<br/>    #img_grey.show()</span><span id="f4e8" class="ll lm jg nt b gy ob ny l nz oa"># Save Greyscale values<br/>    value = np.asarray(img_grey.getdata(), dtype=np.int).reshape((width, height))<br/>    value = value.flatten()<br/>    <br/>    value = np.append(value,labels[i])<br/>    i +=1<br/>    <br/>    print(value)<br/>    with open("name_you_want.csv", 'a') as f:<br/>        writer = csv.writer(f)<br/>        writer.writerow(value)</span></pre><ol class=""><li id="647c" class="md me jg ko b kp kq kt ku kx oc lb od lf oe lj mk ml mm mn bi translated">我使用了K和U字母作为键来识别文件名中的类(Keanu中有K，Uday中有U)。根据你的需要改变它。</li><li id="c2cb" class="md me jg ko b kp mo kt mp kx mq lb mr lf ms lj mk ml mm mn bi translated">要保持彩色图像而不是灰度图像，请将“L”替换为“RGB”此外，在保存图像之前添加深度值。深度= 3表示颜色通道的数量(红色、绿色、蓝色)。</li></ol><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="a1b7" class="ll lm jg nt b gy nx ny l nz oa">img_grey = img_file.convert('L')# replace L with RGB<br/>value = np.asarray(img_grey.getdata(), dtype=np.int).reshape((width, height, <strong class="nt jq">3</strong>))</span></pre><p id="8284" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">3.<em class="lk"> name_you_want </em>将是创建的CSV文件的名称。随便改吧。</p><p id="3fc3" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您已经准备好了数据集。嗯，差不多准备好了。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/645c46359082d8cccee01a89a12256fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LYEn8zzI0IRKUPqRWMVSQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">表格的最后一列是标签|图片，作者是<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="2868" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko jq">对CSV文件做了一些调整</strong></p><ol class=""><li id="e089" class="md me jg ko b kp kq kt ku kx oc lb od lf oe lj mk ml mm mn bi translated">滚动到末尾，单击一个空单元格，并使用以下Excel公式连接像素值。</li></ol><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="3586" class="ll lm jg nt b gy nx ny l nz oa">=TEXTJOIN(" ", TRUE, (A1:B1))<br/>#replace B1 with last but one column name</span></pre><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/46fd7372d8012e3fcf7e2c9101267636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPIUm3AWgs5QcYiIHX4NMg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="f2c4" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">2.将公式拖到剩余的行中。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/bfb0bd573eba5d1dbd5fc4904a3412f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7IsT4UlY40ZZvmDKEG_oug.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="fea4" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">3.将列值复制到记事本。重新复制并粘贴回来。这样，您将保留像素值，而不是公式。</p><p id="a766" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">4.现在选择除标签和连接值之外的所有单元格，并删除它们。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/e22c4f0e3fceca0a99dfaac5dd9cb132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSvFLd4PG0Kcbgesu2DtDQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="6899" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">5.剪切剩余的列，并将其粘贴到工作表的开头。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/bcdb08dbe64eb68cc1e79a1b61ecdae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7V4Pg5JT-wgjTHd7P5-yww.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="0a2d" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">6.相应地命名列。</p><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/7450aba3f873065704702e6af37095e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dBiPhzF4nCk7BFr_LVqeRQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a></figcaption></figure><p id="8171" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">Aaaaannddddd，我们完了！</p><blockquote class="oh oi oj"><p id="de78" class="km kn lk ko b kp kq kr ks kt ku kv kw ok ky kz la ol lc ld le om lg lh li lj ij bi translated">恭喜你！您已经从头开始创建了一个全新的自定义图像数据集。</p></blockquote><h1 id="2b0a" class="on lm jg bd ln oo op oq lq or os ot lt ou ov ow lw ox oy oz lz pa pb pc mc pd bi translated">奖金</h1><h2 id="8fb9" class="ll lm jg bd ln lo lp dn lq lr ls dp lt kx lu lv lw lb lx ly lz lf ma mb mc jm bi translated">装载CSV</h2><p id="a55e" class="pw-post-body-paragraph km kn jg ko b kp mf kr ks kt mg kv kw kx mt kz la lb mu ld le lf mv lh li lj ij bi translated">加载CSV并运行以下代码片段，您就万事大吉了。</p><pre class="mx my mz na gt ns nt nu nv aw nw bi"><span id="62a8" class="ll lm jg nt b gy nx ny l nz oa">import pandas as pd<br/>import cv2<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>from sklearn.model_selection import train_test_split<br/> <br/>dataset_path = '/content/Keanu&amp;Uday.csv'<br/>image_size=(48,48) #add 3 if RGB image<br/> <br/>def load():<br/>    data = pd.read_csv(dataset_path)<br/>    pixels = data['Pixels'].tolist()<br/>    width, height= 48, 48 ,# add depth 3 if RGB image<br/>    faces = []<br/>    for pixel_sequence in pixels:<br/>        face = [int(pixel) for pixel in pixel_sequence.split(' ')]<br/>        face = np.asarray(face).reshape(width, height,) #add depth if RGB image<br/>        a = face<br/>        face = np.resize(face.astype('uint8'),image_size)<br/>        faces.append(face.astype('float32'))</span><span id="b018" class="ll lm jg nt b gy ob ny l nz oa">    faces = np.asarray(faces)<br/>    A = faces<br/>    faces = np.expand_dims(faces, -1)<br/>    return faces, A<br/> <br/>faces,A = load()<br/>plt.imshow(A[0].astype("uint8"))</span></pre><figure class="mx my mz na gt is gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/dded0cf0997a9c324c6168f5d1af5f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*wfhHJTRmZQiEJQ3-OtCj5A.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">以上代码片段|图片由<a class="ae jd" href="https://medium.com/@udayyhit47" rel="noopener">作者</a>输出</figcaption></figure><p id="e3ba" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">感谢阅读！我希望这篇文章对你有用。这是Colab笔记本的链接。</p><p id="616e" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">资源:<a class="ae jd" href="https://github.com/Uday47/How-to-create-a-new-custom-dataset-from-images-Medium-Article" rel="noopener ugc nofollow" target="_blank"> GitHub知识库</a>和<a class="ae jd" href="https://colab.research.google.com/github/Uday47/How-to-create-a-new-custom-dataset-from-images-Medium-Article/blob/master/Code_Medium.ipynb" rel="noopener ugc nofollow" target="_blank"> Google Colab </a></p><p id="4cb2" class="pw-post-body-paragraph km kn jg ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">谢谢你相信我，<a class="ae jd" href="https://medium.com/@sainishitha2000" rel="noopener">西塔</a>。</p></div></div>    
</body>
</html>