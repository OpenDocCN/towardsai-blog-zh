<html>
<head>
<title>Introduction to the Markov Chain, Process, and Hidden Markov Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">马尔可夫链、过程和隐马尔可夫模型简介</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/introduction-to-the-markov-chain-process-and-hidden-markov-model-7b6abad37035?source=collection_archive---------0-----------------------#2020-09-24">https://pub.towardsai.net/introduction-to-the-markov-chain-process-and-hidden-markov-model-7b6abad37035?source=collection_archive---------0-----------------------#2020-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="bb16" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="c864" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">数量金融学中马尔可夫链和隐马尔可夫模型的概念及应用</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/cc6ecae489faa8c841d0313d12eb0c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*symCM3nJPhlyW3DKHZXTaQ.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@seantookthese?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">肖恩·奥·</a>在<a class="ae le" href="https://unsplash.com/s/photos/sea?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="ca1f" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">介绍</h1><p id="f742" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在机器学习领域最近的进展中，我们开始越来越多地讨论强化学习。强化学习不同于我们应该非常熟悉的监督学习，在监督学习中，它们不需要提供示例或标签。强化学习的重点是在探索(新环境)和利用(利用现有知识)之间找到正确的平衡。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mt"><img src="../Images/9910b66157f60cc48cd3a69df1b86e28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5M1sbFoDjl-650Jcdi1HA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">强化学习的概念图</figcaption></figure><p id="7e17" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">强化学习的环境一般以马尔可夫决策过程(MDP)的形式描述。因此，对我们来说，理解各种马尔可夫概念将是一个好主意；马尔可夫链、马尔可夫过程和隐马尔可夫模型(HMM)。</p><h1 id="2eef" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">马尔可夫过程和马尔可夫链</h1><p id="5e4e" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">这两个过程都是重要的随机过程。用更简单的术语来描述随机过程，想象我们有一袋多色球，我们继续从袋中取出球，而不放回袋中。这样，一个随机过程开始以随机变量的颜色存在，但它不满足马尔可夫性。因为每次球被移走，得到下一个特定颜色球的概率可能会有很大的不同。然而，如果我们允许球被放回袋子里，这就产生了一个随机变量带有颜色的随机过程。但是，这满足马尔可夫性质。</p><p id="ca91" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">记住这一点，马尔可夫链是一个随机过程。然而，马尔可夫链必须是<strong class="lz ja">无记忆的</strong>，即未来的行动不依赖于导致当前状态的步骤。这个性质叫做<strong class="lz ja"> <em class="mz">马尔可夫性质</em> </strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi na"><img src="../Images/f8bfc8809126f06b021c7bd3ef4e1207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gu0NL3NjHes1NEqVwuvCfQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">对于任意正整数n和随机变量的可能状态I</figcaption></figure><p id="61c9" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">确定当前状态的概率分布只需要知道以前的状态。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/23c3f354c8101dc9edd14248d1371e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*-8C2HjngKmofS0QavGCKzg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">两状态马尔可夫链图，每个数字，，代表马尔可夫链从一种状态变化到另一种状态的概率</figcaption></figure><p id="076a" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">马尔可夫链是一个<strong class="lz ja">离散时间</strong>过程，其未来行为仅取决于当前状态而非过去状态。而马尔可夫过程是马尔可夫链的<strong class="lz ja">连续时间</strong>版本。</p><h2 id="013d" class="nc lg iq bd lh nd ne dn ll nf ng dp lp mg nh ni lr mk nj nk lt mo nl nm lv iw bi translated">马尔可夫链</h2><p id="fb0a" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">马尔可夫链的特征在于一组状态<strong class="lz ja"> <em class="mz"> S </em> </strong>和每个状态之间的转移概率<strong class="lz ja"> <em class="mz"> P </em> </strong> ij。具有元素Pij的矩阵P被称为马尔可夫链的<em class="mz">转移概率矩阵</em>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/dc0f85345ea35f19f9a9026c01c68abf.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*ETiKdepSzEZ1cm-sHpguLQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上述两状态马尔可夫链的转移矩阵</figcaption></figure><p id="63cb" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">注意，P的行和等于1。在…的情况下；</p><ul class=""><li id="0247" class="no np iq lz b ma mu md mv mg nq mk nr mo ns ms nt nu nv nw bi translated">马尔可夫链的所有状态都相互通信(可能从一个状态经过多个步骤到达另一个状态)</li><li id="dbfd" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms nt nu nv nw bi translated">马尔可夫链不是周期性的(周期性的马尔可夫链就像你只能在偶数步中回到一个状态)</li><li id="576b" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms nt nu nv nw bi translated">马尔可夫链不会漂移到无穷大</li></ul><h2 id="2b4c" class="nc lg iq bd lh nd ne dn ll nf ng dp lp mg nh ni lr mk nj nk lt mo nl nm lv iw bi translated">马尔可夫过程</h2><p id="4cfa" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">主要区别在于转换行为的行为方式。在每种状态下，都有许多可能导致转换的事件。导致从状态I到J的转变的事件可以在指数量的时间后发生，<strong class="lz ja">Q</strong>ij。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/061133cbb68d454668efdaf642082f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*wxrg-I-sU3SpdjDW7tapsw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">在状态I中，在参数为的指数时间量之后发生转变</figcaption></figure><p id="2687" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">系统可以从状态I转换到状态j的概率为；</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/2a9aa1c03793a95d9a8dd9bb8ac77473.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*Nf8YhL9LugAMKOV97rGgmw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">从I到j概率方程的马尔可夫过程转移</figcaption></figure><p id="493d" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">含有<strong class="lz ja">Q</strong>T20】ij元素的矩阵Q称为马尔可夫过程的<em class="mz">生成器</em>。Q的行和为0。在条件下；</p><ul class=""><li id="db17" class="no np iq lz b ma mu md mv mg nq mk nr mo ns ms nt nu nv nw bi translated">马尔可夫过程的所有状态都相互通信</li><li id="f42b" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms nt nu nv nw bi translated">马尔可夫过程不会向无穷大漂移</li></ul><h1 id="91ef" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">应用</h1><p id="d23d" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">我们实际上在日常生活中处理马尔可夫链和马尔可夫过程用例，从购物，活动，演讲，欺诈，点击流预测。</p><p id="b1cc" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">让我们观察如何在Python中为银行业的贷款违约和付清实现这一点。我们可以观察和汇总投资组合的表现(在这种情况下，让我们假设我们有1年的数据)。我们可以计算概率路径，P(好贷款-&gt;坏贷款)= 3%，构造转移矩阵。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/5d27eebad69cd505c6163b650d311351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_vEqJPiR0Q3pemGawNszQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">贷款组合一年绩效的四态转移矩阵</figcaption></figure><p id="d99f" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">一旦我们有了这个转变，我们就可以用它来预测贷款组合在第一年末会变成什么样。假设我们有两个投资组合，一个是90%的优质贷款，10%的风险贷款，另一个是50:50。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/3020ac301d54cdaca8d5aa05e99aa403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fY_hNwdVu_MCJ2uLOvD2Eg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">将转移矩阵乘以投资组合构成的计算示例</figcaption></figure><p id="2818" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">在第一年末，A港将有13.7%的已付贷款和7.1%的不良贷款，而有11.2%成为高风险贷款。端口B将分别成为40%、32%、8.5%和19.5%的良好贷款、风险贷款、已付贷款和不良贷款。</p><p id="76f7" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated"><strong class="lz ja">马尔可夫模型的假设和局限性</strong></p><p id="6c4f" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">马尔可夫链在建模随机过程(例如，排序和CRM事件)时可以是强大的工具。然而，这种技术需要满足一些假设。</p><p id="24eb" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated"><strong class="lz ja"> <em class="mz">假设1 </em> </strong>:概率适用于系统中的所有参与者</p><p id="034e" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated"><strong class="lz ja"> <em class="mz">假设2 </em> </strong>:转移概率随时间恒定</p><p id="cd35" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated"><strong class="lz ja"> <em class="mz">假设3 </em> </strong>:状态随时间独立</p><h1 id="9c11" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">隐马尔可夫模型(HMM)</h1><p id="489b" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">隐马尔可夫模型(hmm)是概率模型，它意味着数据背后的马尔可夫模型是隐藏的或未知的。更具体地说，我们只知道观察数据，而不知道关于状态的信息。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/9a1c746460b86518672d4725d9acd2e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCUE1vCMK9KteBxpbPY65Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">从马尔可夫链(左)到隐马尔可夫模型(右)；其中S =状态，y =可能的观察值，P =状态转移概率，b =观察概率</figcaption></figure><p id="f89b" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">HMM由三个模型参数决定；</p><ul class=""><li id="4f07" class="no np iq lz b ma mu md mv mg nq mk nr mo ns ms nt nu nv nw bi translated"><em class="mz">开始概率</em>；包含状态成为序列的第<strong class="lz ja">个</strong>状态的概率的向量。</li><li id="f4a1" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms nt nu nv nw bi translated"><em class="mz">状态转移概率</em>；由从状态<em class="mz"> Si </em>转移到状态<em class="mz"> Sj </em>的概率组成的矩阵。</li><li id="eefc" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms nt nu nv nw bi translated"><em class="mz">观察概率</em>；如果模型处于状态<em class="mz"> Si </em>时，某个观察值<em class="mz"> y </em>的可能性。</li></ul><p id="a191" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">HMMs可以用来解决四个基本问题；</p><ol class=""><li id="7fbb" class="no np iq lz b ma mu md mv mg nq mk nr mo ns ms oh nu nv nw bi translated">给定模型参数和观测序列，估计最可能的(隐藏)状态序列，这称为<strong class="lz ja"> <em class="mz">解码问题</em> </strong>。</li><li id="0c1e" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms oh nu nv nw bi translated">给定模型参数和观测序列，求给定模型下观测序列的概率。这个过程涉及属性的最大似然估计，有时称为<strong class="lz ja"> <em class="mz">评估问题</em> </strong>。</li><li id="c129" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms oh nu nv nw bi translated">给定观测序列，估计模型参数，这叫做<strong class="lz ja"> <em class="mz">训练问题</em> </strong>。</li><li id="1951" class="no np iq lz b ma nx md ny mg nz mk oa mo ob ms oh nu nv nw bi translated">估计观测序列，<em class="mz"> y1，y2 </em>，…，以及模型参数，使y的概率最大化，这叫做一个<strong class="lz ja"> <em class="mz">学习或优化问题</em> </strong>。</li></ol><h2 id="4d53" class="nc lg iq bd lh nd ne dn ll nf ng dp lp mg nh ni lr mk nj nk lt mo nl nm lv iw bi translated">HMM在量化金融中的用例</h2><p id="6c97" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">考虑到我们在尝试将预测技术应用于资产回报时面临的最大问题是一个<strong class="lz ja"> <em class="mz">非平稳时间序列</em> </strong>。换句话说，资产回报的预期均值和波动性随着时间而变化。大多数时间序列模型和技术都假设数据是平稳的，这是这些模型的主要缺点。</p><p id="dac6" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">现在，让我们用不同的方式来描述这个问题，我们知道时间序列展示了一个临时的时期，在这个时期，期望的均值和方差是稳定的。<strong class="lz ja">这些时期或制度可以与HMM </strong>的隐藏状态相关联。基于这个假设，我们所需要的是<strong class="lz ja"> <em class="mz">可观察变量</em> </strong>，其行为允许我们<strong class="lz ja"> <em class="mz">推断</em> </strong>到真正的隐藏状态。</p><p id="a026" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">在金融界，如果我们能够更好地估计一项资产最可能的状态，包括相关的均值和方差，那么我们的预测模型将变得更具适应性，并可能得到改善。此外，我们可以使用估计的状态参数进行更好的情景分析。</p><p id="2dfb" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">在这个例子中，我将使用可观察变量，Ted利差，10年-2年恒定到期利差，10年-3个月恒定到期利差，以及ICE BofA美国高收益指数总回报指数，来找到隐藏的状态</p><p id="e58b" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">在这个例子中，我使用的可观察变量是基础资产回报、ICE美国银行高收益指数总回报指数、Ted利差、10年-2年恒定到期利差和10年-3个月恒定到期利差。</p><p id="be06" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">现在，我们试图用两种方法来模拟通用电气股票的隐藏状态；<code class="fe oi oj ok ol b">sklearn's GaussianMixture</code>和<code class="fe oi oj ok ol b">HMMLearn's GaussianHMM</code>。这两个模型都要求我们指定适合时间序列的组件数量，我们可以将这些组件视为政权。对于这个具体的例子，我将分配三个组成部分，并假设是高，神经，低挥发性。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="om on l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">获取数据的脚本</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/34ece9c3e65a671f2561f031432660c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*aVNXURGH0rAibbCw0nRH_g.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">通用电气股价的可视化</figcaption></figure><h2 id="4a4d" class="nc lg iq bd lh nd ne dn ll nf ng dp lp mg nh ni lr mk nj nk lt mo nl nm lv iw bi translated">高斯混合方法</h2><p id="c8c5" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">这种混合模型通过利用期望最大化算法来估计隐藏状态的均值和协方差，实现了密切相关的监督形式的密度估计。请参考此<a class="ae le" href="https://scikit-learn.org/stable/modules/generated/sklearn.mixture.GaussianMixture.html" rel="noopener ugc nofollow" target="_blank">链接</a>获取完整文档。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi op"><img src="../Images/a13baea61aadcdb161335048ac57fb7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_EDW0zILffmgcK-WOMrBA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">使用高斯混合模型的结果和可视化</figcaption></figure><p id="162a" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">红色突出显示表示通用电气股票回报的平均值和方差值。我们可以解释为，最后一个隐藏状态代表高波动性状态，基于最高方差，具有负收益。而第0个和第1个隐藏状态代表低的和中性的波动性。这种中性波动也显示了最大的预期收益。让我们来绘制这个颜色代码，并对照实际的GE股价进行绘图。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/130f07ff36edb8bd2e4fd57abe2eb8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-aspuk0vsNGr40BSU7_lA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">通用电气股价的隐藏状态(政权)( 2010年初至2019年底)</figcaption></figure><h2 id="102a" class="nc lg iq bd lh nd ne dn ll nf ng dp lp mg nh ni lr mk nj nk lt mo nl nm lv iw bi translated">HMMLearn's GaussianHMM</h2><p id="266a" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">HMMLearn实现了简单的算法和模型来学习隐马尔可夫模型。有多种模型，如高斯、高斯混合和多项式，在这个例子中，我将使用<code class="fe oi oj ok ol b">GaussianHMM</code>。更多详情，请参考本<a class="ae le" href="https://hmmlearn.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/2b4745bd2f0d10470f4fb234067dba72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BYF8Up1_djePr9wb4LuUtA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">使用GaussianHMM的结果和可视化</figcaption></figure><p id="7c48" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">GaussianHMM的结果与我们使用高斯混合模型得到的结果几乎相同。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/8b0c558956511c6afec2465339c0d9ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HCzVXjCdlWTSAYHEy_YgyA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">使用高斯-安海姆模型的隐藏状态(政权)</figcaption></figure></div><div class="ab cl ot ou hu ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="ij ik il im in"><h1 id="d26b" class="lf lg iq bd lh li pa lk ll lm pb lo lp kf pc kg lr ki pd kj lt kl pe km lv lw bi translated">尾注</h1><p id="17f2" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在这篇文章中，我们讨论了马尔可夫链、马尔可夫过程和隐马尔可夫模型的概念，以及它们的实现。我们使用sklearn的GaussianMixture和HMMLearn的GaussianHMM从其他观察变量来估计历史状态。</p><p id="ccf9" class="pw-post-body-paragraph lx ly iq lz b ma mu ka mc md mv kd mf mg mw mi mj mk mx mm mn mo my mq mr ms ij bi translated">完整的代码实现，你可以参考这里的<a class="ae le" href="https://nbviewer.jupyter.org/github/netsatsawat/markov_and_hidden_markov_model/blob/master/code/Markov_chain_introduction.ipynb" rel="noopener ugc nofollow" target="_blank"/>或者访问下面链接中的my GitHub。快乐学习！！！</p><h1 id="331a" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">参考和Github知识库</h1><p id="1d5c" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated"><a class="ae le" href="http://www.cs.jhu.edu/~langmea/resources/lecture_notes/hidden_markov_models.pdf" rel="noopener ugc nofollow" target="_blank">约翰霍普金斯资源</a></p><div class="pf pg gp gr ph pi"><a href="https://github.com/netsatsawat/markov_and_hidden_markov_model" rel="noopener  ugc nofollow" target="_blank"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd ja gy z fp pn fr fs po fu fw iz bi translated">netsatsawat/马尔可夫与隐马尔可夫模型</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">这两个过程都是重要的随机过程。用更简单的术语来描述随机过程，假设我们…</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">github.com</p></div></div><div class="pr l"><div class="ps l pt pu pv pr pw ky pi"/></div></div></a></div><div class="pf pg gp gr ph pi"><a href="https://towardsai.net/" rel="noopener  ugc nofollow" target="_blank"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd ja gy z fp pn fr fs po fu fw iz bi translated">走向人工智能——最好的技术、科学和工程</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">欢迎来到人工智能最好的技术，科学和工程。走向人工智能最新故事更新[rev_slider…</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">towardsai.net</p></div></div><div class="pr l"><div class="px l pt pu pv pr pw ky pi"/></div></div></a></div></div></div>    
</body>
</html>