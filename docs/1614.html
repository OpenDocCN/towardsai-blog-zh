<html>
<head>
<title>Data Wrangling With Python — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python处理数据——第2部分</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/data-wrangling-with-python-part-2-12165f68f372?source=collection_archive---------5-----------------------#2021-03-04">https://pub.towardsai.net/data-wrangling-with-python-part-2-12165f68f372?source=collection_archive---------5-----------------------#2021-03-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="683d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="1db4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">数据科学中有用的转换方法</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c21d80624820d9b06098779214854018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eHIAYWDsa6TUnVQz"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@ffstop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄于<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的</a></figcaption></figure><h2 id="103a" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">删除一行</h2><p id="05f8" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">我们可以从数据框中删除一行或多行。在布尔条件的帮助下，我们可以创建一个新的数据框，排除我们想要删除的行。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="71fe" class="li lj it mx b gy nb nc l nd ne"># Load library<br/>import pandas as pd</span><span id="ee4a" class="li lj it mx b gy nf nc l nd ne"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="b7d1" class="li lj it mx b gy nf nc l nd ne"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="cced" class="li lj it mx b gy nf nc l nd ne"># Show the first two rows only with female <br/>dataframe[dataframe[‘Sex’] != ‘male’].head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/81f093e35e8b18e85e6d328f092f5d0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/0*Eo410zUbpxYsx09f.png"/></div></figure><p id="998e" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">我们还可以使用类似df.drop([0，1]，axis =0)的drop方法来删除前两行。更实用的方法是简单地将布尔条件包装在df[]中。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="cc05" class="li lj it mx b gy nb nc l nd ne">dataframe[dataframe[‘Name’] != ‘Allison, Miss Helen<br/>                                            Loraine’].head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/dafa65e10661efa5614beaf53d2e067a.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/0*sFUKW2ldzVSq14-T.png"/></div></figure><p id="16ef" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">逐行索引删除单个行</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="d118" class="li lj it mx b gy nb nc l nd ne"># To see the first 2 rows after deleting a row<br/>dataframe[dataframe.index != 0].head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/38605ab5e675984a777341a89faf83db.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/0*NugEDIfjYlhOUI7V.png"/></div></figure><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/data-preprocessing-concepts-with-python-b93c63f14bb6"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd jd gy z fp nw fr fs nx fu fw jc bi translated">Python中的数据预处理概念</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">一种为机器学习估值器准备数据的稳健方法</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">pub.towardsai.net</p></div></div><div class="oa l"><div class="ob l oc od oe oa of lb nr"/></div></div></a></div><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/correlation-and-its-types-in-statistics-7a723dcfd12d"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd jd gy z fp nw fr fs nx fu fw jc bi translated">统计学中的相关性及其类型</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">统计学有助于理解机器学习中的行为</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">pub.towardsai.net</p></div></div><div class="oa l"><div class="og l oc od oe oa of lb nr"/></div></div></a></div><h2 id="0474" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">删除重复的行</h2><p id="99ef" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">要从数据框中删除重复行，请使用drop_duplicates()</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="28ea" class="li lj it mx b gy nb nc l nd ne"># Load library<br/>import pandas as pd</span><span id="5fd0" class="li lj it mx b gy nf nc l nd ne"># Load data<br/>dataframe = pd.read_csv(‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">titanic-csv</a>’)</span><span id="2979" class="li lj it mx b gy nf nc l nd ne"># Drop duplicates show first two rows of output<br/>dataframe.drop_duplicates().head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2a0aceb20ffa897079f8d8f75c09d571.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/0*OR-zGO34GDKDXN2K.png"/></div></figure><p id="7223" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">如果我们清楚地注意到，我们没有删除任何行()</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="8caf" class="li lj it mx b gy nb nc l nd ne"># Show number of rows<br/>print(“Length of an original data frame:”, len(dataframe))<br/>print(“Number Of Rows After Deduping:”, len(dataframe.drop_duplicates()))</span></pre><p id="a2ed" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">原因是drop_duplicates()默认只删除所有列中匹配的行。数据框中的每一行都是唯一的。有时我们想只考虑列的子集来检查重复的行。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="2132" class="li lj it mx b gy nb nc l nd ne"># Drop duplicates<br/>dataframe.drop_duplicates(subset=[‘Sex’])</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ae9add8ec017e849355bf9ef56ca698e.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/0*TYQysqrNUQZlrDTU.png"/></div></figure><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="c183" class="li lj it mx b gy nb nc l nd ne"># Drop duplicates<br/>dataframe.drop_duplicates(subset=[‘Sex’], keep=’last’)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/279a5629128c9b67a2da75ea925ed28c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/0*3he2EEG_ANAVnfrU.png"/></div></figure><p id="c0e5" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated"><em class="oj"> drop_duplicates() </em>默认情况下，保留重复行的第一个匹配项，删除列的其余部分。</p><p id="4537" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated"><em class="oj">duplicate()</em>方法，返回表示一行是否重复的布尔序列。</p><h2 id="18cb" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">按值对行进行分组</h2><p id="ba07" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated"><em class="oj">group by()</em>是熊猫馆的一大特色。我们可以根据一些共享的值对单独的行进行分组。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="c973" class="li lj it mx b gy nb nc l nd ne"># Load library<br/>import pandas as pd</span><span id="91f4" class="li lj it mx b gy nf nc l nd ne"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="abbb" class="li lj it mx b gy nf nc l nd ne"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="59c0" class="li lj it mx b gy nf nc l nd ne"># calculating mean of group basis on 'sex' feature<br/>dataframe.groupby(‘Sex’).mean()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/277ed944e5a864617eadde75e1d060ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/0*ZRrKtsrtWIRnIFpo.png"/></div></figure><p id="07cc" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated"><em class="oj"> groupby() </em>在一个数据帧中非常常见，当我们像下面这样写单行的时候，返回类型就有点混乱了。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="a3cf" class="li lj it mx b gy nb nc l nd ne"># Group rows<br/>dataframe.groupby(‘Sex’)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/2fe90e2918f01daedc59a5c1b485b0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/0*uGBe21uvQs8ZTqKC.png"/></div></figure><p id="f3f4" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">原因是<em class="oj"> groupby() </em>需要与一个操作配对，该操作中应该有一些应用于组的内容，如计算聚合、总和、中值等。</p><p id="9d3a" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">为了返回有用的东西，我们可以如下应用<em class="oj"> count() </em></p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="64cc" class="li lj it mx b gy nb nc l nd ne"># Group rows, count rows<br/>dataframe.groupby(‘Survived’)[‘Name’].count()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/baeddb6924581315b032ba9df46bf950.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/0*9QQK_XKQU_hih4SL.png"/></div></figure><p id="bde9" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">我们可以对第一列进行分组，然后通过第二列对该分组进行分组。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="bbd3" class="li lj it mx b gy nb nc l nd ne"># Group rows, calculate mean<br/>dataframe.groupby([‘Sex’,’Survived’])[‘Age’].mean()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi on"><img src="../Images/ff964cb9db9da5d08f03a5ee2d28a0bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/0*yR6AOl5xdwf_bUVe.png"/></div></figure><h2 id="bcbd" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">按时间对行进行分组</h2><p id="b3fb" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">在resample()的帮助下，我们可以按周期对单个行进行分组。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="d29b" class="li lj it mx b gy nb nc l nd ne"># Load libraries<br/>import pandas as pd<br/>import numpy as np</span><span id="48a5" class="li lj it mx b gy nf nc l nd ne"># Create date range<br/>time_index = pd.date_range(‘06/06/2017’, periods=100000, freq=’30S’)</span><span id="b3ea" class="li lj it mx b gy nf nc l nd ne"># Create DataFrame<br/>dataframe = pd.DataFrame(index=time_index)</span><span id="5347" class="li lj it mx b gy nf nc l nd ne"># Create column of random values<br/>dataframe[‘Sale_Amount’] = np.random.randint(1, 10, 100000)</span><span id="b38f" class="li lj it mx b gy nf nc l nd ne"># calculating mean on the basis of per week<br/>dataframe.resample(‘W’).sum()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/5f0097f673d5f609be3013f2af5b4714.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/0*CLMKObGHbk3rAQSp.png"/></div></figure><p id="6d4b" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">标准的titanic数据集没有日期-时间列，所以我们可以创建一个简单的数据框，其中每一行都是单独的销售。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="d58a" class="li lj it mx b gy nb nc l nd ne"># Show three rows<br/>dataframe.head(3)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/153b08ba748d8a92cbfe3fb5bb3ae6c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/0*sLBaN9Qv02F4pWEU.png"/></div></figure><p id="e92a" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">这里<em class="oj"> resample() </em>要求索引是每次销售的日期时间值。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="e3f6" class="li lj it mx b gy nb nc l nd ne"># Group by two weeks, calculate mean<br/>dataframe.resample(‘2W’).mean()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi op"><img src="../Images/45d028dbbeb697b0ad16982c71a2d2d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/0*vEvIqFDjZDVoGEdR.png"/></div></figure><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="3173" class="li lj it mx b gy nb nc l nd ne"># Group by month, count rows<br/>dataframe.resample(‘M’).count()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/01b3acf5291f39da92cab2c422c10f71.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/0*1d8bTN3OdUHxAcHW.png"/></div></figure><p id="7351" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">从这两个输出中，我们可以注意到日期时间索引是一个日期，尽管我们是按周和月分组的。原因是<em class="oj"> resample() </em>会返回时间组右边“边缘”的标签。我们可以通过标注参数来缓解这种情况。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="631a" class="li lj it mx b gy nb nc l nd ne"># Group by month, count rows<br/>dataframe.resample(‘M’, label=’left’).count()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/25a456cd78870e68f7f51cc28a0e7071.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/0*jj4oPOheq3HUhShW.png"/></div></figure><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/become-a-data-scientist-in-2021-with-these-following-steps-5bf70a0fe0a1"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd jd gy z fp nw fr fs nx fu fw jc bi translated">按照以下步骤，在2021年成为一名数据科学家</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">走上数据科学家之路需要具备的基本点</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">pub.towardsai.net</p></div></div><div class="oa l"><div class="or l oc od oe oa of lb nr"/></div></div></a></div><h2 id="ccdb" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">在列上循环</h2><p id="6be9" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">要迭代数据框中的每个元素，我们可以按顺序进行。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="88bd" class="li lj it mx b gy nb nc l nd ne"># Load library<br/>import pandas as pd</span><span id="b90a" class="li lj it mx b gy nf nc l nd ne"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="8f0f" class="li lj it mx b gy nf nc l nd ne"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="4d9b" class="li lj it mx b gy nf nc l nd ne"># Print first two names uppercased<br/>for name in dataframe[‘Name’][0:2]:<br/> print(name.upper())</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/b80f01feed4431d02038f7df30784f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/0*MUy9LSv3BwekDbCI.png"/></div></figure><p id="299b" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">我们也可以使用列表理解来实现相同的功能，如下所示</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="6c76" class="li lj it mx b gy nb nc l nd ne"># Show first two names uppercased<br/>[name.upper() for name in dataframe[‘Name’][0:2]]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/6a8e3434af8da37c4f2d6181ecdefd9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/0*l65LpdQPaHWc8Hjt.png"/></div></figure><h2 id="9e30" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">应用于所有列的元素的函数</h2><p id="5e7d" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">如果我们希望对数据框中的所有元素应用某种函数，那么我们可以使用内置函数或自定义函数。</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="60d1" class="li lj it mx b gy nb nc l nd ne"># Load library<br/>import pandas as pd</span><span id="baae" class="li lj it mx b gy nf nc l nd ne"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="54f7" class="li lj it mx b gy nf nc l nd ne"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="2a83" class="li lj it mx b gy nf nc l nd ne"># Create function<br/>def uppercase(x):<br/> return x.upper()</span><span id="a54c" class="li lj it mx b gy nf nc l nd ne"># Apply function, show two rows<br/>dataframe[‘Name’].apply(uppercase)[0:2]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/7a52928457b04c5130a26fd759f8967c.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*fB8Mrf6LXzMpzH2j.png"/></div></figure><p id="a45e" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">apply()是清理数据的好方法。我们可以编写一些有用的操作，如转换数据类型或重命名等。然后将该功能映射到数据集中的每个元素。</p><h2 id="49b3" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">将函数应用于组</h2><p id="0d67" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">我们可以使用groupby()和apply()方法对行进行分组，并将函数应用于数据集中的每个元素</p><pre class="ks kt ku kv gt mw mx my mz aw na bi"><span id="5f22" class="li lj it mx b gy nb nc l nd ne"># Load library<br/>import pandas as pd</span><span id="fa1a" class="li lj it mx b gy nf nc l nd ne"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="c8e2" class="li lj it mx b gy nf nc l nd ne"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="bb9e" class="li lj it mx b gy nf nc l nd ne"># Group rows, apply function to groups<br/>dataframe.groupby(‘Sex’).apply(lambda x: x.count())</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/64badb2d21fad54d6d8fba9bd3cf3e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/0*dv50FIWLqvcsgDZm.png"/></div></figure><p id="80ac" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">Apply()对组很有用，通过结合使用apply()和groupby()方法，我们可以计算自定义的统计数据。</p><p id="c77d" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae lh" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="5ee8" class="ow lj it bd lk ox oy oz ln pa pb pc lq ki pd kj lu kl pe km ly ko pf kp mc pg bi translated">推荐文章</h1><ol class=""><li id="4de3" class="ph pi it mf b mg mh mj mk lr pj lv pk lz pl mv pm pn po pp bi translated"><a class="ae lh" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener"> NLP —用Python从零到英雄</a></li></ol><p id="ed32" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">2.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a></p><p id="6b01" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">3.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/python-zero-to-hero-with-examples-c7a5dedb968b?source=friends_link&amp;sk=186aff630c2241aca16522241333e3e0" rel="noopener"> Python:零到英雄附实例</a></p><p id="788c" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">4.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-svm-classification-with-python-eda124997bcd?source=friends_link&amp;sk=da300d557992d67808746ee706269b2f" rel="noopener">用Python全面讲解SVM分类</a></p><p id="bd24" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">5.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-k-means-clustering-with-python-e7caa573176a?source=friends_link&amp;sk=9c5c613ceb10f2d203712634f3b6fb28" rel="noopener">用Python全面解释K-means聚类</a></p><p id="36b4" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">6.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python全面解释线性回归</a></p><p id="9503" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">7.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python全面解释逻辑回归</a></p><p id="e391" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">8.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/basic-of-time-series-with-python-a2f7cb451a76?source=friends_link&amp;sk=09d77be2d6b8779973e41ab54ebcf6c5" rel="noopener">Python时间序列基础</a></p><p id="85d4" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">9.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/numpy-zero-to-hero-with-python-d135f57d6082?source=friends_link&amp;sk=45c0921423cdcca2f5772f5a5c1568f1" rel="noopener"> NumPy:用Python零到英雄</a></p><p id="1702" class="pw-post-body-paragraph md me it mf b mg nh kd mi mj ni kg ml lr nj mn mo lv nk mq mr lz nl mt mu mv im bi translated">10.<a class="ae lh" href="https://medium.com/analytics-vidhya/confusion-matrix-in-machine-learning-91b6e2b3f9af?source=friends_link&amp;sk=11c6531da0bab7b504d518d02746d4cc" rel="noopener">机器学习中的混淆矩阵</a></p></div></div>    
</body>
</html>