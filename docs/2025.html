<html>
<head>
<title>Shapash 1.4.2: Grouping your variables for easier understanding of your models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Shapash 1.4.2:将变量分组，以便更容易理解模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/machine-learning-6011d5d9a444?source=collection_archive---------3-----------------------#2021-07-26">https://pub.towardsai.net/machine-learning-6011d5d9a444?source=collection_archive---------3-----------------------#2021-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6816" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><h1 id="af31" class="jw jx iq bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">Shapash的1.4.2版本现已推出，该库增加了一个变量分组特性，在丰富变量模型的可解释性方面向前迈进了一步！</h1><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/94e1c92810b9a778919a02763a9e5469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*dIOzJ5QJguIv5b4q.gif"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">Webapp Shapash</figcaption></figure><p id="a1b4" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">模型从可能包含数十或数百个变量的数据集中学习，这些变量具有共同的主题。将这些变量分组到模型可解释性中，可以更容易地理解模型，并有助于浏览变量以及它们如何影响模型。</p><p id="b972" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">有了Shapash的这个新版本，现在可以指定一个变量组字典，用于可解释性分析。</p><p id="0031" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">我们将使用公共Kaggle数据集来说明这些功能:<a class="ae me" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank"> <strong class="li ja">房价—高级回归技术| ka ggle</strong></a>(Shapash<a class="ae me" href="https://github.com/MAIF/shapash/tree/master/tutorial" rel="noopener ugc nofollow" target="_blank"><strong class="li ja">教程</strong> </a>中使用的示例数据集)。</p><p id="bec1" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">该数据集包括大约70个房屋的描述性变量，这些变量呈现了房屋的外观和设备、位置、房间表面等信息……例如，6个变量描述了车库的类型、饰面、质量、表面……为了分析模型的可解释性，我们可以将这6个变量归入同一个标题“车库”下，并对这组变量有一个全局的认识。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/78404e0a64f363d377071d51bd2774c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*IT2lFSlGtjVZ2gaz.gif"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">具有或不具有变量分组的重要性</figcaption></figure><ul class=""><li id="0984" class="mf mg iq li b lj lk ln lo lr mh lv mi lz mj md mk ml mm mn bi translated"><strong class="li ja">如何在Shapash中对变量进行分组？</strong></li></ul><p id="8ae9" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">要访问不同的变量分组特性，您必须在一个字典中声明要分组的变量和变量组的名称，并在编译Shapash时声明这个字典。</p><pre class="kv kw kx ky gt mo mp mq mr aw ms bi"><span id="aaab" class="mt jx iq mp b gy mu mv l mw mx"><strong class="mp ja">features_groups</strong> = {<br/>    "<strong class="mp ja">location</strong>": ["MSZoning", "Neighborhood", "Condition1", Condition2"],<br/>    "<strong class="mp ja">garage</strong>": ["GarageType","GarageYrBlt","GarageFinish","GarageArea","GarageQual","GarageCond"],    <br/>}from shapash.explainer.smart_explainer import SmartExplainer<br/>xpl = SmartExplainer(features_dict=house_dict)<br/>xpl.compile(<br/>    x=X_test,<br/>    model=regressor,<br/>    preprocessing=encoder,<br/>    <strong class="mp ja">features_groups=features_groups</strong><br/>)</span></pre><ul class=""><li id="81d8" class="mf mg iq li b lj lk ln lo lr mh lv mi lz mj md mk ml mm mn bi translated"><strong class="li ja">如何浏览Webapp来浏览群组？</strong></li></ul><p id="97f5" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">要启动Web应用程序，代码如下:</p><pre class="kv kw kx ky gt mo mp mq mr aw ms bi"><span id="4e54" class="mt jx iq mp b gy mu mv l mw mx">app = xpl.run_app(title_story='House Prices')</span></pre><p id="1129" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">在Web应用程序中，此按钮允许您激活或取消激活变量分组。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi ku"><img src="../Images/c3be5b4806766b9dea26fdf1d0418390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*kLhNJQmOajNk4BYk.gif"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">在Webapp中导航功能重要性和功能贡献</figcaption></figure><p id="5090" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">在这个特征重要性图中，橙色和粗体的变量代表变量组。要查看组中每个变量的详细信息，请单击橙色条。</p><p id="bc09" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">要恢复变量组，单击图形的白色背景。</p><p id="17cc" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">当在特征重要性图中选择一个组时，变量组的特征贡献图对应于使用t-sne维数缩减在x轴上的投影。在y轴上，我们找到了贡献的总和。通过将光标指向某一点，我们可以找到该组中贡献最大的变量的详细信息。</p><p id="6a20" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">如果我们在特征重要度图中点击组中的一个变量，贡献图显示与特征相关的贡献，而不是t-sne投影。</p><ul class=""><li id="23a6" class="mf mg iq li b lj lk ln lo lr mh lv mi lz mj md mk ml mm mn bi translated"><strong class="li ja">变量分组的局部渲染:</strong></li></ul><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/4cb9bef127ccff3c36625f8d35aa8e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*biqqZmpBfYVD02ET.gif"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">在Webapp的本地图中导航</figcaption></figure><p id="c104" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">变量分组也适用于当地捐款。它提供了贡献变量的综合视图。</p><p id="cd75" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">在图中所示的示例中，变量分组显示，与平均值相比，所有区域变量导致价格下降-13，000美元。位置变量(+3，000美元)和车库变量(+2，000美元)起积极作用。此外，随着变量的分组，隐藏贡献的条很低(隐藏的正贡献和隐藏的负贡献)，这表明贡献的全局被表示。</p><p id="b1b5" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">对于API或批处理模式中的局部贡献恢复，变量组被集成到Smartexplainer(方法to_pandas)和Smartpredictor(方法summarize)对象中。可以使用“use_groups=False”选项停用它们。</p><pre class="kv kw kx ky gt mo mp mq mr aw ms bi"><span id="7bee" class="mt jx iq mp b gy mu mv l mw mx">predictor = xpl.to_smartpredictor()<br/>predictor.add_input(sample_input)<br/>predictor.summarize()</span></pre><p id="4810" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">对于变量组，该值是组中所有变量值的字典。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/1112c41544b61957b1c624ebb61cb343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iWLdDhYeR3wlUB-l.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">捐款数据框架</figcaption></figure><p id="0fda" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">对于每一个人，Smartpredictor的summarize()方法提供了一个数据帧，其中包含按重要性排序的变量。在上面的例子中，主要起作用的变量是分组变量，这使得总结预测更容易。</p><p id="11c0" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">通过这些新功能，我们希望Shapash可以进一步促进对机器学习模型的理解。</p><p id="9129" class="pw-post-body-paragraph lg lh iq li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">更多详情，我们邀请您在<a class="ae me" href="https://github.com/MAIF/shapash" rel="noopener ugc nofollow" target="_blank"> <strong class="li ja"> Shapash </strong> </a> GitHub上发现<a class="ae me" href="https://github.com/MAIF/shapash/blob/master/tutorial/common/tuto-common01-groups_of_features.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="li ja">教程</strong> </a>。</p><h1 id="017d" class="jw jx iq bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">💡分享你的想法！</h1><p id="b240" class="pw-post-body-paragraph lg lh iq li b lj nd ll lm ln ne lp lq lr nf lt lu lv ng lx ly lz nh mb mc md ij bi translated">请随意访问GitHub的<a class="ae me" href="https://github.com/MAIF/shapash" rel="noopener ugc nofollow" target="_blank"> <strong class="li ja"> Shapash </strong> </a>:你会找到关于这个新特性的详尽文档。您也可以在那里留下您的消息(讨论选项卡)，并通过共享您的模板或任何其他想法来为解决方案做出贡献。愿<a class="ae me" href="https://github.com/MAIF/shapash" rel="noopener ugc nofollow" target="_blank"> <strong class="li ja">沙帕什</strong> </a>为开发值得信赖的AI做出贡献！</p></div></div>    
</body>
</html>