<html>
<head>
<title>Anomaly Detection Use Case: Credit Card Fraud Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">异常检测用例:信用卡欺诈检测</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/anomaly-detection-use-case-credit-card-fraud-detection-e15091c8e51d?source=collection_archive---------0-----------------------#2020-07-13">https://pub.towardsai.net/anomaly-detection-use-case-credit-card-fraud-detection-e15091c8e51d?source=collection_archive---------0-----------------------#2020-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="555f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/35503f073cff6111b37cc6117ec02d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yJwDXNlNWNoz6RNo"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">由<a class="ae ko" href="https://unsplash.com/@servuspaul?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">保罗·费尔伯鲍尔</a>在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><blockquote class="kp kq kr"><p id="5a2c" class="ks kt ku kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">欺诈者最大的责任是确信欺诈太聪明而不被发现。路易·j·弗里</p></blockquote><p id="be24" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">事实是，欺诈交易很少发生；他们代表了一个组织内活动的一小部分。挑战在于，如果没有合适的系统和工具，很小一部分活动就可能很快变成巨大的财务损失。罪犯很狡猾，经常改变他们的策略。这篇文章重点介绍了欺诈分析如何构建能够学习、适应和发现新模式的系统来防止欺诈。</p><h1 id="6385" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">什么是异常检测</h1><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ms"><img src="../Images/4ff453a4ff6e97de766088642f93374d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_E8HeiWWc7u354ToxopOZA.jpeg"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">来自<a class="ae ko" href="https://www.pexels.com/photo/eggs-in-tray-on-white-surface-1556707/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae ko" href="https://www.pexels.com/@daniel-reche-718241?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">丹尼尔·雷切</a>的照片</figcaption></figure><p id="d8e6" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">异常检测识别偏离数据集正常行为的数据点、事件和/或观察值。相关应用的一些可行例子是飞机引擎中振动强度和发热的变化、识别黑客信号、检测欺诈性信用卡交易等</p><h1 id="ef8c" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">什么是异常？</h1><p id="164c" class="pw-post-body-paragraph ks kt it kv b kw mx ky kz la my lc ld lr mz lg lh ls na lk ll lt nb lo lp lq im bi translated">在数据挖掘中，异常检测是对引起疑问的罕见事件或观察的识别。异常可以大致分为以下几类:</p><ol class=""><li id="b9e2" class="nc nd it kv b kw kx la lb lr ne ls nf lt ng lq nh ni nj nk bi translated"><strong class="kv jd"> <em class="ku">点异常:</em> </strong>数据的单个实例如果离其余的太远就是异常的。一个典型的例子是根据支出类型检测信用卡欺诈。</li></ol><p id="c761" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">②<em class="ku">。上下文异常:</em> </strong>异常是上下文特有的，在时序数据中是习惯性的。一个可行的例子是，在节日期间，每天花150美元买食物是合理的，但在其他情况下可能是奇怪的。</p><p id="3d2e" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku"> 3。集体异常:</em> </strong>一组数据实例集体帮助检测异常。例如，从数据库中意外复制文件可能会被标记为潜在的网络攻击。</p><p id="9ecd" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">异常检测与<a class="ae ko" href="https://en.wikipedia.org/wiki/Noise_reduction" rel="noopener ugc nofollow" target="_blank">噪声去除</a>和<a class="ae ko" href="https://en.wikipedia.org/wiki/Novelty_detection" rel="noopener ugc nofollow" target="_blank">新奇检测</a>类似，但并不相同。</p><h1 id="4942" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">异常检测技术</h1><h2 id="dbf0" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">1.统计方法</h2><p id="f4c6" class="pw-post-body-paragraph ks kt it kv b kw mx ky kz la my lc ld lr mz lg lh ls na lk ll lt nb lo lp lq im bi translated">识别数据中不规则性的最简单方法是标记偏离分布的常见统计属性的数据点，包括平均值、中值、众数和分位数。</p><h2 id="d47d" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">2.机器学习方法</h2><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/1ea9faba619dc15e085490696c814b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*cUsO0wHBuS2ynQ9-0kQZvQ.jpeg"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">来自<a class="ae ko" href="https://www.slideshare.net/nrubens/outliers-and-inconsistency" rel="noopener ugc nofollow" target="_blank"> Slideshare </a></figcaption></figure><p id="6ec6" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">因此，人工智能(AI)的应用为系统提供了根据经验自动学习和改进以检测这些异常的能力。在欺诈检测中使用机器学习背后的动机是因为两个主要原因。</p><ol class=""><li id="262b" class="nc nd it kv b kw kx la lb lr ne ls nf lt ng lq nh ni nj nk bi translated">速度</li><li id="4a21" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated">适应性</li></ol><p id="d39a" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">与人类相比，机器基本上更有能力快速检测模式。此外，随着欺诈者改变他们的战术和策略，机器可以更快地学习新的模式。</p><p id="d4d4" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">有许多机器学习技术可以使用，但是对于本文的上下文，我们将使用Catboost算法。</p><p id="3f41" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">什么是CATBOOST？</strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oc"><img src="../Images/dbbc2417dd42b8496976b01c97d95142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MW2GNgFSH63k6XC3SKT7zA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">来自<a class="ae ko" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank"> Catboost网站</a></figcaption></figure><p id="8f1e" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">CatBoost是决策树上<strong class="kv jd">梯度提升的算法。它由Yandex的研究人员和工程师开发，用于搜索、推荐系统、个人助理、自动驾驶汽车、天气预测和Yandex的许多其他任务。它在开源库中。</strong></p><p id="c463" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">为什么选择CATBOOST？</strong></p><p id="e4b6" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">该图书馆专注于:</p><ol class=""><li id="8a2d" class="nc nd it kv b kw kx la lb lr ne ls nf lt ng lq nh ni nj nk bi translated">无需参数调整，质量卓越。</li><li id="c080" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated">精确度提高。</li><li id="e004" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated">快速预测。</li><li id="6d31" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated">快速和可扩展的GPU版本。</li><li id="0bcd" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated">分类特征支持。</li></ol><p id="15ed" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> CATBOOST安装</strong></p><p id="0223" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">只有64位版本的Python支持安装。它主要有两个依赖<a class="ae ko" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>和<a class="ae ko" href="https://six.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">六个</a>。它可以由两个流行的Python包管理器安装— <a class="ae ko" href="https://docs.conda.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Conda </a>和<a class="ae ko" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI </a></p><p id="c903" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">康达安装:</p><pre class="mt mu mv mw gt od oe of og aw oh bi"><span id="cd23" class="nl lv it oe b gy oi oj l ok ol">conda install catboost</span></pre><p id="6e60" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">PyPI安装</p><pre class="mt mu mv mw gt od oe of og aw oh bi"><span id="fb9c" class="nl lv it oe b gy oi oj l ok ol">pip install catboost</span></pre><p id="a78d" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">喝杯咖啡，让我们用代码来检测信用卡欺诈</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ot"><img src="../Images/a59782a19ed7bc8bd76fd9d98e0ef687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c-gscY0MI1DZ9Hz9"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">Marc Mintel 在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1c9b" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><em class="ku">本文使用的代码、数据集和其他资源可以在</em><a class="ae ko" href="https://github.com/codebrain001/Credit-Card-Fraud-detection" rel="noopener ugc nofollow" target="_blank"><strong class="kv jd"><em class="ku">Github</em></strong></a><strong class="kv jd"><em class="ku">上找到。</em>T29】</strong></p><h2 id="9cb6" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">导入包和读取数据</h2><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ou"><img src="../Images/011ba7760bbf11f861128e02864c2c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OmZX48ZQ612H81-NnebYew.png"/></div></div></figure><p id="cb4c" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">这里，我们从导入这个项目需要的所有python库开始。</p><ul class=""><li id="8fc6" class="nc nd it kv b kw kx la lb lr ne ls nf lt ng lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">warning</code>:用于抑制python包中不推荐使用的函数的警告控件。</li><li id="09cc" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">pandas</code> &amp; <code class="fe ow ox oy oe b">numpy</code>:分别用于数据角力和科学计算。</li><li id="95d4" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">dask.array</code> &amp; <code class="fe ow ox oy oe b">dask.datafram</code>:针对numpy和熊猫的可扩展性</li><li id="c67b" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">matplotlib</code> &amp; <code class="fe ow ox oy oe b">seaborn</code>:用于图形和图表的可视化。</li><li id="5446" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">classification_report</code>、<code class="fe ow ox oy oe b">confusion_matrix</code>、&amp;、<code class="fe ow ox oy oe b">roc_auc_score</code>:用于评估预测的性能指标和报告。</li><li id="b333" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">SMOTETomek</code>:采样技术。</li><li id="5153" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq ov ni nj nk bi translated"><code class="fe ow ox oy oe b">train_test_split</code>:拆分数据。</li></ul><p id="7a6a" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">为了使用<code class="fe ow ox oy oe b">dask.array</code>和<code class="fe ow ox oy oe b">dask.dataframe</code>，必须安装。要一次安装所有的<strong class="kv jd"> dask </strong>软件包，使用下面的代码片段，使用<a class="ae ko" href="https://docs.conda.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Conda </a>或<a class="ae ko" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>软件包管理器。</p><pre class="mt mu mv mw gt od oe of og aw oh bi"><span id="9984" class="nl lv it oe b gy oi oj l ok ol"># Via Conda</span><span id="104b" class="nl lv it oe b gy oz oj l ok ol">conda install dask</span><span id="444b" class="nl lv it oe b gy oz oj l ok ol"># Via PyPI</span><span id="0d76" class="nl lv it oe b gy oz oj l ok ol">python -m pip install "dask[complete]"    # Install everything</span></pre><h2 id="0a57" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">探索和预处理数据</h2><p id="2ce5" class="pw-post-body-paragraph ks kt it kv b kw mx ky kz la my lc ld lr mz lg lh ls na lk ll lt nb lo lp lq im bi translated">这一部分非常重要，因为我们准备和争论数据以获得洞察力。</p><p id="8ad6" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">获得数据集的概述</strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pa"><img src="../Images/734be2f6fea0fb816388bcfae69a7662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83BQHbJA4OdYnuh55-JVDA.png"/></div></div></figure><p id="f773" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">可以观察到数据集有31个特征。数据集的描述可以在<a class="ae ko" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">这里</a>找到。还可以研究数据集的描述性统计的概述。</p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pb"><img src="../Images/20a9181dadf92177e33842e2db56b6b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHjjptcoB8tTH-NDmz6ynA.png"/></div></div></figure><p id="b036" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">处理<strong class="kv jd">缺失数据</strong>很重要，因为许多机器学习算法不支持带有<strong class="kv jd">缺失值的数据。</strong>来自分析的数据集没有任何缺失值。</p><p id="6793" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">特征分布有助于理解您正在处理的是哪种特征，以及您期望该特征具有什么值。您将看到这些值是集中还是分散。</p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pc"><img src="../Images/2304a4a0ade9b36d70b6312a5546860a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ix5yWmzvd65AXv8_ABiA0g.png"/></div></div></figure><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pd"><img src="../Images/9e5120a7b050523dd14dfadec5c18fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXXk599bfQ39MO-Rr3_pbQ.png"/></div></div></figure><p id="9bee" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">为了理解特征之间的变化，重要的是绘制相关矩阵，以了解相对于另一个变量具有高相关性和低相关性的变量。</p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pe"><img src="../Images/3b02d94ae6df4e6286c8b97647d84103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bjlcK2mROzo6kjNuFOixYA.png"/></div></div></figure><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pf"><img src="../Images/0dc22a9a9e5359c2f6e520ac10699985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7iv9bkeA-Xd6bEu3xKhs6g.png"/></div></div></figure><p id="2dfc" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">上述相关矩阵表明，V1到V28五氯苯甲醚成分之间没有任何相关性，但是，如果我们观察到类别与V成分之间存在某种形式的正相关和负相关，但与时间和数量没有相关性。</p><h2 id="8c7a" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">研究欺诈行为</h2><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pg"><img src="../Images/9234efc19ee8cffe82fbbc06b112cbad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wpMCwYeKl0TuYr7PcBWa8A.png"/></div></div></figure><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ph"><img src="../Images/3bf81e47c20de17ad08e82fad5fb5ec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSC38_CrzNJQekJoLhgH5w.png"/></div></div></figure><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pe"><img src="../Images/41288d89d024ba521473c6911e43c906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rg-jl1sBlkf2nXntgOK9CA.png"/></div></div></figure><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pi"><img src="../Images/c7d7769039de579851c37b8cae4b551f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4sfGfB115r_Fd7sOjNcnsw.png"/></div></div></figure><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pg"><img src="../Images/c3d489447fccadc081a764f025422877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TdxI8Glkh2bc5q3j49j4pQ.png"/></div></div></figure><p id="7fc8" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">此分析显示了这些欺诈活动引发的频率和金额范围。</p><p id="e963" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku"> N/B: </em> </strong> <em class="ku">类</em><code class="fe ow ox oy oe b"><em class="ku">0</em></code><em class="ku"/><code class="fe ow ox oy oe b"><em class="ku">1</em></code><em class="ku">分别表示不欺诈和欺诈。</em></p><h2 id="80ba" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">Dask可扩展性</h2><p id="b3a3" class="pw-post-body-paragraph ks kt it kv b kw mx ky kz la my lc ld lr mz lg lh ls na lk ll lt nb lo lp lq im bi translated">欺诈检测操作在各种金融系统中至关重要，为了建立更好的模型，需要更多的数据来训练机器学习模型。欺诈检测不是一次性的操作，因此可扩展性是随着时间的推移提供高效系统的关键。这就是<a class="ae ko" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv jd"> Dask </strong> </a>发挥巨大作用的地方。</p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pj"><img src="../Images/2ccd700814de4f6ca219fd0f2ba19c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGqAknYTdQIOBtk7-r8pDQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">来源:D <a class="ae ko" href="http://dask.org" rel="noopener ugc nofollow" target="_blank">请教</a></figcaption></figure><p id="3522" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><a class="ae ko" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>已经成为在<a class="ae ko" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>编程语言中用于数据争论和分析的最受欢迎和喜爱的数据科学工具之一。由于算法和本地内存限制，熊猫在大数据方面有自己的局限性。然而，<a class="ae ko" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> Dask </a>是一个开源的免费Python库。Dask提供了在<strong class="kv jd">性能和可伸缩性</strong>方面扩展Pandas、<a class="ae ko" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn </a>和<a class="ae ko" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>的方法。在本文的上下文中，数据集必定会不断增加，这使得Dask成为理想的工具。</p><p id="044c" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">因此，为了展示这些可伸缩性和性能特性，我们将在模型构建阶段并排比较pandas和dask的执行时间和性能。</p><p id="03de" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">平衡数据</strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pk"><img src="../Images/fd40128cd5b7dac6209b52fd630cee00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Y-ENQV5AAlCsnM8eJkhnw.png"/></div></div></figure><p id="3313" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">可以观察到<code class="fe ow ox oy oe b">Class</code>特征的数据集分布非常不平衡。在这种情况下，使用传统机器学习算法开发的预测模型可能会有偏差和不准确。处理这种情况的两种基本方法是通过:</p><ol class=""><li id="7ad3" class="nc nd it kv b kw kx la lb lr ne ls nf lt ng lq nh ni nj nk bi translated">欠采样</li><li id="ea7c" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated">过采样</li></ol><p id="be0f" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">在本出版物中，将使用<code class="fe ow ox oy oe b"><a class="ae ko" href="https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.combine.SMOTETomek.html" rel="noopener ugc nofollow" target="_blank">SMOTETomek</a></code>过采样技术。值得注意的是，为了避免数据泄漏，所使用的采样技术应该应用于数据的训练部分。</p><p id="9738" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为熊猫:</em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pl"><img src="../Images/2c43db69739efe67ac38406ffa09c553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hizoDrTd-TBvqDqaTFJZAA.png"/></div></div></figure><p id="a01b" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为Dask: </em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pm"><img src="../Images/9e4ecaff23b3f2cd27163edb833b5017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*21QQF6CFrDk233M4u1aQ7A.png"/></div></div></figure><p id="67ff" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">特征缩放</strong></p><p id="821b" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">这是数据预处理中的一个重要步骤，以便在特定范围内对数据进行规范化。有时，它有助于加速算法中的计算。</p><p id="e7d7" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">对于熊猫:</em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pn"><img src="../Images/bf576c9bf6aea18ddea2a4e54930ec9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gb7tjQ5Ja4q_YPVI34aQTw.png"/></div></div></figure><p id="34fc" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为Dask: </em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pm"><img src="../Images/7b05cab3f61158ab0cb67b9a4783d879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V391N8H10jGrhUr0IQg1Bw.png"/></div></div></figure><h2 id="f707" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated">模型拟合</h2><p id="e74c" class="pw-post-body-paragraph ks kt it kv b kw mx ky kz la my lc ld lr mz lg lh ls na lk ll lt nb lo lp lq im bi translated">这里的训练数据适合已经调优的Catboost模型。这一步是一个迭代过程，时间成本很高。这里，我们将使用<code class="fe ow ox oy oe b">datetime</code>来计时执行时间。</p><p id="84aa" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为熊猫:</em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi po"><img src="../Images/ece444ee13deb5c29c38bb39b9a55723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjjEYd6mIV0DwRnK2mcqwQ.png"/></div></div></figure></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pp"><img src="../Images/7205788da82ea8e113c677db1552016d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LC0l-6p2PcUz76pwH6cs1w.png"/></div></div></figure><p id="7a89" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为Dask: </em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pq"><img src="../Images/6626d6faa3acf402ea82748f1a49a367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tcp70bxeg0gPHnbYaiD-Bw.png"/></div></div></figure></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pr"><img src="../Images/26fac7e6e045304190026ed01e3cfe7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWDRiKu1UnIdgjsSewlMsg.png"/></div></div></figure><p id="52df" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">很明显<strong class="kv jd"> Dask </strong>的执行时间比<strong class="kv jd"> Pandas </strong>快约3分57秒，执行时间约为4分44秒。注意，用于执行的参数在比较过程中保持不变。</p><p id="978a" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd">预测和评估</strong></p><p id="3b24" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为熊猫</em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pq"><img src="../Images/e216b2e9d26177ac8602cafec7c3e961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkSdnbW5j2PgRhlYg90Rzg.png"/></div></div></figure><p id="2b9a" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated"><strong class="kv jd"> <em class="ku">为达斯克</em> </strong></p><figure class="mt mu mv mw gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ps"><img src="../Images/65228f46857dc48ddad0f263de1f3b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hH08A-InHI1tJUF2to34Zg.png"/></div></div></figure><p id="1ddc" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">可以观察到，两个数据帧的模型性能非常相似，因为它在精确度、召回率、f1分数和roc-auc_score上具有优异的分数。</p><p id="1f77" class="pw-post-body-paragraph ks kt it kv b kw kx ky kz la lb lc ld lr lf lg lh ls lj lk ll lt ln lo lp lq im bi translated">我希望这篇文章将强调如何欺诈分析和机器可以用来打击信用卡欺诈。感谢您的阅读。</p><h2 id="d8fa" class="nl lv it bd lw nm nn dn ma no np dp me lr nq nr mi ls ns nt mm lt nu nv mq iz bi translated"><strong class="ak">参考文献</strong></h2><ol class=""><li id="ea13" class="nc nd it kv b kw mx la my lr pt ls pu lt pv lq nh ni nj nk bi translated"><a class="ae ko" href="https://www.researchgate.net/publication/220565847_Anomaly_Detection_A_Survey" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/publicati/220565847 _ Anomaly _ Detection _ A _ Survey</a></li><li id="241a" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="https://www.researchgate.net/post/what_is_the_different_between_outlier_and_anomalies" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/post/what _ is _ the _ different _ between _ outlier _ and _ anomalies</a></li><li id="d0e2" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="https://en.wikipedia.org/wiki/Anomaly_detection" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Anomaly_detection</a></li><li id="0e76" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="https://machinelearningmastery.com/how-to-identify-outliers-in-your-data/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/how-to-identify-outliers-in-your-data/</a></li><li id="59d0" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="https://www.kdnuggets.com/2017/01/3-methods-deal-outliers.html" rel="noopener ugc nofollow" target="_blank">https://www . kdnugges . com/2017/01/3-methods-deal-outliers . html</a></li><li id="0e4e" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="https://medium.com/the-data-dynasty/anomaly-detection-in-google-analytics-a-new-kind-of-alerting-9c31c13e5237" rel="noopener">https://medium . com/the-data-dynasty/anomaly-detection-in-Google-analytics-a-new-kind-of-alerting-9c 31 c 13 e 5237</a></li><li id="fc0e" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="http://ceur-ws.org/Vol-2289/paper12.pdf" rel="noopener ugc nofollow" target="_blank">http://ceur-ws.org/Vol-2289/paper12.pdf</a></li><li id="d164" class="nc nd it kv b kw nx la ny lr nz ls oa lt ob lq nh ni nj nk bi translated"><a class="ae ko" href="http://ceur-ws.org/Vol-2289/paper12.pdf" rel="noopener ugc nofollow" target="_blank">http://ceur-ws.org/Vol-2289/paper12.pdf</a></li></ol></div></div>    
</body>
</html>