<html>
<head>
<title>Collaborative Filtering — A Type of Recommendation System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">协同过滤——一种推荐系统</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/collaborative-filtering-type-of-recommendation-system-87bef33e701e?source=collection_archive---------0-----------------------#2019-10-29">https://pub.towardsai.net/collaborative-filtering-type-of-recommendation-system-87bef33e701e?source=collection_archive---------0-----------------------#2019-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="91f2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">面向人工智能的推荐系统第三部分</h2><div class=""/><p id="4031" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这是我的推荐系统系列的第3部分</p><p id="e006" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">第一部分:<a class="ae ku" href="https://medium.com/towards-artificial-intelligence/recommendation-systems-104bdfe3f93f" rel="noopener">https://medium . com/forward-artificial-intelligence/recommendation-systems-104 bdfe 3 f 93 f</a></p><p id="a82b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">第二部分:<a class="ae ku" href="https://medium.com/towards-artificial-intelligence/content-based-recommender-system-4db1b3de03e7" rel="noopener">https://medium . com/forward-artificial-intelligence/content-based-recommender-system-4 db 1b 3 de 03 e 7</a></p><h1 id="70b6" class="kv kw iq bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">协作过滤:</h1><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/3b769953f94e5477c9ce7b5ce074e63f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*47JcAfVNfKtLsjAu.jpeg"/></div></div></figure><p id="6898" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">第二种最常用的过滤类型。这被亚马逊和易贝大量用于推荐产品。</p><p id="b61f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">基于用户的协同过滤:</p><p id="3e94" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">如果人们过去有相似的兴趣，他们将来也会有相似的兴趣。让我们考虑两个年轻人Vivek和Nikhil——他们有相似的兴趣。如果Vivek没有看过Nikhil喜欢的电影，我们会向Vivek推荐这部电影。为了理解这种算法的工作原理，我们将回答几个关键问题:</p><ol class=""><li id="ed2b" class="mf mg iq jy b jz ka kd ke kh mh kl mi kp mj kt mk ml mm mn bi translated">我们如何衡量用户之间的相似度？</li><li id="931b" class="mf mg iq jy b jz mo kd mp kh mq kl mr kp ms kt mk ml mm mn bi translated">我们如何预测这个人会有多喜欢这个产品？</li></ol><p id="a513" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们考虑下面的数据集:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mt"><img src="../Images/455adfd263626718a305412f6454f901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OpYY0oJCPShFrCeI84z2A.png"/></div></div></figure><p id="c671" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">任务:</p><ol class=""><li id="00fb" class="mf mg iq jy b jz ka kd ke kh mh kl mi kp mj kt mk ml mm mn bi translated">查找类似Nikhil的用户</li><li id="22d7" class="mf mg iq jy b jz mo kd mp kh mq kl mr kp ms kt mk ml mm mn bi translated">预测Nikhil可能提供的评级</li><li id="963b" class="mf mg iq jy b jz mo kd mp kh mq kl mr kp ms kt mk ml mm mn bi translated">向Nikhil推荐电影列表</li></ol><p id="f46d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">前两行之间的相关性给出了Vivek与Nikhil相似程度的度量。相关系数范围从-1到1。如果相关系数是1意味着Vivek和Nikhil有完全相似的品味，</p><p id="c526" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">-1表示完全相反的口味，0表示完全没有关系。</p><p id="b768" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">Corr(Nikhil，Vivek) = 0.91</p><p id="ae13" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">Corr(Nikhil，Abhirami) = 0.70</p><p id="925d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">Corr(Nikhil，Reetesh) = 0.00</p><p id="12e7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">Corr(Nikhil，Saif) = 0.50</p><p id="daa8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">如果有1000个用户，我们将有999个这样的相似性度量。</p><p id="f361" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在下一步是预测Nikhil会给所有的电影。</p><p id="0931" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">要做到这一点，我们需要找到离Nikhil最近的邻居，以及我们可以给他们多少权重。</p><p id="b80c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在本例中，让我们考虑两个邻居Vivek和Abhirami。根据他们对电影的评分加权平均值，我们可以计算出Vivek对所有电影的评分。</p><p id="38cd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">你看到Nikhil与两个用户Vivek和Abhirami相似，相似度分别为0.91和0.70。两个用户与b的相似度表示为sim(a，b)。为简单起见，我们只考虑这两个最近的邻居。</p><p id="fe61" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">目标是预测Nikhil对他没看过但Vivek和Abhirami看过的电影的评价。例如，假设整个数据集中有50部这样的电影。该系统将预测50部电影，并向Nikhil推荐前10部或前5部电影。</p><p id="27ec" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在这50部电影中，我们来考虑两部:《星际穿越》和《盗梦空间》。Vivek和Abhirami对这些电影的评分如下:</p><p id="b941" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">星际盗梦空间Vivek 5 3Abhirami 4 5</p><p id="7746" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">要预测Nikhil给星际的评级，一种方法是简单地取加权平均值，如下所示:</p><p id="8f03" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">pred(Nikhil，星际)</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/7d6799956384fa594ffae88efe90c73b.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/0*hWTgPUb6goifqU5j"/></div></figure><p id="9e33" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">同样，你可以预测Nikhil会给其余50部电影的评分。</p><p id="bc9b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">预测评级pred(Nikhil，Inception)会是什么？</p><ol class=""><li id="8db2" class="mf mg iq jy b jz ka kd ke kh mh kl mi kp mj kt mk ml mm mn bi">3.56</li><li id="d3b4" class="mf mg iq jy b jz mo kd mp kh mq kl mr kp ms kt mk ml mm mn bi">3.87</li><li id="42a0" class="mf mg iq jy b jz mo kd mp kh mq kl mr kp ms kt mk ml mm mn bi">4.20</li><li id="7d4f" class="mf mg iq jy b jz mo kd mp kh mq kl mr kp ms kt mk ml mm mn bi">4.33</li></ol><p id="11c3" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">答:3.87</p><p id="59c2" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我们使用了皮尔逊系数法来预测收视率。还有其他方法。</p><p id="d85e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">基于项目的协同过滤:</strong></p><p id="15d7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这是最成功、应用最广泛的推荐算法。它被像亚马逊和其他电影推荐网站这样的公司使用。</p><p id="9945" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们考虑同样的例子。假设我们需要找到Nikhil将给予《皇家赌场》的评级，我们假设它将类似于Nikhil过去给予类似类型的其他电影的评级。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mt"><img src="../Images/455adfd263626718a305412f6454f901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OpYY0oJCPShFrCeI84z2A.png"/></div></div></figure><p id="a54b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我们将为电影创建一个项目向量。在创建项目向量时，我们不会考虑Nikhil的评级。</p><p id="2751" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">“皇家赌场”的项目向量是(5，1，0，4)</p><p id="c37d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">《速度与激情》的项目向量是(5，2，0，4)</p><p id="3627" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">低俗小说的项目向量是(4，0，0，3)</p><p id="afca" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我们需要一种数学方法来衡量电影之间的相似性。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mv"><img src="../Images/53f5580791fbf99fda83f70bbac4dc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*icM4Ed7BXWesOyRAyGyO8w.png"/></div></div></figure><p id="59aa" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">类似地——皇家赌场和速度与激情之间的相似性度量达到0.98</p><p id="c5a6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">sim(皇家赌场，速度与激情)= 0.98</p><p id="f514" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">为了预测Nikhil将给予皇家赌场的评级，我们采用最接近的电影的加权平均值如下:</p><p id="a28b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">皇家赌场</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8402726583ce5e3fb57069a00ea7907b.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/0*qLQgoU5tatE_0QZ4"/></div></figure><p id="840c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">因为评级都是正的，所以相似性的值将介于0和1之间。接近1的值表示非常相似。这种相似性度量被称为余弦相似性度量，并且是一种公认的度量。</p><p id="6357" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">同样，该算法将计算Nikhil可能给所有其他他没有看过的电影的评级，并推荐前n名电影的列表，其中“n”的选择取决于算法设计者。</p><p id="6754" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">基于用户和项目的协同过滤的python实现如下。</p><p id="ded8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">https://github.com/BindhuVinodh/Recommendation-System<a class="ae ku" href="https://github.com/BindhuVinodh/Recommendation-System" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>