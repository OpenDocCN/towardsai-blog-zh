<html>
<head>
<title>Credit Card Fraud Prediction using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的信用卡欺诈预测</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/credit-card-fraud-prediction-using-machine-learning-f47e52a0dbc2?source=collection_archive---------1-----------------------#2020-10-01">https://pub.towardsai.net/credit-card-fraud-prediction-using-machine-learning-f47e52a0dbc2?source=collection_archive---------1-----------------------#2020-10-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/f9dca16bc8df809feee1691fc0ae55e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2khmBMis7dw9J93A"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://unsplash.com/@rupixen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">rupixen.com</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><h2 id="8a7c" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="d8c8" class="pw-subtitle-paragraph km jp jg bd b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dk translated">探索逻辑回归和朴素贝叶斯的使用</h2></div><p id="943a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi ma translated">随着新冠肺炎·疫情的出现，一种新的数字常态已经从对常规惯例和行为的破坏中出现。不可预见的情况促使个人和企业加快数字化转型，并采用创新方法来应对动荡和不确定的形势。作为消费者，我们的购物模式随着电子商务领域的繁荣而发展，从而使在线杂货店购物和食品配送的信用卡支付成为新的便利。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="e3fe" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">根据领先的分析软件公司FICO在2020年1月进行的一项最新调查<a class="ae jd" href="https://www.fico.com/blogs/real-time-payments-fraud?utm_source=social&amp;utm_medium=social_platforms&amp;utm_campaign=APAC_banks" rel="noopener ugc nofollow" target="_blank">,调查强调</a></p><blockquote class="mp mq mr"><p id="9c64" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">随着包括个人对个人(P2P)转账和移动支付平台在内的新的近即时支付平台在亚太地区的发展，实时支付欺诈已经激增。</p><p id="2524" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">我们最近对该地区的银行进行了一项调查，发现5家银行中有4家(78%)的欺诈损失有所增加。此外，近四分之一(22%)的受访者表示，欺诈行为将在未来12个月内显著增加，另有58%的受访者表示，他们预计欺诈行为将适度增加。</p></blockquote><p id="7573" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">根据全球领先的信用卡和移动支付行业出版物《尼尔森报告》(,</p><blockquote class="mp mq mr"><p id="580a" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">2018年，全球信用卡欺诈损失达到278.5亿美元，预计五年后将上升至356.7亿美元，10年后将达到406.3亿美元。</p></blockquote><h1 id="ed8b" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">信用卡欺诈检测面临的挑战</h1><p id="b35e" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">信用卡交易中的欺诈检测领域提出了几个挑战。随着每天处理大量的信用卡交易，机器学习算法和技术需要具有非常高的准确性，并且可扩展以处理海量数据。</p><p id="f3e7" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">另一个挑战是难以在记录的信用卡数据集中检测欺诈，因为数据在更高的水平上是倾斜的。这导致了不平衡的数据集，其中真实信用卡交易的数量远远多于欺诈交易。</p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><p id="8489" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这篇文章中，我想分享我对机器学习如何用于<strong class="lg jq">预测信用卡交易是否欺诈的见解。</strong></p><p id="e31b" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">机器学习是人工智能的一种应用，它为系统提供了自动学习和根据经验改进的能力，而无需显式编程。机器学习的3个主要类别是监督学习、非监督学习和强化学习。我们将关注分类问题的监督学习。</p><p id="0964" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq">监督学习</strong>从过去的数据中学习，并将学习应用于当前数据，以预测未来事件。在分类问题的上下文中，输入数据被标注或标记为正确的答案，以实现准确的预测。</p><p id="849c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们来处理一个信用卡交易欺诈预测问题，探索两种监督学习算法(逻辑回归和朴素贝叶斯)的基础，如何微调超参数以优化逻辑回归，并发现哪种监督学习算法更适合解决该问题。</p><h1 id="3085" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">监督学习算法</h1><p id="7c22" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><strong class="lg jq">逻辑回归</strong>用于预测目标变量的概率。目标变量或因变量的性质是二分法，只有两个可能的类别。逻辑回归试图找到最佳的决策边界，最好的分类。</p><p id="f972" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">逻辑回归<strong class="lg jq"> </strong>的一个优点是易于实现，并且提供了很高的训练效率。用这种算法训练模型不需要很高的计算能力。但是，逻辑回归需要一个大型数据集，其中包含足够的训练样本来识别所有需要识别的类别。</p><p id="9971" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq">朴素贝叶斯</strong>假设一个类中特定特征的存在与任何其他特征的存在无关。它是一种统计方法，基于<a class="ae jd" href="https://en.wikipedia.org/wiki/Bayes'_theorem" rel="noopener ugc nofollow" target="_blank">贝叶斯定理</a>的应用来计算某个特征属于某个类别的概率。</p><p id="39e5" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当“天真”假设成立时，分类器与其他模型相比具有优势，可以用较少的训练数据更好地执行。朴素贝叶斯的一个局限是独立预测的假设。在现实世界中，几乎不可能获得一组完全独立的预测器。</p><h1 id="8af0" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">问题陈述:预测信用卡交易是否欺诈。</h1><h1 id="bb13" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">资料组</h1><p id="af38" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><a class="ae jd" href="https://www.kaggle.com/mlg-ulb/creditcardfraud/home" rel="noopener ugc nofollow" target="_blank">数据集</a>由欧洲持卡人在2013年9月两天内进行的匿名信用卡交易组成。</p><p id="cee7" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">信用卡交易仅包含数字输入变量，这些变量是主成分分析转换的结果。由于保密问题，无法提供数据的原始特征和更多背景信息。虽然V1、V2…v 28等特征是通过五氯苯甲醚获得的主要成分，但唯一没有通过五氯苯甲醚转化的特征是“时间”、“数量”和“类别”。</p><ul class=""><li id="0845" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq">‘Time’</strong>包含数据集中每个事务与第一个事务之间经过的秒数。</li><li id="e4cc" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz of og oh oi bi translated"><strong class="lg jq">‘金额’</strong>为交易金额。</li><li id="d03f" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz of og oh oi bi translated"><strong class="lg jq">‘Class’</strong>是响应变量，在欺诈的情况下取值1，否则取值0。</li></ul><h1 id="554a" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">开始编码吧！</h1><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><h1 id="0d3b" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">数据准备</h1><p id="2c7b" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">加载数据集并显示前5行以检查数据。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi op"><img src="../Images/6ff5ed8d28e5d4cb46a20a2a02c5ceb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YcCbGiOba6n07lmd9HKUBQ.png"/></div></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/a71a11d8bee6687c216e9168e70d2661.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*BWnZvYUafPX5YTscU7qBhg.png"/></div></figure><h1 id="f000" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">探索性数据分析</h1><p id="7541" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">绘制一个条形图来可视化数据集中的类分布。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi or"><img src="../Images/e5793af7434af05bb28b42960ea85a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*GlRvdFE_oXoJgDNJ-a9Jeg.png"/></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi os"><img src="../Images/4231965b85b8ddc5edee01fd6a832c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*CS5GnD6iQU0Suwa1UOe2xQ.png"/></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/efce47ebfb248d81fa7571377db9ed31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*FS7CfyS81822eHIEQrqv2w.png"/></div></figure><p id="c73c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">数据集显然是不平衡的，如上所述，这对信用卡欺诈检测构成了挑战。</p><p id="507b" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">时间对数据集的影响呢？非欺诈交易的趋势与欺诈交易有何不同？</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ou"><img src="../Images/85934dfd37a2606f7693de733e1286f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmcC2Y-JPO02M7245wFhWg.png"/></div></div></figure><p id="94ce" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">从上面的直方图可以看出，非欺诈交易的趋势本质上是周期性的。而对于欺诈交易，尝试是随机的，有几个峰值。这就好像犯罪分子在碰运气，在尽可能短的时间内做尽可能多的交易而不被抓住。</p><h1 id="4a40" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">本福德定律的力量</h1><p id="294e" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><a class="ae jd" href="https://www.acfeinsights.com/acfe-insights/what-is-benfords-law" rel="noopener ugc nofollow" target="_blank">本福德定律</a>又称<strong class="lg jq"> <em class="ms">第一位数定律</em> </strong>或<strong class="lg jq"> <em class="ms">反常数定律。</em> </strong>它陈述了在任何一个大的、随机产生的自然数集合中，都会出现某种模式。大约30%的数字以数字1开头，18%以数字2开头，以此类推，最小的百分比以数字9开头。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ov"><img src="../Images/bb23859c51067f08786b335e6e2d1af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6ZXLvIgS7iMMkxSyccr7Q.png"/></div></div></figure><p id="e4e3" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">本福德定律广泛应用于分析财务记录中统计数据的有效性，也常用于查看大量发票和发现虚构的供应商。这种技术对于欺诈检测很有用，因为人为生成的数字通常不符合本福特定律。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ow"><img src="../Images/e00540e285f350fa6ab35d6c99bf8227.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oT9q4XN_r4TIYuzTQVPOfg.png"/></div></div></figure><p id="4201" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们应用本福德定律的概念，在数据集上运行一个测试。数据集的实际前导数字“1”和“9”高于预期的本福特定律预测。我们可以推断，犯罪人故意想做大交易，交易金额为1000美元或999美元，而不是200美元或800美元。如果这样做的次数足够多，那么根据本福特定律，数字出现的自然顺序就会被打乱。</p><h1 id="0dbb" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">实验设计</h1><p id="f886" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">观察不同的因素如何影响每个分类器的性能将是有趣的。考虑以下两个因素:</p><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ox"><img src="../Images/a53ebbd4190c808909696719f073d9a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CmhvduZ5F2OKsvxSq1OjbQ.png"/></div></div></figure><ul class=""><li id="8c16" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq">合成少数过采样技术(“SMOTE”):</strong>不平衡的数据集会导致训练后的模型有偏差。对于这个特定的数据集，我们看到99.83 %的分布代表多数类(即非欺诈交易)和剩余的0.17%代表少数阶级(即欺诈交易)。</li></ul><p id="48cf" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在训练模型时，我们将使模型达到属于多数类的高分类精度。为了解决类不平衡的问题，我们将执行SMOTE，它创建新的合成点以获得平衡的数据集。</p><ul class=""><li id="5512" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq">网格搜索:</strong>为了最大化逻辑回归的性能，我们可以对最佳超参数进行网格搜索，优化模型性能。</li></ul><h1 id="5b1a" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">数据建模</h1><p id="2914" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><a class="ae jd" href="https://scikit-learn.org/stable/modules/preprocessing.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lg jq">数据集的标准化</strong> </a> <strong class="lg jq"> </strong>是scikit-learn中实现的许多机器学习估值器的常见需求。如果单个要素或多或少看起来不像标准的正态分布数据，数据集可能表现不佳，即。均值和单位方差为零的高斯分布。</p><p id="8c7a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">唯一没有被PCA转化的特征是“时间”、“数量”。因此，我们将对这两列进行标准化。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/86e8a79c4559b6e1444ecfb885a8c81f.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*AFQYUKJCKwabqyWvGV51sw.png"/></div></figure><p id="8fad" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">执行数据集的初始加载和分割，以训练和测试基线逻辑回归模型。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><h1 id="a406" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">模型1:基线逻辑回归模型</h1><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/a9682c7572b4da4d7d59ea1a1d2371ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*8mFUjTIOvMQiPjp-ciDVyg.png"/></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pa"><img src="../Images/3624ba5d3094c2bbf00ca07cc0a43bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-fSUIIVPDmiQ3IWWPNHj4A.png"/></div></div></figure><p id="4d70" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">由于严重不平衡的数据集，基线逻辑回归模型能够几乎完美地对每个训练点和测试点进行分类。99.83 %的分布代表多数阶级(即非欺诈性交易)，几乎100%的时间都会做出正确的预测。</p><h1 id="e272" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">奋力营救</h1><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><p id="7fd0" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们为SMOTE的实施选择了以下参数:</p><ul class=""><li id="062a" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq"> sampling_strategy: </strong>采样信息对数据集进行重采样。</li></ul><blockquote class="mp mq mr"><p id="dd58" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">当<code class="fe pb pc pd pe b"><strong class="lg jq">str</strong></code>时，指定重采样的目标类别。不同类别中的样本数量将会相等。可能的选择有:</p><p id="4877" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><code class="fe pb pc pd pe b"><strong class="lg jq">'minority'</strong></code>:只对少数类重新采样；</p><p id="77fc" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><code class="fe pb pc pd pe b"><strong class="lg jq">'not minority'</strong></code>:对除少数类以外的所有类进行重新采样；</p><p id="7463" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><code class="fe pb pc pd pe b"><strong class="lg jq">'not majority'</strong></code>:对除多数类以外的所有类进行重新采样；</p><p id="53f2" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><code class="fe pb pc pd pe b"><strong class="lg jq">'all'</strong></code>:对所有类进行重采样；</p><p id="8762" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><code class="fe pb pc pd pe b"><strong class="lg jq">'auto'</strong></code>:相当于<code class="fe pb pc pd pe b"><strong class="lg jq">'not majority'</strong></code></p></blockquote><ul class=""><li id="ae43" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq"> random_state: </strong>控制算法的随机化。</li></ul><blockquote class="mp mq mr"><p id="27d5" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">如果int，<code class="fe pb pc pd pe b"><strong class="lg jq">random_state</strong></code>是随机数生成器使用的种子；</p><p id="285a" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">如果<code class="fe pb pc pd pe b"><strong class="lg jq">RandomState</strong></code>实例，random_state是随机数生成器；</p><p id="22da" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">如果<code class="fe pb pc pd pe b"><strong class="lg jq">None</strong></code>，随机数生成器就是<code class="fe pb pc pd pe b"><strong class="lg jq">np.random</strong></code>使用的<code class="fe pb pc pd pe b"><strong class="lg jq">RandomState</strong></code>实例</p></blockquote><ul class=""><li id="cfa7" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq"> k_neighbors: </strong> SMOTE选择少数类的最近邻居之间的距离，并在这些距离之间创建合成点。</li></ul><blockquote class="mp mq mr"><p id="6e26" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">如果<code class="fe pb pc pd pe b"><strong class="lg jq">int</strong></code>，用于构建合成样本的最近邻数量。If object，继承自<code class="fe pb pc pd pe b"><strong class="lg jq">sklearn.neighbors.base.KNeighborsMixin</strong></code>的一个估计器，将用于查找k_neighbors。</p></blockquote><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/65de1d0f73b0e2a3c57e1db8ed37f524.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*OYdXRjVAHmjREbXNpSOnuA.png"/></div></figure><h1 id="4602" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">热图相关矩阵</h1><p id="1362" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">相关性说明了特征之间或与目标变量之间的关系。相关性可以是正的(增加一个特征值会增加目标变量的值)，也可以是负的(增加一个特征值会减少目标变量的值)。一个<strong class="lg jq">热图</strong>使得<strong class="lg jq">识别哪些特征与目标变量</strong>最相关变得容易。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pg"><img src="../Images/35b7c16fd2d21771ed79ddb0339cff12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QulvTUlz_Ld1dpEnazURnA.png"/></div></div></figure><ul class=""><li id="a2af" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz of og oh oi bi translated"><strong class="lg jq">正相关:</strong><strong class="lg jq"/>特征值越高，<strong class="lg jq">欺诈交易的概率越大</strong>。</li><li id="29af" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz of og oh oi bi translated"><strong class="lg jq">负相关:</strong><strong class="lg jq">特征值越低</strong>，欺诈交易的概率<strong class="lg jq">越低</strong>。</li></ul><p id="1f96" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对于前4个最高正相关和负相关中的每一个，我们将创建箱线图来帮助我们可视化异常值的程度。</p><h1 id="5da2" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">箱线图</h1><p id="4ca6" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><strong class="lg jq">箱线图</strong>非常有用，因为它们显示了数据集中整数数据类型的异常值。一个<strong class="lg jq">异常值</strong>是一个在数值上远离其余数据的观察值。查看箱线图时，异常值被定义为位于箱线图触须外部的数据点。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pg"><img src="../Images/5f676fc8f8cd90d98c39c254f061887f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EKTaNXBc-UQKuMQWl-LRw.png"/></div></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ou"><img src="../Images/0d4fa2f5890b1e03437d34891b7131d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9APWag26_CtPwN7EYE2LLQ.png"/></div></div></figure><h1 id="313e" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">分布图</h1><p id="a57d" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><strong class="lg jq">分布图</strong>显示了数据分布的变化。通过使用Seaborn库，连续数据变量的总体分布由一个直方图表示，并结合一条线表示高斯分布(即正态)分布。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ph"><img src="../Images/f18200041ff921709926912620f4b3fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wa_sCWANqzcRZ9kE20Kkxg.png"/></div></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pi"><img src="../Images/10f517af2321239f7202589eed53d5c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6CLSeqsJi4RgdQPPjTthA.png"/></div></div></figure><h1 id="1b95" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">极端异常值的去除</h1><p id="2dab" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">为了获得良好的模型性能，需要从与我们的类高度相关的特征中识别并移除极端离群值。这个清理过程有助于确保观察结果最好地代表问题。</p><p id="3c60" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">其中一种技术是使用Jason Brownlee博士的<a class="ae jd" href="https://machinelearningmastery.com/how-to-use-statistics-to-identify-outliers-in-data/" rel="noopener ugc nofollow" target="_blank">机器学习大师博客文章</a>中分享的<strong class="lg jq">四分位间距方法</strong>:</p><blockquote class="mp mq mr"><p id="e8ac" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">概括非高斯分布数据样本的一个好的统计量是四分位距，或简称为IQR。IQR计算为数据的第75个和第25个百分位数之间的差值，并在盒须图中定义盒子。</p><p id="4f75" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated">通过定义低于第25个百分点或高于第75个百分点的IQR因子<em class="jg"> k </em>的样本值限制，IQR可用于识别异常值。系数k的<strong class="lg jq">公共值是值1.5 </strong>。</p></blockquote><p id="6481" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">去除异常值的阈值被确定为1.5，以防止信息丢失的风险，这将导致模型具有较低的准确性(即装配不足)。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pj"><img src="../Images/02ed0d3b27c6c0ec4316e2beebebe175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hoz-OGzxObpTxUdCSUnkDQ.png"/></div></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pk"><img src="../Images/86752478e640ec60821fe550f14a1e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8_uuNMOu13mShc_9KAPrA.png"/></div></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pl"><img src="../Images/66195394b8b2b54e572e4c0abd5b6817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gaUXe1KLY0eG8-70eNA_Pw.png"/></div></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pm"><img src="../Images/8a0360041b4a4bf09e2ba603d21b31b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ltovvHfcfFgcWKZfjCoFfQ.png"/></div></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><h1 id="e784" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">模型2:优化的逻辑回归模型</h1><p id="064a" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">逻辑回归模型通过<strong class="lg jq">网格搜索</strong>进行优化，网格搜索<strong class="lg jq">是对估计器</strong>的指定参数值进行穷尽搜索。它从网格中选择超参数的组合，使用训练数据的交叉验证对它们进行评估，并返回表现最佳的值。</p><p id="c17f" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们为网格搜索选择了以下<a class="ae jd" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" rel="noopener ugc nofollow" target="_blank">模型参数</a>:</p><blockquote class="mp mq mr"><p id="832f" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><strong class="lg jq">刑罚:</strong> <em class="jg"> </em>用来指定刑罚所用的定额。</p><p id="d1b7" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><strong class="lg jq">C:</strong>Cs中的每个值描述了正则化强度的倒数。如果Cs为整数，则在1e-4和1e4之间的对数标度中选择Cs值的网格。较小的值指定较强的正则化。</p></blockquote><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/8b6cd65a0879dcebb185692dada4f0a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*vuGb5viMq9ges4rbTnSoUQ.png"/></div></figure><p id="832e" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">基于网格搜索，最佳超参数值不是默认值。这显示了针对特定数据集优化模型的重要性。每个数据集都有不同的特征，在一个数据集上表现最好的模型不一定在所有数据集上都表现最好。</p><h1 id="5121" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">使用最佳模型优化逻辑回归</h1><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi po"><img src="../Images/9e66338f157e915421c168067fc207c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJ2ki2yKuDZJCsKW9fC_yA.png"/></div></div></figure><p id="5fda" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">虽然优化模型实现的性能略低于基线模型，但它代表了学习曲线的更真实拟合，而不是训练和测试数据的几乎完美的100%准确度。</p><h1 id="e634" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">模型3:朴素贝叶斯模型</h1><p id="9839" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">根据<a class="ae jd" href="https://scikit-learn.org/stable/modules/naive_bayes.html" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn </a>文档，</p><blockquote class="mp mq mr"><p id="dcea" class="le lf ms lg b lh li kq lj lk ll kt lm mt lo lp lq mu ls lt lu mv lw lx ly lz ij bi translated"><strong class="lg jq"> BernoulliNB </strong>为按照多元伯努利分布分布的<strong class="lg jq">数据实现朴素贝叶斯训练和分类算法；即，可能有多个特征，但每个特征都被假设为二进制值(伯努利、布尔)变量。因此，该类要求将样本表示为二进制值特征向量；如果传递任何其他类型的数据，BernoulliNB实例可能会将其输入二进制化(取决于二进制化参数)。</strong></p></blockquote><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/915effaa19bdbb7dbe2c7a25a71f0272.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*-y0jxIBYfWkFAUYDNsXj9w.png"/></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/b401a0de8c3676f47832a0f0c8805948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*Kes5Vnu_T9JDtRjJvQ8ydw.png"/></div></figure><p id="6566" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">与优化的逻辑回归模型相比，朴素贝叶斯模型似乎具有不太理想的学习曲线拟合，并且通过在测试数据上使用训练模型实现的准确率较低。</p><h1 id="0268" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">模型的性能评估</h1><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><h1 id="b14f" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">1.分类报告</h1><p id="00af" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><strong class="lg jq">分类报告</strong>显示了每个分类基础上的主要分类度量的表示，并给出了对分类器行为的更深层次的直觉，这可以掩盖多类问题中一类的功能弱点。这些指标是根据真阳性和假阳性以及真阴性和假阴性来定义的。</p><p id="376c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq">精度</strong>是分类器不将实际上为负的实例标记为正的能力。对于每个类别，它被定义为真阳性与真阳性和假阳性之和的比率。</p><p id="60ea" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ms">对于所有分类为阳性的实例，正确的百分比是多少？</em></p><p id="a826" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq">回忆</strong>是分类器找到所有肯定实例的能力。对于每个类别，它被定义为真阳性与真阳性和假阴性之和的比率。</p><p id="bb95" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="ms">对于所有实际呈阳性的实例，正确分类的百分比是多少？</em></p><p id="9cfe" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq"> F1分数</strong>是精确度和召回率的加权调和平均值，最好的分数是1.0，最差的是0.0。一般来说，F1分数低于准确度，因为它们将准确度和召回率嵌入到计算中。根据经验，F1分数的加权平均值应该用于比较分类器模型，而不是全局准确性。</p><p id="4287" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq"> Support </strong>是指定数据集中该类实际出现的次数。训练数据中的不平衡支持可能指示分类器的报告分数中的结构弱点，并且可能指示需要分层采样或重新平衡。支持在模型之间不改变，而是诊断评估过程。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/26a21cd7c928cb7d8963bb6997d1305b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q57P5vAdi1VYAdV-Y24MLg.png"/></div></figure><p id="7658" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">总的来说，优化的逻辑回归模型在上述指标中表现良好。特别是，在执行SMOTE以保持数据集平衡的情况下，在<strong class="lg jq"><strong class="lg jq">的少数民族阶层</strong>(即标签‘1’代表欺诈交易)，其中<strong class="lg jq">召回分数提高了64%，从0.55提高到0.90，</strong>通过使用优化的逻辑回归模型，与其基线模型相比。</strong></p><p id="0180" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">凭借<strong class="lg jq">更高的精确度和召回分数</strong>，优化的逻辑回归模型能够正确标记确实为阳性的实例。在这些实际上为阳性的实例中，优化的逻辑回归模型在很大程度上正确地对它们进行了分类。这直接转化为更高的F1分数<strong class="lg jq">作为精确度和召回率的加权调和平均值</strong>。</p><h1 id="561b" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">2.混淆矩阵</h1><p id="52ec" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><strong class="lg jq">混淆矩阵</strong>采用拟合的scikit-learn分类器和一组测试x和y值，并返回一份报告，显示每个测试值预测的类别与其实际类别相比如何。它们提供的信息与分类报告中提供的信息相似，但它们提供的不是顶级分数，而是对单个数据点分类的更深入了解。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ps"><img src="../Images/3746f70c786726e2f3845582abbd583a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3fSsru3SJEku8jYQrijLCQ.png"/></div></div></figure><p id="afb8" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">优化的逻辑回归模型表现良好，减少了<a class="ae jd" href="https://www.statisticssolutions.com/to-err-is-human-what-are-type-i-and-ii-errors/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg jq">类型2错误:假阴性</strong> </a>(预测非欺诈性交易，但实际上是欺诈性交易)。当将优化的逻辑回归模型的结果与其基线模型进行比较时，<strong class="lg jq">得分从0.45到0.1显著下降了78%。</strong></p><p id="152c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然而，<a class="ae jd" href="https://www.statisticssolutions.com/to-err-is-human-what-are-type-i-and-ii-errors/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg jq">类型1错误:假阳性</strong> </a>(预测欺诈但实际上非欺诈交易)的<strong class="lg jq">增加了2%，从0到0.02 </strong>，通过比较优化的逻辑回归与其基线模型。</p><p id="cb92" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">总的来说，假阳性多的影响随着假阴性的显著减少而减轻。这在信用卡欺诈预测场景中非常重要，在这种场景中，错误识别非欺诈交易的风险超过了遗漏真实欺诈交易的可能性。</p><p id="9074" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">与实际类别相比，预测类别的测试值具有良好的结果，优化逻辑回归模型的标准化混淆矩阵结果优于其他模型。</p><h1 id="a191" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">3.精确回忆曲线</h1><p id="7695" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated"><strong class="lg jq">精确召回曲线</strong>是用于评估分类器质量的度量。精度-召回曲线显示了精度(结果相关性的度量)和召回(返回多少相关结果的度量)之间的权衡。曲线下的大部分区域表示高召回率和高精度，这是分类器的最佳情况，显示了为其选择的大多数类返回准确结果的模型。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pt"><img src="../Images/d735e425578c4ebc5c3b9c6db68372d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UEbk8YZVzDJIUiOdduRXzQ.png"/></div></div></figure><p id="ceb1" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">优化后的logistic回归模型获得了较高的精确-召回曲线下面积。这表示高召回率和高精确度分数，其中高精确度与低假阳性率相关，高召回率与低假阴性率相关。两者的高分表明优化的逻辑回归模型已经返回了准确的结果(高精度)，以及所有阳性结果的大部分(高回忆)。</p><h1 id="a24d" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">4.ROC曲线和AUC</h1><p id="2c2e" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">接收器操作特征(“ROC”)/曲线下面积(“AUC”)图允许用户可视化分类器的灵敏度和特异性之间的权衡。</p><p id="b549" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq"> ROC </strong>是对分类器预测质量的一种度量，它比较并可视化了模型的灵敏度和特异性之间的权衡。绘制时，ROC曲线在Y轴上显示真阳性率，在X轴上显示假阳性率，包括全球平均值和每个类别。因此，理想点是图的左上角，这里假阳性为零，真阳性为一。</p><p id="fd3c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg jq"> AUC </strong>是假阳性和真阳性之间关系的计算。AUC越高，模型通常越好。然而，检查曲线的“陡度”也很重要，因为这描述了在最小化假阳性率的同时最大化真阳性率。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pu"><img src="../Images/df8830c51bced5ad2985ee8afbdc9da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Ctnm6SEJ7QS1Hc_BVOu6g.png"/></div></div></figure><p id="fa8d" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">所有模型都优于基线猜测，优化的逻辑回归模型获得了最好的AUC结果。因此，表明优化的logistic回归模型是一个较好的分类器。</p><h1 id="ef84" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">5.校准曲线</h1><p id="0376" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">当执行分类时，人们经常希望不仅预测类别标签，而且预测相关的概率。这个概率给出了预测的某种可信度。因此，校准图可用于确定预测概率是否可直接解释为置信水平。</p><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is"><div class="bz fp l di"><div class="oo mo l"/></div></figure><figure class="mj mk ml mm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pv"><img src="../Images/2292480f3634eb14070c799c2d5170fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8c96T1Jfsnqo1N160RRP7w.png"/></div></div></figure><p id="feab" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">与其他两个模型相比，优化的逻辑回归模型的校准图最接近完美校准。因此，优化的逻辑回归模型更可靠，能够更好地推广到新的数据。</p><h1 id="5d7f" class="mw mx jg bd my mz na nb nc nd ne nf ng kv nh kw ni ky nj kz nk lb nl lc nm nn bi translated">结论</h1><p id="44ef" class="pw-post-body-paragraph le lf jg lg b lh no kq lj lk np kt lm ln nq lp lq lr nr lt lu lv ns lx ly lz ij bi translated">与其他模型相比，<strong class="lg jq">优化的逻辑回归模型在测试集上具有更好的泛化性能</strong>,并且方差减小。虽然基线逻辑回归过度拟合，但与优化的逻辑回归模型相比，朴素贝叶斯模型无法在分类报告和标准化混淆矩阵中获得更高的分数。</p><p id="7878" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">逻辑回归优化的<strong class="lg jq">使用</strong>对结果有重大影响，考虑了以下两个因素:</p><ol class=""><li id="22e3" class="oa ob jg lg b lh li lk ll ln oc lr od lv oe lz pw og oh oi bi translated"><strong class="lg jq">击打</strong>创建新的合成点，以获得平衡的数据集</li><li id="0a99" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz pw og oh oi bi translated"><strong class="lg jq">网格搜索</strong>选择最佳超参数以最大化模型性能</li></ol><p id="5fc4" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">尽管如此，这些结果也归因于逻辑回归的独特优势，它旨在用于二元(两类)分类问题。它预测一个实例属于默认类的概率，可以导出为一个<strong class="lg jq">二进制输出变量</strong>(即。<strong class="lg jq"> </strong> 0或1分类)。通过优化逻辑回归模型，它产生了一个更适合分类问题的模型。</p><p id="5107" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了进一步增强模型性能，可以进行改进，在优化的逻辑回归模型中使用足够大且通用的数据集进行训练，而不仅仅是2天的交易量。</p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><h1 id="e55f" class="mw mx jg bd my mz px nb nc nd py nf ng kv pz kw ni ky qa kz nk lb qb lc nm nn bi translated">参考</h1><ol class=""><li id="3049" class="oa ob jg lg b lh no lk np ln qc lr qd lv qe lz pw og oh oi bi translated"><a class="ae jd" href="https://www.acfeinsights.com/acfe-insights/what-is-benfords-law" rel="noopener ugc nofollow" target="_blank">什么是本福特定律，为什么欺诈审查员会使用它</a></li><li id="8fa1" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz pw og oh oi bi translated"><a class="ae jd" href="https://imbalanced-learn.readthedocs.io/en/stable/generated/imblearn.over_sampling.SMOTE.html" rel="noopener ugc nofollow" target="_blank">im learn . over _ sampling的文档。重击</a></li><li id="0a11" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz pw og oh oi bi translated"><a class="ae jd" href="https://machinelearningmastery.com/how-to-use-statistics-to-identify-outliers-in-data/" rel="noopener ugc nofollow" target="_blank">如何使用统计学来识别数据中的异常值</a></li><li id="666b" class="oa ob jg lg b lh oj lk ok ln ol lr om lv on lz pw og oh oi bi translated"><a class="ae jd" href="https://scikit-learn.org/stable/modules/naive_bayes.html" rel="noopener ugc nofollow" target="_blank">sci kit-学习朴素贝叶斯的文档</a></li></ol></div></div>    
</body>
</html>