<html>
<head>
<title>Installing Pytorch with CUDA support on Windows 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Windows 10上安装支持CUDA的Pytorch</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/installing-pytorch-with-cuda-support-on-windows-10-a38b1134535e?source=collection_archive---------0-----------------------#2021-01-06">https://pub.towardsai.net/installing-pytorch-with-cuda-support-on-windows-10-a38b1134535e?source=collection_archive---------0-----------------------#2021-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f44b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="e3c3" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在Pycharm中配置一个Conda环境，以便能够使用CUDA</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0bacdbbc669e938011fc6149c2981116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-wQ1yuhF45-fdqvk1khXA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者制作的图像</figcaption></figure><p id="0138" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><a class="ae md" href="https://pytorch.org/get-started/locally/" rel="noopener ugc nofollow" target="_blank"> Pytorch </a>是一个Python包，用于开发深度学习模型，具有最大的灵活性和速度。Pytorch的特点是<a class="ae md" href="https://pytorch.org/docs/stable/tensors.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">张量</strong> </a>，本质上是n维数组，用于矩阵计算。所以，它类似于NumPy数组。使用Pytorch张量代替Numpy数组的优点是PyTorch张量可以在GPU上运行[1]。</p><p id="e661" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Pytorch安装本身并不难，但是在本地机器上启用GPU的步骤并不乏味。本文将指导您完成设置所需工具和安装在Windows机器上启用GPU所需的驱动程序的整个过程。</p><p id="65cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">编写高效Python代码的一个好的IDE是Pycharm。它是最好的编程工具之一，因为它提供了许多额外的功能，代码分析，一个有用的图形调试器来分析你的代码中的错误，并支持和允许建立一个已经创建的<strong class="lj jd"> Anaconda </strong>虚拟环境。即使您更喜欢Pycharm之外的其他工具，如Jupiter Notebook，您仍然可以按照指南了解如何在Anaconda中集成加速库。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi me"><img src="../Images/9f6d2b9e52f8b0d8fbf45155b6538282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oDeqGuxf9p89Ajpw5tEntw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">信用:<a class="ae md" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank">Pytorch.org</a></figcaption></figure><p id="a030" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上表很好地恢复了安装Pytorch和CUDA支持的先决条件。Pytorch的最新版本是Pytorch 1.7.1。将Pytorch版本与其他特性、操作系统、python包、语言和CUDA版本相匹配的方法有很多。在这种情况下，我会选择python ch 1 . 7 . 1，Anaconda的最新版本，CUDA 10.2。</p><p id="dcef" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">内容:</p><ol class=""><li id="91d0" class="mf mg it lj b lk ll ln lo lq mh lu mi ly mj mc mk ml mm mn bi translated"><a class="ae md" href="#98b9" rel="noopener ugc nofollow"> <strong class="lj jd">下载NVIDIA CUDA工具包</strong> </a></li><li id="c0c5" class="mf mg it lj b lk mo ln mp lq mq lu mr ly ms mc mk ml mm mn bi translated"><a class="ae md" href="#98b9" rel="noopener ugc nofollow"> <strong class="lj jd">下载安装cuDNN </strong> </a></li><li id="7468" class="mf mg it lj b lk mo ln mp lq mq lu mr ly ms mc mk ml mm mn bi translated"><a class="ae md" href="#d233" rel="noopener ugc nofollow"> <strong class="lj jd">获取GPU的驱动软件</strong> </a></li><li id="8036" class="mf mg it lj b lk mo ln mp lq mq lu mr ly ms mc mk ml mm mn bi translated"><a class="ae md" href="#c60e" rel="noopener ugc nofollow"> <strong class="lj jd">下载蟒蛇</strong> </a></li><li id="8822" class="mf mg it lj b lk mo ln mp lq mq lu mr ly ms mc mk ml mm mn bi translated"><a class="ae md" href="#d2a" rel="noopener ugc nofollow"> <strong class="lj jd">下载Pycharm </strong> </a></li></ol></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="98b9" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated"><strong class="ak"> 1。英伟达CUDA工具包</strong></h1><p id="4fc7" class="pw-post-body-paragraph lh li it lj b lk ns kd lm ln nt kg lp lq nu ls lt lu nv lw lx ly nw ma mb mc im bi translated">这是一个创建GPU加速应用程序的开发环境。它包括使用GPU、调试、优化工具和许多其他功能的库。为了安装CUDA，您需要安装与Pytorch 1.7.1兼容的版本<strong class="lj jd"> CUDA Toolkit 10.2 </strong>。选择与您的操作系统兼容的选项。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/3f62ed7df7b1d0acfcbbd8728b173231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34yZaDBWbsupmhSUZHCkGA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">信用:<a class="ae md" href="https://developer.nvidia.com/cuda-10.2-download-archive?target_os=Windows&amp;target_arch=x86_64" rel="noopener ugc nofollow" target="_blank"> CUDA工具包10.2 </a></figcaption></figure><h1 id="bc34" class="na nb it bd nc nd ny nf ng nh nz nj nk ki oa kj nm kl ob km no ko oc kp nq nr bi translated"><strong class="ak"> 2。下载并安装cuDNN </strong></h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/e7b2e7fbcec25ba4729b2417bc561ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsHdzXr7vdPgn6KyPN9Pow.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">信用:<a class="ae md" href="https://developer.nvidia.com/cuDNN" rel="noopener ugc nofollow" target="_blank"> cuDNN </a></figcaption></figure><p id="1b69" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> CUDA深度神经网络</strong>库是为深度神经网络设计的库，通过使用GPU来加速。它允许计算开销很大的操作，如卷积、最大池化、批量标准化和激活层。</p><p id="c58f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">一旦库的安装完成，您需要下载CuDNN的兼容版本。只有在您创建帐户并输入所需的详细信息后，才可能做到这一点。您必须安装对应<strong class="lj jd"> CUDA toolkit 10.2 </strong>的版本，即<strong class="lj jd"> CuDNN v8.0.5 </strong>。而且，你需要选择“cuDNN库for Windows10”。</p><p id="a26a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下载完成后，您需要:</p><ul class=""><li id="7cbf" class="mf mg it lj b lk ll ln lo lq mh lu mi ly mj mc oe ml mm mn bi translated">解压缩cuDNN文件</li><li id="5e6b" class="mf mg it lj b lk mo ln mp lq mq lu mr ly ms mc oe ml mm mn bi translated">复制文件夹“cuda”中包含的文件</li><li id="fe0a" class="mf mg it lj b lk mo ln mp lq mq lu mr ly ms mc oe ml mm mn bi translated">在NVIDIA CUDA 10.2的道路上移动它们。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/1d33e021fbc54be162c6e1282f73107f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMo0fClBEuPWpYx2AG41Zw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">cuDNN下载</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi og"><img src="../Images/f3dfa7e2a26de23e41ca52d8b1742fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jI9163zyLYtDV3F7IsvGig.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">CUDA工具包10.2</figcaption></figure><h1 id="d233" class="na nb it bd nc nd ny nf ng nh nz nj nk ki oa kj nm kl ob km no ko oc kp nq nr bi translated"><strong class="ak"> 3。获取GPU的驱动软件</strong></h1><p id="afa9" class="pw-post-body-paragraph lh li it lj b lk ns kd lm ln nt kg lp lq nu ls lt lu nv lw lx ly nw ma mb mc im bi translated">NVIDIA driver是一款免费软件下载，旨在连接您的操作系统和GPU，以选择图形设计、摄影、广播和视频编辑的创意应用程序。可以从Nvidia网站下载驱动程序。在这样做之前，你需要在<strong class="lj jd">设备管理器</strong> (Gestione Dispositivi)中检查你的<strong class="lj jd">显示适配器</strong> (schede video)的正确版本。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/efd787759efc551a9d79300080f14fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ESYa3rrd9ho9aGwl6DBe0w.png"/></div></div></figure><p id="22e0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我的情况是<strong class="lj jd">英伟达GeForce GTX 960M </strong>。一旦你选择了你在设备管理器上找到的选项，你就可以下载了。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/bd7be1d366454068d5032d4b437f1b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TWXDshnE7NrizEyYWBTPnw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">信用:<a class="ae md" href="https://www.nvidia.it/Download/index.aspx?lang=it" rel="noopener ugc nofollow" target="_blank"> NVIDIA驱动</a></figcaption></figure><h1 id="c60e" class="na nb it bd nc nd ny nf ng nh nz nj nk ki oa kj nm kl ob km no ko oc kp nq nr bi translated"><strong class="ak"> 4。下载蟒蛇</strong></h1><p id="df53" class="pw-post-body-paragraph lh li it lj b lk ns kd lm ln nt kg lp lq nu ls lt lu nv lw lx ly nw ma mb mc im bi translated">我们需要安装<a class="ae md" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>，它将在Pycharm的虚拟环境中用作解释器。安装很容易，但需要一些时间。同时，你可以放松，做任何你想做的事。一旦完成，打开命令提示符，在搜索栏中运行'<em class="oj"> cmd </em>，然后右击<strong class="lj jd"> Anaconda提示符</strong>选择'以管理员身份运行'。在提示符下写下下面一行代码后:</p><pre class="ks kt ku kv gt ok ol om on aw oo bi"><span id="ee33" class="op nb it ol b gy oq or l os ot"><strong class="ol jd">conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch</strong></span></pre><p id="c19f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">使用Pytorch启用GPU非常重要。所以，不要跳过这一步，否则是不行的。</p><h1 id="1d2a" class="na nb it bd nc nd ny nf ng nh nz nj nk ki oa kj nm kl ob km no ko oc kp nq nr bi translated"><strong class="ak"> 5。下载Pycharm </strong></h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/1312f2c81124f1d9da316beba86e1bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkRpJ-w2qY4GXql5mlcHRA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">信用:<a class="ae md" href="https://www.jetbrains.com/pycharm/download/#section=windows" rel="noopener ugc nofollow" target="_blank"> Pycharm </a></figcaption></figure><p id="c462" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有两个版本，完整的专业版和免费版。我关注的是免费的社区版本，它是免费的并且运行得足够好。下载完成后，我们可以打开Pycharm并创建一个新项目，在其中选择解释器。在这里是Anaconda环境。您需要检查文件系统中Anaconda可执行文件的路径。比如我的路径是<strong class="lj jd">C:\ Users \ nuovo \ anaconda 3 \ python . exe</strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/5e1519848f9c9489769a1d7423c5f9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdAxFLhONql2f3Ky-p3vbA.png"/></div></div></figure><p id="e22c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">一旦您选择了解释器，您就可以创建项目了。要查看解释器，需要点击菜单中的文件，进入<strong class="lj jd">设置→项目:名称→解释器</strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/1a7cc75d8fec10cce985041a94810352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H32R-O8IA658D3aXddLpLQ.png"/></div></div></figure><p id="65f2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">看看是不是和这个截图差不多。如果不一样，你需要检查你电脑里的正确路径。要检查CUDA是否工作，可以用格式写一个文件。py下面两行代码:</p><pre class="ks kt ku kv gt ok ol om on aw oo bi"><span id="cdf8" class="op nb it ol b gy oq or l os ot">import torch<br/>print(torch.cuda.is_available())</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/8751340e304fa8ab19dc2cb2feee6b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQjzDeqzdTpqsRvep5RdOQ.png"/></div></div></figure><p id="ee54" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果该行代码返回True，这意味着您的系统支持CUDA。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="aef2" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated"><strong class="ak">最终想法:</strong></h1><p id="c43f" class="pw-post-body-paragraph lh li it lj b lk ns kd lm ln nt kg lp lq nu ls lt lu nv lw lx ly nw ma mb mc im bi translated">这些是我在Windows 10上安装CUDA toolkit、cuDNN、NVIDIA driver、Anaconda和Pycharm的步骤。CUDA的出现将有助于加快Pytorch模型的速度。我希望这个故事对你有用，并能帮助你建立你的深度学习环境。感谢一路阅读。</p><p id="f9cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有兴趣看其他文章吗？下面我给你推荐几个故事:</p><div class="oy oz gp gr pa pb"><a rel="noopener  ugc nofollow" target="_blank" href="/pytorch-tutorial-for-beginners-8331afc552c4"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">Pytorch初学者教程</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">Pytorch是脸书人工智能研究实验室于2016年开发的深度学习框架。它因计算机而广为人知…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">pub.towardsai.net</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp lb pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a href="https://medium.com/datadriveninvestor/train-a-cnn-using-skorch-for-mnist-digit-recognition-53d7d2f971c7" rel="noopener follow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">使用MNIST数字识别Skorch训练CNN</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">结合了scikit-learn的灵活性和PyTorch的强大功能的库</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">medium.com</p></div></div><div class="pk l"><div class="pq l pm pn po pk pp lb pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener  ugc nofollow" target="_blank" href="/k-fold-cross-validation-for-machine-learning-models-918f6ccfd6d"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">机器学习模型的k重交叉验证</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">使用sklearn的交叉验证技术概述</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">pub.towardsai.net</p></div></div><div class="pk l"><div class="pr l pm pn po pk pp lb pb"/></div></div></a></div><p id="c5cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">参考文献:</strong></p><p id="34ae" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[1]<a class="ae md" href="https://github.com/pytorch/pytorch#from-source" rel="noopener ugc nofollow" target="_blank">https://github.com/pytorch/pytorch#from-source</a></p></div></div>    
</body>
</html>