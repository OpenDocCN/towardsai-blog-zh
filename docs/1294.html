<html>
<head>
<title>Statistical Forecasting for Time Series Data Part 5: ARMA+GARCH model for Time Series Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列数据的统计预测第5部分:时间序列预测的ARMA+GARCH模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/statistical-forecasting-for-time-series-data-part-5-arma-garch-model-for-time-series-forecasting-98beeedcfba8?source=collection_archive---------0-----------------------#2020-12-24">https://pub.towardsai.net/statistical-forecasting-for-time-series-data-part-5-arma-garch-model-for-time-series-forecasting-98beeedcfba8?source=collection_archive---------0-----------------------#2020-12-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="fb99" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/0857e9ebae9eb4d35004c04e967cef14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y6j2EdSa6TLHu_bW"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">照片由<a class="ae kl" href="https://unsplash.com/@chrisliverani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·利维拉尼</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="eb96" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这一系列文章中，我们使用流行的统计模型来分析标准普尔500市场指数:<strong class="ko ja"> SARIMA </strong>(季节性自回归综合移动平均线)，以及<strong class="ko ja"> GARCH </strong>(广义自回归条件异方差)。</p><p id="1a29" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在第一部分中，该系列从python中的<code class="fe lk ll lm ln b">yfinance</code> API中废弃。它被清理并用于导出<strong class="ko ja"> S &amp; P 500收益</strong>(连续价格的百分比变化)和<strong class="ko ja">波动率</strong>(收益的大小)。在第二部分中，使用了一些时间序列探索技术来从数据中获得关于趋势、季节性、平稳性等特征的见解。有了这些认识，在第三和第四部分，研究了SARIMA和GARCH类模型。所有这些部分的链接都在本文的底部。</p><p id="176d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这一部分中，前面介绍的两个模型(SARIMA和GARCH)被结合起来建立标准普尔500收益的预测和有效置信区间。本文中使用的代码来自这个<a class="ae kl" href="https://github.com/yashveersinghsohi/Statistical_Modeling_for_Time_Series_Forecasting" rel="noopener ugc nofollow" target="_blank">资源库</a>中的<strong class="ko ja">Returns Models/ARMA-GARCH for SPX Returns . ipynb</strong>笔记本</p><h1 id="5c44" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">目录</h1><ol class=""><li id="b78d" class="mm mn iq ko b kp mo kt mp kx mq lb mr lf ms lj mt mu mv mw bi translated">导入数据</li><li id="b3d4" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">列车测试分离</li><li id="e470" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">ARMA的参数估计</li><li id="468c" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">对收益率拟合ARMA模型</li><li id="a2fd" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">ARMA模型残差</li><li id="46a9" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">GARCH参数估计</li><li id="e046" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">基于ARMA残差的GARCH模型</li><li id="0f8c" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">ARMA + GARCH模型的预测</li><li id="c1c8" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">结论</li><li id="b70e" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">链接到本系列的其他部分</li><li id="1766" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj mt mu mv mw bi translated">参考</li></ol></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h1 id="334d" class="lo lp iq bd lq lr nj lt lu lv nk lx ly lz nl mb mc md nm mf mg mh nn mj mk ml bi translated">导入数据</h1><p id="78e4" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">这里，我们导入在本系列的第1部分中被废弃和预处理的数据集。参考第1部分准备好数据(最后链接)，或者从这个<a class="ae kl" href="https://github.com/yashveersinghsohi/Statistical_Modeling_for_Time_Series_Forecasting" rel="noopener ugc nofollow" target="_blank">库</a>下载<strong class="ko ja"> data.csv </strong>文件。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">从本系列的第1部分导入标准包和预处理数据集的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/e8ada2238edf6ec641c1f7d8a8cdb4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*Hs8ScyWxMhgqIkXjJIyQFQ.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">显示数据集前5行的前一个代码单元格的输出</figcaption></figure><p id="ff18" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">因为这与本系列前面部分中使用的代码相同，所以为了简洁起见，这里不再详细解释每一行。</p><h1 id="4da9" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">列车测试分离</h1><p id="43fc" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">我们现在将数据分为训练集和测试集。这里所有来自<code class="fe lk ll lm ln b">2019–01–01</code>的观测值构成了测试集，之前的所有观测值就是训练集。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">将数据分成训练集和测试集的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/1b832eb52c1ff3c20c710c687c274511.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*3tDWhR-cwVwh5dheM28IEg.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">先前代码单元的输出显示了训练集和测试集的形状</figcaption></figure><h1 id="09bb" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">ARMA模型的参数估计</h1><p id="00ec" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">ARMA模型是ARIMA模型的一个子集，在本系列前面已经讨论过。它有两个参数表示为:ARMA(p，q)。像ARIMA一样，</p><ul class=""><li id="5009" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated"><strong class="ko ja"> PACF </strong>图中显著滞后的数量表示<strong class="ko ja"> p </strong>的顺序(控制过去值对现在值的影响)。</li><li id="edd0" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><strong class="ko ja"> ACF </strong>图中显著滞后的数量表示<strong class="ko ja"> q </strong> ( <strong class="ko ja"> </strong>控制过去残差对当前值的影响)的顺序。</li></ul><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">为标准普尔500回报生成ACF和PACF图的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi od"><img src="../Images/b9f657673bb677963b71fb24366ec793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9I3w9dh84R5rCvu7eYMcA.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">标准普尔500回归的ACF和PACF阴谋</figcaption></figure><p id="c6d5" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe lk ll lm ln b">statsmodels.graphics.tsaplots</code>库中的<code class="fe lk ll lm ln b">plot_acf()</code>和<code class="fe lk ll lm ln b">plot_pacf()</code>函数用于绘制标准普尔500收益的ACF和PACF图。在检查这些图时，很明显，前两个滞后在两个图中都是显著的。此后，显著性水平突然关闭，然后再次上升。因此，为了保持模型简单，合理的做法是将初始参数设置为:</p><ul class=""><li id="72ac" class="mm mn iq ko b kp kq kt ku kx nz lb oa lf ob lj oc mu mv mw bi translated">p = 1或p = 2</li><li id="3f5c" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">q = 1或q = 2</li></ul><h1 id="6408" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">对收益率拟合ARMA模型</h1><p id="7016" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">让我们建立标准普尔500收益的ARMA(1，1)模型。</p><p id="dffc" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">注:</strong>在拟合SARIMA模型类的模型之前，需要检查用于拟合模型的输入序列是否平稳。对于平稳的时间序列，汇总统计数据不会随时间发生显著变化。这意味着创建数据的底层进程与。直觉地认为，只有在生成序列的基础过程在未来保持不变的情况下，才能对序列进行建模。本系列<code class="fe lk ll lm ln b">spx_ret</code>的平稳性在本系列之前的部分(第2部分和第3部分)使用<code class="fe lk ll lm ln b">statsmodels.tsa.stattools</code>中的<code class="fe lk ll lm ln b">adfuller()</code>测试进行测试。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">对标准普尔500收益拟合ARMA(1，1)模型的代码，并绘制汇总表。</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/46ca597487a4f1fae0052fa0355991ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*7EWn1HlYE4TW1w-wp-fd4Q.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">显示标准普尔500收益ARMA(1，1)汇总表的上一个代码单元格的输出</figcaption></figure><p id="459c" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe lk ll lm ln b">statsmodels.tsa.statespace.sarimax</code>库中的<code class="fe lk ll lm ln b">SARIMAX()</code>函数用于拟合SARIMAX系列模型的任何子集。将序列<code class="fe lk ll lm ln b">spx_ret</code>和顺序<code class="fe lk ll lm ln b">order = (1, 0, 1)</code>传递到函数中，以获得ARMA(1，1)模型定义。模型上的<code class="fe lk ll lm ln b">fit()</code>方法用于训练模型定义。拟合模型结果上的<code class="fe lk ll lm ln b">summary()</code>方法打印模型汇总表，如图所示。</p><p id="7f52" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">汇总表显示，模型的所有系数都是显著的。</p><h1 id="4630" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">ARMA模型预测和置信区间</h1><p id="efc6" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">在本节中，我们使用ARMA(1，1)模型来预测测试集的收益。此外，使用相同的模型来生成置信区间。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">标准普尔500收益的ARMA(1，1)预测和置信区间</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi of"><img src="../Images/ee1ca031fc8520dfee63c6cf50b2c2ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMUnxhx5z2cD7XWTaTH2QA.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">ARMA(1，1)模型预测(红色)和置信区间(绿色)与实际回报(蓝色)的关系图</figcaption></figure><p id="52c4" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe lk ll lm ln b">get_forecast()</code>方法用于构建一个预测对象，该对象稍后可用于使用<code class="fe lk ll lm ln b">conf_int()</code>函数导出置信区间。<code class="fe lk ll lm ln b">predict()</code>函数用于获得测试集的预测。<strong class="ko ja"> RMSE </strong>(均方根误差)指标用于计算预测相对于测试集中实际回报的准确性。然后根据测试集的实际回报绘制预测和置信区间，以直观地确认模型的准确性。</p><p id="91a0" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在检查图(如图所示)时，预测在某些情况下是准确的，而在某些情况下，它们会有很大的误差。置信区间不能表明预测在测试集的不同时间段内将如何表现。在某些情况下，置信区间似乎过于保守，回报超出了界限。在其他情况下，置信区间不够保守。</p><p id="2682" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了解决这个问题，在下一节中，我们将分析模型的残差，并尝试预测ARMA预测何时会相差很小，何时会相差很大。</p><h1 id="6a10" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">ARMA模型残差</h1><p id="e960" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">在这一节中，我们将绘制模型的残差图，并探索它的一些特性。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">绘制标准普尔500回报的ARMA(1，1)残差的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi og"><img src="../Images/e67dcc50477778af1133abf83c3a4808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8y0gepsmki9ce6TF01VmEw.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">标准普尔500收益的ARMA(1，1)残差图</figcaption></figure><p id="c938" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">ARMA(1，1)模型生成的残差可以通过使用拟合模型的<code class="fe lk ll lm ln b">resid</code>属性来访问。在检查该图时，可以清楚地看到残差显示出波动聚类现象。这意味着，如果序列在特定时间步显示高波动性(高方差)，那么它在附近的时间步也会显示高波动性，反之亦然。在2004年、2008年(高波动时期)以及两者之间的时期(低波动时期)，这一现象明显可见。</p><p id="4992" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">显示这种波动性聚类的序列可以使用GARCH模型成功地建模(如最后链接的第4部分所示)。在下一节中，我们开始估计在ARMA(1，1)模型的残差上拟合GARCH模型所需的参数。</p><h1 id="b53d" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">GARCH参数估计</h1><p id="10e8" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">GARCH模型有两个参数，表示为:GARCH(p，q)。这些参数是通过计算PACF图中显著滞后的数量来估计的。生成这种图的代码没有显示，因为它与上面的PACF图代码非常相似。传递的数据中只需要调整。在这种情况下，通过的系列将是<code class="fe lk ll lm ln b">model_results.resid</code>。</p><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi og"><img src="../Images/2239ad0704e5ed02f794518617ac7c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDXBc96Y9PFEYi5ibQ2F1w.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">ARMA(1，1)残差的PACF</figcaption></figure><p id="af03" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">该图显示残差中没有明显的滞后。因此，我们将拟合各种GARCH模型:GARCH(1，1)，GARCH(1，2)，GARCH(2，1)，GARCH(2，2)，等等。直到我们得到一个具有重要系数和最佳精度的模型。</p><h1 id="c7c3" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">基于ARMA残差的GARCH模型</h1><p id="b2ea" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">如前所述，PACF图没有提供任何关于起始参数的信息。在这种情况下，应该拟合各种模型，以便找到具有重要系数和最佳精度的模型。这确保了我们有一个尽可能简单的模型和尽可能高的精度。</p><p id="4e17" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在拟合了几个这样的模型后，GARCH(2，2)满足了我的条件。请随意在当地试用各种型号，并选择您喜欢的型号。让我们看看符合GARCH(2，2)模型的代码:</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">根据ARMA(1，1)残差拟合GARCH(2，2)模型的代码</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2c191f218ea5a2b25c726ee62394bd06.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*Faj_hRetyxGDhM5-pAEqFQ.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">GARCH(2，2)模型汇总表</figcaption></figure><p id="bcbf" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在拟合模型之前，准备一个新的数据框架。该数据帧由原始数据集中的所有时间步长组成(在训练测试分割之前)。训练时间步长由来自ARMA(1，1)模型的残差占据。这些实际上用于训练GARCH模型。测试周期被之前一个时间步观察到的实际回报所占据。这相当于说，该模型将使用今天观察到的回报来预测明天的回报波动。</p><p id="0e8f" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe lk ll lm ln b">arch</code>库中的<code class="fe lk ll lm ln b">arch_model()</code>函数用于定义GARCH模型。<code class="fe lk ll lm ln b">fit()</code>函数用于训练定义的模型。<code class="fe lk ll lm ln b">last_obs</code>参数用于确定模型应该从哪个时间步开始预测。<code class="fe lk ll lm ln b">summary()</code>功能打印出如图所示的汇总表。汇总表显示模型的所有系数都是显著的。</p><h1 id="452f" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">ARMA+GARCH模型的预测</h1><p id="7d3c" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">在本节中，我们使用拟合ARMA(1，1)残差的GARCH(2，2)模型来预测测试集中残差的波动性。</p><figure class="nr ns nt nu gt ka"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">使用ARMA构建标准普尔500回报预测的代码，以及使用GARCH构建这些预测的置信区间</figcaption></figure><figure class="nr ns nt nu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oi"><img src="../Images/3bfaef7c1a42db049589e8d81680ce1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3gJi98lVJaq8dT3XHDk2gw.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">使用ARMA+GARCH模型对标准普尔500收益(蓝色)的预测(红色)+置信区间(绿色)</figcaption></figure><p id="f786" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><code class="fe lk ll lm ln b">forecast()</code>方法用于拟合模型:<code class="fe lk ll lm ln b">resid_model_results</code>。这将输出一个<code class="fe lk ll lm ln b">ARCHModelForecast</code>对象，其中包含均值模型和波动性模型的预测。接下来，调用<code class="fe lk ll lm ln b">residual_variance</code>属性来获得对波动性的预测。从存储在<code class="fe lk ll lm ln b">arma_predictions_df</code>中的ARMA模型的预测中减去(和加上)波动率模型的预测，以获得模型的下(和上)置信区间。</p><p id="b996" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">接下来，预测(来自ARMA(1，1))和置信区间(来自GARCH(2，2))相对于实际的标准普尔500回报被绘制。在检查该图时，很明显，当回报稳定时，并且当预测接近实际回报时，置信区间通过接近来反映这一点。当回报不稳定，预测与回报相差甚远时，情况也是如此。在这种情况下，置信区间也会调整并变得远离。</p><h1 id="ad69" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">结论</h1><p id="6653" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">因此，使用组合的ARMA和GARCH模型，我们能够建立更有意义的预测。查看预测和置信区间，我们可以了解未来回报的大概数字以及市场的稳定性。在本系列的下一篇也是最后一篇文章中，我们将研究如何使用SARIMA模型族来处理非平稳数据:标准普尔500价格。</p><h1 id="2246" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">链接到本系列的其他部分</h1><ul class=""><li id="a6f7" class="mm mn iq ko b kp mo kt mp kx mq lb mr lf ms lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-modeling-of-time-series-data-part-1-data-preparation-and-preprocessing-b52f26f6213c" rel="noopener">时间序列数据的统计建模第1部分:预处理</a></li><li id="cede" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-modeling-of-time-series-data-part-2-exploratory-data-analysis-5c3aaedc04b7" rel="noopener">时间序列数据的统计建模第二部分:探索性数据分析</a></li><li id="be2b" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-modeling-of-time-series-data-part-3-forecasting-stationary-time-series-using-sarima-f0ff1284bebb" rel="noopener">时间序列数据的统计建模第三部分:利用SARIMA预测平稳时间序列</a></li><li id="48d7" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-forecasting-of-time-series-data-part-4-forecasting-volatility-using-garch-1e9ff832f7e5" rel="noopener">时间序列数据的统计建模第四部分:利用GARCH预测波动率</a></li><li id="2944" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated">时间序列数据的统计建模第5部分:时间序列预测的ARMA+GARCH模型。</li><li id="02f3" class="mm mn iq ko b kp mx kt my kx mz lb na lf nb lj oc mu mv mw bi translated"><a class="ae kl" href="https://medium.com/@yashveersinghsohi/statistical-forecasting-for-time-series-data-part-6-forecasting-non-stationary-time-series-using-9acc28c39db9" rel="noopener">时间序列数据的统计建模第六部分:用ARMA预测非平稳时间序列</a></li></ul><h1 id="b1c7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">参考</h1><p id="de9b" class="pw-post-body-paragraph km kn iq ko b kp mo kr ks kt mp kv kw kx no kz la lb np ld le lf nq lh li lj ij bi translated">[1]<a class="ae kl" href="https://365datascience.com/courses/time-series-analysis-in-python/" rel="noopener ugc nofollow" target="_blank">365数据科学</a>时间序列分析课程</p><p id="de85" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[2]<a class="ae kl" href="https://machinelearningmastery.com/time-series-forecasting/" rel="noopener ugc nofollow" target="_blank">machine learning mastery</a>关于时序分析的博客</p><p id="4346" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[3] <a class="ae kl" href="https://en.wikipedia.org/wiki/Autoregressive_conditional_heteroskedasticity" rel="noopener ugc nofollow" target="_blank">维基百科</a>关于GARCH的文章</p><p id="8876" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">GARCH模型上的YouTube视频。</p><p id="f2ce" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[5] <a class="ae kl" href="https://www.youtube.com/watch?v=JntA9XaTebs" rel="noopener ugc nofollow" target="_blank"> Tamara Louie:应用统计建模&amp;机器学习进行时间序列预测</a></p><p id="f39d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">罗布·J·海曼和乔治·阿萨纳索普洛斯的《预测:原理与实践》</p></div></div>    
</body>
</html>