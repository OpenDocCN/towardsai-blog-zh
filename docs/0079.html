<html>
<head>
<title>Introduction to Gaussian Distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高斯分布简介</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/introduction-to-gaussian-distribution-726be7dc5046?source=collection_archive---------1-----------------------#2019-06-19">https://pub.towardsai.net/introduction-to-gaussian-distribution-726be7dc5046?source=collection_archive---------1-----------------------#2019-06-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="688b" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">朝向AI的高斯分布101 |<a class="ae ep" href="https://towardsai.net" rel="noopener ugc nofollow" target="_blank"/></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/14278f63716c08b1e8a52b71e2bdea05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gkhEngieNEuNsPLI_g9Rw.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">样本正态分布</figcaption></figure><p id="eb66" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">线性和逻辑回归等机器学习模型假设变量呈正态分布。其他人受益于具有“类高斯”分布的变量。在这种情况下，可用于预测Y(输出)的X(输入)的观测值在更大的值范围内变化，从而给出更好的结果。</p><p id="a913" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如果一个变量不是正态分布的，有时可以找到一个数学变换来将一个变量转换成一个类似高斯的分布。</p><h2 id="7124" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">遵循高斯分布的变量变换:</h2><p id="db21" class="pw-post-body-paragraph kl km iq kn b ko mb kq kr ks mc ku kv kw md ky kz la me lc ld le mf lg lh li ij bi translated">这些是一些直接的数学方法来转换变量，使它们遵循高斯分布。他们谁也不比谁强。它们主要取决于变量的原始分布。他们是，</p><ol class=""><li id="d225" class="mg mh iq kn b ko kp ks kt kw mi la mj le mk li ml mm mn mo bi translated">对数变换</li><li id="0229" class="mg mh iq kn b ko mp ks mq kw mr la ms le mt li ml mm mn mo bi translated">相互转化</li><li id="7ef5" class="mg mh iq kn b ko mp ks mq kw mr la ms le mt li ml mm mn mo bi translated">平方根变换</li><li id="5b54" class="mg mh iq kn b ko mp ks mq kw mr la ms le mt li ml mm mn mo bi translated">指数变换</li></ol><p id="874e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在本文中，我们将比较著名的<a class="ae mu" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集</a>的“年龄”变量的所有这些转换。</p><p id="d0f1" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们从导入包和加载数据集开始</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="0ba7" class="lj lk iq na b gy ne nf l ng nh">#Importing Packages<br/>import numpy as np <br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import pylab<br/>import scipy.stats as stats</span><span id="9628" class="lj lk iq na b gy ni nf l ng nh">#Importing dataset<br/>data = pd.read_csv("train.csv", usecols = ['Age'])</span></pre><p id="cfbf" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">然后让我们检查是否有任何丢失的值，并使用Pandas dropna方法删除它们(为了这个例子)</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="c9eb" class="lj lk iq na b gy ne nf l ng nh">data.apply(lambda x: sum(x.isnull()),axis=0)</span></pre><figure class="mv mw mx my gt ka gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/6966d459b1a5651d5266174843386220.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*9fD044WizUZz2-gv5Ht9hQ.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">“年龄”中空值的数量</figcaption></figure><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="6671" class="lj lk iq na b gy ne nf l ng nh">data = data.dropna()</span></pre><h2 id="4689" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">原始分布:</h2><p id="716b" class="pw-post-body-paragraph kl km iq kn b ko mb kq kr ks mc ku kv kw md ky kz la me lc ld le mf lg lh li ij bi translated">让我们从可视化变量的分布开始，在我们的例子中，年龄，来自泰坦尼克号数据集。我们绘制了一个直方图来显示钟形和Q-Q图(两者都用于显示变量是否遵循高斯分布)。请记住，如果变量是正态分布的，我们应该在理论分位数上看到一条45度的直线。也就是说，真实的分位数值应该与理论值完全一致。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="9c62" class="lj lk iq na b gy ne nf l ng nh">def diagnostic_plots(df, variable): <br/>    <br/>    plt.figure(figsize=(15,6))<br/>    plt.subplot(1,2,1)<br/>    df[variable].hist()<br/>    #plt.xlim((0, 100))<br/>    <br/>    plt.subplot(1,2,2)<br/>    stats.probplot(df[variable], dist="norm", plot = pylab)<br/>    <br/>    plt.show()<br/>    <br/>diagnostic_plots(data, 'Age')</span></pre><p id="2ca8" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这里，我创建了一个函数diagnostic_plots，用于可视化变量是否遵循高斯分布。它将数据框和目标变量作为输入参数。函数的第一部分是直方图，第二部分是Q-Q图。我调用了变量“年龄”上的函数。</p><figure class="mv mw mx my gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nk"><img src="../Images/5a2487fce69e4919bbebe661f51b0b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZbVppSwsIfSxZmDep5Ytg.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">原始分布</figcaption></figure><p id="309b" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">变量遵循近似高斯分布。它稍微有点倾斜，这解释了下端偏离45度线(红线)的原因。</p><p id="edda" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在，让我们对年龄变量应用上述所有转换，并评估结果。</p><h2 id="3d6e" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">对数变换:</h2><p id="7d7d" class="pw-post-body-paragraph kl km iq kn b ko mb kq kr ks mc ku kv kw md ky kz la me lc ld le mf lg lh li ij bi translated">让我们应用Numpy的log函数并绘制诊断图。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="4526" class="lj lk iq na b gy ne nf l ng nh">data['Age_log'] = np.log(data.Age)</span><span id="70f8" class="lj lk iq na b gy ni nf l ng nh">diagnostic_plots(data, 'Age_log')</span></pre><figure class="mv mw mx my gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nl"><img src="../Images/2674b60db597256bb997da59aa722063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WScnK5chuhmmdYVSmxlL7Q.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">对数变换</figcaption></figure><p id="38b3" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以看到，转换根本没有使年龄遵循高斯分布。请记住，0的日志没有定义。因此，如果您的数据包含0 —给它一个偏移量或使用另一种变换方法。</p><h2 id="0715" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">相互转换:</h2><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="05dc" class="lj lk iq na b gy ne nf l ng nh">data['Age_reciprocal'] = 1 / data.Age</span><span id="5b64" class="lj lk iq na b gy ni nf l ng nh">diagnostic_plots(data, 'Age_reciprocal')</span></pre><figure class="mv mw mx my gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nm"><img src="../Images/81e9461c7e6c5abf493d48487948db7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uq2uSSu9jjLoz-JAv17yEA.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">相互转化</figcaption></figure><p id="95a0" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以看到，这种转变也没有帮助。</p><h2 id="8afe" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">平方根变换:</h2><p id="1d3f" class="pw-post-body-paragraph kl km iq kn b ko mb kq kr ks mc ku kv kw md ky kz la me lc ld le mf lg lh li ij bi translated">接下来，我们将尝试平方根变换。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="adac" class="lj lk iq na b gy ne nf l ng nh">data['Age_sqrt'] = data.Age**(1/2)</span><span id="7254" class="lj lk iq na b gy ni nf l ng nh">diagnostic_plots(data, 'Age_sqrt')</span></pre><figure class="mv mw mx my gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nn"><img src="../Images/e3b8543aa1fd95f2b7e14d132745ff0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BfSLF4ALsC-DmD-WU8jL8g.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">平方根变换</figcaption></figure><p id="d9a4" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">结果比其他的好一点，但仍然不是高斯的。开头和结尾有些偏差。最后，我们来试试指数变换。</p><h2 id="72f4" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">指数变换:</h2><p id="ddc7" class="pw-post-body-paragraph kl km iq kn b ko mb kq kr ks mc ku kv kw md ky kz la me lc ld le mf lg lh li ij bi translated">在这里，我们可以尝试任何我们想要的指数。我选择1.2作为指数。但是你可以尝试不同的指数，看看分布如何变化。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="812e" class="lj lk iq na b gy ne nf l ng nh">data['Age_exp'] = data.Age**(1/1.2)</span><span id="56f9" class="lj lk iq na b gy ni nf l ng nh">diagnostic_plots(data, 'Age_exp')</span></pre><figure class="mv mw mx my gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi no"><img src="../Images/fcff30046128760b1775e83426e3d0cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SsI0a4fepfcW3jXeCsdJAQ.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">指数变换</figcaption></figure><p id="2ba3" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如您在直方图中看到的，这种转换使“年龄”变量几乎遵循高斯分布。直方图中的峰值更居中，并且在Q-Q图中，在较低端值附近只有一些偏差。因此，在这种特殊情况下，我们可以看到指数变换效果最好。</p><h2 id="37b2" class="lj lk iq bd ll lm ln dn lo lp lq dp lr kw ls lt lu la lv lw lx le ly lz ma iw bi translated">那么，你应该转换变量吗？</h2><p id="b931" class="pw-post-body-paragraph kl km iq kn b ko mb kq kr ks mc ku kv kw md ky kz la me lc ld le mf lg lh li ij bi translated">这取决于你的最终目标。在商业环境中，最好使用变量的原始分布来训练模型，因为这样更容易解释，并且将来使用模型进行预测时可能会出现较少的问题。另一方面，在竞争的情况下，最好选择一个表现最好的变量。</p><p id="7c54" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">参考资料:<a class="ae mu" href="https://www.udemy.com/feature-engineering-for-machine-learning/learn/lecture/8749894#overview" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/feature-engineering-for-machine-learning/learn/</a></p></div></div>    
</body>
</html>