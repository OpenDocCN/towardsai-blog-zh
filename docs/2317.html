<html>
<head>
<title>Stock Market Prediction using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的股市预测</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/stock-market-prediction-using-machine-learning-dd064a7561f1?source=collection_archive---------1-----------------------#2021-11-09">https://pub.towardsai.net/stock-market-prediction-using-machine-learning-dd064a7561f1?source=collection_archive---------1-----------------------#2021-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b1bd" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="b056" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="kx">“对历史有一个好的视角，我们可以更好地理解过去和现在，从而对未来有一个清晰的愿景。”</em></p><p id="fbb0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">—卡洛斯·斯利姆·埃卢</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/eb3e26fd1e2d5d9d646466f0f7b68972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*-t9Cdl8G7-Mxweb0E4zyRQ.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk translated">照片由<a class="ae lk" href="https://unsplash.com/@aditya1702?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Aditya Vyas </a>在<a class="ae lk" href="https://unsplash.com/s/photos/stock-market?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="0b2c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">简介</strong></p><p id="e0ae" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">股市分析和预测是很难完成的任务。有许多变量会影响股票价格的价值，包括但不限于媒体出版物、内部购买、股息通知、股票分割、季度财务报告和管理层的财务预测。这些变量使得任何股市专业人士都极难准确预测股价的涨跌。</p><p id="4c2c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">随着机器学习及其许多高级算法的引入，最近的市场研究和股票市场预测进步已经开始将机器学习方法包括在分析股票市场数据和预测未来股票价格中。成功预测一只股票的未来价格可以产生可观的投资回报。</p><p id="b63a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><em class="kx">免责声明:本文无意提供交易和投资建议。不保证模型的准确性。建议读者在做出任何投资决定之前，先做好自己的研究。</em></p><p id="891a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">路线图</strong></p><p id="1371" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本文的其余部分将介绍一个程序，该程序将尝试使用机器学习根据以前的收盘价来预测未来的股票价格。我们将使用线性回归模型。将使用Python执行以下步骤。</p><p id="22ea" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.导入所需的库。</p><p id="82be" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.将数据集导入数据框架。</p><p id="368c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.分析数据。</p><p id="3ad8" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.重构数据。</p><p id="4b2d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.将数据分为训练数据集和测试数据集。</p><p id="9b81" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">6.根据训练数据训练模型。</p><p id="e1ad" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">7.根据测试数据进行预测。</p><p id="3e1e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.可视化股票价格预测。</p><p id="e31a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">程序</strong></p><p id="7abc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">这个程序的目标是根据一个公司股票以前的收盘价预测未来的股票价格。在这种情况下，我们将使用特斯拉。</p><p id="c6c9" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">导入所需的库</strong></p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="79ab" class="lq lr it lm b gy ls lt l lu lv"># Install yfinance and cartopy packages.<br/>!pip install yfinance<br/>!pip install cartopy<br/><br/># Import the libraries.<br/><strong class="lm jd">import</strong> <strong class="lm jd">cartopy</strong><br/><strong class="lm jd">import</strong> <strong class="lm jd">pandas</strong> <strong class="lm jd">as</strong> <strong class="lm jd">pd</strong><br/><strong class="lm jd">import</strong> <strong class="lm jd">yfinance</strong> <strong class="lm jd">as</strong> <strong class="lm jd">yf</strong><br/><strong class="lm jd">import</strong> <strong class="lm jd">datetime</strong><br/><strong class="lm jd">import</strong> <strong class="lm jd">numpy</strong> <strong class="lm jd">as</strong> <strong class="lm jd">np</strong><br/><strong class="lm jd">import</strong> <strong class="lm jd">matplotlib.pyplot</strong> <strong class="lm jd">as</strong> <strong class="lm jd">plt</strong></span></pre><p id="c9e0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">访问并导入数据集</strong></p><p id="4d2c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将获得从2020年1月7日到2021年1月7日期间特斯拉的股票数据。</p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="352b" class="lq lr it lm b gy ls lt l lu lv"># We will use the Yahoo! Finance Market Downloader to get data for  # Tesla stock.<br/>tesla = yf.download('TSLA',start='2020-01-07',  end='2021-01-07',progress=<strong class="lm jd">False</strong>)[['Close']]</span></pre><p id="d61f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据分析</strong></p><p id="6ae4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们来看看数据。</p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="84ac" class="lq lr it lm b gy ls lt l lu lv"># Print the first 5 rows.<br/>tesla.head(5)</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/aedf68d5b7bba481d46092a39ec083af.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*JqYPqual2VaNpZEer0e8pw.png"/></div></figure><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="7b46" class="lq lr it lm b gy ls lt l lu lv"># Show information about the data. <br/>tesla.info()</span><span id="8994" class="lq lr it lm b gy lx lt l lu lv">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>DatetimeIndex: 253 entries, 2020-01-07 to 2021-01-06<br/>Data columns (total 1 columns):<br/> #   Column  Non-Null Count  Dtype  <br/>---  ------  --------------  -----  <br/> 0   Close   253 non-null    float64<br/>dtypes: float64(1)<br/>memory usage: 4.0 KB</span></pre><p id="515c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在指定的时间段内有253条特斯拉的股票记录。有一个日期列和一个名为Close的数据类型为float的列。数据集不包含空值。</p><p id="c2fa" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">重组数据</strong></p><p id="98fc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们需要转换数据，以便将它们输入到机器学习模型中。我们将重组我们的数据，以便每行包含一天的实际股票价格，后面是前10天的收盘价。例如，从第11行开始，我们将获得前10个收盘价，并将其用于特性。Pandas shift函数将用于获取前10行数据中每一行的接近值。这一过程将对每行数据重复进行。</p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="ba29" class="lq lr it lm b gy ls lt l lu lv"># Restructure the data.<br/>tesla = pd.concat([tesla, tesla.shift(), tesla.shift(2),tesla.shift(3),tesla.shift(4),tesla.shift(5),<br/>           tesla.shift(6),tesla.shift(7),tesla.shift(8),tesla.shift(9),tesla.shift(10)], axis=1).dropna() <br/>tesla.columns = list(range(0,11))<br/>tesla.rename(columns={0:'actual_stock_price'},inplace=<strong class="lm jd">True</strong>)<br/>tesla.head()</span></pre><p id="4d97" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">以下是重组后的数据集。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="ab gu cl ly"><img src="../Images/0e8326cd5f11f500cb30593f6817b857.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TUW6bzMJecwWB-atJg5DZw.png"/></div></figure><p id="621f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">将数据分成训练和测试数据集</strong></p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="2501" class="lq lr it lm b gy ls lt l lu lv"># Split the data into training and test data sets. <br/>train = tesla.head(len(tesla)-10)<br/>test = tesla.tail(10)</span></pre><p id="0d8f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">训练模型并对测试数据进行预测</strong></p><p id="f41d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用线性回归模型进行训练，并对测试数据进行预测。线性回归是一种受监督的机器学习模型，其中该模型在自变量和因变量之间找到最佳拟合线性线。</p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="73b3" class="lq lr it lm b gy ls lt l lu lv"># Import the Linear Regression model from scikit-learn.<br/><strong class="lm jd">from</strong> <strong class="lm jd">sklearn.linear_model</strong> <strong class="lm jd">import</strong> LinearRegression</span><span id="563f" class="lq lr it lm b gy lx lt l lu lv"># Create the model object.<br/>LR = LinearRegression()<br/><br/># Train the model on the training data.<br/>LR.fit(train[list(range(1,11))],train['actual_stock_price'])<br/><br/># Make predictions on the test data.<br/>test['predictions'] = LR.predict(test[list(range(1,11))])</span></pre><p id="5f2d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">可视化实际和预测的股票价格</strong></p><p id="d5fd" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">让我们将实际股价和预测股价在一段时间内进行可视化比较。</p><pre class="kz la lb lc gt ll lm ln lo aw lp bi"><span id="e9ed" class="lq lr it lm b gy ls lt l lu lv"># Visualize the actual stock price and the predicted stock price    # over the time period.<br/>plt.figure(figsize=(12,7))<br/>ax = test[['actual_stock_price','predictions']].plot(figsize=(12,8))<br/>plt.xlabel('Date', fontsize=12)<br/>plt.ylabel('Stock Price', fontsize=12)<br/>plt.title('Actual and Predicted Stock Prices', fontsize=15)<br/>plt.grid()<br/>plt.show()</span></pre><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lz"><img src="../Images/96c052fa59a2cbfb4155fd142f06923b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZdxIMC9k9JSdaB5Tl-Bb-A.png"/></div></div></figure><p id="aa31" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">结论:在这段时间内，预测的股票价格和实际的股票价格非常接近。看起来预测的股票价格比实际收盘股票价格略低。</p><p id="e0fb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">非常感谢你阅读我的文章！如果您有任何意见或反馈，请在下面添加。</p><p id="011b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。会员资格让你可以无限制地接触媒体上的故事。你可以通过这个链接注册<a class="ae lk" href="https://medium.com/@dniggl/membership" rel="noopener">https://medium.com/@dniggl/membership</a></p></div></div>    
</body>
</html>