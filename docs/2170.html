<html>
<head>
<title>Survival Analysis can be done in excel too.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生存分析也可以在excel中完成。</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/survival-analysis-can-be-done-in-excel-too-46bc12e93a33?source=collection_archive---------4-----------------------#2021-09-09">https://pub.towardsai.net/survival-analysis-can-be-done-in-excel-too-46bc12e93a33?source=collection_archive---------4-----------------------#2021-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d83a" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-analysis" rel="noopener ugc nofollow" target="_blank">数据分析</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div class="gh gi jw"><img src="../Images/ac2e8462317c2fb31964c95b4509da02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*QBjOBrfV0I4P9obZSf320Q.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">图片由来自Pixabay的Peggy und Marco Lachmann-Anke提供</figcaption></figure><p id="45d4" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">写这篇文章的目的是向大家展示“如何利用excel的简单公式进行生存分析”。</p><p id="eeff" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在我继续之前，让我分享一个生存分析的正式定义。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lf"><img src="../Images/a93c17383fad4ec80e15585226ff23f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QuFpF6hYna5ETawmDzrT2Q.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">Denny Ryanto在Unsplash上拍摄的照片</figcaption></figure><p id="b6b0" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">“生存分析是用于数据分析的统计程序的集合，其中感兴趣的结果变量是事件发生前的时间。幸存者函数表示个体从起源时间存活到时间t之后的某个时间的概率</p><p id="a4a1" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">记住这个定义，现在让我们继续我们的目标，使用excel实现生存分析。</p><p id="72ab" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">用于分析的数据集</strong></p><p id="33e2" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我正在考虑一个简单的制造单元的例子，其中一堆有很高故障几率的旧机器被选择进行维护。我们的工作是进行生存分析，找出这些机器在维护期结束后的生存概率。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/6bca698b002546440901982281d37e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*FkY8sV0G0LLpTI_8gF2Z7A.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">照片由Unsplash上的附身摄影提供</figcaption></figure><p id="6b33" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">数据集显示了旧机器维护了多长时间(<em class="lp">栏A </em>)以及机器在维护期结束后是否“发生故障”(<em class="lp">栏B </em>)。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/1a43507b329406f50f523384600c058d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*ULA4-lrERmwoDrEyot8Z5g.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="6806" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这里1 =机器故障，0 =机器可用</p><p id="ffd1" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">群体中包含的机器总数= 20。</p><p id="8ed2" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">需要修改数据，以便将其转换为正确的格式，从而创建生存曲线。</p><p id="a5e3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">格式化数据</strong></p><p id="7831" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">再增加一列，D为“时间”,显示维护的唯一月份。第一个值应该从0开始。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/ce5fec3f44bb0b5edb6719035104aea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*7yiJvE-17r3noRT4RqrfSg.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="e7dc" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">根据需要创建新列</strong></p><p id="aea5" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">新列创建为</p><p id="cf71" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">1.“机器故障”，</p><p id="e2b9" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">2.“机器可用”，</p><p id="3444" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">3.“1-(机器故障/机器可用)”也称为(1-危险)，其中危险=(机器故障/机器可用)和</p><p id="b28b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">4.“S(t)”(生存函数)。</p><p id="e71e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">列中的值使用excel公式填充。</p><p id="6324" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">列中的第一个值“S(t)”是1，因为在开始时间(t = 0)，所有机器都被认为是可用的，并且生存函数为1。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ls"><img src="../Images/9dd216fb0f4c5b3bd1be120fb7cc91cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEuhWco4IU20uO2BI14-tA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="bf10" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">用所需的Excel公式填充各个列</strong></p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lt"><img src="../Images/0fc392defd86430c5f7eb9e5a2fd2c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXkVKv4oWcuIwPsQyaVmxQ.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="3540" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">1.从“机器故障”栏开始。</p><p id="3d11" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">第一行保留空白，因为在时间实例“0”时没有机器故障。</p><p id="b00f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">“机器故障”栏第2行中的值是使用以下公式计算的</p><p id="32f6" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">E3:= count ifs(＄A＄2:＄A＄21，D3，＄B＄2:＄B＄21.1)</p><p id="abf2" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">只需突出显示区域E3:E19并按Ctrl-D即可填充该列的其他行。使用相同的技巧填充F到H列中的所有其他值。</p><p id="6567" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这统计了在特定时刻发生故障的机器数量。</p><p id="4bf5" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">2.对于“可用机器”栏，使用的公式为:</p><p id="b023" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">F2: <strong class="kj ja"> </strong> =COUNTIF($A$2:$A$21，“&gt;”&amp;D2–1)</p><p id="534c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这将计算在移除发生故障的机器后，特定时间实例中可用的机器数量。</p><p id="731e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">3.计算“1-(机器故障/可用机器)”栏时，使用的公式为:</p><p id="f36e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">G3: =1-(E3/F3)</p><p id="079e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">它代表由(Ej/Fj)给出的危险，其中j = 1…19</p><p id="831d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这是因为它有助于计算生存函数S(t ),如下所示。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lu"><img src="../Images/e53e162fd23f0a2e74dd4786c182f007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h_JSRNZiRAsWXURcP0Nl-g.png"/></div></div></figure><p id="b2c9" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">生存分析中的生存函数解释为某个感兴趣的对象在超过某个时间t后生存的概率，函数值介于0和1(含)之间，是一个非增函数。</p><p id="ab9e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">4.对于“S(t)”列，使用的公式为:</p><p id="264c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">H3: =H2*G3</p><p id="766b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这就计算出了生存概率。</p><p id="025d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">该列第一行中的值为1，作为一个实例(t = 0)，所有机器都可用。没有崩溃。</p><p id="54ff" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">现在为了创建生存曲线，我们需要遵循一定的步骤。</strong></p><p id="bf44" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">步骤1:将D列和H列中的值复制到J列和k列中。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lv"><img src="../Images/764aefb99721ac782cd9072527db106e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tL9a4PekSYKJp3LnZsG8GA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="b7d4" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">步骤2:将JBOY3乐队:J19范围内的值复制到J20:J36。然后范围K2:K18中的值被复制到K20:K36。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/702ab5451da7d9719c4fe71753d969f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*a44caW3BokiiuwM376NEcA.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="1754" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">步骤3:列L中的值列表是如下表所示的数字序列。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/66a4ab95f8d42ed95562d9b7a5f75ec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*HX7BI6MDEtRGbNNLxrKMAQ.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="d1dc" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">步骤4:基于列L，从最小到最大对列J到L进行排序。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/f2ad4b1311c6d6411b0c4e1e776db8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*Y5LaxYAbHzxIEvrPyZT2zg.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="65ab" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">步骤5:细胞J2:K36被突出显示，以创建“具有直线和标记的散点图”选项，这是我们的最终存活曲线(卡普兰-迈耶曲线)。</p><p id="a7c6" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">Kaplan-Meier是一种非参数分析，也称为乘积限方法，用于根据事件发生的时间来估计生存函数。</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lz"><img src="../Images/f97527e480879123f19061c157c1f375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-5znkcUxCsdzolt2iUZug.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="53d5" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">生存曲线(卡普兰-迈耶曲线)</p><figure class="lg lh li lj gt ka gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/58fbf3eabf7baf5636c302e696a61038.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*36zFnwfm52b0cmktP2bkmw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">按作者</figcaption></figure><p id="19e5" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">如何解读这条生存曲线/卡普兰·迈耶曲线</strong></p><p id="5a2e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">Kaplan-Meier曲线是生存函数估计的直观表示，它表示某一时间间隔内某一事件(例如生存)的概率是多少。</p><p id="2d9a" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">从上面的生存曲线，可以解释为:</p><p id="6830" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在8个月的时间段之后，包含在群体中的机器的存活概率接近0.80，即80%。</p><p id="33b7" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">类似地，在17个月的时间段之后，包含在群体中的机器的生存概率接近0.60，即60%。</p><p id="bd4f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">并且在22个月的时间段之后，包含在群体中的机器的存活概率接近0.20，即20%。</p><p id="0f96" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我的结论是。</p><p id="cc28" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">希望你喜欢阅读这篇文章。</p><p id="49c3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">你可以在媒体上跟踪我</p><p id="d2ca" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">LinkedIn: <a class="ae mb" href="https://www.linkedin.com/in/supriya-ghosh" rel="noopener ugc nofollow" target="_blank"> Supriya Ghosh </a></p><p id="e9d6" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">还有推特:<a class="ae mb" href="https://twitter.com/isupriyaghosh" rel="noopener ugc nofollow" target="_blank"> @isupriyaghosh </a></p><p id="198b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这会激励我对你越来越满足。</p></div></div>    
</body>
</html>