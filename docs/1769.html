<html>
<head>
<title>Diving Into Data Pipelines — Foundations of Data Engineering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入数据管道——数据工程的基础</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/diving-into-data-pipelines-b2eb1b8a4923?source=collection_archive---------1-----------------------#2021-04-17">https://pub.towardsai.net/diving-into-data-pipelines-b2eb1b8a4923?source=collection_archive---------1-----------------------#2021-04-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e301dc6f38eac0d5f7d4833e0ef0875c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1OQa5gtPdMYr4zjuXh--Q.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">来源:引自<a class="ae jg" href="https://unsplash.com/photos/GAVSpEx6ooc" rel="noopener ugc nofollow" target="_blank">埃里克·韦伯</a>在<a class="ae jg" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的原创</figcaption></figure><h2 id="d7e8" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-engineering" rel="noopener ugc nofollow" target="_blank">数据工程</a>，<a class="ae ep" href="https://towardsai.net/p/category/editorial" rel="noopener ugc nofollow" target="_blank">社论</a></h2><div class=""/><div class=""><h2 id="2127" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">数据管道介绍。如何，什么，什么时候，为什么？</h2></div><p id="b647" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">作者:</strong> <a class="ae jg" href="https://www.linkedin.com/in/saniya-parveez-b41279157/" rel="noopener ugc nofollow" target="_blank">萨妮娅·帕维兹</a>，<a class="ae jg" href="https://mktg.best/vguzs" rel="noopener ugc nofollow" target="_blank">罗伯特·伊里翁多</a></p><div class="is it gp gr iu md"><a href="https://members.towardsai.net" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">加入我们吧↓ |面向人工智能成员|数据驱动的社区</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">加入人工智能，成为会员，你将不仅支持人工智能，但你将有机会…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">members.towardsai.net</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ja md"/></div></div></a></div><p id="9569" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi ms translated"><span class="l mt mu mv bm mw mx my mz na di"> T </span>这篇文章广泛介绍了数据管道的分步解释和代码，介绍了数据工程的基础。数据管道广泛用于数据科学和<a class="ae jg" href="https://mld.ai/mldcmu" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jt">机器学习</strong> </a>中，并且在机器学习工作流中至关重要，以整合来自多个流的数据，从而获得商业智能，用于竞争分析和优势。</p><h1 id="0b29" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">什么是数据管道？</h1><p id="ec92" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">数据管道是一组规则，用于将来自多个源的数据模拟并转换到可以获取新值的目的地。在最简单的形式中，管道可能只从不同的来源提取数据，比如REST API、数据库、提要、实时流等等。这些被加载到目的地，例如数据仓库中的SQL表。数据管道是分析、报告和机器学习能力的基础。</p><p id="5b08" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">数据管道由多个步骤构成，如数据提取、数据预处理、数据验证、数据存储等。它们可以通过使用多种编程语言和工具来开发。</p><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/14b034e4ce93763bf5d7441de927e90b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dH8a_NQsXr-8w9fJdjD6kw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图1:一个简单的数据管道流，在这个例子中是Amazon Web Services(AWS)sage maker。</figcaption></figure><p id="51a0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">构建良好的数据管道不仅仅是从数据源中提取数据，并将它们加载到可管理的数据库表或平面文件中供分析师使用。它们对原始数据执行几个步骤，包括清理、结构化、规范化、合并、聚合等等。数据管道还需要其他活动，如对不同基础设施的监控、维护、增强和支持。</p><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/cefb197428fff22307e2f1d208611af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsSmg4vAhYrT6WTocgUdZw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图2:数据管道工作流程。</figcaption></figure><h1 id="0968" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">ETL和ELT</h1><p id="3329" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">可能没有一种模式像ETL和它更现代的兄弟ELT一样广为人知。两者都是数据仓库和商业智能中广泛使用的模式。在过去几年中，他们鼓励在生产中运行数据科学和机器学习模型的管道模式。</p><p id="cd66" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这两种模式都是数据处理方法，用于将数据输入数据仓库，并使数据对分析师和报告工具有用。<em class="oe">提取</em>步骤从各种来源收集数据，为加载和转换做准备。<em class="oe">加载</em>步骤将原始数据(在ELT的情况下)或完全转换的数据(在ETL的情况下)带到最终目的地——<em class="oe">转换</em>步骤，来自每个源系统的原始数据被组合和格式化，以帮助分析师、可视化工具或我们的管道所服务的任何用例。</p><p id="0bc1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">提取和加载步骤的组合通常被称为<strong class="lj jt"> <em class="oe">数据摄取</em> </strong> <em class="oe">。</em></p><h1 id="a8b9" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">数据接收及其接口</h1><p id="feae" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">术语“数据摄取”指的是从一个数据源提取数据，并将其加载到另一个数据源。数据摄取以实时、批量或两者结合的方式发生(通常也称为<strong class="lj jt">λ架构</strong>)。</p><p id="5de4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当成批接收数据时，会定期按时间间隔安排作业。它与几个源交互和通信，需要几个不同类型的接口和数据结构。</p><p id="5fb2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以下是最常见的摄取接口和数据结构:</p><ul class=""><li id="161a" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated"><strong class="lj jt">流处理平台:</strong> RabbitMQ，Kafka。</li><li id="14c9" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated"><strong class="lj jt">数据库:</strong> Postgres，MySQL，HDFS，或者HBase数据库。</li><li id="c8ac" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">数据仓库或数据湖。</li><li id="8eed" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">JSON，CSV，REST API。</li><li id="fa54" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">共享网络文件系统或云存储桶。</li></ul><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/d2599efbb2876f38f3538c9ba8a26282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2XC7DtIT81Q4PVVOfsMuug.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图3:不同的技术堆栈。</figcaption></figure><h2 id="cb24" class="ou nc jj bd nd ov ow dn nh ox oy dp nl lq oz pa nn lu pb pc np ly pd pe nr jp bi translated">从MySQL数据库中提取数据</h2><p id="d25d" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">我们可以用几种不同的方法从MySQL数据库中提取数据:</p><ul class=""><li id="17c0" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">使用SQL进行完全或增量提取</li><li id="aa1e" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">二进制日志(也称为binlog)复制</li></ul><p id="b125" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">使用SQL进行完全或增量提取</strong></p><p id="976e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">使用SQL的完整或增量提取易于实现，但对于频繁更改的大型数据集，可扩展性较差。</p><p id="d1b0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当我们需要将MySQL表中的所有列或部分列接收到数据仓库或数据湖中时，我们可以使用完全提取或增量提取。</p><ul class=""><li id="f7df" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">每次运行提取作业时，都会提取表中的每条记录。</li><li id="d391" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">高容量表可能需要很长时间才能运行。</li></ul><pre class="nz oa ob oc gt pf pg ph pi aw pj bi"><span id="92a9" class="ou nc jj pg b gy pk pl l pm pn">SELECT * FROM Customers</span></pre><p id="78c8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">二进制日志(binlog)复制</strong></p><p id="4411" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">二进制日志复制实现起来更复杂，更适合源表中的数据量变化很大的情况，或者需要更频繁地从MySQL源接收数据的情况。这也是创建流数据接收[ <a class="ae jg" href="https://www.oreilly.com/library/view/data-pipelines-pocket/9781492087823/ch04.html" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]的途径。</p><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi po"><img src="../Images/ba0503143acfb7a078f87f705aed9a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_f3gDpNIO6tJQqGP-OTxw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图4:word云中的SQL。</figcaption></figure><h1 id="51ac" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">管道编排</h1><p id="a8b4" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">编排确保管道中的步骤正确运行，并且这些步骤之间的依赖关系得到适当的管理。流水线步骤总是由<strong class="lj jt"> <em class="oe">引导</em> </strong>，这意味着它们以一个或多个任务开始，以一个或多个特定任务结束。这是保证执行路径所必需的。换句话说，它确保任务在其所有相关任务成功完成之前不会执行。</p><p id="62aa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">管道图也必须是<strong class="lj jt"> <em class="oe">非循环的</em> </strong>，意思是一个任务不能指向之前完成的任务。换句话说，它不能循环回去。如果可以，那么管道可以无休止地运行。</p><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pp"><img src="../Images/0bc780556ef139cccb72c00121df9c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uAYpc6wzAKCs-_o1.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5:数据管道中的步骤。</figcaption></figure><p id="4b0d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如，<a class="ae jg" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank"><strong class="lj jt">Apache air flow</strong></a>是一个开源的数据管道任务编排工具，旨在解决数据工程团队面临的日常挑战:如何构建、管理和监控涉及多个相互依赖的任务的工作流。</p><p id="2215" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">气流具有出色的配置选项，例如:</p><ul class=""><li id="7390" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">调度程序。</li><li id="9bbd" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">执行人。</li><li id="79b3" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">操作员。</li></ul><p id="62e3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">ETL DAG(气流)的图形视图:</p><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pp"><img src="../Images/a3e0f9d8f669e9bffd35662e0544c225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YlD-zoXCINehx81G.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5: DAG步骤。</figcaption></figure><p id="fabf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">DAG代码实现:</p><pre class="nz oa ob oc gt pf pg ph pi aw pj bi"><span id="601a" class="ou nc jj pg b gy pk pl l pm pn"><strong class="pg jt">from</strong> <strong class="pg jt">datetime</strong> <strong class="pg jt">import</strong> <!-- -->timedelta<br/><strong class="pg jt">from</strong> <strong class="pg jt">airflow</strong> <strong class="pg jt">import</strong> <!-- -->DAG<br/><strong class="pg jt">from</strong> <strong class="pg jt">airflow.operators.bash_operator</strong> \<br/>  <strong class="pg jt">import</strong> <strong class="pg jt">BashOperator</strong><br/><strong class="pg jt">from</strong> <strong class="pg jt">airflow.operators.postgres_operator</strong> \<br/>  <strong class="pg jt">import</strong> <strong class="pg jt">PostgresOperator</strong><br/><strong class="pg jt">from</strong> <strong class="pg jt">airflow.utils.dates</strong> <strong class="pg jt">import</strong> <!-- -->days_ago<br/><br/>dag<!-- --> <!-- -->=<!-- --> <!-- -->DAG(<br/>    <!-- -->'elt_pipeline_sample',<br/>    <!-- -->description='A sample ELT pipeline',<br/>    <!-- -->schedule_interval=timedelta(days=1),<br/>    <!-- -->start_date<!-- --> <!-- -->=<!-- --> <!-- -->days_ago(1),<br/>)<br/><br/>extract_orders_task<!-- --> <!-- -->=<!-- --> <!-- -->BashOperator(<br/>    <!-- -->task_id='extract_order_data',<br/>    <!-- -->bash_command='python /p/extract_orders.py',<br/>    <!-- -->dag=dag,<br/>)<br/><br/>extract_customers_task<!-- --> <!-- -->=<!-- --> <!-- -->BashOperator(<br/>    <!-- -->task_id='extract_customer_data',<br/>    <!-- -->bash_command='python /p/extract_customers.py',<br/>    <!-- -->dag=dag,<br/>)<br/><br/>load_orders_task<!-- --> <!-- -->=<!-- --> <!-- -->BashOperator(<br/>    <!-- -->task_id='load_order_data',<br/>    <!-- -->bash_command='python /p/load_orders.py',<br/>    <!-- -->dag=dag,<br/>)<br/><br/>load_customers_task<!-- --> <!-- -->=<!-- --> <!-- -->BashOperator(<br/>    <!-- -->task_id='load_customer_data',<br/>    <!-- -->bash_command='python /p/load_customers.py',<br/>    <!-- -->dag=dag,<br/>)<br/><br/>revenue_model_task<!-- --> <!-- -->=<!-- --> <!-- -->PostgresOperator(<br/>    <!-- -->task_id='build_data_model',<br/>    <!-- -->postgres_conn_id='redshift_dw',<br/>    <!-- -->sql='/sql/order_revenue_model.sql',<br/>    <!-- -->dag=dag,<br/>)<br/><br/>extract_orders_task<!-- --> <!-- -->&gt;&gt;<!-- --> <!-- -->load_orders_task<br/>extract_customers_task<!-- --> <!-- -->&gt;&gt;<!-- --> <!-- -->load_customers_task<br/>load_orders_task<!-- --> <!-- -->&gt;&gt;<!-- --> <!-- -->revenue_model_task<br/>load_customers_task<!-- --> <!-- -->&gt;&gt;<!-- --> <!-- -->revenue_model_task</span></pre><h1 id="da2f" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">管道中的数据验证</h1><p id="02c8" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">当然，即使是设计最好的数据管道，也可能出错。通过对流程、编排和基础设施的良好设计，可以避免或至少减轻一些问题。数据验证也是确保数据质量和有效性的必要步骤，因为在分析中使用未经测试的数据是不安全的。</p><p id="e1e2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在管道末端获得数据质量问题并追溯到起点是最糟糕的情况。通过验证管道中的每一个步骤，我们更倾向于在当前步骤而不是前一个步骤中找到根本原因。</p><p id="9c0b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了增强源系统中的质量问题，数据摄取过程本身可能会导致数据质量问题。以下是一些常见的数据摄取风险或摄取的加载步骤</p><ul class=""><li id="272e" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">增量摄取中的逻辑错误。</li><li id="0826" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">解析提取文件中的问题。</li></ul><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pq"><img src="../Images/25c4ff26d81c3e62930bc264478e1f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ULxcN2Dqizio5HAJ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5:数据验证步骤。</figcaption></figure><p id="a3e4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在管道的每一步验证数据是至关重要的。即使源数据从管道开始就通过了验证，对在管道末端构建的数据模型运行验证也是一种好的做法。</p><p id="257c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以下步骤代表了检查该过程的一种方法:</p><ul class=""><li id="60c1" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">确保度量标准在一定的下限和上限内。</li><li id="1607" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">查看数据模型中的行数增长(或减少)。</li><li id="d414" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">检查特定指标的值是否存在意外的不稳定性。</li></ul><p id="1299" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">可以编写Python脚本来执行数据验证，也有几种可用的框架:</p><ul class=""><li id="268d" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated"><strong class="lj jt"> dbt: </strong>它是一个命令行工具，使数据分析师和工程师能够更有效地转换他们仓库中的数据。</li></ul><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pr"><img src="../Images/c7ba67326a8284635db2a2afedbbc8f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mOClh3YmCfGmkE69.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图6: dbt。</figcaption></figure><ul class=""><li id="e294" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated"><strong class="lj jt">张量流数据验证:</strong>张量流数据验证通过将数据统计与模式进行比较来识别输入数据中的任何异常。</li><li id="0853" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated"><strong class="lj jt">雅虎的验证器</strong></li></ul><p id="17b0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">TensorFlow数据验证(TFDV)可以分析培训和服务，以:</p><ul class=""><li id="b46d" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">计算<a class="ae jg" href="https://news.towardsai.net/descriptive-statistics" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jt">描述性统计</strong> </a>。</li><li id="c6c5" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">推断一个模式。</li><li id="0762" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">检测数据异常。</li></ul><h1 id="12c7" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">维护数据管道的最佳实践</h1><p id="e1e9" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">维护数据管道有几个挑战。对于数据工程师来说，最常见的维护挑战之一是处理这样一个事实，即他们接收数据的系统不是静态的。开发人员总是对他们的软件进行修改，要么添加功能，重构代码库，要么修复错误。</p><p id="3128" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当这些更改修改了要接收的数据的模式或含义时，管道就有失败或不准确的风险。现代数据基础设施的事实是，数据是从大量的、多种多样的来源中获取的。很难找到一个放之四海而皆准的解决方案来处理源系统中的模式和业务逻辑变化。因此，构建可伸缩的数据管道需要最佳实践。</p><p id="e881" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以下是一些推荐的最佳实践:</p><ul class=""><li id="c23e" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">添加抽象。</li><li id="4e3d" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">维护数据协定。</li><li id="ff7b" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">从写模式设计转向读模式设计。</li></ul><h2 id="9e4b" class="ou nc jj bd nd ov ow dn nh ox oy dp nl lq oz pa nn lu pb pc np ly pd pe nr jp bi translated">为什么要加抽象？</h2><p id="1af7" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">只要可行，在源系统和摄取过程之间包含一个抽象层是非常有用的。源系统所有者也有必要维护或了解抽象方法。</p><p id="f83c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><p id="cf1a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">与其直接从Postgres数据库获取数据，不如考虑与数据库所有者合作构建一个REST API，从数据库中提取数据，并可以通过查询进行数据提取。</p><figure class="nz oa ob oc gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ps"><img src="../Images/4713c5d27915526e86f9c07263ce7771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDXZJoqB-iD28i1PgdUFAQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图7: Rest API与数据库的接口。</figcaption></figure><h2 id="5dc4" class="ou nc jj bd nd ov ow dn nh ox oy dp nl lq oz pa nn lu pb pc np ly pd pe nr jp bi translated">为什么要维护数据契约？</h2><p id="666d" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">如果我们直接从源系统的数据库中获取数据，或者通过一些不是专门为我们的提取而设计的方法获取数据，那么创建和维护数据契约对于管理模式和逻辑更改来说是一个技术性较低的解决方案。</p><p id="c884" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从根本上说，数据契约是源系统所有者和从该系统获取数据以用于数据管道的团队之间的书面协议。数据协定可以用文本文档编写，但最好用标准化的配置文件。</p><p id="e089" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">示例:</p><pre class="nz oa ob oc gt pf pg ph pi aw pj bi"><span id="7f3b" class="ou nc jj pg b gy pk pl l pm pn">{<br/>  ingestion_jobid: "orders_postgres",<br/>  source_host: "my_host.com",<br/>  source_db: "ecommerce",<br/>  source_table: "orders",<br/>  ingestion_type: "full",<br/>  ingestion_frequency_minutes: "60",<br/>  source_owner: "dev-team@mycompany.com",<br/>  ingestion_owner: "data-eng@mycompany.com"<br/>};</span></pre><h2 id="5d5b" class="ou nc jj bd nd ov ow dn nh ox oy dp nl lq oz pa nn lu pb pc np ly pd pe nr jp bi translated">从写模式设计转移到读模式设计</h2><p id="fb2d" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">读取时模式是一种模式，其中数据被写入数据湖、S3桶或其他没有严格模式的存储系统。</p><p id="fd1d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><p id="2cac" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">定义系统订单的事件可能被定义为一个JSON对象，但是该对象的属性可能会随着时间的推移而改变，因为添加了新的对象或者删除了现有的对象。</p><p id="88cc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">因此，在这种情况下，数据的模式在被<em class="oe">读取</em>之前是未知的，这就是为什么它被称为读取时模式。</p><p id="81c2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">读取模式和写入模式的区别:</p><p id="4fe2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">写模式</strong></p><ul class=""><li id="eef9" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">快速阅读。</li><li id="1213" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">较慢的负载。</li><li id="1508" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">不敏捷。</li><li id="a649" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">结构化。</li><li id="03eb" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">错误更少。</li><li id="1e3b" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">SQL。</li></ul><p id="805e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">读取模式</strong></p><ul class=""><li id="5cd2" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">读取速度较慢。</li><li id="a13e" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">快速装载。</li><li id="2b3c" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">结构化/非结构化。</li><li id="8282" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">更多错误。</li><li id="3484" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">NoSQL。</li></ul><h1 id="9413" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">标准化数据接收</h1><p id="c554" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">当谈到复杂性时，我们接收的系统数量通常不是问题，而是每个系统都不完全相同的事实。</p><p id="4bac" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">管道维护面临两大挑战:</p><ul class=""><li id="b50c" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">必须编写摄取作业来管理混合的源系统类型(Postgres、Kafka等)。我们需要获取的源系统类型越多，我们的代码库和维护就越大。</li><li id="d4c1" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">相同源系统类型的摄取作业不容易标准化。例如，即使我们只从REST APIs获取数据，如果这些API没有标准化的分页方式、增量访问数据和其他功能，数据工程师可能会构建“一次性”的获取作业，这些作业不会重用代码和共享可以集中维护的逻辑。</li></ul><p id="81db" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这些是控制的技术方法:</p><ul class=""><li id="e40d" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">尽可能标准化代码，并重用。</li><li id="dfcf" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">努力实现配置驱动的数据吸收。</li><li id="daf3" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">考虑我们的抽象。</li></ul><h1 id="e9f3" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">结论</h1><p id="2792" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">数据管道是一组规则，用于将数据从不同的源移动和转换到可以获得新内容的目标。它们是分析、报告和机器学习能力的基础。</p><p id="c853" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">数据管道的复杂性取决于源数据的大小、状态和结构，以及分析项目的需求。在其最简单的形式中，管道可能只从一个源(如REST API)提取数据，并加载到一个目标(如数据仓库中的SQL表)。</p><p id="f1f0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">数据工程师的目标不仅仅是将数据加载到数据仓库中。数据工程师与数据科学家和分析师密切合作，以了解数据将实现什么，并帮助将他们的需求带入可扩展的生产状态。</p><p id="06c1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">数据工程师以确保他们提供的数据的有效性和及时性为荣。这意味着在出现问题时进行测试、发出警报并制定应急计划。而且，是的，最终还是会出问题的！</p></div><div class="ab cl pt pu hx pv" role="separator"><span class="pw bw bk px py pz"/><span class="pw bw bk px py pz"/><span class="pw bw bk px py"/></div><div class="im in io ip iq"><p id="0d6e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">免责声明:</strong>本文所表达的观点均为作者个人观点，不代表与作者(直接或间接)相关的任何公司的观点。这项工作并不打算成为最终产品，而是当前思想的反映，同时也是讨论和改进的催化剂。</p><p id="65d3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">除非另有说明，所有图片均来自作者。</strong></p><p id="2cc1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">经由<a class="ae jg" href="https://towardsai.net/" rel="noopener ugc nofollow" target="_blank">发布<strong class="lj jt">走向AI </strong>发布</a></p><h1 id="5773" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">进一步阅读</h1><div class="is it gp gr iu md"><a rel="noopener  ugc nofollow" target="_blank" href="/state-of-the-art-data-labeling-with-a-true-ai-powered-data-management-platform-18d973f7af78"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">通过真正的人工智能数据管理平台实现最先进的数据标签</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">深入了解大型非结构化数据集的数据标注工作流的真正一流自动化</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">pub.towardsai.net</p></div></div><div class="mm l"><div class="qa l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener  ugc nofollow" target="_blank" href="/gradient-descent-algorithm-for-machine-learning-python-tutorial-ml-9ded189ec556"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">使用Python教程的机器学习(ML) 101的梯度下降</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">使用Python深入研究机器学习(ML)的梯度下降算法的教程</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">pub.towardsai.net</p></div></div><div class="mm l"><div class="qb l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a rel="noopener  ugc nofollow" target="_blank" href="/google-colab-101-tutorial-with-python-tips-tricks-and-faq-7689bd4d24b4"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">使用Python的Google Colab 101教程—提示、技巧和常见问题</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">关于如何将Google Colab与Python结合使用的深入教程，以及Colab的技巧、诀窍和常见问题</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">pub.towardsai.net</p></div></div><div class="mm l"><div class="qc l mo mp mq mm mr ja md"/></div></div></a></div><h1 id="70da" class="nb nc jj bd nd ne nf ng nh ni nj nk nl ky nm kz nn lb no lc np le nq lf nr ns bi translated">参考资料:</h1><p id="5955" class="pw-post-body-paragraph lh li jj lj b lk nt kt lm ln nu kw lp lq nv ls lt lu nw lw lx ly nx ma mb mc im bi translated">[1]詹森·布朗利。2020.“机器学习中的4类分类任务”。机器学习精通。<a class="ae jg" href="https://machinelearningmastery.com/types-of-classification-in-machine-learning/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/types-of-class ification-in-machine-learning/。</a></p><p id="2f3b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[2]《数据管道袖珍参考》。2021.奥赖利在线学习。<a class="ae jg" href="https://www.oreilly.com/library/view/data-pipelines-pocket/9781492087823/ch04.html." rel="noopener ugc nofollow" target="_blank">https://www . oreilly . com/library/view/data-pipelines-pocket/9781492087823/ch04 . html</a></p></div><div class="ab cl pt pu hx pv" role="separator"><span class="pw bw bk px py pz"/><span class="pw bw bk px py pz"/><span class="pw bw bk px py"/></div><div class="im in io ip iq"><div class="nz oa ob oc gt md"><a href="https://ws.towardsai.net/shop" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">店铺↓ |走向AI</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">发布最好的技术、科学和工程|社论→https://towardsai.net/p/editorial |订阅→…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">ws.towardsai.net</p></div></div><div class="mm l"><div class="qd l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a href="https://members.towardsai.net/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">加入我们吧↓ |面向人工智能成员|数据驱动的社区</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">加入人工智能，成为会员，你将不仅支持人工智能，但你将有机会…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">members.towardsai.net</p></div></div><div class="mm l"><div class="qe l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a href="https://sponsors.towardsai.net/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">赞助商|了解如何成为《走向人工智能》的赞助商</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">无论你是想以一种吸引读者的方式突出你的产品，吸引高度相关的利基受众，还是…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">sponsors.towardsai.net</p></div></div><div class="mm l"><div class="qf l mo mp mq mm mr ja md"/></div></div></a></div></div></div>    
</body>
</html>