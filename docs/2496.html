<html>
<head>
<title>The Framework Uber Uses for Designing Optimal Statistical Experiments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优步用于设计最优统计实验的框架</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/the-framework-uber-uses-for-designing-optimal-statistical-experiments-a6a2585c7d66?source=collection_archive---------4-----------------------#2022-01-17">https://pub.towardsai.net/the-framework-uber-uses-for-designing-optimal-statistical-experiments-a6a2585c7d66?source=collection_archive---------4-----------------------#2022-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d4f9" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="13c6" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">OED支持使用Pyro的概率编程模型进行评分和优化实验。</h2></div><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="ab gu cl kw"><img src="../Images/2f90ce380d93dc728e7429d65ee28f76.png" data-original-src="https://miro.medium.com/v2/format:webp/1*tbmy8TBi9qRC0B01vfgfvg.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">图片来源:优步</figcaption></figure><blockquote class="ld le lf"><p id="3522" class="lg lh li lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我最近创办了一份专注于人工智能的教育时事通讯，已经有超过10万名订户。《序列》是一份无废话(意思是没有炒作，没有新闻等)的ML导向时事通讯，需要5分钟阅读。目标是让你与机器学习项目、研究论文和概念保持同步。请通过订阅以下内容来尝试一下:</p></blockquote><div class="md me gp gr mf mg"><a href="https://thesequence.substack.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd jd gy z fp ml fr fs mm fu fw jc bi translated">序列</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">订阅人工智能世界中最相关的项目和研究论文。受到110，000+的信任…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">thesequence.substack.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu kx mg"/></div></div></a></div><p id="deb5" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">快速实验是现代软件开发的关键要素。机器学习越来越受欢迎，这使得稳健的实验设计成为软件开发方法学的前沿。从数据降噪到超参数优化，实验是机器学习程序生命周期的关键要素。然而，为给定的问题设计最佳的实验仍然是一个相关的挑战。最近，优步开源了建立在其Pyro概率编程语言之上的<a class="ae my" href="http://docs.pyro.ai/en/stable/contrib.oed.html" rel="noopener ugc nofollow" target="_blank">最优实验设计(OED) </a>框架。</p><p id="0c15" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">在机器学习领域，设计最佳实验并不是什么新鲜事，但在过去几年里，这个领域的相关性无疑有所增加。实验设计的困难在于它涵盖了无缝多样的任务，例如设计一个在线调查或寻找学习周期中的最佳点。在一致的结构下建模这些不同的问题需要灵活的方法。贝叶斯最优实验设计(BOED)提供了基于概率的数学抽象，能够在实验过程中解释数据和观察结果。在一个高层次上，BOED为一个给定的实验寻找已建立的贝叶斯模型，然后寻找基于其执行的最大化预期信息增益(EIG)。</p><p id="bfb2" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">优步的新《牛津英语词典》框架受到了BOED研究的一些最新进展的启发。</p><h1 id="bf92" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">这项研究</h1><p id="7c89" class="pw-post-body-paragraph lg lh it lj b lk nr kd lm ln ns kg lp mv nt ls lt mw nu lw lx mx nv ma mb mc im bi translated">在过去的几年里，围绕BOED的研究非常活跃。优步本身已经沉浸在一系列的研究努力，以推进BOED方法。具体来说，有两篇研究论文是新牛津英语词典框架的核心灵感。</p><p id="8d3d" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">在<a class="ae my" href="https://papers.nips.cc/paper/9553-variational-bayesian-optimal-experimental-design" rel="noopener ugc nofollow" target="_blank">变分贝叶斯最优实验设计</a>中，研究人员提出了四种变分方法来估计实验中的EIG。每种方法都基于不同的建模假设，这些假设涵盖了大多数真实世界的实验。本文探讨了每个估计量的优点和缺点，以及它对不同类型的实验的实际适用性。</p><p id="5cce" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">在<a class="ae my" href="https://arxiv.org/abs/1911.00294" rel="noopener ugc nofollow" target="_blank">设计贝叶斯最优实验的统一随机梯度方法</a>中，研究人员提出了BOED的随机梯度上升方法。所提出的方法试图解决对设计空间中所有可能的实验进行评分并选择最佳实验的挑战。使用梯度上升允许选择最佳实验，而不必访问整个设计空间。</p><h1 id="a5d9" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">建立在Pyro之上</h1><p id="1641" class="pw-post-body-paragraph lg lh it lj b lk nr kd lm ln ns kg lp mv nt ls lt mw nu lw lx mx nv ma mb mc im bi translated">为了实现新的BOED技术，优步需要一个概率编程栈。幸运的是，他们已经构建并开源了市场上最好的软件之一。<a class="ae my" href="http://pyro.ai/" rel="noopener ugc nofollow" target="_blank"> Pyro </a>是优步AI实验室发布的深度概率编程语言(PPL)。Pyro建立在PyTorch之上，基于四个基本原则。<a class="ae my" href="https://eng.uber.com/pyro/" rel="noopener ugc nofollow" target="_blank">摘自原Pyro博文:</a></p><ul class=""><li id="61a9" class="nw nx it lj b lk ll ln lo mv ny mw nz mx oa mc ob oc od oe bi translated"><strong class="lj jd"> <em class="li">普适</em> </strong> <em class="li"> : Pyro是一个普适的PPL——它可以表示任何可计算的概率分布。怎么会？通过从具有迭代和递归的通用语言(任意Python代码)开始，然后添加随机采样、观察和推断。</em></li><li id="a3fa" class="nw nx it lj b lk of ln og mv oh mw oi mx oj mc ob oc od oe bi translated"><strong class="lj jd"> <em class="li">可扩展</em> </strong> <em class="li"> : Pyro以比手写代码更少的开销扩展到大型数据集。怎么会？通过建立现代的黑盒优化技术，使用小批量的数据来近似推断。</em></li><li id="a377" class="nw nx it lj b lk of ln og mv oh mw oi mx oj mc ob oc od oe bi translated"><strong class="lj jd"> <em class="li">极小</em> </strong> <em class="li">:烈焰敏捷且易维护。怎么会？Pyro是用一个强大的、可组合的抽象小核心实现的。只要有可能，繁重的工作就委托给PyTorch和其他库。</em></li><li id="3f40" class="nw nx it lj b lk of ln og mv oh mw oi mx oj mc ob oc od oe bi translated"><strong class="lj jd"> <em class="li">灵活</em> </strong> <em class="li"> : Pyro旨在你想要的时候自动化，需要的时候控制。怎么会？Pyro使用高级抽象来表达生成和推理模型，同时允许专家轻松定制推理。</em></li></ul><p id="62da" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">这些原则经常将Pyro的实现拉向相反的方向。例如，通用化要求在Pyro程序中允许任意的控制结构，但是这种通用性使得它很难扩展。然而，总的来说，Pyro在这些功能之间取得了辉煌的平衡，是现实世界应用中最好的ppl之一。</p><h1 id="aa0d" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">烟火中的OED</h1><p id="0ad1" class="pw-post-body-paragraph lg lh it lj b lk nr kd lm ln ns kg lp mv nt ls lt mw nu lw lx mx nv ma mb mc im bi translated">OED利用Pyro的编程模型进行实验设计和优化。本质上，Pyro OED将任何实验分为三个关键阶段:</p><p id="f376" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">1) <strong class="lj jd">设计:</strong>对实验的可控方面进行建模。</p><p id="5c7c" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">2) <strong class="lj jd">观察:</strong>运行实验，收集相关数据点。</p><p id="ff3c" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">3) <strong class="lj jd">推理:</strong>分析收集的数据，更新底层实验。</p><p id="9564" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">为了说明Pyro OED如何实现这些概念，让我们以<a class="ae my" href="http://www2.psych.utoronto.ca/users/peterson/psy430s2001/Miller%20GA%20Magical%20Seven%20Psych%20Review%201955.pdf" rel="noopener ugc nofollow" target="_blank">为例，这是一个著名的心理学实验</a>，它根据参与者能够记住的更长的随机数字串来评估他的记忆能力。在这种情况下，实验的三个阶段如下:</p><p id="d6f3" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">1) <strong class="lj jd">设计:</strong>选择我们希望参与者记住的列表长度。</p><p id="7d11" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">2) <strong class="lj jd">观察:</strong>向被试呈现随机数列表，记录他们能记住或不能记住的情况。</p><p id="cb8c" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">3) <strong class="lj jd">推断:</strong>用逻辑回归模型估计一个有一定记忆能力的人记住一列给定数字的概率。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi ok"><img src="../Images/5ad4819915200ec38577b56695047b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sNRjUzvC52DPXKfRv1EHxA.gif"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">资料来源:https://eng.uber.com/oed-pyro-release/</figcaption></figure><p id="fe6f" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">下面的代码演示了Pyro OED中那个实验的设计。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/9bdc58cc4e2081f9d5ab33eacea078cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*6oGTjoZtnNoDqfaOQ9Zkcg.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">来源:<a class="ae my" href="https://eng.uber.com/oed-pyro-release/" rel="noopener ugc nofollow" target="_blank">https://eng.uber.com/oed-pyro-release/</a></figcaption></figure><p id="1815" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">实验从给所有可能的设计打分并选出最佳设计开始。这是使用前一节中解释的EIG估计器来完成的。之后，代码使用<em class="li"> human_response </em>函数记录用户响应，并使用<em class="li"> run_inference </em>方法更新概率。</p><p id="2466" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">Pyro OED的关键要素是使用EIG估计量来选择最优设计。让我们看看OED文档中的以下代码:<a class="ae my" href="http://docs.pyro.ai/en/stable/contrib.oed.html" rel="noopener ugc nofollow" target="_blank">http://docs.pyro.ai/en/stable/contrib.oed.html</a></p><pre class="kr ks kt ku gt oq or os ot aw ou bi"><span id="4a94" class="ov na it or b gy ow ox l oy oz"><strong class="or jd">#Step 1<br/>def</strong> model(design):</span><span id="512c" class="ov na it or b gy pa ox l oy oz">    <em class="li"># This line allows batching of designs, treating all batch dimensions as independent</em><br/>    <strong class="or jd">with</strong> pyro.plate_stack("plate_stack", design.shape):</span><span id="3be6" class="ov na it or b gy pa ox l oy oz">        <em class="li"># We use a Normal prior for theta</em><br/>        theta = pyro.sample("theta", dist.Normal(torch.tensor(0.0), torch.tensor(1.0)))</span><span id="97db" class="ov na it or b gy pa ox l oy oz">        <em class="li"># We use a simple logistic regression model for the likelihood</em><br/>        logit_p = theta - design<br/>        y = pyro.sample("y", dist.Bernoulli(logits=logit_p))</span><span id="a6a1" class="ov na it or b gy pa ox l oy oz">        <strong class="or jd">return</strong> y<br/>#Step 2</span><span id="43cd" class="ov na it or b gy pa ox l oy oz">eig = nmc_eig(model, design, observation_labels=["y"], target_labels=["theta"], N=2500, M=50)</span><span id="f2e4" class="ov na it or b gy pa ox l oy oz">#Step 3<br/>designs = torch.stack([design1, design2], dim=0)</span></pre><p id="c4bc" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">在模型设计建立之后，我们可以选择一个特定的EIG估计量(步骤2)或者简单地在设计网格中进行估计(步骤3)。</p><p id="d842" class="pw-post-body-paragraph lg lh it lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated">Pyro OED的开源版本将允许数据科学家使用一致的编程模型快速建模和优化实验。通过建立在Pyro的基础上，OED实验可以利用整个概率框架，也可以轻松集成到PyTorch或TensorFlow等深度学习堆栈中。</p></div></div>    
</body>
</html>