<html>
<head>
<title>Real-Time Stock News Sentiment Analyzer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实时股票新闻情绪分析器</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/real-time-stock-news-sentiment-analyzer-54eaa91c5634?source=collection_archive---------0-----------------------#2021-10-10">https://pub.towardsai.net/real-time-stock-news-sentiment-analyzer-54eaa91c5634?source=collection_archive---------0-----------------------#2021-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="cf23" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/97e166718b17a7872a842e013274f7bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3eH011ZtJzA3_OLy6TMJtA.png"/></div></div></figure><p id="5cdb" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">投资股市是应对通货膨胀的一个好方法。通货膨胀是指大多数日常或普通使用的商品和服务的价格上涨，如食品、服装、住房、娱乐、交通、消费品等。基本上，有了100卢比，你就买不到去年能买到的那么多瓦达帕夫了。</p><p id="59bc" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在受到疫情冲击的2020-2021财年，多达1420万新投资者开始在股市交易。</p><p id="b865" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在股票市场进行良好投资所需的一项关键技能是能够正确分析与金融和商业部门相关的新闻。哪家公司正在进行行业多元化，或者哪家公司有走向破产的迹象？你需要随时了解市场上发生的每一笔小交易和影响。金融新闻可能有点难以理解，尤其是对那些金融界的新手来说。</p><p id="c556" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">为了让这个过程变得简单一点，我计划制作一个工具，提取印度股市上每只股票的最新头条，并通过一个经过专门金融新闻培训的情绪分析器进行分析，为每只股票创建一个总体情绪，以帮助股票投资新手更好地理解新闻。</p><p id="b1da" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">实时股票新闻分析</strong></p><p id="3382" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">要求:</strong></p><ol class=""><li id="4c81" class="lf lg iq kj b kk kl ko kp ks lh kw li la lj le lk ll lm ln bi translated">美丽的声音</li><li id="a4d1" class="lf lg iq kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">拥抱脸变形金刚库</li><li id="0047" class="lf lg iq kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">Urllib</li><li id="9f23" class="lf lg iq kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">Numpy</li><li id="4439" class="lf lg iq kj b kk lo ko lp ks lq kw lr la ls le lk ll lm ln bi translated">熊猫</li></ol><p id="fd85" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">获取数据</strong></p><p id="74c4" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">让我们从可靠来源的网络搜集财经新闻开始。</p><p id="d63f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在浏览了多个网站后，我发现<strong class="kj ja"> tickertape </strong>按字母顺序分类其股票，并在其URL中使用一个tick(关键字)来导航到特定的股票。事实证明，这种接口对于网络抓取数据非常有用。</p><p id="373e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">首先，让我们创建tickertape中所有分笔成交点的列表。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="327d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我创建了一个get_ticks()函数来从<strong class="kj ja"> tickertape/stocks </strong>中一次性提取所有的ticks。这里每只股票的名字都链接到它的筛选页面。链接格式为“/股票/ <strong class="kj ja">股票名称勾选</strong>”。</p><figure class="lt lu lv lw gt ka gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/0ba7443320e51403ef4b559bd0bc1890.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*d-HOenhW3xTxSz_fH7_wPw.png"/></div></figure><p id="948b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我们需要提取这个<strong class="kj ja">记号</strong>来无缝导航到每只股票。</p><p id="fc08" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">使用BeautifulSoup和urllib，我提取了股票的价格和名称，并按字母顺序将它们存储在Pandas数据框架中。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="6d7e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">输出如下所示:</p><figure class="lt lu lv lw gt ka gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/0ecdb2f56f7f5f32464cfc30fc6c6cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*F_tOVYKCv0J9l6tnxY-AQg.png"/></div></figure><p id="47cf" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">现在转到新闻部分。为此，我们遵循与<strong class="kj ja"> get_ticks() </strong>类似的模式。与每只股票相关的新闻位于<strong class="kj ja">“ticker tape/stock-tick/news？核对表=基本&amp;ref =股票-概览_概览-栏目&amp;type =新闻"</strong>。同样，通过使用BeautifulSoup和urllib，我们可以提取这条新闻。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="4387" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">运行一个for循环，用数据帧的<strong class="kj ja"> tick </strong>列中的元素替换<strong class="kj ja"> stock-tick </strong>部分，我们可以提取每只股票的新闻，并将其存储在一个名为<strong class="kj ja"> <em class="mb"> news </em> </strong>的列表中。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="8a67" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">现在我们已经有了我们需要的新闻格式，我们可以继续进行情绪分析部分。</p><p id="75d9" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">财经新闻的情感分析</strong></p><p id="6bf3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">对于这个项目，我计划使用一个名为<strong class="kj ja"> FinBERT </strong>的预训练模型。</p><p id="889f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">FinBERT是一个专门设计用于财经新闻和文本的模型。这是一个基于BERT架构的模型。加上HuggingFace transformers库，FinBERT变得非常容易实现。</p><p id="3a07" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">关于伯特和芬伯特的更多细节，你可以参考我的博客:</p><p id="de90" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><a class="ae mc" href="https://medium.com/@ravirajshinde2000/financial-news-sentiment-analysis-using-finbert-25afcc95e65f" rel="noopener"> <strong class="kj ja">利用芬伯特进行财经新闻情绪分析</strong> </a></p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="832e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">现在FinBERT已经加载，我们开始分析过程。</p><p id="c63f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">由于FinBERT以数字格式返回情感，我们需要将输出映射到一种更加人性化的格式。为此，我们将创建一个名为labels的python字典。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="1a3b" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">好的部分来了。这里，我们使用tokenizer对象根据良好的NLP实践对文本进行预处理，然后将来自tokenizer的输出传递给finbert对象进行情感分析。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="4146" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我们对列表中的每只股票都这样做。每个标题的情绪都存储在一个列表中，这样我们以后可以将它们分组，以创建每只股票的总体情绪。我们将函数的输出存储在一个名为<strong class="kj ja"> tot_val </strong>的列表列表中。一些列表看起来是空的，因为网站上没有新闻。对于那些股票，我只是回归中性作为情绪。</p><p id="9ddd" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">最后，我们继续通过组合每只股票的每个标题的观点来创建观点的集合。为此，如果标题是正面的，我简单地将<strong class="kj ja"> +1 </strong>添加到<strong class="kj ja"> agg </strong>变量，如果标题是负面的，则添加<strong class="kj ja"> -1 </strong>。基于<strong class="kj ja"> agg </strong>变量的最终值，我给股票分配正、负或中性。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="6a21" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">最后，我们通过<strong class="kj ja"> get_sent() </strong>传递我们的情感列表，并获得总的情感。我们将这些情感存储在一个列表中，然后将它分配到我们原始的<strong class="kj ja"> tick_df </strong>数据帧的<strong class="kj ja">情感</strong>列中。</p><figure class="lt lu lv lw gt ka"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="3725" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">输出如下所示:</p><figure class="lt lu lv lw gt ka gh gi paragraph-image"><div class="gh gi md"><img src="../Images/30d9b6c5047880c7046b5cdbd6a20189.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*I_rnmB9FFnMJd-jkZSFiBQ.png"/></div></figure><p id="302c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">因此，我们成功地基于金融新闻为印度股票市场创建了一个情绪分析器。</p><ul class=""><li id="4757" class="lf lg iq kj b kk kl ko kp ks lh kw li la lj le me ll lm ln bi translated">本项目仅用于教育目的，不应用于投资决策。</li><li id="c5a8" class="lf lg iq kj b kk lo ko lp ks lq kw lr la ls le me ll lm ln bi translated"><strong class="kj ja">此外，本博客绝不是tickertape或博客中提到的任何其他实体的赞助</strong></li></ul><p id="3a1e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我的git档案中有完整的代码:</p><div class="mf mg gp gr mh mi"><a href="https://github.com/Raviraj2000/Realtime-Stock-News-Sentiment-Analyzer.git" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ja gy z fp mn fr fs mo fu fw iz bi translated">GitHub-ravi Raj 2000/实时股票新闻情绪分析器</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">在GitHub上创建一个帐户，为ravi Raj 2000/实时股票新闻情绪分析器的开发做贡献。</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">github.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw kf mi"/></div></div></a></div><p id="6256" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">感谢阅读！😄</p></div></div>    
</body>
</html>