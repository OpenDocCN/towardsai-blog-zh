<html>
<head>
<title>Towards Artificial Intelligence — Overcoming Data Challenges</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">走向人工智能——克服数据挑战</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/a-data-scientists-guide-to-data-preprocessing-part-i-91ed80d920ef?source=collection_archive---------2-----------------------#2022-03-11">https://pub.towardsai.net/a-data-scientists-guide-to-data-preprocessing-part-i-91ed80d920ef?source=collection_archive---------2-----------------------#2022-03-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2c21" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">多种多样的杂乱数据及其修复</h2></div><p id="191e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“<em class="lb">数据挖掘就是我的就是我的，你的也是我的”</em>，悉尼·布雷内</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/2444a5d91fdfbce998acd611773b9f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lRwJ9vdFD1zlpZLlR0ADTg.jpeg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">使用数据预处理工具箱通常很关键(来源:Anete-Lusina，pixels)</figcaption></figure><p id="a31d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从数据不足和缺失值到不平衡和异常值，准备好数据机器学习(ML)是至关重要的。其中一些数据清理或预处理步骤的范围有限，仅适用于特定场景或特定数据类型。其他的是更通用和广泛适用的概念。</p><p id="ef8a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> I .规模很重要，即使在数据科学领域也是如此</strong></p><p id="5d55" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当涉及到创建预测性机器学习(ML)模型以很好地推断新数据时，您需要大量良好、干净的数据。反过来，可访问的训练数据的大小将在一定程度上决定您可以建立的模型的类型——可解释与反箱、线性与非线性、可实现的非线性程度，以及最终其预测外推至其训练期间从未见过的数据的程度。</p><p id="2ff6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">考虑到这一点，有时将数据科学项目视为属于不同的“数据经济”层是有用的，每个层都由数据大小的任意界限来设定:</p><blockquote class="ls lt lu"><p id="ea3c" class="kf kg lb kh b ki kj jr kk kl km ju kn lv kp kq kr lw kt ku kv lx kx ky kz la ij bi translated">在数据世界里，有数据亿万富翁、数据百万富翁，但也有穷困潦倒的数据“百富翁”和数据“十富翁”。在我攻读生物医学博士期间，我很大程度上属于后一类——一个不幸的数据匮乏者，不断试图获取更多的数据</p></blockquote><p id="10cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有什么解决方案来处理几乎没有足够的数据来训练你的ML模型？</p><p id="7589" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然“不够”数据的定义模糊不清，但通常情况下，观察数据的数量(以患者为例)比变量或特征的数量(以患者年龄、性别、身高、体重为例)要多得多。</p><p id="133a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是看看是否有更多的可用数据。这很可能需要克服获得它的障碍，或者与它的产生相关的成本(比如在实验室或野外进行更多的实验)。不管你的额外数据收集追求的结果如何，应用数据扩充是有价值的，尤其是图像。</p><p id="667b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了在计算机视觉中建立分类器或对象检测模型，图像增强通常会增加价值。有多种途径来增加现有的图像数据:<a class="ae ly" href="https://link.springer.com/article/10.1186/s40537-019-0197-0?code=a6ae644c-3bfc-43d9-b292-82d77d5890d5" rel="noopener ugc nofollow" target="_blank">以多种方式转换图像</a>捕捉额外的不同观点，使用<a class="ae ly" href="https://towardsdatascience.com/implementing-generative-adversarial-networks-gans-for-increasing-a-convolutional-neural-networks-f871e17fe271" rel="noopener" target="_blank">生成对抗网络(GANs)来合成更多的数据</a>使用现有的图像作为种子，或者有时只是复制粘贴现有的图像。这可以搭配创意ML模型训练。通常，我们使用某种形式的转移学习或微调来利用在其他不相关的大型图像数据集上构建和优化的预训练人工神经网络。这种微调预训练模型的一个典型例子是<a class="ae ly" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> ResNets </a>和几个候选人可以在<a class="ae ly" href="https://modelzoo.co/" rel="noopener ugc nofollow" target="_blank">模型动物园</a>找到。几个小组已经报告了<a class="ae ly" href="https://journalofbigdata.springeropen.com/articles/10.1186/s40537-016-0043-6" rel="noopener ugc nofollow" target="_blank">使用这种数据扩充结合迁移学习方法的破纪录结果</a>。</p><p id="bca7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种数据扩充解决方案对结构化的表格数据同样有效吗？(结构化数据具有定义的特征或列，每个特征或列都有不同的含义，例如房子的大小、房间的数量等)。最近在这个领域有一些研究，一些创新的解决方案似乎有效。然而，对于表格数据，您必须在很大程度上依赖于在模型训练级别解决数据不足的问题，并且仅对模型的广泛适用性做出谨慎乐观的声明。</p><p id="665e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于只有几十行的结构化表格数据，通常工作良好的ML模型是线性模型及其正则化表兄弟(如lasso、ridge或elastic net)的版本。</p><p id="b466" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">二。数据及其不平衡性</strong></p><p id="a949" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在他最近的一次演讲中，吴恩达强调了数据质量比数量更重要。延伸一下，<em class="lb">初步看来</em>，看起来你可以访问数万甚至数百万的数据观察。但是，如果大部分数据或图像文件只属于一种或一类，那么在庞大的多维数据宇宙中，只有很小一部分被采样。有了这样的图像数据集，我们之前讨论过的那种数据转换将部分抵消这个问题。</p><p id="77cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结构化的表格数据，其行(=数据观察值)只属于一个类(我们这里说的是机器学习分类器模型)，将保证重新调整或重新平衡。有几种方法可以解决这种数据不平衡的问题，目标是用来自所有不同类的实例同等地训练ML模型。</p><p id="9082" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，欠采样方法从主要类别中无用的行(例如，来自正常、健康个体的数据)，或者过采样方法合成较少代表类别的额外行(例如，来自人群中糖尿病患者的数据)。混合技术使用不同比例的过采样和欠采样。这些优雅的数据重平衡方法中的绝大多数都是在python包<a class="ae ly" href="https://imbalanced-learn.org/stable/" rel="noopener ugc nofollow" target="_blank">不平衡学习</a>中实现的。令人鼓舞的是，这个包可以与最流行的基于python的ML工具箱<a class="ae ly" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>无缝协作，并且正在积极开发中。</p><p id="5eb1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">三世。价值缺失问题</strong></p><p id="e80d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">具有多个字段或要素的结构化表格数据可能包含不同比例的缺失值或空值。解决数据中的这种空白，没有一个ML算法会接受它作为输入，通常需要复杂的技巧。</p><p id="8823" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果在一个字段或行中有太多的缺失值，比如75%或更多，直接的解决方法是删除或丢弃有问题的行或列。告诫是，“如果你能负担得起的话”。例如，如果有很大一部分值缺失的列恰好对您的预测或模型很重要，那么它就需要被回收。这种永不删除的数据特征和那些只包含一小部分缺失值的数据特征可以从仔细的数据插补中受益。</p><p id="3eb8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，一些特征中缺失值存在的原因可能是已知的。例如，希望隐藏其社会行为方面的人比其他人更有可能留下部分数据生成问卷未填写。这种知识可以用来主观地填充这种缺失的值字段。</p><p id="a5eb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分类和连续值数据列都有几种插补或<a class="ae ly" href="https://link.springer.com/article/10.1007/s10462-019-09709-4" rel="noopener ugc nofollow" target="_blank">数据填充方法。缺失的类别值最好通过将NA映射到不同的类别或级别来弥补。对于连续值，计算训练数据剩余值的某种平均值并使用它来估算缺失值通常非常有效。</a></p><p id="f91d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，在更高的复杂程度上，有一些软件包可以让你<a class="ae ly" href="https://pypi.org/project/missingpy/ ." rel="noopener ugc nofollow" target="_blank">预测</a>并通过在其他特性上应用ML方法来估算缺失值。</p><p id="ba7f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">四世。用未标记数据训练ML模型</strong></p><p id="30cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个完全不同的挑战是没有标签。运行到数万甚至数百万行的大型数据集可能没有标签。在没有目标变量Y标签的情况下，训练ML模型有意义吗？嗯，是也不是。在大量未标记点中至少有少量标记数据的数据集中，<a class="ae ly" href="https://www.morganclaypool.com/doi/abs/10.2200/S00196ED1V01Y200906AIM006" rel="noopener ugc nofollow" target="_blank">半监督学习</a>是一个可行的选择。</p><p id="c5c7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用未标记数据的另一种方法，特别是如果它是图像或文本(情感预测)，是请求注释或标记。只要能够满足预算和数据隐私的考虑，在亚马逊MTurk 上众包图像或文本标签任务是可行的。也有越来越多的公司提供定制的数据标签服务。</p><p id="7792" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">非监督学习是一种间接但潜在有用的尝试，可以用未标记的数据来完成。虽然这很少产生任何目标变量预测，但它很可能揭示数据中开创性的、深刻的内在结构。零售数据集中客户群或聚类的存在说明了这个问题。</p><p id="7788" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">五、离群值是数据世界的坏鸡蛋</strong></p><p id="d2ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后但绝不是最不重要的，经常遇到的数据挑战是数据中异常值的存在。这些代表了数据巢的“坏鸡蛋”。要扔掉这些坏鸡蛋，一个三管齐下的策略通常是有效的— (a)检测异常值，(b)尝试理解创建它们的过程，以及(c)决定如何处理它们。</p><p id="485f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在单变量或单一特征数据的情况下，极大或极小的值通常构成异常值。有正式的方法来寻找<a class="ae ly" href="http://d-scholarship.pitt.edu/7948/1/Seo.pdf" rel="noopener ugc nofollow" target="_blank">这样简单的异常值</a>。但是对于多维数据，检测异常值突然变得具有挑战性，因为<a class="ae ly" href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-019-0737-5" rel="noopener ugc nofollow" target="_blank">在最佳技术上没有普遍接受的共识</a>。一种合理的主观方法包括使用主成分分析(PCA)压缩特征列，然后绘制前两个或三个主成分，以直观地发现任何异常值。</p><p id="5584" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还存在基于<a class="ae ly" href="https://wis.kuleuven.be/statdatascience/robust/papers/2011/rousseeuwhubert-robuststatisticsforoutlierdetectio.pdf" rel="noopener ugc nofollow" target="_blank">线性模型</a>的标准统计方法。偏离平均值几个标准偏差的模型残差或误差可能表明存在异常值。如果您正在寻找一个基于python的软件工具箱来完成所有这些工作，<a class="ae ly" href="https://www.jmlr.org/papers/volume20/19-011/19-011.pdf?ref=https://githubhelp.com" rel="noopener ugc nofollow" target="_blank"> PyOD </a>提供了一个有意义的起点。</p><p id="6e69" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或许，真正有用但有时有点哲学意味的一步是下一步——调查异常值的来源。例如，在数字表中发现无意义的字符串或其他奇怪的字符可能表示数据输入错误。但是，真正的异常值不是简单的测量误差。相反，这些意味着“很少发生”的价值观，原因可能不明显。异常值检测的一种形式，称为异常检测，用于识别欺诈交易或虚假产品列表。</p><p id="0129" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第三步，在发现这样一堆神秘的离群值后，你到底能做什么？一个显而易见的解决方案是删除它们，然后继续处理剩余的(希望是干净的)数据。另一个是<a class="ae ly" href="https://en.wikipedia.org/wiki/Winsorizing" rel="noopener ugc nofollow" target="_blank"> winsorize极值</a>。进行winsorize时，选择一个阈值，如90 %,然后通过将其余值设置为阈值内的最高值来修整它们。</p><p id="a8de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">处理离群值的另一种方法是<a class="ae ly" href="https://www.statology.org/remove-outliers/" rel="noopener ugc nofollow" target="_blank">假装它们不存在，并继续使用它们</a>。不管是好是坏，一些最大似然模型比其他模型更少受到极值存在的影响。很多时候，魔鬼就在细节中，很难找到一个放之四海而皆准的方法来发现和处理异常值。老生常谈，不足为奇，经验为王。</p><p id="589c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了上面讨论的与数据相关的问题，有时可能需要标准化、规范化和转换表格和图像数据，过滤信噪比等。其中许多是特定于图像、视频、文本和表格的。这些及其解决方案将在本文的第二部分深入讨论。</p></div></div>    
</body>
</html>