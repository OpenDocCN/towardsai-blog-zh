# 长出牙齿

> 原文：<https://pub.towardsai.net/growing-teeth-e3c6a947fbb3?source=collection_archive---------2----------------------->

## 牙齿生长数据集的贝叶斯分析。

为了表明贝叶斯分析真的没有那么难，或者与我们人类处理(新)信息的方式相差甚远，我已经发布了几个贝叶斯分析。在已知的数据集上，比如 [Iris](/good-old-iris-93358b8ecdbd) 、 [Chickweight](https://medium.com/mlearning-ai/mixed-models-of-chicks-weight-a41413c99b51) 、 [MTcars](https://medium.com/mlearning-ai/mtcars-f68f02c29a2) 或者 [Rent99](https://medium.com/mlearning-ai/determining-the-rent-d1431c90ca9f) 。今天，我将展示我如何分析一个名为 ABC 的模拟数据集。这没什么稀奇的，但也不尽然。贝叶斯定理创造了奇迹，尤其是在小样本中，它的力量来自于当前数据集之外。这就是为什么使用贝叶斯分析总会比任何一种最大似然法告诉你更多。记住，这都是关于条件概率的。

在这篇文章中，我将应用我之前已经应用过的东西，但接下来是关于牙齿生长的数据集，它显示了维生素 C 对豚鼠牙齿生长的影响。这是一个已经在各种媒体上的许多帖子中使用过的数据集，我确信在某处有贝叶斯分析，但无论如何我会尝试继续下去。请结合我写的其他文章阅读这篇文章。我相信你会发现它们相当连贯，因此有助于学习如何应用贝叶斯定理。如果不是，请告诉我！

顺便说一句，我把代码放在了最后，这样我可以更好地讲述这个故事。不是我做的每件事都在帖子里，而是在代码里。尽情享受吧！

那么，我们要对付的是什么？嗯，正如你在下面看到的，我们有牙齿的**长度**，应用的**补充**(*OJ*vs*VC*)，以及**剂量**。实际上不会超过这个数，而且数据集非常小。

![](img/72ff63b075752dd24bfba9f6f7935db0.png)![](img/fa103074f01e5a15eba3090f3dff1fcd.png)

两个图显示了同样的事情，但是一个有 p 值[，一个没有 p 值](https://medium.com/mlearning-ai/inference-estimates-p-values-and-confidence-limits-a-frequentist-approach-acdd45d94bd5)。

r 有许多函数可以让最基本的数据看起来像火箭科学。为了向你展示这些情节有多荒谬，以及你可以给一个简单的图表添加多少数字色情，这里有一些例子。这些数字一点帮助都没有，会让你相信从这么小的样本中可以提取出比实际情况更多的东西。

![](img/cca83cbd75b413a831c8637012b7f284.png)![](img/4b76517838d961cf85bd7fcfdd50be9c.png)![](img/00b36f5a4c06eeddc56ca77e425b8908.png)![](img/9c111c5b994653abe323c22b2cfd151e.png)![](img/e67eefad94d993f9a47ec84a65b99680.png)![](img/088a7e84abc669f00401512d36db2572.png)

六个情节告诉你比看起来要少得多的东西。不要使用它们。在分析数据时，坚持你的基本原则，即将先前的知识与当前的数据结合起来，形成一个新的知识库。你不需要 p 值。

![](img/62a75927be5c781ef91e5559dc24fadf.png)

当然，在 R 中也一样，你 p 值化你看到的一切。请不要。相信我，我也这样做了很多年，并且可能在不久的将来会再次这样做，因为合作者的客户想要什么，但是每个图表顶部的 p 值绝对没有增加你也可以通过运行贝叶斯分析获得的任何东西。

![](img/eea098b369f116974632b0cc6a19bdf7.png)

获得 p 值在 r 中是轻而易举的事。

下面，我做了六个图，左边是一个带数值的方框图，右边是一个显示密度的密度图。p 值当然也依赖于 p 值，但是我希望你们熟悉右边的图，而不是左边的。箱线图是最容易制作的图之一，但是在贝叶斯分析中，它是关于密度图的。

![](img/e6ac30b2013fa0bf3e5c1c43d3e06188.png)![](img/cf9f5681d150c469dd60b91a7cf4bc51.png)![](img/321d3c6e962a10a37e3b7f174022ba41.png)![](img/a291633b4f8e981c0612219078044c8c.png)![](img/bf1ba519caef3a1f1fb8b43aa1942b1b.png)![](img/2fbeca1f5ae12d2b96c4ed1b013589fe.png)

左边是带 p 值的方框图，右边是密度图。它们展示了完全相同的东西。使用密度图会遇到的唯一危险是，对于小样本，峰值是异常的。它们并不代表多项式数据，或[混合物](https://blog.devgenius.io/mixture-component-zero-inflated-and-hurdle-models-44c5e6fe5d7f)，而只是一个小数据集。

让我们继续实际的建模部分。数据集很小，也不令人兴奋，所以这更像是一篇技术文章，展示了 R 中用于贝叶斯分析的函数。下面，我用的是 [**rstanarm**](https://mc-stan.org/rstanarm/) ，虽然我个人最喜欢的是 [**brms**](https://cran.r-project.org/web/packages/brms/vignettes/brms_overview.pdf) 。两者都使用 [STAN](https://mc-stan.org/) 进行采样，并通过编译器与 STAN 通信。

![](img/7864cb59e6cb2fcbb13e26b084bb3e21.png)

如果我自己没有指明先验，我将自动获得查看先验的代码，以及我用来分析数据集的模型。如你所见，我的模型有一些有用的先验知识，尤其是在截距中。

![](img/9127d5d34abd5559f9b892c1e856ba30.png)![](img/224ef9a298ee0b61a15d9a42a72a981e.png)

左图:如果我什么都不做，先验来自数据，这只不过是可能性分析。以及我之前指定的概要。右图:来自模型的后验分布。

![](img/e49423d876979067046ad20a786b4ff8.png)![](img/ddfee3175c85531b301f9e268e7313d4.png)

左图:来自后验模型的总结。注意 7.7 的截距是如何偏离我之前的 7 的。这不是一个很大的区别，但它是一个区别。当然，7.7 在我之前提到的变化范围之内，但是仍然。右图:每个采样参数的后验分布。

![](img/42487c5738c915006be8894e43b22511.png)

这是每次分析最重要的图——显示取样过程的链。他们应该收敛。

现在，让我们做一些额外的分析，检查如何采样时，并比较后验概率。我不能强调指出可能性和后验概率的偏离是多么重要。没问题，没问题。

![](img/eaa69176a040d799ca240fb574391fe0.png)![](img/a120e3852e32b0ace734e18435a21b84.png)![](img/c40b6be5f96393545153ab5abb98815c.png)![](img/d266c181589122fb1c480dbadd54cbf1.png)

看起来不错。记住，寻找抽样空间，而不是可能性和后验概率之间的重叠。

![](img/3dd57aa214479c4c2cc72906ebe28684.png)

后验值叠加在观察到的反应上。

![](img/cf515a2f7ed4e7bb3c239996d55b6e57.png)

剂量、补充和长度之间的关系来自数据(点)和模型(线)。看起来不错。如果你相信你的先验是合理的，这就是你在数据中看到的，那么这就是你得到的。如果后验不与数据重叠，不要更改前验。坚持你的选择。这是科学。

![](img/374a0e8c1e287a9764ab9bbf861394bc.png)![](img/2eeaa954215ab569393ece515ab866f4.png)

当然，我可以要求模型向我显示特定类别的值的分布，这里是当剂量= 1.8 且 supp = OJ 时的长度(左图)，以及当剂量= 1.8 时每个 supp 的长度(右图)。我还添加了不同之处。如您所见，零是一种可能性，因此对于 1.8 的剂量，每次补充的长度没有差异。

![](img/5187e149f99f566300d9bfddae89847f.png)

模型预测能力的摘要。不应该真的与你有关。

![](img/8a38a053e78c6cbdaf7ccd0589b2f5a8.png)

交叉验证的预测摘要。应该也不关你的事。贝叶斯建模不是为了能够很好地预测。它是关于整合我们知道的、我们收集的和我们现在知道的。这总是比预期的少

在前面的例子中，我将*剂量*建模为一个数字变量。你当然也可以把这个变量作为一个因素。对于这个例子，我使用了 brms。你能看到的是来自模型的先验，如果我没有指定，和我使用的先验。我的病史表明，与剂量 0 相比，剂量 1 和剂量 2 之间没有差异。还有，补品之间没有区别。因此，我的先验知识使我不期望任何东西，我想看看它如何与最新的数据集相一致。

![](img/b784d386cd8974cbd3163dec97997899.png)![](img/aa302fcb5539a9318557452e72322bea.png)![](img/ed6c6c6684aea9c930a8182a60fbd7c7.png)![](img/ae3cc301dcb844342b4def2209b2b41d.png)![](img/780a51bdec25c774655e1eadfb906c1b.png)

如你所见，后验肯定与先验不一致，而先验与数据息息相关。因此，我先前的知识，结合最新的数据，将改变知识库。

![](img/6d82e934dc29c8213a1321e977cf3e75.png)

每种剂量和补充剂的后验分布。

另一个模型中，我改变了作为数字变量的分析剂量，并改变了先验。这完全是儿戏，但找到先知却不是。由于我对豚鼠一无所知，从统计学上来说，我的先验知识可以提供信息，但它本身并没有坚实的基础。

![](img/dd34fa42c3b8ed3f888e53533618dd0f.png)

新型号。

![](img/7fd2931d1574713cd2ccfbdc4d0d9d9f.png)

来自 **brms** 模型的先验，如果我没有指定任何东西和我自己的先验。

![](img/92004ec28cf384d5995981f3efd10cf9.png)

后验分布。如你所见，后验不等于先验，而先验并不需要如此。

![](img/d32a4d12c7bafda4f5e4bc7413e60f60.png)![](img/d41ec1f97c5151b38a97cbb2f414a008.png)

supp = VC 的每个链的分布。看起来不错！

另一个模型，我们把所有的参数放在模型的随机部分。因此，我们有一个贝叶斯[混合模型](https://medium.com/mlearning-ai/introduction-to-mixed-models-in-r-9c017fd83a63)，这有点自相矛盾。如果你知道为什么你想出贝叶斯分析！(*提示:在贝叶斯分析中，所有的参数都被认为是随机和可变的*)。

![](img/36d8b57d2d40fd645668474a252d115d.png)

我的前科。

![](img/2ff5ed31598cb95b0efc45b031779423.png)

我所做的和如果我什么都不做会做的区别。

![](img/d83088175f79f8de4a02717b417ad159.png)

结果呢。寻找这些先验和后验之间的差异。指标看起来不错。rhat = 1 告诉我链收敛了。

![](img/72ebb23fe8c41bc46c8901cb7da6fdc4.png)

画出后验分布。

![](img/cd553f75d208d8c937a052fd1b5cca98.png)![](img/66be4eb866a2a7dc56bc857764b9a77d.png)

画出不同之处。如果包含零，则不可能有差异。

![](img/4c4a1c4edb09126ead79532e5d7a9762.png)![](img/56967a56cf9b34775501aeed38f7b28d.png)

画出不同之处。如果包含零，则不可能有差异。

最后但同样重要的是，预测来自贝叶斯模型。色带和点都显示了后验分布。这些图向您展示了建模在总体上是多么变化无常——只要看看剂量变量中没有数据可用的部分。插值规则，这一直是一个弱点。

![](img/7720038b85efbca71bcd381d72c69680.png)![](img/a5ab1d7953acab5878c178ec34bc818b.png)

我希望你喜欢这篇文章！如果有什么不对劲，请告诉我！