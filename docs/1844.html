<html>
<head>
<title>Building RESTful APIs using Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flask构建RESTful APIs</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/building-restful-apis-using-flask-8ba2716d361f?source=collection_archive---------3-----------------------#2021-05-13">https://pub.towardsai.net/building-restful-apis-using-flask-8ba2716d361f?source=collection_archive---------3-----------------------#2021-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3fd1" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="89d7" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">Python中的轻量级Web框架</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4b3e58b1347cde96dd2d9ef060a700a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0OwVytyiWBb896OCJ1fgg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://github.com/pallets/flask/blob/master/artwork/logo-full.svg" rel="noopener ugc nofollow" target="_blank">烧瓶</a>框架<a class="ae le" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">框架</a></figcaption></figure><p id="9d52" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">什么是API？</em>T9】</strong></p><blockquote class="mc md me"><p id="4b0a" class="lf lg mb lh b li lj ka lk ll lm kd ln mf lp lq lr mg lt lu lv mh lx ly lz ma ij bi translated">应用程序编程接口(API)是允许两个应用程序进行通信的软件中介。</p></blockquote><p id="a0bb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">什么是web框架，为什么有用？</em>T13】</strong></p><p id="3a09" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">web框架是一种软件框架，创建它是为了支持动态站点、web服务和web应用程序的开发。web框架是一个代码库，它通过提供构建可靠、可伸缩和可维护的web应用程序的基本模式，使web开发变得更快更容易。</p><p id="9d1b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">烧瓶:简介</em> </strong></p><p id="8d32" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="mb">Flask</em><strong class="lh ja"><em class="mb"/></strong>是一个轻量级的WSGI web应用框架。它旨在快速轻松地开始使用，并能够扩展到复杂的应用程序。它最初是一个简单的包装器，围绕着<em class="mb"> Werkzeug </em>和<em class="mb"> Jinja </em>，现在已经成为最流行的Python web应用程序框架之一。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/0fb2e8176b6bb065f3741a6672552dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xzPzSwwNhnw6g9PflDj-5w.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上个月的包下载数量。<a class="ae le" href="https://pypistats.org/" rel="noopener ugc nofollow" target="_blank">来源</a>。</figcaption></figure><p id="28a8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">为什么是微框架？</em> </strong></p><blockquote class="mc md me"><p id="3121" class="lf lg mb lh b li lj ka lk ll lm kd ln mf lp lq lr mg lt lu lv mh lx ly lz ma ij bi translated">“微型”并不意味着您的整个web应用程序必须适合一个Python文件(尽管它确实可以)，也不意味着Flask缺乏功能。微框架中的“微”意味着Flask旨在保持核心简单但可扩展。</p></blockquote><p id="bcbf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Flask提供建议，但不强制任何依赖或项目布局。由开发人员来选择他们想要使用的工具和库。社区提供了许多扩展，使得添加新功能变得容易⁴.</p><p id="f8b1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">为什么要用烧瓶？</em> </strong></p><ul class=""><li id="b448" class="mj mk iq lh b li lj ll lm lo ml ls mm lw mn ma mo mp mq mr bi translated">易于设置</li><li id="91bb" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">简约主义</li><li id="a6bd" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">灵活地添加更多功能的扩展</li><li id="1176" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">活跃社区</li></ul></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="c54e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本文中，我将演示如何设置、构建和运行一个简单的Flask应用程序。</p><p id="9159" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">包安装</em> </strong></p><p id="e494" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通常建议在特定于项目的虚拟环境中安装软件包。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="8afb" class="nj nk iq nf b gy nl nm l nn no"># command prompt<br/><strong class="nf ja">pip</strong> install Flask</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi np"><img src="../Images/46657f25ac96285fbd8104aef87b209a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZSZuv6qH-GhmHGhSG1ucA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">安装烧瓶组件</figcaption></figure></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="1b54" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb"> JSON </em> </strong></p><p id="48c3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">JSON是一种通用数据格式，具有最少数量的值类型:字符串、数字、布尔值、列表、对象和null。尽管符号是JavaScript的一个子集，但是这些类型在所有通用编程语言中都有表示，这使得JSON成为跨越语言鸿沟传输数据的一个很好的选择⁵.</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="a773" class="nj nk iq nf b gy nl nm l nn no"># JSON Example:<br/>{<br/>"id" : 1,<br/>"name" : "john"<br/>"age" : "25",<br/>"activities" : ["cricket","football"],<br/>"class" : [{"year":"2020","dept":"CSE"}]<br/>}</span></pre><p id="989b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">打造烧瓶App </em> </strong></p><p id="ceba" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我将使用Flask构建一个简单的应用程序，它将访问员工数据并返回输入中请求的信息。我们将使用<em class="mb"> JSON </em>文件格式发送和接收数据。因为我将给出一个基于数据的演示，所以我也加载了<em class="mb">熊猫</em>包。</p><ol class=""><li id="acb4" class="mj mk iq lh b li lj ll lm lo ml ls mm lw mn ma nq mp mq mr bi translated">导入所需的包</li></ol><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="fb99" class="nj nk iq nf b gy nl nm l nn no"><strong class="nf ja">from </strong>flask <strong class="nf ja">import </strong>Flask, request, jsonify <br/><strong class="nf ja">import</strong> pandas as pd</span></pre><p id="7581" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该项目的目录结构如下</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="0f79" class="nj nk iq nf b gy nl nm l nn no">Demo/<br/>| — emp_info.csv<br/>| — emp_status.csv<br/>| — app.py</span></pre><p id="d685" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">2.创建应用程序实例</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="9d3f" class="nj nk iq nf b gy nl nm l nn no">app = Flask(__name__)</span></pre><p id="825a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">3.使用<code class="fe nr ns nt nf b">.route()</code>和<code class="fe nr ns nt nf b">POST</code>、<code class="fe nr ns nt nf b">GET</code>等公认的方法声明终点。默认情况下，它只监听<code class="fe nr ns nt nf b">GET</code>方法。让我们为这个API启用<code class="fe nr ns nt nf b">POST</code>方法。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="1faf" class="nj nk iq nf b gy nl nm l nn no">@app.route(<strong class="nf ja">"/get_emp_info"</strong>, methods = [<strong class="nf ja">'POST'</strong>])</span></pre><p id="7bf9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">4.定义应用程序将执行的功能。基于输入数据从CSV文件中检索员工数据。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="c06f" class="nj nk iq nf b gy nl nm l nn no">@app.route(<strong class="nf ja">"/get_emp_info"</strong>, methods = [<strong class="nf ja">'POST'</strong>])<br/><strong class="nf ja">def </strong>get_employee_record():<br/>    input_data = json.loads(request.get_json())<br/>    ids = input_data[<strong class="nf ja">'</strong>emp_ids<strong class="nf ja">'</strong>]<br/>    status = input_data[<strong class="nf ja">'</strong>status<strong class="nf ja">'</strong>]<br/>    emp_info = pd.read_csv(<strong class="nf ja">'</strong>emp_info.csv<strong class="nf ja">'</strong>)<br/>    emp_status = pd.read_csv(<strong class="nf ja">'</strong>emp_status.csv<strong class="nf ja">'</strong>)<br/>    emp_status = emp_status[(emp_status[<strong class="nf ja">'</strong>emp_no<strong class="nf ja">'</strong>].isin(ids)) &amp;     (emp_status[<strong class="nf ja">'</strong>status<strong class="nf ja">'</strong>].isin(status))]<br/>    emp_info = emp_info[emp_info[<strong class="nf ja">'</strong>emp_no<strong class="nf ja">'</strong>].isin(emp_status[<strong class="nf ja">'</strong>emp_no<strong class="nf ja">'</strong>])]<br/>    emp_info = pd.merge(emp_info,emp_status,on=<strong class="nf ja">'</strong>emp_no<strong class="nf ja">'</strong>,how=<strong class="nf ja">'</strong>left<strong class="nf ja">'</strong>)<br/>    out_data = emp_info.to_dict(orient=<strong class="nf ja">'</strong>records<strong class="nf ja">'</strong>)<br/>    <strong class="nf ja">return </strong>jsonify(out_data)</span></pre><p id="c713" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"><em class="mb">jsonify</em></strong><em class="mb">()</em>是Flask提供的一个helper方法，用来正确返回<em class="mb"> JSON </em>数据。它返回一个设置了application/json mimetype的响应对象。</p><p id="14b8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">5.将Python应用程序设置为在本地开发服务器上运行。默认情况下，调试模式为<em class="mb">假</em>。为了在修改代码时重启服务，可以将调试模式设置为<em class="mb">真。</em></p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="a1d9" class="nj nk iq nf b gy nl nm l nn no"><strong class="nf ja"># </strong>Setting port number and host i.e., localhost by default<strong class="nf ja"><br/>if __name__</strong> == <strong class="nf ja">"__main__"</strong>:<br/>    app.run(<strong class="nf ja">host</strong>=<strong class="nf ja">'</strong>0.0.0.0<strong class="nf ja">'</strong>, <strong class="nf ja">port</strong>=6123)</span></pre><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Python Flask应用程序</figcaption></figure><p id="bbb6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">6.在本地服务器上运行Python程序</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="e651" class="nj nk iq nf b gy nl nm l nn no"># command prompt<br/><strong class="nf ja">python</strong> app.py</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/48fa6c08726b7e14820ac581b8914fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbBkf2T8x6nKlNisydDozA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">运行Python应用程序</figcaption></figure><p id="3eb8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">测试应用</em> </strong></p><p id="e2ef" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">使用<em class="mb">请求</em>包向开发的应用程序发送<code class="fe nr ns nt nf b">POST</code>请求。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="7cff" class="nj nk iq nf b gy nl nm l nn no"># command prompt - installing requests package<br/>$ <strong class="nf ja">pip</strong> install requests</span><span id="6c4f" class="nj nk iq nf b gy nx nm l nn no"># Python code to test<strong class="nf ja"><br/>import </strong>requests, json<br/># sample request<br/>data = {"emp_ids":["1001","1002","1003"],"status":["active"]}<br/># Hitting the API with a POST request<br/>ot = requests.post(url=<strong class="nf ja">'http://localhost:6123/get_emp_info'</strong>, json=json.dumps(data))<br/>print(ot.json())</span><span id="aa89" class="nj nk iq nf b gy nx nm l nn no"># Response JSON <br/>[{<br/> 'cmp': 'ABC',<br/> 'emp_no': 1001,<br/> 'name': 'Ben',<br/> 'salary': 100000,<br/> 'status': 'active'<br/>}, {<br/> 'cmp': 'MNC',<br/> 'emp_no': 1002,<br/> 'name': 'Jon',<br/> 'salary': 200000,<br/> 'status': 'active'<br/>}]</span></pre></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="d7e5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">汇总</em> </strong></p><p id="9a44" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们在本文中涉及的概念:</p><ul class=""><li id="0197" class="mj mk iq lh b li lj ll lm lo ml ls mm lw mn ma mo mp mq mr bi translated">API和Web框架</li><li id="2f09" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">烧瓶介绍</li><li id="0d91" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">设置烧瓶环境</li><li id="30b1" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">构建烧瓶API</li><li id="bee4" class="mj mk iq lh b li ms ll mt lo mu ls mv lw mw ma mo mp mq mr bi translated">使用<em class="mb">请求</em>包测试带有请求的Flask API</li></ul><p id="19f6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Flask就像构建RESTful APIs的极简主义方法。</p><blockquote class="ny"><p id="7a3d" class="nz oa iq bd ob oc od oe of og oh ma dk translated">总是简单产生奇妙。—阿米莉亚·巴尔</p></blockquote><p id="ac78" class="pw-post-body-paragraph lf lg iq lh b li oi ka lk ll oj kd ln lo ok lq lr ls ol lu lv lw om ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb">包装完毕</em> </strong></p><p id="ac52" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">感谢所有走到这一步的人。我希望这篇文章对你有所帮助。请在评论中分享您的反馈/疑问。现在，是时候让您从头开始构建自己的API了。祝你好运！</p><p id="1b3c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="mb">如果你觉得这篇文章很有趣，并且对数据科学、数据工程或软件工程充满热情，点击</em> <a class="ae le" href="https://medium.com/@mahadeveaswar" rel="noopener"> <em class="mb">关注</em> </a> <em class="mb">并随时在</em><a class="ae le" href="https://www.linkedin.com/in/mahadeveaswar/" rel="noopener ugc nofollow" target="_blank"><em class="mb">LinkedIn</em></a><em class="mb">上添加我。</em></p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="4e79" class="nj nk iq nf b gy nl nm l nn no">REFERENCES:<br/>1. <a class="ae le" href="https://www.goodfirms.co/glossary/web-framework/" rel="noopener ugc nofollow" target="_blank">https://www.goodfirms.co/glossary/web-framework/</a><br/>2. <a class="ae le" href="https://pypistats.org/" rel="noopener ugc nofollow" target="_blank">https://pypistats.org/</a><br/>3. <a class="ae le" href="https://flask.palletsprojects.com/" rel="noopener ugc nofollow" target="_blank">https://flask.palletsprojects.com/</a><br/>4. <a class="ae le" href="https://github.com/pallets/flask" rel="noopener ugc nofollow" target="_blank">https://github.com/pallets/flask</a><br/>5. <a class="ae le" href="https://www.infoworld.com/article/3222851/what-is-json-a-better-format-for-data-exchange.html" rel="noopener ugc nofollow" target="_blank">https://www.infoworld.com/article/3222851/what-is-json-a-better-format-for-data-exchange.html</a></span></pre></div></div>    
</body>
</html>