<html>
<head>
<title>Fully Explained DBScan Clustering Algorithm with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python全面解释DBScan聚类算法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/fully-explained-dbscan-clustering-algorithm-with-python-a568139ebff5?source=collection_archive---------0-----------------------#2021-02-26">https://pub.towardsai.net/fully-explained-dbscan-clustering-algorithm-with-python-a568139ebff5?source=collection_archive---------0-----------------------#2021-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="97c1" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="9d6c" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">基于密度聚类的机器学习中的无监督学习</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi kr"><img src="../Images/4d1bbc273fa7f9547661759984da1cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*MP0ZCqyW9vPYQCGfs8G-Cg.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">无监督学习中的聚类。作者的照片</figcaption></figure><p id="5f63" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在本文中，我们将讨论基于机器学习的聚类算法，即DBScan聚类。该聚类算法中方法是基于密度的，而不是另一种基于距离的方法。另一个基于距离的聚类寻找数据点中的接近度，但是如果该点属于另一个类，也会分类错误。因此，基于密度的聚类适合这种情况。聚类算法来自无监督学习，在这种学习中，我们不依赖于目标变量来形成聚类。</p><p id="5cea" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在集群中，主要关注的是最大密集连接点。基于密度的聚类可以用于任意形状，即使有噪声。</p><blockquote class="lz ma mb"><p id="b458" class="ld le mc lf b lg lh kd li lj lk kg ll md ln lo lp me lr ls lt mf lv lw lx ly im bi translated"><strong class="lf jd"> <em class="it">基于密度的集群的工作函数如下所示:</em> </strong></p></blockquote><ul class=""><li id="2c55" class="mg mh it lf b lg lh lj lk lm mi lq mj lu mk ly ml mm mn mo bi translated">我们选择一个随机的数据点。</li><li id="c6d0" class="mg mh it lf b lg mp lj mq lm mr lq ms lu mt ly ml mm mn mo bi translated">然后需要两个参数来检查该点周围的密度。首先，它将围绕该点创建一个半径，其次，它将检查该半径中的最小点。</li><li id="0cb8" class="mg mh it lf b lg mp lj mq lm mr lq ms lu mt ly ml mm mn mo bi translated">如果该点确实用最小点进行了检查，那么它将对该点进行聚类，并向前移动到其他点，如果不是，那么它将把它视为异常值。</li><li id="0fbf" class="mg mh it lf b lg mp lj mq lm mr lq ms lu mt ly ml mm mn mo bi translated">DBSCAN方法有两个参数，即<strong class="lf jd"><em class="mc">【EPS(epsilon)</em></strong>用于确定半径，以及<strong class="lf jd"> <em class="mc"> min_samples </em> </strong>用于检查最小点。</li><li id="b465" class="mg mh it lf b lg mp lj mq lm mr lq ms lu mt ly ml mm mn mo bi translated">这些参数的默认值分别为0.5和5。</li></ul><p id="6727" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">寻找邻居的距离测量是非常重要的步骤和距离函数。</p><p id="8392" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">还有另一个度量来选择距离函数。此指标的默认值是欧几里得，但它可以是字符串或可调用的。如果我们选择string或callable，那么我们应该考虑公制中的成对距离方法。</p><p id="4af9" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">还有一个参数叫做<strong class="lf jd"> <em class="mc">算法</em> </strong>，用于机器学习中的邻居搜索，如下图所示:</p><ul class=""><li id="b99c" class="mg mh it lf b lg lh lj lk lm mi lq mj lu mk ly ml mm mn mo bi translated"><strong class="lf jd">强力搜索:</strong>它适用于小数据集，并提供对邻居的快速搜索，但在数据集增长时不可行。</li><li id="11e3" class="mg mh it lf b lg mp lj mq lm mr lq ms lu mt ly ml mm mn mo bi translated"><strong class="lf jd"> K-D和球树:</strong>一级以上蛮搜。这种搜索是基于关联的，并且是在结构化树类型中完成的。而球树在高维特征中是有用的。</li></ul><p id="af5d" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">叶大小参数用于KD和球树方案，默认值为30。但这并不太可行，因为它会降低速度，并且需要内存来保存一棵树。</p><p id="93f0" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为了节省内存，内存受限的研究人员选择了基于光学的聚类。</p><p id="b589" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">让我们用python做一个DBSCAN集群</p><p id="8e91" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">导入必要的库</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="18d6" class="mz na it mv b gy nb nc l nd ne"># DBSCAN Clustering</span><span id="7d5d" class="mz na it mv b gy nf nc l nd ne"># Importing the libraries<br/>import numpy as np<br/>import pandas as pd</span></pre><p id="d5e1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">用熊猫的读取方法读取数据集。</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="ccbc" class="mz na it mv b gy nb nc l nd ne"># Importing the dataset<br/>dataset = pd.read_csv('Mall_Customers.csv')<br/>X = dataset.iloc[:, [3, 4]].values</span></pre><p id="8303" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">数据集的视图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/cc74296b49894ef72808a54135ab0fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*phjB7uzfKLmN-wU6XPqUSQ.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">商场顾客的数据集。作者的照片</figcaption></figure><p id="1e93" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">从sklearn导入聚类算法</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="c30d" class="mz na it mv b gy nb nc l nd ne"># Using the elbow method to find the optimal number of clusters<br/>from sklearn.cluster import DBSCAN<br/>dbscan=DBSCAN(eps=3,min_samples=4)</span></pre><p id="2593" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，拟合模型。</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="059f" class="mz na it mv b gy nb nc l nd ne"># Fitting the model</span><span id="0ea8" class="mz na it mv b gy nf nc l nd ne">model=dbscan.fit(X)</span><span id="8e8b" class="mz na it mv b gy nf nc l nd ne">labels=model.labels_</span><span id="4b0e" class="mz na it mv b gy nf nc l nd ne">print(labels)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/38e2ebd177d4832bc3824363c3d96068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Dufom7rg9dU05aU4vVh_Jw.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">标签组成不同的集群。作者的照片</figcaption></figure><p id="af7f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们看到标签也显示了“-1”值，这意味着它是一个异常值，即不属于任何聚类。提出核心观点。</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="4b92" class="mz na it mv b gy nb nc l nd ne">#identifying the points which makes up our core points<br/>sample_cores=np.zeros_like(labels,dtype=bool)</span><span id="db01" class="mz na it mv b gy nf nc l nd ne">sample_cores[dbscan.core_sample_indices_]=True</span></pre><p id="f5ed" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为了找到集群的数量</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="05cf" class="mz na it mv b gy nb nc l nd ne">#Calculating the number of clusters</span><span id="c0b8" class="mz na it mv b gy nf nc l nd ne">n_clusters=len(set(labels))- (1 if -1 in labels else 0)<br/>print(n_clusters)</span><span id="7716" class="mz na it mv b gy nf nc l nd ne">#output:<br/>9</span></pre><p id="33de" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">上面的代码显示了集群的总数。要打印分类的分数</p><pre class="ks kt ku kv gt mu mv mw mx aw my bi"><span id="6e66" class="mz na it mv b gy nb nc l nd ne">print(metrics.silhouette_score(X,labels))</span><span id="914c" class="mz na it mv b gy nf nc l nd ne">#output:<br/>-0.1908319132560097</span></pre><p id="0e74" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">度量分数变为负值，这意味着样本被分配到错误的聚类。分数介于“1”到“-1”之间，其中“1”表示好的值，“-1”表示最差的值。</p><blockquote class="lz ma mb"><p id="f512" class="ld le mc lf b lg lh kd li lj lk kg ll md ln lo lp me lr ls lt mf lv lw lx ly im bi translated"><strong class="lf jd"> <em class="it">结论:</em> </strong></p></blockquote><p id="bb87" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">DBSCAN聚类适用于任意形状的聚类。它在异常值的情况下也是稳健的。该算法在异常检测和卫星图像中是有用的。</p><p id="71a6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae ni" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae ni" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="5c8d" class="nj na it bd nk nl nm nn no np nq nr ns ki nt kj nu kl nv km nw ko nx kp ny nz bi translated">推荐文章</h1><ol class=""><li id="7049" class="mg mh it lf b lg oa lj ob lm oc lq od lu oe ly of mm mn mo bi translated"><a class="ae ni" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener"> NLP —用Python从零到英雄</a></li></ol><p id="04f4" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">2.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a></p><p id="c4f4" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">3.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/python-zero-to-hero-with-examples-c7a5dedb968b?source=friends_link&amp;sk=186aff630c2241aca16522241333e3e0" rel="noopener"> Python:零到英雄带实例</a></p><p id="7aa8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">4.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/fully-explained-svm-classification-with-python-eda124997bcd?source=friends_link&amp;sk=da300d557992d67808746ee706269b2f" rel="noopener">用Python全面讲解SVM分类</a></p><p id="2ae3" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">5.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/fully-explained-k-means-clustering-with-python-e7caa573176a?source=friends_link&amp;sk=9c5c613ceb10f2d203712634f3b6fb28" rel="noopener">用Python全面解释K-means聚类</a></p><p id="0e2e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">6.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python全面解释线性回归</a></p><p id="1480" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">7.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python全面讲解逻辑回归</a></p><p id="4f2e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">8.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/basic-of-time-series-with-python-a2f7cb451a76?source=friends_link&amp;sk=09d77be2d6b8779973e41ab54ebcf6c5" rel="noopener">Python时间序列基础知识</a></p><p id="9ebc" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">9.<a class="ae ni" href="https://medium.com/towards-artificial-intelligence/numpy-zero-to-hero-with-python-d135f57d6082?source=friends_link&amp;sk=45c0921423cdcca2f5772f5a5c1568f1" rel="noopener"> NumPy:用Python零到英雄</a></p><p id="42d5" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">10.<a class="ae ni" href="https://medium.com/analytics-vidhya/confusion-matrix-in-machine-learning-91b6e2b3f9af?source=friends_link&amp;sk=11c6531da0bab7b504d518d02746d4cc" rel="noopener">机器学习中的混淆矩阵</a></p></div></div>    
</body>
</html>