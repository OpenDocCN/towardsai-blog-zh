# 知识蒸馏，一种压缩神经网络的方法

> 原文：<https://pub.towardsai.net/natural-language-processing-abcd6e13ed40?source=collection_archive---------2----------------------->

## [自然语言处理](https://towardsai.net/p/category/nlp)

## 师生架构为嵌入式系统创建一个更小的模型

![](img/a639fe52af9e50d9ec05c64f1be7c85c.png)

由[莎伦·麦卡琴](https://unsplash.com/@sharonmccutcheon?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/miniature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

大型神经网络非常复杂，并且很有可能执行更复杂的任务。但不幸的是，验证这样的大型网络并不容易，因此无法保证我们使用了神经网络的全部容量。相比之下，较小的神经网络更容易验证和部署。

**知识提炼是将知识从一个大型神经网络或一组网络转移到一个较小的神经网络的过程，其精度损失可接受。**这个过程有助于压缩大型深度学习模型，有时也有可能提高准确性。**知识提炼是一种压缩过程，如量化或模型修剪，以获得部署在边缘设备或智能手机等资源受限设备上的较小模型。**

# 师生模型

大模型具有教师模型的作用，小模型是可以从大模型中学习的学生模型。目标是让学生模型达到相同或更好的精度，尽管它是一个更小的模型。学生模型从教师模型中学习知识。**教师模型的知识可分为三类:基于反应的、基于特征的和基于关系的知识。**

# 准确度分数

根据这篇[论文](https://arxiv.org/pdf/2007.09029.pdf)，一些知识提炼方法在学生模型中提供了与教师模型中相同的准确性评级，将模型大小减少了大约 80%。**甚至有一些提炼方法可以在学生模型中获得比教师模型更好的准确率。**

# 基于响应的蒸馏

教师模型输出层的知识是基于响应的提炼的核心。**学生模型模仿教师模型输出层的预测。**教师模型和学生模型之间的差异称为蒸馏损失，应在培训过程中将其降至最低。

# 基于特征的蒸馏

学生模型可以从教师模型的深层神经网络的中间层的知识中学习。特性在中间层中是不同的，学生模型使用特性属性来提供与教师模型相同的特性。在基于特征的蒸馏中，蒸馏损失可通过两个模型中应被最小化的特征激活的差异来定义。这种方法对于从深度网络学习薄网络是合理的。

# 基于关系的蒸馏

**这种方法使用所有层、中间层和输入或输出层之间的关系中的信息。**与使用中间层或输出层知识的其他两种基于响应和基于特征的方法相比，在这种方法中，蒸馏损失由教师和学生网络中特征图的关系决定。

# 知识蒸馏的应用

## 计算机视觉

通过知识提炼的模型压缩可以应用于计算机视觉，因为这种方法像在计算机视觉架构中一样利用深度神经网络。图像、视频、对象分类或识别等应用是知识提炼最常用的应用。**在人脸识别应用中，可以在大容量教师模型的指导下，将特征图转移到学生模型中，以创建更小的学生模型。**

作为自动驾驶的现实应用，将行人作为动态对象(有时可能是静态对象(站立的行人))具有挑战性，并且与安全相关。这篇[论文](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8803079&casa_token=t2QkLTU_gLUAAAAA:AV8DB5rPmAP3IdRE7zVXPBdLN5YEjN7XpeO8wEQEl3W-RIEwL9TUMmTmAlP3_t0BVtR7aZRyvjL4&tag=1)提供了一个解决方案，使用高精度的知识提炼来构建一个快速的、占用空间小的模型。

## 自然语言处理

诸如 BERT(来自 Transformer 的双向编码器表示)之类的语言模型很复杂，并且需要大量的计算资源。BERT 由 Google 于 2006 年开发并发布。知识提炼可以减少内存和计算能力的需求，以适应资源受限设备的模型。这种方法有助于将深度学习模型从云转移到智能手机或其他边缘设备。[**distil BERT**](https://huggingface.co/docs/transformers/model_doc/distilbert)**是 BERT 语言模型的压缩版本，准确率超过原始 BERT 模型的 95%。**

## 语音识别

深度神经网络用于语音识别应用程序(如 Alexa 或 Siri)中的声学建模。知识提炼有助于创建轻量级声学模型。语音中的时间信息需要额外的考虑，例如 RNN(递归神经网络)算法将实时行为从教师模式转移到学生模式。同样的概念可以用于智能手机神经网络中的音频传感，以检测人类行为。根据这篇[论文](https://dl.acm.org/doi/abs/10.1145/2750858.2804262?casa_token=PXk1bbFEWY8AAAAA:wXSPbyB0B5zQ0uFgV7AEryapfSrCVAPY6N9lxRgK0q3PUreHr3Cce76ro6XiXTZoQQFk0MR7xeBKhoUn)，人类的情感，如悲伤、恐惧、压力或愤怒可以在一个小设备上被识别。

## 医疗保健领域的移动诊断

**通过深度神经网络的知识提炼，可以降低诊断皮肤病的成本。**根据这篇[论文](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=9335582)，一个健壮的移动深度学习模型经过训练，通过智能手机拍照并应用知识提取方法，以超过 93%的准确率区分特定的皮肤病。