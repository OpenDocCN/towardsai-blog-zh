<html>
<head>
<title>Implementing FaceID Technology with a Siamese Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用连体神经网络实现FaceID技术</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/implementing-faceid-technology-with-siamese-neural-network-177d33ac0bc4?source=collection_archive---------4-----------------------#2020-10-06">https://pub.towardsai.net/implementing-faceid-technology-with-siamese-neural-network-177d33ac0bc4?source=collection_archive---------4-----------------------#2020-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3cb9" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="7ecf" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">了解更多奇怪的网络。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5e7499517c5b96e39b773cfa0c0a2410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PX9-DGKHdOvwiaIciKp6dQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Nikita Golubev的flaticon图标</figcaption></figure><p id="04be" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">Face ID是一种技术，它允许设备只允许被允许的身份访问自己。它利用这一点来看这个人的脸，如果它被认为是一个有权限的人，系统就会给它。很长一段时间以来，它是通过不同的技术来实现的，但是现在，在人工神经网络的大规模发展和CNN在计算机视觉中实现高性能之后，神经网络已经成为一种更有吸引力的实现方式。</p><h1 id="206e" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">第一种方式——简单的CNN。</h1><p id="5907" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">最直接的方法是建立一个简单的CNN，将用户的脸分类为这个设备的“拥有者”/“非拥有者”。然而，这种实现有一些缺点。</p><ul class=""><li id="6d1e" class="mx my iq lg b lh li lk ll ln mz lr na lv nb lz nc nd ne nf bi translated">训练一个神经网络需要大量的时间和计算能力，尤其是CNN。</li><li id="39f2" class="mx my iq lg b lh ng lk nh ln ni lr nj lv nk lz nc nd ne nf bi translated">CNN应该为每个人分别培训。</li></ul><p id="cffb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因此，如果用户必须等待3到5个小时来训练能够识别自己的模型，他/她就不会购买设备。另外，它需要大量的图像。想象一下，用户必须拍摄大约1000张自己的自拍才能进行人脸识别。</p><h1 id="b8ce" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">第一种方式—双头神经网络。</h1><p id="ec13" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">第二种方式是采取更硬的神经网络架构——双头神经网络。这个想法很简单。网络拍摄2幅图像，一幅保存在所有者的设备中，另一幅来自相机。CNN应该把他们归类为“相同的”/“不相同的”，或者给他们一个排名。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/459199a95cceedd1637f82846fbca66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Agp2M-ITLJO3ufi8m--D3Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Freepik的flaticon中的图标</figcaption></figure><p id="a0ff" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">即使这种架构是一种更好的方法，它也有其局限性。</p><ul class=""><li id="1192" class="mx my iq lg b lh li lk ll ln mz lr na lv nb lz nc nd ne nf bi translated">它可能不是在所有情况下都有效，即使它是在许多不同人的图像上训练的。</li><li id="d553" class="mx my iq lg b lh ng lk nh ln ni lr nj lv nk lz nc nd ne nf bi translated">此外，即使CNN将在服务器上而不是在终端设备上被训练，这也可能是计算和耗时的。</li></ul><p id="4816" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">所以我们需要一个更好的方法。</p><h1 id="def8" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">暹罗神经网络</h1><p id="f4da" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">暹罗神经网络(简称SNN)实际上是一个简单的CNN，需要一点点不同的方式来训练。在几乎所有的网络中，我们将数据集分成几批，加载器将它们发送到网络。snn正在使用一种叫做三联体训练的方法。所以它是如何工作的。<br/>基本上，我们需要两种类型的图像，一种是“车主脸”的照片，另一种是“非车主脸”的照片，通常是随机的人物照片。在创建数据集的过程中，我们从这些图像中创建三个一组，同一个人的两张不同的照片，以及一个随机的人的一张照片。下面的代码展示了在PyTorch中实现的Dataset类。</p><pre class="kp kq kr ks gt nl nm nn no aw np bi"><span id="a9f7" class="nq mb iq nm b gy nr ns l nt nu"># Defining the Dataset<br/>class SNN_Dataset(data.Dataset):<br/>    def __init__(self, root, ME_DIR, NOT_ME_DIR):<br/>        self.root = root<br/>        ME_PATHS = listdir(ME_DIR)<br/>        NOT_ME_PATHS = listdir(NOT_ME_DIR)<br/>        ME_PATHS = [join(ME_DIR, img_path) for img_path in ME_PATHS]<br/>        NOT_ME_PATHS = [join(NOT_ME_DIR, img_path) for img_path in NOT_ME_PATHS]<br/>        ME_PAIRS = list(itertools.permutations(ME_PATHS, 2))<br/>        self.TRIPLETS = list(itertools.product(ME_PAIRS, NOT_ME_PATHS))<br/>        self.TRIPLETS = [list(triplet) for triplet in self.TRIPLETS]<br/>        for i in range(len(self.TRIPLETS)):<br/>            self.TRIPLETS[i] = list(self.TRIPLETS[i])<br/>            self.TRIPLETS[i][0] = list(self.TRIPLETS[i][0])<br/>            self.TRIPLETS[i][0].append(self.TRIPLETS[i][1])<br/>            self.TRIPLETS[i].pop(-1)<br/>            self.TRIPLETS[i] = self.TRIPLETS[i][0]<br/>        random.shuffle(self.TRIPLETS)<br/>    def __getitem__(self, index):<br/>        img_triplet = [Image.open(img).convert('RGB') for img in self.TRIPLETS[index]]<br/>        img_triplet = [transforms.Scale((244, 244))(img) for img in img_triplet]<br/>        img_triplet = [transforms.ToTensor()(img) for img in img_triplet]<br/>        return img_triplet[0], img_triplet[1], img_triplet[2]<br/>    def __len__(self):<br/>        return self.TRIPLETS</span></pre><p id="aa2c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">网络从三元组中取出每一幅图像，并计算图像的线性表示。从线性代数的观点来看，神经网络实际上是一个非常庞大和复杂的线性和非线性变换。因此，人工神经网络的每个输出都是输入的线性表示。采用线性表示后，输出将进入下面的公式。如果第一个到第二个图像的线性表示彼此靠近(欧几里德范数低)，并且第一个和最后一个图像的线性表示远离(欧几里德范数高)，则在加上α之前，max函数的第一项的值将是负的。因此，当alpha为0时，如果第一个图像是同一个人，则该公式的将为0。这就是为什么我们在公式中需要α。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0fb03b039dcc1f58f2e1eba6b1c75ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzFtvSCNJMS_2QzyWHGw1Q.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/7aea8300745c89826696a3f5bd4ab6b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*NTXue9-BrCPrxa5T07yi5w.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">这里A是新图像的线性表示，P是正片，N是负片。</figcaption></figure><p id="d9c4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">Alpha可以解释为设置网络灵敏度的参数(从-1到1)。因此，灵敏度越高，对同一个人图像的要求就越低，反之亦然。同样，如果你有很多图像，你可以将alpha设置为较高的值，当图像较少时，可以设置为较小的负值。<br/>当我在我的图像上训练网络时，a将alpha设置为0.5，并使用7张我的图像和10张随机图像，花了5个小时在具有8个内核的PC上训练网络(我使用组合来生成数据集)。然而，当我只使用我的一位同事的2张照片和5张随机照片来训练网络时，训练网络的时间不超过15分钟，但它也采用了更低的alpha，甚至是负值。所以你可以训练一个alpha值很高的网络来推动网络更好地学习，在生产阶段降低它。</p><p id="a9fb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对于反向传播，使用从公式中得到的值。<br/>下面是结果。<br/>注:瓦西里卡——意思是对我的名字——瓦西里的爱抚。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/c9d23efccc91a162faeec3fd30379f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*yLk7RxivSIzpx1BovwA1Ow.gif"/></div></figure><p id="87fe" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">代码库:<a class="ae nx" href="https://github.com/ScienceKot/SNN.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ScienceKot/SNN.git</a></p><p id="4999" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">灵感——安德烈·布尔科夫的百页机器学习书</p></div></div>    
</body>
</html>