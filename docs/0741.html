<html>
<head>
<title>Using Excel reference functions in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Pandas中使用Excel引用函数</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/using-excel-reference-functions-in-pandas-5b9192b1cadd?source=collection_archive---------5-----------------------#2020-07-30">https://pub.towardsai.net/using-excel-reference-functions-in-pandas-5b9192b1cadd?source=collection_archive---------5-----------------------#2020-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3ee6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="92a1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在我的Github库有完整的代码<a class="ae kr" href="https://github.com/arditoibryan/Projects/tree/master/20200730_Pandas_Excel_Functions" rel="noopener ugc nofollow" target="_blank">。</a></h2></div><p id="dd74" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在本文中，我将使用Pandas从头创建一个数据集，但是在填充数据集时会引用其他单元格的值。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/1ed50e50f6ab0a290732bec92724bb45.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*JYqSMfQSCaLzqhfVGoLbFQ.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">我用熊猫从头开始创建了这个数据集</figcaption></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><p id="cf03" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">Pandas缺少的一个功能是创建类似Excel的功能。当我们必须手动处理数量有限的信息时，Excel是一个很好的工具。这个电子表格最直观的特征之一是函数。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/42c45fdbd2fb05747adca4f021390553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhkd57qfTN6yf1TL6BXgcQ.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">熊猫/Excel混合徽标的外观</figcaption></figure><p id="d839" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">关于熊猫，人们从一开始就很难欣赏它的最令人不安的原因之一是编辑数据集中的数据真的很有挑战性。如果我想从头创建一个数据集，并且需要使用从以前的行和列中获取信息的函数，该怎么办？</p><h1 id="6ab3" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">Excel版本</h1><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ne"><img src="../Images/fd06108222f1d9b1239b6a128f7bce9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lRNqzv88wORc641CJ7fuw.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">使用Excel公式</figcaption></figure><p id="007a" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">我们获得以下数据集:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/24dbd9d396a27ecee9ad5ef5021e1624.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*BEWPkTnK5zWGhjIHXdi_qw.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">数据集的10行</figcaption></figure><h1 id="bdf7" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">熊猫版</h1><p id="b26d" class="pw-post-body-paragraph ks kt it ku b kv ng kd kx ky nh kg la lb ni ld le lf nj lh li lj nk ll lm ln im bi translated">我们可以将该文件保存为. csv文件，但是，本文的目的是用pandas复制相同的过程。我将使用这些相关函数从头开始创建一个数据集。</p><h2 id="175e" class="nl mn it bd mo nm nn dn ms no np dp mw lb nq nr my lf ns nt na lj nu nv nc iz bi translated">创建第一行</h2><p id="d349" class="pw-post-body-paragraph ks kt it ku b kv ng kd kx ky nh kg la lb ni ld le lf nj lh li lj nk ll lm ln im bi translated">我将在语句中使用来创建其余的行。像在Excel中一样，第一行不应该包含任何函数，而只能包含数据。我将创建一个空行来设置数据集的列。</p><pre class="lp lq lr ls gt nw nx ny nz aw oa bi"><span id="8dea" class="nl mn it nx b gy ob oc l od oe">import pandas as pd<br/>df = [0, 0, 0]<br/>df = pd.DataFrame(df).transpose()<br/>df.columns = ['A', 'B', 'C']<br/>df</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3cd6b4913abfc81f10a7d8bf03cae323.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*5hYtp4DLy-3HCyvYrtFzJw.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">空数据集</figcaption></figure><h2 id="3d75" class="nl mn it bd mo nm nn dn ms no np dp mw lb nq nr my lf ns nt na lj nu nv nc iz bi translated">设置值</h2><p id="56f9" class="pw-post-body-paragraph ks kt it ku b kv ng kd kx ky nh kg la lb ni ld le lf nj lh li lj nk ll lm ln im bi translated">我以前可以这样做，但我更喜欢一步一步来。</p><pre class="lp lq lr ls gt nw nx ny nz aw oa bi"><span id="3b71" class="nl mn it nx b gy ob oc l od oe">df['A'][0] = 100<br/>df['B'][0] = 0<br/>df['C'][0] = 0<br/>df</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi og"><img src="../Images/f4c965a85dc5246faf9d771b4ba8e93e.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/format:webp/1*TDKfsF_P_QyfKwILpR4jtg.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">第一值</figcaption></figure><h2 id="1a65" class="nl mn it bd mo nm nn dn ms no np dp mw lb nq nr my lf ns nt na lj nu nv nc iz bi translated">使用函数</h2><p id="8010" class="pw-post-body-paragraph ks kt it ku b kv ng kd kx ky nh kg la lb ni ld le lf nj lh li lj nk ll lm ln im bi translated">现在我终于可以设置函数了。它们肯定不如excel直观，但是，这也能解决问题。要指定以前的单元格，我必须在for语句中使用_作为引用。例如，如果我在列A中，并且我希望该单元格获取同一列的上一个单元格的值:</p><pre class="lp lq lr ls gt nw nx ny nz aw oa bi"><span id="ab1c" class="nl mn it nx b gy ob oc l od oe">df.loc[_, 'A'] = df.loc[_-1, 'A']+1</span></pre><p id="a0fb" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">含义:在A列中，仍然从A列(' A ')中获取前一个单元格的值(_-1)。然后将检索到的值加1。</p><p id="1f08" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">为了使用这种方法创建整个数据集，我将使用以下算法:</p><pre class="lp lq lr ls gt nw nx ny nz aw oa bi"><span id="f6d6" class="nl mn it nx b gy ob oc l od oe">for _ in range(1, 10):<br/>  df.loc[_, 'A'] = df.loc[_-1, 'A']+1<br/>  df.loc[_, 'B'] = df.loc[_, 'A']+100<br/>  df.loc[_, 'C'] = df.loc[_-1, 'B']+500<br/>df</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/dd0b731b0f349918b49d5a87576901bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*CUaGWQL8qay4beut9dNM9w.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">仅用熊猫创建的数据集</figcaption></figure><h1 id="29c3" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">在Excel中可以使用其他函数吗？</h1><p id="1767" class="pw-post-body-paragraph ks kt it ku b kv ng kd kx ky nh kg la lb ni ld le lf nj lh li lj nk ll lm ln im bi translated">您不能使用与Excel完全相同的功能。例如，不能以同样的方式使用=AVERAGE(B1，C1)。Python有自己的内置函数或额外的库，您可以下载。在这种特殊情况下，我会这样做:</p><pre class="lp lq lr ls gt nw nx ny nz aw oa bi"><span id="0f64" class="nl mn it nx b gy ob oc l od oe">df['D'] = 0</span></pre><p id="4d3c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这将创建一个附加列。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/fe92291624abb5ed6f1a984561244601.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*suBmnbviUkMs5y3RiPn6ZA.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">增加D柱</figcaption></figure><pre class="lp lq lr ls gt nw nx ny nz aw oa bi"><span id="694a" class="nl mn it nx b gy ob oc l od oe">import statistics<br/>for _ in range(1, 10):<br/>  df.loc[_, 'A'] = df.loc[_-1, 'A']+1<br/>  df.loc[_, 'B'] = df.loc[_, 'A']+100<br/>  df.loc[_, 'C'] = df.loc[_-1, 'B']+500<br/>  df.loc[_, 'D'] = statistics.mean([df.loc[_, 'B'], df.loc[_, 'C']])<br/>df</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/1ed50e50f6ab0a290732bec92724bb45.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*JYqSMfQSCaLzqhfVGoLbFQ.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">最终数据集</figcaption></figure><p id="2f55" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">从for语句的最后一个函数可以看出，我一直在用python版的mean计算同一行的B和C的平均值。</p></div></div>    
</body>
</html>