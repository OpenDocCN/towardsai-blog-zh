<html>
<head>
<title>Data Wrangling With Python — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python处理数据——第1部分</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/data-wrangling-with-python-part-1-969e3cc81d69?source=collection_archive---------1-----------------------#2021-03-03">https://pub.towardsai.net/data-wrangling-with-python-part-1-969e3cc81d69?source=collection_archive---------1-----------------------#2021-03-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c09d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="867a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">数据科学中有用的转换方法</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/e117ad5ad4a9ec0e52e4ca0073b392e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S9L8NTiRQZc1tkXq"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@ricaros?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹尼尔·伊德里</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h2 id="faa2" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated"><strong class="ak">数据争吵也称为数据争吵</strong></h2><p id="e5af" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">简单来说，数据角力就是清理(杂乱无章或不完整的原始数据)和统一杂乱(标准化)的复杂数据集以便于访问和分析的过程。</p><p id="3eaf" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">数据争论还涉及数据映射，这在任何数据集成过程中都是最重要的，如果没有适当的数据映射策略、数据转换和过滤，数据总是容易出错。</p><p id="0610" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们在wrangling中对数据执行的操作是连接解析、清理、统一或过滤数据集中的行或列，以产生所需的输出。</p><p id="96ea" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">为什么我们需要数据争论？</p><p id="4f58" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">数据专业人员几乎72%的时间都花在数据争论过程中。这是数据处理中非常关键的一步。如果处理得当，它可以帮助企业用户根据市场需求做出具体而及时的决策。</p><p id="a12e" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">此外，与python的数据争论是常见的，也是经常使用的。</p><p id="bce7" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">数据争论的议程是</p><p id="aa5e" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">1.揭示更深层次的数据洞察</p><p id="21ae" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">2.提供准确、可操作的数据</p><p id="6941" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">3.减少数据专业人员在收集和组织非结构化数据上花费的时间</p><p id="8de7" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">4.更好的决策技能</p><p id="87bd" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">在本文中，我们使用数据框进行辩论。数据框是表格(行和列)格式。数据框中的每一行对应一个观测值，每一列代表一个要素。</p><div class="nb nc gp gr nd ne"><a rel="noopener  ugc nofollow" target="_blank" href="/data-preprocessing-concepts-with-python-b93c63f14bb6"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">Python中的数据预处理概念</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">一种为机器学习估值器准备数据的稳健方法</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">pub.towardsai.net</p></div></div><div class="nn l"><div class="no l np nq nr nn ns lb ne"/></div></div></a></div><div class="nb nc gp gr nd ne"><a rel="noopener  ugc nofollow" target="_blank" href="/z-statistics-t-statistics-p-statistics-are-still-confusing-you-87557047e20a"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">Z-统计量，T-统计量，P-统计量还在迷惑你？</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">机器学习统计学中的定义和概念</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">pub.towardsai.net</p></div></div><div class="nn l"><div class="nt l np nq nr nn ns lb ne"/></div></div></a></div><h2 id="a77b" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">数据争论简介:</h2><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="6ee2" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="805e" class="li lj it nv b gy od oa l ob oc"># Load data as a dataframe<br/>dataframe = pd.read_csv(‘train.csv’)</span><span id="8c9e" class="li lj it nv b gy od oa l ob oc"># Show first 5 rows<br/>dataframe.head(5)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9a2508367a48deae4bc714d4376f9716.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/0*Haw7YiboSxWBvDkw.png"/></div></figure><p id="6342" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">从结果中得到的启示:这里我们需要根据观察和特征来理解数据。</p><p id="e4fd" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">特征:姓名，P级，年龄，性别，性别代码，幸存</p><p id="32a3" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">观察:乘客信息</p><p id="0920" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们可以清楚地注意到，特征性别和性别代码持有相同的信息。我们希望我们的功能是独特的。所以我们可以移除任何一根柱子。</p><h2 id="3a9f" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">创建数据框</h2><p id="0306" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">熊猫有许多创建新数据框的方法。</p><ol class=""><li id="0b29" class="of og it mf b mg mw mj mx lr oh lv oi lz oj mv ok ol om on bi translated">要创建空数据框，请分别创建每一列</li></ol><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="4c40" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="707b" class="li lj it nv b gy od oa l ob oc"># Create DataFrame<br/>dataframe = pd.DataFrame()</span><span id="c213" class="li lj it nv b gy od oa l ob oc"># Add columns<br/>dataframe[‘Name’] = [‘Jacky Jackson’, ‘Steven Stevenson’]<br/>dataframe[‘Age’] = [38, 25]<br/>dataframe[‘Driver’] = [True, False]</span><span id="0abb" class="li lj it nv b gy od oa l ob oc"># Show DataFrame<br/>dataframe</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/acd6e900418f3879e963e3c892867cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/0*GzTLeMc02_pUlVce.png"/></div></figure><p id="a1cf" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">在这里，我们可以通过以下方式将新行追加到底部</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="8b85" class="li lj it nv b gy nz oa l ob oc"># Create row<br/>new_person = pd.Series([‘Molly Mooney’, 40, True], index=[‘Name’,’Age’,’Driver’])</span><span id="600d" class="li lj it nv b gy od oa l ob oc"># Append row<br/>dataframe.append(new_person, ignore_index=True)</span></pre><p id="a5fc" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">在熊猫中，我们有无数种方法来创建数据框。实际上，我们不能追加行来填充数据框。相反，我们有一个从其他来源的加载选项。</p><h2 id="3ef6" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">描述数据</h2><p id="4bcc" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">我们可以看到数据帧的特征。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="416f" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="3cd2" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="8d97" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="9cbd" class="li lj it nv b gy od oa l ob oc"># Show two rows<br/>dataframe.head(2)</span></pre><p id="e836" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">这里我们可以通过使用head()看到前几行。为了知道数据集的维数，我们使用shape方法。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="f8d6" class="li lj it nv b gy nz oa l ob oc"># Show dimensions<br/>dataframe.shape</span></pre><p id="1e86" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们可以使用describe()获得任何数字列的描述性统计信息。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="32e4" class="li lj it nv b gy nz oa l ob oc"># Show statistics<br/>dataframe.describe()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi op"><img src="../Images/b8a7097903f9bddb48224ea02c45ed7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/0*dPj1JUvV3JG_M4up.png"/></div></figure><p id="85ca" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">当我们加载数据时，我们可以了解它是如何构造的，以及它包含什么样的信息。我们可以抽取样本来查看小切片，并计算数据的汇总统计。</p><p id="c14b" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">例如，如果目标要素幸存= 1，则表示乘客幸存。但是，对于分类特征来说，统计概要就没那么有用了。</p><h2 id="33e6" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">导航数据框架</h2><p id="f823" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">为了导航，我们可以使用loc或iloc通过一行或一个值</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="fc86" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="d871" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com//titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com//titanic-csv'</a></span><span id="9bfa" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="f83f" class="li lj it nv b gy od oa l ob oc"># Select first row<br/>dataframe.iloc[0]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/5430ae5018dc2b3595a4632c051f5c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/0*6lsvezOntDoVQ8C5.png"/></div></figure><p id="7d7d" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">定义我们想要的一片行，比如选择第二、第三和第四行</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="cfa7" class="li lj it nv b gy nz oa l ob oc"># Select three rows<br/>dataframe.iloc[1:4]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi or"><img src="../Images/ff932fa5ce5c7f535fd7651bcd9a7f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/0*3rgC4PcpJdVBBCRb.png"/></div></figure><p id="a685" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们甚至可以用它来获取某一点之前的所有行，比如第四行之前的所有行</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="7a8b" class="li lj it nv b gy nz oa l ob oc"># Select three rows<br/>dataframe.iloc[:4]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/22fda91b7b927a2cc3f41a46c9d92fc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/0*yYuMgGJZRtIxQCOG.png"/></div></figure><p id="59a2" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">数据帧不需要数字索引。我们甚至可以更改用户定义的索引值，使每行都有一个唯一的值。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="e9eb" class="li lj it nv b gy nz oa l ob oc"># Set index<br/>dataframe = dataframe.set_index(dataframe[‘Name’])</span><span id="141f" class="li lj it nv b gy od oa l ob oc"># Show row<br/>dataframe.loc[‘Allen, Miss Elisabeth Walton’]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/98a019c0c52570a7a50f0fa87564347e.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/0*tE6RFWvhpdLDFjDI.png"/></div></figure><p id="20e2" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">熊猫数据框中的每一行都有一个唯一的索引值。默认情况下，该索引号是一个整数。我们可以将它们更改为唯一的字母数字字符串或客户编号。为了选择单独的行和行的切片，pandas提供了两种方法:</p><p id="b7da" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">1.当数据帧的索引是一个标签(例如一个字符串)时，loc是有用的</p><p id="9f98" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">2.iloc对于查看具有整数值的数据框中的位置非常有用。</p><h2 id="66ee" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">基于条件选择行</h2><p id="f9e2" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">我们可以从数据中选择所有女性</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="5b3a" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="72e3" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="4ef2" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="f074" class="li lj it nv b gy od oa l ob oc"># To get the top 2 rows where column ‘sex’ == ‘female’<br/>dataframe[dataframe[‘Sex’] == ‘female’].head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/10e7730945521a9582e5202d99e03291.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/0*8ajjVwrfE5X4NHS1.png"/></div></div></figure><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="73c1" class="li lj it nv b gy nz oa l ob oc">dataframe[‘Sex’] == ‘female’ is the conditional statement; by wrapping that in dataframe[] we can get “select all the rows in the DataFrame where the value of data frame[‘Sex’] is ‘female’.</span></pre><p id="d9ab" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们也可以使用多个条件。我们可以选择乘客为65岁或以上女性的所有行。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="90c4" class="li lj it nv b gy nz oa l ob oc"># Filter rows<br/>dataframe[(dataframe[‘Sex’] == ‘female’) &amp; (dataframe[‘Age’] &gt;= 65)]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/cbe7e0dcc6316b72e5f688667bba8b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/0*LgpHFsbSV-O1sIuj.png"/></div></figure><p id="e011" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">有条件地选择和过滤数据是数据争论中最常见的任务。</p><h2 id="19ea" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">替换值</h2><p id="977b" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">在这里，我们可以将性别列中的任何“女性”实例替换为“女性”</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="5419" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="514c" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="975f" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="b860" class="li lj it nv b gy od oa l ob oc"># Replace values, show two rows<br/>dataframe[‘Sex’].replace(“female”, “Woman”).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/353b923b9585e4428bc28899a35647c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/0*0oSPGO9piGJSsekz.png"/></div></figure><p id="4ed6" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们可以同时替换多个值。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="3021" class="li lj it nv b gy nz oa l ob oc"># Replace “female” and “male with “Woman” and “Man” respectively in ‘sex’ column<br/>dataframe[‘Sex’].replace([“female”, “male”], [“Woman”, “Man”]).head(5)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/47b8e1e5ea0258cae4cb027f307b167d.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/0*UvDQZBBNm9nJ2x36.png"/></div></figure><p id="4117" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们还可以通过指定整个数据框而不是单个列来查找和替换整个数据框对象:</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="84db" class="li lj it nv b gy nz oa l ob oc"># Replace values, show two rows<br/>dataframe.replace(1, “One”).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/874dc5f7204d896688a9e67ec7b4c904.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/0*dT3aleoaS3tzWS09.png"/></div></figure><p id="a007" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">Replace也接受正则表达式</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="109f" class="li lj it nv b gy nz oa l ob oc"># Replace values, show two rows<br/>dataframe.replace(r”1st”, “First”, regex=True).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/b65e8dd2cec61831883fac328ab91310.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/0*au00pIsSh1VFWUkp.png"/></div></figure><p id="c7e3" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">Replace()是一种简单但强大的接受正则表达式的能力。</p><h2 id="0a49" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">重命名列</h2><p id="6732" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">rename()将接受一个字典作为参数。我们可以使用字典一次改变多个列名。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="ccd7" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="5051" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="d2e3" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="3cd6" class="li lj it nv b gy od oa l ob oc"># Rename column, show two rows<br/>dataframe.rename(columns={‘PClass’: ‘Passenger Class’}).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/21833de11b6427fa3d90576ccf4ed534.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/0*5FvIpB5vfh0MfJ4M.png"/></div></figure><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="52e2" class="li lj it nv b gy nz oa l ob oc"># Rename columns, show two rows<br/>dataframe.rename(columns={‘PClass’: ‘Passenger Class’, ‘Sex’: ‘Gender’}).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/8c34d442f540d1373874700f07c262d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/0*zuOIEe6Wdl5J70Au.png"/></div></figure><p id="8003" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们还可以用dictionarys的键-值对来改变列名。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="9dd2" class="li lj it nv b gy nz oa l ob oc"># Load library<br/> import collections</span><span id="65a6" class="li lj it nv b gy od oa l ob oc"># Create dictionary<br/> column_names = collections.defaultdict(str)</span><span id="a894" class="li lj it nv b gy od oa l ob oc"># Create keys<br/> for name in dataframe.columns:<br/> column_names[name]</span><span id="c802" class="li lj it nv b gy od oa l ob oc"># Show dictionary<br/> column_names</span></pre><h2 id="3fa9" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated"><strong class="ak">查找最小值、最大值和其他特征。</strong></h2><p id="533a" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">Pandas提供describe()方法，该方法给出描述性统计数据</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="6bcd" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="3a19" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="537d" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="a82d" class="li lj it nv b gy od oa l ob oc"># Calculate statistics<br/>print(‘Maximum:’, dataframe[‘Age’].max())<br/>print(‘Minimum:’, dataframe[‘Age’].min())<br/>print(‘Mean:’, dataframe[‘Age’].mean())<br/>print(‘Sum:’, dataframe[‘Age’].sum())<br/>print(‘Count:’, dataframe[‘Age’].count())</span></pre><p id="c2dc" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">Pandas提供了方差(var)、标准差(std)、峰度(kurt)、偏斜度(skew)、平均值的标准误差(sem)、众数(mode)、中位数(median)和许多其他值。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="118c" class="li lj it nv b gy nz oa l ob oc"># Show counts<br/>dataframe.count()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/de719dde81d279308fa433730c24b61f.png" data-original-src="https://miro.medium.com/v2/resize:fit:236/format:webp/0*iBFWYpI6G2AM-4OI.png"/></div></figure><h2 id="573b" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">寻找独特的价值</h2><p id="46cd" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">Unique()用于查看数据集中某一列的所有唯一值的数组</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="69d9" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="4e0d" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="9395" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="5c0a" class="li lj it nv b gy od oa l ob oc"># Select unique values<br/>dataframe[‘Sex’].unique()</span></pre><p id="fa2c" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">或者，value_counts()将显示所有唯一值以及每个值在数据帧的选定列中出现的次数</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="1c82" class="li lj it nv b gy nz oa l ob oc"># Show counts<br/>dataframe[‘Sex’].value_counts()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/c8d9eda418ed307384a901003e6b8eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/0*j2XrcjMDT6_KG4PB.png"/></div></figure><p id="dd7f" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">unique()和value_counts()对于操作数据集中的分类列非常有用。</p><p id="8ac0" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们可以使用nunique()获得所选列中唯一值的数量</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="f3ea" class="li lj it nv b gy nz oa l ob oc"># Show number of unique values<br/>dataframe[‘PClass’].nunique()</span></pre><h2 id="050b" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">处理缺失值</h2><p id="2a6d" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">isnull()和notnull()将返回一个布尔值，指示某个值是否缺失。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="f26e" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="f87d" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="e065" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="617e" class="li lj it nv b gy od oa l ob oc"># Select missing values, show two rows<br/>dataframe[dataframe[‘Age’].isnull()].head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/2fddd3437e2c50069383db16cb5b5941.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/0*8LgYVgLmpG0RSq-m.png"/></div></figure><p id="4841" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们使用Numpy来处理缺失值。</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="2307" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import numpy as np</span><span id="d813" class="li lj it nv b gy od oa l ob oc"># Replace values with NaN<br/>dataframe[‘Sex’] = dataframe[‘Sex’].replace(‘male’, np.nan)</span></pre><h2 id="6b62" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">删除列</h2><p id="cbdc" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">Delete()用于删除参数axis=1(即列轴)</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="5552" class="li lj it nv b gy nz oa l ob oc"># Load library<br/>import pandas as pd</span><span id="ce80" class="li lj it nv b gy od oa l ob oc"># Create URL<br/>url = ‘<a class="ae lh" href="https://tinyurl.com/titanic-csv'" rel="noopener ugc nofollow" target="_blank">https://tinyurl.com/titanic-csv'</a></span><span id="36ad" class="li lj it nv b gy od oa l ob oc"># Load data<br/>dataframe = pd.read_csv(url)</span><span id="dd5e" class="li lj it nv b gy od oa l ob oc"># Delete column<br/>dataframe.drop(‘Age’, axis=1).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/40dc000817829e44b92de1b61535c3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/0*kDEGHi1_0BSC1NQW.png"/></div></figure><p id="19f5" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们还可以通过指定列名来一次删除多个列</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="b6fb" class="li lj it nv b gy nz oa l ob oc"># Drop columns<br/>dataframe.drop([‘Age’, ‘Sex’], axis=1).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/8e7f025caf455672b7c07f452b599314.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/0*BGvfPUpdin8OSmU3.png"/></div></figure><p id="4f6f" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我们也可以通过指定index一次删除多个列</p><pre class="ks kt ku kv gt nu nv nw nx aw ny bi"><span id="447c" class="li lj it nv b gy nz oa l ob oc"># Drop column<br/>dataframe.drop(dataframe.columns[1], axis=1).head(2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/67b4fcc5fc06c0c5a61c7612d99296c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/0*VKNUBe5cqp6a2KKm.png"/></div></figure><p id="c15d" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">注意:不要使用inplace=True参数，许多pandas方法都包含一个inplace参数，当该参数为True时，将直接编辑数据帧。</p><h2 id="8fa4" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">结论</h2><p id="67cf" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">数据科学的基础来自基础学习。</p><p id="a161" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae lh" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="0535" class="ph lj it bd lk pi pj pk ln pl pm pn lq ki po kj lu kl pp km ly ko pq kp mc pr bi translated">推荐文章</h1><ol class=""><li id="59c7" class="of og it mf b mg mh mj mk lr ps lv pt lz pu mv ok ol om on bi translated"><a class="ae lh" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener">NLP——用Python零到英雄</a></li></ol><p id="e313" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">2.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a></p><p id="d3c7" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">3.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/python-zero-to-hero-with-examples-c7a5dedb968b?source=friends_link&amp;sk=186aff630c2241aca16522241333e3e0" rel="noopener"> Python:零到英雄附实例</a></p><p id="fadc" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">4.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-svm-classification-with-python-eda124997bcd?source=friends_link&amp;sk=da300d557992d67808746ee706269b2f" rel="noopener">用Python全面讲解SVM分类</a></p><p id="1b62" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">5.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-k-means-clustering-with-python-e7caa573176a?source=friends_link&amp;sk=9c5c613ceb10f2d203712634f3b6fb28" rel="noopener">用Python全面解释K-means聚类</a></p><p id="1732" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">6.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python全面解释线性回归</a></p><p id="2df3" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">7.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python全面解释逻辑回归</a></p><p id="9b16" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">8.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/basic-of-time-series-with-python-a2f7cb451a76?source=friends_link&amp;sk=09d77be2d6b8779973e41ab54ebcf6c5" rel="noopener">Python时间序列基础知识</a></p><p id="a590" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">9.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/numpy-zero-to-hero-with-python-d135f57d6082?source=friends_link&amp;sk=45c0921423cdcca2f5772f5a5c1568f1" rel="noopener"> NumPy:用Python零到英雄</a></p><p id="e328" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">10.<a class="ae lh" href="https://medium.com/analytics-vidhya/confusion-matrix-in-machine-learning-91b6e2b3f9af?source=friends_link&amp;sk=11c6531da0bab7b504d518d02746d4cc" rel="noopener">机器学习中的混淆矩阵</a></p></div></div>    
</body>
</html>