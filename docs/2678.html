<html>
<head>
<title>Text Generation with Markov Decision Processes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于马尔可夫决策过程的文本生成</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/text-generation-with-markov-decision-processes-168251ef937c?source=collection_archive---------2-----------------------#2022-04-12">https://pub.towardsai.net/text-generation-with-markov-decision-processes-168251ef937c?source=collection_archive---------2-----------------------#2022-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bbe3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">马尔可夫决策过程似乎是一种处理序列、驯服序列或将其用作最终自动生成某些文本的构建块的有效方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9db8cf60a036fb6530db733b4916c10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dRfXf70--bxEdfFVbwG5Xw.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@impatrickt" rel="noopener ugc nofollow" target="_blank">帕特里克·托马索</a>从<a class="ae ky" href="https://unsplash.com/photos/Oaqk7qqNh_c" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="83f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">生成文本需要制定几个规则来管理我们打算使用的单词。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/831c10b28235831e5e84cf3b1bcb826a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bjn0_PKFVitbeZi8yLXvWg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="0f30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着使用某种基础真理来人工学习它们。我把这个杰作命名为<code class="fe lw lx ly lz b">Herman Melville</code>的<code class="fe lw lx ly lz b">Moby Dick</code>，我们将从<code class="fe lw lx ly lz b">Project Gutenberg</code>下载。</p><p id="0ddf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lw lx ly lz b">Project Gutenberg</code>是第一个提供免费电子书的公司，也被称为eBooks。电子书由<code class="fe lw lx ly lz b">Project Gutenberg</code>的创始人<code class="fe lw lx ly lz b">Michael Hart</code>于1971年创立，他的遗产继续激励着今天的电子书和相关材料的生产。</p><p id="6225" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，您必须下载:</p><ul class=""><li id="1fac" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated">来自此链接的<a class="ae ky" href="https://zenodo.org/record/2422561/files/SPGC-metadata-2018-07-18.csv?download=1" rel="noopener ugc nofollow" target="_blank">标准化项目古腾堡语料库元数据</a>(或简化为SGPC元数据)<a class="ae ky" href="https://zenodo.org/record/2422561#.YlSxV25Bwyk" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/legalcode" rel="noopener ugc nofollow" target="_blank">知识共享署名4.0国际</a>许可下可用，由<code class="fe lw lx ly lz b">Martin Gerlach</code>和<code class="fe lw lx ly lz b">Francesc Font-Clos</code> (*)编译。</li><li id="5531" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated">通过python的pip包管理器的<code class="fe lw lx ly lz b"><a class="ae ky" href="https://pypi.org/project/Gutenberg/" rel="noopener ugc nofollow" target="_blank">Gutenberg</a></code>库。</li></ul><p id="5aba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">元数据将帮助您将每个id与给定的图书进行匹配。id对于使用<code class="fe lw lx ly lz b">Gutenberg</code> python库是必不可少的，因为这是你加载书籍的唯一方式。</p><p id="a32d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，出于好奇，我们会进行一些探索性的分析。</p><h2 id="6114" class="mo mp it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated"><strong class="ak"> 1。探索性分析</strong></h2><p id="9362" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">一旦我们装载了基本原料，</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="c21c" class="mo mp it lz b gy nq nr l ns nt">import pandas as pd<br/>import numpy as np</span></pre><p id="d0a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以继续处理元数据文件:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="bd19" class="mo mp it lz b gy nq nr l ns nt">metadata = "path-to-metadata"<br/>data_meta = pd.read_csv(metadata)</span></pre><p id="39ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看一看这个文件:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="6d9c" class="mo mp it lz b gy nq nr l ns nt">data_meta.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/60e275a47a400944497db92708fc9435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z7NP3sT38QlqopIJ6ayESw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="a381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看来<code class="fe lw lx ly lz b">Gutenberg Project</code>处理多种语言，这对于那些使用英语以外的语言的人来说很有趣。</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="327a" class="mo mp it lz b gy nq nr l ns nt">&gt;&gt;&gt; data_meta.language.value_counts()</span><span id="b64c" class="mo mp it lz b gy nv nr l ns nt">['en']                46972<br/>['fr']                 2864<br/>['fi']                 1903<br/>['de']                 1644<br/>['nl']                  782<br/>                      ...  <br/>['en', 'tl', 'es']        1<br/>['en', 'myn']             1<br/>['gl']                    1<br/>['nah']                   1<br/>['en', 'brx']             1<br/>Name: language, Length: 123, dtype: int64</span></pre><p id="393f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们只保存英文书:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="8629" class="mo mp it lz b gy nq nr l ns nt">data_meta_eng = data_meta[data_meta['language'] == "['en']"]</span></pre><p id="1fd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我们可能会遇到的一些作者:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="e671" class="mo mp it lz b gy nq nr l ns nt">&gt;&gt;&gt; np.random.choice(data_meta_eng.author.unique(), 15 )</span><span id="58ae" class="mo mp it lz b gy nv nr l ns nt">array(['Ohrwalder, Josef', 'Reese, H. B.', 'Eltzbacher, Paul',<br/>       'Denikin, Anton Ivanovich', Atkinsonn, George William',<br/>       'Hooker, Worthington', 'Olmstead, Charles H.',<br/>       'Kemp, Matthew Stanley', 'Williams, Howard', 'Boys, John',<br/>       'Slater, Gilbert', 'Austrian, Delia', 'Hodous, Lewis',<br/>       'Ostwald, Hans', 'Gildersleeve, Basil L. (Basil Lanneau)'],<br/>      dtype=object)</span></pre><h2 id="2253" class="mo mp it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated"><strong class="ak"> 2。实施:</strong></h2><p id="79e7" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">这一切都始于载入古腾堡的基本元素:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="035b" class="mo mp it lz b gy nq nr l ns nt">from gutenberg.acquire import load_etext<br/>from gutenberg.cleanup import strip_headers</span></pre><p id="eecd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，<code class="fe lw lx ly lz b">load_etext</code>通过与元数据文件中的名称相匹配的<code class="fe lw lx ly lz b">id</code>从远程镜像加载一本书。<code class="fe lw lx ly lz b">Herman Melville</code>的<code class="fe lw lx ly lz b">Moby Dick</code>可以用id <code class="fe lw lx ly lz b">2701</code>获得:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="ad8a" class="mo mp it lz b gy nq nr l ns nt">text = strip_headers(load_etext(2701)).strip()<br/>text = text.replace('\n',' ').replace('\t',' ').replace('\r',' ')</span></pre><p id="c496" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设每页平均包含250到300个单词，我们大概有一本800页的书，这很好地反映了实际长度:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="ec59" class="mo mp it lz b gy nq nr l ns nt">&gt;&gt;&gt; len(text.split())/275</span><span id="aef8" class="mo mp it lz b gy nv nr l ns nt">773.796</span></pre><p id="786f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般来说，<code class="fe lw lx ly lz b">stopwords</code>是所有可能的单词中出现频率最高的:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="d6b0" class="mo mp it lz b gy nq nr l ns nt">&gt;&gt;&gt; from collections import Counter</span><span id="e933" class="mo mp it lz b gy nv nr l ns nt">&gt;&gt;&gt; wordcount = Counter(text.split())<br/>&gt;&gt;&gt; sorted_wordcount = dict(sorted(wordcount.items(), key=lambda item: item[1], reverse=True))</span><span id="a8ad" class="mo mp it lz b gy nv nr l ns nt">{'the': 13694,<br/> 'of': 6531,<br/> 'and': 5932,<br/> 'a': 4493,<br/> 'to': 4459,<br/> 'in': 3850,<br/> 'that': 2679,<br/> 'his': 2428,<br/> 'I': 1723,<br/> 'with': 1649,<br/> 'as': 1591,<br/> 'was': 1566,<br/>...</span></pre><p id="ece0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们要处理一些NLP任务时，我们倾向于摆脱它们。在这种情况下，我们将保留它们，因为它们将构成我们生成的故事的主干，就像我们的方法一样简单。</p><p id="2985" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们把一个特殊的配方放在一起，以实现文本中的马尔可夫决策过程。</p><p id="8f50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们构建一个成对的窗口，在书中滑动:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="d124" class="mo mp it lz b gy nq nr l ns nt">from itertools import tee</span><span id="2dd9" class="mo mp it lz b gy nv nr l ns nt">def pairwise(iterable):<br/>    a, b = tee(iterable)<br/>    next(b, None)<br/>    return zip(a, b)</span><span id="be97" class="mo mp it lz b gy nv nr l ns nt">pairwise_words = pairwise(text.split())</span></pre><p id="1a1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用下一段文本运行一个小示例:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="23bf" class="mo mp it lz b gy nq nr l ns nt">This is a simple text generator. This version could be improved. This is the first version.</span></pre><p id="c446" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是实现的方式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/7f17e21779a5a6e875091fb30d19c768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTEPrGsjeeupBE3BGfrWFw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="7300" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个包含两个连续单词的所有元组的列表。</p><p id="7841" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，计算每个元组的出现是有趣的，因为它们用于计算转移概率:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/21711b033ba03ba233b899710d64680f.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*3NKDuIDq01MEz6QkPzpXPg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="77f4" class="mo mp it lz b gy nq nr l ns nt">pairwise_count = Counter(pairwise_words)</span></pre><p id="f0fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在接下来的部分，我们试图把所有这些放在一起。我们构造了一个类似于转移矩阵的东西。相反，它将由字典组成，字典由作为关键字的唯一单词以及从该唯一单词到书中下一个单词的所有转换组成。</p><p id="774e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是上一个例子的说明图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/977e7a61429cc537968e529bec1e14c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*2if63tgZWCCl2EC7tASJYQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="5520" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个输出<code class="fe lw lx ly lz b">dictionary_transitions</code>的实现，对于进一步的分析非常有用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="c1ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一个代码片段确保了我们的<code class="fe lw lx ly lz b">Markov Decision Process</code>的触发:我们通常选择<code class="fe lw lx ly lz b">“The”</code>作为序列的第一个元素。我们检查<code class="fe lw lx ly lz b">Moby Dick</code>中<code class="fe lw lx ly lz b">“The”</code>之后的所有单词的<code class="fe lw lx ly lz b">dictionary_transitions</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0e3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们选择一个具有预定概率的转换。然后我们重复这个过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/7f210349ae670fd1a46fb246b2d00e06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrUYgS4Xk1e1-dI4UYHlcw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="acad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个虚构故事的例子:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="ebe8" class="mo mp it lz b gy nq nr l ns nt">'The quantity too keenly, sir; there apart from the crowd of thy finger darted out; this through the hull go into one he had every plank and go—that’s the most buoyant matter of protrusion. If your backbones, my soul, therefore was not seen pulling for a schooner or make plain; but then mixed with rope-walks of the twenty-four hours, going to them, for all that from demonstrable, yet some ten to go a-whaling, and honorable, and feel the Town-Ho’s story, is I.'</span></pre><p id="9c3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，我们可以注意到生成的文本是多么不一致，因为每个单词都独立于它周围的所有上下文。它可以访问的唯一上下文元素是前一个单词。这并不反映现实，所以我们将增加一层复杂性，以考虑更多的背景。</p><p id="d17f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用两个词来代替一个词来预测下一个词。</p><p id="b0b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了做到这一点，我们像前面一样用一个三个单词的窗口重复这个过程，以构建一组附加到随后的单词的二元模型。</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="651d" class="mo mp it lz b gy nq nr l ns nt">def triplewise(iterable):<br/>    <br/>    result = []<br/>    <br/>    for (a, _), (b, c) in pairwise(pairwise(iterable)):<br/>        result.append((a+" "+b , c))<br/>        <br/>    return result<br/>        <br/>triplewise_words = triplewise(text.split())</span></pre><p id="231b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在前面的同一个例子中，我们将有一个包含所有二元模型元组的列表，其后续单词如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/72ad0ed2cf42ad3217fc56a9d797e7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjpydiB7VHaHrOiVYula1g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="907f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们计算出现次数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/f63731645539ae0cd325675af54286f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*JDgsRH8dJ_YY75t1jEXwXg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="1467" class="mo mp it lz b gy nq nr l ns nt">triplewise_count = Counter(triplewise_words)</span></pre><p id="ba8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们设置了<code class="fe lw lx ly lz b">dictionary_transitions_v2</code>，它将保存每个二元模型以及一组可能的后续单词和概率。与前面的实现相同(不过这个可能需要一些时间来运行) :</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/4aca21fc60cc95131ef373174d7bebef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*thiusariMhVHFtJwzahURw.png"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="612a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们启动了生成句子的过程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/79b19af0f542bf793e558bad2d8426d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHKkVBAWtZ6RXwxJRydIeA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="82a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个例子:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="9c0e" class="mo mp it lz b gy nq nr l ns nt">'The three corresponding new sails were now at the wounded planks, but we didn’t know him then; but not a cobbler’s job, that’s at an end to the road-side door.'</span></pre><p id="7f81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="1dc2" class="mo mp it lz b gy nq nr l ns nt">'The Titans, they say, and I will quit it, lest Truth shake me falsely.” “There now’s the old black, testily. “Silence! How old are you, reader, but a bubble, sing out.” All this while Tashtego, Daggoo, and Queequeg budged not.'</span></pre><p id="d2c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三个是:</p><pre class="kj kk kl km gt nm lz nn no aw np bi"><span id="1b76" class="mo mp it lz b gy nq nr l ns nt">'The people of the fight. But with Ahab the question returns whether this is both ponderous and profound. And I am told, on good authority, that Sperm Whales have been studying Murray’s Grammar! Improving his mind, poor fellow! he’ll have to say.'</span></pre></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h2 id="fd8f" class="mo mp it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">结束语:</h2><p id="1050" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">在这篇文章中，我们看到了一个基本的例子，它应该为更复杂的人工智能模型建立支柱，这些模型能够处理更长的序列，以在文本生成的情况下维护上下文。</p><p id="9e1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用了<code class="fe lw lx ly lz b">1-gram and 2-gram</code>方法来生成一些文本。我们可以增加生成单词的数量，并在一致性和意义方面感受到飞跃。</p><p id="dea8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与之前使用的数据相比，我们可以用更多的数据合并不同书籍的不同章节，我们可以积累更多的广义知识，而不会局限于一个独特的背景故事。</p><p id="c518" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但并非最不重要的是，我们的方法只考虑以前的单词作为上下文。更复杂的模型(编码器)完全有能力填补这一空白。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h2 id="dc92" class="mo mp it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">参考资料:</h2><p id="d4f9" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">(*) <a class="ae ky" href="https://arxiv.org/abs/1812.08092" rel="noopener ugc nofollow" target="_blank">自然语言统计分析和定量语言学的标准化项目古腾堡语料库</a>。</p><ol class=""><li id="beaa" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu on mg mh mi bi translated"><a class="ae ky" href="https://www.gutenberg.org/about/" rel="noopener ugc nofollow" target="_blank">古腾堡计划</a></li></ol></div></div>    
</body>
</html>