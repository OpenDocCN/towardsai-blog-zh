<html>
<head>
<title>Meme Generator (MemeGen) Using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习的迷因生成器(MemeGen)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/meme-generator-memegen-using-deep-learning-d133e6fc363f?source=collection_archive---------1-----------------------#2020-05-24">https://pub.towardsai.net/meme-generator-memegen-using-deep-learning-d133e6fc363f?source=collection_archive---------1-----------------------#2020-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="e542" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">深度学习</h2><div class=""/><p id="f731" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">MemeGen是一个web应用程序，它根据给定图像中人脸的表情自动生成迷因。用户只需上传一张清晰的照片，应用程序就会分析照片中人的表情，产生有趣的迷因。要使用网络应用程序，<a class="ae ku" href="https://bit.ly/developerscosmos-memegenerator" rel="noopener ugc nofollow" target="_blank">点击此处。</a></p><h2 id="7c42" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">这里有一些由MemeGen生成的图片:</h2><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/50f62ed60ed3a0e52df60432a148571f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*jFOhUDDrQTWRyE6bAudJkw.png"/></div></figure><h2 id="7b40" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">工作原理:</h2><p id="122b" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">要理解这个项目的运作，你需要理解几个奇特的术语，例如:</p><ul class=""><li id="8056" class="ma mb iq jy b jz ka kd ke kh mc kl md kp me kt mf mg mh mi bi translated">欠采样</li><li id="2f5f" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated">过采样</li><li id="24d5" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated">图像增强</li><li id="d0e8" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated">卷积神经网络</li><li id="5830" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated">自动ML</li></ul><p id="7210" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">难怪有一个庞大的图像数据集在幕后发挥作用。图像数据集带来了CNN的重要性。如果你不熟悉这个术语，请继续阅读！</p><h2 id="29fd" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">平衡数据:</h2><p id="392d" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">首先，让我们理解好数据的重要性，更重要的是，平衡的数据。简单来说，平衡数据是指所有可用类别的数据相等或几乎相等的情况。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/ed8c221c1ade515f868b3ac7a7258653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ZzB_4C8jmM4FXhmCDlL6MQ.jpeg"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">这是平衡数据的动画版本</figcaption></figure><h2 id="bd02" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">那么如果它们不相等会发生什么呢？</h2><p id="6b06" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">这个问题的可能答案是，你的模型最终会是蹩脚的，归功于数据集！这是因为，当你用1000张A类图片和300张B类图片训练一个模型时，很明显，这个模型看到了更多的A类图片，当你给它看一张B类图片并让它预测时，很有可能，它会预测这个图片是一个显而易见的原因。如果这看起来不太可能，想象一个模型试图在10个类之间取得平衡，每个类的数据变化很大(10000，800，350，500…)。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/a4c3d8b65eba0088d7c16f8b763ed4c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*yK1ph4VyDKAw7xba9f8pQQ.jpeg"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">我打赌你不想让你的模特代替他！</figcaption></figure><h2 id="e77a" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">现在的问题是，我们如何克服这个问题？</h2><blockquote class="mt mu mv"><p id="5613" class="jw jx mw jy b jz ka kb kc kd ke kf kg mx ki kj kk my km kn ko mz kq kr ks kt ij bi translated"><em class="iq">所以有两种可行的解决方案，过采样和欠采样！简单来说，</em></p></blockquote><ul class=""><li id="61d2" class="ma mb iq jy b jz ka kd ke kh mc kl md kp me kt mf mg mh mi bi translated">如果我们减少多数类的数据以匹配少数类的数据量并减少样本，该过程将被称为<em class="mw">欠采样</em>。</li><li id="95ba" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated">如果我们不想错过已经掌握的高质量数据，并设法增加另一个数据较少的类的样本，我们最终会增加样本总数，这被称为<em class="mw">过采样</em>。</li></ul><p id="f707" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这个故事的寓意是，数据分析中的过采样和欠采样是用来调整数据集类别分布的技术。</p></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><h2 id="60b1" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">图像增强:</h2><p id="3d0a" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">图像增强是一种用于人工扩展数据集的技术。当我们得到一个只有很少数据样本的数据集时，这是很有帮助的。它可以被认为是一种过采样的方法，主要的区别是，当你没有足够的数据时(对于所有类的组合)进行扩充，而过采样是当你在一个类中没有足够的数据时使用的一种技术。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/2b10aad83d6dd81bc5b1e0bd2e3ae640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLjkDF61bGGNYj566ppyog.jpeg"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">从一张照片中获得6张不同的照片</figcaption></figure><p id="c6e5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在我们已经有了足够的数据，并准备好建立一个模型，你认为哪一个过程会给我们最好的输出？深度学习和图像的结合立即在我们的脑海中响起了熟悉的铃声，绝对是卷积神经网络！</p><blockquote class="mt mu mv"><p id="64cb" class="jw jx mw jy b jz ka kb kc kd ke kf kg mx ki kj kk my km kn ko mz kq kr ks kt ij bi translated">CNN是一种人工神经网络，其他类型有MLP、RNN、浅层神经网络、序列对序列模型等。ANN的灵感来自于生物神经系统处理信息的方式。它由大量高度互联的处理元件(神经元)组成，这些元件协同工作以解决特定的问题。MemeGen的模型是基于CNN算法的，所以让我们简单看看它到底是做什么的。</p></blockquote></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><h2 id="204c" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">卷积神经网络(CNN):</h2><p id="c104" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">顾名思义，CNN的工作方式与人类大脑神经元的工作方式非常相似。你是否曾经密切关注过我们的大脑是如何识别人、物体和奇异的事物的？它发生得如此之快，以至于我们大多数人都没有再去想它。当我们看到一幅图像时，我们扫描图像以理解图像的不同特征。然后，我们的大脑将扫描到的不同局部特征结合起来，对图像进行分类。这正是CNN的工作方式。它获取一幅图像，将其分解成几个相等的部分，并对其进行分析，然后将每个这样的部分的理解结果进行重叠。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nm"><img src="../Images/672977e8097db0cb343966d31a85cb10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXAGSyM19rD05rj3y_4Z_g.jpeg"/></div></div></figure><p id="7854" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">CNN可以通过清楚地将它与两个关键元素联系起来来理解:</p><pre class="lo lp lq lr gt nn no np nq aw nr bi"><span id="3fbe" class="kv kw iq no b gy ns nt l nu nv">1. Convolutional Layer<br/>2. Kernel K</span></pre><p id="acd4" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">卷积层是CNN的核心构建模块，它有助于特征检测。核K是一组可学习的过滤器，并且与图像相比在空间上较小，但是贯穿输入图像的整个深度。</p><p id="0ac9" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">下面是我们在互联网上找到的一个非常令人满意的关于CNN工作方式的比喻:</p><p id="1806" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">如果你是一名侦探，你在黑暗中看到一幅很大的图像或一张照片，你会如何辨认？你将使用手电筒扫描整个图像。这正是我们在卷积层所做的。Kernel K是一个特征检测器，相当于图像I上的手电筒，我们正在尝试检测特征，并创建多个特征图来帮助我们识别或分类图像。我们有多种特征检测器来帮助边缘检测，识别不同的形状、弯曲或不同的颜色等。</p><blockquote class="mt mu mv"><p id="d578" class="jw jx mw jy b jz ka kb kc kd ke kf kg mx ki kj kk my km kn ko mz kq kr ks kt ij bi translated"><em class="iq">与传统的图像分类方法相比，CNN有几个优点，其中之一是平移不变性，这通常意味着即使物体发生平移、旋转或轻微变形，它也能识别出物体。</em></p></blockquote><p id="92ef" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这只是CNN的一个简报。看似简单，实则涉及大量的数学计算和对神经网络的理解。如果你想了解更多关于CNN，<a class="ae ku" href="https://towardsdatascience.com/simple-introduction-to-convolutional-neural-networks-cdf8d3077bac" rel="noopener" target="_blank">点击这里。</a></p></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><h2 id="b45f" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">自动ML:</h2><p id="856f" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">正如你所猜测的，Auto ML是自动训练机器学习模型并在提供数据集时找到最佳可能模型的过程。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nw"><img src="../Images/c49ab0b96d9097f8c3aa4187366be20d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FbJrTK_cQiiD_RSX.jpg"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">描述了模型如何自动试验数百万个参数以找到最佳值</figcaption></figure><p id="510b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在我们的例子中，我们使用了3个不同的数据集来获得最佳结果。</p><ul class=""><li id="a117" class="ma mb iq jy b jz ka kd ke kh mc kl md kp me kt mf mg mh mi bi translated"><em class="mw">第一个数据集:</em>日本面孔</li><li id="3a3f" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated"><em class="mw">第二个数据集:</em>印度演员的脸部照片</li><li id="243d" class="ma mb iq jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi bi translated"><em class="mw">第三数据集:</em>名人的脸部图像</li></ul><p id="1c3e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">下面是它如何工作的一个例子:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/0944741ee3151ddc2aa26ea8af4d8dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*cUg0hauX2PmCy2dUB2GgxQ.jpeg"/></div></figure><p id="7980" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这里要注意的一点是，模型A对于悲伤表情给出了很好的精度，并且60%的时间是正确的，而模型C对于悲伤表情给出了不充分的精度，并且预测它是某个其他表情，预测大约25%的时间正确。因此，我们为每个类别(表达式)的模型分配权重，以获得最佳结果。</p><blockquote class="mt mu mv"><p id="c9fb" class="jw jx mw jy b jz ka kb kc kd ke kf kg mx ki kj kk my km kn ko mz kq kr ks kt ij bi translated"><em class="iq">例如，对于sad表达式，模型A的权重将是0.8，而B和C的权重将分别是0.3和0.1。</em></p></blockquote><p id="9a46" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这确保了所有现有的模型适当地发挥它们的作用，并提供最准确的结果。</p><h2 id="1327" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">MemeGen中使用的其他技术堆栈:</h2><p id="3787" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">除了上述内容，我们还在构建MemeGen时使用了以下内容:</p><pre class="lo lp lq lr gt nn no np nq aw nr bi"><span id="6cf7" class="kv kw iq no b gy ns nt l nu nv">1. Flask as a framework <br/>2. Chef as Configuration Management tool<br/>3. Google Cloud Platform as Cloud Service</span></pre><p id="ef1b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">要了解上述术语的含义和作用，请访问我们的GitHub资源库<a class="ae ku" href="https://developers-cosmos.github.io/COVID19-FeedbackApplication/" rel="noopener ugc nofollow" target="_blank">“covid 19反馈应用”，</a>，我们在这里已经详细解释清楚了。</p><p id="0781" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">完整的代码可以在GitHub <a class="ae ku" href="https://github.com/developers-cosmos/Meme-Generator" rel="noopener ugc nofollow" target="_blank">这里找到。</a></p><h2 id="c606" class="kv kw iq bd kx ky kz dn la lb lc dp ld kh le lf lg kl lh li lj kp lk ll lm iw bi translated">结论:</h2><p id="e1b9" class="pw-post-body-paragraph jw jx iq jy b jz lv kb kc kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ij bi translated">因此，该应用程序是使用多种技术堆栈开发的。做这个项目背后的核心原因之一就是为了了解深度学习、云服务、厨师、图像增强等不同方面。希望你喜欢阅读Meme Generator中使用的所有技术栈的简化版本。如果你发现有改进的地方，请随时提出修改建议。如果你想联系，<strong class="jy ja">在</strong><a class="ae ku" href="https://www.linkedin.com/in/ritheesh-baradwaj-yellenki-8a6988173/" rel="noopener ugc nofollow" target="_blank"><strong class="jy ja">LinkedIn</strong></a><strong class="jy ja">上联系我。</strong>我会很快再赶上你的。在那之前，呆在家里，注意安全！</p></div></div>    
</body>
</html>