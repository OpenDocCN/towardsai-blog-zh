<html>
<head>
<title>Pandas Dataframes Basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据框架基础</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/pandas-dataframes-basics-c7d5a41fa018?source=collection_archive---------2-----------------------#2021-04-12">https://pub.towardsai.net/pandas-dataframes-basics-c7d5a41fa018?source=collection_archive---------2-----------------------#2021-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="59c2" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="0d71" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">重塑数据</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/22fde4e6e74a64d0ae5303e7d8554676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vm0nR3jslyQU_YkKLmnZ6A.jpeg"/></div></div></figure><p id="ec75" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在这一系列的文章中，我们将向你展示Pandas Dataframes的基础知识，它是有史以来最有用的数据科学python库之一。本系列的第一篇文章是关于重塑数据的。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="90d9" class="mg mh it bd mi mj mk ml mm mn mo mp mq ki mr kj ms kl mt km mu ko mv kp mw mx bi translated">pd.pivot:将列分散成行</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi my"><img src="../Images/fd6ab00c3d9350a19af98e78c9e539ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bnn3iJjhcH4XE1E3.jpg"/></div></div></figure><h2 id="e8a9" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="cdfe" class="mz mh it nl b gy np nq l nr ns">df = pd.DataFrame(<br/>{"A" : ['a' ,'a', 'a', 'b', 'b' ,'b'],<br/>"B" : ['A' ,'B', 'C', 'A', 'B' ,'C'],<br/>"C" : [4, 5, 6 , 7 ,8 ,9]})<br/> <br/>df</span><span id="4548" class="mz mh it nl b gy nt nq l nr ns">   A  B  C<br/>0  a  A  4<br/>1  a  B  5<br/>2  a  C  6<br/>3  b  A  7<br/>4  b  B  8<br/>5  b  C  9</span></pre><p id="6a78" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe nu nv nw nl b">df.pivot(columns='B',values='C',index='A')</code></p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="19ee" class="mz mh it nl b gy np nq l nr ns">B  A  B  C<br/>A         <br/>a  4  5  6<br/>b  7  8  9</span></pre><h1 id="1c86" class="mg mh it bd mi mj nx ml mm mn ny mp mq ki nz kj ms kl oa km mu ko ob kp mw mx bi translated">pd.melt:将列聚集成行</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/db4f3858d7e5f343224f65b52680c150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E0zyycEw3H-OXSoA.jpg"/></div></div></figure><h2 id="b6d7" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="63ab" class="mz mh it nl b gy np nq l nr ns">df=pd.DataFrame({'A': [4, 7], 'B': [5, 8], 'C': [6, 9]})</span><span id="b4c0" class="mz mh it nl b gy nt nq l nr ns">df</span><span id="6bb8" class="mz mh it nl b gy nt nq l nr ns">   A  B  C<br/>0  4  5  6<br/>1  7  8  9</span><span id="f881" class="mz mh it nl b gy nt nq l nr ns">df.melt()</span><span id="ff24" class="mz mh it nl b gy nt nq l nr ns">  variable  value<br/>0        A      4<br/>1        A      7<br/>2        B      5<br/>3        B      8<br/>4        C      6<br/>5        C      9</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6a4c" class="mg mh it bd mi mj mk ml mm mn mo mp mq ki mr kj ms kl mt km mu ko mv kp mw mx bi translated">合并数据帧</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi my"><img src="../Images/afacabddabc3e6d86b0b64ac70e76fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tsHQHv6AjOzzE5Ff.jpg"/></div></div></figure><h2 id="6eab" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="b295" class="mz mh it nl b gy np nq l nr ns">df1 <strong class="nl jd">=</strong> <!-- -->pd.DataFrame({"A"<!-- --> <!-- -->: [1<!-- --> <!-- -->,2, 3],"B"<!-- --> <!-- -->: [4, 5, 6],"C"<!-- --> <!-- -->: [7, 8, 9]})</span><span id="6e40" class="mz mh it nl b gy nt nq l nr ns">df2 <strong class="nl jd">=</strong> <!-- -->pd.DataFrame({"A"<!-- --> <!-- -->: [10<!-- --> <!-- -->,11],"B"<!-- --> <!-- -->: [12, 13],"C"<!-- --> <!-- -->: [14, 15]})</span><span id="9b69" class="mz mh it nl b gy nt nq l nr ns">print(df1</span><span id="75b1" class="mz mh it nl b gy nt nq l nr ns">print(df2)</span><span id="388e" class="mz mh it nl b gy nt nq l nr ns">   A  B  C<br/>0  1  4  7<br/>1  2  5  8<br/>2  3  6  9</span><span id="1822" class="mz mh it nl b gy nt nq l nr ns">    A   B   C<br/>0  10  12  14<br/>1  11  13  15</span></pre><p id="5191" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe nu nv nw nl b">pd.concat([df1,df2])</code></p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="8245" class="mz mh it nl b gy np nq l nr ns">    A   B   C<br/>0   1   4   7<br/>1   2   5   8<br/>2   3   6   9<br/>0  10  12  14<br/>1  11  13  15</span></pre><h1 id="e4eb" class="mg mh it bd mi mj nx ml mm mn ny mp mq ki nz kj ms kl oa km mu ko ob kp mw mx bi translated">pd.explode:将类似列表的每个元素转换为一行</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/cc765778b630aadc631c66f6b29e9e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fYhdGhjpojtArOJS.jpg"/></div></div></figure><h2 id="ad5a" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="0ef7" class="mz mh it nl b gy np nq l nr ns">df<strong class="nl jd">=</strong>pd.DataFrame({'A':[[1,2,3],[4,5,6]]})</span><span id="82ea" class="mz mh it nl b gy nt nq l nr ns">    A<br/>0  [1, 2, 3]<br/>1  [4, 5, 6]</span><span id="90b4" class="mz mh it nl b gy nt nq l nr ns">df.explode('A')</span><span id="4621" class="mz mh it nl b gy nt nq l nr ns">   A<br/>0  1<br/>0  2<br/>0  3<br/>1  4<br/>1  5<br/>1  6</span></pre><h1 id="aaa7" class="mg mh it bd mi mj nx ml mm mn ny mp mq ki nz kj ms kl oa km mu ko ob kp mw mx bi translated">堆叠:堆叠要索引的列</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/ba0cdd332075f67f2a7e9beed234b99c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t8uH8fnLOHJUCVYW.jpg"/></div></div></figure><h2 id="1089" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="532a" class="mz mh it nl b gy np nq l nr ns">df <strong class="nl jd">=</strong> <!-- -->pd.DataFrame([[0, 1], [2, 3]],index<strong class="nl jd">=</strong>['A', 'B'],columns<strong class="nl jd">=</strong>['COL1', 'COL2'])</span><span id="8a37" class="mz mh it nl b gy nt nq l nr ns">df</span><span id="f1e7" class="mz mh it nl b gy nt nq l nr ns">   COL1  COL2<br/>A     0     1<br/>B     2     3</span><span id="89d0" class="mz mh it nl b gy nt nq l nr ns">df.stack()</span><span id="3b0a" class="mz mh it nl b gy nt nq l nr ns">A  COL1    0<br/>   COL2    1<br/>B  COL1    2<br/>   COL2    3</span></pre><h1 id="585c" class="mg mh it bd mi mj nx ml mm mn ny mp mq ki nz kj ms kl oa km mu ko ob kp mw mx bi translated">拆分:从索引中拆分列</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/9d04d1d919715e46b8cce441ea53dfd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_3Z0V9XL2gy2yF-4.jpg"/></div></div></figure><h2 id="bdf1" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="004b" class="mz mh it nl b gy np nq l nr ns">index <strong class="nl jd">=</strong> <!-- -->pd.MultiIndex.from_tuples([('A', 'col1'), ('A', 'col2'),('B', 'col1'), ('B', 'col2')])</span><span id="432b" class="mz mh it nl b gy nt nq l nr ns">df <strong class="nl jd">=</strong> <!-- -->pd.Series(np.arange(1.0, 5.0), index<strong class="nl jd">=</strong>index)</span><span id="bff1" class="mz mh it nl b gy nt nq l nr ns">df</span><span id="dca1" class="mz mh it nl b gy nt nq l nr ns">A  col1    1.0<br/>   col2    2.0<br/>B  col1    3.0<br/>   col2    4.0</span><span id="a46a" class="mz mh it nl b gy nt nq l nr ns">df.unstack()</span><span id="f736" class="mz mh it nl b gy nt nq l nr ns">   col1  col2<br/>A   1.0   2.0<br/>B   3.0   4.0</span></pre><h1 id="338d" class="mg mh it bd mi mj nx ml mm mn ny mp mq ki nz kj ms kl oa km mu ko ob kp mw mx bi translated">pd.split(expand=True):将拆分的字符串展开到单独的列中</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi my"><img src="../Images/487e6608ec7b0885b35562cf0dc9e86c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZUtTJbcxyDYr_1aH.jpg"/></div></div></figure><h2 id="afad" class="mz mh it bd mi na nb dn mm nc nd dp mq lm ne nf ms lq ng nh mu lu ni nj mw iz bi translated">示例:</h2><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="501e" class="mz mh it nl b gy np nq l nr ns">df <strong class="nl jd">=</strong> <!-- -->pd.DataFrame({"A"<!-- --> <!-- -->: ['A B C'<!-- --> <!-- -->,'D E F', 'G H I']})</span><span id="22d6" class="mz mh it nl b gy nt nq l nr ns">   A<br/>0  A B C<br/>1  D E F<br/>2  G H I</span><span id="16d4" class="mz mh it nl b gy nt nq l nr ns">print(df['A'].str.split(' ',expand<strong class="nl jd">=</strong>True))</span><span id="46aa" class="mz mh it nl b gy nt nq l nr ns">   0  1  2<br/>0  A  B  C<br/>1  D  E  F<br/>2  G  H  I</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="6dc1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="of">最初发表于</em><a class="ae og" href="https://predictivehacks.com/pandas-dataframes-basics-reshaping-data/" rel="noopener ugc nofollow" target="_blank"><em class="of">https://predictivehacks.com。</em>T9】</a></p></div></div>    
</body>
</html>