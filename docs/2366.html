<html>
<head>
<title>Building a Product Recommendation Engine with AWS SageMaker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用AWS SageMaker构建产品推荐引擎</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/building-a-product-recommendation-engine-with-aws-sagemaker-321a0e7c7f7b?source=collection_archive---------0-----------------------#2021-11-24">https://pub.towardsai.net/building-a-product-recommendation-engine-with-aws-sagemaker-321a0e7c7f7b?source=collection_archive---------0-----------------------#2021-11-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="007f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，<a class="ae ep" href="https://towardsai.net/p/category/tutorial" rel="noopener ugc nofollow" target="_blank">教程</a></h2><div class=""/><div class=""><h2 id="cc72" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">了解如何使用Amazon SageMaker因式分解机构建和训练个性化推荐引擎</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c9f8c9af88cdc9a747b95b10d99e8a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5Pf3B3Cv1K5HHPIt92u6Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">从Amazon.com捕获的截屏零件</figcaption></figure><p id="215e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi md translated">信不信由你，随着互联网的使用已经成为我们生活中不可或缺的一部分，推荐系统几乎无处不在。</p><p id="1193" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在万维网上，我们每天都会遇到一个(或多个)。推荐系统正在形成网络个性化的一个重要方面，创造定制的体验，推动内容参与，增强互动，并提高销售。</p><p id="01fa" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在<strong class="lj jd">脸书</strong>、<strong class="lj jd"> Linkedin </strong>或<strong class="lj jd"> Twitter </strong>上，他们向你推荐你可能认识的人或你可以关注的社区。</p><p id="bd50" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在<strong class="lj jd"> Pinterest </strong>上，它会根据你关注的话题或你之前看过的类似内容，推荐你可能感兴趣的图钉或图板。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mm"><img src="../Images/4bccb9961eaa7c37d01851b3b708170f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ApCCEiZ9pdmpZqKanSGRrg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">Pinterest邮件内容中的推荐。作者图片</figcaption></figure><p id="b1de" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在<strong class="lj jd">亚马逊</strong>上，当购买一件商品时，它会推荐其他人经常一起购买的其他商品。</p><p id="3db2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">同样，在Coursera或Udemy上，除了你正在学习的课程之外，他们还会推荐其他学生已经注册的类似课程。</p><p id="c102" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">那么，为什么我们需要推荐系统，为什么它们如此重要？</p><blockquote class="mn"><p id="1578" class="mo mp it bd mq mr ms mt mu mv mw mc dk translated">“我们从一个匮乏的时代走向了一个富足的时代”</p></blockquote><blockquote class="mx my mz"><p id="1413" class="lh li na lj b lk nb kd lm ln nc kg lp nd ne ls lt nf ng lw lx nh ni ma mb mc im bi translated">货架空间是一种稀缺商品，它限制了零售商可以销售的商品数量。</p><p id="837b" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">一个电视网只能播放这么多节目，因为一天只有这么多小时。</p><p id="a70b" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">电影院也是如此。电影院只有这么多，所以他们现在只能为银幕提供一定数量的电影。</p><p id="3546" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">一旦互联网被开发出来，事情就变了。网络实现了零成本的产品信息传播，这意味着我们可以拥有比以往更多的产品。</p><p id="af67" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">来源:<a class="ae nj" href="https://www.youtube.com/watch?v=1JRrCEgiyHM&amp;list=PLLssT5z_DsK9JDLcT8T62VtzwyW9LNepV&amp;index=41" rel="noopener ugc nofollow" target="_blank">推荐系统概述</a></p></blockquote><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/9356997924674a07a50937fb7d8abe89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*znzFOITTYGC7vpD6"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae nj" href="https://unsplash.com/@nicosmit99?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Nico Smit </a>在<a class="ae nj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8f5a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在当今世界，越来越多的事情是通过互联网在线完成的，从杂货店购物到看视频、听音乐、为下次度假预订住宿和交通工具、为生日庆祝预订餐饮和餐馆等等。</p><p id="55dd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在传统的实体店中，产品陈列在货架上，你可以看到并挑选你喜欢的并购买。</p><p id="d415" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然而在网络世界，可用的物品、选择和供应品的数量是如此多样和广泛。我们的选择几乎是无限的。即使提供了搜索功能，有时我们甚至不知道要找什么。这就是推荐系统的作用所在。它帮助我们发现事物，解开新的内容。如果没有推荐系统，许多产品或服务将会远离人们的视线，永远不会出现。这并不意味着他们不好，只是他们被其他更受欢迎的人所掩盖。</p><p id="38a0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了说明推荐系统的威力，<a class="ae nj" href="https://www.wired.com/2004/10/tail/" rel="noopener ugc nofollow" target="_blank">《长尾理论》</a>引用了一本名为<strong class="lj jd"> <em class="na">《触摸虚空》</em> </strong>的书获得了不错的评价，但很快就被遗忘了。然后，十年后，一本名为《消失在空气中的<strong class="lj jd"><em class="na"/></strong>的新书轰动了出版界。随着亚马逊的推荐，一个积极的反馈循环开始了。<strong class="lj jd"> <em class="na">触空</em> </strong>又开始卖了，而且卖得比<strong class="lj jd"><em class="na"/></strong>多了两倍。</p><blockquote class="mx my mz"><p id="e127" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">“亚马逊通过将无限的货架空间与关于购买趋势和公众意见的实时信息结合起来，创造了<strong class="lj jd">触空</strong>现象。结果是:对一本晦涩难懂的书的需求不断上升。”— <a class="ae nj" href="https://www.wired.com/2004/10/tail/" rel="noopener ugc nofollow" target="_blank">长尾巴</a></p></blockquote></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="01b5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本文中，我们将演示如何使用Amazon Sagemaker因式分解机器为在线零售店构建和训练个性化推荐引擎。我们还将把训练好的模型部署到Amazon SageMaker托管的端点，并进行实时推理。</p><h1 id="13a5" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">内容</h1><p id="1985" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated"><a class="ae nj" href="#b27c" rel="noopener ugc nofollow"> 1。亚马逊SageMaker因式分解机</a> <br/> <a class="ae nj" href="#e5c1" rel="noopener ugc nofollow"> 2。数据集</a> <br/> <a class="ae nj" href="#d158" rel="noopener ugc nofollow"> 3。数据清理</a> <br/> <a class="ae nj" href="#3638" rel="noopener ugc nofollow"> 4。创建稀疏矩阵</a> <br/> ∘ <a class="ae nj" href="#8528" rel="noopener ugc nofollow">分类数据的一键编码</a> <br/> ∘ <a class="ae nj" href="#3106" rel="noopener ugc nofollow">文本数据的TF-IDF编码</a> <br/> ∘ <a class="ae nj" href="#2eed" rel="noopener ugc nofollow">所有特征的稀疏矩阵</a> <br/> <a class="ae nj" href="#b70a" rel="noopener ugc nofollow"> 5 .将数据拆分成训练集和测试集</a> <br/> <a class="ae nj" href="#36b4" rel="noopener ugc nofollow"> 6。创建稀疏记录文件</a> <br/> <a class="ae nj" href="#0f27" rel="noopener ugc nofollow"> 7。训练工作&amp;超参数</a> <br/> <a class="ae nj" href="#e94c" rel="noopener ugc nofollow"> 8。列车型号</a> <br/> <a class="ae nj" href="#f24d" rel="noopener ugc nofollow"> 9。部署型号</a> <br/> <a class="ae nj" href="#02cd" rel="noopener ugc nofollow"> 10。模型推断</a> <br/> <a class="ae nj" href="#6f54" rel="noopener ugc nofollow">总结</a></p><h1 id="b27c" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">1.亚马逊SageMaker因子分解机</h1><p id="2777" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated"><a class="ae nj" href="https://aws.amazon.com/sagemaker/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">亚马逊SageMaker </strong> </a>是一个完全托管的服务，你可以用它来构建、训练、调优、部署和优化机器学习模型。</p><p id="ddfe" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">因式分解机</strong> </a>是亚马逊SageMaker的内置算法之一。这种受监督的机器学习算法可以对回归和二元分类类型的问题进行操作，并且能够处理稀疏数据。如果你有兴趣阅读Steffen Rendle关于因式分解机器的原始论文，你可以点击这个<a class="ae nj" href="https://www.csie.ntu.edu.tw/~b97053/paper/Rendle2010FM.pdf" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="4410" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们将用于构建推荐引擎的方法，如one-hot编码和TF-IDF编码(我们将在后面介绍)，改编自<a class="ae nj" href="https://www.youtube.com/watch?v=o_p_8HXh0tY" rel="noopener ugc nofollow" target="_blank">如何使用Amazon SageMaker </a>提供个性化推荐。</p><h1 id="e5c1" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">2.数据集</h1><p id="3527" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">我们将要使用的数据集是<a class="ae nj" href="https://s3.amazonaws.com/amazon-reviews-pds/readme.html" rel="noopener ugc nofollow" target="_blank">亚马逊客户评论数据集</a>。该公共数据集在AWS美国东部地区的<code class="fe op oq or os b">amazon-reviews-pds</code> S3桶中可用，采用制表符分隔值(TSV)格式和拼花格式。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/8755e6856082916fe7850e3d213d24e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRXHTzdG_q8tWERMymgePQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><code class="fe op oq or os b">amazon-reviews-pds</code>AWS中的S3斗</figcaption></figure><p id="ef9f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">出于本教程的目的，我们将只使用TSV格式的数据，用于两个类别的美国评论:<em class="na">个人护理设备</em>和<em class="na">主要设备</em>。</p><p id="89d5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">关于每个字段信息的更多细节可以在TSV索引文件的<a class="ae nj" href="https://s3.amazonaws.com/amazon-reviews-pds/tsv/index.txt" rel="noopener ugc nofollow" target="_blank">数据列</a>部分找到。</p><h1 id="d158" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">3.数据清理</h1><p id="4b84" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">需要对这个数据集进行一些数据清理。</p><p id="7b7a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们从检查和处理重复记录开始。对于我们的任务，我们希望客户对某个特定产品只有一个评论和评级。然而，在现实生活中，对于一个客户来说，同一个产品确实有可能有多个评论和评级。我们认为这是重复的，尽管我们知道每个记录中的评论和评级可能不同。</p><p id="8a65" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这种情况通常发生在客户在购买产品后不久给出一个评论和评级，然后在使用一段时间后对同一产品提供另一个评论和评级。在这种情况下，我们将只考虑最近的评论和评级，它更准确地反映了客户对该特定产品的情绪和意见。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/208ce5037358607cf7e252b3c5d973e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1p8x9yYgUwByFFTchC6nBA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">客户对特定产品有多个评论和评级的示例</figcaption></figure><p id="83d7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以通过<code class="fe op oq or os b">customer_id</code>、<code class="fe op oq or os b">product_id</code>、<code class="fe op oq or os b">product_title</code>和<code class="fe op oq or os b">product_category</code>对记录进行分组，以找到这样的事件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/31a0b6f919055c416499ec16fcd140e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7cFTERdUwNoQq1KYCoxVMg.png"/></div></div></figure><p id="fffc" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了只保留最近的记录，我们对数据进行排序，然后通过指定<code class="fe op oq or os b">keep=‘last’</code>来调用Pandas <code class="fe op oq or os b">drop_duplicates()</code>方法。</p><pre class="ks kt ku kv gt ow os ox oy aw oz bi"><span id="39e3" class="pa nt it os b gy pb pc l pd pe">df.sort_values(by=['customer_id', 'product_id', 'review_date'], inplace=True)</span><span id="9944" class="pa nt it os b gy pf pc l pd pe">df.drop_duplicates(['customer_id', 'product_id'], keep='last', inplace=True)</span></pre><p id="01dc" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们还检查丢失的数据，并用空字符串替换<code class="fe op oq or os b">product_title</code>丢失的内容。</p><pre class="ks kt ku kv gt ow os ox oy aw oz bi"><span id="ba17" class="pa nt it os b gy pb pc l pd pe">df["product_title"].fillna("", inplace=True)</span></pre><p id="d639" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们的任务中，我们将在过滤已验证购买的记录(<code class="fe op oq or os b">df['verified_purchase']=='Y'</code>)后，只处理以下各列:</p><ul class=""><li id="6587" class="pg ph it lj b lk ll ln lo lq pi lu pj ly pk mc pl pm pn po bi translated"><code class="fe op oq or os b">customer_id</code> —唯一的客户标识符</li><li id="4dd8" class="pg ph it lj b lk pp ln pq lq pr lu ps ly pt mc pl pm pn po bi translated"><code class="fe op oq or os b">product_id </code> —唯一的产品标识符</li><li id="a949" class="pg ph it lj b lk pp ln pq lq pr lu ps ly pt mc pl pm pn po bi translated"><code class="fe op oq or os b">product_title</code> —产品的标题</li><li id="354e" class="pg ph it lj b lk pp ln pq lq pr lu ps ly pt mc pl pm pn po bi translated"><code class="fe op oq or os b">product_category</code> —产品类别</li><li id="5fc9" class="pg ph it lj b lk pp ln pq lq pr lu ps ly pt mc pl pm pn po bi translated"><code class="fe op oq or os b">star_rating</code> —点评的1-5星级</li></ul><p id="2607" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们来看看按产品类别划分的记录分布。我们在<code class="fe op oq or os b">Major Appliances</code>下有将近7万条记录，在<code class="fe op oq or os b">Personal_Care_Appliances</code>下有大约6.3万条记录。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/fa69273e2136966a7a127727c993ad84.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*RC-gOgns_DAmeb4I_dKlHw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="1b61" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于星级评定，大多数唱片都获得了5星级评定，其中有近80K张。大约22K张唱片获得了4星评级，而三星级及以下的唱片都远低于20K张。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/224fc3a55f3ee4f10dc541fb48147880.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*rFeeh0YgV5H3pnNEWiYEqA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="2057" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面的条形图显示了两个产品类别中独特客户和独特产品的分布情况。</p><p id="7ea2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><code class="fe op oq or os b">Major Appliances</code>下约有66K个独立客户和8K个独立产品，而<code class="fe op oq or os b">Personal_Care_Appliances</code>下约有62K个独立客户和12K个独立产品。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/c4c91018ff7a32c57dcea77235e275c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*siKS8pYSvtyaI93aZHu36g.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h1 id="3638" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">4.创建稀疏矩阵</h1><h2 id="8528" class="pa nt it bd nu pw px dn ny py pz dp oc lq qa qb oe lu qc qd og ly qe qf oi iz bi translated">分类数据的一键编码</h2><p id="8b32" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">对于分类数据，我们将对<code class="fe op oq or os b">customer_id</code>、<code class="fe op oq or os b">product_id</code>和<code class="fe op oq or os b">product_category</code>执行<a class="ae nj" href="https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/" rel="noopener ugc nofollow" target="_blank">一键编码</a>。结果将是132，044行和147，967列的稀疏矩阵。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/6702d651eaf123fee21650cbd86f6b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*EavURQirwe3dZmGNDSpx-w.png"/></div></figure><h2 id="3106" class="pa nt it bd nu pw px dn ny py pz dp oc lq qa qb oe lu qc qd og ly qe qf oi iz bi translated">文本数据的TF-IDF编码</h2><p id="ed05" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">至于文本数据，我们将执行TF-IDF编码。</p><p id="ade2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> TF-IDF </strong>代表“<strong class="lj jd"> <em class="na">词频——逆文档频率</em></strong><em class="na">”</em><strong class="lj jd">。</strong>根据<a class="ae nj" href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank">维基百科</a>、<em class="na">的定义，它是一种数字统计，旨在反映一个词对集合或语料库中的文档(或我们上下文中的产品)有多重要。结合了逆文档频率因子，其减少了在文档集中非常频繁出现的术语的权重，并增加了很少出现的术语的权重。</em>”</p><p id="69f1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们会用<code class="fe op oq or os b"><a class="ae nj" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" rel="noopener ugc nofollow" target="_blank">sklearn.feature_extraction.text.TfidfVectorizer</a></code>。这将把文本集合转换成TF-IDF编码特征的矩阵。</p><p id="b3df" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了让大家了解TF-IDF编码的结果是什么样的，我们使用下面一个包含4条文本数据记录的例子。TF-IDF编码的相应结果，也称为TF-IDF编码特征矩阵，如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/ef4d313aac4e4f019dc8054936f10283.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*-rzLMM7aEQP2JueGR7xmfg.png"/></div></figure><p id="bfde" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Scikit-learn的<a class="ae nj" href="https://scikit-learn.org/stable/modules/feature_extraction.html#text-feature-extraction" rel="noopener ugc nofollow" target="_blank">文本特征提取</a>文档提供了关于标记化、出现计数和TF-IDF公式的细节。</p><p id="5492" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">回到我们的数据集，在<code class="fe op oq or os b">product_title</code>上应用TF-IDF编码的结果将是一个132，044行和8，671列的稀疏矩阵。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qi"><img src="../Images/c6d008bedcb865644b5cc16ed39ea60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*mATwEJ-WjHt21XHz3sC2mw.png"/></div></figure><h2 id="2eed" class="pa nt it bd nu pw px dn ny py pz dp oc lq qa qb oe lu qc qd og ly qe qf oi iz bi translated">所有特征的稀疏矩阵</h2><p id="ef72" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated"><code class="fe op oq or os b">X</code>是一个稀疏矩阵，它包含了我们所有的特征(即一键编码特征和TF-IDF编码特征)。我们将通过并排堆叠上述矩阵来构造<code class="fe op oq or os b">X</code>。结果是一个132，044行和156，638列的矩阵！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/3190c3aceefc4d68a250baa88e80521b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*MQ2vnziH9K-7trBsGPy3ag.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/219b5a86d6a3437028aec345fb5e1d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*cohuy0O3TsWnkPckU5qDWg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">稀疏矩阵的构成</figcaption></figure><p id="f51a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">那标签呢？嗯，至于标签(或目标变量)，我们将有<code class="fe op oq or os b">y</code>，数组形式的<code class="fe op oq or os b">star_rating</code>。这是我们将在回归任务中预测的。我们假设预测值越高，客户就越有可能喜欢或购买该产品。</p><pre class="ks kt ku kv gt ow os ox oy aw oz bi"><span id="452d" class="pa nt it os b gy pb pc l pd pe">y = df["star_rating"].values.astype("float32")</span></pre><p id="31bb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你想知道我们的数据有多稀疏，那么，我们的数据是99.9929%稀疏！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/215ae92793e9c070dcbe62b6dcc8aae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*kuRJlbhe3521hdmNsarQ5w.png"/></div></figure><h1 id="b70a" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">5.将数据分为训练集和测试集</h1><p id="5005" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">我们现在将使用<code class="fe op oq or os b"><a class="ae nj" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">sklearn.model_selection.train_test_split</a></code>将我们的数据分成80%的训练集和20%的测试集。拆分后，我们的训练数据包含约105.6K条记录，我们的测试数据包含约26.4K条记录。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/b4cef5cd4a9bdfad09c3d672309e5800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*cv_N92s4DEUc4PNYhb0L-Q.png"/></div></figure><h1 id="36b4" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">6.创建稀疏记录文件</h1><blockquote class="mx my mz"><p id="599c" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">对于<strong class="lj jd">训练</strong>，因式分解机器算法目前仅支持具有<code class="fe op oq or os b"><em class="it">Float32</em></code>张量的<code class="fe op oq or os b"><em class="it">recordIO-protobuf</em></code>格式。因为它们的用例主要基于稀疏数据，<code class="fe op oq or os b"><em class="it">CSV</em></code>不是一个好的候选。</p><p id="6938" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">对于<strong class="lj jd">推理</strong>，因式分解机算法支持<code class="fe op oq or os b"><em class="it">application/json</em></code>和<code class="fe op oq or os b"><em class="it">x-recordio-protobuf</em></code>格式。</p><p id="af05" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">来源:<a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html" rel="noopener ugc nofollow" target="_blank"> AWS </a></p></blockquote><p id="bd06" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们将创建一个函数来编写稀疏RecordIO文件，这些文件将用于模型训练。为此，我们使用<code class="fe op oq or os b"><a class="ae nj" href="https://github.com/aws/sagemaker-python-sdk/blob/master/src/sagemaker/amazon/common.py" rel="noopener ugc nofollow" target="_blank">sagemaker.amazon.common</a></code>包中的<code class="fe op oq or os b">write_spmatrix_to_sparse_tensor</code>函数将<code class="fe op oq or os b">scipy</code>稀疏矩阵转换为稀疏张量。</p><p id="341d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们还将创建一个将文件上传到亚马逊S3的功能。这是因为Amazon SageMaker希望培训和测试文件位于S3。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="qn qo l"/></div></figure><p id="1c41" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">要将文件上传到S3，我们首先需要定义bucket、前缀(您可以将前缀想象成一个文件夹)和key(对象名)。</p><p id="bccd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在下面的代码中，我们还指定了<code class="fe op oq or os b">output_location</code>，在S3的位置，由训练作业创建的模型工件将被存储在这里。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/8240ad1d174e110ab6fe6d0f1f7876f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*Yef0vZmO-Xx3x7wR1t9tnw.png"/></div></figure><h1 id="0f27" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">7.培训工作和超参数</h1><p id="f147" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">这里，我们为我们的培训工作定义了<code class="fe op oq or os b">job_name</code>。我们使用<code class="fe op oq or os b"><a class="ae nj" href="https://sagemaker.readthedocs.io/en/v2.68.0/api/utility/image_uris.html" rel="noopener ugc nofollow" target="_blank">sagemaker.image_uris.retrieve</a></code>为我们将要使用的内置算法(因式分解机器)获取一个预构建的Docker容器。为了获得允许Amazon SageMaker(一个托管服务)代表我们执行操作的角色，我们使用了<code class="fe op oq or os b"><a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-roles.html" rel="noopener ugc nofollow" target="_blank">sagemaker.get_execution_role()</a></code>。</p><p id="5ecb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果我们计划使用<a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/model-managed-spot-training.html" rel="noopener ugc nofollow" target="_blank">管理的现场训练</a>，我们需要设置<code class="fe op oq or os b">max_run</code>时间和<code class="fe op oq or os b">max_wait</code>时间，并指定<code class="fe op oq or os b">checkpoint_s3_uri</code>，在S3的位置将保存检查点。这些参数连同<code class="fe op oq or os b">container</code>、<code class="fe op oq or os b">role</code>、<code class="fe op oq or os b">output_location</code>、<code class="fe op oq or os b">sess</code>、<code class="fe op oq or os b">job_name</code>将在用<code class="fe op oq or os b"><a class="ae nj" href="https://aws.amazon.com/sagemaker/pricing/" rel="noopener ugc nofollow" target="_blank">ml.m4.xlarge</a></code>实例初始化<code class="fe op oq or os b">Estimator</code>时被传递。</p><p id="b135" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><code class="fe op oq or os b"><a class="ae nj" href="https://sagemaker.readthedocs.io/en/stable/api/training/estimators.html" rel="noopener ugc nofollow" target="_blank">Estimator</a></code>是一个高级接口，可以处理Amazon SageMaker培训和部署任务。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="qn qo l"/></div></figure><p id="2577" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于因式分解机器超参数，我们将83设置为要运行的<code class="fe op oq or os b">epochs</code>的数量，将<code class="fe op oq or os b">predictor_type</code>设置为“回归变量”,因为我们正在运行回归任务。<code class="fe op oq or os b">feature_dim</code>是指特征维度，即我们训练数据的列数。我们将为<code class="fe op oq or os b">num_factors</code>使用默认值64，为<code class="fe op oq or os b">mini_batch_size</code>使用默认值1000。</p><p id="669d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你可以阅读<a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines-hyperparameters.html" rel="noopener ugc nofollow" target="_blank">这里</a>关于因式分解机器超参数的细节。如果您希望对因式分解机器执行超参数调整，请参考<a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/fm-tuning.html#fm-tunable-hyperparameters" rel="noopener ugc nofollow" target="_blank">可调超参数</a>。</p><blockquote class="mx my mz"><p id="2e4b" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated"><strong class="lj jd">托管现场培训</strong>可以优化培训模型的成本，与按需实例相比，最多可降低90%。SageMaker代表您管理现场中断。</p><p id="0c25" class="lh li na lj b lk ll kd lm ln lo kg lp nd lr ls lt nf lv lw lx nh lz ma mb mc im bi translated">来源:<a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/model-managed-spot-training.html" rel="noopener ugc nofollow" target="_blank"> AWS </a></p></blockquote><h1 id="e94c" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">8.火车模型</h1><p id="5478" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">为了开始训练我们的模型，我们调用<code class="fe op oq or os b">fit()</code>方法并传入我们的训练和测试文件的位置。</p><pre class="ks kt ku kv gt ow os ox oy aw oz bi"><span id="5a4f" class="pa nt it os b gy pb pc l pd pe">estimator.fit({'train':train_file_location, <br/>               'test':test_file_location})</span></pre><p id="a6be" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当作业运行时，我们将能够在屏幕上看到打印的日志。</p><p id="4371" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">作业完成后，结果、状态、训练秒数和计费秒数将显示在最后。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qq"><img src="../Images/dbffa649f21a94b4946641923c13c934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLQU8IzqInl9_BvwkE-qQw.png"/></div></div></figure><h1 id="f24d" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">9.部署模型</h1><p id="7892" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">在模型训练成功完成后，我们可以调用<code class="fe op oq or os b">deploy()</code>方法将训练好的模型部署到Amazon SageMaker托管的端点。这是我们可以进行调用以获得实时推断的地方。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="qn qo l"/></div></figure><h1 id="02cd" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">10.模型推理</h1><p id="96b3" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">对于模型推断，我们将演示一个从促销产品池中预测前3名产品以推荐给客户的示例。</p><p id="ab01" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们的例子中，我们将使用<code class="fe op oq or os b">customer_id</code> 42799904，它是顶级客户之一。该客户之前为<code class="fe op oq or os b">Personal_Care_Appliances</code>下的3个产品和<code class="fe op oq or os b">Major Appliances</code>下的2个产品提供了评级。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qr"><img src="../Images/122b2efc5d03dde9dd22053b4c47ab3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xx2Fa5AhEL2aa5bc-zKyuw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><code class="fe op oq or os b">customer_id</code> 42799904给出的产品评级历史记录</figcaption></figure><p id="0804" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以在下面看到总共8个趋势产品，每个类别4个。想象一下，这就是我们想要向客户提供和推荐的促销产品。我们将该数据称为<em class="na">趋势产品数据集</em>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="qn qo l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qs"><img src="../Images/c924a9c55434e25c684e36153ccdddc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BvgkRcjWbzS_r8TQvxPToQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">趋势产品数据集。每个类别有4种产品。</figcaption></figure><p id="c978" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从<em class="na">趋势产品数据集</em>中，我们的目标是获得前3名产品推荐给<code class="fe op oq or os b">customer_id</code> 42799904(基于<code class="fe op oq or os b">star_rating</code>的预测值)。</p><p id="a54c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在调用模型推理之前，我们需要再次执行与之前相同的one-hot编码和TF-IDF编码，只是这次<code class="fe op oq or os b">transform</code>位于<em class="na">趋势产品数据集</em>上。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="qn qo l"/></div></figure><p id="7a2b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了调用模型推理，我们调用<code class="fe op oq or os b">predict()</code>方法，传入已经转换为数组的<code class="fe op oq or os b">X_trending</code>稀疏矩阵。</p><p id="850c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如下所示，该模型返回了<code class="fe op oq or os b">score</code>，这是<em class="na">趋势产品数据集</em>中相应记录的预测值。</p><p id="b2a3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><code class="fe op oq or os b"><a class="ae nj" href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html" rel="noopener ugc nofollow" target="_blank">argsort()</a></code>用于获取将对返回的预测数组进行排序的索引。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qt"><img src="../Images/dff12bf7ca06e2e61c78eed541fcd5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*izNc7ieYzW18Mu4Z9JYm7Q.png"/></div></figure><p id="ac77" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，我们使用<code class="fe op oq or os b">ohe.inverse_transform</code>将数据转换为原始表示，我们得到了<code class="fe op oq or os b">product_id</code>的列表。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qu"><img src="../Images/eb301ff157aeb743511db03945693ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*9E3Z5h6R6NGXa_voawunYw.png"/></div></figure><p id="3d49" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我们逆序取最后3个乘积，因为排序后，预测值较大的记录在最后。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/7cb8ed9e457a239ebbc6d5c8357610ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*7wKuk6U-Z-fuwU8DlOXKaA.png"/></div></figure><p id="fc49" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">瞧啊。开始吧，这些是<code class="fe op oq or os b">customer_id</code> 42799904的前3个推荐产品。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qw"><img src="../Images/10d86e7779d2cf4e7f0f43854a9420ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*GB4bjWD2AcqxoKW5uSpghA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><code class="fe op oq or os b">customer_id</code> 42799904前3名推荐产品。</figcaption></figure><p id="8da1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">目前就这些。我们已经使用Amazon Sagemaker因式分解机成功地构建和训练了个性化推荐引擎，部署了模型，并调用了实时推理。</p><p id="6b43" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果您正在跟进，不要忘记删除端点并停止SageMaker实例，以避免AWS产生不必要的费用。</p><h1 id="6f54" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">摘要</h1><p id="e2d6" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">☑️:我们对数据集进行了必要的数据清理。</p><p id="5999" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">☑️我们对分类数据应用了一键编码，对文本数据应用了TF-IDF编码，以创建模型特征的稀疏矩阵。</p><p id="fbd0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">☑️:我们把数据转换成RecordIO格式，然后上传到S3。</p><p id="7984" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">☑️:我们学习了如何使用亚马逊SageMaker因式分解机来构建和训练一个推荐引擎。</p><p id="f62b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">☑️培训之后，我们在SageMaker管理端点上部署了该模型。</p><p id="4548" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">☑️:我们通过一个实时模型推断的例子，根据预测的星级来获得推荐给客户的前3名产品。</p><p id="1c64" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我希望你喜欢这个教程。</p><p id="1fe0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="na">如果你喜欢我的帖子，别忘了点击</em> <a class="ae nj" href="https://peggy1502.medium.com/" rel="noopener"> <strong class="lj jd"> <em class="na">关注</em> </strong> </a> <em class="na">和</em> <a class="ae nj" href="https://peggy1502.medium.com/subscribe" rel="noopener"> <strong class="lj jd"> <em class="na">订阅</em> </strong> </a> <em class="na">以获得邮件通知。</em></p><p id="c32b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="na">你也可以选择</em> <a class="ae nj" href="https://peggy1502.medium.com/membership" rel="noopener"> <em class="na">注册</em> </a> <em class="na">成为媒体会员，以获得媒体上所有故事的完整访问权限。</em></p><p id="3a5d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">📑<em class="na">访问这个</em><a class="ae nj" href="https://github.com/peggy1502/Data-Science-Articles/blob/main/README.md" rel="noopener ugc nofollow" target="_blank"><em class="na">GitHub repo</em></a><em class="na">获取我在帖子中分享的所有代码和笔记本。</em></p><p id="149a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">2021保留所有权利。</p><h1 id="121c" class="ns nt it bd nu nv nw nx ny nz oa ob oc ki od kj oe kl of km og ko oh kp oi oj bi translated">参考资料:</h1><p id="7ae1" class="pw-post-body-paragraph lh li it lj b lk ok kd lm ln ol kg lp lq om ls lt lu on lw lx ly oo ma mb mc im bi translated">【1】<a class="ae nj" href="https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html" rel="noopener ugc nofollow" target="_blank">亚马逊SageMaker因子分解机</a></p><p id="90e1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[2] <a class="ae nj" href="https://www.youtube.com/watch?v=1JRrCEgiyHM&amp;list=PLLssT5z_DsK9JDLcT8T62VtzwyW9LNepV&amp;index=41" rel="noopener ugc nofollow" target="_blank">推荐系统概述</a></p><p id="c61e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[3] <a class="ae nj" href="https://www.youtube.com/watch?v=o_p_8HXh0tY" rel="noopener ugc nofollow" target="_blank">如何使用亚马逊SageMaker提供个性化推荐</a></p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="0db7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你想查看更多关于机器学习、亚马逊SageMaker的资源，或者如果你打算参加<a class="ae nj" href="https://towardsdatascience.com/aws-certified-machine-learning-specialty-97eacbd1a0fe" rel="noopener" target="_blank"> AWS认证机器学习专业</a>，请点击下面的<a class="ae nj" href="https://towardsdatascience.com/aws-certified-machine-learning-specialty-97eacbd1a0fe" rel="noopener" target="_blank">链接</a>。</p><div class="qx qy gp gr qz ra"><a href="https://towardsdatascience.com/aws-certified-machine-learning-specialty-97eacbd1a0fe" rel="noopener follow" target="_blank"><div class="rb ab fo"><div class="rc ab rd cl cj re"><h2 class="bd jd gy z fp rf fr fs rg fu fw jc bi translated">AWS认证机器学习—专业</h2><div class="rh l"><h3 class="bd b gy z fp rf fr fs rg fu fw dk translated">关于如何准备和通过考试的提示和建议</h3></div><div class="ri l"><p class="bd b dl z fp rf fr fs rg fu fw dk translated">towardsdatascience.com</p></div></div><div class="rj l"><div class="rk l rl rm rn rj ro lb ra"/></div></div></a></div><p id="7d8c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有兴趣了解变形金刚吗？我有以下的帖子给你。</p><div class="qx qy gp gr qz ra"><a href="https://towardsdatascience.com/transformers-can-you-rate-the-complexity-of-reading-passages-17c76da3403" rel="noopener follow" target="_blank"><div class="rb ab fo"><div class="rc ab rd cl cj re"><h2 class="bd jd gy z fp rf fr fs rg fu fw jc bi translated">变形金刚，你能评价阅读段落的复杂程度吗？</h2><div class="rh l"><h3 class="bd b gy z fp rf fr fs rg fu fw dk translated">用PyTorch微调RoBERTa以预测文本摘录的阅读难易程度</h3></div><div class="ri l"><p class="bd b dl z fp rf fr fs rg fu fw dk translated">towardsdatascience.com</p></div></div><div class="rj l"><div class="rp l rl rm rn rj ro lb ra"/></div></div></a></div><div class="qx qy gp gr qz ra"><a href="https://towardsdatascience.com/advanced-techniques-for-fine-tuning-transformers-82e4e61e16e" rel="noopener follow" target="_blank"><div class="rb ab fo"><div class="rc ab rd cl cj re"><h2 class="bd jd gy z fp rf fr fs rg fu fw jc bi translated">微调变压器的先进技术</h2><div class="rh l"><h3 class="bd b gy z fp rf fr fs rg fu fw dk translated">学习这些先进的技术，看看它们如何帮助改善结果</h3></div><div class="ri l"><p class="bd b dl z fp rf fr fs rg fu fw dk translated">towardsdatascience.com</p></div></div><div class="rj l"><div class="rq l rl rm rn rj ro lb ra"/></div></div></a></div></div></div>    
</body>
</html>