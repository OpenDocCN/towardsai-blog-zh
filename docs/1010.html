<html>
<head>
<title>Linear Regression: Why it Matters and How to Write the Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归:为什么它很重要以及如何编写代码</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/linear-regression-why-it-matters-and-how-to-write-the-code-1028008b65c5?source=collection_archive---------2-----------------------#2020-10-06">https://pub.towardsai.net/linear-regression-why-it-matters-and-how-to-write-the-code-1028008b65c5?source=collection_archive---------2-----------------------#2020-10-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f20e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="9b1b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">构建线性回归模型的简单步骤</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/34f4a2889dbf022774b5407a31d3fc36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l0ykg65TP5ko9gl_"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="12ac" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">什么是线性回归？</strong></h1><p id="42d2" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">线性回归是一种统计程序，用于找出两个或多个变量之间的关系。我们知道，年龄和身高是两个相互关联的变量——也就是说，随着孩子年龄的增长，他们会长得更高。</p><p id="f0f9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">机器学习采用这种统计概念，根据另一个变量(称为<em class="nb">独立变量或预测变量</em>)的已知量来预测未知量(称为<em class="nb">因变量</em>)。这意味着如果我们知道一个孩子的年龄，我们可以合理地预测他们的身高。找到这种关系的算法叫做<strong class="mc jd">回归</strong>。</p><p id="3b89" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果只有一个变量被用作预测因子(上面例子中的年龄对身高)，那么它被称为<strong class="mc jd">简单线性回归</strong>。然而，有时预测需要不止一个预测因子——这被称为<strong class="mc jd">多元回归</strong>。多元回归的一个例子是根据树的年龄和高度预测树的体积。</p><h1 id="dd9c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">申请</strong></h1><p id="0d64" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我们知道，机器学习问题大致分为分类问题或回归问题。分类算法用于结果为非数字或分类的情况(例如，对鸢尾花的种类进行分类)。另一方面，如果结果是一个连续变量(如身高)，分类算法不起作用，这就是回归算法派上用场的地方。</p><p id="e3d5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在机器学习领域有许多回归的用例。一些例子包括:</p><ul class=""><li id="8686" class="nc nd it mc b md mw mg mx mj ne mn nf mr ng mv nh ni nj nk bi translated">根据品牌、型号、颜色、年份、车门等属性确定汽车的<strong class="mc jd">价格。</strong></li><li id="427a" class="nc nd it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated">根据卧室数量、建造年份、面积、位置等属性预测房价。</li><li id="5158" class="nc nd it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated">根据客户属性，如年龄、驾驶记录、所拥有汽车的类型等，确定<strong class="mc jd">保险费</strong>。</li></ul><h1 id="82dc" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">用Python实现</h1><p id="8439" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">下面我将展示用Python编程语言实现的多元回归。目标是根据不同媒体的广告支出来预测产品的销售。一般公式如下:</p><blockquote class="nq"><p id="d782" class="nr ns it bd nt nu nv nw nx ny nz mv dk translated">总销售额= f(电视、报纸、广播广告支出)</p></blockquote><p id="a3bc" class="pw-post-body-paragraph ma mb it mc b md oa kd mf mg ob kg mi mj oc ml mm mn od mp mq mr oe mt mu mv im bi translated">在本次演示中，我们将使用一个关于广告支出的<a class="ae lh" href="http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv" rel="noopener ugc nofollow" target="_blank">公开数据集</a>；这个数据集经常在机器学习的例子中使用。</p><p id="beae" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">第一步:导入库</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="0b72" class="ok lj it og b gy ol om l on oo"># import pandas<br/>import pandas as pd<br/># import numpy<br/>import numpy as np<br/># import seaborn for visualization <br/>import seaborn as sns<br/># import model <br/>from sklearn.linear_model import LinearRegression<br/># import accuracy metrics<br/>from sklearn import metrics<br/># splitting training data<br/>from sklearn.model_selection import train_test_split</span></pre><p id="d47e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">第二步:导入数据</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="3b77" class="ok lj it og b gy ol om l on oo"># import data<br/>data = pd.read_csv('<a class="ae lh" href="http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv'" rel="noopener ugc nofollow" target="_blank">http://faculty.marshall.usc.edu/gareth-james/ISL/Advertising.csv'</a>, index_col=0)</span><span id="4d32" class="ok lj it og b gy op om l on oo"># take a peek into first few columns<br/>data.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/e2de02bc5a20064e8f4f4052b02aa6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*RfdK-JFBBA6dQDzp7OCBNg.png"/></div></figure><p id="53df" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">第三步:可视化数据</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="b780" class="ok lj it og b gy ol om l on oo"># visualize data with a fitted line<br/>sns.pairplot(data, x_vars=['TV','radio','newspaper'], y_vars='sales', height=7,aspect=0.7, kind = 'reg')</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/39f5b1e72d408ebe9abe4f6307fae743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUtDp5-5u-e51FFEjAs60g.png"/></div></div></figure><p id="c71f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">第四步:准备数据</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="f26e" class="ok lj it og b gy ol om l on oo"># make X (predictor) and y (dependent) variables <br/>X = data[['TV','radio','newspaper']]<br/>y = data['sales']</span><span id="7852" class="ok lj it og b gy op om l on oo"># split data<br/>X_train,X_test,y_train,y_test = train_test_split(X,y,random_state=1)</span></pre><p id="5231" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">第五步:模型拟合</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="1773" class="ok lj it og b gy ol om l on oo"># instantiate model<br/>model = LinearRegression()</span><span id="36ce" class="ok lj it og b gy op om l on oo"># fit model<br/>model.fit(X_train,y_train)</span></pre><p id="9cf0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">第六步:做预测</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="134d" class="ok lj it og b gy ol om l on oo"># make prediction on test set<br/>y_pred = model.predict(X_test)</span></pre><p id="dfe7" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">步骤7:模型评估</strong></p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="d584" class="ok lj it og b gy ol om l on oo"># calculate RMSE<br/>rmse = np.sqrt(metrics.mean_squared_error(y_test,y_pred))</span><span id="25b5" class="ok lj it og b gy op om l on oo"># calculate R^2 value<br/>from sklearn.metrics import r2_score<br/>r2score = r2_score(y_test, y_pred)</span><span id="8028" class="ok lj it og b gy op om l on oo">print("Root mean squared error (RMSE): ", round(rmse, 2))<br/>print("R squared: ", round(r2score, 2))</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/165150be6050990faa19c5c75e90aeb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*eY2sVRcFz4MT6yxrko8lcA.png"/></div></figure><h1 id="5481" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated"><strong class="ak">最后一句话</strong></h1><p id="65fe" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">本文的目的是介绍线性回归作为一种机器学习算法的一些基本概念，它的应用以及Python中的演示。虽然我在一个简单的7步过程中展示了所有的实现，但是实际的实现可能是一个冗长的、迭代的过程。对于建模者来说，光是将数据转换成正确的格式就要花很长时间。而且一旦实施，事情还没完呢！您可能需要准备在各种参数空间中实现它，以便根据您的精度指标(例如，最低的RMSE或最高的R平方值等)找到最佳模型。).最后，<strong class="mc jd">模型漂移</strong>是机器学习中的一个现实问题——一旦一个模型建立起来，它可能不会永远工作良好，随着时间的推移，它的性能可能会下降，你可能需要用新数据重新训练模型。</p><p id="0739" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果你喜欢这篇文章，欢迎在<a class="ae lh" href="https://medium.com/@mab.datasc" rel="noopener">媒体</a>或<a class="ae lh" href="https://twitter.com/DataEnthus" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我。</p></div></div>    
</body>
</html>