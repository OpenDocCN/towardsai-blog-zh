<html>
<head>
<title>How to Create a Simple Streamlit App + How to Deploy it on Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建一个简单的Streamlit应用+如何在Heroku上部署它</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-create-a-simple-streamlit-app-how-to-deploy-it-on-heroku-6a9095c6aabd?source=collection_archive---------2-----------------------#2021-12-15">https://pub.towardsai.net/how-to-create-a-simple-streamlit-app-how-to-deploy-it-on-heroku-6a9095c6aabd?source=collection_archive---------2-----------------------#2021-12-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="fa6d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/devops" rel="noopener ugc nofollow" target="_blank"> DevOps </a></h2><div class=""/><div class=""><h2 id="75f4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用几行代码开发一个迷你加密货币仪表板</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/de73ac5bc14ffff729cb7242d64a95fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWCPuaymSh0qBqLQv-mxng.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="c494" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Streamlit是我们最喜欢的创建python web应用程序的方法，因为它很简单。无需任何前端体验，您就可以构建漂亮而复杂的应用程序。在本帖中，我们将创建一个迷你加密货币仪表板，显示一段时间内的收盘价。</p><p id="4cbb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">要安装Streamlit:</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="d840" class="mi mj it me b gy mk ml l mm mn">pip install streamlit</span></pre><h1 id="7059" class="mo mj it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">python代码</h1><p id="1000" class="pw-post-body-paragraph lh li it lj b lk nf kd lm ln ng kg lp lq nh ls lt lu ni lw lx ly nj ma mb mc im bi translated">使用Streamlit创建web应用程序的最佳途径是首先在Jupyter Notebook之类的东西中开发代码，然后将其传输到Streamlit python文件中。说到这里，让我们开发代码，获取数据并绘制加密货币的收盘价。</p><p id="10c5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有很多方法可以得到一种货币的价格，但是在这篇文章中，我们将使用pandas_datareader。要安装它，请运行以下命令:</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="8a9c" class="mi mj it me b gy mk ml l mm mn">pip install pandas-datareader</span></pre><p id="365d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在，让我们开始编码。我们想要两件事，设置日期范围和加密货币名称，然后绘制其收盘价。</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="6667" class="mi mj it me b gy mk ml l mm mn">import pandas as pd<br/>import numpy as np<br/>import pandas_datareader as web<br/>import datetime as dt</span><span id="1803" class="mi mj it me b gy nk ml l mm mn">start = dt.datetime(2020,1,1)<br/>end = dt.datetime.now()</span><span id="79d6" class="mi mj it me b gy nk ml l mm mn">df = web.DataReader('XRP-USD', 'yahoo', start, end)<br/>df</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/e1b9d34a9ca9899ecb98208092f33e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/0*CKoiN38bSuHXy1EB.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="bdfd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Pandas Datareader将货币名称(XRP)、范围和来源(yahoo)作为输入。</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="1247" class="mi mj it me b gy mk ml l mm mn">df['Adj Close'].plot()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/b28d0bfec2bec65fd6965279d0a7eb3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/0*LVeWaNmOUHKrBjpo.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h1 id="1c9a" class="mo mj it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">将代码转换成Streamlit应用程序</h1><p id="4440" class="pw-post-body-paragraph lh li it lj b lk nf kd lm ln ng kg lp lq nh ls lt lu ni lw lx ly nj ma mb mc im bi translated">现在是有趣的部分。在我们开始之前，你应该打开这个<a class="ae nn" href="https://share.streamlit.io/daniellewisdl/streamlit-cheat-sheet/master/app.py" rel="noopener ugc nofollow" target="_blank"> streamlit备忘单</a>，这是我在开发应用程序时经常使用的。</p><p id="f1e7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">第一步是想一个标题，以及我们需要什么输入。在我们的例子中，我们只需要3样东西。货币名称以及开始和结束日期。然后，如果用户按下提交按钮，它应该显示一个图。所以，里面有一个<strong class="lj jd">。py </strong>(姑且称t <strong class="lj jd"> app.py </strong>)文件添加如下。</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="3c47" class="mi mj it me b gy mk ml l mm mn">import pandas as pd<br/>import pandas_datareader as web<br/>import datetime as dt<br/>import numpy as np<br/>import streamlit as st</span><span id="acee" class="mi mj it me b gy nk ml l mm mn">st.title('Crypto price over time.')</span><span id="e4bd" class="mi mj it me b gy nk ml l mm mn">with st.form(key='my_form'):<br/>    crypto=st.selectbox('Select Cryptocurrency', ['BTC','ETH','XRP','BCH'])<br/>    start=st.date_input('Start')<br/>    end=st.date_input('End')<br/>    submit_button = st.form_submit_button(label='Submit')</span><span id="6f3c" class="mi mj it me b gy nk ml l mm mn">if submit_button:<br/>    df = web.DataReader(f'{crypto}-USD', 'yahoo', start, end)</span><span id="d5a5" class="mi mj it me b gy nk ml l mm mn">st.line_chart(df['Adj Close'])</span></pre><p id="dd0d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们的应用程序已经准备好了！让我们解释一下我们做了什么。</p><p id="b5c7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在导入库之后(不要忘记导入<strong class="lj jd"> streamlit </strong>)，我们通过使用<strong class="lj jd"> st.title </strong>函数添加了一个标题。然后我们创建了一个表单。正如您在<a class="ae nn" href="https://share.streamlit.io/daniellewisdl/streamlit-cheat-sheet/master/app.py" rel="noopener ugc nofollow" target="_blank">备忘单</a>中所看到的，您可以使用多种类型的输入，但是在我们的示例中，我们添加了一个<strong class="lj jd">选择框</strong>用于选择货币，2个<strong class="lj jd">日期输入</strong>用于日期范围的开始和结束，当然，还有一个<strong class="lj jd">提交按钮</strong>。</p><p id="1902" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">接下来，我们检查是否单击了提交按钮，我们添加了其余的代码，并做了一点小小的更改，我们使用streamlit的line_chart代替pandas plot。</p><p id="182e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了启动我们的应用程序，我们在终端中运行以下程序:</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="dbe0" class="mi mj it me b gy mk ml l mm mn">streamlit run app.py</span></pre><p id="22bc" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出应该如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d517d603552c2af1e7549df5195f369b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/0*mYduA-Mioc6g57VC.png"/></div></figure><p id="7101" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这意味着我们的应用程序运行在<a class="ae nn" href="http://localhost:8501" rel="noopener ugc nofollow" target="_blank"> http://localhost:8501 </a>中。让我们看一看。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi np"><img src="../Images/ac60d4c60de6b831411c81fd8b5b645b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Itz18imBSV9WYhIk.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nq"><img src="../Images/7e0ee6d693d63634c46c85e1d25b1e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ypWjkGtHPJF3Cv0u.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h1 id="2a5f" class="mo mj it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">额外收获:如何在Heroku上部署Streamlit应用程序</h1><p id="a9fa" class="pw-post-body-paragraph lh li it lj b lk nf kd lm ln ng kg lp lq nh ls lt lu ni lw lx ly nj ma mb mc im bi translated">Heroku是一个开始使用web应用程序或API的很好的服务，因为你可以免费部署它们。如果你对Heroku或部署一无所知，我鼓励你阅读<a class="ae nn" href="https://predictivehacks.com/practical-guide-build-and-deploy-a-machine-learning-web-app/" rel="noopener ugc nofollow" target="_blank">实用指南:构建和部署机器学习网络应用</a>。</p><p id="d347" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先，你需要用下面的代码创建一个<strong class="lj jd"> setup.sh </strong>文件:</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="e5cb" class="mi mj it me b gy mk ml l mm mn">mkdir -p ~/.streamlit/<br/>echo "\<br/>[server]\n\<br/>headless = true\n\<br/>port = $PORT\n\<br/>enableCORS = false\n\<br/>\n\<br/>[theme]\n\<br/>base = 'light'\n\<br/>\n\<br/>" &gt; ~/.streamlit/config.toml</span></pre><p id="1685" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这个文件中，你也可以改变应用程序的主题。您可以在<a class="ae nn" href="https://docs.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit的文档</a>中找到更多信息。对于这个应用程序，我使用的是<strong class="lj jd">光</strong>主题。</p><p id="fd3c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">接下来，我们只需要创建一个包含以下内容的<strong class="lj jd"> Procfile </strong></p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="aa76" class="mi mj it me b gy mk ml l mm mn">web: sh setup.sh &amp;&amp; streamlit run app.py</span></pre><p id="372d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，您需要一个<strong class="lj jd"> requirements.txt </strong>文件，其中包含我们在项目中使用的库。</p><pre class="ks kt ku kv gt md me mf mg aw mh bi"><span id="0d49" class="mi mj it me b gy mk ml l mm mn">numpy == 1.19.5<br/><br/>pandas == 1.3.3<br/><br/>pandas_datareader == 0.10.0<br/><br/>streamlit == 1.1.0</span></pre><p id="ad4f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在，您已经准备好将您的Streamlit应用程序部署到Heroku。你应该在Heroku的网站上创建一个app，然后按照<a class="ae nn" href="https://predictivehacks.com/practical-guide-build-and-deploy-a-machine-learning-web-app/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">实用指南</strong> </a>中提到的在Heroku中初始化并推送代码。</p><h1 id="3a49" class="mo mj it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">总结一下</h1><p id="b5e8" class="pw-post-body-paragraph lh li it lj b lk nf kd lm ln ng kg lp lq nh ls lt lu ni lw lx ly nj ma mb mc im bi translated">Streamlit是我最喜欢的创建Python web应用程序的方式。它又快又简单，而且看起来很专业。在这篇文章中，我们只用了几行代码就创建了一个迷你加密货币仪表板。</p><p id="8f8d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">像Heroku这样的服务让我们免费部署我们的应用程序，作为数据科学家分享想法和知识变得更加容易。结合我们的知识、Streamlit和Heroku，你甚至可以通过自由职业赚钱，或者你可以创建一个漂亮的应用程序组合，展示给你的下一次工作面试。</p><p id="0de2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你想看一个更复杂的Streamlit的例子，你可以阅读<a class="ae nn" href="https://predictivehacks.com/how-to-create-an-instagram-profile-analyzer-app-using-python-and-streamlit/" rel="noopener ugc nofollow" target="_blank">如何使用Python和Streamlit </a>创建Instagram Profile Analyzer应用。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="d7d1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="ny">原载于</em><a class="ae nn" href="https://predictivehacks.com/how-to-create-a-simple-streamlit-app-how-to-deploy-it-on-heroku/" rel="noopener ugc nofollow" target="_blank"><em class="ny">https://predictivehacks.com</em></a><em class="ny">。</em></p></div></div>    
</body>
</html>