<html>
<head>
<title>The ABCs of PyTorch in 4 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyTorch的ABC在4分钟内</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/pytorch-in-2-minutes-9e18875990fd?source=collection_archive---------0-----------------------#2019-07-13">https://pub.towardsai.net/pytorch-in-2-minutes-9e18875990fd?source=collection_archive---------0-----------------------#2019-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="4fdb" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">PyTorch 101 | <a class="ae ep" href="https://towardsai.net" rel="noopener ugc nofollow" target="_blank">向着艾</a></h2><div class=""/><div class=""><h2 id="09d9" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">用四分钟介绍PyTorch的基础知识，并附有示例代码</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5fb54b13fb18e5157715f153713e294d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mar0bor8qH2IP0KFn9UZQ.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">www.ai-techsystems.com AITS</figcaption></figure><p id="91f6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这篇文章通过用python编写的代码，帮助新手在2分钟内开始使用python PyTorch。对于那些不知道<a class="ae ma" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>是什么的人来说，它是一个来自<a class="ae ma" href="https://ai.facebook.com/tools/pytorch/" rel="noopener ugc nofollow" target="_blank">脸书</a>的开源深度学习平台，提供了从研究原型到生产部署的无缝路径。</p><p id="2079" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">事不宜迟，让我们直入主题吧。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="2385" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated"><strong class="ak">张量</strong></h1><p id="6e69" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">它是一个多维矩阵，包含单一数据类型的元素，声明为</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/5fb755e77cd4285c9b97b9a65f0d4175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ShEADEj8cXqH8tXrJsl2Q.png"/></div></div></figure><h1 id="38df" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated"><strong class="ak">操作</strong></h1><p id="2d97" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">PyTorch包含许多关于张量的数学运算。此外，它提供了许多有效序列化张量和任意类型的实用程序以及其他有用的实用程序。这里有一个张量加减的例子。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nl"><img src="../Images/31d55c0c987f6b3db818a50b251300d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8fHQixthKbdnBfSaujyC_Q.png"/></div></div></figure><h1 id="c5c1" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated"><strong class="ak"> PyTorch和NumPy </strong></h1><p id="56c2" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">人们可以很容易地在PyTorch和NumPy之间往返。下面是一个将np.matrix转换为PyTorch并将维度更改为单列的简单示例</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nl"><img src="../Images/107568446d634bed7b0139e47fd3ed2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LMbGDga_7sQ_uD7YX4nqbQ.png"/></div></div></figure><p id="41b7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里有一个有用的<a class="ae ma" href="https://github.com/wkentaro/pytorch-for-numpy-users" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>概述PyTorch &lt; - &gt; numpy转换。</p><h1 id="e209" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated"><strong class="ak"> CPU和GPU</strong></h1><p id="f4de" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">PuTorch允许你的变量用一个<code class="fe nm nn no np b"><a class="ae ma" href="https://pytorch.org/docs/stable/cuda.html#torch.cuda.device" rel="noopener ugc nofollow" target="_blank">torch.cuda.device</a></code>上下文管理器动态地改变设备。下面是示例代码:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/44e46586e61630d9a327b7242ae2efed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4ZJkKC5E2SBn7ZuVDA5Mg.png"/></div></div></figure><h1 id="a6d8" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated"><strong class="ak"> PyTorch </strong>变量</h1><p id="fb6b" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">一个<strong class="lg ja">变量</strong>只不过是一层薄薄的东西，包裹着张量。它支持几乎所有由张量定义的API。变量被巧妙地定义为<a class="ae ma" href="https://pytorch.org/docs/stable/autograd.html" rel="noopener ugc nofollow" target="_blank">亲笔签名包</a>的一部分。它提供了实现任意标量值函数的自动微分的类和函数。</p><p id="96da" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下面是PyTorch变量用法的一个简单示例:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/ef3dec7c4319f5d3650f306e8d651412.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i6IQRc9Byy51HLD-bqsGRw.png"/></div></div></figure><h1 id="badb" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated">反向传播</h1><p id="2f7d" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">反向传播算法用于计算损失相对于输入权重和偏差的梯度，以在下一次优化迭代中更新权重，并最终减少损失。PyTorch很聪明，在变量上分层定义了一个<em class="ns">向后</em>方法来执行反向传播。</p><p id="80c0" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是一个反向传播计算微分的简单例子，以sin(x)为例</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nl"><img src="../Images/179152e68598130dfbc7a2541439752c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3BDUJ_t2YTycD-zBEopHw.png"/></div></div></figure><h1 id="5ff4" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated"><strong class="ak">单反:简单线性回归</strong></h1><p id="4f40" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">现在，我们已经收集了所有弹药，可以开始使用带有<a class="ae ma" href="https://en.wikipedia.org/wiki/Simple_linear_regression" rel="noopener ugc nofollow" target="_blank">简单线性回归</a>问题的机器学习示例。我们将通过4个简单的步骤来实现:</p><h2 id="011d" class="nt mj iq bd mk nu nv dn mo nw nx dp ms ln ny nz mu lr oa ob mw lv oc od my iw bi translated">单反:第一步</h2><p id="16c2" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">在第一步中，我们创建一个人工数据集，该数据集是通过注入随机误差的方程<em class="ns"> y=w.x+b </em>创建的。请参见下面的示例:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/70aa03756a927afbaf04de0c33f8a58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ymQR1Dhs-klr31xHvsZMFQ.png"/></div></div></figure><h2 id="0966" class="nt mj iq bd mk nu nv dn mo nw nx dp ms ln ny nz mu lr oa ob mw lv oc od my iw bi translated">单反:第二步</h2><p id="1d92" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">在第2步中，我们定义了一个简单的类<em class="ns"> LinearRegressionModel </em>，使用方法forward和构造器<a class="ae ma" href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/linear.html" rel="noopener ugc nofollow" target="_blank"> <em class="ns"> torch.nn.Linear </em> </a>对输入数据进行线性转换</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/124faca46f5fc6dabee4811578d8893c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ASTmsWm5J5VBhqyqWRqQew.png"/></div></div></figure><h2 id="b756" class="nt mj iq bd mk nu nv dn mo nw nx dp ms ln ny nz mu lr oa ob mw lv oc od my iw bi translated">单反:第三步</h2><p id="85a4" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">下一步是用<a class="ae ma" href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/loss.html" rel="noopener ugc nofollow" target="_blank"><em class="ns">ms loss</em></a><em class="ns">作为</em>成本函数，用<a class="ae ma" href="https://pytorch.org/docs/stable/_modules/torch/optim/sgd.html" rel="noopener ugc nofollow" target="_blank"> <em class="ns"> SGD </em> </a>作为优化器来训练模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/fa0025e30ace2ea1a42a37f34f876645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_DT2TgpavO6WMEgNy-AAA.png"/></div></div></figure><h2 id="7e29" class="nt mj iq bd mk nu nv dn mo nw nx dp ms ln ny nz mu lr oa ob mw lv oc od my iw bi translated">单反:第四步</h2><p id="fa17" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">现在培训已经完成，让我们来目视检查我们的模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/dffcac146cf9c3396cd6666b2de2caa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQxjxJimTbE4IM35Ppddqg.png"/></div></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="7710" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">有很多东西需要学习，所以从这里展示的代码开始使用<a class="ae ma" href="https://github.com/srohit0/ML-Misc/blob/master/ABCs_Of_PyTorch.ipynb" rel="noopener ugc nofollow" target="_blank"> python笔记本</a>。随意换，开始玩PyTorch。</p><div class="oh oi gp gr oj ok"><a href="https://cainvas.ai-tech.systems/notebooks/details/?path=rohit/Scholar%20Modules/M4%20Frameworks/PyTorch/PyTorch_Overview.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ja gy z fp op fr fs oq fu fw iz bi translated">PyTorch _概述</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">链接到包含本文中使用的示例代码的整个笔记本…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">人工智能技术系统</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ky ok"/></div></div></a></div><p id="928c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">玩得开心。👍</p><h1 id="ede3" class="mi mj iq bd mk ml ng mn mo mp nh mr ms kf ni kg mu ki nj kj mw kl nk km my mz bi translated">参考资料:</h1><ol class=""><li id="66f4" class="oz pa iq lg b lh na lk nb ln pb lr pc lv pd lz pe pf pg ph bi translated">解说视频—<a class="ae ma" href="https://youtu.be/drwrMiARTQ4" rel="noopener ugc nofollow" target="_blank">https://youtu.be/drwrMiARTQ4</a></li><li id="9515" class="oz pa iq lg b lh pi lk pj ln pk lr pl lv pm lz pe pf pg ph bi translated">笔记本网址—<a class="ae ma" href="https://cainvas.ai-tech.systems/notebooks/details/?path=rohit/Scholar%20Modules/M4%20Frameworks/PyTorch/PyTorch_Overview.ipynb" rel="noopener ugc nofollow" target="_blank">https://cainvas.ai-tech.systems/notebooks/details/?path = rohit/Scholar % 20 modules/M4 % 20 frameworks/py torch/py torch _ overview . ipynb</a></li><li id="344f" class="oz pa iq lg b lh pi lk pj ln pk lr pl lv pm lz pe pf pg ph bi translated"><a class="ae ma" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank">PyTorch.org</a></li><li id="a5f4" class="oz pa iq lg b lh pi lk pj ln pk lr pl lv pm lz pe pf pg ph bi translated"><a class="ae ma" href="https://medium.com/predict/hello-world-of-deep-learning-891f37a53c88" rel="noopener">深度学习的Hello World</a></li><li id="4bea" class="oz pa iq lg b lh pi lk pj ln pk lr pl lv pm lz pe pf pg ph bi translated"><a class="ae ma" href="http://amzn.to/2paZ53b" rel="noopener ugc nofollow" target="_blank">设计自动化中的机器智能</a></li><li id="dbeb" class="oz pa iq lg b lh pi lk pj ln pk lr pl lv pm lz pe pf pg ph bi translated"><a class="ae ma" href="https://www.linkedin.com/pulse/design-your-neural-network-eda-software-rohit-sharma/" rel="noopener ugc nofollow" target="_blank">为EDA软件设计您的神经网络</a></li></ol></div></div>    
</body>
</html>