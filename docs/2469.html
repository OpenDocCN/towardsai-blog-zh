<html>
<head>
<title>Ljung-Box or Durbin Watson — Which test is more powerful</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">永盒和杜宾·沃森——哪种测试更有效</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/ljung-box-or-durbin-watson-which-test-is-more-powerful-a1ba247f30db?source=collection_archive---------4-----------------------#2022-01-05">https://pub.towardsai.net/ljung-box-or-durbin-watson-which-test-is-more-powerful-a1ba247f30db?source=collection_archive---------4-----------------------#2022-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="84dd" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/statistics" rel="noopener ugc nofollow" target="_blank">统计数据</a></h2><div class=""/></div><div class="ab cl jw jx hu jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ij ik il im in"><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/652b1629f4f178ef0a214fd2b58b038f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJ3v2xR3tuh0rAsP6JOmRw.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk translated">来源:Pixabay</figcaption></figure><p id="0a4d" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">德宾·沃森更强大，但有一个问题。请继续阅读，了解更多信息。</p><p id="1d36" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">说到统计检验，我们寻找的最重要的因素之一是检验的功效，它可以简单地定义如下:</p><p id="a7c3" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kv ja">检验的功效:</strong>当替代假设为真时，检验拒绝原假设的概率。</p><p id="abc2" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">简而言之，检测出真正阳性的概率越高，其功效就越高。这将在本文中变得更加清晰。我们将检查两个统计测试:<a class="ae lr" href="https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test" rel="noopener ugc nofollow" target="_blank"> Ljung-Box </a>和<a class="ae lr" href="https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic" rel="noopener ugc nofollow" target="_blank"> Durbin Watson </a>的功效，并得出使用哪一个以及何时使用的结论。</p><p id="4f97" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Ljung-Box和Durbin Watson大致用于相同的目的，即检查数据序列中的自相关性。虽然Ljung-Box可用于任何滞后值，但Durbin Watson仅可用于滞后1。两种测试的无效假设和替代假设是相同的:</p><p id="9eb7" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kv ja"> H0: </strong>数据中没有自相关。</p><p id="c9bc" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kv ja"> H1: </strong>存在显著的自相关。</p><p id="64a8" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使用python库来进行实验，实验的过程如下:</p><ol class=""><li id="c7e0" class="ls lt iq kv b kw kx la lb le lu li lv lm lw lq lx ly lz ma bi translated">创建一个随机数据集(无相关性情况)</li><li id="2377" class="ls lt iq kv b kw mb la mc le md li me lm mf lq lx ly lz ma bi translated">对其进行Ljung-Box和Durbin Watson测试，并记录输出。</li><li id="ae98" class="ls lt iq kv b kw mb la mc le md li me lm mf lq lx ly lz ma bi translated">多次(1000次)重复步骤2，检查测试拒绝零假设的概率。给出假阳性的概率。</li><li id="0f50" class="ls lt iq kv b kw mb la mc le md li me lm mf lq lx ly lz ma bi translated">计算测试的功效:1-在步骤3中获得的值。</li></ol><p id="e333" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们首先需要加载所有需要的库:</p><pre class="ke kf kg kh gt mg mh mi mj aw mk bi"><span id="45fa" class="ml mm iq mh b gy mn mo l mp mq">from statsmodels.stats.api import acorr_ljungbox</span><span id="af2f" class="ml mm iq mh b gy mr mo l mp mq">from statsmodels.stats.stattools import durbin_watson</span><span id="2dac" class="ml mm iq mh b gy mr mo l mp mq">import numpy as np</span><span id="57d7" class="ml mm iq mh b gy mr mo l mp mq">import matplotlib.pyplot as plt</span></pre><p id="8de8" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将首先使用Numpy的random.normal()函数创建一个随机数据集，这将创建一个从标准正态分布中选取的随机数。</p><pre class="ke kf kg kh gt mg mh mi mj aw mk bi"><span id="ccd7" class="ml mm iq mh b gy mn mo l mp mq">sample_size = 150<br/>random_data = [np.random.normal() for i in range(sample_size)]</span></pre><p id="4c9f" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从statsmodels库导入的两个测试可直接用于计算测试统计和p值。在这里，谨慎的做法是明确在Durbin Watson检验的情况下，如果检验统计量约为2，我们不能拒绝零假设，否则拒绝零假设。在Ljung-Box测试的情况下，可以通过使用测试抛出的p值来做出决定。</p><p id="2fb9" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">整个逻辑可以被赋予如下所示的函数形状:</p><pre class="ke kf kg kh gt mg mh mi mj aw mk bi"><span id="2867" class="ml mm iq mh b gy mn mo l mp mq">def run_test(sample_size):</span><span id="0669" class="ml mm iq mh b gy mr mo l mp mq">   random_data = [np.random.normal() for i in range(sample_size)]                       #create random data with given sample size</span><span id="4d03" class="ml mm iq mh b gy mr mo l mp mq">   dw = durbin_watson(random_data)</span><span id="f89a" class="ml mm iq mh b gy mr mo l mp mq">   if(dw &gt; 1.8 and dw &lt; 2.2): <br/>#A tolerance of 0.2 is kept to decide in case of DW</span><span id="8948" class="ml mm iq mh b gy mr mo l mp mq">      dw = 0</span><span id="0bbb" class="ml mm iq mh b gy mr mo l mp mq">   else:</span><span id="c21f" class="ml mm iq mh b gy mr mo l mp mq">      dw = 1</span><span id="bf58" class="ml mm iq mh b gy mr mo l mp mq">   ljung = float(acorr_ljungbox(random_data, lags = 1)[1])</span><span id="07dd" class="ml mm iq mh b gy mr mo l mp mq">   #The acorr_ljung_box() returns both test-statistic and p-value,       index of 1 is used to access the p-val.</span><span id="9c7e" class="ml mm iq mh b gy mr mo l mp mq">   if(ljung &gt; 0.05): #Significance level of 5% is considered</span><span id="b050" class="ml mm iq mh b gy mr mo l mp mq">      ljung = 0</span><span id="50dc" class="ml mm iq mh b gy mr mo l mp mq">   else:</span><span id="1120" class="ml mm iq mh b gy mr mo l mp mq">      ljung = 1</span><span id="8201" class="ml mm iq mh b gy mr mo l mp mq">   return dw, ljung</span></pre><p id="7b91" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果零假设没有被拒绝，这两个测试都返回0，否则返回1。理想情况下，上面定义的函数应该总是返回0，因为我们测试的是随机性质的数据序列。该函数返回的值1将是假阳性，并将用于判断这两个测试的功效。</p><p id="dfd1" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们已经有了run_test()函数，我们可以反复调用它来计算这些测试的功效，但是我们将不仅针对单个样本大小，而且针对多个样本大小来进行计算，以了解功效与数据大小的关系。</p><pre class="ke kf kg kh gt mg mh mi mj aw mk bi"><span id="37f3" class="ml mm iq mh b gy mn mo l mp mq">sample_sizes = [50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000]</span></pre><p id="82cd" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上面python列表中定义的样本大小将用于执行这个实验，我们将对每个样本大小运行run_test()函数1000次。</p><p id="c246" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面几行代码将为我们完成这项工作:</p><pre class="ke kf kg kh gt mg mh mi mj aw mk bi"><span id="4e45" class="ml mm iq mh b gy mn mo l mp mq">sample_sizes = [50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000]</span><span id="b169" class="ml mm iq mh b gy mr mo l mp mq">number_of_runs = 1000</span><span id="2fe2" class="ml mm iq mh b gy mr mo l mp mq">#Creating empty lists to contain the results later for durbin watson(dw) and ljung-box (lb)</span><span id="fdfa" class="ml mm iq mh b gy mr mo l mp mq">dw_data = []</span><span id="3913" class="ml mm iq mh b gy mr mo l mp mq">lb_data = []</span><span id="7336" class="ml mm iq mh b gy mr mo l mp mq">for sample_size in sample_sizes:</span><span id="5416" class="ml mm iq mh b gy mr mo l mp mq">   x = [run_test(sample_size) for i in range(number_of_runs)]   #runtest() is called 1000 times for each sample size</span><span id="2a57" class="ml mm iq mh b gy mr mo l mp mq">   dw = [i[0] for i in x]</span><span id="55ff" class="ml mm iq mh b gy mr mo l mp mq">   lb = [i[1] for i in x]</span><span id="7dcf" class="ml mm iq mh b gy mr mo l mp mq">   dw_per = np.sum(dw)/number_of_runs <br/>#calculatng fraction of times the null hypothesis was rejected</span><span id="6328" class="ml mm iq mh b gy mr mo l mp mq">   lb_per = np.sum(lb)/number_of_runs</span><span id="2d1c" class="ml mm iq mh b gy mr mo l mp mq">#Populating the empty lists to contain the results</span><span id="9d3d" class="ml mm iq mh b gy mr mo l mp mq">   dw_data.extend([dw_per])</span><span id="d166" class="ml mm iq mh b gy mr mo l mp mq">   lb_data.extend([lb_per])</span></pre><p id="389b" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在已经有了结果，我们现在正处于检查这两个测试的功效与数据样本大小的关系的阶段。我们将使用matplotlib库来绘制结果，以获得见解和推论:</p><pre class="ke kf kg kh gt mg mh mi mj aw mk bi"><span id="28dc" class="ml mm iq mh b gy mn mo l mp mq">plt.plot(sample_sizes, lb_data, label = ‘Ljung-Box’)</span><span id="8b51" class="ml mm iq mh b gy mr mo l mp mq">plt.plot(sample_sizes, dw_data, label = ‘Durbin-Watson’)</span><span id="e611" class="ml mm iq mh b gy mr mo l mp mq">plt.xlabel(‘Sample Size’); plt.ylabel(‘1-Power’)</span><span id="1d95" class="ml mm iq mh b gy mr mo l mp mq">plt.legend()</span><span id="c573" class="ml mm iq mh b gy mr mo l mp mq">plt.show()</span></pre><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/adf8c787c0afc32c7d637d86b4e6e6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*kGIY-54sM9hvmGq26J3s9A.png"/></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk translated">代码输出。来源:Self</figcaption></figure><p id="7710" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上图清楚地表明，对于小样本量，使用Durbin-Watson测试是一个坏主意，因为它的功效较低，但对于大样本量，它的表现优于ljung-box。在Ljung-Box的情况下，无论样本大小如何，功率都是一致的。所以用哪一个取决于你手头的样本量。</p><p id="9c1b" class="pw-post-body-paragraph kt ku iq kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这篇文章也发表在<a class="ae lr" href="https://teastatistic.com/index.php/2022/01/16/durbin-watson-or-ljung-box-which-test-is-more-powerful/" rel="noopener ugc nofollow" target="_blank">茶统计</a>上</p></div></div>    
</body>
</html>