<html>
<head>
<title>Building Natural Flower Classifier using Amazon Rekognition Custom Labels</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Amazon Rekognition自定义标签构建自然花卉分类器</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/build-natural-flower-classifier-using-amazon-rekognition-custom-labels-8aabc3c8931c?source=collection_archive---------2-----------------------#2020-11-16">https://pub.towardsai.net/build-natural-flower-classifier-using-amazon-rekognition-custom-labels-8aabc3c8931c?source=collection_archive---------2-----------------------#2020-11-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="59f9" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><div class=""><h2 id="0da4" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">包含AWS最佳实践的完整指南</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/324ea4554b2c45203d1def786fff6859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*up1vEN197WsOm3J7RgSjxw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图片来自<a class="ae le" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a></figcaption></figure><h1 id="68fe" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">简介</strong></h1><p id="e85b" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">从头开始构建自己的计算机视觉模型会很有趣，也很有成就感。您可以决定您首选的用于训练和部署的机器学习框架和平台，设计您的数据管道和神经网络架构，编写定制的训练和推理脚本，并微调您的模型算法的超参数，以获得最佳的模型性能。</p><p id="489b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">另一方面，对于没有或几乎没有计算机视觉和机器学习专业知识的人来说，这也可能是一项艰巨的任务。这篇文章展示了如何使用亚马逊Rekognition定制标签 和AWS最佳实践构建自然花朵分类器的分步指南。</p><h1 id="2111" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">亚马逊Rekognition定制标签概述</strong></h1><p id="0262" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated"><strong class="lz ja">亚马逊Rekognition定制标签</strong>是<a class="ae le" href="https://aws.amazon.com/rekognition/" rel="noopener ugc nofollow" target="_blank">亚马逊Rekognition </a>的一项功能，是<a class="ae le" href="https://aws.amazon.com/machine-learning/ai-services/" rel="noopener ugc nofollow" target="_blank"> AWS人工智能服务</a>之一，通过机器学习进行自动图像和视频分析。<strong class="lz ja"> </strong>它为定制计算机视觉端到端机器学习工作流提供<strong class="lz ja">自动机器学习(AutoML) </strong>能力。</p><p id="2916" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">它适合任何想要快速构建自定义计算机视觉模型的人，以对图像进行分类，检测特定于其用例的对象和场景。不需要机器学习专业知识。</p><h1 id="75b5" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">先决条件</strong></h1><p id="f5d9" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">对于本演练，您应该具备以下先决条件:</p><ul class=""><li id="26ae" class="my mz iq lz b ma mt md mu mg na mk nb mo nc ms nd ne nf ng bi translated">一个AWS账户 —如果你还没有账户，你可以<a class="ae le" href="https://portal.aws.amazon.com/billing/signup#/start" rel="noopener ugc nofollow" target="_blank">创建一个新账户</a>。</li><li id="d904" class="my mz iq lz b ma nh md ni mg nj mk nk mo nl ms nd ne nf ng bi translated"><strong class="lz ja"> AWS CLI — </strong>您应该安装或升级到最新的<a class="ae le" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank"> AWS命令行界面(AWS CLI)版本2 </a>。</li></ul><h1 id="b477" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">创建最低权限访问IAM用户和策略</h1><p id="06e9" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">作为<a class="ae le" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#lock-away-credentials" rel="noopener ugc nofollow" target="_blank">安全最佳实践</a>，强烈建议不要在不需要<strong class="lz ja"> AWS账号root用户</strong>的地方使用<strong class="lz ja"> </strong>完成任何任务。相反，创建一个新的IAM(身份和访问管理)用户，并使用<a class="ae le" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html" rel="noopener ugc nofollow" target="_blank">基于身份的策略</a>根据<strong class="lz ja">最低权限原则</strong>授予IAM用户所需的权限。这符合针对<a class="ae le" href="https://aws.amazon.com/architecture/well-architected/" rel="noopener ugc nofollow" target="_blank"> AWS良好架构框架</a>的<a class="ae le" href="https://docs.aws.amazon.com/wellarchitected/latest/machine-learning-lens/welcome.html" rel="noopener ugc nofollow" target="_blank">机器学习镜头</a>中安全支柱下的<a class="ae le" href="https://docs.aws.amazon.com/wellarchitected/latest/machine-learning-lens/identity-and-access-management.html" rel="noopener ugc nofollow" target="_blank"> IAM最佳实践</a>。</p><p id="ce45" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在本演练中，新的IAM用户需要<strong class="lz ja">编程访问</strong>和<strong class="lz ja"> AWS管理控制台访问</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/6ad0214d314020b99b796eb03278e7eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEpAwhqbXUTKcktOK6inDg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">AWS重新确认自定义标签IAM用户的访问类型</figcaption></figure><p id="ae59" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">创建了一个新的<a class="ae le" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#customer-managed-policies" rel="noopener ugc nofollow" target="_blank">客户管理策略</a>来定义IAM用户所需的权限集。此外，一个现有的S3存储桶(在本例中为<em class="nn">my-rekognition-custom-labels-bucket</em>)也需要一个<a class="ae le" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/using-iam-policies.html" rel="noopener ugc nofollow" target="_blank">存储桶策略</a>，用于存储自然花卉数据集以进行访问控制。除了新IAM用户之外，任何用户都可以创建这个现有的存储桶。</p><p id="4d76" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">JSON格式的策略定义如下所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/c6cd76f85f951d3d77aa88da48f115d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5m2s8CCPiPAbJ7E1jjJ-eQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">IAM用户自定义标签的客户管理策略</figcaption></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="np nq l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">JSON形式的客户管理政策</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/3e409e4886d64c4ef4335bf9b9c17757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxJEoYBcQrxpCW6iD_MyZA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">数据集存储桶策略</figcaption></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="np nq l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Amazon Rekognition自定义标签花卉数据集S3存储桶的存储桶策略</figcaption></figure><h1 id="945e" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">花卉数据集</strong></h1><p id="473f" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">我们使用来自<a class="ae le" href="https://www.kaggle.com/c/oxford-102-flower-pytorch/" rel="noopener ugc nofollow" target="_blank">牛津102花卉PyTorch Kaggle竞赛</a>的<a class="ae le" href="https://www.kaggle.com/c/oxford-102-flower-pytorch/data?select=flower_data.zip" rel="noopener ugc nofollow" target="_blank"> <strong class="lz ja">牛津花卉102数据集</strong> </a> <strong class="lz ja"> </strong>来构建使用亚马逊Rekognition定制标签的自然花卉分类器。我们使用这个而不是来自牛津大学视觉几何组<a class="ae le" href="https://www.robots.ox.ac.uk/~vgg/index.html" rel="noopener ugc nofollow" target="_blank">的</a><a class="ae le" href="http://www.robots.ox.ac.uk/~vgg/data/flowers/102/102flowers.tgz" rel="noopener ugc nofollow" target="_blank">原始数据集</a>，因为它已经被分成<em class="nn">训练</em>、<em class="nn">有效</em>、<em class="nn">测试</em>数据集，更重要的是，这些数据已经被相应地标注了<em class="nn">训练</em>和<em class="nn">有效</em>的各自的花类别号。</p><p id="4923" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">该数据集共有<strong class="lz ja">8189张</strong>花朵图像，其中<em class="nn">列车</em>分割有<em class="nn">6552张</em>图像(<strong class="lz ja">80%</strong>)<em class="nn">有效</em>分割有<em class="nn"> 818 </em>图像(<strong class="lz ja">10%</strong>)<em class="nn">测试</em>分割有<em class="nn"> 819 </em>图像()下面的代码片段有助于将102种花的类别号转换成它们各自的名称。</p><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="720b" class="nx lg iq nt b gy ny nz l oa ob">import os<br/>import json</span><span id="2f0d" class="nx lg iq nt b gy oc nz l oa ob">with open('cat_to_name.json', 'r') as flower_cat:<br/>    data = flower_cat.read()</span><span id="04fb" class="nx lg iq nt b gy oc nz l oa ob">flower_types = json.loads(data)</span><span id="7f31" class="nx lg iq nt b gy oc nz l oa ob">for cur_dir_name, new_dir_name in flower_types.items():<br/>    os.rename(cur_dir_name, new_dir_name)</span></pre><p id="b6f1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">数据集存储桶应该具有相同的文件夹结构，如下所示，包括train和valid文件夹。每个应该有102个文件夹下，每个文件夹名称对应于一个特定的花卉类别名称。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/16fcd879ea2b4c435df97e8d6a4235bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5wiB9Bkbpeb538it-gEOA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">花卉数据集桶文件夹结构</figcaption></figure><h1 id="a0fa" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">创建新的花卉分类器项目</strong></h1><p id="2bb9" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">完成必要的设置后，您可以作为IAM用户登录AWS管理控制台。按照本<a class="ae le" href="https://docs.aws.amazon.com/rekognition/latest/customlabels-dg/gs-step-create-bucket.html" rel="noopener ugc nofollow" target="_blank">指南</a>中的步骤，为Amazon Rekognition自定义标签创建新项目。</p><h1 id="0390" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">创建新的训练和测试数据集</strong></h1><p id="a248" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">我们通过<a class="ae le" href="https://docs.aws.amazon.com/rekognition/latest/customlabels-dg/cd-s3.html#cd-procedure" rel="noopener ugc nofollow" target="_blank">从S3桶</a>导入图像，为亚马逊Rekognition自定义标签中的花卉分类器项目创建新的训练和测试数据集。重要的是给数据集一个清晰和独特的名称，以区分不同的数据集以及训练或测试。</p><p id="21a3" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">对于训练数据集，S3文件夹位置被设置为S3 <em class="nn">列车</em>文件夹路径，如下所示。类似地，对于测试数据集，S3文件夹位置被设置为S3 <em class="nn">有效</em>文件夹路径。</p><p id="6f0a" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><em class="nn">S3://my-rekognition-custom-labels-bucket/datasets/Oxford _ flowers _ 102/train/</em></p><p id="47d2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><em class="nn">S3://my-rekognition-custom-labels-bucket/datasets/Oxford _ flowers _ 102/valid/</em></p><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="aa18" class="nx lg iq nt b gy ny nz l oa ob"><strong class="nt ja">train</strong><br/>|- <strong class="nt ja">alpine sea holly</strong><br/>|  |- image_06969.jpg<br/>|  |- image_06970.jpg<br/>|  |- ...<br/>|- <strong class="nt ja">anthurium</strong><br/>|  |- image_01964.jpg<br/>|  |- image_01965.jpg<br/>|  |- ...<br/>|...</span></pre></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><pre class="ns nt nu nv aw nw bi"><span id="19b1" class="nx lg iq nt b gy ol om on oo op nz l oa ob"><strong class="nt ja">valid</strong><br/>|- <strong class="nt ja">alpine sea holly</strong><br/>|  |- image_06977.jpg<br/>|  |- image_06978.jpg<br/>|  |- ...<br/>|- <strong class="nt ja">anthurium</strong><br/>|  |- image_01972.jpg<br/>|  |- image_01975.jpg<br/>|  |- ...<br/>|...</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/cd3c15ff5dcc74862bf2729dd322292a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJnLlNqMy2p5IzyhcA1pHQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">从S3桶导入图像创建训练/测试数据集</figcaption></figure><p id="df84" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">训练和测试数据集中的所有图像都被组织到代表它们各自的花类别标签的文件夹名称中。请确保通过选中如上所示的复选框来启用<strong class="lz ja">自动标记</strong>，因为Amazon Rekognition自定义标签支持在此类结构中自动标记这些图像。这可以节省手动标注大型影像数据集的大量时间和精力。</p><p id="1dc6" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">您可以放心地忽略“<em class="nn">确保您的S3存储桶配置正确</em>”消息，因为您应该更早地应用存储桶策略。如果您使用的名称不同于此示例中的名称，请确保您的存储桶名称是正确的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/29fa413d921dc3f13d7b8d9f0a8ac076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Et-0BgVorjXdwVtgEGVKgQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">确保S3存储桶策略配置正确。</figcaption></figure><p id="cf26" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">创建训练和测试数据集后，应该使用列出的数据集。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/04db6e9c94e882cb770e47c6dc3baf60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYH2IvxEwCKUZwTm6CA72g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">训练和测试数据集</figcaption></figure><p id="6ec9" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">当您单击任一数据集时，您应该会发现所有图像都有相应的标签。您可以单击任何标签来检查该标签的图像。您也可以在左侧的搜索文本框中搜索标签。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/ec750746f06e95c3095355d22ca029a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_72a9MaScJI3PV-UOPmgw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">月兰的标签图像</figcaption></figure><h1 id="3c57" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">训练新的花卉分类器模型</strong></h1><p id="cded" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">您可以按照本<a class="ae le" href="https://docs.aws.amazon.com/rekognition/latest/customlabels-dg/tm-console.html" rel="noopener ugc nofollow" target="_blank">指南</a>在Amazon Rekognition自定义标签控制台中训练一个新模型。要创建一个测试数据集，您应该使用“<em class="nn">选择一个现有的测试数据集</em>”选项，如下所示，因为它应该已经在前面的部分中被创建了。</p><p id="3aa9" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">基于该花卉数据集的训练可能需要一个多小时(在本例中大约1小时20分钟)才能完成。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/5e1ae3bb861b20c0c2d3b182d078c1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zW9ZF81CKdi9dFfdOQjyg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">火车模型</figcaption></figure><h1 id="2a9c" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">评估训练好的模型性能</strong></h1><p id="a301" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">花卉分类器模型训练完成后，您可以通过访问控制台中的<a class="ae le" href="https://docs.aws.amazon.com/rekognition/latest/customlabels-dg/tr-console.html" rel="noopener ugc nofollow" target="_blank">评估结果</a>来查看模型性能，如图所示。通过本<a class="ae le" href="https://docs.aws.amazon.com/rekognition/latest/customlabels-dg/tr-metrics-use.html" rel="noopener ugc nofollow" target="_blank">指南</a>，您可以更好地理解评估模型性能的指标。您应该能够在Amazon Rekognition自定义标签中使用相同的数据集获得类似的模型性能评估结果。</p><p id="4d23" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">每个标签的<strong class="lz ja">性能</strong>是一个很棒的功能，允许您分析每个标签级别的性能指标，以便您更快、更容易地找出哪些标签的性能优于或差于平均水平。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/652a1be7995ecb8bdc67c0cda2ea74ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeyXmj52TVu4oWabv5iH1A.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">花卉分类器模型评估结果摘要和每个标签的性能</figcaption></figure><p id="926b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">此外，您还可以查看和过滤测试图像的结果(<strong class="lz ja">真阳性</strong>、<strong class="lz ja">假阳性</strong>、<strong class="lz ja">假阴性</strong>)，以了解模型在哪里做出了不正确的预测。这些信息通过指示如何更改图像或将图像添加到定型数据集或测试数据集中，帮助您提高模型的性能。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/ccec4f8b168b76e6d6ac75724e16e816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Sr10Niva_FmlR9DMZP1Kg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">测试结果评估库</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ow"><img src="../Images/556376d92b0ebb46b94abaccf190043b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLBuc2O5p1uUQhv0op31Ig.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">测试结果被误报过滤</figcaption></figure><h1 id="9df2" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">启动花卉分类器模型</strong></h1><p id="2dfa" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">当您对训练好的花卉分类器模型的性能感到满意时，您可以使用它来预测您选择的花卉。在使用它之前，您需要启动模型。在“模型评估结果”页面的底部，有关于如何使用模型启动、停止和分析花图像的示例AWS CLI命令。您可以参考本<a class="ae le" href="https://docs.aws.amazon.com/rekognition/latest/customlabels-dg/gs-step-start-model.html" rel="noopener ugc nofollow" target="_blank">指南</a>了解启动模型和为IAM用户设置AWS CLI的详细步骤。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ox"><img src="../Images/15b16c69b238236a7ee9d05759a5d31c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQ98iPMTepdbdKuTiiRu0w.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">将模型与AWS CLI命令一起使用</figcaption></figure><p id="9771" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">要启动该模型，请使用AWS CLI命令，如下所示。请注意，您应该根据您的设置或偏好来更改命令行参数。命名配置文件特定于为Amazon Rekognition自定义标签创建的IAM用户。</p><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="5c0b" class="nx lg iq nt b gy ny nz l oa ob"><strong class="nt ja">aws rekognition</strong> <strong class="nt ja">start-project-version</strong> \<br/>  <strong class="nt ja">--project-version-arn</strong> "MODEL_ARN" \<br/>  <strong class="nt ja">--min-inference-units</strong> 1 \<br/>  <strong class="nt ja">--region</strong> us-east-1 \<br/>  <strong class="nt ja">--profile</strong> customlabels-iam</span></pre><p id="d398" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">启动模型需要一段时间(在本例中大约15分钟)才能完成。您应该会在控制台中看到模型状态显示为正在运行，如图所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oy"><img src="../Images/09dacfdeb398c82cca9237859dc766cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJKmNU3UrqxtzALCQ57vMA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">模型开始</figcaption></figure><h1 id="c717" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">用看不见的花图像分类</strong></h1><p id="2dd8" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">模型运行后，您可以使用它来预测训练和测试数据集中不存在的图像的花朵类型，以确定您的模型在支持的花朵类型上的表现如何，这是以前从未见过的。您可以使用下面的AWS CLI命令来确定图像的预测标签。</p><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="acf1" class="nx lg iq nt b gy ny nz l oa ob"><strong class="nt ja">aws rekognition</strong> <strong class="nt ja">detect-custom-labels</strong> \<br/>  <strong class="nt ja">--project-version-arn</strong> "MODEL_ARN" \<br/>  <strong class="nt ja">--image</strong> '{"S3Object": {"Bucket": "BUCKET_NAME", "Name": "IMAGE_PATH"}}' \<br/>  <strong class="nt ja">--region</strong> us-east-1 \<br/>  <strong class="nt ja">--profile</strong> customlabels-iam</span></pre><p id="a5eb" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">以下是一些使用数据集的预测结果，这些数据集是自己获取的，或者独立于训练数据集和测试数据集。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/0cc8cde82cb608be44ba87af05be28e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*QPtkfVv4IHtze1e4daxWnQ.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">玫瑰</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="99a8" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": [<br/>        {<br/>            "Name": "rose",<br/>            "Confidence": 99.93900299072266<br/>        }<br/>    ]<br/>}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/409559f1333fb709638d9b528b7d5791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*JK8XGlRMt3smxNwQdQEOyw.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">莲花</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="a155" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": [<br/>        {<br/>            "Name": "lotus",<br/>            "Confidence": 99.7560043334961<br/>        }<br/>    ]<br/>}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/29d21b985c7d1931c596dce97c232cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*H_JLiio0U2izEV4Hjm5H7g.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">月兰</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="52f5" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": [<br/>        {<br/>            "Name": "moon orchid",<br/>            "Confidence": 98.02899932861328<br/>        }<br/>    ]<br/>}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/a514ba84658a95898a39ccb4a539fbe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*ZJ_Pv1EIuQbAcEwkMLC-Fw.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">木槿</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="114c" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": [<br/>        {<br/>            "Name": "hibiscus",<br/>            "Confidence": 98.11100006103516<br/>        }<br/>    ]<br/>}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/88c34e303993afdf73f7d6077b2481de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*hebIOScyvLDZ7R5lNjTx2g.jpeg"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">向日葵</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="5c04" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": [<br/>        {<br/>            "Name": "sunflower",<br/>            "Confidence": 99.86699676513672<br/>        }<br/>    ]<br/>}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/cc0560e00d7c8e48fce3dad37d4a8653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GIMAmdSUiNJTEOH1qmJ8w.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">人造花1</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="e12e" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": []<br/>}</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/7f09caaaabbd912e65a1948ddcbbcde3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5PzvSwIBmws4WE0nra4lA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">人造花2</figcaption></figure><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="5c5a" class="nx lg iq nt b gy ny nz l oa ob">{<br/>    "CustomLabels": []<br/>}</span></pre><h1 id="1341" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">清理资源</strong></h1><p id="a056" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">您将根据模型运行的时间付费。如果您已经使用完该模型，您应该停止它。您可以使用下面的AWS CLI命令来停止模型，以避免产生不必要的成本。</p><p id="e3ad" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">为了节省成本，如果不再需要自定义标注项目和数据集，也应将其删除到S3存储桶中。</p><pre class="kp kq kr ks gt ns nt nu nv aw nw bi"><span id="4a47" class="nx lg iq nt b gy ny nz l oa ob"><strong class="nt ja">aws rekognition stop-project-version </strong>\<br/><strong class="nt ja">  --project-version-arn </strong>"MODEL_ARN" \<br/>  <strong class="nt ja">--region </strong>us-east-1 \<br/>  <strong class="nt ja">--profile</strong> customlabels-iam</span></pre><p id="ef9c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">停止模型比启动模型更快。在这种情况下，大约需要5分钟。您应该会在控制台中看到模型状态显示为已停止。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oy"><img src="../Images/44552ef345739106420bc636f0d18e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVsg9aHltNkpOqW_ZQDv9w.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">模型停止</figcaption></figure><h1 id="280c" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated"><strong class="ak">结论和下一步措施</strong></h1><p id="1a49" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">这篇文章展示了使用Amazon Rekognition自定义标签和基于AWS良好架构框架的AWS最佳实践创建自然花卉分类器的完整分步演练。它还表明，在没有机器学习专业知识的情况下，您可以使用Amazon Rekognition自定义标签构建高性能的自定义计算机视觉模型。</p><p id="201d" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在本演练中构建的模型的<em class="nn"> F1分数</em>为<strong class="lz ja"> 0.997 </strong>，<em class="nn"> </em>，即使具有丰富的机器学习专业知识，如果从零开始构建，这对于相同的数据集也是不容易实现的。它还能够在看不见的天然花的样本上很好地执行，并且预计不能在人造花的样本上进行预测。</p><p id="16f8" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如果你有兴趣从头构建一个自然花卉分类器，你可能会对我的帖子感兴趣:<a class="ae le" href="https://towardsdatascience.com/build-train-and-deploy-a-real-world-flower-classifier-of-102-flower-types-a90f66d2092a" rel="noopener" target="_blank"> <strong class="lz ja">使用TensorFlow 2.3、Amazon SageMaker Python SDK 2.x和定制SageMaker培训&amp;服务Docker容器</strong></a>构建、训练和部署一个包含102种花卉类型的真实世界花卉分类器 — <strong class="lz ja"> </strong>。</p></div></div>    
</body>
</html>