# 我的熊猫用于探索性分析和数据处理

> 原文：<https://pub.towardsai.net/my-pandas-cheatsheet-for-exploratory-analysis-and-data-manipulation-75c8ea462d12?source=collection_archive---------0----------------------->

## 帮助你快速分析和操作数据集的 12 大熊猫函数

![](img/0e3a828b6669cb6864a86842c3afc4ee.png)

[拍照那是她的事](https://unsplash.com/@thatsherbusiness)上 [Unsplash](https://unsplash.com/photos/R4sP8_Bq0Bw)

我以前已经写过关于熊猫的教程，但我在探索和操纵数据集的同时发现新事物的方式令人惊讶。最近，我开始了一项新的工作经历，我惊讶地发现，每一个想当然的功能都可以通过发现数据中的隐藏模式来真正挽救你的生命。

在本教程中，我想向您展示 12 个对数据集的数据质量至关重要的熊猫函数。你肯定知道其中的一些，但是总有一些方面你忽略了，因为你太匆忙了，要去完成另一个任务。

我将从展示必不可少的 pandas 函数开始，这些函数可以帮助您快速理解数据集是如何组织的，缺少什么信息，以及数值变量的范围。之后，我将介绍更高级的函数来修改您的数据集，比如向一个数据帧添加一行并连接两个数据帧。

使用的数据集包含英国人口，来自国家统计局。到数据集的链接在这里是。它在[开放政府许可 v3.0](https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/) 下可用。我认为这是一个简单的例子，由于统计局的工作，它可以鼓励使用开放的数据。我们开始吧！

## 1.可视化第一行和最后一行

如果你已经开始玩数据学习了，你大概就知道我在说什么了。每当我们需要对数据结构有一个概念时，我们就使用`head()`和`tail()`，这是一个硬币的两面。如果不更改默认参数，第一个函数显示前五行的概述。

在这种情况下，我们错误地导入了数据集。在前几行中，有一些关于数据集内容的解释，但是真正的内容从第 8 行开始。因此，我们需要跳过前七行:

现在，我们终于可以看到英国的人口估计数了，它包含在 2021 年中期、2011 年中期和 2001 年中期的列中。该年对应于进行人口普查以估计所有居民的年份。该数据集不仅局限于英国的居民数量，还包括英国境内的国家(英格兰、苏格兰、威尔士和北爱尔兰)、地区、郡和其他类型的地方当局区域。

同样，`tail()`允许可视化五行，但在底部:

我们还用更合适的名称重命名了与人口相关的字段，并将 Geography 转换为 category 类型。

## 2.计算每列的统计数据

可视化数据集的一小部分后，就该分析要素了。特别是，我们希望看到一个包含数字和分类列的所有统计信息的表。让我们从计算数值变量的最小值、最大值和分位数开始:

`describe()`函数允许计算这些描述性统计数据。

为了更全面地了解我们的人口估计，我们还可以修改对应于百分位数的默认参数，并传递更大范围的百分位数:

了解它们是否包含一些干扰信息、异常值和其他可能对后续步骤有用的信息非常有帮助。

也有可能只关注分类特征:

相反，如果我们希望将所有这些洞察包含到一个唯一的表中，我们需要在函数中指定“all ”:

从这个表中，我们可以观察到每一行对应一个不同的代码，它代表我们的统计单位。该代码也称为邮政编码或单位邮政编码，通常由五到七个字母数字字符组成，旨在识别英国的不同地区。它包含不同的信息，如国家和地区。该名称表示国家、地区、国家和另一种位置类型的名称，而位置类型由地理位置指定，地理位置可以有九种形式。

## 3.查找分类特征的唯一值

以前，我们看到地理有九个独特的值，但我们看不到模态。我们可以用`unique()`函数来实现:

我们还可以检查行数是否对应于代码变量的唯一值的数量:

行数与唯一值的数量相对应，因此我们确信没有重复的值。我应该强调这是一个重要的检查，当你处理数据时，没有什么是理所当然的。最好先验证一下再开始更高级的分析，否则以后你就有问题了，而且要花时间和精力去纠正错误。

## 4.唯一值的频率和百分比

在上一节中，我们看到了地理的形态，但是我们还想可视化相应的计数。这可以通过`value_counts()`功能实现:

如果我们想要百分比，而不是频率，我们只需要指定`normalize=True`:

很明显，超过 40%的地方是非大都市地区，19%是单一当局，其余地区不到 9%。

## 5.计算列中缺少的值

这是在从事数据科学项目时要做的另一项基本检查。要计算空值的数量，有一个`isnull().sum()`可以帮你完成:

在这种情况下，我们没有任何丢失的值，但大多数情况下，您会发现空值，您需要处理这个问题。决定删除与缺失信息相对应的行，或者用一些技术替换值，如特定特征的平均值和模式。

## 6.创建新功能

特征工程是从数据集中提取有价值信息的一项重要技能。在这个例子中，我们有几个特性，我们想添加一个包含国家信息的列。事实上，每个地点可以属于四个国家中的一个:英格兰、威尔士、苏格兰和北爱尔兰。怎么才能补充呢？如前所述，我们可以从邮政编码的第一个字母推断出来。让我们使用`apply`函数创建一个只包含代码特性的第一个字符的列:

我们可以一眼看出，第一个字母对应于前面列出的模态的第一个字符。最有效的操作是使用字典将每个值替换为另一个值，如下所示:

如果再统计一下每个唯一值的配额，可以推断出大部分地点都是英格兰国家的一部分，只有不到 8%在苏格兰，其余的都在威尔士和北爱尔兰。

## 7.根据要素的值对数据集进行排序

假设我们希望看到英格兰和威尔士人口密度最高的前 15 个统一当局。特别是，根据 2021 年人口普查的人口估计值，按降序显示这些城市将非常有用。这可以通过`sort_values()`功能实现:

正如我们所料，除了威尔士的首都和最大城市卡迪夫，所有人口最多的城市都属于英格兰。

## 8.基于要素对数据进行分组

可能会出现这样的情况:您有粒度数据，并且您更愿意根据您的研究目的对其进行汇总。例如，假设我们想计算 2011 年和 2021 年人口普查的四个国家中每个国家的居民人数。我们可以使用`groupby()`功能对数据进行分组。

在一行代码中，我们还重置了索引，并根据填充值对行进行了降序排序。你可以在国家统计局提供的这份报告中找到相同的结果。

## 9.向熊猫数据框架添加行

为了向数据帧添加一行或多行，我们利用了`concat()`函数:

在这几行代码中，有几个操作:

*   我们创建一个字典，其中的关键字是标题的名称，值是海峡群岛的人口估计。
*   通过应用`from_dict()`函数，字典被转换成熊猫数据帧
*   我们将这两个数据帧连接成一个唯一的数据帧。

## 10.连接两个数据框

前面，我们添加了一个新行，但这不是丰富数据集信息的唯一方式。例如，我们可能有兴趣将家庭数量包含在我们的数据集中。

在这种情况下，我们不需要添加行，但是需要使用`merge()`函数合并两个具有公共字段的数据集，通常命名为主键。

我们指定连接的类型，以及两端的主键。如果主键名相同，参数`on`就足够了，不需要指定`left_on`和`right_on`。

家庭的数据集可以在这里[找到](https://www.ons.gov.uk/datasets/TS041/editions/2021/versions/1)并且只包含与英格兰和威尔士相关的数据，所以我们可以预期在这个左连接之后会缺少值。让我们检查一下

有 83 个空值对应于不属于英格兰和威尔士的位置。

## 总结:

*   `head()`和`tail()`来可视化数据集的第一行和最后五行。
*   `describe()`计算所有列的统计数据。
*   `unique()`和`nunique()`分别获取一列的唯一值和唯一值的个数。
*   `value_counts()`查看您的分类字段中每个模态的频率。
*   `isnull().sum()`检查所有列的缺失值。
*   `apply()`和`map()`功能用于创建新特征。
*   `groupby()`根据一个或多个特征对数据进行分组的功能。
*   向数据帧添加一行或多行的函数。
*   `merge()`连接两个数据帧的功能。

## 最终想法:

就是这样！这些是我在数据科学项目中大部分时间使用的 Pandas 函数。当然还有我在本文中没有涉及的其他功能和方面。如果有兴趣，再深入一点，找其他可能的情况使用这些功能。你知道熊猫其他有用的功能吗？如果是，请在评论中写下你的建议。感谢阅读！祝您愉快！

## 其他相关文章:

[](https://betterprogramming.pub/how-to-deal-with-time-series-using-pandas-and-plotly-express-45b6848432df) [## 如何使用 Pandas 和 Plotly Express 处理时间序列

### 处理时间序列数据

better 编程. pub](https://betterprogramming.pub/how-to-deal-with-time-series-using-pandas-and-plotly-express-45b6848432df) [](https://betterprogramming.pub/3-pandas-functions-to-group-and-aggregate-data-9763a32583bb) [## 3 Pandas 功能用于分组和汇总数据

### 导入数据并进行简单和多重聚合

better 编程. pub](https://betterprogramming.pub/3-pandas-functions-to-group-and-aggregate-data-9763a32583bb) 

你喜欢我的文章吗？ [*成为会员*](https://eugenia-anello.medium.com/membership) *每天无限获取数据科学新帖！这是一种间接的支持我的方式，不会给你带来任何额外的费用。如果您已经是会员，* [*订阅*](https://eugenia-anello.medium.com/subscribe) *每当我发布新的数据科学和 python 指南时，您都会收到电子邮件！*