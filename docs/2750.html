<html>
<head>
<title>Time Series Forecasting with ARIMA Models In Python [Part 1]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中ARIMA模型的时间序列预测[第一部分]</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/time-series-forecasting-with-arima-models-in-python-part-1-c2940a7dbc48?source=collection_archive---------1-----------------------#2022-05-11">https://pub.towardsai.net/time-series-forecasting-with-arima-models-in-python-part-1-c2940a7dbc48?source=collection_archive---------1-----------------------#2022-05-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3e9b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python中的ARIMA模型进行时间序列预测的实用指南</h2></div><p id="7f01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">ime系列数据是行业中最常见的数据类型之一，在您的职业生涯中可能会用到它。因此，了解如何使用它以及如何应用分析和预测技术对于每个有抱负的数据科学家来说至关重要。在这一系列文章中，我将介绍处理时间序列数据的基本技术，从数据操作、分析和可视化开始，以了解您的数据并为其做准备，然后使用统计、机器和深度学习技术进行预测和分类。这更像是一个实践指南，我将把每个讨论和解释的概念应用到真实数据中。</p><p id="cce2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个系列将由10篇文章组成:</p><ol class=""><li id="87d0" class="ln lo it kk b kl km ko kp kr lp kv lq kz lr ld ls lt lu lv bi translated"><a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/manipulating-time-series-data-in-python-49aed42685a0">在Python Pandas中操作时间序列数据【实用指南】</a></li><li id="5711" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated"><a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/time-series-data-analysis-in-python-1492ee4ca974">Python Pandas中的时间序列分析【实用指南】</a></li><li id="4e44" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated"><a class="ae lw" href="https://medium.com/towards-artificial-intelligence/time-series-data-visualization-in-python-2b1959726312" rel="noopener">用Python可视化时间序列数据【实用指南】</a></li><li id="16f2" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated"><a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/time-series-forecasting-with-arima-models-in-python-part-1-c2940a7dbc48">用Python实现ARIMA模型的时间序列预测【第一部分】</a>(你来了！)</li><li id="88d6" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated"><a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/time-series-forecasting-with-arima-models-in-python-part-2-91a30d10efb0">利用Python中的ARIMA模型进行时间序列预测【第二部分】</a></li><li id="79b7" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated"><a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/machine-learning-for-time-series-data-in-python-regression-5e19fa2e7471">时间序列数据的机器学习【回归】</a></li><li id="8728" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated">时间序列数据的机器学习[分类](即将推出)</li><li id="f9d5" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated">时间序列数据的深度学习[实用指南](即将推出)</li><li id="ffb0" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated">使用统计分析、机器学习和深度学习的时间序列预测项目(即将推出)</li><li id="b87b" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld ls lt lu lv bi translated">使用统计分析、机器学习和深度学习进行时间序列分类(即将推出)</li></ol><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/b18e7b8bd1f6b979af4e2b5e78287d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GP2gas3MI2CgGekF"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">用ARIMA模型预测未来/照片由<a class="ae lw" href="https://unsplash.com/@lazycreekimages?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Michael Dziedzic </a>在<a class="ae lw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="00f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你曾经试图预测未来吗？未来是一个谜，通常只有等待才能解开。在这篇文章和接下来的文章中，我们将停止等待，学习使用强大的ARIMA类模型来预测未来。您将学习如何使用statsmodels包来分析时间序列、构建定制的模型以及在不确定的情况下进行预测。未来24小时股市将如何走势？未来十年，二氧化碳的水平会有怎样的变化？明年会有多少次地震？你将学会解决所有这些问题，甚至更多。</p><blockquote class="ms mt mu"><p id="e81f" class="ki kj mv kk b kl km ju kn ko kp jx kq mw ks kt ku mx kw kx ky my la lb lc ld im bi translated">本文使用的数据和代码可以在<a class="ae lw" href="https://github.com/youssefHosni/Time-Series-With-Python/tree/main/Arima%20Models%20in%20Python" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">这个资源库</strong> </a> <strong class="kk iu">中找到。</strong></p></blockquote><h1 id="8b48" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">目录:</h1><p id="7cc8" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated"><strong class="kk iu"> 1。ARMA模型介绍</strong></p><ul class=""><li id="a8e1" class="ln lo it kk b kl km ko kp kr lp kv lq kz lr ld nw lt lu lv bi translated">平稳性介绍</li><li id="0f3c" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">使时间序列平稳</li><li id="c830" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">AR、MA和ARMA模型简介</li></ul><p id="5895" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.<strong class="kk iu">拟合未来</strong></p><ul class=""><li id="946d" class="ln lo it kk b kl km ko kp kr lp kv lq kz lr ld nw lt lu lv bi translated">拟合时间序列模型</li><li id="c3e1" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">预测</li><li id="9f50" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">非平稳时间序列的ARIMA模型</li></ul><p id="e01b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3。参考文献</strong></p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="b8fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">如果你想免费学习数据科学和机器学习，看看这些资源:</strong></p><ul class=""><li id="9cc5" class="ln lo it kk b kl km ko kp kr lp kv lq kz lr ld nw lt lu lv bi translated">免费互动路线图，自学数据科学和机器学习。从这里开始:<a class="ae lw" href="https://aigents.co/learn/roadmaps/intro" rel="noopener ugc nofollow" target="_blank">https://aigents.co/learn/roadmaps/intro</a></li><li id="bd29" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">数据科学学习资源搜索引擎(免费)。将你最喜欢的资源加入书签，将文章标记为完整，并添加学习笔记。<a class="ae lw" href="https://aigents.co/learn" rel="noopener ugc nofollow" target="_blank">https://aigents.co/learn</a></li><li id="d7ed" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">想要在导师和学习社区的支持下从头开始学习数据科学吗？免费加入这个学习圈:<a class="ae lw" href="https://community.aigents.co/spaces/9010170/" rel="noopener ugc nofollow" target="_blank">https://community.aigents.co/spaces/9010170/</a></li></ul><p id="b734" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想在数据科学领域开始职业生涯，而你不知道如何开始。我提供数据科学指导课程和长期职业指导:</p><ul class=""><li id="41a2" class="ln lo it kk b kl km ko kp kr lp kv lq kz lr ld nw lt lu lv bi translated">长期指导:<a class="ae lw" href="https://lnkd.in/dtdUYBrM" rel="noopener ugc nofollow" target="_blank">https://lnkd.in/dtdUYBrM</a></li><li id="5159" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">辅导会议:<a class="ae lw" href="https://lnkd.in/dXeg3KPW" rel="noopener ugc nofollow" target="_blank">https://lnkd.in/dXeg3KPW</a></li></ul><p id="a919" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="mv">加入</em> </strong> <a class="ae lw" href="https://youssefraafat57.medium.com/membership" rel="noopener"> <strong class="kk iu"> <em class="mv">中等会员</em> </strong> </a> <strong class="kk iu"> <em class="mv">计划，只需5美元，继续无限制学习。如果你使用下面的链接，我会收到一小部分会员费，不需要你额外付费。</em>T13】</strong></p><div class="oe of gp gr og oh"><a href="https://youssefraafat57.medium.com/membership" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">加入我的介绍链接媒体-优素福胡斯尼</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">阅读Youssef Hosni(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">youssefraafat57.medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov mm oh"/></div></div></a></div></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h1 id="89e9" class="mz na it bd nb nc ow ne nf ng ox ni nj jz oy ka nl kc oz kd nn kf pa kg np nq bi translated">1.ARMA模型</h1><p id="0981" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">我们将从平稳性的简单介绍开始，以及平稳性对ARMA模型的重要性。然后我们将修改如何用肉眼和标准的统计测试来检验平稳性。如果你想获得关于这些主题的更多信息，你可以查看我以前的文章<a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/time-series-data-analysis-in-python-1492ee4ca974"><strong class="kk iu">Python中的时间序列分析</strong> </a>，因为它们在其中有更详细的介绍。最后，您将学习ARMA模型的基本结构，并使用它来生成一些ARMA数据和拟合ARMA模型。</p><p id="c3fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<a class="ae lw" href="https://github.com/youssefHosni/Time-Series-With-Python/blob/main/Arima%20Models%20in%20Python/candy_production.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">糖果生产数据集</strong> </a>，它代表了1972年至2018年间美国每月的糖果产量。具体来说，我们将使用工业生产指数IPG3113N。这是美国每月生产的糖和糖果产品总量，占2012年1月产量的百分比。因此，120将是2012年1月工业产量的120%。</p><h2 id="3311" class="pb na it bd nb pc pd dn nf pe pf dp nj kr pg ph nl kv pi pj nn kz pk pl np pm bi translated">1.1.平稳性介绍</h2><p id="5cbe" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">平稳意味着数据的分布不随时间变化。对于一个平稳的时间序列，它必须满足三个标准:</p><ul class=""><li id="e544" class="ln lo it kk b kl km ko kp kr lp kv lq kz lr ld nw lt lu lv bi translated">该系列有零趋势。它没有增长也没有萎缩。</li><li id="63c4" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">方差是常数。数据点离零线的平均距离没有变化。</li><li id="a864" class="ln lo it kk b kl lx ko ly kr lz kv ma kz mb ld nw lt lu lv bi translated">自相关是恒定的。时间序列中的每个值与其相邻值的关系保持不变。</li></ul><p id="c4eb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">平稳性的重要性来自于建模一个时间序列，它必须是平稳的。其原因在于，建模的目的是估计代表数据的参数，因此，如果数据的参数随时间变化，则很难估计所有的参数。</p><p id="9b99" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们首先加载并绘制月度糖果生产数据集:</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi pp"><img src="../Images/b1377d6067f740f0132dbf0f694bdfe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_C-CynLMBXt3ajN_N8Hedg.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">1974年至2018年美国糖果月产量。</figcaption></figure><p id="4349" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一般来说，在机器学习中，你有一个适合你的模型的训练集，和一个测试集，用来测试你的预测。时间序列预测也是一样。我们的火车测试分割将会不同。我们使用过去的值来预测未来，因此我们需要及时分割数据。我们根据时间序列中较早的数据进行训练，并根据随后的数据进行测试。我们可以使用数据框的<strong class="kk iu">分割给定日期的时间序列，如下所示。锁定</strong>方法。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi pp"><img src="../Images/f749ef1028bbf178466a613232287177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xE7YczZgcbjNMApzQ9zmqA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">美国每月糖果产量的测试分割。</figcaption></figure><h2 id="8539" class="pb na it bd nb pc pd dn nf pe pf dp nj kr pg ph nl kv pi pj nn kz pk pl np pm bi translated">1.2.使时间序列平稳</h2><p id="066b" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">有许多方法来测试静态，其中一种是用眼睛，其他的更正式的是使用统计测试。也有将非平稳时间序列转化为平稳时间序列的方法。我们将在这一小节中解决这两个问题，然后您就可以开始建模了。</p><p id="6706" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">识别时间序列是否为非平稳的最常见测试是扩展的Dicky-Fuller测试。这是一个统计测试，零假设是你的时间序列由于趋势而不稳定。我们可以使用statsmodels实现增强的Dicky-Fuller测试。首先，我们导入如图所示的<strong class="kk iu"> adfuller </strong>函数，然后我们可以在糖果生产时间序列上运行它。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/b45bfeb746df25639ac81834fb6dff86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*jDVHoEabAUZMSJF-sGRN-Q.png"/></div></figure><p id="d151" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结果对象是一个元组。第零个元素是测试统计量，在本例中，它是-1.77。这个数字越负，数据越可能是稳定的。结果元组中的下一项是测试p值。这里是0.3。如果p值小于0.05，我们拒绝零假设，并假设我们的时间序列必须是平稳的。元组中的最后一项是字典。这存储了等同于不同p值的检验统计的临界值。在这种情况下，如果我们想要p值为0.05或更低，我们的测试统计需要低于-2.86。</p><p id="26e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基于这一结果，我们确信时间序列是非平稳的。因此，在建模之前，我们需要将数据转换成静态形式。我们可以认为这有点像经典机器学习中的特征工程。使时间序列平稳的一个非常常见的方法是求它的差。这是我们从时间序列中的每个值减去前一个值的地方。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi pr"><img src="../Images/d6fb5c46c146b1193857f124554fd205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TgZ7seA6oR-A9RTCy2TWUg.png"/></div></div></figure><p id="b47e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从结果中，我们可以看到现在的时间序列是平稳的。这一次，求差就足以使它稳定，但对于其他时间序列，我们可能需要多次求差或进行其他变换。有时，我们需要执行其他转换来使时间序列稳定。这可以是取对数，或时间序列的平方根，或计算比例变化。很难决定做哪一个，但是通常最简单的解决方案是最好的。</p><h2 id="c6cd" class="pb na it bd nb pc pd dn nf pe pf dp nj kr pg ph nl kv pi pj nn kz pk pl np pm bi translated">1.3.AR、MA和ARMA模型介绍</h2><p id="9756" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">在自回归(AR)模型中，我们将时间序列的值与同一时间序列的先前值进行回归。简单AR模型的等式如下所示:</p><p id="a0cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y(t) = a(1) * y(t-1) + ϵ(t)</p><p id="2ed0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">时间(t)处的时间序列的值是前一步的时间序列的值乘以参数a(1)加上噪声或冲击项ϵ(t).冲击术语是白噪声，意味着每个冲击都是随机的，与系列中的其他冲击无关。a(1)是滞后一点的自回归系数。与简单的线性回归相比，因变量是y(t)，自变量是y(t-1)。系数a(1)仅仅是线的斜率，冲击是线的残差。</p><p id="345a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一阶AR模型。模型的阶数是所用的时滞数。二阶AR模型有两个自回归系数和两个独立变量，滞后一的序列和滞后二的序列。更一般的，我们用p来表示AR模型的阶数。这意味着我们有p个自回归系数并使用p个滞后。</p><p id="a6d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<strong class="kk iu">移动平均(MA) </strong>模型中，我们将时间序列的值与同一时间序列的先前冲击值进行回归。简单MA模型的等式如下所示:</p><p id="83f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y(t) = m(1)*ϵ(t-1) + ϵ(t)</p><p id="c5cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">时间序列y(t)的值是前一步冲击值的m(1)倍；加上当前时间步长的一个令人震惊的术语。这是一个一阶马模型。同样，模型的顺序意味着我们使用多少时间滞后。一个MA模型将包括一步和两步之前的冲击。更一般地，我们用q来表示MA模型的阶数。</p><p id="dccb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ARMA模型是AR和MA模型的组合。时间序列是根据以前的值和以前的冲击项回归的。这是ARMA-one-one模型。更一般地，我们使用ARMA(p，q)来定义ARMA模型。p告诉我们模型的自回归部分的阶，q告诉我们移动平均部分的阶。</p><p id="a825" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y(t)= a(1)* y(t-1)+m(1)* ϵ(t-1)+ϵ(t)</p><p id="146b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<strong class="kk iu"> statsmodels </strong>软件包，我们既可以拟合ARMA模型，也可以创建ARMA数据。让我们看看这个ARMA-one-one模型。假设我们想用这些系数模拟数据。首先，我们导入arma-generate-sample函数。然后我们列出AR和MA系数。请注意，两个系数列表都以1开头。这是零滞后项，我们总是把它设为1。我们设置滞后一个AR系数为0.5，MA系数为0.2。我们生成数据，传入系数、要创建的数据点的数量以及冲击的标准偏差。<strong class="kk iu">在这里，我们实际上传递了我们需要的AR系数的负值。</strong> <strong class="kk iu">这是一个我们需要记住的怪癖</strong>。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="9941" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">生成的数据可以用以下等式表示:</p><p id="5b48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y(t)= 0.5y(t1)+0.2 * ϵ(t−1)+ϵ(t).</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/662583ed4e339d07be3a1a1bfea4c67c.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*pJ0pm6E_G3F2uPnq8C8POw.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">用ARMA模型生成的数据。</figcaption></figure><p id="2d20" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">拟合将在下一节中介绍，但这里可以快速浏览一下如何拟合这些数据。首先，我们导入ARMA模型类。我们实例化模型，向其提供数据并定义模型顺序。然后我们终于适应了。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h1 id="dd8b" class="mz na it bd nb nc ow ne nf ng ox ni nj jz oy ka nl kc oz kd nn kf pa kg np nq bi translated">2.适应未来</h1><p id="1af6" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">在本节中，您将学习如何使用优雅的statsmodels包来拟合ARMA、ARIMA和ARMAX模型。然后，您将使用您的模型来预测<a class="ae lw" href="https://github.com/youssefHosni/Time-Series-With-Python/blob/main/Arima%20Models%20in%20Python/amazon_close.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">亚马逊股票价格的不确定未来。</strong>T3】</a></p><h2 id="4048" class="pb na it bd nb pc pd dn nf pe pf dp nj kr pg ph nl kv pi pj nn kz pk pl np pm bi translated">2.1.拟合时间序列模型</h2><p id="16b8" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">在上一节中，我们快速浏览了拟合时间序列模型，但让我们更仔细地看一下。为了适应这些模型，我们首先从<strong class="kk iu"> statsmodels </strong>包中导入<strong class="kk iu"> ARIMA </strong>模型类。我们创建一个模型对象并定义模型顺序，我们还必须输入训练数据。数据可以是pandas数据帧、pandas系列或NumPy数组。记住ARIMA模型的阶是(p，d，q) p是自回归滞后，d是差的阶，q是移动平均滞后。d总是一个整数，而p和q可以是整数或整数列表。为了拟合AR模型，我们可以简单地使用q等于零的ARMA类。为了符合MA模型，我们将p设置为零。</p><p id="6a2a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看看拟合模型的结果汇总:</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/ce17175a8441b15e1c25837c1a4e85c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*-igb1HiB4wfRN6kNTlhJ_w.png"/></div></figure><p id="f5db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">顶部包括有用的信息，例如我们拟合的模型的阶数、观察值或数据点的数量以及时间序列的名称。创新的标准差是冲击项的标准差。</p><p id="fef9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">概要的下一部分显示了拟合的模型参数。这里我们拟合了ARIMA(1，0，1)模型，因此该模型具有AR-lag-1和lag-1系数。在表中，这些是ar。和马。L1街。滞后-1 MA系数在最后一行。第一列显示模型系数，而第二列显示这些系数的标准误差。这是拟合系数值的不确定性。</p><p id="f0a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ARMA模型的一个可能的扩展是使用外部输入来创建ARMAX模型。这意味着我们使用其他独立变量以及时间序列本身对时间序列进行建模。这就像是ARMA模型和正常线性回归模型的结合。这里显示了两个简单的ARMA和ARMAX模型的方程。唯一的区别是多了一项。我们增加一个新的自变量z(t)乘以它的系数x(1)。让我们想一个ARMAX可能有用的例子。</p><p id="bea5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ARMA(1，1)模型:</p><p id="11fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y(t) = a(1) y(t-1) + m(1) ϵ(t-1) + ϵ(t)</p><p id="7f1c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ARMAX(1，1)模型:</p><p id="ffad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y = x(1)* z(t)+a(1)y(t-1)+m(1)ϵ(t-1)+ϵ(t)</p><p id="1dc2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用之前使用的相同ARMA模型类来拟合ARMAX模型。唯一的区别是，我们现在将使用exog关键字输入我们的外生变量。模型顺序和安装程序完全相同。</p><h2 id="4d33" class="pb na it bd nb pc pd dn nf pe pf dp nj kr pg ph nl kv pi pj nn kz pk pl np pm bi translated">2.2.预测</h2><p id="691e" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">在介绍了如何用ARIMA模型拟合数据之后，让我们看看如何用它们来预测未来。让我们以AR(1)模型表示的时间序列为例。在时间序列中的任何时间点，我们都可以通过将前一个值乘以滞后一位的AR系数来预测下一个值。如果前一个值是15，系数α-1是0.5，我们估计下一个值是7.5。如果冲击项的标准偏差为1，我们预测不确定性的下限和上限分别为6.5和8.5。这种类型的预测称为<strong class="kk iu">一步预测</strong>。下面是它的方程式:</p><p id="55ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">y = 0.5 x 15 + ϵ(t)</p><h2 id="9621" class="pb na it bd nb pc pd dn nf pe pf dp nj kr pg ph nl kv pi pj nn kz pk pl np pm bi translated">2.3.非平稳时间序列的ARIMA模型</h2><p id="94cb" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">如果您试图预测的时间序列是非平稳的，您将无法对其应用ARMA模型。我们首先要求差，使它稳定，然后我们可以用ARMA模型。然而，当我们这样做时，我们将有一个模型，它被训练来预测时间序列的差值。我们真正想预测的不是差值，而是时间序列的实际值。我们可以通过仔细转换我们对差异的预测来实现这一点。</p><p id="9e09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们从差值的预测开始，求差的反面是求累积和或积分。我们将需要使用这个转换来从差值的预测到绝对值的预测。</p><p id="c982" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用<strong class="kk iu"> np.cumsum </strong>函数来实现。如果我们应用这个函数，我们现在就可以预测在预测期间时间序列从初始值变化了多少。为了得到一个绝对值，我们需要将原始时间序列的最后一个值加到这个值上。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="5c8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从非平稳数据开始的这些步骤；差分使其静止；然后整合预测在时间序列建模中非常常见。这是很大的工作量！但是谢天谢地，有一个ARMA模型的扩展为我们做了这件事！这就是自回归综合移动平均模型(<strong class="kk iu">【ARIMA】</strong>)。</p><p id="bf5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用statsmodels中的SARIMAX模型类实现一个ARIMA模型。ARIMA模型有三个模型订单。这些是p自回归序列；d是差分的阶，q是移动平均阶。在上一节中，我们将中间阶参数d设置为零。如果d是零，我们简单地有一个ARMA模型。</p><p id="1d1c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们使用这个模型时，我们以非差分时间序列和模型顺序传递它。当我们想对时间序列数据进行一次差分，然后应用ARMA(2，1)模型时。这是通过使用ARIMA(2，1，1)模型实现的。在我们声明了差分参数之后，我们就不再需要担心差分了。我们像以前一样拟合模型并做出预测。差分和集成步骤都由模型对象负责。对于非平稳时间序列，这是一种更简单的预测方法！</p><blockquote class="ms mt mu"><p id="0bcf" class="ki kj mv kk b kl km ju kn ko kp jx kq mw ks kt ku mx kw kx ky my la lb lc ld im bi translated">我们仍然必须小心选择合适的差异量。请记住，我们只对数据进行差分，直到它稳定为止。我们将在应用我们的模型之前解决这个问题，使用增强的Dicky-Fuller测试来决定差序。因此，当我们开始应用一个模型时，我们已经知道我们应该应用的差异程度。</p></blockquote><p id="6721" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们将此应用于真实数据。将要使用的数据是<a class="ae lw" href="https://github.com/youssefHosni/Time-Series-With-Python/blob/main/Arima%20Models%20in%20Python/amazon_close.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">亚马逊股票价格数据</strong> </a> <strong class="kk iu">。我们将应用这两种方法。首先对具有差异的数据使用ARMA模型，并使用具有内置差异的ARIMA模型。</strong></p><p id="d930" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，数据将被上传和绘制。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/8bdb77e3b21be25ad97df8dea40d3e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*juvb5zXl7ynt3CgqqNtdAg.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">亚马逊股价随时间变化。</figcaption></figure><p id="dbef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们将应用Adfuller-Dickey检验来了解时间序列是否是平稳的。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="7ae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样做的结果如下:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/b62cc2a08581a04f86a97c144fcb48b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*zg0s-KkL3eDFdqvYDQgI-Q.png"/></div></figure><p id="7b34" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">p值大于0.05，因此我们不能拒绝零假设，时间序列被认为是非平稳的。因此，我们将取第一个差值，并用Adfuller-Dickey检验来检验它是否是稳定的。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/4cc1c18b63310cb0af91e1841dbe6011.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*5On6y7hUYy-Kdg9dLR10ag.png"/></div></figure><p id="a5b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对亚马逊股价时间序列进行一阶差分后的p值小于0.05，因此我们可以拒绝零假设，现在的数据被认为是平稳的。对于建模步骤，我们可以遵循上面提到的两条路径之一。首先，使用ARMA模型，应用于一阶差分的数据。然后<strong class="kk iu"> np.cumsum </strong>函数将用于预测实际数据，而不是有差异的数据。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="ba5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二种方法是使用ARIMA模型，使用实际数据，并使用<strong class="kk iu"> ARIMA </strong>函数中的差异参数。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="pn po l"/></div></figure><p id="f129" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文的第2部分，我们将讨论如何使用自相关函数(ACF)和偏自相关函数(PACF)图选择最佳模型参数，并使用阿凯克信息标准(AIC)和贝叶斯信息标准(BIC)来缩小我们的选择范围。之后，我们将讨论Box-Jenkins方法，该方法将帮助您从原始时间序列转换为可用于生产的模型。然后我们将讨论如何将此应用于季节性时间序列。</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h1 id="63a6" class="mz na it bd nb nc ow ne nf ng ox ni nj jz oy ka nl kc oz kd nn kf pa kg np nq bi translated">3.参考</h1><p id="6b06" class="pw-post-body-paragraph ki kj it kk b kl nr ju kn ko ns jx kq kr nt kt ku kv nu kx ky kz nv lb lc ld im bi translated">[1].<a class="ae lw" href="https://app.datacamp.com/learn/courses/arima-models-in-python" rel="noopener ugc nofollow" target="_blank">https://app . data camp . com/learn/courses/ARIMA-models-in-python</a></p><p id="9dfa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2].https://www . stats models . org/devel/generated/stats models . TSA . ARIMA . model . ARIMA . html</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><div class="md me mf mg gt oh"><a href="https://youssefraafat57.medium.com/membership" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">加入我的介绍链接媒体-优素福胡斯尼</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">阅读Youssef Hosni(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">youssefraafat57.medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov mm oh"/></div></div></a></div><p id="99a4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mv">感谢阅读！如果你喜欢这篇文章，一定要鼓掌(高达50！)并在</em> <a class="ae lw" href="https://www.linkedin.com/in/youssef-hosni-b2960b135/" rel="noopener ugc nofollow" target="_blank"> <em class="mv"> LinkedIn </em> </a> <em class="mv">上与我联系，并在</em><a class="ae lw" href="https://youssefraafat57.medium.com/" rel="noopener"><em class="mv">Medium</em></a><em class="mv">上关注我的新文章</em></p></div></div>    
</body>
</html>