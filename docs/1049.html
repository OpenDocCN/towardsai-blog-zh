<html>
<head>
<title>Introduction to Bayesian Inference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贝叶斯推理简介</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/bayesian-inference-beyond-estimating-statistical-models-4b2f78c7f090?source=collection_archive---------1-----------------------#2020-10-15">https://pub.towardsai.net/bayesian-inference-beyond-estimating-statistical-models-4b2f78c7f090?source=collection_archive---------1-----------------------#2020-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7f13" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>、<a class="ae ep" href="https://towardsai.net/p/category/probability" rel="noopener ugc nofollow" target="_blank">概率</a>、<a class="ae ep" href="https://towardsai.net/p/category/statistics" rel="noopener ugc nofollow" target="_blank">统计</a></h2><div class=""/><div class=""><h2 id="3c2b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">第7部分:超越线性模型和广义线性模型</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/fa102d7eb07622eb0244d2935ee11c5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fFjdlG4x3kU0ZPxNmMLrgw.png"/></div></div></figure><h1 id="a151" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">介绍</h1><p id="0a01" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">让我们把模型的世界分成两种类型:统计的和科学的。这两类模型都旨在理解目标变量(即y)和一组特征(即<strong class="lx jd"> x. </strong>)之间的关系。前者旨在基于数据找到统计上合理的关系，而后者具有能够描述因果关系的特性。</p><p id="5024" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">本系列中的所有示例都使用了统计模型(例如GLMs)来说明贝叶斯推理中的一个概念。然而，贝叶斯推理同样适用于建立科学模型。</p><p id="0629" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">本文将展示如何结合贝叶斯推理来构建科学模型，以及这样做的好处。</p><p id="cd60" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">本文内容基于[1]中的第16章。</p><p id="cee3" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">在这个<a class="ae mw" href="https://github.com/hsm207/statrethinking-julia/blob/master/book/16_Madness/fit_scientific_model.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>中可以找到重现本文中描述的结果的代码。</p><h1 id="d64a" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">问题</h1><p id="8420" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">为了保持数学简单，让我们假设我们想要建立一个模型来预测给定身高的人的体重。</p><h1 id="15d3" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">资料组</h1><p id="222f" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">我们将使用Howell1数据集中记录的身高和体重值，您可以在这里找到<a class="ae mw" href="https://github.com/rmcelreath/rethinking/blob/3b48ec8dfda4840b9dce096d0cb9406589ef7923/data/Howell1.csv#L1" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="2d7f" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">数据看起来是这样的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c2c1bafe51f95b97a09b68d417f70e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*dGyE97WTQl-QZZmz85CBgw.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">图Howell1数据集</figcaption></figure><h1 id="6939" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">建模</h1><h2 id="48a7" class="nc le it bd lf nd ne dn lj nf ng dp ln me nh ni lp mi nj nk lr mm nl nm lt iz bi translated">统计模型</h2><p id="8b94" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">如果我们假设体重和身高之间存在线性关系，则模型看起来是这样的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f7038ace1fc9f700b8a2af9ce514e447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*BYwvs5w_-OGlYu1ia4gSIA.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">图2:线性模型的平均预测</figcaption></figure><p id="4cf4" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">当然，仅根据图1，我们不应该期望简单的线性回归是一个很好的拟合。事实上，它预测一些身高值的负体重也是愚蠢的。</p><p id="d478" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">数据有一条曲线，所以我们可以做一个转换，比如添加一个二次项来获得更好的拟合。但是让我们用一个对数变换。</p><p id="48b7" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">具体来说，让我们假设:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi no"><img src="../Images/77be29daccd0eb20f0348eb87476f8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*b1kJSOZD9bmnDiKaesXWNg.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">图3:假设体重的对数是身高的线性函数</figcaption></figure><p id="5b9f" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">请注意，α和β是我们需要指定先验分布的模型参数。但由于他们有一个大的数据集，获得正确的先验以获得良好的拟合并不太重要。</p><p id="4c3c" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">这是结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi np"><img src="../Images/745b6cebd44915b377f9baa4b6592e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*fLiwbIu6UciG6Nnuo-yuug.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">图4:给定图3中的假设，模型的平均预测</figcaption></figure><p id="8958" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">现在合身多了。</p><h2 id="5c5c" class="nc le it bd lf nd ne dn lj nf ng dp ln me nh ni lp mi nj nk lr mm nl nm lt iz bi translated">科学模型</h2><p id="0d34" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">身高怎么会是体重的原因？</p><p id="2f97" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">好吧，让我们从简单的开始，看看我们能走多远。</p><p id="cbff" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">假设人体形状可以近似为一个圆柱体，那么高度h和体积V之间的关系为:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/11cb12e9b2d759ac8924e316289d379f.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*hAa0_Th7RRlfKMOSR_XVGA.png"/></div></figure><p id="f56a" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">r是圆柱体的半径。假设它是高度的一部分是合理的，所以r = ph。因此，我们得到:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/00443ccd3d62f8eb9dba50df648cfe31.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*taOxXZnQxjTCi2828JvmcA.png"/></div></figure><p id="2e78" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">密度k是重量W和体积V的函数，即k = W/V [2]，由此得出:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/291bcab1515bc86fdadf9a7351549582.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*jRqKvd5Q-ZyfkGE3wdUMpQ.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">图5:人类身高和体重之间关系的近似模型</figcaption></figure><p id="5b3d" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">由于W以千克为单位，h以厘米为单位，所以k的单位是千克/厘米。</p><p id="ef4a" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">图5中的模型只有两个参数，k，人体的密度(kg/cm ),以及人体的半径(其宽度的一半)与高度的比值p。</p><p id="7c5b" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">图5中的模型当然不是线性或广义线性模型，但是使用贝叶斯推理将其拟合到数据遵循完全相同的过程，即:</p><ol class=""><li id="c8f3" class="nt nu it lx b ly mr mb ms me nv mi nw mm nx mq ny nz oa ob bi translated">定义模型参数的先验分布</li><li id="3518" class="nt nu it lx b ly oc mb od me oe mi of mm og mq ny nz oa ob bi translated">定义后验分布(在给定数据的情况下观察参数的概率)</li><li id="30a1" class="nt nu it lx b ly oc mb od me oe mi of mm og mq ny nz oa ob bi translated">对参数进行推断</li></ol><p id="23d7" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">有关这些步骤如何工作的演练，请参考[3]。</p><p id="eae9" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">[3]使用网格近似作为算法在步骤3中进行推断。这对于简单的模型很有效。</p><p id="5493" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">对于这个例子，我们将使用MCMC作为推理算法。具体来说，我们将使用Turing.jl。有关代码，请参考随附的笔记本。</p><p id="a187" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">那么，我们该如何设定k和p的先验呢？</p><p id="4725" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">对于p，我们知道它是一个比值，所以它肯定在0和1之间。此外，它必须小于0.5(设h = 2r，代入r = ph)，因为我们知道人类不能拥有相等的高度和宽度。因此，平均值约为0.1-0.2的贝塔分布似乎是合理的。</p><p id="638c" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">对k来说，就是查一个人体的密度，知道一定是正数。根据维基百科的说法，似乎一个人的密度大约是2克/毫升，所以用这个平均值给它分配一个指数分布似乎是合理的。</p><p id="30ba" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">当然，在实践中，我们应该检查这些先验给出的预测的分布，以验证它们的合理性，但这不是本文的重点，所以我们将跳过这一步。</p><p id="6750" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">图5给出了以下结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mx"><img src="../Images/90d0ad16d5b2da016ff6635b465ce934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*yTMbYPFdLLBDGvoUxFpQOA.png"/></div></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">图6:图5中模型的平均预测</figcaption></figure><p id="7a52" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">这很合适，但是图4中的模型看起来更好。</p><h1 id="36ea" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">科学与统计模型</h1><p id="59fd" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">让我们比较一下图4(统计模型)和图6(科学模型)中的模型。</p><p id="11e0" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">图4给出了一个更好的拟合，但是哪个更容易解释呢？我们可以说身高1厘米的变化会导致体重对数的β变化，但这听起来有些尴尬。此外，我们如何理解截距α？在0厘米的高度谈论体重是没有意义的。</p><p id="537a" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">相比之下，图6中模型的参数对应于我们在物理世界中可以观察到的量。除了可解释之外，它让我们很容易得出合理的先验。</p><p id="075b" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">科学模型的另一个有用的特性是，它的误差可以洞察数据，并指导建立更好的模型。例如，有趣的是，当身高小于70厘米时，该模型系统地低估了体重。这可能是该组中的人具有不同生理机能并需要不同模型参数来正确建模的标志。</p><h1 id="21b0" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">其他示例</h1><p id="1dd8" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">[1]讨论了其他三个例子，在这些例子中，科学模型相对于统计模型给出了更丰富的结果。</p><p id="c3c6" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">在我看来，最有趣的例子是将人口动态视为一个时间序列问题，并使用自回归模型预测其演变，而不是使用Lotka-Volterra模型。</p><p id="bbce" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">对我来说，关键的一点是，尽管科学模型经常做出简化的假设，但它们足以概括我们试图理解的现象的复杂性。对于这些情况，可解释性的收益可能超过拟合度的损失。</p><p id="ba2d" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">当然，如果我们只关心预测性能，那么全押在统计模型上是一种有效的方法。</p><h1 id="e428" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">结论</h1><p id="ab7a" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">本文展示了如何使用贝叶斯推理来估计科学模型，即编码因果关系的模型。它也触及了科学模型相对于统计模型的优点。</p><p id="3c76" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">我希望这对你有用。</p><h1 id="bc48" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">参考</h1><p id="7537" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">[1]统计学再思考:贝叶斯课程与实例，R和Stan，第2版。麦克尔瑞斯。2020</p><p id="bb40" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">[2] <a class="ae mw" href="https://aboutbuildingengineering.blogspot.com/2012/09/weightvolume-relationships.html" rel="noopener ugc nofollow" target="_blank">重量-体积关系</a>。土木和建筑工程。最后访问时间是2020年10月14日。</p><p id="f39f" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">[3] <a class="ae mw" href="https://medium.com/towards-artificial-intelligence/bayesian-inference-how-grid-approximation-works-e2c79a516c49" rel="noopener">贝叶斯推理介绍第1部分:网格逼近如何工作</a>。___.2020</p></div></div>    
</body>
</html>