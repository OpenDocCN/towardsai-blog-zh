<html>
<head>
<title>Split Your Dataset With scikit-learn’s train_test_split()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用scikit-learn的train_test_split()拆分数据集</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/split-your-dataset-with-scikit-learns-train-test-split-b666285e5e23?source=collection_archive---------4-----------------------#2021-11-22">https://pub.towardsai.net/split-your-dataset-with-scikit-learns-train-test-split-b666285e5e23?source=collection_archive---------4-----------------------#2021-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7112" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/6650fe7268bc9114f161252f9ecf024c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pcM5EKgpINOUDDxU"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">由<a class="ae kl" href="https://unsplash.com/@isaacmsmith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾萨克·史密斯</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d691" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">模型评估和验证是监督机器学习的重要组成部分。它有助于选择最佳模型来表示我们的数据，以及预测该模型在未来的表现如何。</p><p id="72b1" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了预测这个模型，我们需要将这个模型数据集分成训练和测试数据。手动拆分这些数据非常困难，因为数据集的大小很大，并且需要对数据进行混洗。</p><p id="451e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了使这项任务更容易，我们将使用Scikit-learn的train_test_split()模块，该模块将我们的数据分成训练集和测试集。</p><h1 id="0579" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">Scikit-Learn的安装</h1><figure class="mj mk ml mm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi mi"><img src="../Images/11c0ee47cc72a713eaed9aa167c0b6a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nOzSiMQceaMhWyuo"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">沃洛季米尔·赫里先科在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="970e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">安装Scikit-使用pip学习:</strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="1015" class="ms ll iq mo b gy mt mu l mv mw">$ pip install -U scikit-learn</span></pre><p id="cb35" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">安装sci kit-使用conda学习:</strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="59d2" class="ms ll iq mo b gy mt mu l mv mw">$ conda install -c anaconda scikit-learn=0.24</span></pre><h1 id="2f39" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">正在导入库—</h1><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="f49e" class="ms ll iq mo b gy mt mu l mv mw">&gt;&gt;&gt; from <strong class="mo ja">sklearn.model_selection</strong> import <strong class="mo ja">train_test_split</strong></span></pre><h1 id="d93d" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">开始——</h1><figure class="mj mk ml mm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi mx"><img src="../Images/3866687616f665f1f15c139d6fe15659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_v7Ce0hghRm9VlHL"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">照片由<a class="ae kl" href="https://unsplash.com/@dtopkin1?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">戴恩·托普金</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="1d5b" class="ms ll iq bd lm my mz dn lq na nb dp lu kx nc nd ly lb ne nf mc lf ng nh mg iw bi translated">语法-</h2><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="9da2" class="ms ll iq mo b gy mt mu l mv mw"><em class="ni">train_test_split(*arrays, test_size=None, train_size=None, random_state=None, shuffle=True, stratify=None)</em></span></pre><h2 id="b1c2" class="ms ll iq bd lm my mz dn lq na nb dp lu kx nc nd ly lb ne nf mc lf ng nh mg iw bi translated"><strong class="ak">参数- </strong></h2><figure class="mj mk ml mm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/7fa11adff549abf556cfc5ad6e0e445b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d0gwk9yD50fwd9lN"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">Artem Sapegin 在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="8578" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">数组</strong>——你想要分割的数据保存在一系列列表、NumPy数组、pandas数据帧或其他类似数组的对象中，这些对象称为数组。数据集由所有这些对象组成，它们的长度必须相同。</p><p id="6288" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja"> train_size - </strong>训练数据集的大小由该选项决定。无，这是默认值。需要精确样本数的Int和从0.1到1.0的float是三种选择。</p><p id="9c25" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja"> test_size - </strong>该参数指定测试数据集的大小。如果训练尺寸被设置为默认值，则<strong class="ko ja">测试尺寸</strong>将被设置为<strong class="ko ja"> 0.25 </strong>。</p><p id="4ad7" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja"> random_state - </strong>该参数使用<code class="fe nj nk nl mo b">np.random</code>或int指定数据的随机分割。</p><p id="f8b5" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja"> shuffle - </strong> Shuffle有布尔值(<em class="ni">默认=真</em>)。这决定了数据是否应该被打乱。</p><p id="6b52" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">分层- </strong>是一个类似数组的对象(<em class="ni">默认=无</em>)。如果分层不是任何，那么它确定如何使用分层数据分割。</p><p id="78bb" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在是时候测试您的数据分割技能了！首先，您需要创建一个简单的数据集来使用。输入将位于二维数组<strong class="ko ja"> X </strong>中，而输出将位于数据集中的一维数组<strong class="ko ja"> y </strong>中。</p><figure class="mj mk ml mm gt ka"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3819" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们使用NumPy库来生成数据集。arange()将返回指定间隔内的等间距值。shape()将改变数组的形状而不改变其数据。</p><div class="no np gp gr nq nr"><a href="https://medium.com/@yashpnagare/a-complete-guide-on-numpy-for-machine-learning-fd4ec1f168b7" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ja gy z fp nw fr fs nx fu fw iz bi translated">机器学习的NumPy完全指南</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">什么是NumPy？如何安装NumPy？Numpy线性代数</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kf nr"/></div></div></a></div><p id="b5bf" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">通过一次函数调用，您可以分割输入和输出数据集。</p><figure class="mj mk ml mm gt ka"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="10a0" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">train_test_split()执行数据拆分，并按以下顺序返回NumPy数组的四个序列:</p><ol class=""><li id="b217" class="og oh iq ko b kp kq kt ku kx oi lb oj lf ok lj ol om on oo bi translated">X _ train-X序列的训练部分</li><li id="7fb6" class="og oh iq ko b kp op kt oq kx or lb os lf ot lj ol om on oo bi translated">y _ train-y序列的训练部分</li><li id="82bb" class="og oh iq ko b kp op kt oq kx or lb os lf ot lj ol om on oo bi translated">X _ test-X序列的测试部分</li><li id="52c0" class="og oh iq ko b kp op kt oq kx or lb os lf ot lj ol om on oo bi translated">y _ test-y序列的测试部分</li></ol><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="05de" class="ms ll iq mo b gy mt mu l mv mw"><strong class="mo ja">&gt;&gt;&gt;</strong> train_test_split(y, shuffle=True)<br/>[[4, 0, 6, 2, 5, 9, 3], [1, 7, 8]]<br/><strong class="mo ja">&gt;&gt;&gt;</strong></span></pre><p id="e201" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">数据集的样本被随机打乱，然后将数据分成训练集和测试集。</p><figure class="mj mk ml mm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ou"><img src="../Images/13685c859ec54fb541be86ed76de6755.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1A_U8JQMqytRGHVY"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">照片由<a class="ae kl" href="https://unsplash.com/@alx_andru?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alex </a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><h1 id="28df" class="lk ll iq bd lm ln pc lp lq lr pd lt lu lv pe lx ly lz pf mb mc md pg mf mg mh bi translated">结论</h1><p id="744a" class="pw-post-body-paragraph km kn iq ko b kp ph kr ks kt pi kv kw kx pj kz la lb pk ld le lf pl lh li lj ij bi translated">现在您已经了解了为什么以及如何使用sklearn的train_test_split()函数以及其中使用的各种参数。现在，您可以使用您的数据来训练、验证和测试任意数量的机器学习模型。</p><h1 id="4610" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">在你走之前</h1><p id="0f1f" class="pw-post-body-paragraph km kn iq ko b kp ph kr ks kt pi kv kw kx pj kz la lb pk ld le lf pl lh li lj ij bi translated">我欢迎你加入我的旅程！关注此<a class="ae kl" href="https://medium.com/@yashpnagare" rel="noopener">媒体</a>页面，了解更多令人兴奋的数据科学/Python内容。</p></div></div>    
</body>
</html>