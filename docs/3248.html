<html>
<head>
<title>Logistic Regression with BigQuery ML in 6 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">6步使用BigQuery ML进行逻辑回归</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/logistic-regression-with-bigquery-ml-in-6-steps-7a8ce7700ee8?source=collection_archive---------2-----------------------#2022-10-24">https://pub.towardsai.net/logistic-regression-with-bigquery-ml-in-6-steps-7a8ce7700ee8?source=collection_archive---------2-----------------------#2022-10-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="74d5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用BigQuery ML通过SQL构建逻辑回归模型的分步指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/16999824653e03198caecf7015efd62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1oIChZwUQohSLO_rTO7wQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.freepik.com/free-photo/nexus-bring-communicate-cloud-your-google_1235355.htm#query=google%20cloud&amp;position=11&amp;from_view=search&amp;track=sph" rel="noopener ugc nofollow" target="_blank">图片由Freepik拍摄</a></figcaption></figure><h1 id="4352" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="06e3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">逻辑回归模型是一种用于预测结果概率的统计模型。逻辑回归，尽管它的名字，是一个分类模型，而不是回归模型。结果通常是二进制的，这意味着它只能是两个可能值中的一个，如是或否。但是逻辑回归也可以很容易地扩展到两个以上的类(多项式回归)。</p><p id="9880" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以下是逻辑回归模型的一些优点:</p><ul class=""><li id="4bf3" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">逻辑回归很容易解释</li><li id="f563" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">它可以被正则化以避免过度拟合</li><li id="5847" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">模型系数可以被解释为特征重要性的指标。</li></ul><p id="4958" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本教程中，您将学习BigQuery ML中的二元逻辑回归模型，以预测从<a class="ae kv" href="https://data.cityofchicago.org/Transportation/Taxi-Trips/wrvz-psew" rel="noopener ugc nofollow" target="_blank">芝加哥出租车出行数据集</a>中的客户处获得小费。该数据集包括从2013年到现在的出租车出行，报告给作为监管机构的芝加哥市。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/e6983db8b494f07f3b620b39c52a6ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Zexaf0imdUSPOF-6yEIFw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://data.cityofchicago.org/Transportation/Taxi-Trips/wrvz-psew" rel="noopener ugc nofollow" target="_blank">芝加哥出租车旅行</a></figcaption></figure><p id="2269" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以下是我们将在本帖中介绍的内容:</p><ul class=""><li id="0ebc" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">什么是BigQuery？</li><li id="99e7" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">什么是BigQuery ML？</li><li id="9e85" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">创建数据集</li><li id="86a8" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">了解数据集</li><li id="a373" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">建立逻辑回归模型</li><li id="f142" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">评估逻辑回归模型</li><li id="9df8" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">使用逻辑回归模型进行预测</li></ul><p id="fb6b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们开始吧！</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="d9d3" class="kw kx iq bd ky kz nl lb lc ld nm lf lg jw nn jx li jz no ka lk kc np kd lm ln bi translated">什么是BigQuery？</h1><p id="d725" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://cloud.google.com/bigquery/docs/introduction" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> BigQuery </strong> </a>是一个完全托管的无服务器数据仓库，允许您使用内置功能(如机器学习、地理空间分析和商业智能)来管理和分析您的数据。使用BigQuery可以在几秒钟内查询TB，在几分钟内查询Pb。</p><p id="52d3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您可以在Google云控制台界面和BigQuery命令行工具中访问BigQuery。您还可以使用<a class="ae kv" href="https://github.com/googleapis/python-bigquery" rel="noopener ugc nofollow" target="_blank"> Python </a>、Java、JavaScript和Go中的客户端库以及BigQuery的REST API和RPC API来处理BigQuery，以转换和管理数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/9bc9a98a1fc74c42131211e75fb87e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEX3Pb0IBnOsnvl_vj5bZg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">大查询页面</figcaption></figure><h1 id="6841" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是BigQuery ML？</h1><p id="9db8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您可以使用BigQuery来查询大数据，也可以使用标准SQL查询来构建机器学习模型。BigQuery ML允许您发现、实现和管理数据工具，以做出关键的业务决策。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/5c8b499494bb634161b036eea6f4b4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1iVd2IfvsTY-dncK1SSmuA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://cloud.google.com/static/bigquery-ml/images/ml-model-cheatsheet.pdf" rel="noopener ugc nofollow" target="_blank"> BigQuery Cheatsheet </a></figcaption></figure><p id="fc9f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如你所知，在大数据集上建立机器学习模型需要大量的编程和ML框架知识，如TensorFlow和PyTorch。BigQuery ML帮助SQL从业者使用现有的SQL工具和技能建立和评估机器学习模型。</p><p id="d88d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以下是BigQuery ML的一些优点:</p><ul class=""><li id="bb5b" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">BigQuery ML民主化了机器学习的使用，你只需要懂SQL。</li><li id="bdd8" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">它提供了各种可以开箱即用的预构建模型。</li><li id="98d0" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">不用从数据仓库导出数据，就可以快速建立机器学习模型。</li><li id="a36b" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">它易于使用，可以集成到现有的工作流程中。</li><li id="eda8" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">它具有成本效益，可用于在现收现付的基础上训练模型。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/9fdc3283e24c8c1b728d25fbbeb20657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKKwQzjCtfIglWwt-MMSIw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://medium.com/google-cloud/how-to-integrate-external-data-sources-with-bigquery-9e126d5751ea" rel="noopener">数据处理管道</a></figcaption></figure><h1 id="be77" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">BigQuery定价</h1><p id="4528" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Bigquery不是免费的，它向你收取数据存储和运行查询的费用。但是作为<a class="ae kv" href="https://cloud.google.com/free" rel="noopener ugc nofollow" target="_blank">谷歌云免费层</a>的一部分，BigQuery免费提供一些特定限制的资源。这些免费使用限制在免费试用期期间和之后可用。有关免费使用层的更多信息，您可以查看<a class="ae kv" href="https://cloud.google.com/bigquery/pricing#free-tier" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="7e49" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">用6步BigQuery进行逻辑回归分析</h1><p id="bea8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在开始之前，您需要创建一个Google Cloud项目，或者在Google Cloud控制台中选择一个项目。<em class="ns">请记住，完成项目后，您可以删除该项目，删除与该项目相关的所有资源。</em></p><h2 id="b8f1" class="nt kx iq bd ky nu nv dn lc nw nx dp lg lx ny nz li mb oa ob lk mf oc od lm oe bi translated">第一步。创建数据集</h2><p id="3185" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在建立机器学习模型之前，您需要创建一个数据集。为此，我们先转到bigquery页面。之后，点击项目名称旁边的三个点，然后按<em class="ns">创建数据集</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/26ea011d8bdb1359665d33cd82df745f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJ--gl1n2Y-tb1f7NkCt4g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建数据集</figcaption></figure><p id="0d62" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在<strong class="lq ir">创建数据集</strong>页面上，输入一个名称，比如说<em class="ns"> chicago_taxi，</em>保留所有其他选项的默认值，然后单击创建数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/4b47392d0b42677ab83073e59fd13639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-BQ6Pge4wh9q9FGXAufjw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建名为chicago_taxi的数据集</figcaption></figure><h2 id="4e99" class="nt kx iq bd ky nu nv dn lc nw nx dp lg lx ny nz li mb oa ob lk mf oc od lm oe bi translated">第二步。探索数据集</h2><p id="b94c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我要用的数据集是<strong class="lq ir">芝加哥_出租车_行程</strong>数据集<strong class="lq ir">。</strong>该数据集存在于托管所有bigquery公共数据集的<strong class="lq ir">big query-public-data</strong>GCP项目中。让我们来看看这个数据集。打开<strong class="lq ir">big query-public-data</strong>GCP项目，找到<strong class="lq ir"> chicago_taxi_trips </strong>数据集。之后，单击taxi_trips表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/6ad1a3752fdf433e3b294dad1a92388a.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*ApBOEgfkto4m3yrY4giRZg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">芝加哥出租车旅行</figcaption></figure><p id="5e29" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">将打开一个新窗口，显示关于数据集的信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/37d2affefa0a47550e78c8fac08bedff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*We-BAIA2X4nVSrLOy-WQWQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">taxi_trips表模式</figcaption></figure><p id="ce48" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在方案选项卡中，citibike_trips表的结构显示了可用作标注和要素的所有字段。</p><p id="4d26" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您还可以通过按PREVIEW选项卡来查看数据集的行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/b184c98bca0779f1cad5799f7f2036c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRCm2PlbkBjWhf5pqXZHmw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">数据集的预览</figcaption></figure><p id="fb9c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，为了理解数据集，让我们看一下taxi_trips表中的前十行:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/b916affec0845d5e67b990d89de501b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKDKVdYX4guugMLsg9_z2A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">显示数据集前十行的查询</figcaption></figure><p id="0358" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">注意，我使用了<code class="fe oj ok ol om b">LIMIT 10</code>子句来限制结果集中的记录数量。运行该查询后，您将看到如下屏幕截图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/0cfb968454cdb92f966384e8d715c897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Yd9EIj2hTaaJYrOPcG4bQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">数据集的前几行</figcaption></figure><p id="e4ed" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在让我们来看看<strong class="lq ir"> trip_start_timestamp </strong>字段的最小值和最大值:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/0e9b0b2fe1fa363ecdd8acc5ae243379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MajVGIA9Ep9SiZEYX8r95Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">显示<strong class="bd ky"> trip_start_timestamp </strong>字段的最小值和最大值的查询</figcaption></figure><p id="583b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">运行该查询后，您将看到如下屏幕截图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/5691e5541e5bba7f2f881c279f0f5d77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XPkPjqPY6XnagAmHGiAFw.png"/></div></div></figure><p id="63eb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如你所见，这个数据集包括了从2013年到现在的出租车出行。现在，让我们来看看提示栏中缺少的数据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/48239876b342b8c6ca57635276ee9109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u1snNJKbVa3_qowpLjixsw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">在提示列中显示缺失数据的查询</figcaption></figure><p id="ed71" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">运行该查询后，您将看到如下屏幕截图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/96d4bb2b875687a3faed854be0091f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9CbaS7wrdyVZS4qdeWayA.png"/></div></div></figure><p id="ccd7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如您所见，tips列有7，378个缺失数据。在建立机器学习模型之前，我们将处理这些值。</p><p id="5a68" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，让我们将数据集分成三个不同的集合:训练、评估和分类。</p><h2 id="debb" class="nt kx iq bd ky nu nv dn lc nw nx dp lg lx ny nz li mb oa ob lk mf oc od lm oe bi translated">第三步。创建表</h2><p id="87fe" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在训练模型之前，数据集在机器学习项目中被分成三组。这些是训练集、验证集和测试集。模型是用定型集构建的，模型是用验证集评估的，测试集中的值是用模型预测的。</p><p id="1135" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们首先创建培训表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/37e8e7ecfd2bf8bfca58474741ace34f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UxdYO1_p5UhD1NMlL1stjQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建培训表</figcaption></figure><p id="8e54" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我关注的是2018年的前7个月。我将分别用第八个月和第九个月做评估和测试表。运行此查询时，将创建培训表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/dbc2214f051e665e67bdecf1ba1d5f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTAV8vtvOBvkqfnKl-dbbA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">训练台</figcaption></figure><p id="2ab0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，让我们用下面的查询创建评估表。请注意，我将只更改表的名称和日期。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/907d3316fd6e1600f0d8017a4d3ac9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVCVOGsrje2TkChfj6noxw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建评估表</figcaption></figure><p id="c6dc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在让我们创建测试表。这次我要定第九个月。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/d191524b954fcd2e0e3bbb488912bc05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOky7XIu_Ex_dQutOTChWg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建测试表</figcaption></figure><p id="f2dc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">厉害！我们创造了桌子。现在，我们可以使用训练表建立逻辑回归模型。</p><h2 id="5a95" class="nt kx iq bd ky nu nv dn lc nw nx dp lg lx ny nz li mb oa ob lk mf oc od lm oe bi translated">第四步。构建模型</h2><p id="f3bd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您可以使用带有选项<code class="fe oj ok ol om b">'LOGISTIC_REG'</code>的<code class="fe oj ok ol om b">CREATE MODEL</code>语句来创建和训练逻辑回归模型。让我们使用下面的查询建立一个逻辑回归模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/477fb3af7193b0e5420957ae539421fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8t_zT6--Hrlvr6BM0kqsg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">构建模型</figcaption></figure><p id="fbde" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这里，我创建了<em class="ns"> will_get_tip </em>数据。此数据指的是小费是否收到。如果小费大于零，它将被编码为1，否则为零。我将这个数据设置为label。运行此查询时，您可以在导航面板中看到您的模型。如果您点击<em class="ns"> tips_model </em>，您可以看到如下模型指标:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/27707bf390ca895dba33769409975dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwV6i9s6a-bxePFEHhJdxw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">模型度量</figcaption></figure><p id="884d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">很好。模型指标，如精确度、召回率和准确度，非常高，接近最大值1。模型的性能看起来不错。现在，让我们使用评估表来评估模型。</p><h2 id="2696" class="nt kx iq bd ky nu nv dn lc nw nx dp lg lx ny nz li mb oa ob lk mf oc od lm oe bi translated">第五步。评估模型</h2><p id="ecdb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">构建模型后，您可以使用<code class="fe oj ok ol om b">ML.EVALUATE</code>函数评估模型的性能。<code class="fe oj ok ol om b">ML.EVALUATE</code>函数根据实际数据评估预测值。</p><p id="4b62" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">评估模型的查询如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/c2f4fdb61489deb942117db44c4c7221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFplSImZmj2BU_ljH3vGog.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">模型评估</figcaption></figure><p id="6847" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">运行此查询时，您会看到以下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/4341eee9f0f8166e552a871de38e3377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6tIUx_Q4U2pTKRBt_pj0w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">评估集上的模型度量</figcaption></figure><p id="296b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如您所见，模型指标非常高，接近最大值1。现在，让我们看看如何预测测试集。</p><h2 id="3f5b" class="nt kx iq bd ky nu nv dn lc nw nx dp lg lx ny nz li mb oa ob lk mf oc od lm oe bi translated">第六步。使用模型预测测试集</h2><p id="4630" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">评估模型后，下一步是用它来预测结果。让我们使用测试表中的数据来预测标签:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/794ec60d51691e323d4bceaa20fd5ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_kya3jUNlUZ1p2V5vOkJA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">预测测试集。</figcaption></figure><p id="490d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里，我在提取<strong class="lq ir"> will_get_tip </strong>字段的实际值和预测值的<code class="fe oj ok ol om b">SELECT</code>语句中设置了三列，<em class="ns">predicted _ will _ get _ tip _ tip</em>、<em class="ns">predicted _ will _ get _ tip _ probs</em>和<em class="ns"> will_get_trip </em>。当您运行此查询时，您将获得以下结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/f6d574eaec5cbd3153ef5e569bb459ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*HVW51oWYtbU2Jcm4YWSw-w.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">模型预测</figcaption></figure><p id="dc79" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在该表中，第一列包含预测标签，第二和第三列分别包含预测标签和这些标签的概率，最后一列包含实际标签。请注意，我们的模型预测几乎完美。</p><h1 id="6ba6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">打扫</h1><p id="a932" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了避免您的Google Cloud帐户因本教程中使用的资源而产生费用，您可以删除您创建的项目，或者保存项目并删除数据集。</p><h1 id="4dac" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="e411" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">逻辑回归根据一组给定的独立变量预测一个事件发生的概率，如一个女人或一个男人。对于二元和线性分类任务，逻辑回归是一种简单且更有效的方法。在这篇文章中，我一步一步地展示了如何使用BigQuery ML执行逻辑回归分析。我们首先创建了一个逻辑回归模型，然后使用该模型来预测我们在构建模型时没有使用的数据。结果是，我们创建的模型的指标非常高，接近最大值1。</p><p id="43a9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">就是这样。感谢阅读。我希望你喜欢它。别忘了关注我们的<a class="ae kv" href="https://jovian.ai/outlink?url=http%3A%2F%2Fyoutube.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae kv" href="https://instagram.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">insta gram</a>|<a class="ae kv" href="https://jovian.ai/outlink?url=http%3A%2F%2Ftwitter.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kv" href="https://jovian.ai/outlink?url=https%3A%2F%2Fwww.linkedin.com%2Fin%2Ftirendaz-academy" rel="noopener ugc nofollow" target="_blank">Linkedin</a>|<a class="ae kv" href="https://jovian.ai/outlink?url=https%3A%2F%2Fwww.kaggle.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">ka ggle</a>了解更多关于数据科学和云计算的内容。</p><div class="pa pb gp gr pc pd"><a href="https://medium.com/geekculture/hands-on-regression-analysis-with-bigquery-7925dca179ff" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd ir gy z fp pi fr fs pj fu fw ip bi translated">使用BigQuery进行回归分析</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">如何使用BiqQuery执行线性回归分析的分步指南</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">medium.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr kp pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a href="https://levelup.gitconnected.com/data-manipulation-with-pyspark-in-10-steps-ac9d4a0f96f9" rel="noopener  ugc nofollow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd ir gy z fp pi fr fs pj fu fw ip bi translated">使用Pyspark在10个步骤中进行数据操作</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">我将逐步指导您如何使用PySpark对真实世界的数据进行数据操作。</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pm l"><div class="ps l po pp pq pm pr kp pd"/></div></div></a></div><p id="5db7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示支持👇</p></div></div>    
</body>
</html>