<html>
<head>
<title>Exploring Dataset With Data Visualization: Wine Classification Using PCA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用数据可视化探索数据集:利用主成分分析进行葡萄酒分类</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/exploring-dataset-with-data-visualization-wine-classification-using-pca-d133427183fb?source=collection_archive---------2-----------------------#2021-01-16">https://pub.towardsai.net/exploring-dataset-with-data-visualization-wine-classification-using-pca-d133427183fb?source=collection_archive---------2-----------------------#2021-01-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="8dca" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><div class=""><h2 id="747c" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">光看数据能看出我的数据有多好，我的模型能有多好吗？完整的代码可在我的回购<a class="ae kr" href="https://github.com/arditoibryan/Projects/tree/master/20200528_Wine_Classifier" rel="noopener ugc nofollow" target="_blank">。</a></h2></div><p id="264b" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">创建葡萄酒分类器是初学者在他们的第一个机器学习项目中提出的最简单的实验之一。在本教程中，我已经详细介绍了如何构建一个模型，如果您对该模型感兴趣，请随意研究它并使用我提供的代码进行实验。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/328b59f84e6323c23204e3268a65824c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AE0NwV6--FGERRJS"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">照片由<a class="ae kr" href="https://unsplash.com/@kathyli0928?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯西·李</a>在<a class="ae kr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="ad01" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">然而，本文将关注数据可视化。具体来说，我如何估计我可以从数据中使用ML建立一个模型有多好，如果必要的话，如果更灵活的推理功能可能需要深度学习。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/2e04f135b491a6ad10c4facae797093c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pqW9hN-yT1gCyjb984SGLg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">葡萄酒等级的3D表示</figcaption></figure><p id="b48a" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">上面，你可以看到最终的结果:让我来指导你如何用代码获得它。</p><h1 id="ff07" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">创建模型</h1><p id="918e" class="pw-post-body-paragraph ks kt it ku b kv mx kd kx ky my kg la lb mz ld le lf na lh li lj nb ll lm ln im bi translated">在文章的第一部分，我将创建一个分类模型。因为它将被证明是非常准确的，所以我将解释如何从一开始就理解和可视化数据，甚至在构建模型之前，就已经可以很好地估计模型的性能。</p><h2 id="89a7" class="nc mg it bd mh nd ne dn ml nf ng dp mp lb nh ni mr lf nj nk mt lj nl nm mv iz bi translated">导入数据集</h2><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="353c" class="nc mg it no b gy ns nt l nu nv">import pandas as pd</span><span id="f079" class="nc mg it no b gy nw nt l nu nv">#importing dataset<br/>X = pd.read_csv('/content/drive/My Drive/Colab Notebooks/Projects/20200528_Wine_Classifier/wine_data.csv')<br/>X</span></pre><h2 id="1ab7" class="nc mg it bd mh nd ne dn ml nf ng dp mp lb nh ni mr lf nj nk mt lj nl nm mv iz bi translated">分离特征和标签</h2><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="7a01" class="nc mg it no b gy ns nt l nu nv">y = X.pop('Wine')<br/>y</span><span id="5a89" class="nc mg it no b gy nw nt l nu nv">k = list(y).copy()<br/>k</span></pre><h2 id="8dd2" class="nc mg it bd mh nd ne dn ml nf ng dp mp lb nh ni mr lf nj nk mt lj nl nm mv iz bi translated">分割数据集</h2><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="b383" class="nc mg it no b gy ns nt l nu nv">import numpy as np<br/>from sklearn.model_selection import train_test_split</span><span id="71ba" class="nc mg it no b gy nw nt l nu nv">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)<br/>print(X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span></pre><h2 id="a8fe" class="nc mg it bd mh nd ne dn ml nf ng dp mp lb nh ni mr lf nj nk mt lj nl nm mv iz bi translated">训练模型</h2><p id="e9c4" class="pw-post-body-paragraph ks kt it ku b kv mx kd kx ky my kg la lb mz ld le lf na lh li lj nb ll lm ln im bi translated">该模型不需要任何调整，因为我可以使用一个简单的朴素贝叶斯分类器来执行分类。</p><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="024f" class="nc mg it no b gy ns nt l nu nv">#GaussianNB<br/>from sklearn.naive_bayes import GaussianNB</span><span id="d317" class="nc mg it no b gy nw nt l nu nv">clf = GaussianNB()<br/>clf = clf.fit(X_train, y_train)</span><span id="7d40" class="nc mg it no b gy nw nt l nu nv">y_predict = clf.predict(X_test)</span><span id="49c0" class="nc mg it no b gy nw nt l nu nv">from sklearn.metrics import accuracy_score<br/>print(accuracy_score(y_test, y_predict))</span></pre><p id="6e90" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">但是，我仍将使用另一种分类模型来查看结果如何变化:</p><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="7e62" class="nc mg it no b gy ns nt l nu nv">#RandomForestClassifier<br/>from sklearn.ensemble import RandomForestClassifier<br/>clf = RandomForestClassifier(n_estimators=10)<br/>clf = clf.fit(X_train, y_train)<br/>y_predict = clf.predict(X_test)<br/>from sklearn.metrics import accuracy_score<br/>print(accuracy_score(y_test, y_predict))</span><span id="8b2a" class="nc mg it no b gy nw nt l nu nv">#cross validation<br/>from sklearn.model_selection import cross_val_score</span><span id="c66c" class="nc mg it no b gy nw nt l nu nv">scores = cross_val_score(clf, X, y, cv=5)<br/>scores</span></pre><h2 id="fc69" class="nc mg it bd mh nd ne dn ml nf ng dp mp lb nh ni mr lf nj nk mt lj nl nm mv iz bi translated">主成分分析:可视化数据</h2><p id="a5e3" class="pw-post-body-paragraph ks kt it ku b kv mx kd kx ky my kg la lb mz ld le lf na lh li lj nb ll lm ln im bi translated">现在，我有几种方法可以将数据可视化。我最喜欢的工作之一是研究问题的多维性。通过首先缩放特征，然后降低维度，我可以在压缩的3D空间中绘制所有特征。</p><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="fae0" class="nc mg it no b gy ns nt l nu nv">from sklearn.preprocessing import MinMaxScaler</span><span id="0a5f" class="nc mg it no b gy nw nt l nu nv">scaler = MinMaxScaler()<br/>scaler.fit(X)</span><span id="7682" class="nc mg it no b gy nw nt l nu nv">X_ = pd.DataFrame(scaler.transform(X))<br/>X_.columns = X.columns<br/>X_</span><span id="7f85" class="nc mg it no b gy nw nt l nu nv">df = X_</span><span id="93af" class="nc mg it no b gy nw nt l nu nv">from sklearn.decomposition import PCA<br/>import matplotlib.pyplot as plt</span><span id="2e51" class="nc mg it no b gy nw nt l nu nv">pca = PCA(n_components=3)<br/>pca_result = pca.fit_transform(df)<br/>pca_result</span></pre><p id="d313" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">我现在将使用Plotly在3D空间中绘制结果。通过选择颜色参数，我将能够在图形中可视化不同的类别。</p><pre class="lp lq lr ls gt nn no np nq aw nr bi"><span id="de30" class="nc mg it no b gy ns nt l nu nv">y</span><span id="99ef" class="nc mg it no b gy nw nt l nu nv">import plotly.express as px<br/>fig = plt.figure(figsize=(14, 8))</span><span id="a490" class="nc mg it no b gy nw nt l nu nv">x = list(pca_result[:,0])<br/>y = list(pca_result[:,1])<br/>z = list(pca_result[:,2])</span><span id="e170" class="nc mg it no b gy nw nt l nu nv">fig = px.scatter_3d(df, x=x, y=y, z=z, text=k, color=k)<br/>fig.show()</span></pre><h2 id="f612" class="nc mg it bd mh nd ne dn ml nf ng dp mp lb nh ni mr lf nj nk mt lj nl nm mv iz bi translated">结论</h2><p id="a052" class="pw-post-body-paragraph ks kt it ku b kv mx kd kx ky my kg la lb mz ld le lf na lh li lj nb ll lm ln im bi translated">结果非常有趣:如您所见，数据集中的所有样本在一部分空间中很容易区分。通过使用分类模型，甚至可以说是线性模型，我们能够获得非常高的性能。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/2e04f135b491a6ad10c4facae797093c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pqW9hN-yT1gCyjb984SGLg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">葡萄酒等级的3D表示</figcaption></figure></div></div>    
</body>
</html>