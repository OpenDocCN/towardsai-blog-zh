<html>
<head>
<title>Predicting Health Insurance Charges with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测医疗保险费用</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/predicting-health-insurance-charges-with-machine-learning-313963dbb904?source=collection_archive---------0-----------------------#2022-01-28">https://pub.towardsai.net/predicting-health-insurance-charges-with-machine-learning-313963dbb904?source=collection_archive---------0-----------------------#2022-01-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3134" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="9057" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">“我强烈支持病人权利法案。决定应该由医生做出，而不是会计师。”</p><p id="ef2e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">查尔斯·舒默</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/ae5535cdec00dc892b1ad78e573bc4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCmdaKuNTVAs832UnSml9Q.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">照片由来自Pexels的Olya Kobruseva拍摄</figcaption></figure><p id="754e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">健康保险政策</strong></p><p id="2f03" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">当您拥有健康保险时，它会涵盖或最大限度地减少您为医疗保健服务支付的费用。多种因素会影响保险单的成本。其中包括以下内容:</p><p id="a11e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.年龄——老年人的保险费可能比年轻人高3倍。</p><p id="0091" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.地点——你居住的地方对你的保费有影响。竞争、州和地方规则以及生活成本的不同造成了差异。</p><p id="53e5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.烟草使用——保险公司可以向吸烟者收取比不吸烟者高50%的费用。</p><p id="1543" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.个人与家庭——保险公司可以对涵盖配偶和/或家属的计划收取更高的费用。</p><p id="6cb3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.计划类别-有五个计划类别，包括青铜级、白银级、黄金级、白金级和灾难级。这些类别基于您和计划分摊费用的方式。当您获得护理时，青铜计划通常每月保费较低，自付费用较高。白金计划通常保费最高，自付费用最低。</p><p id="666a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">根据凯泽家庭基金会的数据，2020年美国健康保险的年均成本为个人7470美元，家庭21342美元。</p><p id="4fa6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">健康保险索赔</strong></p><p id="34b0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">健康保险索赔是对被保险人已获得的医疗服务进行直接支付或补偿的请求。在被保险人或卫生保健提供者向他们的保险公司提交索赔后，获得健康保险福利或付款。</p><p id="6d35" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">Change Healthcare发现，2016年美国医院提交的医疗保险索赔高达3万亿美元。这些指控中有2620亿美元最初被否认。</p><p id="f9cc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">预测医疗费用</strong></p><p id="aa88" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确预测个人医疗保健费用的模型对保险公司、医疗保健提供者和保险单下的被保险人非常有益。准确的成本估算可以帮助医疗保险公司和医疗保健提供商规划未来，并优先分配医疗保健资源。此外，被保险人可以提前知道他们未来可能的费用，并可以帮助他们选择具有适当免赔额和保费的保险计划。</p><p id="9d1e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本文的目的是根据投保人的特征准确预测保险成本。此外，我们将确定影响保险成本的最重要的变量。健康保险公司可以使用这些估计值，根据预期的治疗费用来设定更高或更低的年度保费价格。</p><p id="5872" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">路线图</strong></p><p id="0e8d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">以下步骤将使用机器学习和Python来执行。</p><p id="d045" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.导入所需的软件库。</p><p id="f6e7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.加载并导入数据集。</p><p id="e266" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.数据分析和探索。</p><p id="f640" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.特征选择。</p><p id="8545" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.将数据分为训练数据集和测试数据集。</p><p id="ca1d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">6.将数据标准化。</p><p id="b264" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">7.根据训练数据训练模型。</p><p id="b843" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">8.根据测试数据进行预测。</p><p id="7ae5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">9.评估模型的性能。</p><p id="9268" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">10.从评估中得出结论。</p><p id="b5a3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">程序</strong></p><p id="a3ee" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">目的:根据投保人的特征预测医疗保险费用。</p><p id="e5ce" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">导入所需的软件库</strong></p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="4608" class="ls lt it lo b gy lu lv l lw lx"><strong class="lo jd">import</strong> pandas <strong class="lo jd">as</strong> pd<br/><strong class="lo jd">import</strong> numpy <strong class="lo jd">as</strong> np<br/><strong class="lo jd">import</strong> matplotlib.pyplot <strong class="lo jd">as</strong> plt<br/><strong class="lo jd">import</strong> seaborn <strong class="lo jd">as</strong> sns<br/><strong class="lo jd">from</strong> sklearn.preprocessing <strong class="lo jd">import</strong> StandardScaler<br/><strong class="lo jd">from</strong> sklearn.model_selection <strong class="lo jd">import</strong> train_test_split<br/><strong class="lo jd">from</strong> sklearn.linear_model <strong class="lo jd">import</strong> LinearRegression<br/><strong class="lo jd">from</strong> sklearn.ensemble <strong class="lo jd">import</strong> RandomForestRegressor<br/><strong class="lo jd">from</strong> sklearn.svm <strong class="lo jd">import</strong> SVR</span></pre><p id="1696" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">加载并导入数据集</strong></p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="693e" class="ls lt it lo b gy lu lv l lw lx"># Load the data on Google Colab <br/><strong class="lo jd">from</strong> google.colab <strong class="lo jd">import</strong> files  # Use to load data on Google Colab<em class="ly"> </em><br/>uploaded <strong class="lo jd">=</strong> files<strong class="lo jd">.</strong>upload()</span><span id="443b" class="ls lt it lo b gy lz lv l lw lx"># Import the data set into a dataframe.<br/>insurance <strong class="lo jd">=</strong> pd<strong class="lo jd">.</strong>read_csv('insurance.csv')</span></pre><p id="79c7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据分析和探索</strong></p><p id="ee4b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">打印数据框的前5行。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="aec9" class="ls lt it lo b gy lu lv l lw lx">insurance<strong class="lo jd">.</strong>head()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ma"><img src="../Images/7f3f1ba88ebf2b6847f1690907fa55a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKa4-IGsHEyLqz6I4SwFfg.png"/></div></div></figure><p id="e382" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">这个数据集是在Kaggle上找到的，可以通过这个<a class="ae mb" href="https://www.kaggle.com/mirichoi0218/insurance" rel="noopener ugc nofollow" target="_blank">链接</a>访问。数据集基于Miri Choi的医疗费用个人数据集。</p><p id="791a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下面描述了这些列和定义。</p><ol class=""><li id="1a80" class="mc md it kb b kc kd kg kh kk me ko mf ks mg kw mh mi mj mk bi translated">年龄—投保人的年龄。</li><li id="dc1a" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">性别—投保人的性别(女性、男性)。</li><li id="ce5d" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">BMI——身体质量指数，提供对身体的了解，体重相对于身高的高低，体重的客观指数(kg / m ^ 2 ),使用身高与体重的比率，理想值为18.5至25。</li><li id="3465" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">子女——投保人的子女/受抚养人人数。</li><li id="2aeb" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">吸烟者—投保人的吸烟状态(不吸烟者=否，吸烟者=是)。</li><li id="9dcb" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">地区—投保人在美国的居住区(东北、西北、东南和西南)。</li><li id="2816" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mh mi mj mk bi translated">费用—由健康保险支付的个人医疗费用(美元)。</li></ol><p id="0117" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示有关数据列的信息。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="9f87" class="ls lt it lo b gy lu lv l lw lx">insurance<strong class="lo jd">.</strong>info()</span><span id="b6fe" class="ls lt it lo b gy lz lv l lw lx">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 1338 entries, 0 to 1337<br/>Data columns (total 7 columns):<br/> #   Column    Non-Null Count  Dtype  <br/>---  ------    --------------  -----  <br/> 0   age       1338 non-null   int64  <br/> 1   sex       1338 non-null   object <br/> 2   bmi       1338 non-null   float64<br/> 3   children  1338 non-null   int64  <br/> 4   smoker    1338 non-null   object <br/> 5   region    1338 non-null   object <br/> 6   charges   1338 non-null   float64<br/>dtypes: float64(2), int64(2), object(3)<br/>memory usage: 73.3+ KB</span></pre><p id="673c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">总结:</p><ul class=""><li id="f15b" class="mc md it kb b kc kd kg kh kk me ko mf ks mg kw mq mi mj mk bi translated">有1338个保险记录，包含7个变量。</li><li id="8676" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">数据集没有任何空值或缺失值。</li><li id="08ce" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">有分类和数字数据类型。</li></ul><p id="0710" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示数据框的统计数据。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="9de1" class="ls lt it lo b gy lu lv l lw lx">insurance<strong class="lo jd">.</strong>describe()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mr"><img src="../Images/6df48e81b5eaa1b36370795920e6b08a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-W3uhd22xcrO0qRkoMprQ.png"/></div></div></figure><p id="e1ba" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">观察结果:</p><ul class=""><li id="c55c" class="mc md it kb b kc kd kg kh kk me ko mf ks mg kw mq mi mj mk bi translated">平均年龄39岁。</li><li id="8f5e" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">平均体重指数30.66。</li><li id="b6b0" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">孩子的平均数量是1。</li><li id="d4c1" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">平均索赔费用为13，270美元。</li></ul><p id="4a8c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">想象年龄和索赔费用之间的关系。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="5608" class="ls lt it lo b gy lu lv l lw lx">fig <strong class="lo jd">=</strong> plt<strong class="lo jd">.</strong>figure(figsize <strong class="lo jd">=</strong> (10, 6))<br/>sns<strong class="lo jd">.</strong>barplot(y <strong class="lo jd">=</strong> 'charges', <br/>            x <strong class="lo jd">=</strong> 'age', <br/>            data <strong class="lo jd">=</strong> insurance,<br/>            ci <strong class="lo jd">=</strong> <strong class="lo jd">None</strong>)<br/><br/><em class="ly"># set labels</em><br/>plt<strong class="lo jd">.</strong>xlabel("Age", size<strong class="lo jd">=</strong>12)<br/>plt<strong class="lo jd">.</strong>ylabel("Claim Charges ($)", size<strong class="lo jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ms"><img src="../Images/1a54449d85617ca81a470ce3c2150140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RWIxKKW0FHczQ3TlACA0Ow.png"/></div></div></figure><p id="5485" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">想象性别和索赔费用之间的关系。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="33f2" class="ls lt it lo b gy lu lv l lw lx">fig <strong class="lo jd">=</strong> plt<strong class="lo jd">.</strong>figure(figsize <strong class="lo jd">=</strong> (6,4))<br/>sns<strong class="lo jd">.</strong>barplot(y <strong class="lo jd">=</strong> 'charges', <br/>            x <strong class="lo jd">=</strong> 'sex', <br/>            data <strong class="lo jd">=</strong> insurance,<br/>            ci <strong class="lo jd">=</strong> <strong class="lo jd">None</strong>)<br/>plt<strong class="lo jd">.</strong>xticks(ticks<strong class="lo jd">=</strong>[0, 1], labels <strong class="lo jd">=</strong> ["Female", "Male"])<br/><br/><em class="ly"># set labels</em><br/>plt<strong class="lo jd">.</strong>xlabel("Gender", size<strong class="lo jd">=</strong>12)<br/>plt<strong class="lo jd">.</strong>ylabel("Claim Charges ($)", size<strong class="lo jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mt"><img src="../Images/a633be5c7759dfcb8cffbf9c3767db3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVyFS4OqCHv-9NQe0Px2Jg.png"/></div></div></figure><p id="952d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">检查身体质量指数(身体质量指数)栏中的数值差异。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="4515" class="ls lt it lo b gy lu lv l lw lx">min(insurance<strong class="lo jd">.</strong>bmi), max(insurance<strong class="lo jd">.</strong>bmi)<br/>(15.96, 53.13)</span></pre><p id="6a4f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">身体质量指数(身体质量指数)值有很大的差异。为了可视化此功能的数据，我们需要添加一个新的身体质量指数类变量，并创建具有特定身体质量指数值的组。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="cc70" class="ls lt it lo b gy lu lv l lw lx">insurance["bmiclass"] <strong class="lo jd">=</strong> insurance<strong class="lo jd">.</strong>bmi<br/>insurance<strong class="lo jd">.</strong>bmiclass <strong class="lo jd">=</strong> insurance<strong class="lo jd">.</strong>bmi<strong class="lo jd">.</strong>round()<br/>insurance<strong class="lo jd">.</strong>head(5)</span><span id="85c8" class="ls lt it lo b gy lz lv l lw lx">insurance['bmiclass'] <strong class="lo jd">=</strong> insurance['bmiclass']<strong class="lo jd">.</strong>replace([16, 17, 18, 19, 20, 21], 1)<br/>insurance['bmiclass'] <strong class="lo jd">=</strong> insurance['bmiclass']<strong class="lo jd">.</strong>replace([22, 23, 24, 25, 26, 27], 2)<br/>insurance['bmiclass'] <strong class="lo jd">=</strong> insurance['bmiclass']<strong class="lo jd">.</strong>replace([28, 29, 30, 31, 32, 33], 3)<br/>insurance['bmiclass'] <strong class="lo jd">=</strong> insurance['bmiclass']<strong class="lo jd">.</strong>replace([34, 35, 36, 37, 38, 39], 4)<br/>insurance['bmiclass'] <strong class="lo jd">=</strong> insurance['bmiclass']<strong class="lo jd">.</strong>replace([40, 41, 42, 43, 44, 45], 5)<br/>insurance['bmiclass'] <strong class="lo jd">=</strong> insurance['bmiclass']<strong class="lo jd">.</strong>replace([46, 47, 48, 49, 50, 51, 52, 53], 6)<br/>insurance<strong class="lo jd">.</strong>head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mu"><img src="../Images/92de6d6d3c76b175a1e2585f436360ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*_2pvAv9xU4zI0pGQ8oYVTw.png"/></div></div></figure><p id="c756" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">想象一下体重指数和索赔费用之间的关系。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="248e" class="ls lt it lo b gy lu lv l lw lx">fig <strong class="lo jd">=</strong> plt<strong class="lo jd">.</strong>figure(figsize <strong class="lo jd">=</strong> (6,4))<br/>sns<strong class="lo jd">.</strong>barplot(y <strong class="lo jd">=</strong> 'charges', <br/>            x <strong class="lo jd">=</strong> 'bmiclass', <br/>            data <strong class="lo jd">=</strong> insurance,<br/>            ci <strong class="lo jd">=</strong> <strong class="lo jd">None</strong>)<br/>plt<strong class="lo jd">.</strong>xticks(ticks<strong class="lo jd">=</strong>[0, 1, 2, 3, 4, 5], labels <strong class="lo jd">=</strong> ["16 - 21", "22 - 27", "28 - 33", "34 - 39", "40 - 45", "46 - 53"]) <br/><em class="ly"># set labels</em><br/><br/>plt<strong class="lo jd">.</strong>xlabel("Body Mass Index", size<strong class="lo jd">=</strong>12)<br/>plt<strong class="lo jd">.</strong>ylabel("Claim Charges ($)", size<strong class="lo jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mv"><img src="../Images/fe76e5d84936fb77b6f3f60835fe6460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArYvGe00igTt0WZ-THev4Q.png"/></div></div></figure><p id="4a7d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">设想子女人数和索赔费用之间的关系。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="d040" class="ls lt it lo b gy lu lv l lw lx">fig <strong class="lo jd">=</strong> plt<strong class="lo jd">.</strong>figure(figsize <strong class="lo jd">=</strong> (6,4))<br/>sns<strong class="lo jd">.</strong>barplot(y <strong class="lo jd">=</strong> 'charges', <br/>            x <strong class="lo jd">=</strong> 'children', <br/>            data <strong class="lo jd">=</strong> insurance,<br/>            ci <strong class="lo jd">=</strong> <strong class="lo jd">None</strong>)<br/><br/><em class="ly"># set labels</em><br/>plt<strong class="lo jd">.</strong>xlabel("Number of Children", size<strong class="lo jd">=</strong>12)<br/>plt<strong class="lo jd">.</strong>ylabel("Claim Charges ($)", size<strong class="lo jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mw"><img src="../Images/ad1fa32f6e5c54415a7a5d3537f4649e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zjPy9gOBLFZ1aUwRRXqmTg.png"/></div></div></figure><p id="4e64" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">想象吸烟者/非吸烟者与索赔费用金额之间的关系。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="5b4d" class="ls lt it lo b gy lu lv l lw lx">fig <strong class="lo jd">=</strong> plt<strong class="lo jd">.</strong>figure(figsize <strong class="lo jd">=</strong> (6,4))<br/>sns<strong class="lo jd">.</strong>barplot(y <strong class="lo jd">=</strong> 'charges', <br/>            x <strong class="lo jd">=</strong> 'smoker', <br/>            data <strong class="lo jd">=</strong> insurance,<br/>            ci <strong class="lo jd">=</strong> <strong class="lo jd">None</strong>)<br/> <br/><em class="ly"># set labels</em><br/>plt<strong class="lo jd">.</strong>xlabel("Smoker", size<strong class="lo jd">=</strong>12)<br/>plt<strong class="lo jd">.</strong>ylabel("Claim Charges ($)", size<strong class="lo jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mx"><img src="../Images/865f01e1328724f058911fad9fdf9958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0IANsahPv8dF9LATfoabQ.png"/></div></div></figure><p id="9c3b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化地区和索赔费用金额之间的关系。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="a23a" class="ls lt it lo b gy lu lv l lw lx">fig <strong class="lo jd">=</strong> plt<strong class="lo jd">.</strong>figure(figsize <strong class="lo jd">=</strong> (6,4))<br/>sns<strong class="lo jd">.</strong>barplot(y <strong class="lo jd">=</strong> 'charges', <br/>            x <strong class="lo jd">=</strong> 'region', <br/>            data <strong class="lo jd">=</strong> insurance,<br/>            ci <strong class="lo jd">=</strong> <strong class="lo jd">None</strong>)<br/>plt<strong class="lo jd">.</strong>xticks(ticks<strong class="lo jd">=</strong>[0, 1, 2, 3], labels <strong class="lo jd">=</strong> ["Northeast", "Northwest", "Southeast", "Southwest"]) <br/><br/><em class="ly"># set labels</em><br/>plt<strong class="lo jd">.</strong>xlabel("Region", size<strong class="lo jd">=</strong>12)<br/>plt<strong class="lo jd">.</strong>ylabel("Claim Charges ($)", size<strong class="lo jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi my"><img src="../Images/596b495d9815d10de386e984ac52dc3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uiXqn72aVIkO2pghhS-S9w.png"/></div></div></figure><p id="6d44" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">观察结果:</p><ul class=""><li id="3bef" class="mc md it kb b kc kd kg kh kk me ko mf ks mg kw mq mi mj mk bi translated">随着年龄的增长，索赔费用逐渐增加。</li><li id="b998" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">男性的索赔费用略高。</li><li id="7601" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">随着体重指数的增加，索赔费用也会增加。有趣的是，在40-45岁的身体质量指数群体中，索赔费用略有下降。</li><li id="d242" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">当保单下有2或3名子女时，索赔费用会更高。</li><li id="6c2a" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">吸烟者的索赔费用要高得多。</li><li id="e623" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">所有地区的索赔费用相似，西北航空公司的费用最高。</li></ul><p id="087e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">检查费用列中的值差异。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="ff39" class="ls lt it lo b gy lu lv l lw lx">min(insurance<strong class="lo jd">.</strong>charges), max(insurance<strong class="lo jd">.</strong>charges)<br/>(1121.8739, 63770.42801)</span></pre><p id="46d7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">费用变量的值有很大的变化范围。</p><p id="06be" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化索赔费用值的分布。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="89f2" class="ls lt it lo b gy lu lv l lw lx">plt<strong class="lo jd">.</strong>figure(figsize<strong class="lo jd">=</strong>(6, 4))<br/>sns<strong class="lo jd">.</strong>histplot(insurance['charges'])</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mz"><img src="../Images/89447fa227ffa933ff7c62f73e41e9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ovxSORH8QqROk9Fib_j0g.png"/></div></div></figure><p id="e4dd" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">电荷值向轴的右侧倾斜。我们将在sklearn中使用最小和最大缩放来标准化电荷。这将把电荷的值转换到0和1之间的范围，这将使模型中的数据更容易处理。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="3ab9" class="ls lt it lo b gy lu lv l lw lx">column <strong class="lo jd">=</strong> 'charges'<br/>insurance[column] <strong class="lo jd">=</strong> (insurance[column] <strong class="lo jd">-</strong> insurance[column]<strong class="lo jd">.</strong>min()) <strong class="lo jd">/</strong> (insurance[column]<strong class="lo jd">.</strong>max() <strong class="lo jd">-</strong> insurance[column]<strong class="lo jd">.</strong>min())<br/>insurance<strong class="lo jd">.</strong>head()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi na"><img src="../Images/a991e5c962774ddaae8293942e3e8981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*73aj87FSgPfK5eUmNrfMqg.png"/></div></div></figure><p id="bf04" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">功能选择</strong></p><p id="611f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们需要将分类数据转换成数字数据。我们将使用一键编码进行转换。一种热门的编码技术是用二进制数字替换分类数据。转换后的列被赋予一个与这些值相对应的编号。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="d7ab" class="ls lt it lo b gy lu lv l lw lx"><strong class="lo jd">from</strong> sklearn <strong class="lo jd">import</strong> preprocessing<br/>le <strong class="lo jd">=</strong> preprocessing<strong class="lo jd">.</strong>LabelEncoder()<br/>insurance["sex"] <strong class="lo jd">=</strong> le<strong class="lo jd">.</strong>fit_transform(insurance["sex"])       <em class="ly"># 0 = female, 1 = male</em><br/>insurance["smoker"] <strong class="lo jd">=</strong> le<strong class="lo jd">.</strong>fit_transform(insurance["smoker"]) <em class="ly"># 1 = smoker, 2 = non-smoker</em><br/>insurance["region"] <strong class="lo jd">=</strong> le<strong class="lo jd">.</strong>fit_transform(insurance["region"]) <em class="ly"># 1 = northwest, 2 = southeast, 3 = southwest, 4 = northeast</em></span></pre><p id="ab52" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用皮尔逊相关法构建一个相关矩阵，用于测量特征和目标变量之间的线性关联。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="f258" class="ls lt it lo b gy lu lv l lw lx">plt<strong class="lo jd">.</strong>figure(figsize<strong class="lo jd">=</strong>(8,6))  <br/>sns<strong class="lo jd">.</strong>heatmap(insurance<strong class="lo jd">.</strong>corr(), annot<strong class="lo jd">=True</strong>, fmt<strong class="lo jd">=</strong>'.0%', cmap<strong class="lo jd">=</strong>'Blues')</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mx"><img src="../Images/ec30e49e564efc5f410d8849207c0385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euAKdDwWQ1toZFD5fSDk0g.png"/></div></div></figure><p id="6709" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">观察结果:</p><ul class=""><li id="d46b" class="mc md it kb b kc kd kg kh kk me ko mf ks mg kw mq mi mj mk bi translated">吸烟者和收费之间有很强的相关性。</li><li id="157e" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">年龄和费用之间的相关性很弱</li><li id="c74f" class="mc md it kb b kc ml kg mm kk mn ko mo ks mp kw mq mi mj mk bi translated">身体质量指数和电荷之间的相关性很弱。</li></ul><p id="aa67" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们需要移除性别和区域特征，因为它们为该分析提供了极小的价值。我们还将删除身体质量指数类要素，因为身体质量指数已经出现在数据集中。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="345c" class="ls lt it lo b gy lu lv l lw lx">insurance<strong class="lo jd">.</strong>drop(['sex', 'region', 'bmiclass'], axis<strong class="lo jd">=</strong>1, inplace<strong class="lo jd">=True</strong>)</span></pre><p id="eaac" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">将数据分成训练和测试数据集</strong></p><p id="2aea" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">首先，我们需要将数据分为x值(我们将用来进行预测的数据)和y值(我们试图预测的数据)。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="f721" class="ls lt it lo b gy lu lv l lw lx">x_data <strong class="lo jd">=</strong> insurance<strong class="lo jd">.</strong>drop('charges', axis <strong class="lo jd">=</strong> 1)<br/>y_data <strong class="lo jd">=</strong> insurance['charges']</span></pre><p id="094e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用train_test_split函数来生成训练数据和测试数据。测试数据集将包括25%的原始数据集。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="b7e0" class="ls lt it lo b gy lu lv l lw lx">x_training_data, x_test_data, y_training_data, y_test_data <strong class="lo jd">=</strong> train_test_split(x_data, y_data, test_size <strong class="lo jd">=</strong> 0.25, random_state<strong class="lo jd">=</strong>42)</span></pre><p id="bc42" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">归一化数据</strong></p><p id="36d4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们需要对数据进行标准化，使其分布的平均值为0，标准差为1。规范化使要素之间更加一致，从而使模型能够更准确地预测输出。这是为数据集中的每个特征或列进行的。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="e367" class="ls lt it lo b gy lu lv l lw lx">sc <strong class="lo jd">=</strong> StandardScaler()<br/>x_training_data <strong class="lo jd">=</strong> sc<strong class="lo jd">.</strong>fit_transform(x_training_data)<br/>x_test_data <strong class="lo jd">=</strong> sc<strong class="lo jd">.</strong>fit_transform(x_test_data)</span></pre><p id="77b5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">我们现在将训练模型，进行预测，并评估三种不同机器学习模型的性能。</strong></p><p id="d766" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用R2分数来评估基于回归的机器学习模型的性能。它也被称为决定系数。它通过测量数据集中的样本与模型所做预测之间的差异量来工作。</p><p id="48af" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用均方根误差(RMSE)来衡量模型的性能。“根”表示平方误差是一种度量标准，它显示了模型的预测值与数据集中的实际值之间的平均距离。通过计算每个数据点的残差(预测值和真实值之间的差异)，计算每个数据点的残差的范数，计算残差的平均值，并取该平均值的平方根，可以找到RMSE。该值越低，模型的性能越好。</p><p id="2141" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">线性回归模型</strong></p><p id="39d4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">简单线性回归使用一个自变量来解释或预测因变量Y的结果，而多元线性回归使用两个或多个自变量来预测结果。当创建一个回归模型时，我们所要做的就是画一条最接近数据集中每一点的线。</p><p id="f87c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将根据训练数据训练线性回归模型，并根据测试数据进行预测。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="bb7c" class="ls lt it lo b gy lu lv l lw lx"># Create model object.<em class="ly"> </em><br/>model_lr <strong class="lo jd">=</strong> LinearRegression()<br/># Train the model on the training data.<br/>model_lr<strong class="lo jd">.</strong>fit(x_training_data, y_training_data)<br/># Make predictions on the test data. <br/>predictions_lr <strong class="lo jd">=</strong> model_lr<strong class="lo jd">.</strong>predict(x_test_data)</span></pre><p id="b10a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用测试数据计算线性回归模型的R2分数。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="e5a6" class="ls lt it lo b gy lu lv l lw lx">r2 = r2_score(y_test_data, predictions_lr)<br/>print("R2 score :", r2)</span></pre><p id="3f2c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">R2分数:0.76668636865</p><p id="ad8b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">线性回归模型根据投保人的特征准确预测了77%的保险索赔费用。</p><p id="7ff1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算线性回归模型的均方根误差(RMSE)。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="44e9" class="ls lt it lo b gy lu lv l lw lx">rmse <strong class="lo jd">=</strong> np<strong class="lo jd">.</strong>sqrt(np<strong class="lo jd">.</strong>mean(((predictions_lr <strong class="lo jd">-</strong> y_test_data)<strong class="lo jd">**</strong>2)))<br/>print(rmse)</span></pre><p id="5d68" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi">0.0949123371964687</p><p id="c5ca" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">RMSE显示，线性回归模型的典型预测误差为0.09，非常好。</p><p id="9454" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">随机福里斯特模型</strong></p><p id="be54" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">随机福里斯特模型由大量单独的决策树组成，这些决策树作为一个整体运行。随机森林中的每棵树都会生成一个类别预测，拥有最多投票的类别将成为模型的预测。随机森林背后的基本思想是将许多决策树组合成一个模型。单独地，由决策树(或人类)做出的预测可能不准确，但是结合在一起，预测会准确得多。</p><p id="ee05" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将根据训练数据训练随机森林模型，并根据测试数据进行预测。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="47fe" class="ls lt it lo b gy lu lv l lw lx"># Create model object. <br/>model_rf <strong class="lo jd">=</strong> RandomForestRegressor(n_estimators <strong class="lo jd">=</strong> 10, random_state <strong class="lo jd">=</strong> 0)<br/># Train the model on the training data.<br/>model_rf<strong class="lo jd">.</strong>fit(x_training_data, y_training_data)<br/># Make predictions on the test data.<strong class="lo jd"> </strong><br/>predictions_rf <strong class="lo jd">=</strong> model_rf<strong class="lo jd">.</strong>predict(x_test_data)</span></pre><p id="824c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用测试数据计算随机森林模型的R2分数。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="5ed8" class="ls lt it lo b gy lu lv l lw lx"># Calculate the R2 score.<br/>r2 = r2_score(y_test_data, predictions_rf)<br/>print("R2 Score :", r2)</span></pre><p id="2a41" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">R2分数:0.82586888887</p><p id="31a2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">随机森林模型根据投保人的特征准确预测了82%的保险索赔费用。</p><p id="ea0a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算随机森林模型的均方根误差(RMSE)。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="b51a" class="ls lt it lo b gy lu lv l lw lx">rmse <strong class="lo jd">=</strong> np<strong class="lo jd">.</strong>sqrt(np<strong class="lo jd">.</strong>mean(((predictions_rf <strong class="lo jd">-</strong> y_test_data)<strong class="lo jd">**</strong>2)))<br/>print(rmse)</span></pre><p id="86bf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi">0.08277932950728627</p><p id="c071" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">RMSE表明，随机森林模型的典型预测误差为0.08，这是非常好的。</p><p id="29ef" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">支持向量机模型</strong></p><p id="bd4f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">支持向量机(SVM)是有监督的机器学习模型，具有分析数据和识别模式的相关学习算法。支持向量机既可以用于分类问题，也可以用于回归问题。更具体地说，SVR模型将数据点映射为空间中的点，并划分单独的类别，以便通过尽可能宽的开放间隙来划分它们。根据新数据点落入间隙的哪一侧，预测它们属于某个类别。</p><p id="656f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将在训练数据上训练支持向量机模型，并在测试数据上进行预测。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="beb5" class="ls lt it lo b gy lu lv l lw lx"># Create model object. <br/>model_sv <strong class="lo jd">=</strong> SVR()<br/># Train the model on the training data.<br/>model_sv<strong class="lo jd">.</strong>fit(x_training_data, y_training_data)<br/># Make predictions on the test data. <br/>predictions_sv <strong class="lo jd">=</strong> model_sv<strong class="lo jd">.</strong>predict(x_test_data)</span></pre><p id="f37b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用测试数据计算支持向量机模型的R2分数。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="129b" class="ls lt it lo b gy lu lv l lw lx">r2 = r2_score(y_test_data, predictions_sv)<br/>print("R2 Score :", r2)</span></pre><p id="d139" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">R2分数:0.73678676867</p><p id="6744" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">支持向量机模型根据投保人的特征准确预测了74%的保险索赔费用。</p><p id="f2e4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算支持向量机模型的均方根误差(RMSE)。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="b0ed" class="ls lt it lo b gy lu lv l lw lx">rmse <strong class="lo jd">=</strong> np<strong class="lo jd">.</strong>sqrt(np<strong class="lo jd">.</strong>mean(((predictions_sv <strong class="lo jd">-</strong> y_test_data)<strong class="lo jd">**</strong>2)))<br/>print(rmse)</span></pre><p id="ab6b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi">0.10006634144813659</p><p id="73e1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">RMSE表明，支持向量机模型的典型预测误差为. 10，这是非常好的。</p><p id="7a27" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示每个模型的准确度分数。</p><pre class="ky kz la lb gt ln lo lp lq aw lr bi"><span id="9aef" class="ls lt it lo b gy lu lv l lw lx">models <strong class="lo jd">=</strong> pd<strong class="lo jd">.</strong>DataFrame({<br/>    'Model':['Linear Regression', 'Random Forrest', 'Support Vector Machine'],<br/>    'Accuracy_score' :[lr, rf, sv]<br/>})<br/>models<br/>sns<strong class="lo jd">.</strong>barplot(x<strong class="lo jd">=</strong>'Accuracy_score', y<strong class="lo jd">=</strong>'Model', data<strong class="lo jd">=</strong>models)<br/><br/>models<strong class="lo jd">.</strong>sort_values(by<strong class="lo jd">=</strong>'Accuracy_score', ascending<strong class="lo jd">=False</strong>)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/0249e1409cb45ce44977c42cb3eaf0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*qTsNvlUIJVTcxwi8O7PEJw.png"/></div></figure><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/78ad17463a9fe632906ac0249e9b218c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*YqEKEesA6Rj-EOS_pvS9AA.png"/></div></figure><p id="6edb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">结论:所有的模型都很好地预测了基于投保人特征的保险索赔费用。随机森林模型的准确度最高。该模型正确预测了82%的保险索赔费用。这个模型的典型预测误差也是0.08。这项研究可以通过更大的保险数据集和调整模型的超参数来改进。</p><p id="e278" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">非常感谢你阅读我的文章！如果您有任何意见或反馈，请在下面添加。</p><p id="9556" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。会员资格让你可以无限制地接触媒体上的故事。你可以使用此链接<a class="ae mb" href="https://medium.com/@dniggl/membership" rel="noopener">https://medium.com/@dniggl/membership</a>注册</p></div></div>    
</body>
</html>