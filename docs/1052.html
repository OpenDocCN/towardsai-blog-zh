<html>
<head>
<title>How to Handle Imbalanced Data in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中如何处理不平衡数据</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-handle-imbalanced-data-in-machine-learning-9fe1334e9dff?source=collection_archive---------0-----------------------#2020-10-17">https://pub.towardsai.net/how-to-handle-imbalanced-data-in-machine-learning-9fe1334e9dff?source=collection_archive---------0-----------------------#2020-10-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="e257" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="9f84" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">解决分类任务时处理不平衡数据的不同方法</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/9d0244c68e6aaccd389f58ae14973744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zJjd6zQiwksNJv7A"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@bk010397?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">巴拉蒂·坎南</a>在<a class="ae li" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="f839" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">什么是不平衡数据</h1><p id="e74a" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">处理分类任务时最常见的问题之一是数据不平衡，即一个类支配另一个类。例如，在信用卡欺诈检测任务中，与非欺诈交易(负类)相比，欺诈交易(正类)将非常少。有时，甚至有可能99.99%的交易是非欺诈交易，只有0.01%的交易是欺诈交易。</p><p id="e5af" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">在二元分类任务和多类分类任务中，你可能会遇到类不平衡的问题。然而，我们在这里将要学习的技术可以应用于这两者。</p><h1 id="91ed" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">你为什么要担心不平衡的数据呢？</h1><p id="a919" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">考虑同样的信用卡欺诈交易检测的例子，其中欺诈和非欺诈交易的比率分别为99%和1%。这是一个高度不平衡的数据集。如果您要在这个数据集上训练模型，您将获得高达99%的准确性，因为分类器将挑选流行类中的模式，并预测几乎所有交易都是非欺诈交易。因此，该模型将无法对新数据进行归纳。这也是为什么在处理不平衡数据时，准确性不是一个好的评估指标的原因。</p><h1 id="aa9e" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">不平衡数据的例子</h1><p id="527f" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">以下是我们在机器学习中遇到不平衡数据的一些例子:</p><ul class=""><li id="7b8d" class="nc nd iu md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated">欺诈检测</li><li id="d0ee" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">索赔预测</li><li id="497c" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">流失预测</li><li id="8bb2" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">垃圾邮件检测</li><li id="375f" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">异常检测</li><li id="3491" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">异常值检测等。</li></ul><h1 id="befd" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">处理不平衡数据</h1><p id="87cb" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">让我们尝试一下处理不平衡数据集的一些方法。</p><h2 id="aee8" class="nq lk iu bd ll nr ns dn lp nt nu dp lt mk nv nw lv mo nx ny lx ms nz oa lz ja bi translated">1.获取更多数据</h2><p id="f2d3" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">当你有不平衡的数据时，检查是否有可能得到更多的数据以减少类的不平衡是一个好的实践。在大多数情况下，由于您试图解决的问题的性质，您不会获得所需的更多数据。</p><h2 id="45ab" class="nq lk iu bd ll nr ns dn lp nt nu dp lt mk nv nw lv mo nx ny lx ms nz oa lz ja bi translated">2.变更评估标准</h2><p id="b7fd" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">正如我们上面讨论的，当处理不平衡的类时，准确性不是一个好的度量。下面提到的其他分类指标可以提供更好的洞察力。您可以根据您试图解决的用例或问题来选择指标。</p><p id="9298" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> Precision: </strong>在所有肯定预测的类别中，实际上是肯定类别的百分比是多少。</p><p id="3d38" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je">召回:</strong>召回又叫敏感度和真阳性率(TPR)。在所有积极的类中，有多少百分比实际上被预测为积极的。</p><p id="652b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je">F1-得分:</strong>F1-得分是精确度和召回率调和平均值。结果介于0和1之间，0表示最差，1表示最好。它是模型准确性的度量。</p><p id="d614" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> ROC-AUC: </strong> ROC <strong class="md je">ROC图是通过绘制FPR对TPR而创建的，其中对于0.0至1.0的不同概率阈值，FPR(假阳性率)绘制在x轴上，TPR(真阳性率)绘制在y轴上。</strong></p><blockquote class="ob oc od"><p id="804f" class="mb mc oe md b me mx ke mg mh my kh mj of mz mm mn og na mq mr oh nb mu mv mw in bi translated">我邀请您浏览下面的文章，在这些文章中，我非常详细地解释了不同的分类评估标准。</p></blockquote><div class="oi oj gq gs ok ol"><a href="https://medium.com/towards-artificial-intelligence/classification-evaluation-metrics-explained-clearly-e74756dd2a0f" rel="noopener follow" target="_blank"><div class="om ab fp"><div class="on ab oo cl cj op"><h2 class="bd je gz z fq oq fs ft or fv fx jd bi translated">分类评估指标解释清楚</h2><div class="os l"><h3 class="bd b gz z fq oq fs ft or fv fx dk translated">理解混淆矩阵、精确度、回忆、F1分数等。</h3></div><div class="ot l"><p class="bd b dl z fq oq fs ft or fv fx dk translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz lc ol"/></div></div></a></div><div class="oi oj gq gs ok ol"><a href="https://medium.com/towards-artificial-intelligence/the-beginners-guide-to-the-roc-curve-and-auc-40585bada247" rel="noopener follow" target="_blank"><div class="om ab fp"><div class="on ab oo cl cj op"><h2 class="bd je gz z fq oq fs ft or fv fx jd bi translated">ROC曲线和AUC初学者指南</h2><div class="os l"><h3 class="bd b gz z fq oq fs ft or fv fx dk translated">了解什么是ROC曲线和AUC，如何工作，以及如何将其用于分类问题</h3></div><div class="ot l"><p class="bd b dl z fq oq fs ft or fv fx dk translated">medium.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz lc ol"/></div></div></a></div><h2 id="69bc" class="nq lk iu bd ll nr ns dn lp nt nu dp lt mk nv nw lv mo nx ny lx ms nz oa lz ja bi translated">3.改变算法</h2><p id="36af" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">你应该尝试用不同的机器学习算法来比较结果。基于树的分类器，例如决策树分类器、额外树分类器、随机森林分类器等。即使在不平衡的数据集上也能表现良好。</p><h2 id="b543" class="nq lk iu bd ll nr ns dn lp nt nu dp lt mk nv nw lv mo nx ny lx ms nz oa lz ja bi translated">4.重采样技术</h2><p id="9c2d" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">这是平衡数据集中多数类和少数类的方法。有两种重采样技术:</p><p id="c2f9" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je">欠采样</strong> —这有助于减少数据集中多数类示例的数量。因为我们从原始数据中删除了多数类示例，所以丢失了一些信息。</p><p id="3f64" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je">过采样</strong> —这有助于增加数据集中少数类示例的数量。过采样的主要优点之一是在处理过程中，多数类和少数类都不会丢失信息。容易过拟合。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pb"><img src="../Images/81a66f5e2d8bac69f5d645ece616f88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ij9uVGBcQ3FZBekW5LvlUA.png"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">资料来源:KDNuggets.com</figcaption></figure><h2 id="cc10" class="nq lk iu bd ll nr ns dn lp nt nu dp lt mk nv nw lv mo nx ny lx ms nz oa lz ja bi translated">5.生成合成样本</h2><p id="6b23" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">过采样技术创建少数类的副本来平衡数据集。这种方法的一个改进是使用不同的方法合成新的少数类。两种最常用的技术是——SMOTE(合成少数过采样技术)和ADASYN(自适应合成采样)。</p><h1 id="1393" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">结论</h1><p id="5636" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">在本文中，您已经了解了什么是类不平衡，以及在机器学习中处理不平衡数据的不同方法。在下一篇文章中，我们将使用<code class="fe pc pd pe pf b">imbalanced-learn</code>库来处理不平衡数据。</p><p id="95bf" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><em class="oe">阅读更多关于Python和数据科学的此类有趣文章，</em> <a class="ae li" href="https://pythonsimplified.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="md je"> <em class="oe">订阅</em> </strong> </a> <em class="oe">到我的博客</em><a class="ae li" href="http://www.pythonsimplified.com/" rel="noopener ugc nofollow" target="_blank"><strong class="md je"><em class="oe">【www.pythonsimplified.com】</em></strong></a><strong class="md je"><em class="oe">。</em> </strong>你也可以通过<a class="ae li" href="https://www.linkedin.com/in/chetanambi/" rel="noopener ugc nofollow" target="_blank"> <strong class="md je"> LinkedIn </strong> </a>联系我。</p></div></div>    
</body>
</html>