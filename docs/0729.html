<html>
<head>
<title>The Architecture and Implementation of LeNet-5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LeNet-5的体系结构与实现</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/the-architecture-implementation-of-lenet-5-eef03a68d1f7?source=collection_archive---------1-----------------------#2020-07-27">https://pub.towardsai.net/the-architecture-implementation-of-lenet-5-eef03a68d1f7?source=collection_archive---------1-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="2fe6" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="6447" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">揭秘LeNet-5最古老的神经网络架构</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/d256992a6a19618c647e0c9a31490633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01ZtSWeE053EWkIdkYb4GQ.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">【Faz.net T2】图片来自</figcaption></figure><p id="3885" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated"><span class="l mc md me bm mf mg mh mi mj di"> T </span>他非常古老的神经网络架构是由法裔美国计算机科学家<em class="mk"> Yann André LeCun、Leon Bottou、Yoshua Bengio、</em>和<em class="mk"> Patrick Haffner </em>于1998年开发的。这种体系结构是为识别手写和机器打印的字符而开发的。它是其他深度学习模型的基础。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ml"><img src="../Images/628627c80dd18e9f422a78ffabc85fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvvWF48t7cyRWqct13eU0w.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf" rel="noopener ugc nofollow" target="_blank">原图发表于【乐存等，1998】</a></figcaption></figure><p id="4889" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该架构总共由7层组成，包括2组卷积层和2组平均池层，之后是平坦卷积层。之后，我们有2个密集的全连接层，最后是一个softmax分类器。</p><h2 id="24e3" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">输入层</h2><p id="7608" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">如果我们取一个标准的MNIST图像来理解，那么<strong class="lh ja"> </strong>我们有一个(32×32)灰度图像的输入，它通过第一个卷积层，具有6个特征图或滤波器，具有(5×5)核的大小，步长为1。对输入像素的值进行归一化处理，使白色背景和前景黑色分别对应于<strong class="lh ja"> -0.1 </strong>和<strong class="lh ja"> 1.175 </strong>，使<strong class="lh ja"> <em class="mk">的均值近似为0 </em> </strong> <em class="mk"> </em>，使<strong class="lh ja"> <em class="mk">的方差近似为1 </em> </strong>。</p><blockquote class="nj"><p id="c629" class="nk nl iq bd nm nn no np nq nr ns ma dk translated">该输入层不计入LeNet-5的网络结构中，因为传统上，输入层不被认为是网络层级之一。</p></blockquote><h2 id="9a6e" class="mm mn iq bd mo mp nt dn mr ms nu dp mu lo nv mw mx ls nw mz na lw nx nc nd iw bi translated">第一层</h2><p id="6bc9" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">用6个滤波器对输入图像进行卷积的结果必须导致尺寸从(32×32×1)变化到(28×28×6)，并且我们得到我们的<strong class="lh ja">第一层</strong>。因此，当对我们的输入图像应用6个滤波器时，1个通道变为6个通道。此外，由于内核大小为(5x5)的零填充，图像大小也减小了。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/f387c664cfbe7b033af9af55eb2c2e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8FF7uNQE-fG02l9HELRnYw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><h2 id="48d7" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;第一层的计算</h2><ul class=""><li id="35de" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated"><strong class="lh ja">过滤器尺寸= f = </strong> 5 x 5</li><li id="1a2d" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">过滤器数量= 6</strong></li><li id="6655" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">大步数= S = </strong> 1</li><li id="f0dd" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">填充= P = </strong> 0</li><li id="c3f8" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">输出特征映射大小= </strong> 28 x 28</li><li id="4120" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">神经元数量= 28 * 28 * 6 =</strong>4704</li></ul><blockquote class="on oo op"><p id="e944" class="lf lg mk lh b li lj ka lk ll lm kd ln oq lp lq lr or lt lu lv os lx ly lz ma ij bi translated">在卷积中，滤波器值是可训练的参数。</p></blockquote><ul class=""><li id="9a01" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">学习参数数量= <em class="mk">(权重+偏差)每个滤波器*滤波器数量</em> </strong></li></ul><p id="a2d7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">= <strong class="lh ja"> (5 * 5 + 1) * 6 = </strong> 156</p><p id="db18" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">其中，<strong class="lh ja"> 5 * 5 = 25 </strong>为<em class="mk">单位参数</em>和<strong class="lh ja"> 1 </strong>每滤波器的<em class="mk">偏差，我们总共有<em class="mk">个</em>滤波器<strong class="lh ja"> 6个</strong>滤波器<em class="mk"/></em></p><ul class=""><li id="9e98" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">连接数量= 156<em class="mk">* 28 * 28</em>=</strong>122304</li></ul><h2 id="beb1" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;详细描述:</h2><ol class=""><li id="4e54" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma ow of og oh bi translated">对输入图像应用第一次卷积运算(使用大小为5×5的6个卷积核)以获得6个C1特征图(6个特征图，每个大小为28×28)，其中大小通过<strong class="lh ja"> (N-f+2P)/S+1 </strong>获得，但是这里<strong class="lh ja"> P=0 </strong>并且<strong class="lh ja"> S=1，</strong>因此我们在整个内容中使用<strong class="lh ja"> N-f+1 </strong>。因此，卷积后的输出大小为32–5+1 = 28。</li><li id="6102" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated">让我们看看需要的参数数量。卷积核的大小为5×5，共有6 * (5 * 5 <strong class="lh ja"> + 1 </strong> ) = 156个参数，其中<strong class="lh ja"> <em class="mk"> +1表示核有偏差</em> </strong>。</li><li id="6f52" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated">对于卷积层<strong class="lh ja"> C1 </strong>，C1每个像素连接5 * 5个像素，1个偏置，所以总共有156 * 28 * 28 = 122304个连接。虽然有1，22，304个连接，但我们只需要学习156个参数，主要通过权重共享。</li></ol></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><h2 id="7c3c" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">第二层</h2><p id="a22c" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">在<strong class="lh ja">第二层</strong>中，我们实现了一个平均池层，过滤器大小为(2x2)，跨距为2。因此，生成的图像尺寸将减小到(14x14x6)。这里，每个特征地图中的每个单元都连接到<strong class="lh ja">2×2)</strong>C1的相应特征地图中的邻域。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/184b00ef74efd3b47967bc71b7d8f053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7YUD0zqvkoAlBQ9iyYCGg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><h2 id="2350" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;第二层的计算</h2><ul class=""><li id="48fa" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated"><strong class="lh ja">过滤器尺寸= f =</strong>2×2</li><li id="906a" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">过滤器的数量=  6</li><li id="cfa7" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">步幅= S =  2</li><li id="b9d1" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">填充= P = </strong> 0</li><li id="9944" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">输出特征图尺寸=</strong>14×14</li><li id="f136" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">神经元的数量= 14 * 14 * 6 =1176</li></ul><blockquote class="on oo op"><p id="8af7" class="lf lg mk lh b li lj ka lk ll lm kd ln oq lp lq lr or lt lu lv os lx ly lz ma ij bi translated">将<strong class="lh ja"> 4个</strong>输入从<strong class="lh ja"><em class="iq"/></strong>中的相应特征映射添加到<strong class="lh ja"> S2 </strong>中的一个单元，然后乘以一个<strong class="lh ja">可训练系数</strong>，并添加一个<strong class="lh ja">可训练偏差</strong>。然后结果通过一个s形激活函数，我们得到结果<strong class="lh ja"> Q </strong></p></blockquote><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/89b86b0a1933b4220492b3bd8d361b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gE8TnA4ZTC5rMx4SzHZQ0Q.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><ul class=""><li id="ba1a" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">学习参数个数= <em class="mk">(系数+偏差)*滤波器个数</em> </strong></li></ul><p id="44ea" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">= <strong class="lh ja"> (1+ 1) * 6 = </strong> 12</p><p id="3187" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">其中，第一个<strong class="lh ja"> 1 </strong>为汇集对应的2×2感受野的<em class="mk">权重，第二个<strong class="lh ja"> 1 </strong>为<em class="mk">偏差</em>。</em></p><ul class=""><li id="8e85" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">连接数=(2 * 2+1)* 14 * 14 * 6 = 5880</strong></li></ul><h2 id="79eb" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;详细描述:</h2><ol class=""><li id="5232" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma ow of og oh bi translated">在第一次卷积之后，立即进行汇集操作。使用2 * 2个核进行池化，并且获得6个14 * 14的S2特征图。</li><li id="0036" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated">S2的池层是C1 <strong class="lh ja"> <em class="mk">中2 * 2区域像素的平均值乘以一个权重系数再加上一个偏移或偏置</em> </strong>，然后结果再次映射。</li><li id="110c" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated">所以每个池核心都有两个训练参数，因而在<strong class="lh ja"> <em class="mk">中总共有2*6 = 12个训练参数，但是有5*14*14*6 = 5880个连接。</em> </strong></li></ol></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><h2 id="7373" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">第三层</h2><p id="30a6" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">如果我们进一步进行到<strong class="lh ja">第三层</strong>，我们将内核大小为(5x5)的<strong class="lh ja"> 16 </strong>滤镜应用到<strong class="lh ja"> S2 </strong>上，产生一个卷积层<strong class="lh ja"> C3 </strong>和<strong class="lh ja"> 16 </strong> <em class="mk">特征贴图。</em>这个卷积导致图像的尺寸从 <strong class="lh ja"> <em class="mk"> S2 </em> </strong>中的<strong class="lh ja"><em class="mk">(14×14×6)</em></strong><em class="mk">变为</em><strong class="lh ja"><em class="mk">【C3</em></strong>中的<strong class="lh ja"><em class="mk">10×16】</em></strong><em class="mk">。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/c4b2e2ea98b4995f9d80a33489f93943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qG1zQAwWORt9FhsOP2fr_g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><h2 id="814e" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;第三层的计算</h2><ul class=""><li id="bf74" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated"><strong class="lh ja">过滤器尺寸= f =</strong>5×5</li><li id="b765" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">过滤器数量=  16</li><li id="70e3" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">大步数= S = </strong> 1</li><li id="d4db" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">填充= P = </strong> 0</li><li id="660d" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">输出特征图尺寸=</strong>10×10</li><li id="859f" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">神经元数量= 10 * 10 * 16 =1600</li></ul><p id="bbd8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这里我们可以看到输入即<strong class="lh ja"> S2 </strong>有<strong class="lh ja"> 6 </strong>层，输出即<strong class="lh ja"> C3 </strong>有16层。因此，我们不能直接将每个输入层映射到输出层。因此，每个特征地图中的每个单元，即<strong class="lh ja"> C3 </strong>都连接到<strong class="lh ja">5 x 5)</strong>S2特征地图子集中相同位置的几个邻域。</p><blockquote class="nj"><p id="9a3a" class="nk nl iq bd nm nn no np nq nr ns ma dk translated">来自S2的不同输入特征地图选择的组合将允许提取更多的新特征。</p></blockquote><p id="d2c9" class="pw-post-body-paragraph lf lg iq lh b li ph ka lk ll pi kd ln lo pj lq lr ls pk lu lv lw pl ly lz ma ij bi translated">从<strong class="lh ja"> S2 </strong>拍摄的特征地图的不同组合如下图所示:</p><ol class=""><li id="7a9e" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma ow of og oh bi translated"><strong class="lh ja"> <em class="mk">从来自S2的3幅特征地图的每个相邻子集获取输入:</em></strong>C3的前6个卷积层用该组合制成。</li><li id="53b0" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated"><strong class="lh ja"> <em class="mk">从来自S2的4个特征图的每个相邻子集获取输入:-</em></strong>C3的接下来6个卷积层用该组合制成。</li><li id="d5c5" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated"><strong class="lh ja"> <em class="mk">从来自S2的4个特征地图的不连续子集获取输入:- </em> </strong>接下来的3个C3层用这个组合制作。</li><li id="d23b" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated"><strong class="lh ja"> <em class="mk">取所有的特征图:-</em></strong><em class="mk">C3最后的</em>图层就是用这个组合做出来的。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/768a0ad778e7a7e1df71e1efe4ee932f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJ1cLUx_Sb6W5neBCCrmSA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="bd mo">原图发表于【乐存等著，1998】</strong></a></figcaption></figure><ul class=""><li id="934b" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">学习参数个数= <em class="mk">(组合类型-1中的参数)+(组合类型-2中的参数)+(组合类型-3中的参数)+(组合类型-4中的参数)</em> </strong></li></ul><p id="bb1b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">=<strong class="lh ja">[6 *(5 * 5 * 3+1)]+[6 *(5 * 5 * 4+1)]+[3 *(5 * 5 * 4+1)]+[1 *(5 * 5 * 6+1)]</strong></p><p id="09d0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">= 456 + 606 + 303 + 151 = <strong class="lh ja"> 1516 </strong></p><blockquote class="on oo op"><p id="e2ca" class="lf lg mk lh b li lj ka lk ll lm kd ln oq lp lq lr or lt lu lv os lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="iq">注:- </em> </strong> <em class="iq">以上计算中，括号中与5*5一起使用的数字3、4、4、6基本上就是</em> <strong class="lh ja"> <em class="iq">深度。</em> </strong></p></blockquote><ul class=""><li id="0eb5" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">连接数量=</strong>1516 *(10 * 10)<strong class="lh ja">= 151600</strong></li></ul></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><h2 id="2463" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">第四层</h2><p id="3426" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">在<strong class="lh ja">第四层，</strong>我们将再次应用平均池层，过滤器大小为(2x2)，步长为2。因此，生成的图像具有平均池的结果，其大小为(5x5x16)。这里<strong class="lh ja"> S4 </strong>的每个特征地图中的每个单元都连接到<strong class="lh ja"> C3的相应特征地图中的(<strong class="lh ja"> 2 x 2) </strong>邻域。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/06beab7e61dc051248c1aa0851133edd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsYhWqPfBAoo4UrvyojuQg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><h2 id="7000" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;第四层的计算</h2><ul class=""><li id="b18d" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated"><strong class="lh ja">过滤器尺寸= f =</strong>2×2</li><li id="68e6" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">过滤器的数量=  16</li><li id="91f3" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">跨度= S =  2</li><li id="2ca5" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">填充= P = </strong> 0</li><li id="f104" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">输出特征图尺寸=</strong>5×5</li><li id="0721" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">神经元数量= 5*5*16 = 400 </strong></li><li id="0253" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">学习参数数量= <em class="mk">(系数+偏差)*滤波器数量</em> </strong></li></ul><p id="aaf9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">= <strong class="lh ja"> (1+ 1) * 16 = </strong> 32</p><p id="eab5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">其中，第一个<strong class="lh ja"> 1 </strong>为汇集对应的2×2感受野的<em class="mk">权重，第二个<strong class="lh ja"> 1 </strong>为<em class="mk">偏差</em>。</em></p><ul class=""><li id="c8d0" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma oe of og oh bi translated"><strong class="lh ja">连接数=(2 * 2+1)* 5 * 5 * 16 = 2000</strong></li></ul><p id="18e6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这完成了2次卷积运算和2次汇集运算。</p></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><h2 id="5664" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">第五层</h2><p id="fd6e" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">在<strong class="lh ja">第五层</strong>中，我们有一个<strong class="lh ja"> <em class="mk">全连通卷积层C5 </em> </strong>，它有120个神经元单元，C5的每个单元都连接到所有16个S4特征图上的(5×5)邻域，即C5的每个单元都连接到S4的所有特征图上，因此<strong class="lh ja"> <em class="mk"> C5 </em> </strong>被称为<strong class="lh ja"> <em class="mk">全连通卷积层。</em>T15】</strong></p><blockquote class="on oo op"><p id="76ef" class="lf lg mk lh b li lj ka lk ll lm kd ln oq lp lq lr or lt lu lv os lx ly lz ma ij bi translated">C5被命名为<strong class="lh ja">“全连接卷积层”</strong>，而不是简单的<strong class="lh ja">“全连接层”</strong>，因为如果LeNet-5的输入大小增加，而保持其他一切不变，则C5层中的特征映射的维度将大于(1 x 1)。</p></blockquote><p id="d7d2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以在第四层，得到的维度是(5x5x16)，所以总节点是5x5x16 = 400个神经元。这意味着，400个节点连接到120个节点，形成一个密集的全连接网络。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi po"><img src="../Images/676ee1371b1b9ec4364135d4902d4903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oP78g9ch6zEXcgE8FS5KDw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><h2 id="4647" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;第五层的计算</h2><ul class=""><li id="eb32" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated"><strong class="lh ja">过滤器尺寸= f =</strong>5×5</li><li id="cb8c" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">过滤器数量=  120</li><li id="ba6e" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">步幅= S =  1</li><li id="b226" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated">填充= P =  0</li><li id="4a14" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">输出特征图尺寸=</strong>1×1</li><li id="12f7" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">神经元数量= 1*1*120 = </strong> 120</li><li id="b945" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">学习参数个数=(5 * 5 * 16+1)* 120 =</strong>48120</li><li id="75b6" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">连接数量= 48120 * 1 * 1 = 48120</strong></li></ul></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><h2 id="d9aa" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">第六层</h2><p id="62bb" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated"><strong class="lh ja">第六层F6 </strong>由84个神经元<strong class="lh ja"> <em class="mk">与</em> </strong>和<strong class="lh ja"> C5 </strong>完全连接而成。这里，执行输入向量和权重向量之间的点积，然后向其添加偏差。然后，结果通过一个s形激活函数。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pp"><img src="../Images/e2b1b071f84e8f948117d38665576f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CMuQ80Q6HmUsU9MSH_M1lw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><h2 id="d758" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">&gt;第六层的计算</h2><ul class=""><li id="0b51" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated"><strong class="lh ja">输入:</strong> C5有120个神经元</li><li id="6b21" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">输出:</strong>有84个神经元的F6</li><li id="6dd5" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma oe of og oh bi translated"><strong class="lh ja">学习参数个数=(120 * 84)+84 = 10164</strong></li></ul><p id="52b3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> F6层</strong>的神经元个数选择为<strong class="lh ja"> 84 </strong>，对应一个<strong class="lh ja">7×12位图</strong>，<strong class="lh ja"> -1 </strong>表示<strong class="lh ja">白色</strong>，<strong class="lh ja"> 1 </strong>表示<strong class="lh ja">黑色</strong>，所以每个符号位图的黑白对应一个代码。这种表示对于识别从可打印的<strong class="lh ja"> ASCII </strong>集中提取的字符串非常有用。与大写O、0和小写O相似且容易混淆的字符将具有相同的输出代码。</p><p id="453e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">ASCII编码集如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pq"><img src="../Images/c1a8016a4cb0d2e3078310c25f7cbd61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vD8SQ2q_JKwb-ScR0YBoxg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="bd mo">原图发表于【乐存等著，1998】</strong></a></figcaption></figure></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><p id="5d15" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">和<strong class="lh ja">最后是</strong>，我们有一个完全连接的softmax输出层，它有10个可能的值，对应于从<strong class="lh ja"> <em class="mk"> 0到9的数字。</em>T9】</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/87db0846f72a9c51d410cfc2273cc2bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2r5Z-HW9rq1But94axQyg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">作者图片</strong></figcaption></figure><blockquote class="on oo op"><p id="7c37" class="lf lg mk lh b li lj ka lk ll lm kd ln oq lp lq lr or lt lu lv os lx ly lz ma ij bi translated"><strong class="lh ja">因此，我们在输出层使用了“softmax activation”函数，我们看到其他层使用“tanh”作为激活函数，因为softmax将在最后给出每个输出类出现的概率。</strong></p></blockquote></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><blockquote class="nj"><p id="65e1" class="nk nl iq bd nm nn no np nq nr ns ma dk translated">我们现在正冒险进入编码领域。</p></blockquote><h1 id="7b3b" class="ps mn iq bd mo pt pu pv mr pw px py mu kf pz kg mx ki qa kj na kl qb km nd qc bi translated">使用Keras实现LeNet-5</h1><p id="a75d" class="pw-post-body-paragraph lf lg iq lh b li ne ka lk ll nf kd ln lo ng lq lr ls nh lu lv lw ni ly lz ma ij bi translated">在我们开始通过代码实现LeNet-5之前，有几个要点需要记住:</p><ol class=""><li id="c2ef" class="nz oa iq lh b li lj ll lm lo ot ls ou lw ov ma ow of og oh bi translated">LeCun使用的输入大小为<strong class="lh ja"> (32 x 32) </strong>，但是由于我们将使用MNIST数据集，因此该数据集中的图像大小为<strong class="lh ja"> (28 x 28)。</strong>因此，我们的输入大小是<strong class="lh ja"> (28 x 28) </strong>。</li><li id="58e2" class="nz oa iq lh b li oi ll oj lo ok ls ol lw om ma ow of og oh bi translated">当LeCun应用第三卷积，即<strong class="lh ja"> C5、</strong>时，输入大小为<strong class="lh ja">(5×5)</strong>，但是从最初开始，只有我们对网络的输入大小小于LeCun的输入大小，因此，在我们的情况下，<strong class="lh ja"> C5 </strong>的输入大小将为<strong class="lh ja">(4×4)</strong>，并且使用<strong class="lh ja">(5×5)</strong>滤波器对该输入应用卷积将导致负维大小，这是不可能的，因此</li></ol><h2 id="db17" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">导入库</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">导入的库</strong></figcaption></figure><h2 id="cd18" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">加载数据集并执行训练测试分割</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">拆分成列车并测试</strong></figcaption></figure><h2 id="307d" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">检查火车和测试分裂的大小</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">列车和测试的尺寸</strong></figcaption></figure><p id="ec7e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">上述代码的输出如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/a37a5d08daf8f92959947711ac428685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*-0IgPCDDEhVcFPyc4NQd2A.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">列车和试拼的形状</strong></figcaption></figure><h2 id="5393" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">执行整形操作-转换为四维</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">图像值的整形</strong></figcaption></figure><h2 id="0fcf" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">将图像转换的值归一化在0和1之间</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">归一化图像值</strong></figcaption></figure><h2 id="f52d" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">一键编码标签</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">标签的一个热编码</strong></figcaption></figure><h2 id="538d" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">构建模型架构</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">模型架构</strong></figcaption></figure><h2 id="0e95" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">模型概述</h2><ul class=""><li id="2867" class="nz oa iq lh b li ne ll nf lo ob ls oc lw od ma oe of og oh bi translated">这里大约有45，000个可训练参数，从后续图像中可以看出。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/20f39cc007c481643da4d90706d1b7f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*ToinNsR5poH5EwJ2LfEQ8Q.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">型号总结</strong></figcaption></figure><h2 id="cc05" class="mm mn iq bd mo mp mq dn mr ms mt dp mu lo mv mw mx ls my mz na lw nb nc nd iw bi translated">模型的编译</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">编译模型</strong></figcaption></figure><blockquote class="nj"><p id="2650" class="nk nl iq bd nm nn qh qi qj qk ql ma dk translated">最后，谈一谈评估你的模型。</p></blockquote><h2 id="ef53" class="mm mn iq bd mo mp nt dn mr ms nu dp mu lo nv mw mx ls nw mz na lw nx nc nd iw bi translated">寻找模型的损失和准确性</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="qd qe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="ak">模型的损失和精度</strong></figcaption></figure><p id="4979" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">损耗和精度的输出如下:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/5d85ef12dd5c404986aaa4b39e8e9286.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*8ujS0wQUa5RrMyDEGa78jg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd mo">模型的损失和准确性- </strong>作者图片</figcaption></figure></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><p id="5554" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">📌<strong class="lh ja">要获得LeNet-5或任何其他网络的完整代码，请访问我的</strong> <a class="ae le" href="https://github.com/vaibhavcodes/DeepLearning-Architectures" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja"> GitHub库</strong> </a> <strong class="lh ja">。</strong></p></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><p id="5f7b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mk">参考文献:</em> </strong></p><p id="9bc1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[1] Yann LeCun，<a class="ae le" href="http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf" rel="noopener ugc nofollow" target="_blank">基于梯度的学习应用于文档识别</a> (1998)，IEEE学报(1998)</p></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><blockquote class="nj"><p id="02b3" class="nk nl iq bd nm nn no np nq nr ns ma dk translated">感谢阅读。希望这篇博客对你的编码和理解架构有所帮助。😃</p></blockquote></div></div>    
</body>
</html>