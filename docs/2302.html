<html>
<head>
<title>[DBT] Override Default Schema with Custom Schema name [Tip-1]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[DBT]用自定义模式名覆盖默认模式[提示-1]</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/dbt-override-default-schema-with-custom-schema-name-tip-1-2e6ec59141b7?source=collection_archive---------0-----------------------#2021-11-07">https://pub.towardsai.net/dbt-override-default-schema-with-custom-schema-name-tip-1-2e6ec59141b7?source=collection_archive---------0-----------------------#2021-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="bd5a" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/software-engineering" rel="noopener ugc nofollow" target="_blank">软件工程</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/cf0e1929ac4d575ac5d13e4e35e28623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PpLGoKk6EF_6Rlt4lBxoQ.png"/></div></div></figure><h2 id="26e0" class="kh ki iq bd kj kk kl dn km kn ko dp kp kq kr ks kt ku kv kw kx ky kz la lb iw bi translated">问题</h2><p id="e8e4" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm kq ln lo lp ku lq lr ls ky lt lu lv lw ij bi translated">默认情况下，<code class="fe lx ly lz ma b">DBT</code>在由<code class="fe lx ly lz ma b">target_schema</code>和<code class="fe lx ly lz ma b">custom_schema</code>组合而成的模式下创建一个模型。但是，有些情况下，您希望只使用<code class="fe lx ly lz ma b">custom_schema</code>来创建模式，为了处理这个问题，我们需要覆盖创建模式的默认宏。默认情况下，dbt使用<code class="fe lx ly lz ma b">generate_schema_name</code>宏来生成模式。</p><p id="6154" class="pw-post-body-paragraph lc ld iq le b lf mb lh li lj mc ll lm kq md lo lp ku me lr ls ky mf lu lv lw ij bi translated"><code class="fe lx ly lz ma b">Target Schema</code>:在<code class="fe lx ly lz ma b">Profiles.yml</code>下定义。如果没有为模型定义定制模式，目标模式表示dbt将构建对象的<code class="fe lx ly lz ma b">default schema </code>。</p><p id="8969" class="pw-post-body-paragraph lc ld iq le b lf mb lh li lj mc ll lm kq md lo lp ku me lr ls ky mf lu lv lw ij bi translated"><code class="fe lx ly lz ma b">Custom Schema</code>:在<code class="fe lx ly lz ma b">dbt_project.yml</code>下定义。您可以在dbt中使用定制模式在目标模式之外的模式中构建模型。</p><figure class="mh mi mj mk gt ka gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/d0d10dbf2d676f949bd5ee23105e17d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*mEQg7-0BskWAvkJcTvTDJA.png"/></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">来源:<a class="ae mp" href="https://docs.getdbt.com/docs/building-a-dbt-project/building-models/using-custom-schemas" rel="noopener ugc nofollow" target="_blank">https://docs . get dbt . com/docs/building-a-dbt-project/building-models/using-custom-schemas</a></figcaption></figure><h2 id="9b71" class="kh ki iq bd kj kk kl dn km kn ko dp kp kq kr ks kt ku kv kw kx ky kz la lb iw bi translated">默认<code class="fe lx ly lz ma b">generate_schema_name Macro</code></h2><figure class="mh mi mj mk gt ka gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/99b9df5d854da8232f56c2c36cce82e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*z6arryEIQtGPP4tl0ToSmA.png"/></div></figure><h1 id="da99" class="mr ki iq bd kj ms mt mu km mv mw mx kp my mz na kt nb nc nd kx ne nf ng lb nh bi translated">解决办法</h1><h2 id="be5b" class="kh ki iq bd kj kk kl dn km kn ko dp kp kq kr ks kt ku kv kw kx ky kz la lb iw bi translated">自定义<code class="fe lx ly lz ma b">generate_schema_name Macro</code></h2><p id="bc9a" class="pw-post-body-paragraph lc ld iq le b lf lg lh li lj lk ll lm kq ln lo lp ku lq lr ls ky lt lu lv lw ij bi translated">在<strong class="le ja">宏</strong>文件夹下创建一个名为<strong class="le ja">override _ default _ macros . sql</strong>的文件，输入下面的SQL。</p><figure class="mh mi mj mk gt ka"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="ee3d" class="pw-post-body-paragraph lc ld iq le b lf mb lh li lj mc ll lm kq md lo lp ku me lr ls ky mf lu lv lw ij bi translated">如果<code class="fe lx ly lz ma b">custom_schema</code>不适用于指定的型号，则将使用<code class="fe lx ly lz ma b">profiles.yml</code>中的<code class="fe lx ly lz ma b">default_schema</code>。</p><p id="a262" class="pw-post-body-paragraph lc ld iq le b lf mb lh li lj mc ll lm kq md lo lp ku me lr ls ky mf lu lv lw ij bi translated">上面相同的代码也维护在这个不断增长的git存储库中。</p><div class="nk nl gp gr nm nn"><a href="https://github.com/karthikeyan-sivabaskaran/dbt-tips-and-tricks-series" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ja gy z fp ns fr fs nt fu fw iz bi translated">GitHub-karthikeyan-sivabaskaran/dbt-tips-and-tricks-series:这个回购将继续增长以演示…</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob kf nn"/></div></div></a></div><blockquote class="oc od oe"><p id="61bd" class="lc ld of le b lf mb lh li lj mc ll lm og md lo lp oh me lr ls oi mf lu lv lw ij bi translated">我希望这篇文章能帮助您定制模式名。如果你喜欢这个博客，请分享给你的队友，朋友，鼓掌👏在1到50英寸的范围内。<a class="ae mp" href="https://help.medium.com/hc/en-us/articles/115011350967-Claps" rel="noopener">每个帖子最多可以鼓掌50次</a>。</p></blockquote><figure class="mh mi mj mk gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oj"><img src="../Images/df97e99dd68d538fa24090ea6de53e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9fmbfwrjEIAfSkWR"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated"><a class="ae mp" href="https://unsplash.com/@grstocks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> GR Stocks </a>在<a class="ae mp" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><blockquote class="oc od oe"><p id="3ce2" class="lc ld of le b lf mb lh li lj mc ll lm og md lo lp oh me lr ls oi mf lu lv lw ij bi translated"><strong class="le ja">快乐压倒一切！</strong></p><p id="16a9" class="lc ld of le b lf mb lh li lj mc ll lm og md lo lp oh me lr ls oi mf lu lv lw ij bi translated">这篇文章是DBT提示和技巧系列的一部分。</p></blockquote></div></div>    
</body>
</html>