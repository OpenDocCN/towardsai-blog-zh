<html>
<head>
<title>Dissecting 1-Way ANOVA and ANCOVA with Examples in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R中的例子剖析单向方差分析和协方差分析</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/dissecting-1-way-anova-and-ancova-with-examples-in-r-a3a7da83d742?source=collection_archive---------1-----------------------#2021-04-03">https://pub.towardsai.net/dissecting-1-way-anova-and-ancova-with-examples-in-r-a3a7da83d742?source=collection_archive---------1-----------------------#2021-04-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3cf934eaf0ab9d4f89f2a6fb24cd6523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*k9XqgRyMOEisM5PY"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">彼得·奥勒克萨在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="5d0f" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming/r" rel="noopener ugc nofollow" target="_blank"> R </a></h2><div class=""/><div class=""><h2 id="49c8" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">通过分析方差得出的均值差异</h2></div><p id="641d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">ANOVA(方差分析)是比较两个以上组的平均值的过程。它也可用于比较两组的平均值。但那是不必要的。只能使用假设检验方法(如t检验)来比较两组之间的平均值。</p><p id="5727" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果您需要复习t-test或z-test，请查看这篇文章:</p><div class="is it gp gr iu md"><a rel="noopener  ugc nofollow" target="_blank" href="/a-complete-guide-to-confidence-interval-t-test-and-z-test-in-r-for-data-scientists-cd16dd2d0eec"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">数据科学家置信区间、t检验和z检验完全指南</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">大量的实践练习</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">pub.towardsai.net</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ja md"/></div></div></a></div><p id="0c9b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本文将集中于使用方差分析(ANOVA)方法比较两个以上组的平均值。<strong class="lj jt">这种方法将一个给定的连续结果的整体可变性分解成几个部分。</strong></p><h2 id="8163" class="ms mt jj bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj jp bi translated">单向方差分析</h2><p id="249d" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">单向ANOVA适用于基于一个因子的值定义组的情况。目标是比较各组的平均值。</p><p id="bce5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">无论样本均值是否不同，每组均值内的变异量都是比较均值并得出结论时要考虑的重要因素。</p><blockquote class="np"><p id="b0bc" class="nq nr jj bd ns nt nu nv nw nx ny mc dk translated">一般规则是，如果组间的差异小于组内的差异，则组间均值差异的可能性较小。同时，如果组间的差异大于单个组内的差异，则组间的均值可能存在差异。</p></blockquote><p id="b3fe" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">因此，在方差分析中，我们既需要组间的可变性，也需要单个组内的可变性。通常，方差分析中使用F统计量作为检验统计量。F统计量的公式为:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/67ec848a6052442368510beb4c3abf4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*KAIkjvbfvI3OOIeOXII7hQ.png"/></div></figure><p id="c0fe" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">或者，它可以表示为:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/923bef6c7f3a8de6f93bc1a38a775cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/format:webp/1*batIctifqK2LYGL9UqGHig.png"/></div></figure><p id="ed80" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">F统计量公式的分子和分母应该分开分析。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/510cf319d5cf48eb489dea73e8cf48e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*ST9pjoyO1-07or5jKWhQxg.png"/></div></figure><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/b8826d3c9e2476336ff487685b46af70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tvbMixdjHOxTiAhmM-H59w.png"/></div></div></figure><p id="7211" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里k是组的数量</p><p id="e997" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">n =观察次数</p><p id="46a8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">k =组数</p><p id="4f2c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">nj =每个单独组中的观察次数</p><p id="8abf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Sj =每个单独组的标准偏差</p><blockquote class="np"><p id="7b0e" class="nq nr jj bd ns nt nu nv nw nx ny mc dk translated">提醒一下，标准差的平方就是方差。</p></blockquote><p id="04d4" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">在继续讨论之前，让我们使用真实数据集，计算组间方差和组内方差，以便更清楚地理解它:</p><p id="8bda" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里我用R来计算。您可以使用任何其他编程语言，甚至excel。我在这次演示中使用的数据集是RStudio中的内置数据集。数据集的名称是“mtcars”。这些是数据集的列名:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="21b5" class="ms mt jj on b gy or os l ot ou">names(mtcars)</span></pre><p id="5d8e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="e003" class="ms mt jj on b gy or os l ot ou">[1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"  <br/>[10] "gear" "carb"</span></pre><p id="2a57" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里的“cyl”是一个分类变量，有三个唯一值4、6和8。在本文中，我们将检查不同“气缸”的平均“马力”或马力是否不同。</p><p id="1bbf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面是一个箱线图，提供了每个“气缸”的“hp”数据的初步概念:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="0c1d" class="ms mt jj on b gy or os l ot ou">boxplot(hp~cyl, data = mtcars, main = "hp by cyl",<br/>        xlab = "cyl", ylab = "hp")</span></pre><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/40bd5f636632589e6bdbd113a4e1a7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*jiMNgK6CJPAhcCQnWIRCYg.png"/></div></figure><p id="7f4e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从上面的图片我们可以找到一些信息。也就是说，“气缸8”似乎具有更高的值，但同时也具有更高的范围。4和6更接近，其中4具有较高的可变性，而6具有较低的可变性，带有一些异常值。</p><p id="f8cd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于组间方差和组内方差的计算，我们需要以下信息:</p><p id="23dc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">a.观察次数:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="bce4" class="ms mt jj on b gy or os l ot ou">nrow(mtcars)</span></pre><p id="7f9a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="ff49" class="ms mt jj on b gy or os l ot ou">32</span></pre><p id="6246" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">b.平均“hp”:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="6c08" class="ms mt jj on b gy or os l ot ou">mean(mtcars$hp)</span></pre><p id="d18f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="aee3" class="ms mt jj on b gy or os l ot ou">146.6875</span></pre><p id="d0ed" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">c.单个“气缸”组的平均“马力”:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="ec9d" class="ms mt jj on b gy or os l ot ou">mtcars %&gt;% group_by(cyl) %&gt;% summarise(mean(hp))</span></pre><p id="ed8b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/17528352c0678b437fd81af8a8801fb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*5cmLm0Vb2Sr5YDeB2kE2QQ.png"/></div></figure><p id="b9a3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">d.单个“气缸”组“hp”的标准偏差:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="3443" class="ms mt jj on b gy or os l ot ou">mtcars %&gt;% group_by(cyl) %&gt;% summarise(sd(hp))</span></pre><p id="7d22" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/67664be553c6892827cf42ae1e9436d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*7xeyXY9TcqHBSMOM8jrfBg.png"/></div></figure><p id="0905" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">e.每个“气缸”组的“hp”方差:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="e2ac" class="ms mt jj on b gy or os l ot ou">mtcars %&gt;% group_by(cyl) %&gt;% summarise(var(hp))</span></pre><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/e89f7757ff8ab11e4bc1634a5183a0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*kn7tU-VtM_FeYFMjMnLyLQ.png"/></div></figure><p id="7ad2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以下是(MSB)之间的均方误差和(MSW)内的均方误差的表达式:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/e960f80e03383c4d549409db0d04530b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*VHT8p0_RRedbXJv1AAUzPw.png"/></div></figure><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/458132e021ede1f34fcb6bff25faf143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*-saXTmOj_EF85rusr7ynaQ.png"/></div></figure><p id="e438" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">间均方和内均方分别为52008.23和1437.801。</p><h2 id="d3ba" class="ms mt jj bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj jp bi translated">推理</h2><p id="8957" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">对于推断，f检验是非常常见的，它是从方差分析表中得出的。这也称为全局测试。这个测试让你知道至少两组之间是否有显著差异。</p><p id="8f9e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">推论归结为三个常见步骤:</p><ol class=""><li id="aac8" class="pb pc jj lj b lk ll ln lo lq pd lu pe ly pf mc pg ph pi pj bi translated">设置零假设、替代假设和显著性水平。零假设是一种普遍的信念。在这种情况下，零假设是，所有类型的“气缸”的平均“马力”相等。我们将使用95%的置信度。这意味着显著性水平为0.05。</li></ol><p id="2148" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果我们找不到足够的证据来支持这一主张，我们将拒绝零假设，并接受替代假设。否则，我们将无法拒绝零假设。</p><p id="6007" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">另一个假设是，至少两组之间的均值存在差异。</p><p id="7090" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">2.从f分布中找出适当的值。你可以用F表找到它。但是我会用R来计算。因为R对我来说是可用的，用qf函数很容易计算R。您需要输入三个参数。置信水平和两个自由度。自由度为:k-1 = 3–1 = 2，n-k = 32–3 = 29。</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="a5c4" class="ms mt jj on b gy or os l ot ou">qf(0.95, 2, 29)</span></pre><p id="3258" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="4749" class="ms mt jj on b gy or os l ot ou">[1] 3.327654</span></pre><blockquote class="np"><p id="2324" class="nq nr jj bd ns nt pk pl pm pn po mc dk translated">如果F统计量大于或等于3.33，我们将拒绝零假设。</p></blockquote><p id="b967" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">3.计算F统计量</p><p id="c411" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是用于查找F统计量的通用ANOVA表:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pp"><img src="../Images/8d8408df385a6e722e0a87edb086a422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1EhcFhckJ8VdjE1ahxYwVA.png"/></div></div></figure><p id="5d1b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">请记住，在上一节中，我们已经计算了(MSB)之间的均方误差和(MSW)之内的均方误差。因此，我们可以像这样简单地计算F统计量:</p><p id="d48c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">f = MSB/MSW = 52008.23/1437.801 = 36.17</p><p id="b409" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">听着，F值比3.33高多了。所以，我们有足够的证据来拒绝零假设。这意味着所有类型的“气缸”的“马力”并不相同。至少有两个群体的手段是不同的。</p><h2 id="4284" class="ms mt jj bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj jp bi translated">评估各组之间的差异</h2><p id="73bb" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">在上一节中，我们评估了任意两组之间的均值是否存在差异。我们发现确实有。现在，你可能有兴趣知道哪些群体是完全不同的。</p><p id="ac00" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以确定我们需要对每一对进行测试。例如，这里有三组不同的“气缸”(4、6和8)。因此，一个测试是关于4和6的平均“hp ”,一个是关于6和8，一个是关于4和8。所以，会有三个测试。有一个公式可以确定需要多少次测试。</p><blockquote class="np"><p id="2cb5" class="nq nr jj bd ns nt nu nv nw nx ny mc dk translated">如果有k个组，测试次数将为k(k-1)/2</p></blockquote><p id="001b" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">像这样的多重比较测试的问题是我们有alpha*(k(k-1))/2的机会犯错误。</p><p id="1c58" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了控制测试中的错误数量，每次测试都应该有一个调整。一种非常流行的调整是Bonferroni调整，其中每个测试的显著性水平是(alpha/c)。这里c是总测试次数。</p><p id="0d01" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里将使用t-统计量来做这件事。</p><p id="f4eb" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">t统计量的公式如下:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/32eefeb9bd75e3e5cfb5fdbb808586d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*t3wYN2y4KUgRSKZBEf1N-A.png"/></div></figure><p id="addd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在我将使用R来完成剩下的测试。因为正如我前面提到的，我们现在必须进行几项测试。r的优秀功能使这项工作变得非常容易。</p><p id="8683" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">模型如下:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="a02f" class="ms mt jj on b gy or os l ot ou">mtcars$cyl = as.factor(mtcars$cyl)</span><span id="df3d" class="ms mt jj on b gy pr os l ot ou">m = aov(hp~cyl, data=mtcars)<br/>summary(m)</span></pre><p id="d3ae" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="7b20" class="ms mt jj on b gy or os l ot ou">            Df Sum Sq Mean Sq F value   Pr(&gt;F)    <br/>cyl          2 104031   52015   36.18 1.32e-08 ***<br/>Residuals   29  41696    1438                     <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></pre><p id="cd8c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">请注意，我必须将“cyl”列转换为一个因子。如果没有分组列作为因子，最终可能会在成对测试中产生一些错误。</p><blockquote class="np"><p id="3d65" class="nq nr jj bd ns nt nu nv nw nx ny mc dk translated">看上面的汇总表。之间的均方，内部的均方，F值和我们之前手动计算的差不多。</p></blockquote><p id="d64b" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">现在，可以像这样对所有对进行t检验:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="399d" class="ms mt jj on b gy or os l ot ou">pairwise.t.test(mtcars$hp, mtcars$cyl, p.adj = "bonferroni")</span></pre><p id="5abe" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="7362" class="ms mt jj on b gy or os l ot ou">Pairwise comparisons using t tests with pooled SD</span><span id="b347" class="ms mt jj on b gy pr os l ot ou">data:  mtcars$hp and mtcars$cyl</span><span id="c117" class="ms mt jj on b gy pr os l ot ou">   4       6      <br/>6 0.12    -      <br/>8 1.2e-08 8.7e-05</span><span id="482c" class="ms mt jj on b gy pr os l ot ou">P value adjustment method: bonferroni</span></pre><p id="4408" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你是第一次，可能会有点难以理解这里的表格。此表给出了所有对中差异的p值。组4和组6的p值为0.12，组4和组8的p值为1.2e-08，组6和组8的p值为8.7e-05。</p><p id="9c61" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">考虑到alpha水平为0.05，我们没有足够的证据证明“气缸4”和“气缸6”的平均“hp”相同。因为p值是0.12，大于p值。</p><p id="1a08" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">但有足够的证据来否定“第4缸”和第8缸的平均“马力”相同的观点。因为p值低于alpha级别。这对“气缸”6和8也是如此。</p><p id="048f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">还有另一个名为“TukeyHSD”的函数，它给出了每一对均值差异的置信区间以及p值。</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="ea5d" class="ms mt jj on b gy or os l ot ou">TukeyHSD(m)</span></pre><p id="6b8e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="90d6" class="ms mt jj on b gy or os l ot ou">Tukey multiple comparisons of means<br/>    95% family-wise confidence level</span><span id="80b6" class="ms mt jj on b gy pr os l ot ou">Fit: aov(formula = hp ~ cyl, data = mtcars)</span><span id="a041" class="ms mt jj on b gy pr os l ot ou">$cyl<br/>         diff       lwr       upr     p adj<br/>6-4  39.64935 -5.627454  84.92616 0.0949068<br/>8-4 126.57792 88.847251 164.30859 0.0000000<br/>8-6  86.92857 43.579331 130.27781 0.0000839</span></pre><p id="1ffb" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先可以看到差异，然后是置信区间的下限和上限，以及调整后的p值。由于校正方法不同，p值看起来略有不同。但推论是一样的。使用这里的p值，我们也必须拒绝“气缸4”和“气缸6”的平均“马力”相同的想法。因为p值为0.09，高于alpha级别0.05。</p><h2 id="62dd" class="ms mt jj bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj jp bi translated">针对另一个变量进行调整</h2><p id="c294" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">一直以来，我们只使用了一个响应变量和一个解释变量。现在我们来看看如何调整第二个响应变量。这个过程被称为单向变异。</p><p id="1be4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们将首先使用“car”包中的“Anova”函数来查看“disp”变量是否显著。它还将测试是否至少有一对“cyl”组具有不同的平均“hp”。</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="64eb" class="ms mt jj on b gy or os l ot ou">Anova(lm(hp~cyl+disp, data=mtcars), type=3)</span></pre><p id="122b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="3266" class="ms mt jj on b gy or os l ot ou">Anova Table (Type III tests)</span><span id="f26e" class="ms mt jj on b gy pr os l ot ou">Response: hp<br/>            Sum Sq Df F value    Pr(&gt;F)    <br/>(Intercept)  24897  1 16.8314 0.0003189 ***<br/>cyl          13143  2  4.4428 0.0210962 *  <br/>disp           280  1  0.1890 0.6670811    <br/>Residuals    41417 28                      <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></pre><p id="6bba" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你注意到“Anova”函数将线性回归模型作为一个参数。本文不涉及线性回归和方差分析之间的关系。那又是一个长时间的讨论。如果您有兴趣探索更多，请查看这篇文章，其中ANOVA表用于推断线性回归模型的信息:</p><div class="is it gp gr iu md"><a href="https://towardsdatascience.com/detail-explanation-of-simple-linear-regression-assessment-and-inference-with-anova-bb12ff4604d3" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">简单线性回归的详细解释，评估，和用ANOVA的推断</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">一步一步的讨论和例子，手动实现和R</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="ps l mo mp mq mm mr ja md"/></div></div></a></div><p id="c409" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在，让我们看看当“disp”变量被控制时，我们之前发现的成对差异将如何改变。“lsmeans”包中的“lsmeans”函数将用于:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="2144" class="ms mt jj on b gy or os l ot ou">lsmeans(lm(hp~cyl+disp, data=mtcars), pairwise~cyl, adjust="tukey")</span></pre><p id="e59b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">输出:</p><pre class="of og oh oi gt om on oo op aw oq bi"><span id="c7f4" class="ms mt jj on b gy or os l ot ou">$lsmeans<br/> cyl lsmean   SE df lower.CL upper.CL<br/> 4     90.2 20.9 28     47.4      133<br/> 6    125.1 15.9 28     92.5      158<br/> 8    201.9 19.8 28    161.3      242</span><span id="3f22" class="ms mt jj on b gy pr os l ot ou">Confidence level used: 0.95</span><span id="f02e" class="ms mt jj on b gy pr os l ot ou">$contrasts<br/> contrast estimate   SE df t.ratio p.value<br/> 4 - 6       -34.9 21.5 28 -1.625  0.2522 <br/> 4 - 8      -111.7 37.6 28 -2.967  0.0163 <br/> 6 - 8       -76.7 29.5 28 -2.603  0.0377</span><span id="9d7e" class="ms mt jj on b gy pr os l ot ou">P value adjustment: tukey method for comparing a family of 3 estimates</span></pre><p id="6349" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">注意每对的p值！他们变得多好啊！所有的p值都比以前大。像以前一样，对4，6的p值大于α水平0.05。所以平均“hp”在这里有很大的不同。但是4–8和6–8的p值比我们之前没有控制任何其他变量的ANOVA测试要大得多。它们仍然低于阿尔法水平0.05，我们将得出结论，我们无法拒绝4–8和6–8之间的平均“hp”相同的观点。</p><p id="1ec5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">但是，如果我们认为alpha水平为0.01，那么我们可以拒绝零假设或4-8和6-8对的平均“hp”相同的想法。因此，调整“disp”变量会显著改变结果。但这并不一定会一直发生。这就是为什么我们必须测试，看看会发生什么。</p><h2 id="26de" class="ms mt jj bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj jp bi translated">结论</h2><p id="d49d" class="pw-post-body-paragraph lh li jj lj b lk nk kt lm ln nl kw lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">仅仅通过查看三组的箱线图，一些人可能会得出均值不同的结论。或者只是计算数据的平均值，有些人可能会得出结论，它们是不同的。但是使用方差分析，你可能会看到一个不同的结果，就像这个例子。</p><p id="069d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这个想法是看你是否能把样本概括为总体均值，或者均值的差异是否显著。</p><p id="7446" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是统计学中一个流行且广泛使用的话题。希望对你有帮助！</p><p id="ee86" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">欢迎在推特上关注我，喜欢我的T2脸书页面。</p><h2 id="e7e9" class="ms mt jj bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj jp bi translated">更多阅读</h2><div class="is it gp gr iu md"><a href="https://medium.com/codex/complete-details-of-simple-logistic-regression-model-and-inference-in-r-eedb1c84b65f" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">R中简单逻辑回归模型和推论的完整细节</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">举例演示</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="pt l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a href="https://towardsdatascience.com/an-ultimate-data-visualization-course-in-python-for-free-12a5da0a517b" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">免费的Python终极数据可视化课程</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">学习比任何付费课程更多的可视化功能和技术</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="pu l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a href="https://towardsdatascience.com/detailed-guide-to-multiple-linear-regression-model-assessment-and-inference-in-r-146845067aa3" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">多元线性回归模型、评估和推理的详细指南</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">模型开发、解释、方差计算、f检验和t检验</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="pv l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a href="https://towardsdatascience.com/a-complete-beginners-guide-to-data-visualization-in-ggplot2-121f1eee23cd" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">ggplot2中数据可视化的完全初学者指南</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">这是一个丰富的图书馆。今天就开始使用吧</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="pw l mo mp mq mm mr ja md"/></div></div></a></div><div class="is it gp gr iu md"><a href="https://towardsdatascience.com/a-complete-k-mean-clustering-algorithm-from-scratch-in-python-step-by-step-guide-1eb05cdcd461" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">Python中从头开始的完整K均值聚类算法:分步指南</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">还有，如何使用K均值聚类算法对图像进行降维</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="px l mo mp mq mm mr ja md"/></div></div></a></div></div></div>    
</body>
</html>