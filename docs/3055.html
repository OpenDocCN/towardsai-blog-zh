<html>
<head>
<title>Beyond the Jupyter Notebooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超越朱庇特笔记本</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/beyond-the-jupyter-notebooks-24b6732a1a7b?source=collection_archive---------0-----------------------#2022-08-19">https://pub.towardsai.net/beyond-the-jupyter-notebooks-24b6732a1a7b?source=collection_archive---------0-----------------------#2022-08-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c8cd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用烧瓶在swift中部署您的模型</h2></div><p id="7197" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一名数据科学家，如果你经常发现自己在寻找关于<strong class="kh ir"> <em class="lb">“木星笔记本之后的下一步是什么？”</em> </strong> <em class="lb">，</em>你来对地方了，因为这正是本文要回答的问题。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/4b37dcfaf27fedee2d57d935e6d02dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VtiJmIrS8Q_HHUHo"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">照片由<a class="ae ls" href="https://unsplash.com/@alessandroerbetta?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚历山德罗·埃尔贝塔</a>在<a class="ae ls" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="e739" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我会假设任何阅读这篇文章的人都曾经对数据进行过一些基本分析，并建立了机器学习模型。我们永远不能忘记的一件事是:</p><blockquote class="lt"><p id="de00" class="lu lv iq bd lw lx ly lz ma mb mc la dk translated">数据科学的作用是从我们的数据中获得洞察力，并根据数据做出未来预测，以增加商业价值。</p></blockquote><p id="dd23" class="pw-post-body-paragraph kf kg iq kh b ki md jr kk kl me ju kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">为了实现这一目标，我们的Jupyter笔记本中构建的模型必须提供给相关的利益相关方进行决策。您的模型不仅仅意味着在您的PC中结束它们的生命周期。</p><p id="e416" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，你可能会问，<strong class="kh ir"> <em class="lb">“我们如何让他们使用它？”，</em> </strong>这就是模型部署的由来。</p><blockquote class="mi mj mk"><p id="a483" class="kf kg lb kh b ki kj jr kk kl km ju kn ml kp kq kr mm kt ku kv mn kx ky kz la ij bi translated">模型部署是将最终的机器学习模型发布到真实环境中的过程，在真实环境中，机器学习模型可以被充分利用以达到其预期目的</p></blockquote><p id="08f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">机器学习模型可以通过各种环境部署，并以应用程序编程接口(API)的形式可访问，该应用程序编程接口可以由诸如web、android等应用程序使用。</p><p id="47b9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">旁注:API是一组代码，它使两个软件组件能够相互交流</em></p><p id="318c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将向您展示如何使用Flask框架将简单的机器学习模型部署为API。到本文结束时，您将有足够的信息开始将您自己的模型部署到云中。</p><p id="06a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">喝杯咖啡，你会喜欢这篇文章的！</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><h2 id="ce76" class="mv mw iq bd mx my mz dn na nb nc dp nd ko ne nf ng ks nh ni nj kw nk nl nm nn bi translated">什么是烧瓶</h2><p id="d5fb" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">Flask是一个用python编写的轻量级框架，允许你开发web应用和API。它使用起来非常直观，初学者也很容易上手。</p><h2 id="546b" class="mv mw iq bd mx my mz dn na nb nc dp nd ko ne nf ng ks nh ni nj kw nk nl nm nn bi translated"><strong class="ak">项目策略</strong></h2><p id="1ebf" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">以下是我通过flask应用程序部署我的机器学习模型所遵循的步骤:</p><ul class=""><li id="2954" class="nt nu iq kh b ki kj kl km ko nv ks nw kw nx la ny nz oa ob bi translated">机器学习模型的保存</li><li id="6fd4" class="nt nu iq kh b ki oc kl od ko oe ks of kw og la ny nz oa ob bi translated">虚拟环境的创建</li><li id="3f90" class="nt nu iq kh b ki oc kl od ko oe ks of kw og la ny nz oa ob bi translated">开发烧瓶路线及其相关功能</li><li id="c2f4" class="nt nu iq kh b ki oc kl od ko oe ks of kw og la ny nz oa ob bi translated">完成并测试路线</li></ul><h2 id="8965" class="mv mw iq bd mx my mz dn na nb nc dp nd ko ne nf ng ks nh ni nj kw nk nl nm nn bi translated">模型保存</h2><p id="27d1" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">要开始，首先要保存您的模型。我们将使用<strong class="kh ir"><em class="lb">【pickle】</em></strong>python库来实现。出于演示的目的，我将使用我构建的模型来预测客户对电子商务公司营销活动的反应。这个项目的完整代码和实现可以在<a class="ae ls" href="https://github.com/hope205/Customers_Campaign_Response/blob/master/Final_Customer_Campaign.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/5b34e1cdc4c746302ccd5eec305448e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*7SM0tXeCd7XbIDLZtNv6Qw.png"/></div></figure><p id="e2a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用这几行代码来保存您的模型。<em class="lb">泡菜的第一个参数。dump </em>根据您为模型指定的名称接收模型名称。</p><h2 id="630e" class="mv mw iq bd mx my mz dn na nb nc dp nd ko ne nf ng ks nh ni nj kw nk nl nm nn bi translated">虚拟环境创建</h2><blockquote class="mi mj mk"><p id="6dd7" class="kf kg lb kh b ki kj jr kk kl km ju kn ml kp kq kr mm kt ku kv mn kx ky kz la ij bi translated">虚拟环境是包含应用程序所依赖的软件的目录</p></blockquote><p id="d763" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它有助于将我们的应用程序及其包包含在一个目录中，最重要的是，它防止我们的包版本与系统中的其他包冲突。我们可以使用<code class="fe oi oj ok ol b">virtualenv</code>包创建一个虚拟环境。你可以在这里阅读关于这个包<a class="ae ls" href="https://virtualenv.pypa.io/en/latest/" rel="noopener ugc nofollow" target="_blank">的更多信息</a></p><p id="8030" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用pip在您的系统上安装virtualenv</p><p id="f523" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe oi oj ok ol b">pip install virtualenv</code></p><p id="f533" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在项目目录中创建一个虚拟环境</p><p id="11d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe oi oj ok ol b">virtualenv env</code></p><p id="4dff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该命令将创建一个名为<strong class="kh ir"><em class="lb">“env”</em></strong>的虚拟环境。你可以使用任何你选择的名字，但是“env”是最常用的</p><p id="f667" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是激活您使用该命令创建的虚拟环境</p><p id="ad89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe oi oj ok ol b">env\Scripts\activate.bat</code></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi om"><img src="../Images/784373d6a84c27e425477201c76ff48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91cCuVkW_c0BumGSTkcFeg.png"/></div></div></figure><p id="7e84" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">注意:这个命令只对windows机器有效，如果你在mac上，使用这个命令</em></p><p id="b058" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe oi oj ok ol b">source env/bin/activate</code></p><p id="f43c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是安装python flask库和我们在这个新的虚拟环境中可能需要的其他库。我们将使用pip来安装它，方法是在我们的终端中输入以下命令</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi on"><img src="../Images/d032b33c0785bb5e547b9da4e2ac8615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGzRuyWS7pCeya5L2WBUMw.png"/></div></div></figure><p id="4bb7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">pip命令将把flask和其他包安装到虚拟环境中，然后您可以在您的项目中使用它们。</p><h2 id="ba93" class="mv mw iq bd mx my mz dn na nb nc dp nd ko ne nf ng ks nh ni nj kw nk nl nm nn bi translated">烧瓶体</h2><p id="23da" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">Haven安装了flask，打开了一个空白的python文件，让我们设置它工作。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="2294" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个基本的flask应用程序的样子。首先要做的是实例化flask对象，并将其赋给你选择的任何变量，但我们通常使用<strong class="kh ir"><em class="lb">【app】</em></strong>作为变量名。<strong class="kh ir"> <em class="lb"> "__name__" </em> </strong>表示应用程序包的名称，Flask用它来标识模板、静态资产和实例文件夹等资源。</p><p id="9400" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步我们要做的是确定路线。为了在烧瓶中定义路线，我们使用了<strong class="kh ir"><em class="lb">【app . route】</em></strong>装饰器，如下所示:</p><p id="b546" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe oi oj ok ol b">@app.route</code></p><blockquote class="lt"><p id="eda2" class="lu lv iq bd lw lx ly lz ma mb mc la dk translated">flask中的Routes用于将旨在执行任务的特定功能映射到可从网页访问的url。</p></blockquote><p id="3bbe" class="pw-post-body-paragraph kf kg iq kh b ki md jr kk kl me ju kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">简而言之，路由用于将您希望的一些操作连接到URL，这样无论用户何时通过URL访问该路由，输出都是函数的结果。</p><p id="699a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="53ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里发生的事情是，测试函数被映射到<strong class="kh ir"> <em class="lb"> "/test" </em> </strong>路由，这样每当用户访问“/test”端点，<strong class="kh ir"> <em class="lb"> "Ping模型A应用程序！!"屏幕上显示</em> </strong>。<strong class="kh ir"><em class="lb">【methods】</em></strong>参数接受所允许的HTTP请求类型列表。</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><p id="7c33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的下一步行动将是开发"<em class="lb">预测</em>"我们分配给"/predict "路线的功能。为了避免混乱并保证代码的可读性，我将在我的目录下创建一个名为<strong class="kh ir"> <em class="lb">【模型文件】</em> </strong> <em class="lb"> </em>的新文件夹。</p><p id="2ade" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该文件夹将包含:</p><ul class=""><li id="09f1" class="nt nu iq kh b ki kj kl km ko nv ks nw kw nx la ny nz oa ob bi translated">保存的模型</li><li id="242d" class="nt nu iq kh b ki oc kl od ko oe ks of kw og la ny nz oa ob bi translated"><em class="lb"/><strong class="kh ir"><em class="lb">【ml _ model . py】</em></strong>文件</li><li id="5906" class="nt nu iq kh b ki oc kl od ko oe ks of kw og la ny nz oa ob bi translated"><strong class="kh ir"><em class="lb">【init _ _】。py" </em> </strong>文件</li></ul><p id="8ca2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb"> "ml_model.py" </em>文件将包含预处理函数和预测函数。稍后，我将导入这些文件以在我的主flask应用程序中使用。</p><p id="4262" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我的文件的样子:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="bcfe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这背后的想法是把这个文件变成一个包，可以导入到我们的主flask应用程序。要将此文件夹打包，请创建一个新文件名<strong class="kh ir"><em class="lb">" _ _ init . py _ _ "</em></strong>，并将其留空。</p><h2 id="42be" class="mv mw iq bd mx my mz dn na nb nc dp nd ko ne nf ng ks nh ni nj kw nk nl nm nn bi translated">结束</h2><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oq"><img src="../Images/de04a5607e0ea79d4ae37dc166f92b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V2N7Mpe9S2BrfkdW"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">照片由<a class="ae ls" href="https://unsplash.com/@artbyhybrid?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">麦迪森·柳文欢</a>在<a class="ae ls" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="befd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个阶段，我们已经建立了两条路线，它们是<em class="lb">【测试】</em>和“预测”。<em class="lb"> "test" </em>路由允许的HTTP请求方法是get请求，而<em class="lb"> "predict" </em>路由允许的HTTP请求方法是post请求。</p><p id="637b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在的最后一步是开发我们在“predict”路径中定义的预测函数，使用<strong class="kh ir"><em class="lb">“model _ file”</em></strong>包接受数据、处理数据并返回预测。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="552b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是主文件的样子。我利用了我们通过导入包并调用它们而创建的函数。接下来要做的是启动flask服务器并在本地测试它。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi or"><img src="../Images/224686dba181ad2408c5526e89e9a97a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OTuCedtMAwEQPUk1WQv8tg.png"/></div></div></figure><p id="dc7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们现在尝试使用模型来进行预测</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi os"><img src="../Images/0ba39cbe1277f77ce500d642e59689f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGe0UwRjWeR2STspxUsDPg.png"/></div></div></figure><p id="b367" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在预测的路线上发出post请求，并传入我们的数据。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ot"><img src="../Images/eb589d4d028565913bccaad92e8fbc70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v077Y25vqrdeL4AT7_wS4Q.png"/></div></div></figure><p id="d714" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型返回的输出为1，这意味着该客户将对公司的营销活动做出回应。</p><h1 id="ad47" class="ou mw iq bd mx ov ow ox na oy oz pa nd jw pb jx ng jz pc ka nj kc pd kd nm pe bi translated">结论</h1><p id="8929" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">唷！您已经使用Flask成功部署了您的机器学习模型。在这个阶段，它仍然是本地的，只能在您的计算机上访问。在我的下一篇文章中，我将向您展示如何将flask应用程序部署到Heroku云平台，以便可以通过互联网访问它。</p><p id="5aab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个项目的文件可以从我的GitHub repo <a class="ae ls" href="https://github.com/hope205/Customers_Campaign_Response/tree/master/Flask" rel="noopener ugc nofollow" target="_blank">这里</a>获得</p><p id="48de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢所有激励我这样做的人。在<a class="ae ls" href="https://www.linkedin.com/in/hope-ogidan-82a6b31bb/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae ls" href="https://twitter.com/HopeOgidan" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系，看看我们能有多好的结合。</p></div></div>    
</body>
</html>