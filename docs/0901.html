<html>
<head>
<title>Campus Recruitment: EDA and Classification — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">校园招聘:EDA与分类——第二部分</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/campus-recruitment-eda-and-classification-part-2-ff8bdc634e7?source=collection_archive---------3-----------------------#2020-09-07">https://pub.towardsai.net/campus-recruitment-eda-and-classification-part-2-ff8bdc634e7?source=collection_archive---------3-----------------------#2020-09-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9b54" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="52eb" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">数据科学100天中的第15天</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/45a02b4816da7841b19b41c737958580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M6-_klTWhjMlUlz6"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@morningbrew?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">晨酿</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="7156" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">欢迎回到我的100天数据科学挑战之旅。在第15天，我在<a class="ae lh" href="https://www.kaggle.com/benroshan/factors-affecting-campus-placement" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上的校园招聘数据集上工作。</p><p id="f454" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在这里阅读我之前的部分:</p><div class="me mf gp gr mg mh"><a href="https://medium.com/towards-artificial-intelligence/campus-recruitment-eda-and-classification-part-1-ca07945f3e47" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jd gy z fp mm fr fs mn fu fw jc bi translated">校园招聘:EDA和分类—第一部分</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">数据科学100天的第13天和第14天</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv lb mh"/></div></div></a></div><p id="d16e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在第二部分，我将讨论以下主题:</p><h2 id="1fab" class="mw mx it bd my mz na dn nb nc nd dp ne lr nf ng nh lv ni nj nk lz nl nm nn iz bi translated">内容</h2><ul class=""><li id="7fa1" class="no np it lk b ll nq lo nr lr ns lv nt lz nu md nv nw nx ny bi translated">特征映射和附加特征生成</li><li id="a2f2" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">预测模型</li></ul></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="e42e" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated">概述</h1><p id="7a0d" class="pw-post-body-paragraph li lj it lk b ll nq kd ln lo nr kg lq lr ow lt lu lv ox lx ly lz oy mb mc md im bi translated">在最后一部分，我已经将问题陈述定义为“XYZ大学想要建立一个机器学习模型来知道一个学生是否会被安排。这样他们可以提供特别的关注，帮助他们找到工作，给定的数据集可以被视为一个分类或回归问题。在这个项目中，我将处理这个分类问题，任务是找到一个候选人是否会被安置。这是一个二元分类问题。”— <a class="ae lh" href="https://medium.com/towards-artificial-intelligence/campus-recruitment-eda-and-classification-part-1-ca07945f3e47" rel="noopener">校园招聘:EDA与分类—第一部分</a>。</p><p id="82d4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集有15个特征，但我们发现其中很少是我们的分析所不需要的。所以我要放弃他们。</p><p id="d647" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以让我们从去掉不需要的特性开始。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="7b2c" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated">特征映射和生成</h1><p id="addc" class="pw-post-body-paragraph li lj it lk b ll nq kd ln lo nr kg lq lr ow lt lu lv ox lx ly lz oy mb mc md im bi translated">正如上一节所提到的，让我们删除所有不需要的列。</p><ul class=""><li id="2900" class="no np it lk b ll lm lo lp lr oz lv pa lz pb md nv nw nx ny bi translated">SSC板</li><li id="a5af" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">HSC板</li><li id="df99" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">HSC专业化</li><li id="a4cb" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">学位类型</li><li id="491a" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">薪水</li></ul><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="c0d2" class="mw mx it pd b gy ph pi l pj pk">data.drop(['ssc_b','hsc_b', 'hsc_s', 'degree_t', 'salary'], axis=1, inplace=True)</span></pre><p id="73e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如前一部分所述，我们的数据具有一些类别值，例如，性别特征分别具有男性和女性的M值和F值。</p><p id="13fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们将分类特征映射到数字特征。</p><p id="2f49" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">分类特征是:</p><ul class=""><li id="646d" class="no np it lk b ll lm lo lp lr oz lv pa lz pb md nv nw nx ny bi translated"><strong class="lk jd">性别</strong>:性别特征有男性和女性价值。我将为男性映射0，为女性映射1。</li><li id="db8b" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated"><strong class="lk jd">工作经验</strong>:工作经验特性有“是”和“否”两个值。我将0映射为否，1映射为是。</li><li id="7b59" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated"><strong class="lk jd">状态</strong>:状态特性未放置和已放置值。同样，对于这些特征，我将0映射为未放置值，1映射为已放置值。</li><li id="9751" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated"><strong class="lk jd">专门化</strong>:专门化特征有两个值Mkt &amp; HR和Mkt &amp; Fin。我将把0映射到Mkt &amp; HR，把1映射到Mkt &amp; Fin。</li></ul><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="6988" class="mw mx it pd b gy ph pi l pj pk">data["gender"] = data.gender.map({"M":0,"F":1})<br/>data["workex"] = data.workex.map({"No":0, "Yes":1})<br/>data["status"] = data.status.map({"Not Placed":0, "Placed":1})<br/>data["specialisation"] = data.specialisation.map({"Mkt&amp;HR":0, "Mkt&amp;Fin":1})</span></pre><p id="f955" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们检查所有列。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="ef97" class="mw mx it pd b gy ph pi l pj pk">data.columns</span><span id="4207" class="mw mx it pd b gy pl pi l pj pk"># Output</span><span id="faa4" class="mw mx it pd b gy pl pi l pj pk">Index(['gender', 'ssc_p', 'hsc_p', 'degree_p', 'workex', 'etest_p',<br/>       'specialisation', 'mba_p', 'status'],<br/>      dtype='object')</span></pre><p id="e312" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">看看我们的最终数据。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="6b40" class="mw mx it pd b gy ph pi l pj pk">data.head()</span></pre><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="5281" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在让我们添加一些额外的功能。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="05ea" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated"><strong class="ak">附加特征生成</strong></h1><p id="665d" class="pw-post-body-paragraph li lj it lk b ll nq kd ln lo nr kg lq lr ow lt lu lv ox lx ly lz oy mb mc md im bi translated">让我们添加一些新功能。</p><ul class=""><li id="62d4" class="no np it lk b ll lm lo lp lr oz lv pa lz pb md nv nw nx ny bi translated">HSC和SSC百分比</li><li id="ef69" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">学位和HSC百分比</li><li id="0ee1" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">学位和SSC百分比</li><li id="1602" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">工商管理硕士和学位百分比</li><li id="cb23" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">工商管理硕士和就业测试百分比比率</li></ul><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="8cee" class="mw mx it pd b gy ph pi l pj pk"># Function to create additional features<br/>def new_features(df):<br/>    df['hsc_to_ssc'] = df['hsc_p'] / df['ssc_p']<br/>    df['degree_to_hsc'] = df['degree_p'] / df['hsc_p']<br/>    df['degree_to_ssc'] = df['degree_p'] / df['ssc_p']<br/>    df['mba_to_degree'] = df['mba_p'] / df['degree_p']<br/>    df['mba_to_etest'] = df['mba_p'] / df['etest_p']<br/>        <br/>    return df</span><span id="21dd" class="mw mx it pd b gy pl pi l pj pk">data = new_features(data)</span></pre></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="da5f" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated">模型预测法</h1><p id="07b5" class="pw-post-body-paragraph li lj it lk b ll nq kd ln lo nr kg lq lr ow lt lu lv ox lx ly lz oy mb mc md im bi translated">现在，我们的数据已经准备好了，可以准备模型来预测解决方案。有大量的预测算法可供尝试。在这个项目中，我将使用分类算法-K-最近邻、决策树、SVM、随机森林和高斯朴素贝叶斯。</p><p id="66af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我们需要导入所有需要的库。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="cef2" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># machine learning</em><br/>from sklearn.svm import SVC<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.neighbors import KNeighborsClassifier<br/>from sklearn.naive_bayes import GaussianNB<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import confusion_matrix, classification_report<br/>from sklearn import preprocessing</span></pre><p id="e81a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们将数据集分为训练数据和测试数据。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="c75e" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># Separating Features and Target</em><br/>X = data.copy().drop('status', axis=1)<br/>y = data['status']</span><span id="dd43" class="mw mx it pd b gy pl pi l pj pk"><em class="po"># scale each features</em><br/>X_scaled = preprocessing.scale(X)</span><span id="2e41" class="mw mx it pd b gy pl pi l pj pk"><em class="po">#Train Test Split</em><br/>X_train, X_test, Y_train, Y_test = train_test_split(X_scaled, y, test_size=0.3)<br/>X_train.shape, Y_train.shape, X_test.shape</span><span id="8154" class="mw mx it pd b gy pl pi l pj pk"># Output<br/>((150, 13), (150,), (65, 13))</span></pre><h1 id="f33f" class="ol mx it bd my om pp oo nb op pq or ne ki pr kj nh kl ps km nk ko pt kp nn ov bi translated"><strong class="ak"> KNN分类</strong></h1><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="af59" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># k-nearest neighbor</em><br/>knn = KNeighborsClassifier(n_neighbors = 3)<br/>knn.fit(X_train, Y_train)<br/>knn_Y_pred = knn.predict(X_test)<br/>knn_accuracy = knn.score(X_test, Y_test)<br/>knn_accuracy</span><span id="b97d" class="mw mx it pd b gy pl pi l pj pk"># Output<br/>0.8769230769230769</span></pre><p id="78d6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个混淆矩阵热图</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="5fcb" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># creating confusion matrix heatmap</em><br/><br/>conf_mat = confusion_matrix(Y_test, knn_Y_pred)<br/>fig = plt.figure(figsize=(10,7))<br/>group_names = ['True Neg','False Pos','False Neg','True Pos']<br/>group_counts = ["<strong class="pd jd">{0:0.0f}</strong>".format(value) for value <strong class="pd jd">in</strong><br/>                conf_mat.flatten()]<br/>labels = [f"<strong class="pd jd">{</strong>v1<strong class="pd jd">}\n{</strong>v2<strong class="pd jd">}</strong>" for v1, v2 <strong class="pd jd">in</strong> zip(group_names,group_counts)]<br/>labels = np.asarray(labels).reshape(2,2)<br/>sns.heatmap(conf_mat, annot=labels, annot_kws={"size": 16}, fmt='')<br/>plt.title("Confusion Matrix")<br/>plt.xlabel("Predicted Label")<br/>plt.ylabel("True Label")<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/a9eee0f4390756b5f483901778a8888b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*a-ie60PqUR9_kCySPd28sg.png"/></div></figure><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="9d96" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># getting precision, recall and f1-score via classification report</em><br/><br/>print(classification_report(Y_test, knn_Y_pred))</span><span id="729e" class="mw mx it pd b gy pl pi l pj pk"># Output</span><span id="4813" class="mw mx it pd b gy pl pi l pj pk">                 precision  recall  f1-score   support<br/><br/>           0       0.75      0.83      0.79        18<br/>           1       0.93      0.89      0.91        47<br/><br/>    accuracy                           0.88        65<br/>   macro avg       0.84      0.86      0.85        65<br/>weighted avg       0.88      0.88      0.88        65</span></pre></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="0f56" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated"><strong class="ak">决策树分类</strong></h1><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="7b2a" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># Decision Tree</em><br/><br/>decision_tree = DecisionTreeClassifier()<br/>decision_tree.fit(X_train, Y_train)<br/>decision_tree_Y_pred = decision_tree.predict(X_test)<br/>decision_tree_accuracy = decision_tree.score(X_test, Y_test)<br/>decision_tree_accuracy</span><span id="cb00" class="mw mx it pd b gy pl pi l pj pk"># Output</span><span id="97d7" class="mw mx it pd b gy pl pi l pj pk">0.8615384615384616</span></pre><p id="c772" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个混淆矩阵热图。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="3adc" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># creating confusion matrix heatmap</em><br/><br/>conf_mat = confusion_matrix(Y_test, decision_tree_Y_pred)<br/>fig = plt.figure(figsize=(10,7))<br/>group_names = ['True Neg','False Pos','False Neg','True Pos']<br/>group_counts = ["<strong class="pd jd">{0:0.0f}</strong>".format(value) for value <strong class="pd jd">in</strong><br/>                conf_mat.flatten()]<br/>labels = [f"<strong class="pd jd">{</strong>v1<strong class="pd jd">}\n{</strong>v2<strong class="pd jd">}</strong>" for v1, v2 <strong class="pd jd">in</strong> zip(group_names,group_counts)]<br/>labels = np.asarray(labels).reshape(2,2)<br/>sns.heatmap(conf_mat, annot=labels, annot_kws={"size": 16}, fmt='')<br/>plt.title("Confusion Matrix")<br/>plt.xlabel("Predicted Label")<br/>plt.ylabel("True Label")<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/210228547d5ef8fe3e21e6c834fce994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*q7zjtERsQ3Vj5ayHComp_w.png"/></div></figure><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="949d" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># getting precision, recall and f1-score via classification report</em><br/><br/>print(classification_report(Y_test, decision_tree_Y_pred))</span><span id="73d7" class="mw mx it pd b gy pl pi l pj pk">                  precision    recall  f1-score   support<br/><br/>           0       0.70      0.89      0.78        18<br/>           1       0.95      0.85      0.90        47<br/><br/>    accuracy                           0.86        65<br/>   macro avg       0.82      0.87      0.84        65<br/>weighted avg       0.88      0.86      0.87        65</span></pre></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="600a" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated"><strong class="ak">支持向量机</strong></h1><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="0bf7" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># Support Vector Machine</em><br/>svc = SVC()<br/>svc.fit(X_train, Y_train)<br/>svm_Y_pred = svc.predict(X_test)<br/>svc_accuracy = svc.score(X_test, Y_test)<br/>svc_accuracy</span><span id="2094" class="mw mx it pd b gy pl pi l pj pk"># Output<br/>0.8615384615384616</span></pre><p id="770c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个混淆矩阵热图。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="66cb" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># creating confusion matrix heatmap</em><br/><br/>conf_mat = confusion_matrix(Y_test, svm_Y_pred)<br/>fig = plt.figure(figsize=(10,7))<br/>group_names = ['True Neg','False Pos','False Neg','True Pos']<br/>group_counts = ["<strong class="pd jd">{0:0.0f}</strong>".format(value) for value <strong class="pd jd">in</strong><br/>                conf_mat.flatten()]<br/>labels = [f"<strong class="pd jd">{</strong>v1<strong class="pd jd">}\n{</strong>v2<strong class="pd jd">}</strong>" for v1, v2 <strong class="pd jd">in</strong> zip(group_names,group_counts)]<br/>labels = np.asarray(labels).reshape(2,2)<br/>sns.heatmap(conf_mat, annot=labels, annot_kws={"size": 16}, fmt='')<br/>plt.title("Confusion Matrix")<br/>plt.xlabel("Predicted Label")<br/>plt.ylabel("True Label")<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/210228547d5ef8fe3e21e6c834fce994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*q7zjtERsQ3Vj5ayHComp_w.png"/></div></figure><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="42ba" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># getting precision, recall and f1-score via classification report</em><br/><br/>print(classification_report(Y_test, svm_Y_pred))</span><span id="ea5e" class="mw mx it pd b gy pl pi l pj pk">precision    recall  f1-score   support<br/><br/>           0       0.70      0.89      0.78        18<br/>           1       0.95      0.85      0.90        47<br/><br/>    accuracy                           0.86        65<br/>   macro avg       0.82      0.87      0.84        65<br/>weighted avg       0.88      0.86      0.87        65</span></pre><h1 id="393f" class="ol mx it bd my om pp oo nb op pq or ne ki pr kj nh kl ps km nk ko pt kp nn ov bi translated"><strong class="ak">随机森林</strong></h1><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="37d2" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># Random Forest</em><br/><br/>random_forest = RandomForestClassifier(n_estimators=1000)<br/>random_forest.fit(X_train, Y_train)<br/>random_forest_Y_pred = random_forest.predict(X_test)<br/>random_forest.score(X_train, Y_train)<br/>random_forest_accuracy = random_forest.score(X_test, Y_test)<br/>random_forest_accuracy</span><span id="0489" class="mw mx it pd b gy pl pi l pj pk"># Output<br/>0.8461538461538461</span></pre><p id="1cc4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建混淆矩阵热图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/288a6f16ecb00f018abe0fdb2567178d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*Q3208RudkVtLtEz6zmfdAw.png"/></div></figure><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="58b5" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># getting precision, recall and f1-score via classification report</em><br/><br/>print(classification_report(Y_test, random_forest_Y_pred))</span><span id="73a2" class="mw mx it pd b gy pl pi l pj pk"># Output</span><span id="87bc" class="mw mx it pd b gy pl pi l pj pk">precision    recall  f1-score   support<br/><br/>           0       0.68      0.83      0.75        18<br/>           1       0.93      0.85      0.89        47<br/><br/>    accuracy                           0.85        65<br/>   macro avg       0.81      0.84      0.82        65<br/>weighted avg       0.86      0.85      0.85        65</span></pre></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="3c26" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated"><strong class="ak">高斯朴素贝叶斯</strong></h1><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="69a0" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># Gaussian Naive Bayes</em></span><span id="ffd1" class="mw mx it pd b gy pl pi l pj pk">gaussian = GaussianNB()<br/>gaussian.fit(X_train, Y_train)<br/>gaussian_Y_pred = gaussian.predict(X_test)<br/>gaussian_accuracy = gaussian.score(X_test, Y_test)<br/>gaussian_accuracy</span><span id="acf5" class="mw mx it pd b gy pl pi l pj pk"># Output<br/>0.8153846153846154</span></pre><p id="4d92" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个混淆矩阵热图。</p><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="494e" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># creating confusion matrix heatmap</em><br/><br/>conf_mat = confusion_matrix(Y_test, gaussian_Y_pred)<br/>fig = plt.figure(figsize=(10,7))<br/>group_names = ['True Neg','False Pos','False Neg','True Pos']<br/>group_counts = ["<strong class="pd jd">{0:0.0f}</strong>".format(value) for value <strong class="pd jd">in</strong><br/>                conf_mat.flatten()]<br/>labels = [f"<strong class="pd jd">{</strong>v1<strong class="pd jd">}\n{</strong>v2<strong class="pd jd">}</strong>" for v1, v2 <strong class="pd jd">in</strong> zip(group_names,group_counts)]<br/>labels = np.asarray(labels).reshape(2,2)<br/>sns.heatmap(conf_mat, annot=labels, annot_kws={"size": 16}, fmt='')<br/>plt.title("Confusion Matrix")<br/>plt.xlabel("Predicted Label")<br/>plt.ylabel("True Label")<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/920a45b6ed5157c2bd6be516ac5e43e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*t3pdGk-GrzPuUtuEWFRdXQ.png"/></div></figure><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="357a" class="mw mx it pd b gy ph pi l pj pk"><em class="po"># getting precision, recall and f1-score via classification report</em><br/><br/>print(classification_report(Y_test, gaussian_Y_pred))</span><span id="6f49" class="mw mx it pd b gy pl pi l pj pk"># Output</span><span id="374d" class="mw mx it pd b gy pl pi l pj pk">                precision    recall  f1-score   support<br/><br/>           0       0.62      0.83      0.71        18<br/>           1       0.93      0.81      0.86        47<br/><br/>    accuracy                           0.82        65<br/>   macro avg       0.78      0.82      0.79        65<br/>weighted avg       0.84      0.82      0.82        65</span></pre><p id="c768" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们来比较一下各个模型的精度。</p><h1 id="4924" class="ol mx it bd my om pp oo nb op pq or ne ki pr kj nh kl ps km nk ko pt kp nn ov bi translated"><strong class="ak">最佳表现车型</strong></h1><pre class="ks kt ku kv gt pc pd pe pf aw pg bi"><span id="f005" class="mw mx it pd b gy ph pi l pj pk">models = pd.DataFrame({<br/>    'Model': ['Support Vector Machines', 'KNN', 'Decision Tree','Random Forest', 'Gaussian Naive Bayes'],<br/>    'Score': [svc_accuracy, knn_accuracy, decision_tree_accuracy, random_forest_accuracy, gaussian_accuracy]})<br/>models.sort_values(by='Score', ascending=False)</span></pre><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="5943" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">KNN是性能最好的算法，准确率为87.69%。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="aaf8" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated">最后的话</h1><p id="c6b6" class="pw-post-body-paragraph li lj it lk b ll nq kd ln lo nr kg lq lr ow lt lu lv ox lx ly lz oy mb mc md im bi translated">我希望这篇文章对你有帮助。我尝试用数据科学来回答几个问题。还有很多问题要问。现在，明天我将转向另一个数据集。所有数据分析和可视化的代码都可以在这个<a class="ae lh" href="https://github.com/themlphdstudent/100DaysofDataScience" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>或者<a class="ae lh" href="https://www.kaggle.com/themlphdstudent/campus-recruitment-eda-classification" rel="noopener ugc nofollow" target="_blank"> Kaggle内核</a>中找到。</p><p id="3b2a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">感谢阅读。</strong></p><p id="aa79" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我感谢任何反馈。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><h1 id="a3fb" class="ol mx it bd my om on oo nb op oq or ne ki os kj nh kl ot km nk ko ou kp nn ov bi translated">100天的数据科学进步</h1><div class="me mf gp gr mg mh"><a href="https://towardsdatascience.com/analysing-and-visualising-the-country-wise-population-from-1955-to-2020-with-pandas-matplotlib-70b3614eed6b" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jd gy z fp mm fr fs mn fu fw jc bi translated">用熊猫分析和可视化1955年至2020年的乡村人口</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">100天数据科学的第1、2、3天。</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="pv l ms mt mu mq mv lb mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://towardsdatascience.com/box-office-revenue-analysis-and-visualization-ce5b81a636d7" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jd gy z fp mm fr fs mn fu fw jc bi translated">票房收入分析和可视化</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">数据科学100天的第4天和第5天</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="pw l ms mt mu mq mv lb mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://towardsdatascience.com/world-population-from-1955-to-2020-bar-chart-race-166ff307c48e" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jd gy z fp mm fr fs mn fu fw jc bi translated">从1955年到2020年的世界人口条形图竞赛</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">数据科学100天的第6天</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="px l ms mt mu mq mv lb mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://medium.com/python-in-plain-english/data-analysis-and-visualization-using-pandas-matplotlib-and-seaborn-5bc27e8d00c3" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jd gy z fp mm fr fs mn fu fw jc bi translated">使用Pandas、Matplotlib和Seaborn进行数据分析和可视化</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">数据科学100天的第7天和第8天(印度人民院选举的印度候选人名单)</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="py l ms mt mu mq mv lb mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://medium.com/towards-artificial-intelligence/campus-recruitment-eda-and-classification-part-1-ca07945f3e47" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jd gy z fp mm fr fs mn fu fw jc bi translated">校园招聘:EDA和分类—第一部分</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">数据科学100天的第13天和第14天</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv lb mh"/></div></div></a></div></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="5695" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你喜欢我的工作并想支持我，我会非常感谢你在我的社交媒体频道上关注我:</p><ul class=""><li id="1f47" class="no np it lk b ll lm lo lp lr oz lv pa lz pb md nv nw nx ny bi translated">支持我的最好方式就是在<a class="ae lh" href="https://towardsdatascience.com/@themlphdstudent" rel="noopener" target="_blank"> <strong class="lk jd">中</strong> </a>上关注我。</li><li id="7a30" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">订阅我的新<a class="ae lh" href="https://www.youtube.com/c/themlphdstudent" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> YouTube频道</strong> </a>。</li><li id="8bdf" class="no np it lk b ll nz lo oa lr ob lv oc lz od md nv nw nx ny bi translated">在我的<a class="ae lh" href="http://eepurl.com/hampwT" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">邮箱列表</strong> </a>报名。</li></ul></div></div>    
</body>
</html>