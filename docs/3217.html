<html>
<head>
<title>Airflow is on the Cloud | ELT Pipeline Orchestration With Airflow &amp; AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">气流在云上| ELT管道与气流和AWS的协调</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/airflow-is-on-the-cloud-elt-pipeline-orchestration-with-airflow-aws-4d4268e5321a?source=collection_archive---------1-----------------------#2022-10-15">https://pub.towardsai.net/airflow-is-on-the-cloud-elt-pipeline-orchestration-with-airflow-aws-4d4268e5321a?source=collection_archive---------1-----------------------#2022-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f099d8bcf6fcee375db7f3849a44dfed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hQvL1RiKOtsk5O4Y60tNQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">詹姆斯·惠勒摄影:<a class="ae kf" href="https://www.pexels.com/photo/symmetrical-photography-of-clouds-covered-blue-sky-1486974/" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/photo/symmetric-photography-of-clouds-covered-blue-sky-1486974/</a></figcaption></figure><p id="ff6d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你会看到<strong class="ki iu">带气流编排的ELT管道</strong>。</p><p id="5028" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将学习直接从<strong class="ki iu"> AWS S3 </strong>向<strong class="ki iu">PostgreSQL</strong>数据库加载数据。你要用码头集装箱做所有的事情。</p><p id="3113" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将学习如何使用<strong class="ki iu"> Airflow XCom </strong>在不同任务之间进行通信。</p><p id="be65" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你将从S3 AWS下载文件。</p><p id="234d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将上传文件到<strong class="ki iu"> AWS S3 </strong>。</p><p id="d273" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将使用<strong class="ki iu"> <em class="le"> Bash操作符</em> </strong>，<strong class="ki iu"> <em class="le"> Python操作符</em> </strong>，<strong class="ki iu"> <em class="le">任务装饰器</em> </strong>，以及其他<strong class="ki iu"> <em class="le">气流</em> </strong>功能。</p><p id="79bd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将获得数据，将其加载到<strong class="ki iu"> <em class="le"> PostgreSQL </em> </strong>数据库，并在几分钟内通过<strong class="ki iu"> pgAdmin </strong>查看。</p><p id="f043" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们开始吧。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="6a12" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">内容</h1><p id="2173" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated"><a class="ae kf" href="#96a6" rel="noopener ugc nofollow"> <strong class="ki iu">简介</strong> </a></p><p id="434f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="#6f43" rel="noopener ugc nofollow"> <strong class="ki iu">上传文件到S3 </strong> </a></p><p id="e158" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="#899b" rel="noopener ugc nofollow"> <strong class="ki iu">从S3下载文件</strong> </a></p><p id="39ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="#7b69" rel="noopener ugc nofollow"> <strong class="ki iu">不同任务之间用气流XCOM </strong> </a>进行交流</p><p id="fed3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="#ce32" rel="noopener ugc nofollow"> <strong class="ki iu">将PostgreSQL连接到AWS S3 &amp; ELT管道</strong> </a></p><p id="b1d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="#1712" rel="noopener ugc nofollow"> <strong class="ki iu">结论</strong> </a></p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="96a6" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">介绍</h1><p id="3ee9" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">" Airflow是一个由社区创建的平台，用于以编程方式创作、调度和监控工作流."(<a class="ae kf" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank">https://airflow.apache.org/</a>)</p><p id="160c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">气流是最著名的工作编排工具之一。</p><p id="321c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/towards-artificial-intelligence/lets-orchestrate-with-airflow-step-by-step-airflow-implementations-8100d8fe58b0" rel="noopener"> <strong class="ki iu">在上一篇文章</strong> </a>中，我们讨论了循序渐进的<strong class="ki iu">气流</strong>实现。</p><p id="bab9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我们将介绍云上的<strong class="ki iu">气流</strong>实现，尤其是在<strong class="ki iu"> AWS </strong>上。</p><p id="6f82" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<a class="ae kf" href="https://medium.com/towards-artificial-intelligence/you-can-install-airflow-with-docker-in-minutes-66a3de44374f" rel="noopener"> <strong class="ki iu">气流Docker Lite安装</strong> </a>。</p><p id="1d96" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅:我们将从数据源获取数据，并将其放入一个<strong class="ki iu"> AWS S3 </strong>桶中。</p><p id="5f29" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅:我们将从AWS S3 桶中下载数据。</p><p id="5819" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅我们将学习用<strong class="ki iu"> Airflow XCom </strong>在不同的任务之间进行交流。</p><p id="29b7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅我们将从<strong class="ki iu"> AWS S3 </strong>桶、<strong class="ki iu"> <em class="le"> </em> </strong>中读取数据，将其加载到<strong class="ki iu"> <em class="le"> PostgreSQL </em> </strong>数据库中，并用<strong class="ki iu"> <em class="le"> pgAdmin </em> </strong>查看。</p><p id="3bba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们开始吧。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="6f43" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">将文件上传到AWS S3 —提取并加载到DATALAKE</h1><p id="27a0" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">在本教程中，我们将使用<strong class="ki iu"> <em class="le"> TLC记录黄色出租车的行程</em> </strong>。</p><p id="0287" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">黄色和绿色出租车行程记录包括捕捉上下车日期/时间、上下车位置、行程距离、分项费用、费率类型、付款类型和驾驶员报告的乘客数量的字段(<a class="ae kf" href="https://www1.nyc.gov/site/tlc/about/tlc-trip-record-data.page" rel="noopener ugc nofollow" target="_blank">参考链接</a>)</p><p id="4be7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将实现<strong class="ki iu"> ELT管线</strong>的<strong class="ki iu"> EL </strong>部分。</p><p id="0df3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将获得2022年1月黄色出租车出行记录。</p><p id="e591" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并将数据加载到S3自动气象站的数据湖。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/392cb325bac2238e82c8799436b0337f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/0*9MCvh-vYJ8zw13Hk.PNG"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://aws.amazon.com/big-data/what-is-a-data-lake/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/big-data/what-is-a-data-lake/</a></figcaption></figure><p id="364c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们将获得一个新的S3桶作为目的地。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/4d427d2bab0833e38bf8e3ea6f0516b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W1MZcMU4AAPjQ1rY1X4hMQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="8a0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用“气流-介质-s3”桶作为我们的数据湖点。</p><p id="9c7f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以转到气流方面。</p><p id="9500" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我假设您遵循了<a class="ae kf" href="https://medium.com/towards-artificial-intelligence/you-can-install-airflow-with-docker-in-minutes-66a3de44374f" rel="noopener"> <strong class="ki iu"> Airflow Docker Lite安装</strong> </a> <strong class="ki iu"> </strong>并且Airflow容器正常运行。</p><p id="f651" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要为S3自动气象站添加一个新的连接。这样，气流可以连接到自动气象站S3桶。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/bc2438f1f8ac84b0b13a8ff96a3ece10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YM3NlJvzy7sXdi9yqJk-AQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="c278" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">选择连接后，我们将提供以下信息。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/0cad0be5108942157fc6261e287e58b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6Ggs54HzZYPyvZBR91PxQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="70f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将在DAG上使用连接ID。<br/>你需要提供你的AWS证书。</p><p id="915a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">🛑在保存它之前，<strong class="ki iu">测试你的连接</strong>。在连接上获得绿灯后，保存您的连接。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mx"><img src="../Images/17787f23d1c6d1401069d07b8165af51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mi-kBLNQ8TTVWUNdbp4q1A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="2d46" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好的。我们有AWS连接。</p><p id="4d60" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们为AWS S3存储桶和文件名定义变量。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/2aa05ee7c645a881bb33dc9ca5714a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQnjFl_U0gXa2lYqMcPKaQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="75dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">单击变量后，我们将提供以下信息。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/67041a275a6e2146f0a987f060b85767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvFSUlEFKCmS1T7aq60WrQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="0318" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将在DAG上使用密钥和存储段名称以及S3密钥。</p><p id="aaae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">🛑 <strong class="ki iu"> s3_key </strong>:数据湖上的文件名。在我们的案例中，我们给出了'<strong class="ki iu"><em class="le">Trip/Trip _ 2022 _ 01 . parquet</em></strong>'。如果没有Trip文件夹，我们的bucket上也没有任何东西，首先，它会创建一个文件夹，然后将这个文件放入trip_2022_01.parquet。</p><p id="2f10" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经准备好编写Python函数来将数据加载到AWS S3。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/306d8aa8c833ed45e211ff1410d0f52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPuxCJj4h9063VQg744kXA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="e409" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅ <strong class="ki iu"> S3_VAR </strong>:我们会得到变量信息。</p><p id="1f8f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅ <strong class="ki iu"> s3_hook </strong>:连接AWS S3。它将使用我们之前定义的“s3_upload”命名连接。</p><p id="b517" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅ <strong class="ki iu"> s3_hook.load_file </strong>:我们本地文件夹的第一个文件名。然后S3桶上的文件名。最后还有S3斗名(<a class="ae kf" href="https://airflow.apache.org/docs/apache-airflow/1.10.6/_modules/airflow/hooks/S3_hook.html#S3Hook" rel="noopener ugc nofollow" target="_blank">参考链接</a>)。</p><p id="2f31" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们完成DAG并运行它。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/ce325feb64508e1f3192861f537e4d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuQYfB6nz78kfqsYd9B_og.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="1343" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们转到Airflow GUI，查看DAG的操作。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/8c8290cb386afe60e0f5a3e03b8f208c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YmfU51C5UxXsCd5yhI_Qw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/903c7d2359e9934e0fff277239e2f2eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7CAkoKtC9MTEkzP9_I21_g.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="7f6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据日志，气流将任务标记为成功。</p><p id="7482" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看自动气象站S3站的档案。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/3a8de90010b9bb2a5fe28d52f2fbf9c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_0V-MscDmqQ7TBaq0RYQVg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="03a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们之前所讨论的，我们有一个新的<strong class="ki iu"> Trip </strong>文件夹，其中有<strong class="ki iu"> trip_2022_01.parquet </strong>文件。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="899b" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">从S3自动气象站下载文件</h1><p id="0102" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">让我们从AWS S3下载一个带有气流工作编排的文件。</p><p id="5a0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果容器上有拼花文件，请从容器中取出拼花文件。(作为复习，你可以看看<a class="ae kf" href="https://medium.com/towards-artificial-intelligence/lets-orchestrate-with-airflow-step-by-step-airflow-implementations-8100d8fe58b0" rel="noopener"> <strong class="ki iu">上一篇文章</strong> </a>，看看如何从气流容器中移除文件)</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/1c041ee4181e96f22709a838c614972d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cdCqAODLwYO9TH9vbkpwhg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="9456" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们删除了parquet文件，准备从AWS S3下载。</p><p id="00a8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们编写Python任务装饰器。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/2aa3aa94085976131e31fc5969873311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*URnAG5mHa5EPfdtmruvrig.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="35de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">✅<strong class="ki iu">s3 _ hook . download _ file</strong>:AWS S3上的第一个文件名，然后是S3桶名，最后是容器上的本地路径(<a class="ae kf" href="https://airflow.apache.org/docs/apache-airflow/1.10.6/_modules/airflow/hooks/S3_hook.html#S3Hook" rel="noopener ugc nofollow" target="_blank">引用链接</a>)。</p><p id="eb37" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们启动DAG，看看它的运行情况。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/8d7336b910b491b72160e6a79c16fd93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*-Kk99Wfx6wuhlDswtAYuGw.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="87da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们成功了。</p><p id="f5e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们转到终端，查看本地路径和下载的文件。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/b5ace96bc032750894f3d57418fc8fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QjX6YlEukxzHOzTJnrbdw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="9d15" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经下载了文件，但有些有趣的东西。</p><p id="0cd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">气流给了它一个随意的名字。</p><p id="e022" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们必须找到解决办法。</p><h1 id="7b69" class="lm ln it bd lo lp nj lr ls lt nk lv lw lx nl lz ma mb nm md me mf nn mh mi mj bi translated">使用Airflow XCom在不同任务之间进行通信</h1><p id="74f2" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">在找到这个问题的解决方案之前，让我们先简单提一下<strong class="ki iu"> XCom </strong>。</p><p id="f3fb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">XComs(“交叉通信”的缩写)是一种机制，<strong class="ki iu">让任务彼此对话</strong>，默认情况下，任务是完全隔离的，可能运行在完全不同的机器上。</p><p id="dbeb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">XCom由一个<code class="fe no np nq nr b">key</code>(本质上是它的名字)以及它来自的<code class="fe no np nq nr b">task_id</code>和<code class="fe no np nq nr b">dag_id</code>来标识。它们可以有任何(可序列化的)值，但它们只是为少量数据设计的；不要用它们来传递大值，比如data frames”(<a class="ae kf" href="https://airflow.apache.org/docs/apache-airflow/stable/concepts/xcoms.html" rel="noopener ugc nofollow" target="_blank">参考链接</a>)。</p><p id="8d97" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好的。让我们在XCom的帮助下解决这个问题。</p><p id="e442" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们看看气流文档，以找到任何解决方案。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/618e04ef3f046abfe166a49ea2a926f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ADrlrUcov6Y8JLOh-iF53g.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://airflow.apache.org/docs/apache-airflow/1.10.6/_modules/airflow/hooks/S3_hook.html#S3Hook" rel="noopener ugc nofollow" target="_blank">https://air flow . Apache . org/docs/Apache-air flow/1 . 10 . 6/_ modules/air flow/hooks/S3 _胡克. html#S3Hook </a></figcaption></figure><p id="b564" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">没有关于重命名文件的内容。</p><p id="f676" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们必须找到解决办法。</p><p id="92c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们删除下载的文件并重新开始。</p><p id="8029" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<strong class="ki iu"> Bash操作符</strong>来重命名下载的文件。</p><p id="1d8d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们编写Bash操作符任务。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/971b39feb61696794f36d8f27cb95b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0Nf8FiueLtU2ZWNGMJdiQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="a03d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<strong class="ki iu"> mv -f </strong>命令来重命名文件。</p><p id="54fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将用<strong class="ki iu"> XCom </strong>从Python函数中获取下载的文件名。</p><p id="b323" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们给文件起一个名字。</p><p id="17aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们一起来看两个任务。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/d5db3f6515f765a3eef65695fd53c860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KvFGJgkwftkHW-TSol3gZA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="10f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们运行DAG，看看它的运行情况。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/865dbaf7b90eae909604b38cbf326972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W1aZVaeBJ-NKBfBwPDMzog.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="b4f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们成功了。</p><p id="0545" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看集装箱上的文件。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/af27e34b728a7c1a4362449684de352b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlG217r9iPqa9ZGCuVjh-A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="7890" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">恭喜你。我们有一个重命名的文件。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="ce32" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">将POSTGRESQL连接到AWS S3存储桶和ELT管道</h1><p id="a490" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">在本文的最后一部分，我们将完成<strong class="ki iu"> ELT管道</strong>的最后一部分。</p><p id="c8e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将从AWS S3获取数据，并将其转换和加载到PostgreSQL数据库。</p><p id="5d7a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经完成了管道的EL部分。</p><p id="7043" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<strong class="ki iu"> Bash操作符，</strong>我们提取数据。</p><p id="2ed0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<strong class="ki iu"> Python任务装饰器</strong>，我们将数据加载到<strong class="ki iu">数据湖</strong>、<strong class="ki iu"> AWS S3 </strong>。</p><p id="41b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是时候转换数据并将其加载到PostgreSQL数据库中，然后用pgAdmin查看它了。</p><p id="38f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们写最后的任务。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nx"><img src="../Images/e3ad033f5f98735cfcd1797101f979c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aSTjL97FGt0NVQ_1YIRbvg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="7ea7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经在<a class="ae kf" href="https://medium.com/towards-artificial-intelligence/lets-orchestrate-with-airflow-step-by-step-airflow-implementations-8100d8fe58b0" rel="noopener"> <strong class="ki iu">前一篇</strong> </a>中讨论了DAG的某些部分。</p><p id="8acf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我没有对数据进行任何更改/转换。您可以随意使用这些数据，并在将其放入PostgreSQL数据库之前进行相关的转换。</p><p id="132a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看S3连接部分。</p><p id="fb07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有一个S3钩子，我们得到了带有<strong class="ki iu"> s3_hook.get_key </strong>的S3对象。</p><p id="3221" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它返回一个<strong class="ki iu"> boto3.s3.Object </strong> ( <a class="ae kf" href="https://airflow.apache.org/docs/apache-airflow/1.10.6/_modules/airflow/hooks/S3_hook.html#S3Hook" rel="noopener ugc nofollow" target="_blank">引用链接</a>)。</p><p id="45bd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> object.download_fileobj </strong>:接受可写对象。文件对象必须以二进制模式打开，而不是文本模式(<a class="ae kf" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/s3-example-download-file.html" rel="noopener ugc nofollow" target="_blank">引用链接</a>)。我们可以在<strong class="ki iu"> Python IO模块</strong>的帮助下满足这个条件。</p><p id="6755" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看看任务的运行情况。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ny"><img src="../Images/d91e85a56d608b28cc3bd7c692f84e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wm2iedwEw3gYhBeTYJ07Dg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="2c6c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们成功了。</p><p id="9dae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，让我们看看<strong class="ki iu"> pgAdmin </strong>。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/cabd4920201e19e1ac765a1ae513acb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r1mIhFE3gbfjlAYmUxE1-w.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">作者捕获的图像</figcaption></figure><p id="be7b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">干得好。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/bcfeb155f663b68dbdca83e28b6255cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*w19cSsZLTG-xjB9Y"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">图片来源:<a class="ae kf" href="https://giphy.com/" rel="noopener ugc nofollow" target="_blank">https://giphy.com/</a></figcaption></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="1712" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">结论</h1><p id="d0bc" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">在本文中，我们讨论了<strong class="ki iu"> ELT管道</strong>与<strong class="ki iu">气流</strong>和<strong class="ki iu"> AWS </strong>的编排。</p><p id="d84f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们从数据源获取数据，并将其放入AWS S3桶中。</p><p id="0882" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们从<strong class="ki iu"> AWS S3 </strong>桶下载数据。</p><p id="4647" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们研究了如何使用<strong class="ki iu"> Airflow XCom </strong>在不同任务之间进行通信。</p><p id="a631" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们从<strong class="ki iu"> AWS S3 </strong>桶、<strong class="ki iu"> <em class="le"> </em> </strong>中读取数据，加载到<strong class="ki iu"> <em class="le"> PostgreSQL </em> </strong>数据库中，用<strong class="ki iu"> <em class="le"> pgAdmin </em> </strong>查看。</p><p id="8b69" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望它有所帮助。</p><p id="8a9c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文是<a class="ae kf" href="https://medium.com/@kaanboke/list/workflow-tools-e3da3a530ea5" rel="noopener"> <strong class="ki iu">工作流工具列表</strong> </a>的一部分。你可以在 这里找到<a class="ae kf" href="https://medium.com/@kaanboke/list/workflow-tools-e3da3a530ea5" rel="noopener"> <strong class="ki iu">系列的其他文章。</strong></a></p><p id="7f1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对了，喜欢题目的时候，<strong class="ki iu">可以通过支持</strong> <strong class="ki iu">来表现👏</strong></p><p id="d5d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">欢迎发表评论。感谢您的宝贵时间。</p><h1 id="507d" class="lm ln it bd lo lp nj lr ls lt nk lv lw lx nl lz ma mb nm md me mf nn mh mi mj bi translated">万事如意🤘</h1></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="1a68" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">代码</strong>可以从<a class="ae kf" href="https://github.com/kb1907/airflow-aws-elt" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">这里</strong> </a>下载。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="c973" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢看我的内容，<a class="ae kf" href="https://medium.com/@kaanboke/membership" rel="noopener"> <em class="le">请考虑关注我</em> </a>。还有，你可以通过<a class="ae kf" href="https://medium.com/@kaanboke/membership" rel="noopener"> <strong class="ki iu">订阅Medium </strong> </a>来支持其他作家和我。使用我的推荐链接不会额外花费你。</p></div></div>    
</body>
</html>