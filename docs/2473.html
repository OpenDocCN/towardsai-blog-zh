<html>
<head>
<title>Fraud Detection using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的欺诈检测</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/fraud-detection-using-machine-learning-eae93f6c1bec?source=collection_archive---------0-----------------------#2022-01-07">https://pub.towardsai.net/fraud-detection-using-machine-learning-eae93f6c1bec?source=collection_archive---------0-----------------------#2022-01-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7216" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="a6a7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">“人类在识别欺诈方面糟糕得惊人。研究表明，即使当我们在寻找欺骗的迹象时，我们的准确性也不比运气好多少。</p><p id="262b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">—玛丽亚·孔尼科娃</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/f8560f2e6f05ae38d2b5757753f6785f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxY3pdp6ZtMa1B0z6BBRdw.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">罗德尼制片公司在<a class="ae ln" href="https://www.pexels.com/photo/man-people-woman-coffee-7821901/" rel="noopener ugc nofollow" target="_blank">的照片</a></figcaption></figure><h1 id="8366" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">问题</h1><p id="a781" class="pw-post-body-paragraph jz ka it kb b kc mm ke kf kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw im bi translated">越来越多的公司和消费者一直在转向在线和非接触式支付方式。数以百万计的美国人成为信用卡诈骗的受害者，最终花费他们数千美元，并对他们的信用评分产生负面影响。华尔街日报报告称，2019年，欺诈损失，包括与信用卡和借记卡相关的损失，给银行、商家以及某些情况下的持卡人造成了169亿美元的损失。最近，在2020年12月，尼尔森报告将全球信用卡欺诈损失量化为286.5亿美元。</p><h1 id="b0a5" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">解决办法</h1><p id="8a54" class="pw-post-body-paragraph jz ka it kb b kc mm ke kf kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw im bi translated">在欺诈交易被批准和处理之前，开发一种实时检测和拒绝欺诈交易的方法。这可以通过访问与交易相关的数据来实现，例如物理位置、购买的项目、金额以及与持卡人先前购买的一致性。</p><h1 id="ba11" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">路标</h1><p id="a760" class="pw-post-body-paragraph jz ka it kb b kc mm ke kf kg mn ki kj kk mo km kn ko mp kq kr ks mq ku kv kw im bi translated">我们需要预测信用卡交易是合法交易还是欺诈交易。以下步骤将使用机器学习和Python来执行。</p><p id="88b9" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.导入所需的软件库。</p><p id="d699" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.访问并导入数据集。</p><p id="02d0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.数据分析和探索。</p><p id="74a0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.数据清理和规范化。</p><p id="c448" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.将数据分为训练数据集和测试数据集。</p><p id="3cc7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">6.根据训练数据训练模型。</p><p id="d600" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">7.根据测试数据进行预测。</p><p id="c943" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">8.评估模型的性能。</p><p id="2256" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">9.从评估中得出结论。</p><p id="f168" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">程序</strong></p><p id="a7e2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">目的:使用机器学习模型预测交易是有效交易还是欺诈交易。</p><p id="1337" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">导入所需的软件库</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="23fa" class="mw lp it ms b gy mx my l mz na"><strong class="ms jd">import</strong> pandas <strong class="ms jd">as</strong> pd <br/><strong class="ms jd">import</strong> numpy <strong class="ms jd">as</strong> np<br/><strong class="ms jd">import</strong> matplotlib.pyplot <strong class="ms jd">as</strong> plt<br/><strong class="ms jd">import</strong> seaborn <strong class="ms jd">as</strong> sns<br/><strong class="ms jd">from</strong> sklearn.model_selection <strong class="ms jd">import</strong> train_test_split<br/><strong class="ms jd">from</strong> sklearn.ensemble <strong class="ms jd">import</strong> RandomForestClassifier<br/><strong class="ms jd">from</strong> sklearn.linear_model <strong class="ms jd">import</strong> LogisticRegression<br/><strong class="ms jd">from</strong> sklearn.svm <strong class="ms jd">import</strong> SVC<br/><strong class="ms jd">from</strong> sklearn.neighbors <strong class="ms jd">import</strong> KNeighborsClassifier<br/><strong class="ms jd">from</strong> sklearn.metrics <strong class="ms jd">import</strong> accuracy_score, classification_report</span></pre><p id="04dc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">访问并导入数据集</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="f9de" class="mw lp it ms b gy mx my l mz na">#Load the data on Google Colab <br/><strong class="ms jd">from</strong> <strong class="ms jd">google.colab</strong> <strong class="ms jd">import</strong> files                                         uploaded = files.upload() </span><span id="94d5" class="mw lp it ms b gy nb my l mz na"># Import the data set into a dataframe.<br/>credit_data = pd.read_csv('creditcard.csv')</span></pre><p id="f57e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">信用卡数据集包含2013年欧洲信用卡持卡人的真实银行交易。点击<a class="ae ln" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">链接</a>可以找到信用卡数据集。为了安全起见，没有包括实际的变量名，除了amount和class之外，变量名都标为V，后跟一个数字。有30个特性列和1个名为Class的目标列。</p><p id="e872" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据分析与探索</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="60ce" class="mw lp it ms b gy mx my l mz na"># Print the first 5 rows. <br/>credit_data.head()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nc"><img src="../Images/133c78d12bdce51eff2c5cc6b09374eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KUsJhwnICYQI3EAQG7zatw.png"/></div></div></figure><p id="4f19" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示有关数据列的信息。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="c29f" class="mw lp it ms b gy mx my l mz na">credit_data<strong class="ms jd">.</strong>info()</span><span id="940d" class="mw lp it ms b gy nb my l mz na">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 284807 entries, 0 to 284806<br/>Data columns (total 31 columns):<br/> #   Column  Non-Null Count   Dtype  <br/>---  ------  --------------   -----  <br/> 0   Time    284807 non-null  float64<br/> 1   V1      284807 non-null  float64<br/> 2   V2      284807 non-null  float64<br/> 3   V3      284807 non-null  float64<br/> 4   V4      284807 non-null  float64<br/> 5   V5      284807 non-null  float64<br/> 6   V6      284807 non-null  float64<br/> 7   V7      284807 non-null  float64<br/> 8   V8      284807 non-null  float64<br/> 9   V9      284807 non-null  float64<br/> 10  V10     284807 non-null  float64<br/> 11  V11     284807 non-null  float64<br/> 12  V12     284807 non-null  float64<br/> 13  V13     284807 non-null  float64<br/> 14  V14     284807 non-null  float64<br/> 15  V15     284807 non-null  float64<br/> 16  V16     284807 non-null  float64<br/> 17  V17     284807 non-null  float64<br/> 18  V18     284807 non-null  float64<br/> 19  V19     284807 non-null  float64<br/> 20  V20     284807 non-null  float64<br/> 21  V21     284807 non-null  float64<br/> 22  V22     284807 non-null  float64<br/> 23  V23     284807 non-null  float64<br/> 24  V24     284807 non-null  float64<br/> 25  V25     284807 non-null  float64<br/> 26  V26     284807 non-null  float64<br/> 27  V27     284807 non-null  float64<br/> 28  V28     284807 non-null  float64<br/> 29  Amount  284807 non-null  float64<br/> 30  Class   284807 non-null  int64  <br/>dtypes: float64(30), int64(1)<br/>memory usage: 67.4 MB</span></pre><p id="b6b4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">有284，807个交易，包含31个变量。信用交易没有任何缺失值，所有列都包含数字变量。</p><p id="247b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示类中的类类型和计数。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="458d" class="mw lp it ms b gy mx my l mz na">credit_data['Class'].value_counts()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nd"><img src="../Images/fd1c0baa1677a1a6bf75e59dd214fe13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvnFyN1Lm1OeDPtftrD_DQ.png"/></div></div></figure><p id="5ca3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化有效和欺诈交易，并显示欺诈的百分比。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="3a23" class="mw lp it ms b gy mx my l mz na">plt.bar(['Valid','Fraud'],list(credit_data['Class'].value_counts()))print("Fraudulent transactions: ", end='') <br/>frauds= credit_data['Class'].value_counts()[1]/sum(credit_data['Class'].value_counts())</span><span id="b5b6" class="mw lp it ms b gy nb my l mz na">print(round(frauds*100,2), end='%')<br/>plt.show()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ne"><img src="../Images/bae35c4dff01ce85e07a3f76de9b1dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqXDvScByW9m_HK1R1lNLg.png"/></div></div></figure><p id="6383" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们有一个高度不平衡的数据集。大多数交易显然是有效的，只有少数欺诈案例。</p><p id="6cb5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化特征和目标变量类之间的相关性。我们将使用皮尔逊相关法。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="3a0d" class="mw lp it ms b gy mx my l mz na">plt.figure(figsize=(16,15))  </span><span id="c40b" class="mw lp it ms b gy nb my l mz na">sns.heatmap(credit_data.corr(), annot=<strong class="ms jd">True</strong>, fmt='.0%', cmap='coolwarm')</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nf"><img src="../Images/2b9dd0f01aa5fe077637ce80574f94d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NqSUMzh6wp5JDowYRQRwyQ.png"/></div></div></figure><p id="a738" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">预测值列之间没有高相关值。没有预测值列与类列具有高相关值。然而，V2与数量之间存在负相关，V7与数量特征之间存在正相关。</p><p id="8795" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据清理和规范化</strong></p><p id="8427" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">检查“金额”列中的数据是否存在值差异。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="89e7" class="mw lp it ms b gy mx my l mz na">min(credit_data.Amount), max(credit_data.Amount)</span></pre><p id="2660" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi">(0.0, 25691.16)</p><p id="fd3f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用标准缩放器缩放金额变量，以校正金额中的较大差异。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="0fdd" class="mw lp it ms b gy mx my l mz na">sc = StandardScaler() <br/>amount = credit_data['Amount'].values <br/>credit_data['Amount'] = sc.fit_transform(amount.reshape(-1, 1))</span></pre><p id="21a2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">删除时间变量，因为此分析不需要它。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="ad64" class="mw lp it ms b gy mx my l mz na">credit_data.drop(['Time'], axis=1, inplace=<strong class="ms jd">True</strong>)</span></pre><p id="845d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">将数据分成训练和测试数据集</strong></p><p id="e8f6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">首先，我们需要将数据分为x值(我们将用来进行预测的数据)和y值(我们试图预测的数据)。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="ee4a" class="mw lp it ms b gy mx my l mz na">x = credit_data.drop('Class', axis = 1)<br/>y = credit_data['Class']</span></pre><p id="3363" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用train_test_split函数生成训练数据和测试数据。测试数据集将是原始数据集的20%。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="99ab" class="mw lp it ms b gy mx my l mz na">x_training_data, x_test_data, y_training_data, y_test_data = train_test_split(x, y, test_size = 0.2)</span></pre><p id="978b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">我们现在将训练模型，进行预测，并评估四种不同机器学习模型的性能。</strong></p><p id="35a2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">随机福里斯特模型</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="1b60" class="mw lp it ms b gy mx my l mz na"># Create model object.<em class="ng"> <br/></em>model_rf <strong class="ms jd">=</strong> RandomForestClassifier()</span><span id="689b" class="mw lp it ms b gy nb my l mz na"># Train the model on the training data.<br/>model_rf<strong class="ms jd">.</strong>fit(x_training_data, y_training_data)</span><span id="9976" class="mw lp it ms b gy nb my l mz na"># Make predictions on the test data.<br/>predictions_rf <strong class="ms jd">=</strong> model_rf<strong class="ms jd">.</strong>predict(x_test_data)</span></pre><p id="6ae1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="345d" class="mw lp it ms b gy mx my l mz na">rf <strong class="ms jd">=</strong> accuracy_score(y_test_data, predictions_rf)<br/>print(f'Accuracy: {round(rf<strong class="ms jd">*</strong>100,2)}%')</span></pre><p id="0dd0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:99.95%</p><p id="ed90" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="138c" class="mw lp it ms b gy mx my l mz na">print(classification_report(y_test_data, predictions_rf))</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nh"><img src="../Images/073f918893bdaff8a84aed7a6b604a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0e8lNQURALSD8LFMvyY6A.png"/></div></div></figure><p id="8675" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">随机森林模型准确预测了99.95%的交易是有效的或欺诈的。</p><p id="42da" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">100%正确预测有效交易。</p><p id="9b4a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">94%正确预测欺诈交易。</p><p id="6f39" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">逻辑回归模型</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="8562" class="mw lp it ms b gy mx my l mz na"># Create model object.<em class="ng"> <br/></em>model_lr <strong class="ms jd">=</strong> LogisticRegression(max_iter<strong class="ms jd">=</strong>150)</span><span id="d197" class="mw lp it ms b gy nb my l mz na"># Train the model on the training data. model_lr<strong class="ms jd">.</strong>fit(x_training_data, y_training_data)</span><span id="2428" class="mw lp it ms b gy nb my l mz na"># Make predictions on the test data. <br/>predictions_lr <strong class="ms jd">=</strong> model_lr<strong class="ms jd">.</strong>predict(x_test_data)</span></pre><p id="94b1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="4f24" class="mw lp it ms b gy mx my l mz na">lr <strong class="ms jd">=</strong> accuracy_score(y_test_data, predictions_lr)<br/>print(f'Accuracy: {round(lr<strong class="ms jd">*</strong>100,2)}%')</span></pre><p id="e8d7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:99.92%</p><p id="d74e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="7eb6" class="mw lp it ms b gy mx my l mz na">print(classification_report(y_test_data, predictions_lr))</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ni"><img src="../Images/704f8213f1bf31226c9a0844f35f6838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yoXv_0Jl869TEul4EnliTw.png"/></div></div></figure><p id="9ece" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">逻辑回归模型准确预测了99.92%的交易是有效的或欺诈的。</p><p id="79f0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">100%正确预测有效交易。</p><p id="4a04" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">91%正确预测欺诈交易。</p><p id="5952" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">支持向量机模型</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="f8ef" class="mw lp it ms b gy mx my l mz na"># Create model object.<em class="ng"> <br/></em>model_sv <strong class="ms jd">=</strong> SVC()</span><span id="ddfd" class="mw lp it ms b gy nb my l mz na"># Train the model on the training data. model_sv<strong class="ms jd">.</strong>fit(x_training_data, y_training_data)</span><span id="30a0" class="mw lp it ms b gy nb my l mz na"># Make predictions on the test data. <br/>predictions_sv <strong class="ms jd">=</strong> model_sv<strong class="ms jd">.</strong>predict(x_test_data)</span></pre><p id="c95a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="8b3d" class="mw lp it ms b gy mx my l mz na">sv <strong class="ms jd">=</strong> accuracy_score(y_test_data, predictions_sv)<br/>print(f'Accuracy: {round(sv<strong class="ms jd">*</strong>100,2)}%')</span></pre><p id="ece9" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:99.93%</p><p id="c7e0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="10bc" class="mw lp it ms b gy mx my l mz na">print(classification_report(y_test_data, predictions_sv))</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nj"><img src="../Images/2df56882fde2f1acecd2d65fbe21653c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sh9kkgruIKbDrhwxQzi_A.png"/></div></div></figure><p id="d471" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">支持向量机模型准确预测了99.93%的交易是有效的或欺诈的。</p><p id="2bc7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">100%正确预测有效交易。</p><p id="a13e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">93%正确预测欺诈交易。</p><p id="b3c1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd"> K个最近邻居</strong></p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="3ce5" class="mw lp it ms b gy mx my l mz na"># Create model object. <br/>model_kn <strong class="ms jd">=</strong> KNeighborsClassifier(n_neighbors<strong class="ms jd">=</strong>9, leaf_size<strong class="ms jd">=</strong>20) <em class="ng"># (n_neighbors = 5, metric = 'minkowski', p = 2) </em></span><span id="ea02" class="mw lp it ms b gy nb my l mz na"># Train the model on the training data. model_kn<strong class="ms jd">.</strong>fit(x_training_data, y_training_data)</span><span id="20dd" class="mw lp it ms b gy nb my l mz na"># Make predictions on the test data. <br/>predictions_kn <strong class="ms jd">=</strong> model_kn<strong class="ms jd">.</strong>predict(x_test_data)</span></pre><p id="0fb0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">计算准确度分数。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="c5fe" class="mw lp it ms b gy mx my l mz na">kn <strong class="ms jd">=</strong> accuracy_score(y_test_data, predictions_kn) <br/>print(f'Accuracy: {round(kn<strong class="ms jd">*</strong>100,2)}%')</span></pre><p id="749d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">准确率:99.94%</p><p id="4436" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">评估模型的性能。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="3ad2" class="mw lp it ms b gy mx my l mz na">print(classification_report(y_test_data, predictions_kn))</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nk"><img src="../Images/524cf843310a598ededb98c79e457dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6ybN5_hUNt2A3TE7gxTsg.png"/></div></div></figure><p id="f6ed" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">k近邻模型准确地预测了99.94%的交易是有效的或欺诈的。</p><p id="8cd0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">100%正确预测有效交易。</p><p id="5e72" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">91%正确预测欺诈交易。</p><p id="1cf2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">按型号显示准确度分数。</p><pre class="ky kz la lb gt mr ms mt mu aw mv bi"><span id="4509" class="mw lp it ms b gy mx my l mz na">models <strong class="ms jd">=</strong> pd<strong class="ms jd">.</strong>DataFrame({<br/>    'Model':['Random Forrest', 'Logistic Regression', 'Support Vector Machine', 'K Nearest Neighbors'],<br/>    'Accuracy_score' :[rf, lr, sv, kn]<br/>})</span><span id="2939" class="mw lp it ms b gy nb my l mz na">models</span><span id="a2e9" class="mw lp it ms b gy nb my l mz na">sns<strong class="ms jd">.</strong>barplot(x<strong class="ms jd">=</strong>'Accuracy_score', y<strong class="ms jd">=</strong>'Model', data<strong class="ms jd">=</strong>models)</span><span id="2fb8" class="mw lp it ms b gy nb my l mz na">models<strong class="ms jd">.</strong>sort_values(by<strong class="ms jd">=</strong>'Accuracy_score', ascending<strong class="ms jd">=False</strong>)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nl"><img src="../Images/3a61333b9afcb3a9ca80f22f2bb0e3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H3ucg561VthaLP9X67J4kg.png"/></div></div></figure><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nm"><img src="../Images/fee1c68cf770fca21ffd4b7decdd0496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJYdy1lQ1XUrbbmOQgYnOg.png"/></div></div></figure><p id="da51" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">结论:所有模型在预测有效交易和欺诈交易方面都做得很好，准确率达到99%以上。随机森林模型的准确度最高。该模型正确预测了99.95%的交易为有效或欺诈交易。这些数据对有效交易非常重要。通过在合法交易和欺诈交易之间建立更加平衡的数据集，可以改进该研究。</p><p id="fd4a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">感谢阅读我的文章！如果您有任何意见或反馈，请在下面添加。</p><p id="4dd5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。会员资格让你可以无限制地接触媒体上的故事。你可以使用此链接<a class="ae ln" href="https://medium.com/@dniggl/membership" rel="noopener">https://medium.com/@dniggl/membership</a>注册</p></div></div>    
</body>
</html>