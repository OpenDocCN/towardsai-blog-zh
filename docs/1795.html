<html>
<head>
<title>What Is Serverless AWS Lambda and How to Use It</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是无服务器AWS Lambda以及如何使用它</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/what-is-serverless-aws-lambda-and-how-to-use-it-2c69672c0161?source=collection_archive---------0-----------------------#2021-04-27">https://pub.towardsai.net/what-is-serverless-aws-lambda-and-how-to-use-it-2c69672c0161?source=collection_archive---------0-----------------------#2021-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3ba0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/cloud-computing" rel="noopener ugc nofollow" target="_blank">云计算</a></h2><div class=""/><div class=""><h2 id="7293" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">AWS提供的Lambda服务概述</h2></div><p id="f49a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><a class="ae ln" href="http://www.michelangiolo.best/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt jd">点击这里了解我，我的项目，我的最新文章。</strong> </a></p><p id="5f36" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在本文中，我将详细解释如何开始将AWS Lambda用于无服务器应用程序。如何设置您的第一个功能，以及如何将其连接到其他服务。我很少写一步一步的教程，我的大多数文章都包含代码和解释，但是我想试一试。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/5dc3c135e8a00ca5a8df12cec2c5507b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5eaigiLCWKUsk5GvX3V1w.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">AWS Lambda徽标</figcaption></figure><h1 id="4cfe" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">AWS云</h1><p id="371f" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">AWS(亚马逊网络服务)是互联网上最大的云之一。云是一个服务的集合，一个大的技术允许你根据你的使用来租用。您不必在自己的基础设施上花费数百万美元，而是可以以几美分的成本(如果您很小)获得计算能力、网络服务、分析工具，甚至高达数百万美元的成本(如果您很大并且正在扩展)。</p><h1 id="877e" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">无服务器计算</h1><p id="6e8a" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">当选择构建一个无服务器的应用程序时，不要租用一个必须24小时运行的服务器来在客户端连接时提供应用程序的后端，而是只在需要时才激活服务器。当一个客户端在你的网站上执行一个动作时，这个动作会触发一个功能，这个功能可以执行一个你选择的算法(发送电子邮件，收集或发送数据，授权):任何你不能在前端直接做的事情。</p><p id="9685" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">选择无服务器而不是基于服务器的计算可能会节省你的钱，特别是如果你很小，没有那么多人使用你的网站，但你需要知道如何做到这一点。开始时，如果你习惯于在flask或Django框架中编码所有东西，你可能会发现无服务器的概念相当混乱。</p><h1 id="c592" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">开始使用Lambda</h1><p id="4d2b" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">在本教程中，如果您是AWS新手，需要遵循以下说明:</p><ol class=""><li id="f6d0" class="nb nc it kt b ku kv kx ky la nd le ne li nf lm ng nh ni nj bi translated">访问AWS控制台</li><li id="512c" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">选择λ</li><li id="817a" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">创建您的第一个函数</li><li id="a0d9" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">编码</li><li id="96f0" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">正在创建触发器</li><li id="a89f" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">与AWS API网关连接</li><li id="fe6d" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">创建发布方法</li><li id="5a66" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">部署</li><li id="0704" class="nb nc it kt b ku nk kx nl la nm le nn li no lm ng nh ni nj bi translated">URL测试</li></ol><p id="0193" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">编写您的函数</p><h2 id="68be" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">2.选择λ</h2><p id="5135" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">当您打开服务列表时，您可以立即看到Lambda:您可以单击它来访问服务。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oa"><img src="../Images/fca07bab1dbfc5de318c857c2b908ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3MeTNN3JtlUG79aEJRckw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">控制台中一些可用服务的列表</figcaption></figure><h2 id="f73e" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">3.创建您的第一个函数</h2><p id="0176" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">我们将从使用Lambda创建第一个函数开始:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ob"><img src="../Images/990e3bc738086f028ae9913e7dda3cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLW41MBlmjtPcFjDJZ7Lhg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">点击创建功能开始(右上方，抱歉是意大利语)</figcaption></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oc"><img src="../Images/368d30dd48b5ca16d73a9a03acb72673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xa0VhfaYqbc8rp_v5iJVtA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">当创建你的第一个函数时，你可以选择参数，包括运行的语言，权限…</figcaption></figure><p id="2038" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在这种情况下，我选择了python 3.8。您还可以根据自己的喜好，用不同的语言构建函数。</p><p id="7c45" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">* * *记住，一旦创建了函数</strong>，就不能对其进行重命名</p><h2 id="187a" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">4.编码</h2><p id="0254" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">AWS已经提供了一个可以编写函数的接口。并非所有的云都会提供相同的功能。lambda函数有一个输入，您可以用触发器传递它，它允许您将JSON代码作为输出输出，以防您希望向您的程序传达一切顺利。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi od"><img src="../Images/b75db7b0eee2911f0ef993d90d76ac66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vkC99yvpogzbPOnrxAOUUw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">点击test &gt; Configure Test Event来编辑输入JSON</figcaption></figure><p id="0eff" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">通过配置测试事件，您可以决定在调用时哪个输入(以JSON格式)进入您的函数。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oe"><img src="../Images/441a2f7329f9cc6a837423c4394c6279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RILr-tSfMdCdqK3Byz8RYQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">测试函数时，这将是函数将接收的输入(主体)。您可以保存不同的身体样本，以方便您的测试。</figcaption></figure><p id="5f47" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">JSON格式非常简单，事实上，至少在python中，是一个只有3个值的字典:key1、key2和key3。在该函数中，输入将作为<strong class="kt jd">事件</strong>参数接收。让我编辑lambda函数，并通过单击DEPLOY保存它。如果运行，输出如下:</p><pre class="lp lq lr ls gt of og oh oi aw oj bi"><span id="6960" class="np mf it og b gy ok ol l om on">import json</span><span id="9882" class="np mf it og b gy oo ol l om on">def lambda_handler(event, context):<br/> # TODO implement<br/> return {<br/> ‘statusCode’: 200,<br/> ‘body’: json.dumps(str(event[‘key1’]))<br/> }</span></pre><p id="f842" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">运行时的输出(测试功能):</p><pre class="lp lq lr ls gt of og oh oi aw oj bi"><span id="c8ee" class="np mf it og b gy ok ol l om on">Response<br/>{<br/>  "statusCode": 200,<br/>  "body": "\"value1\""<br/>}</span></pre><p id="2e22" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有用！响应包含输入的key1。</p><h2 id="d6c2" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">5.正在创建触发器</h2><p id="92b8" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">我们现在需要公开部署Lambda函数。我们可以通过将它连接到一个API来做到这一点。AWS用来执行此任务的工具称为API Gateway:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi op"><img src="../Images/f67d00d38e560c2b9a23099cde65d2b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJ0iuxcGJ--fOHF-rdfrgw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">在Lambda接口的顶部，您可以选择使用API Gateway作为触发器来激活您的</figcaption></figure><p id="84d4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">添加该功能将出现以下菜单:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oq"><img src="../Images/33f3d2e6f31fc734fe8f78413e9a85a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_qkyiuiiok1O38we7FVEA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">使用API网关创建REST API触发器</figcaption></figure><h2 id="6de6" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">6.与AWS API网关连接</h2><p id="56b7" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">通过访问API网关，您将能够编辑API详细信息。我们现在可以添加一个HTTP来执行请求:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi or"><img src="../Images/f1eacc5e6ad92356b5c4f39918f05017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybn1CFjCHAb5hBtXceypKA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">有了这个接口，你可以将HTTP方法添加到lambda函数中</figcaption></figure><h2 id="e490" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">7.创建发布方法</h2><p id="b0c1" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">我将从声明一个新的HTTP方法开始。因为我需要传入一些JSON，所以我需要一个POST请求:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi os"><img src="../Images/0ea02896fc1284305277b4e65e3cacc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*EWad90-BFEGxPxPQTXqxvQ.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">声明与lambda函数foo1关联的新HTTP方法的步骤</figcaption></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ot"><img src="../Images/1c718e6f4cebce17a13015397473b556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KT-_XFW9UpviTLAoZLWfKw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">为了方便起见，我使用了相同名称的函数</figcaption></figure><p id="29a7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在是测试函数的时候了(可选，但也是很好的实践)。我们可以在没有测试和实践的情况下部署它，但是如果出现错误，我们会知道。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ou"><img src="../Images/857f4f44be667057b6923a01bd24d34e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sinjNkbmTxhthiz-DUpRzA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">进入测试界面</figcaption></figure><p id="53fa" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">测试的工作方式(在API网关内)很简单。我们可以访问一个接口，在这个接口上，根据调用的类型(GET、POST……)，我们可以像部署函数一样与函数进行交互。因为我想将一个JSON文件传递给函数，所以我需要使用POST方法:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ov"><img src="../Images/0c1bf5c788696cfaca1bca1c2625ab2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DkJNw1BXCdHowP4tqL1oGA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">测试界面</figcaption></figure><p id="8228" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如您所见，该函数将按键作为输入并正确运行。如果它有错误，它将输出:“内部服务器错误”。</p><h2 id="48d1" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">8.部署</h2><p id="e340" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">既然我们已经确定该功能工作正常，现在是时候把它放到网上了，可以通过URL访问。我们将通过部署API来实现这一点:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/60382a829f492d447a5462f683a8a0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*BqTXLTu9GwTsqaw9razYGQ.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">部署说明</figcaption></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/5cc43791aeb139a2e501a0085471a08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*2B6NAXlxZPz0OBZbfQ0Iaw.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">部署阶段参数</figcaption></figure><h2 id="737b" class="np mf it bd mg nq nr dn mk ns nt dp mo la nu nv mq le nw nx ms li ny nz mu iz bi translated">9.URL测试</h2><p id="7c77" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">既然已经部署了URL，它就在线了。我们只需要URL的链接，我们可以将它用作HTTP方法。我们可以从API网关接口检索工作URL，或者返回到lambda接口，如下所示:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi oy"><img src="../Images/1dd4fa42578c0e1a0a44040869440203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XconUrLNh2kfuFahNnnLaw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">在Lambda接口中找到您部署的API Url</figcaption></figure><p id="e2f0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我将使用一个名为Postman的软件来测试我的函数，传递一个JSON并期待一个响应:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/718ed8898e7e15f68f57efae6a7affe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*vInv7OgrAgd0heUZ993VUA.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">邮递员成功投递邮件的截图</figcaption></figure><p id="7da0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有用！用于JSON代码的函数作为主体传递，以正确处理它并输出statuscode 200和主体中键的第一个值。您可以将value1更改为任何值，它将输出您所编写的内容。</p></div></div>    
</body>
</html>