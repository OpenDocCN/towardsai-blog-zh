<html>
<head>
<title>Classic Methods for Identification of First Order Plus Dead Time (FOPDT) Systems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一阶加纯滞后(FOPDT)系统的经典辨识方法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/classic-methods-for-identification-of-first-order-plus-dead-time-fopdt-systems-d81b0484aa4e?source=collection_archive---------1-----------------------#2020-09-16">https://pub.towardsai.net/classic-methods-for-identification-of-first-order-plus-dead-time-fopdt-systems-d81b0484aa4e?source=collection_archive---------1-----------------------#2020-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0387" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/engineering" rel="noopener ugc nofollow" target="_blank">工程</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/1b873cea6d6cefde9213942c4f438710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yLswgUU01D21Jgkq"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated"><a class="ae ko" href="https://unsplash.com/@crew?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">剧组</a>在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="0ae2" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi ln translated">一阶系统是输入输出关系为一阶微分方程的系统。这些类型的系统非常重要，例如，咖啡机作为一个大规模加热系统。</p><p id="ce6d" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因此，这里的事情是，有时我们需要有系统模型在手，才可能控制它们。但是…</p><p id="a823" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有时很难用解析方法获得系统的传递函数。在许多情况下，系统是封闭的，人们无法识别其组成部分。</p><p id="79e8" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有没有一种方法可以解决问题，那就是通过将系统提交给一个阶跃输入，我们可以从系统对这个输入的响应中获得重要的信息，否则很难获得这些信息。换句话说，阶跃响应可以引导我们找到一些属性，使得获得系统的传递函数成为可能。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/3c4401e573e7c80beda1bea5635d19da.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*wpdCJrrRTfPE4YdUo4Mbng.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图1:系统表示为一个盒子。</figcaption></figure><p id="d96a" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这里我们有一个案例要研究:想象一下，对于一个温度控制系统，假设电阻线R的长度相对于它与温度计之间的距离L可以忽略不计，并且管道直径足够小。我们正在讨论图2所示的问题。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/3a87fc5fddda073c7c7b47798a73fbb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*SzxluzoKxEjVj_jPSNZOxA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图2:系统图。</figcaption></figure><p id="129e" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果开关<em class="mc"> S </em>闭合，液体温度将立即上升。然而，在作为输出信号的温度计检测到这一点之前，被加热的液体必须到达温度计主体，这将在取决于液体流量的一定时间之后发生。这个时间就是所谓的死时间。因此，我们面对的是一阶加死区(FOPDT)系统，对于这些系统，我们有一个与其动态响应相关的方程，下面是它的方程。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi md"><img src="../Images/23d9ec0464b6d1e0e8ea75b81479a8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:106/format:webp/0*I-vcKKpvUmHfl9c2.png"/></div></figure><p id="0bdb" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">其中:</p><ul class=""><li id="c288" class="me mf it kr b ks kt kw kx la mg le mh li mi lm mj mk ml mm bi translated"><strong class="kr jd"> K </strong> =过程增益</li><li id="f45b" class="me mf it kr b ks mn kw mo la mp le mq li mr lm mj mk ml mm bi translated"><strong class="kr jd"> τ </strong> =过程时间常数</li><li id="8e91" class="me mf it kr b ks mn kw mo la mp le mq li mr lm mj mk ml mm bi translated"><strong class="kr jd"> θ </strong> =过程停滞时间</li></ul><p id="abef" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因此，通过包含时间(t)、步长输入u(t)和输出y(t)变量的"<a class="ae ko" href="https://github.com/rwguerra/classic_identification_FOPDT/blob/master/dados.mat?raw=true" rel="noopener ugc nofollow" target="_blank"> data.mat </a>"文件可以获得本例中的数据。文章的目的是，利用数据实现经典的系统辨识方法(使用MatLab ),获得系统的一阶模型为:</p><ul class=""><li id="4d2a" class="me mf it kr b ks kt kw kx la mg le mh li mi lm mj mk ml mm bi translated"><strong class="kr jd">齐格勒-尼科尔斯法；</strong></li><li id="cb9b" class="me mf it kr b ks mn kw mo la mp le mq li mr lm mj mk ml mm bi translated"><strong class="kr jd">史密斯的方法；</strong></li><li id="c15a" class="me mf it kr b ks mn kw mo la mp le mq li mr lm mj mk ml mm bi translated"><strong class="kr jd"> Sundaresan的方法；</strong></li><li id="eed9" class="me mf it kr b ks mn kw mo la mp le mq li mr lm mj mk ml mm bi translated"><strong class="kr jd">西川法</strong></li></ul><p id="3641" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">所有方法都将使用平均绝对百分比误差(MAPE)进行评估，该误差通过以下等式获得。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/aaf503331d4904bdc8de43b9d8af1123.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/0*aJD6WvvWC7WKMSg2.png"/></div></figure><p id="d58a" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">其中处的<em class="mc">是当前值，<em class="mc"> Pt </em>是预测值，<em class="mc"> n </em>是样本数。</em></p><p id="2d55" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">好，那我们开始吧！</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="2477" class="na nb it bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">齐格勒-尼科尔斯方法</h1><p id="0896" class="pw-post-body-paragraph kp kq it kr b ks ny ku kv kw nz ky kz la oa lc ld le ob lg lh li oc lk ll lm im bi translated">Ziegler，Nichols等人(1942)[1]提出的方法是在曲线拐点处画一条切线，以确定系统的增益、时间和延迟常数，如图3所示。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi od"><img src="../Images/177ab4fc07872b99b9d9049646b76a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*I4X51TgnOaR7CifBWmRFlA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图3:齐格勒-尼科尔斯的例子。</figcaption></figure><p id="ca88" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">对于FOPDT，响应在瞬时= θ + τ时达到63%,在t = θ时响应的最大正切在直线= θ + τ处截距y / KM，因此阶跃响应在t = 5τ(平衡时间)时处于永久状态。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/6bdaa515e96c2c6cb8d3eddae20739a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjWJLFpPw7MfYB47OVgRSQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图4:齐格勒-尼科尔斯结果图。</figcaption></figure><p id="0e09" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">应用所讨论的方法，获得了图4所示的虚线曲线。可能会注意到曲线与原始曲线非常接近，差别很小。这个问题的MAPE是0.65%。</p><p id="5f49" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">应用这种方法的困难在于首先需要找到曲线的拐点。拐点定义在曲线改变方向并且导数等于零的地方。在这种情况下，这一点是通过计算梯度来寻找曲线的二阶导数而获得的。</p><p id="0cc4" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">然后，有必要创建一条以拐点为中心的曲线切线。之后，一切都变得容易了，因为你只要应用这个方法。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="2335" class="na nb it bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">史密斯方法</h1><p id="b2a0" class="pw-post-body-paragraph kp kq it kr b ks ny ku kv kw nz ky kz la oa lc ld le ob lg lh li oc lk ll lm im bi translated">Smith (1972年)[2]建议选择θ和τ的值，使模型和真实响应在呈现高变化率的两点上重合。从图中确定的中间值是输入中应用的值的幅度和输出中变化状态的幅度，采用两次，其中第一次是当输出达到输出最终值的28%时，第二次是63%，如图5所示。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e13853616f56f199a994172e98d977c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*bqGhicm_mBl8TFqCVXmCEQ.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图5:史密斯的例子。</figcaption></figure><p id="c622" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因此，我们可以很容易地计算t1和t2，然后找到:</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi og"><img src="../Images/146bd495c864287f9497cf3cce5b3558.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/0*bGkyr6KJn-Uj_Fj6.png"/></div></figure><p id="9b23" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">将该方法应用于问题数据，我们得到了图6所示的虚线曲线。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/5fd8e249360762291cbaad78f47ca133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTkSglGzvjdr8UCeuODipQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图6:史密斯的结果图。</figcaption></figure><p id="22a5" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">可能会注意到曲线与原始曲线非常接近，差别很小。该问题的MAPE为0.513%，略好于齐格勒-尼科尔斯方法。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="2d59" class="na nb it bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">孙达雷桑和克里希纳瓦米方法</h1><p id="d255" class="pw-post-body-paragraph kp kq it kr b ks ny ku kv kw nz ky kz la oa lc ld le ob lg lh li oc lk ll lm im bi translated">该方法还避免了使用拐点来估计时间常数τ和传输延迟θ。他们建议从单步响应曲线估计两个时间t1和t2，分别对应于响应的35.3%和85.3%。</p><p id="aa80" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">史密斯方法的唯一区别是选择点的方式和寻找τ和θ的方式，在这种情况下是通过:</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/286f851b1e651ee5a2dfd7b80c737553.png" data-original-src="https://miro.medium.com/v2/resize:fit:294/format:webp/0*DSbGGjytAWC9Aqed.png"/></div></figure><p id="aaea" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">从图7中可以看出，预测曲线几乎与原始曲线相同，反映出0.2607%的MAPE。除了很好的结果之外，这种方法非常简单，并且计算成本非常低。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/7a040469274e9b125e74455fe55e349a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ssbJlGKrxbzH4tt64oU8ig.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图7: Sundaresan和Krishnaswamy结果图。</figcaption></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="3d60" class="na nb it bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">西川方法</h1><p id="529d" class="pw-post-body-paragraph kp kq it kr b ks ny ku kv kw nz ky kz la oa lc ld le ob lg lh li oc lk ll lm im bi translated">Nishikawa (2007)[3]创建了一种方法，该方法包括使用图8所示的曲线面积计算来确定常数值。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/dfd0f1944593ed3bccb6ebafddbde6fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*FKhbIB9FPB2J5xvEAOJ7WQ.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图5:西川的例子。</figcaption></figure><p id="7ec8" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">其中:</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/469423be885a4ef8583966c618454304.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/0*EY5YD6_U-ir8-4gI.png"/></div></figure><p id="11ac" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">然后获得模型参数，使得:</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div class="gh gi og"><img src="../Images/305a5807ab9eed2fe8822ed26b27066b.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/0*hRaWs1ADxflhxkpd.png"/></div></figure><p id="99eb" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这样，就有可能获得图9所示的曲线。</p><figure class="lx ly lz ma gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/c4440e3857192ebdc9e8a3d9a2805171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjLb0Al194hSbaZb2qp8qw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">图9:西川结果图。</figcaption></figure><p id="0b92" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">再一次，通过0.4195%的图反映了优异的结果，但是与其他方法相比，这种方法的代价是具有更大的数学复杂性和相当大的计算成本，因为需要计算积分来找到系统的参数。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="493f" class="na nb it bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">结论</h1><p id="a736" class="pw-post-body-paragraph kp kq it kr b ks ny ku kv kw nz ky kz la oa lc ld le ob lg lh li oc lk ll lm im bi translated">可以研究和应用齐格勒/尼科尔斯、史密斯、孙达雷桑和西川的方法，得出的结论是，在所有情况下计算低于1%的MAPE时，都获得了相当好的结果。</p><p id="e4da" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">一些方法被证明是更复杂的，例如Ziegler和Nishikama，在第一种方法中，需要找到一个拐点，在最后一种方法中，执行面积计算，在这种情况下，对于这个问题，他们最终没有带来证明复杂性增加的结果。另一方面，Smith和Sundaresan等方法除了简单之外，还取得了令人满意的结果，其中Sundaresan的MAPE最低。</p><p id="796e" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些方法的一个重要观察结果是，通过测量对真实阶跃的响应，参数K、τ和θ可以根据过程的操作条件(即，进入阶跃的幅度和变化的方向)而显著变化。这些变化可归因于过程的非线性。附录A包含用于生成结果的MATLAB代码。如果需要，代码也可以在我的<a class="ae ko" href="https://github.com/rwguerra/classic_identification_FOPDT/" rel="noopener ugc nofollow" target="_blank"> Github </a>中找到。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="0634" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[1]齐格勒，J. GNICHOLS，N. B .等人<a class="ae ko" href="http://robotics.itee.uq.edu.au/~elec3004/2015/assignments/PS4-Z_N_Original.pdf" rel="noopener ugc nofollow" target="_blank">自动控制器的最佳设置</a>。译<em class="mc"> ASME </em>，第64卷，第11号，1942年。</p><p id="2ee2" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[2]史密斯，C. L. <em class="mc">数字计算机过程控制</em>。[S.l.]:英特尔教育出版社，1972年。</p><p id="eb1b" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">[3] NISHIKAWA，H. <a class="ae ko" href="https://doi.org/10.1016/j.jcp.2007.07.029" rel="noopener ugc nofollow" target="_blank">扩散方程的一阶系统方法。I:二阶剩余分配方案</a>。《计算物理学杂志》，爱思唯尔，第227卷，第1期，第315–352页，2007年。</p></div></div>    
</body>
</html>