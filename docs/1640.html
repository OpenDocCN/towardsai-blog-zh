<html>
<head>
<title>Choosing a Machine Type on Google AI Platform for Training Object Detection Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google AI平台上选择用于训练对象检测模型的机器类型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/choosing-a-machine-type-on-google-ai-platform-for-training-object-detection-models-68a88c45574c?source=collection_archive---------8-----------------------#2021-03-08">https://pub.towardsai.net/choosing-a-machine-type-on-google-ai-platform-for-training-object-detection-models-68a88c45574c?source=collection_archive---------8-----------------------#2021-03-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c158" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/cloud-computing" rel="noopener ugc nofollow" target="_blank">云计算</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/72238384ef7ade005043e6522eb5685c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZGI-ynG2S70DA-eVafPA3A.png"/></div></div></figure><p id="84e5" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">当我的学生开始抱怨无法在谷歌AI平台上训练他们的深度学习模型时，我想他们可能在某个地方出现了小错误。也许，他们没有正确使用我给他们的命令。也许，他们忘了在AI平台上设置一些东西。或者只是他们在某个地方打错了。</p><p id="5416" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我的学生参加的课程是关于如何使用tensor flow 2<a class="ae li" href="https://www.udemy.com/course/deep-learning-for-object-detection-using-tensorflow-2/?couponCode=OBJECTDET13" rel="noopener ugc nofollow" target="_blank">训练和评估用于对象检测的深度学习模型</a>(更快的RCNN，SSD和YOLOv3)。在谷歌人工智能平台上运行训练的最后一个步骤是运行<a class="ae li" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_training_and_evaluation.md#training-with-multiple-gpus" rel="noopener ugc nofollow" target="_blank">原始github库中提到的Tensorflow对象检测API </a>的命令。虽然这个确切的命令实际上并不工作，但我已经做了必要的修改使它工作。</p><p id="3967" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">但是只有在我花了一些时间和我的两个学生一起试着解决这个问题之后，我才意识到一些重要的事情。有一些因素会影响你在google AI平台上对机器类型的选择。您选择用来训练深度学习模型进行对象检测的机器类型。</p><p id="3ccc" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">事实上，在某些情况下，您将无法使用他们拥有的任何机器！</p><p id="2062" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我的一个学生和我分享了这张截图:</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/7e989d223be8edc7371fab1b75258b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*yBjbjnUPokl-sfABxOF5OQ.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">要使用的机器数量有限</figcaption></figure><p id="9908" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">当你看到上面的错误时，你会注意到屏幕截图的末尾写着:</p><blockquote class="ls"><p id="4417" class="lt lu it bd lv lw lx ly lz ma mb lh dk translated">描述:对2个V100加速器的请求超过了允许的最大数量，即0个TPU V2 POD、0个TPU V3 POD、1个K80、1个P100、1个P4、1个T4、1个V100、8个TPU V2、8个TPU V3加速器</p></blockquote><p id="c2c8" class="pw-post-body-paragraph kk kl it km b kn mc kp kq kr md kt ku kv me kx ky kz mf lb lc ld mg lf lg lh im bi translated">这意味着你只能使用特定型号的机器。例如，<strong class="km jd"><em class="mh">0 TPU _ V2 _ POD</em></strong><em class="mh"/>表示不能使用任何<strong class="km jd"> <em class="mh">类型的机器(零)【TPU_V2_POD </em> </strong> <em class="mh">。</em>另一方面，<strong class="km jd"> <em class="mh"> 1 K80 </em> </strong>意味着你可以使用一台<strong class="km jd"><em class="mh"/></strong>型号的<strong class="km jd"> <em class="mh"> K80。</em>T29】</strong></p><p id="18f0" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我上面提到的在google AI平台上运行培训的部分命令如下:</p><pre class="lk ll lm ln gt mi mj mk ml aw mm bi"><span id="6c2d" class="mn mo it mj b gy mp mq l mr ms">--master-accelerator count=8,type=nvidia-tesla-v100</span></pre><p id="9836" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">这只是完整命令的一小部分。它负责选择要使用的GPU类型以及数量。所以<strong class="km jd"> <em class="mh"> count=8 </em> </strong>意味着你要用8个GPU。另一部分，<strong class="km jd"> <em class="mh"> type=nvidia-tesla-v100，</em> </strong>表示你想用<strong class="km jd"> <em class="mh">类型的GPU(或TPU)【NVIDIA-Tesla-v100】</em></strong>。</p><p id="2769" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">问题是，不是所有的学生都面临这个问题！我意识到，在选择机器数量和机器类型时，生活在世界不同地区的学生有不同的选择。事实上，有一个学生没有选择！这意味着他不能在任何装有GPU的机器上运行培训！</p><p id="cb36" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">事情是这样的，在谷歌人工智能平台上，你有不同的机器类型。对于每种机器类型，您都有特定数量和类型的GPU可以使用！这些选项的完整列表可在<a class="ae li" href="https://cloud.google.com/ai-platform/training/docs/using-gpus#compute-engine-machine-types-with-gpu" rel="noopener ugc nofollow" target="_blank">表格</a>中找到。下面是该表的屏幕截图:</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mt"><img src="../Images/0796659586d7d49658764de67dc11401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wu3EIp8jnriDzET9Yrk7bA.png"/></div></div></figure><p id="7706" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在上面一点，我向你展示了我们用来选择GPU的数量和类型的命令。命令又来了:</p><pre class="lk ll lm ln gt mi mj mk ml aw mm bi"><span id="03c6" class="mn mo it mj b gy mp mq l mr ms">--master-accelerator count=8,type=nvidia-tesla-v100</span></pre><p id="8e58" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">但是这个命令不能让您选择机器类型！在上表中，您可以看到最左边的一列是机器类型。其他列用于GPU类型。在表格中，您可以看到每种机器类型和GPU类型的允许GPU数量。那么，我们该如何选择机器类型呢？这实际上是在<a class="ae li" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_training_and_evaluation.md#training-with-multiple-gpus" rel="noopener ugc nofollow" target="_blank"> github repo </a>中描述的完整命令的另一部分。这部分是:</p><pre class="lk ll lm ln gt mi mj mk ml aw mm bi"><span id="fea6" class="mn mo it mj b gy mp mq l mr ms">--master-machine-type n1-highcpu-16</span></pre><p id="3890" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">如果你回到上表，你可以看到如果你选择机器类型<strong class="km jd"><em class="mh">n1-high CPU-16</em></strong>你可以使用类型<strong class="km jd"> <em class="mh"> nvidia-tesla-v100的2、4或8个GPU。</em> </strong></p><p id="45ac" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">如果您选择其他数量的GPU，比如10或16个，您将无法运行该命令，因为您被限制只能使用2、4或8个。</p><p id="4dc5" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">现在，您应该对如何选择机器类型及其对应的GPU数量和类型有了更清晰的认识！</p><p id="5ac8" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">回到我的学生身上，他不会使用任何类型的GPU。他能做什么？</p><p id="a86e" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">别急，有可能解决他(还有你！).</p><p id="120d" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">Google Cloud实际上给了你请求增加配额的可能性！这意味着你可以要求谷歌给你一些GPU的访问权限。为此，您需要填写一份表格，并将其发送给google cloud团队。这个过程就是这里提到的<a class="ae li" href="https://cloud.google.com/ai-platform/training/docs/quotas#requesting_a_quota_increase" rel="noopener ugc nofollow" target="_blank"><strong class="km jd"/></a>。</p><p id="292e" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">本文到此为止！</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mu"><img src="../Images/49b27d7e7bfe544c28a4ad607f843387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Qgb_XG-331geZCny.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">作者制作的图像</figcaption></figure><p id="2bec" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我是一名机器学习工程师，致力于解决具有挑战性的计算机视觉问题。我想帮助你学习应用于计算机视觉问题的机器学习。以下是方法。</p><ol class=""><li id="745b" class="mv mw it km b kn ko kr ks kv mx kz my ld mz lh na nb nc nd bi translated">通过帮助您了解该领域的最新动态。我几乎每天都在<a class="ae li" href="https://www.linkedin.com/in/nour-islam-mokhtari-07b521a5/" rel="noopener ugc nofollow" target="_blank"><strong class="km jd">【LinkedIn】</strong></a>和<a class="ae li" href="https://twitter.com/NourIslamMo" rel="noopener ugc nofollow" target="_blank"><strong class="km jd">Twitter</strong></a><strong class="km jd"/><strong class="km jd">上分享小型博客帖子。</strong>那就跟我去吧！</li><li id="49ac" class="mv mw it km b kn ne kr nf kv ng kz nh ld ni lh na nb nc nd bi translated">每周给你一份我的<a class="ae li" href="https://nourislam.ck.page/dc3e8b7e12" rel="noopener ugc nofollow" target="_blank"> <strong class="km jd">时事通讯</strong> </a>上那些琐碎帖子的摘要。所以订阅吧！</li><li id="d40f" class="mv mw it km b kn ne kr nf kv ng kz nh ld ni lh na nb nc nd bi translated">通过在Medium上写关于机器学习不同主题的文章。所以跟我来吧！</li><li id="d5d4" class="mv mw it km b kn ne kr nf kv ng kz nh ld ni lh na nb nc nd bi translated">给你一份免费的机器学习工作清单，帮助你检查你需要学习的所有要点，如果你计划在ML，特别是在计算机视觉方面的职业生涯。你可以在这里 得到清单<a class="ae li" href="https://www.aifee.co/free-resources" rel="noopener ugc nofollow" target="_blank"> <strong class="km jd">。</strong></a></li></ol><p id="a403" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">5.最后但同样重要的是，通过与你分享我的<a class="ae li" href="https://aifee.teachable.com/p/introduction-to-tensorflow-2-for-computer-vision" rel="noopener ugc nofollow" target="_blank"> <strong class="km jd">免费入门张量流课程</strong> </a>，它有超过<strong class="km jd"> <em class="mh"> 4小时</em>的视频内容</strong>，你可以在那里问我任何问题。</p><p id="21d9" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">此外，如果您有任何问题或者您只是想聊聊ML，请随时在LinkedIn或Twitter上联系我！</p></div></div>    
</body>
</html>