<html>
<head>
<title>Binary Classification Using Logistic Regression vs Visualizations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用逻辑回归和可视化的二元分类</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/binary-classification-using-logistic-regression-vs-visualizations-8b9b5dce8e8b?source=collection_archive---------0-----------------------#2022-10-29">https://pub.towardsai.net/binary-classification-using-logistic-regression-vs-visualizations-8b9b5dce8e8b?source=collection_archive---------0-----------------------#2022-10-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="437b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Seaborn可视化数据集？如何使用逻辑回归创建机器学习模型？良好视觉化的力量。</h2></div><h1 id="fed7" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="4cbc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本教程中，我们将构建一个诊断患者是否患有糖尿病的二元分类项目。我们将从两个方面着手:1 .仅使用散点图可视化和2。使用流行的机器学习算法之一—<strong class="lc iu"><em class="lw"/></strong>逻辑回归。最后我会<strong class="lc iu"> <em class="lw">对比结果</em> </strong>。事实证明，数据可视化对分类也有很大的作用。</p><blockquote class="lx ly lz"><p id="197d" class="la lb lw lc b ld ma ju lf lg mb jx li mc md ll lm me mf lp lq mg mh lt lu lv im bi translated">如果你喜欢看的话，这里有完整的YouTube视频教程。</p></blockquote><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mj"><img src="../Images/9b16501eb9eb43b19025d141d6a85b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWqEeGai08VJMzOE2pKDyg.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated"><a class="ae mi" href="https://www.youtube.com/watch?v=1hjkSCE2hgA&amp;t=16s" rel="noopener ugc nofollow" target="_blank">逻辑回归vs可视化</a>(图片由作者提供)</figcaption></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/d73d0b3bedbd636d2be4acbadbf5907a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EMxQFizmIrvdC5xumUwFNg.gif"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">结果gif作者</figcaption></figure><p id="ad59" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">您可以从<a class="ae mi" href="https://www.kaggle.com/datasets/mathchi/diabetes-data-set" rel="noopener ugc nofollow" target="_blank">这里</a>下载数据集</p><p id="bc41" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">你可以在这里看到GitHub代码<a class="ae mi" href="https://github.com/gurokeretcha/Applied-Data-Science-For-Beginners/blob/main/tutorial_1/1_Logistic_Regression_Classification.ipynb" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9865" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">环境:<a class="ae mi" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌colab </a></p><h1 id="bf96" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">目录:</h1><p id="22ba" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae mi" href="#fed7" rel="noopener ugc nofollow"> <strong class="lc iu">简介</strong> </a></p><p id="7a4f" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated"><strong class="lc iu"> 1。</strong> <a class="ae mi" href="#1e9e" rel="noopener ugc nofollow"> <strong class="lc iu">数据预处理</strong> </a></p><p id="9452" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated"><strong class="lc iu"> 2。</strong> <a class="ae mi" href="#76fe" rel="noopener ugc nofollow"> <strong class="lc iu">分类使用可视化</strong> </a></p><p id="9997" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated"><strong class="lc iu"> 3。</strong> <a class="ae mi" href="#9400" rel="noopener ugc nofollow"> <strong class="lc iu">分类采用逻辑回归</strong> </a></p><p id="cc4c" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated"><strong class="lc iu"> 4。</strong> <a class="ae mi" href="#6f16" rel="noopener ugc nofollow"> <strong class="lc iu">可视化vs逻辑回归</strong> </a></p><p id="4449" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated"><a class="ae mi" href="#da74" rel="noopener ugc nofollow"> <strong class="lc iu">结论</strong> </a></p><h1 id="1e9e" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak"> 1。数据预处理:</strong></h1><p id="1327" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">第一步是下载、读取和预处理数据集。此外，我们需要导入必要的库。</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7ecd" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">显示了数据集的样本。它由8个输入特征组成，如“怀孕”、“血糖”、“血压”等。和1个输出特征——“结果”，其表示患者是否患有糖尿病。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nc"><img src="../Images/592a26e3f57959dbeef990b6210c9966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50mkguGcCzSmbAYISPlIPw.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">数据集示例(图片由作者提供)</figcaption></figure><ul class=""><li id="6867" class="nd ne it lc b ld ma lg mb lj nf ln ng lr nh lv ni nj nk nl bi translated">仔细检查数据集是否包含空值</li></ul><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/6c403d5bf80c893b006755b21eed7daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*QNMbfIp4p_WOpgsTSDvxFQ.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">输出结果(作者)</figcaption></figure><ul class=""><li id="318c" class="nd ne it lc b ld ma lg mb lj nf ln ng lr nh lv ni nj nk nl bi translated">检查数据集列数据类型。结果显示，所有的列都是int64数据类型，所以不需要做什么。</li></ul><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e570662c85c7dfe720fdd30ef431da68.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*EICfXZ4fUm658ki5EH_4yw.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">输出结果(作者)</figcaption></figure><ul class=""><li id="7824" class="nd ne it lc b ld ma lg mb lj nf ln ng lr nh lv ni nj nk nl bi translated">检查输出类的分布。正如结果所强调的，数据集中有一点不平衡，因此选择正确的指标来评估我们的分类结果非常重要。</li></ul><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi no"><img src="../Images/9cdd8828db4648e07e2e2e0002b14148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JMo8BktPE5yVfzI81PlzA.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">类别分布(作者的结果)</figcaption></figure><h1 id="76fe" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">2.仅使用可视化的分类</h1><p id="bc33" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">由于我们对数据集进行了预处理，现在是时候进行分类了。通常，数据集的可视化是预处理步骤的一部分。但是，在这种情况下，我们将对二进制分类进行可视化。为此，我们将所有要素相对于输出要素的散点图可视化，并注意分隔橙色和蓝色点簇的最有趣的图。</p><ul class=""><li id="cbd1" class="nd ne it lc b ld ma lg mb lj nf ln ng lr nh lv ni nj nk nl bi translated"><strong class="lc iu">橘色圆点</strong>——患有糖尿病的<strong class="lc iu">患者</strong></li><li id="75d6" class="nd ne it lc b ld np lg nq lj nr ln ns lr nt lv ni nj nk nl bi translated"><strong class="lc iu">蓝点</strong>——无糖尿病的患者<strong class="lc iu">。</strong></li></ul><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="c716" class="nz kj it nv b gy oa ob l oc od">g <strong class="nv iu">=</strong> sns<strong class="nv iu">.</strong>pairplot(data, hue<strong class="nv iu">=</strong>"Outcome")</span></pre><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi oe"><img src="../Images/af76686c720a8e0c4a65e8aa4dd2aadc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-hZjDvsheGRgxmC8LaDNg.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">所有特征的散点图(图片由作者提供)</figcaption></figure><p id="1878" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">根据散点图，最有趣的图是<strong class="lc iu">年龄</strong>和<strong class="lc iu">葡萄糖</strong>之间的关系，因为我们可以看到橙色和蓝色点簇之间的明显区别。我们可以分别想象这种关系，以便更仔细地观察它们。</p><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="5520" class="nz kj it nv b gy oa ob l oc od">sns.scatterplot(data['Glucose'],data['Age'],hue=data['Outcome'])</span></pre><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi of"><img src="../Images/914128bcad9185a6748c5204176c88aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRL7x1LfSZuV-jDFDF-z4g.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">年龄与葡萄糖散点图(图片由作者提供)</figcaption></figure><p id="b832" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">值得注意的是，如果葡萄糖浓度高于130，我们可以粗略地假设患者患有糖尿病。我们只根据这个阈值做一个预测，看看结果。</p><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="92f3" class="nz kj it nv b gy oa ob l oc od">data['prediction'] <strong class="nv iu">=</strong> np<strong class="nv iu">.</strong>where((data['Glucose']<strong class="nv iu">&gt;</strong>130),1,0)<br/>data.head()</span></pre><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi og"><img src="../Images/2e689a30426c8039c533a2972985e13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUMr-yMPMDDPJPwa8Db66w.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">预测结果(作者图片)</figcaption></figure><p id="8573" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">“结果”是基本事实，而“预测”是预测值。基于这个数据集样本，几乎所有的预测都是正确的。然而，为了更全面地了解我们的预测有多好，我们可以计算一下<a class="ae mi" href="https://developers.google.com/machine-learning/crash-course/classification/accuracy" rel="noopener ugc nofollow" target="_blank"> <em class="lw">【准确性】</em></a><a class="ae mi" href="https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall" rel="noopener ugc nofollow" target="_blank"><em class="lw">【精度】</em></a><a class="ae mi" href="https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall" rel="noopener ugc nofollow" target="_blank"><em class="lw">【召回】</em> </a>。</p><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="0811" class="nz kj it nv b gy oa ob l oc od">y_test_vis <strong class="nv iu">=</strong> data['Outcome']<strong class="nv iu">.</strong>values<br/>y_pred_vis <strong class="nv iu">=</strong> data['prediction']<strong class="nv iu">.</strong>values<br/><br/>print("accuracy: ", accuracy_score(y_test_vis,y_pred_vis ))<br/>print("precision: ", precision_score(y_test_vis,y_pred_vis ))<br/>print("recall: ", recall_score(y_test_vis,y_pred_vis ))</span></pre><p id="9d0f" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">Out[ ]:</p><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="6736" class="nz kj it nv b gy oa ob l oc od">accuracy:  0.73828125<br/>precision:  0.6334661354581673<br/>recall:  0.5932835820895522</span></pre><h1 id="9400" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">3.使用逻辑回归分类</h1><p id="5596" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">正如我们使用可视化进行分类一样，现在我们可以使用机器学习方法来做同样的事情。在这种情况下，我们使用逻辑回归算法。由于逻辑回归是一个线性模型，数据集需要缩放。在一切(缩放、数据拆分等)之后。)完成后，我们计算与之前相同的指标，以比较预测结果。</p><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="9362" class="nz kj it nv b gy oa ob l oc od">data<strong class="nv iu">.</strong>drop(columns<strong class="nv iu">=</strong>['prediction'], inplace<strong class="nv iu">=True</strong>)</span><span id="6615" class="nz kj it nv b gy oh ob l oc od">data_f <strong class="nv iu">=</strong> data<strong class="nv iu">.</strong>drop(columns<strong class="nv iu">=</strong>['Outcome'])<strong class="nv iu">.</strong>values<br/>labels <strong class="nv iu">=</strong> data['Outcome']<strong class="nv iu">.</strong>values<br/>scaler <strong class="nv iu">=</strong> MinMaxScaler()<br/><br/>data_f_scaled <strong class="nv iu">=</strong> scaler<strong class="nv iu">.</strong>fit_transform(data_f)</span><span id="62de" class="nz kj it nv b gy oh ob l oc od">X_train, X_test, y_train, y_test <strong class="nv iu">=</strong> train_test_split(data_f_scaled, labels, test_size<strong class="nv iu">=</strong>0.2, random_state<strong class="nv iu">=</strong>42)</span><span id="c189" class="nz kj it nv b gy oh ob l oc od">LR <strong class="nv iu">=</strong> LogisticRegression()<br/><br/>LR<strong class="nv iu">.</strong>fit(X_train,y_train)<br/><br/>y_pred <strong class="nv iu">=</strong> LR<strong class="nv iu">.</strong>predict(X_test)<br/>y_pred_prob <strong class="nv iu">=</strong> LR<strong class="nv iu">.</strong>predict_proba(X_test)[:,1]</span><span id="1383" class="nz kj it nv b gy oh ob l oc od">print("accuracy: ", accuracy_score(y_test,y_pred ))<br/>print("precision: ", precision_score(y_test,y_pred ))<br/>print("recall: ", recall_score(y_test,y_pred ))</span></pre><p id="82e5" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">Out[ ]:</p><pre class="mk ml mm mn gt nu nv nw nx aw ny bi"><span id="5f14" class="nz kj it nv b gy oa ob l oc od">accuracy:  0.7662337662337663<br/>precision:  0.7111111111111111<br/>recall:  0.5818181818181818</span></pre><h1 id="6f16" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">4.可视化与逻辑回归(ML)</h1><p id="7426" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是指标的摘要。即使我们使用了机器学习算法，简单的可视化产生了非常相同的预测结果。此外，视觉化预测有较高的回忆分数。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi oi"><img src="../Images/34d452e07ce6ce2f8fd179f3104317a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O_uXC6XgUFEoldv-JjrX-Q.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">预测结果对比(图片由作者提供)</figcaption></figure><h1 id="da74" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="1354" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">综上所述，我们可以得出结论，可视化对于数据分析是非常强大的。在这种情况下，我们使用可视化进行分类，产生了与流行的机器学习算法几乎相同的结果。当然，一切都取决于数据集，在大多数情况下，简单地目测可视化无法击败机器学习算法，但可视化是一种强大的分析工具，可以让数据科学家从数据集获得洞察力。它可以在预处理步骤中完成，也可以在最后调试机器学习预测结果。</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="859c" class="pw-post-body-paragraph la lb it lc b ld ma ju lf lg mb jx li lj md ll lm ln mf lp lq lr mh lt lu lv im bi translated">谢谢你的阅读。如果你想看 <strong class="lc iu"> <em class="lw">更详细的分析</em> </strong> <em class="lw">你可以</em> <strong class="lc iu"> <em class="lw">观看</em> </strong> <em class="lw">我的</em> <a class="ae mi" href="https://www.youtube.com/watch?v=1hjkSCE2hgA&amp;t=16s" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iu"> <em class="lw"> YouTube视频</em> </strong> </a></p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><blockquote class="lx ly lz"><p id="86d8" class="la lb lw lc b ld ma ju lf lg mb jx li mc md ll lm me mf lp lq mg mh lt lu lv im bi translated">如果你想在medium上注册，以获得无限的故事，你可以使用我的<a class="ae mi" href="https://medium.com/@gkeretchashvili/membership" rel="noopener"> <strong class="lc iu">推荐链接</strong> </a> <strong class="lc iu"> </strong>(我会免费向你收取一小笔佣金<em class="it"> ) </em></p></blockquote><div class="oq or gp gr os ot"><a href="https://medium.com/@gkeretchashvili/membership" rel="noopener follow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">通过我的推荐链接加入媒体-Gurami keretcashvili</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">阅读Gurami Keretchashvili(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">medium.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph mt ot"/></div></div></a></div></div></div>    
</body>
</html>