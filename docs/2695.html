<html>
<head>
<title>How to Create and Use Multi-Index DataFrame to Scale Up Your Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建和使用多索引数据框架来扩展您的数据分析</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-create-and-use-multi-index-dataframe-to-scale-up-your-data-analysis-fa80ed025d42?source=collection_archive---------1-----------------------#2022-04-21">https://pub.towardsai.net/how-to-create-and-use-multi-index-dataframe-to-scale-up-your-data-analysis-fa80ed025d42?source=collection_archive---------1-----------------------#2022-04-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/a4cb5368b646629f7a17d865a7f3ef20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JPgK5CfDGW94tXpK"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jg" href="https://unsplash.com/@pactovisual?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pacto Visual </a>拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="a2e2" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">多索引数据帧的详细信息:创建、切片、索引和分析</h2></div><p id="411e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在大多数数据帧中，我们看到一个作为行标识符的索引。但是如果一个数据帧中有不止一个索引呢？多索引数据框架对于数据分析来说是好事还是令人困惑？事实上，如果你知道如何使用它们，它可以是一个非常好的数据分析。它让您可以更方便、更高效地分析数据。</p><p id="d2d2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要真正提高和扩大您数据分析技能，很重要的一点是要很好地了解多索引数据框架。在本文中我们将看到:</p><p id="87ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">如何创建多索引数据框架</em></p><p id="95ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">如何使用多索引数据框架进行高效的数据分析。</em></p><p id="df91" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">在多索引数据帧上使用“groupby”和聚合函数。</em></p><blockquote class="lv"><p id="e79f" class="lw lx jj bd ly lz ma mb mc md me lt dk translated">我还包括了上述三个主题的视频版本。如果你更喜欢视频教程，请随时观看视频版本。</p></blockquote><p id="f2e3" class="pw-post-body-paragraph ky kz jj la b lb mf kk ld le mg kn lg lh mh lj lk ll mi ln lo lp mj lr ls lt im bi translated">让我们从创建多索引数据帧开始。作为数据分析师或数据科学家，我们不仅需要了解分析，还需要学习如何以有组织的方式存储数据。</p><h2 id="1952" class="mk ml jj bd mm mn mo dn mp mq mr dp ms lh mt mu mv ll mw mx my lp mz na nb nc bi translated">如何创建多索引数据框架？</h2><p id="3554" class="pw-post-body-paragraph ky kz jj la b lb nd kk ld le ne kn lg lh nf lj lk ll ng ln lo lp nh lr ls lt im bi translated">为了创建多索引数据框架，我将首先创建索引。我将生成一个双层索引。因此，索引看起来像这样:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="39e9" class="mk ml jj nn b gy nr ns l nt nu">import pandas as pd<br/>import numpy as np</span><span id="10ba" class="mk ml jj nn b gy nv ns l nt nu">index = [('Bob', 2019), ('Bob', 2020),<br/>        ('Lilly', 2019), ('Lilly', 2010),<br/>        ('Shelly', '2019'), ('Shelly', 2020)]</span></pre><p id="4fed" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该索引在第一层显示姓名，在第二层显示年份。</p><p id="0496" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的索引中，我们提到了六个人。这六个人的数学成绩列表如下:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5fa1" class="mk ml jj nn b gy nr ns l nt nu">Math = [98, 93, 78, 88, 92, 81]</span></pre><p id="f8f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经准备好了索引和数据。我们将首先用这些数据制作一个系列:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="e418" class="mk ml jj nn b gy nr ns l nt nu">pop = pd.Series(Math, index=index)<br/>pop</span></pre><p id="f3c3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="8290" class="mk ml jj nn b gy nr ns l nt nu">(Bob, 2019)       98<br/>(Bob, 2020)       93<br/>(Lilly, 2019)     78<br/>(Lilly, 2010)     88<br/>(Shelly, 2019)    92<br/>(Shelly, 2020)    81<br/>dtype: int64</span></pre><p id="89c2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意我们有每个人两次的分数。第一个是2019年，第二个是2020年。</p><p id="ae5d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我将添加一个分数信息，并制作一个包含数学分数和阅读分数的数据框架:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0e12" class="mk ml jj nn b gy nr ns l nt nu">pop_df = pd.DataFrame({'math': pop,<br/>                      'reading': [88, 81, 73, 81, 91, 94]})<br/>pop_df</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/557f3b9ecfc14df51f8604b138fe35bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*ENO_YUzOO7UX2dptmwjzyg.jpeg"/></div></figure><p id="b91a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">我们走了很长一段路。下面是最直接的方法:</strong></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5377" class="mk ml jj nn b gy nr ns l nt nu">df = pd.DataFrame(data,<br/>                 index=[['Bob', 'Bob', 'Lilly', 'Lilly',<br/>                        'Shelly', 'Shelly'], <br/>                        [2019, 2020, 2019, 2020, 2019, 2020]],<br/>                  columns = ["Math", "Reading"]<br/>                 )</span></pre><p id="9dc6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它将产生和以前完全一样的结果。</p><p id="039b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个例子将展示如何拥有两级索引和两级列。首先，我这里有分数列表。<strong class="la jk">注意这个列表是二维的。</strong></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="8e58" class="mk ml jj nn b gy nr ns l nt nu">scores = [[90, 67, 89, 76, 93, 90], <br/>          [90, 67, 89, 76, 93, 90], <br/>          [90, 67, 89, 76, 93, 90], <br/>          [90, 67, 89, 76, 93, 90], <br/>          [90, 67, 89, 76, 93, 90],<br/>          [90, 67, 89, 76, 93, 90]]</span></pre><p id="52c1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我使用上面的分数列表制作数据框架。我们将设置两级索引和两级列:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="1c11" class="mk ml jj nn b gy nr ns l nt nu">pd.DataFrame(scores, <br/>             index = [['school1', 'school1', 'school2', 'school2', 'school3', 'school3'], [2019, 2020, 2019, 2020, 2019, 2020]],<br/>             columns = [['7th grade', '7th grade', '7th grade', '8th grade', '8th grade', '8th grade'], ['math', 'reading', 'writing','math', 'reading', 'writing']]<br/>            )</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/27ef8241240412e2a407d04f7726cc0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*5UtzijDgFT152lynI_uAlQ.jpeg"/></div></div></figure><p id="c112" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们以一种非常有组织的方式存储了三所学校两年来7年级和8年级的数学、阅读和写作成绩。</p><p id="a78d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是创建多索引数据帧的视频版本:</p><figure class="ni nj nk nl gt iv"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="ab3d" class="mk ml jj bd mm mn mo dn mp mq mr dp ms lh mt mu mv ll mw mx my lp mz na nb nc bi translated">多索引数据帧的切片</h2><p id="c89a" class="pw-post-body-paragraph ky kz jj la b lb nd kk ld le ne kn lg lh nf lj lk ll ng ln lo lp nh lr ls lt im bi translated">在本次演示中，我们将使用一个<strong class="la jk">虚拟数据集，该数据集只能用于数据科学培训目的</strong>。请随意从以下链接下载数据集:</p><div class="is it gp gr iu oa"><a href="http://roycekimmons.com/tools/generated_data/exams" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jk gy z fp of fr fs og fu fw ji bi translated">考试分数</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">这是一个虚构的数据集，应仅用于数据科学培训目的。该数据集包括分数…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">roycekimmons.com</p></div></div></div></a></div><p id="4f6a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先导入数据集:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="fa94" class="mk ml jj nn b gy nr ns l nt nu">df <strong class="nn jk">=</strong> pd<strong class="nn jk">.</strong>read_csv('StudentsPerformance.csv')<br/>df<strong class="nn jk">.</strong>head()</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oj"><img src="../Images/1e22a28bbd04636e9a74b73fb9a33800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uRBMYsPFpR-HJ0OgQ0QnfA.jpeg"/></div></div></figure><p id="9bb1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个数据集现在只有一个数字序列号作为索引。让我们使用一些有意义的列作为索引。由于我们将处理多索引数据帧，我将在此使用五层索引:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="ef56" class="mk ml jj nn b gy nr ns l nt nu">mdf <strong class="nn jk">=</strong> df<strong class="nn jk">.</strong>set_index(['race/ethnicity', 'parental level of education', 'lunch','test preparation course','gender'])</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/e74e2495766857bf79ec7f774242be8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyBayG3rDJJP8i9hNxvF2w.jpeg"/></div></div></figure><p id="7075" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们有种族/民族、父母教育水平、午餐、备考课程和性别作为指标。</p><p id="4124" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些层可用于在不同条件下将数据集分割成粒度部分。接下来是一些例子。</p><p id="b32f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们希望看到种族/民族仅为“B组”的数据。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="8f01" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>xs('group B')</span></pre><p id="bd6a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是部分输出:</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/76abb7f84ddfafd51bd618548c270158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4HwS1DPOiBt1Cs5_AU-tg.jpeg"/></div></div></figure><p id="f7a3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是数据集的一部分，仅显示B组数据。<strong class="la jk">当我们应用种族/民族条件分割数据时，种族/民族不再显示为一个索引。</strong></p><p id="bc8b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里使用更多的条件进一步分割数据。这次我们将看到种族/民族为B组、父母教育水平为“某大学”、午餐为“标准”的学生的分数:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="feb0" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>xs(('group B', 'some college', 'standard'))</span></pre><p id="e12e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这次我们可以分享全部产出。</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/f8959358e04d243c983c2e213ac5bf14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*PfEK6eRNi93HgmPdVx1F7g.jpeg"/></div></figure><p id="5448" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，让我们把更好的条件。在这里，我们将看到比率/种族为“B组”、父母教育水平为“某大学”、“午餐为“标准”、备考课程已完成且性别为男性的学生的分数:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="582e" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>xs(('group B', 'some college', 'standard', 'completed', 'male'))</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/521fa5da24d4d094a788ee22796e63e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7DvCMWNRL-ETGjNTS-riNQ.jpeg"/></div></div></figure><p id="5452" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当索引值的使用顺序与数据集完全相同时，就不需要提及索引值是哪一级的了。您可以简单地使用您正在寻找的索引值。</p><p id="cb12" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，假设您只想找到备考课程已经完成的数据。你不关心种族/民族或父母的教育水平或午餐。在这种情况下，有必要直接提到级别号或级别。</p><p id="580c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们想看的是备考课程完成的数据。备考课程是指数的第四级。所以，我们必须使用level =3。<strong class="la jk">将种族/民族视为0级指标。</strong></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="e792" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>xs('completed', level <strong class="nn jk">=</strong> 3)</span></pre><p id="d8d4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">部分输出:</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/78147f99db6227796e80bd62b90cbb4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nq_AD76PKVN0IvsTnLkeaw.jpeg"/></div></div></figure><p id="286e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者，您也可以明确地使用级别的名称，如下所示:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="c50a" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>xs('completed', level <strong class="nn jk">=</strong> 'test preparation course')</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/e58547ab7ffd99081bcd90bed70d4a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBVL3O8_-PZ6MW1l_SjHcg.jpeg"/></div></div></figure><p id="a689" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我使用了两个级别的指数:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="a346" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>xs(('group A', 'completed'), level <strong class="nn jk">=</strong> ['race/ethnicity', 'test preparation course'])</span></pre><p id="d01d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">部分输出:</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/53af6b7e6d4998e1db1f7ee364f605cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*IwVjPhUEqipGQjKU-_YY3w.jpeg"/></div></figure><p id="849c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是切片多索引数据帧的视频版本:</p><figure class="ni nj nk nl gt iv"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="46be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，你会发现另一个视频切片和索引使用。loc()、iloc()和IndexSlice，我没有在本文中展示它们。请随意查看:</p><figure class="ni nj nk nl gt iv"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="da0e" class="mk ml jj bd mm mn mo dn mp mq mr dp ms lh mt mu mv ll mw mx my lp mz na nb nc bi translated">在多索引数据帧上使用“groupby”函数</h2><p id="a175" class="pw-post-body-paragraph ky kz jj la b lb nd kk ld le ne kn lg lh nf lj lk ll ng ln lo lp nh lr ls lt im bi translated">我假设您还记得groupby函数对于数据分析是多么有用。在多索引数据帧上，它甚至更高效。</p><p id="c60b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我得到了每个种族/民族的平均数学、阅读和写作分数:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="70dc" class="mk ml jj nn b gy nr ns l nt nu"><strong class="nn jk">mdf.</strong>groupby(level <strong class="nn jk">=</strong> 0)<strong class="nn jk">.</strong>mean()</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/2a264ea1864aa75563e4e0d904921ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*9l8rrjfcemi3WCTq6VFMXw.jpeg"/></div></figure><p id="efaf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们将向前推进一点，找到每个种族/民族的个体性别的平均分数。请记住，种族/民族是0级指标，性别是4级指标。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="1e72" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>groupby(level <strong class="nn jk">=</strong> [0, 4])<strong class="nn jk">.</strong>mean()</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/89ccc96a347a96cba53923d80a7ca25c.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*GzPAd182zqvmBKHWr6LBJA.jpeg"/></div></figure><p id="4087" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以像这样使用索引级别的名称来获得相同的结果:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="4a7e" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>groupby(level <strong class="nn jk">=</strong> ['race/ethnicity', 'gender'])<strong class="nn jk">.</strong>mean()</span></pre><p id="1b2e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们拿到所有三个分数之前。我们还可以提到我们希望在结果数据中看到的具体分数。我想得到每个种族/民族的每个性别的平均数学和写作分数:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="88e6" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>groupby(level <strong class="nn jk">=</strong> ['race/ethnicity', 'gender'])['math score', 'writing score']<strong class="nn jk">.</strong>mean()</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/6e2f03b16dc543e7bb7ce8a65b8ac7e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*NtrJYS0k61USovfQFV2ggg.jpeg"/></div></figure><p id="bd2e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的输出数据集中，我们只看到平均阅读和写作分数。接下来，我还会将中位数添加到输出数据集中:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="54b4" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>groupby(level <strong class="nn jk">=</strong> ['race/ethnicity', 'gender'])['math score', 'writing score']<strong class="nn jk">.</strong>agg(['mean', 'median'])</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/2916494ba4ed17f0688777fac876ea20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*vn18ECo2g13uh-0neAnatQ.jpeg"/></div></figure><p id="5190" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您需要不同分数的不同类型的聚合怎么办？例如，我在这里使用数学分数的平均值和中值，写作分数的最小值、最大值和标准值。</p><p id="492e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们还使用了三个级别的指数:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0ed4" class="mk ml jj nn b gy nr ns l nt nu">mdf<strong class="nn jk">.</strong>groupby(level <strong class="nn jk">=</strong> ['race/ethnicity', 'parental level of education', 'gender'])['math score', 'writing score']<strong class="nn jk">.</strong>agg(<br/>    {<br/>        'math score': ['mean', 'median'],<br/>        'writing score': ['min', 'max', 'std']<br/>    }<br/>)</span></pre><p id="d02b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">部分输出:</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/2594d309f4a0429bd2eff2bb2203a290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8sXnJUlP1cKyulNZDaNg6w.jpeg"/></div></div></figure><p id="4e2b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是在多索引数据帧上使用groupby函数的视频版本:</p><figure class="ni nj nk nl gt iv"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="ee28" class="mk ml jj bd mm mn mo dn mp mq mr dp ms lh mt mu mv ll mw mx my lp mz na nb nc bi translated">结论</h2><p id="24ff" class="pw-post-body-paragraph ky kz jj la b lb nd kk ld le ne kn lg lh nf lj lk ll ng ln lo lp nh lr ls lt im bi translated">本页上的例子和视频应该让你完全准备好高效地使用多索引数据框架，并提高你的数据分析水平。用更简单、更少的代码获得对数据的粒度级访问要简单得多。</p><p id="cfb6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望它有帮助。</p><p id="a405" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请随时在<a class="ae jg" href="https://twitter.com/rashida048" rel="noopener ugc nofollow" target="_blank">推特</a>和<a class="ae jg" href="https://www.facebook.com/Regenerative-149425692134498" rel="noopener ugc nofollow" target="_blank">脸书页面</a>上关注我</p><h2 id="f8c7" class="mk ml jj bd mm mn mo dn mp mq mr dp ms lh mt mu mv ll mw mx my lp mz na nb nc bi translated">更多阅读</h2><div class="is it gp gr iu oa"><a href="https://towardsdatascience.com/animated-and-racing-bar-plots-tutorial-7967a45c4753" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jk gy z fp of fr fs og fu fw ji bi translated">动画和赛车酒吧情节教程</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">完整的工作代码</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ja oa"/></div></div></a></div><div class="is it gp gr iu oa"><a href="https://towardsdatascience.com/30-very-useful-pandas-functions-for-everyday-data-analysis-tasks-f1eae16409af" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jk gy z fp of fr fs og fu fw ji bi translated">30个非常有用的熊猫函数，用于日常数据分析任务</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">熊猫小型张</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pc l oy oz pa ow pb ja oa"/></div></div></a></div><div class="is it gp gr iu oa"><a href="https://towardsdatascience.com/exploratory-data-analysis-with-some-cool-visualizations-in-pythons-matplotlib-and-seaborn-library-99dde20d98bf" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jk gy z fp of fr fs og fu fw ji bi translated">利用Python的Matplotlib和Seaborn中的高级可视化进行探索性数据分析…</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">探索国际足联数据集</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pd l oy oz pa ow pb ja oa"/></div></div></a></div><div class="is it gp gr iu oa"><a href="https://towardsdatascience.com/all-the-datasets-you-need-to-practice-data-science-skills-and-make-a-great-portfolio-74f2eb53b38a" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jk gy z fp of fr fs og fu fw ji bi translated">练习数据科学技能和制作优秀投资组合所需的所有数据集</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">大量不同种类的数据集</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pe l oy oz pa ow pb ja oa"/></div></div></a></div><div class="is it gp gr iu oa"><a rel="noopener  ugc nofollow" target="_blank" href="/data-analysis-91a38207c92b"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jk gy z fp of fr fs og fu fw ji bi translated">数据分析</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">Python中数据科学家/分析师日常工作中的常见数据清理任务</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">pub.towardsai.net</p></div></div><div class="ow l"><div class="pf l oy oz pa ow pb ja oa"/></div></div></a></div></div></div>    
</body>
</html>