<html>
<head>
<title>Combine datasets using Pandas merge(), join(), concat() and append()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pandas merge()、join()、concat()和append()合并数据集</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/combine-datasets-using-pandas-merge-join-concat-and-append-442f839ba854?source=collection_archive---------0-----------------------#2020-04-18">https://pub.towardsai.net/combine-datasets-using-pandas-merge-join-concat-and-append-442f839ba854?source=collection_archive---------0-----------------------#2020-04-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6f72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在数据库世界中，<strong class="jp ir">连接</strong>和<strong class="jp ir">联合</strong>是最关键和最频繁执行的操作。几乎所有其他查询都是连接或联合的结合。使用Pandas，我们可以在处理数据科学算法或任何ETL(提取、转换和加载)项目时执行类似的任务，连接和联合在这里也很重要。</p><p id="c37e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在讨论join和unions的用例之前，这两者之间还有一点区别。连接和联合都用于组合数据集，然而连接结果集是数据集的水平组合，而联合的结果集是数据集的垂直组合。</p><p id="1ece" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Pandas中，对于水平组合，我们有<strong class="jp ir"> merge() </strong>和<strong class="jp ir"> join() </strong>，而对于垂直组合，我们可以使用<strong class="jp ir"> concat() </strong>和<strong class="jp ir"> append()。</strong> Merge和join执行类似的任务，但在内部它们有一些不同，类似于concat和append。在这篇博客中，我试图列出这些方法本质上的区别。</p><ol class=""><li id="603a" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated"><strong class="jp ir"> merge()用于合并公共列或索引上的数据。</strong></li></ol><p id="5c0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建两个数据框，了解合并的工作原理。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="e161" class="ld le iq kz b gy lf lg l lh li">import pandas as pd</span><span id="122a" class="ld le iq kz b gy lj lg l lh li">d1 = {‘Id’: [‘A1’, ‘A2’, ‘A3’, ‘A4’,’A5'],<br/> ‘Name’:[‘Vivek’, ‘Rahul’, ‘Gaurav’, ‘Ankit’,’Vishakha’], <br/> ‘Age’:[27, 24, 22, 32, 28],} <br/> <br/> <br/>d2 = {‘Id’: [‘A1’, ‘A2’, ‘A3’, ‘A4’],<br/> ‘Address’:[‘Delhi’, ‘Gurgaon’, ‘Noida’, ‘Pune’], <br/> ‘Qualification’:[‘Btech’, ‘B.A’, ‘Bcom’, ‘B.hons’]}</span><span id="a679" class="ld le iq kz b gy lj lg l lh li">df1=pd.DataFrame(d1)<br/>df2=pd.DataFrame(d2)</span></pre><p id="e63b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例1。合并公共列' Id '上的数据</strong></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="9e6b" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">#Inner Join</strong><br/>pd.merge(df1,df2)<br/>#simple merge with no additional arguments performs an inner/equi join equivalent to data base join operation</span><span id="4a84" class="ld le iq kz b gy lj lg l lh li">pd.merge(df1,df2, how='inner)<br/>#produces output similar as above, as pandas merge by default is an equi join</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/dcfff7c255cbfc5965e0316e417cf8e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*smrww32drYqqLKYON6lYFQ.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">合并内部</figcaption></figure><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="9f14" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">#Left Join</strong><br/>pd.merge(df1,df2,how=’left’)</span><span id="9e39" class="ld le iq kz b gy lj lg l lh li">#matching and non matching records from left DF which is df1 is present in result data frame</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/24aa02782f97b8fee1c9202c6b032c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*eg-0SMDFJX0UFJCQyVU1EA.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">向左合并</figcaption></figure><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="76df" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">#Right Join</strong><br/>pd.merge(df1,df2,how=’right’)</span><span id="561a" class="ld le iq kz b gy lj lg l lh li">#matching and non matching records from right DF, df2 will come in result df<br/>#as of now we dont have any non matching record in right df</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/dc722e63104fb73d2717b26603950cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*vuT0NNWvhVAxGsRkdesGzg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">向右合并</figcaption></figure><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="3ec2" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">#outer join</strong><br/>pd.merge(df1,df2,how=’outer’)</span><span id="57f9" class="ld le iq kz b gy lj lg l lh li">#all the matching and non matching records are available in resultant dataset from both data frames</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/9c520aea6e0aef50daf0de73f77dd0e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*FmzauxX-qazqv7FaoYCpAw.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">合并全外部</figcaption></figure><p id="ef7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">情况2:合并没有公共列的数据帧</strong></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="6c3a" class="ld le iq kz b gy lf lg l lh li">#changed the merging key in data frame d2</span><span id="b80d" class="ld le iq kz b gy lj lg l lh li">import pandas as pd</span><span id="70f1" class="ld le iq kz b gy lj lg l lh li">d1 = {‘Id’: [‘A1’, ‘A2’, ‘A3’, ‘A4’,’A5'],<br/> ‘Name’:[‘Vivek’, ‘Rahul’, ‘Gaurav’, ‘Ankit’,’Vishakha’], <br/> ‘Age’:[27, 24, 22, 32, 28],} <br/> <br/> <br/>d2 = {‘ID’: [‘A1’, ‘A2’, ‘A3’, ‘A4’],<br/> ‘Address’:[‘Delhi’, ‘Gurgaon’, ‘Noida’, ‘Pune’], <br/> ‘Qualification’:[‘Btech’, ‘B.A’, ‘Bcom’, ‘B.hons’]}</span><span id="94fe" class="ld le iq kz b gy lj lg l lh li">df1=pd.DataFrame(d1)<br/>df2=pd.DataFrame(d2)</span><span id="2eaa" class="ld le iq kz b gy lj lg l lh li">#lets check when merging keys are different ('Id' and 'ID')<br/>pd.merge(df1,df2)</span></pre><p id="b805" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">合并导致以下错误:</p><blockquote class="lv lw lx"><p id="a08d" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated"><strong class="jp ir">合并错误</strong>:没有要执行合并的公共列。</p></blockquote><p id="c3b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了克服合并错误，我们可以使用pandas参数' left_on '和' right_on '来明确指示pandas要在哪些键列上合并数据帧，其余一切保持类似。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="7d00" class="ld le iq kz b gy lf lg l lh li">#df1 key column 'Id'<br/>#df2 key column 'ID'</span><span id="d0c7" class="ld le iq kz b gy lj lg l lh li">pd.merge(df1,df2,left_on=’Id’,right_on=’Id’,how=’left’)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/b727a48e88201f3758ceaeda7791401f.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*I04GUG8NfgbwDtsOhA_a6Q.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">合并不常用键</figcaption></figure><p id="5aa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。join()用于组合键列或索引上的数据。</strong></p><p id="58cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建两个数据框并了解连接的工作原理。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="df09" class="ld le iq kz b gy lf lg l lh li">import pandas as pd<br/>df1 = pd.DataFrame({‘key’: [‘K0’, ‘K1’, ‘K5’, ‘K3’, ‘K4’, ‘K2’],<br/> ‘A’: [‘A0’, ‘A1’, ‘A5’, ‘A3’, ‘A4’, ‘A2’]})<br/>df2 = pd.DataFrame({‘key’: [‘K0’, ‘K1’, ‘K2’],<br/> ‘B’: [‘B0’, ‘B1’, ‘B2’]})</span></pre><p id="3588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例1。加入索引</strong></p><p id="8f55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，对索引执行pandas连接操作。两个数据框都有默认的索引值，因此无需指定任何连接键，连接将隐式地对索引执行。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="0fde" class="ld le iq kz b gy lf lg l lh li">#default nature of pandas join is left outer join<br/>df1.join(df2, lsuffix=’_l’, rsuffix=’_r’)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi md"><img src="../Images/22d9ee53d212e2001915697a4fc6bf5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*oHHq7-iCMgrDaaaI-Veayg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">向左加入</figcaption></figure><p id="7cf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果pandas join中有重叠的列，它将抛出错误:</p><blockquote class="lv lw lx"><p id="7d9b" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated"><strong class="jp ir">值错误</strong>:列重叠，但没有指定后缀:Index(['key']，dtype='object ')</p></blockquote><p id="4a61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">借助下面的用例，尝试理解pandas连接的默认性质，即左外连接。</p><p id="d3fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建两个具有不同索引值的数据框</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="953c" class="ld le iq kz b gy lf lg l lh li">df1 = pd.DataFrame({‘key’: [‘K0’, ‘K1’, ‘K5’, ‘K3’, ‘K4’, ‘K2’],<br/> ‘A’: [‘A0’, ‘A1’, ‘A5’, ‘A3’, ‘A4’, ‘A2’]},<br/> index=[0,1,2,3,4,5])</span><span id="dca3" class="ld le iq kz b gy lj lg l lh li">df2 = pd.DataFrame({‘key’: [‘K0’, ‘K1’, ‘K2’],<br/> ‘B’: [‘B0’, ‘B1’, ‘B2’]},<br/> index=[6,7,8])</span><span id="912c" class="ld le iq kz b gy lj lg l lh li">df1.join(df2,lsuffix=’_l’,rsuffix=’_r’)</span><span id="c056" class="ld le iq kz b gy lj lg l lh li">#df1 is left DF and df2 is right DF</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi me"><img src="../Images/cae361ac43b18cea3e7c8ca1a8f6ce53.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*ft1l_enzxGIoHcoHfuhMow.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">非匹配索引</figcaption></figure><p id="8e8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">两个数据框中的索引值不同，如果内部/相等连接，结果数据集将为空，但数据从左侧DF (df1)出现。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="f8f0" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">#inner join</strong><br/>df1.join(df2,lsuffix=’_l’,rsuffix=’_r’,how=’inner’)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/8bf71df1d6d316168afcff86409f341d.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*9PiNvtqi663TyKrk1ytD3Q.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">加入内部</figcaption></figure><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="26a4" class="ld le iq kz b gy lf lg l lh li"><strong class="kz ir">#outer join</strong><br/>df1.join(df2,lsuffix=’_l’,rsuffix=’_r’,how=’outer’)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/f45cb54222a61c2ae8546c27060de0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*ckWLikbtAmRVs9avSGi_Xw.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">连接外部</figcaption></figure><p id="14dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例二。连接列</strong></p><p id="4b65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据框也可以在列上连接，但是由于连接在索引上工作，我们需要将连接键转换成索引，然后执行连接，其余都是类似的。</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="4c98" class="ld le iq kz b gy lf lg l lh li">#join on data frame column<br/>df1.set_index(‘key1’).join(df2.set_index(‘key2’))</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/1782fd9584e2f2108da29f7d1cb46855.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/1*mjaHf-AzobfSkBziCIL1wQ.png"/></div></figure><p id="876f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。concat()用于组合跨行或列的数据帧。</strong></p><p id="00d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建两个数据框以了解concat的工作原理。concat是一种垂直操作。</p><p id="fcac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例一。串联轴上的数据帧=0，默认操作</strong></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="e9fa" class="ld le iq kz b gy lf lg l lh li">import pandas as pd<br/>m1 = pd.DataFrame({<br/> ‘Name’: [‘Alex’, ‘Amy’, ‘Allen’, ‘Alice’, ‘Ayoung’],<br/> ‘subject_id’:[‘sub1’,’sub2',’sub4',’sub6',’sub5'],<br/> ‘Marks_scored’:[98,90,87,69,78]},<br/> index=[1,2,3,4,5])</span><span id="9770" class="ld le iq kz b gy lj lg l lh li">m2 = pd.DataFrame({<br/> ‘Name’: [‘Billy’, ‘Brian’, ‘Bran’, ‘Bryce’, ‘Betty’],<br/> ‘subject_id’:[‘sub2’,’sub4',’sub3',’sub6',’sub5'],<br/> ‘Marks_scored’:[89,80,79,97,88]},<br/> index=[4,5,6,7,8])</span><span id="6f27" class="ld le iq kz b gy lj lg l lh li">pd.concat([m1,m2])</span></pre><p id="a81d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">两个数据帧的索引都保留在concat操作中。</p><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/5085019e95e0a6f0e9c9d3b166ddb064.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*MzE4cK20yoyv00F9mLVqLw.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">串联</figcaption></figure><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="70ef" class="ld le iq kz b gy lf lg l lh li">#ignore indexes from original data frames<br/>pd.concat([m1,m2],ignore_index=True)</span></pre><p id="068e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与以前的输出不同，索引值被赋予了序列号</p><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/83b690a515df272717d0873d1045eed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*GzU-q8UqVWCpNUP5TNgXBQ.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">忽略索引</figcaption></figure><p id="1a3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例二。轴上的串联操作=1，水平操作</strong></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="2b3e" class="ld le iq kz b gy lf lg l lh li">#axis=1 works as join operation<br/>pd.concat([m1,m2],axis=1)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/24a10b6daa8975a7309b20978ce22df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*w2xtq-VOPHt5qsuYYxZqFw.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">连接为连接</figcaption></figure><p id="4fd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例三。连接不同形状的数据帧</strong></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="62b2" class="ld le iq kz b gy lf lg l lh li">df1 = pd.DataFrame({‘A’:[1,2,3], ‘B’:[1,2,3]})<br/>df2 = pd.DataFrame({‘A’:[4,5]})</span></pre><p id="9b2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们试图对具有不同列或不同形状的数据帧的df1和df2执行concat操作。对不相等形状的数据帧执行串联操作时，pandas会将缺失值更新为NaN。</p><blockquote class="lv lw lx"><p id="a50c" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated">熊猫NaN本质上是浮点型的，因此B系列的值更改为浮点型。</p></blockquote><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="c725" class="ld le iq kz b gy lf lg l lh li">df = pd.concat([df1,df2],ignore_index=True)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/fe750f85ba138b1906b9810e7f6d86f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:274/format:webp/1*rO4iJBxHyEJrRYCSdA1GaQ.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">连接不等形状DF</figcaption></figure><p id="b608" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。append()垂直组合数据帧</strong></p><p id="d313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建两个数据框以了解追加的工作原理。</p><p id="b7eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例一。追加数据帧，重复索引问题</strong></p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="c8bd" class="ld le iq kz b gy lf lg l lh li">m1 = pd.DataFrame({<br/> ‘Name’: [‘Alex’, ‘Amy’, ‘Allen’, ‘Alice’, ‘Ayoung’],<br/> ‘subject_id’:[‘sub1’,’sub2',’sub4',’sub6',’sub5'],<br/> ‘Marks_scored’:[98,90,87,69,78]},<br/> index=[1,2,3,4,5])</span><span id="8bcc" class="ld le iq kz b gy lj lg l lh li">m2 = pd.DataFrame({<br/> ‘Name’: [‘Billy’, ‘Brian’, ‘Bran’, ‘Bryce’, ‘Betty’],<br/> ‘subject_id’:[‘sub2’,’sub4',’sub3',’sub6',’sub5'],<br/> ‘Marks_scored’:[89,80,79,97,88]},<br/> index=[1,2,3,4,5])</span></pre><p id="33b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">带有重叠索引的追加函数抛出错误:</p><blockquote class="lv lw lx"><p id="d011" class="jn jo ly jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated"><strong class="jp ir">值错误</strong>:索引有重叠值:</p></blockquote><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="0068" class="ld le iq kz b gy lf lg l lh li">m1.append(m2,verify_integrity=False)<br/>#verify_integrity=False is default argument<br/>m1.append(m2)</span><span id="ecbc" class="ld le iq kz b gy lj lg l lh li">#output will be similar for both above lines of code</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/bb9e5285b45592003274276d439ad15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*8ovBBxTX0bnz-G54KeRiug.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">附加</figcaption></figure><p id="689f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">案例二。附加形状不等的数据帧</strong></p><p id="592c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建两个具有不同形状的新数据框</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="52ee" class="ld le iq kz b gy lf lg l lh li">m1 = pd.DataFrame({<br/> ‘Name’: [‘Vivek’, ‘Vishakha’, ‘Ash’, ‘Natalie’, ‘Ayoung’],<br/> ‘subject_id’:[‘sub1’,’sub2',’sub4',’sub6',’sub5'],<br/> ‘Marks_scored’:[98,90,87,69,78],<br/> ‘Rank’:[1,3,6,20,13]},<br/> index=[1,2,3,4,5])</span><span id="c60c" class="ld le iq kz b gy lj lg l lh li">m2 = pd.DataFrame({<br/> ‘Name’: [‘Barak’, ‘Wayne’, ‘Saurav’, ‘Yuvraj’, ‘Suresh’],<br/> ‘subject_id’:[‘sub2’,’sub4',’sub3',’sub6',’sub5'],<br/> ‘Marks_scored’:[89,80,79,97,88],},<br/> index=[1,2,3,4,5])</span><span id="5d3a" class="ld le iq kz b gy lj lg l lh li">m1.append(m2)</span></pre><figure class="ku kv kw kx gt ll gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/16a8843063fb86aad7bc12797895a459.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*tieRstDzaVt6P7Jw0SEs0w.png"/></div></figure><h1 id="233f" class="mo le iq bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">总结:</h1><p id="3925" class="pw-post-body-paragraph jn jo iq jp b jq nl js jt ju nm jw jx jy nn ka kb kc no ke kf kg np ki kj kk ij bi translated"><strong class="jp ir"> </strong>熊猫数据集组合操作用例</p><p id="e347" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> </strong>每种组合操作的性质</p><p id="2fe3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> </strong>熊猫合并()，加入()的工作方式和差异</p><p id="773f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> </strong>熊猫concat()、append()的工作方式和区别</p><p id="6682" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢所有人阅读我的博客，如果你喜欢我的内容和解释，请在媒体上关注我，你的反馈将永远帮助我们成长。</p><p id="4d12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢</p><p id="b3b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Vivek Chaudhary</p></div></div>    
</body>
</html>