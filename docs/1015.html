<html>
<head>
<title>Simple Linear Regression Tutorial for Machine Learning (ML)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的简单线性回归教程(ML)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/calculating-simple-linear-regression-and-linear-best-fit-an-in-depth-tutorial-with-math-and-python-804a0cb23660?source=collection_archive---------1-----------------------#2020-10-07">https://pub.towardsai.net/calculating-simple-linear-regression-and-linear-best-fit-an-in-depth-tutorial-with-math-and-python-804a0cb23660?source=collection_archive---------1-----------------------#2020-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/6352f329947a2827d16d77c0e0b3e809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhL0pHDFo0WWfq6r0eFTmw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">来源:图片由作者提供。</figcaption></figure><h2 id="7476" class="jg jh ji bd b dl jj jk jl jm jn jo dk jp translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，<a class="ae ep" href="https://towardsai.net/p/category/editorial" rel="noopener ugc nofollow" target="_blank">编辑</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a>，<a class="ae ep" href="https://towardsai.net/p/category/statistics" rel="noopener ugc nofollow" target="_blank">统计</a></h2><div class=""/><div class=""><h2 id="2d8e" class="pw-subtitle-paragraph ko jr ji bd b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dk translated">通过Python和math中的代码示例，深入计算简单的线性回归和线性最佳拟合</h2></div><p id="9568" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js">作者:</strong> <a class="ae mc" href="https://www.linkedin.com/in/pratik-shukla28/" rel="noopener ugc nofollow" target="_blank">普拉蒂克·舒克拉</a>，<a class="ae mc" href="https://mktg.best/vguzs" rel="noopener ugc nofollow" target="_blank">罗伯特·伊里翁多</a></p><p id="0f2a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最后更新，2021年1月8日</p><div class="is it gp gr iu md"><a href="https://members.towardsai.net/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd js gy z fp mi fr fs mj fu fw jr bi translated">加入我们吧↓ |面向人工智能成员|数据驱动的社区</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">加入人工智能，成为会员，你将不仅支持人工智能，但你将有机会…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">members.towardsai.net</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ja md"/></div></div></a></div><p id="9fe3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js">本教程的代码可在</strong><a class="ae mc" href="https://github.com/towardsai/tutorials/tree/master/simple_linear_regression_tutorial" rel="noopener ugc nofollow" target="_blank"><strong class="li js">Github</strong></a><strong class="li js">上获得，其完整实现也可在</strong><a class="ae mc" href="https://colab.research.google.com/drive/1WRdDbFFykiLv16-Vv-ghsregmfdbwtRX?usp=sharing" rel="noopener ugc nofollow" target="_blank"><strong class="li js">Google Colab</strong></a><strong class="li js">上获得。</strong></p><h2 id="a593" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">目录:</h2><ol class=""><li id="4236" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated"><a class="ae mc" href="#bb0b" rel="noopener ugc nofollow">什么是简单线性回归？</a></li><li id="5bf8" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated"><a class="ae mc" href="#9ae9" rel="noopener ugc nofollow">计算线性最佳拟合</a></li><li id="d8ec" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated"><a class="ae mc" href="#f6e3" rel="noopener ugc nofollow">寻找线性最佳拟合的方程</a></li><li id="29ba" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated"><a class="ae mc" href="#9a2b" rel="noopener ugc nofollow">简单线性回归公式的推导</a></li><li id="191d" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated"><a class="ae mc" href="#8b9a" rel="noopener ugc nofollow">简单线性回归Python从头实现</a></li><li id="857f" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated"><a class="ae mc" href="#4924" rel="noopener ugc nofollow">使用Scikit-learn的简单线性回归</a></li></ol><blockquote class="oa"><p id="dd7e" class="ob oc ji bd od oe of og oh oi oj mb dk translated">📚查看我们的<a class="ae mc" href="https://towardsai.net/p/data-science/gradient-descent-algorithm-for-machine-learning-python-tutorial-ml-9ded189ec556" rel="noopener ugc nofollow" target="_blank">梯度下降</a>教程。📚</p></blockquote></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h1 id="bb0b" class="or mt ji bd mu os ot ou mx ov ow ox na kx oy ky nd la oz lb ng ld pa le nj pb bi translated">什么是简单线性回归？</h1><p id="33f7" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">简单线性回归是一种统计方法，允许我们研究和总结两个连续数量变量之间的关系。简单线性回归用于<a class="ae mc" href="https://mld.ai/mldcmu" rel="noopener ugc nofollow" target="_blank"> <strong class="li js">机器学习</strong> </a>模型、数学、统计建模、预测流行病等定量领域。</p><p id="cb35" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在这两个变量中，一个变量称为因变量，另一个变量称为自变量。我们的目标是根据自变量的值来预测因变量的值。简单的线性回归旨在找到X(自变量)和Y(因变量)之间的最佳关系。</p><p id="4b43" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">有三种类型的关系。我们可以使用其函数预测输出变量的这种关系被称为<strong class="li js">确定性关系</strong>。在<strong class="li js">随机关系</strong>中，变量之间没有关系。在我们的统计世界里，它不太可能有确定性的关系。在统计学中，我们一般会有一个不那么完美的关系，那就是所谓的<strong class="li js">统计关系</strong>，它是确定性和随机性关系的混合体<a class="ae mc" href="https://www.statisticshowto.com/deterministic/" rel="noopener ugc nofollow" target="_blank"> 4 </a>。</p><h2 id="25d4" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">示例:</h2><p id="25ca" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated"><strong class="li js"> 1。确定性关系:</strong></p><p id="f553" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">a.直径= 2 *π*半径</p><p id="efce" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">b.华氏= 1.8 *摄氏+32度</p><p id="90d7" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js"> 2。统计关系:</strong></p><p id="9e6d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">a.巧克力的数量与成本</p><p id="1000" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">b.收入与支出</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pf"><img src="../Images/459f5748b84c3093da0e52f8da064608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jo8wuI9PS6Wnhdol.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图1:确定性关系与统计关系。</figcaption></figure><h2 id="a48c" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">了解简单线性回归:</h2><p id="4df3" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">机器学习中最简单的回归模型是简单线性回归。首先，我们需要知道我们为什么要研究它。为了更好地理解它，我们为什么不从一些住在“比基尼底部”的朋友的故事开始(参考海绵宝宝)[ <a class="ae mc" href="https://en.wikipedia.org/wiki/SpongeBob_SquarePants" rel="noopener ugc nofollow" target="_blank"> 3 </a> ]。</p><p id="8db5" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">海绵宝宝、帕特里克、斯奎沃德和加里住在“比基尼海底！”。一天，Squidward去找海绵宝宝，他们进行了这样的对话。我们去看看。</p><p id="a1e8" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js"> Squidward: </strong>“嘿，海绵宝宝，我听说你很聪明！”</p><p id="039d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js">海绵宝宝:</strong>“是，先生！这是毫无疑问的。”</p><p id="1708" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js"> Squidward: </strong>“是吗？”</p><p id="159a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js">海绵宝宝:</strong>“嗯……是的！”</p><p id="6a83" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">Squidward: “事情是这样的。我想卖掉我的房子，因为我要搬到我在市中心的豪华新房子。但是我不知道我应该以什么价格卖掉我的房子！如果我把价格定得太高，那么没有人会买，如果我把价格定得太低，我可能会面临很大的财务损失！所以你得帮我找到最适合我房子的价格。但是，请记住，你只有一天时间！”</p><p id="96ea" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">海绵宝宝一如既往地强调，但对找到解决办法持乐观态度。为了讨论这个问题，他去了他聪明的朋友帕特里克的家。帕特里克正在他的客厅里看电视，手里拿着一大碗爆米花，海绵宝宝向帕特里克描述了整个情况后:</p><p id="11f2" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js">派屈克:</strong>“那是小事一桩。跟我来！”</p><p id="aba9" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">(他们决定去Squidward的小区，他的两个邻居最近卖掉了他们的房子。经过一番谨慎的调查，他们从斯奎沃德的新邻居那里获得了以下详细情况。现在帕特里克向海绵宝宝解释了整个计划。)</p><p id="475c" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js"> Patrick: </strong>一旦我们有了Squidward附近前一套房子销售情况的基本数据，我想我们可以做一些逻辑推断来预测Squidward的房价。所以让我们得到一些数据。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pk"><img src="../Images/a4b709cab05edc23bbc349c1a407c69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-U38Y8LGn_CrCcvQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图Squidward所在小区的面积和房价。</figcaption></figure><p id="59a8" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">根据收集的数据，Patrick能够将数据绘制成散点图:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/adcfcc18045cc7ada81969a3141d48f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/0*w0ygcWpX2WcuvEP5.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图3:散点图上的面积与房价。</figcaption></figure><p id="0cd3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果我们仔细观察上面的图表，我们可以注意到，我们可以用一条线连接我们的两个数据点，正如我们所知，每条线都有它的方程。从图3中，如果我们有房子的面积，我们可以很快得到房价。如果我们用一些公式来计算房价，那就简单多了。请注意，我们可以通过在图上画一条横线和一条竖线来得到房价，但是要概括一下，我们用的是线方程。首先，我们需要了解一些几何基础知识，并深入研究直线方程。</p><h2 id="a5b2" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">坐标几何基础:</h2><ol class=""><li id="2658" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">我们总是在坐标平面上从左向右看来命名这些点。</li><li id="f9a1" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">从左往右看，我们得到的第一个点一定命名为(x1，y1)，第二个点会是(x2，y2)。</li><li id="e648" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">水平线的斜率为0。</li><li id="a6b6" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">垂直线有一个“无限”的斜率。</li><li id="3d43" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">如果第二个点的Y坐标大于第一个点的Y坐标，则该线具有正(+)斜率。这条线的斜率为负。</li><li id="2692" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">与X轴垂直距离相同的点具有相同的Y坐标。</li><li id="79be" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">与Y轴垂直距离相同的点具有相同的X坐标。</li></ol><p id="770d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在让我们回到我们的图表。</p><p id="5a90" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们都知道这条线的方程式:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/24fa634ac6f866c7d4cbb0b8a77a30bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/0*1tK3npm4wE1JeqgB.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图4:直线方程。</figcaption></figure><p id="4e83" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">根据直线斜率的定义:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/242fe70417c22894e5781d41a7e10291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/0*Crig0-W6ZX-tyiAG.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5:直线斜率方程。</figcaption></figure><p id="4fb9" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">从上面提到的规则，我们可以推断出，在我们的图表中:</p><p id="17b6" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">(X1，Y1) = ( 1500，150000)</p><p id="8ca3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">(X2，Y2) = (2500，300000)</p><p id="45dd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们可以很容易地找到这两点的斜率。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi po"><img src="../Images/67234552c87f44f00eeb5e987f585185.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/0*wSvg9G5hWzP73kSb.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图6:计算我们例子的斜率。</figcaption></figure><p id="8796" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">考虑到我们的例子，在我们的等式中，Y代表房子的价格，X代表房子的面积。</p><p id="18ee" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">既然我们有了所有其他的值，我们可以计算斜率b的值。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pp"><img src="../Images/9602a23f0a2ec171f7550f29719c737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/0*v4qewaO_TBcLA_bP.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图7:计算直线的Y截距。</figcaption></figure><p id="6392" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请注意，我们可以使用任何点来计算斜率值。对于同一条直线，斜率的答案总是相同的。<br/>接下来，由于我们有了所有的参数，我们可以将直线方程写成:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/75e98a1fc3a1457436242c019e6afa9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/0*16-6ZttzBrSqMXdZ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图8:直线方程。</figcaption></figure><p id="b74f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了求出Squidward的房子的价格，我们需要在上式中代入X=1800。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/8d397a755d90e3227ff83db8f3012ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/0*bcas7ECmbMBsb91v.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图9:预测Squidward的房价。</figcaption></figure><p id="e1ce" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，我们可以说Squidward应该以195，000.00美元的价格出售他的房子。那很容易。</p><p id="cf57" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请注意，我们只有两个数据点来快速绘制一条穿过它们的直线，并得到直线方程。在这种情况下，需要注意的关键点是，我们的预测将取决于两个数据点的值。如果我们改变两个可用数据点中任何一个的值，我们的预测很可能也会改变。为了解决这个问题，我们有了大量的数据集。真实世界的数据集可能包含数百万个数据点。</p><p id="a67f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在让我们回到我们的例子。当我们的数据集中有两个以上的数据点时(通常的情况)，我们不能画一条穿过所有点的直线，对吗？这就是为什么我们将使用最适合我们的数据集的线。这条线被称为最佳拟合线或回归线。通过使用这条线的方程，我们将对数据集进行预测。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/2d119bea6bbbb16a427695dfa6589af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*VQ8ZAusk4wJb9FuS.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图10:散点图上的面积与房价。</figcaption></figure><p id="970f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请注意，中心概念保持不变。我们会找到直线和插件X的值(自变量)的方程，从而找到Y的值(因变量)。我们需要找到数据集的最佳拟合线。</p><h1 id="9ae9" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">计算线性最佳拟合</h1><p id="ddc8" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">正如我们在图11中看到的，我们不能画出一条穿过所有点的直线。所以我们能做的就是尽量减小误差。意思是我们找一根杠，然后找预测误差。既然这里有了实际值，就很容易找到预测的误差。我们的最终目标是找到误差最小的那条线。那条线被称为<strong class="li js">线性最佳拟合</strong>。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi py"><img src="../Images/1821b41bef49b2ec12c7671b41c20c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/0*bqfYIY8YhITaxc8s.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图11:计算线性最佳拟合。</figcaption></figure><p id="e112" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如上所述，我们的目标是为我们的数据集找到<strong class="li js">线性最佳拟合</strong>，或者换句话说，我们的目标应该是减少预测中的误差。现在的问题是，我们如何计算误差？测量散乱点和线之间距离的一种方法是找出它们的Y值之间的距离。</p><p id="3933" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了更好地理解它，让我们回到我们实际的房价预测例子。我们知道面积为1800平方英尺的房子实际售价为22万美元。如果我们根据直线方程预测房价，也就是Y = 150X-75000，我们得到的房价是19.5万美元。现在我们可以看到有一个预测误差。</p><p id="6a70" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">因此，我们可以使用误差平方和计算技术来找出每个数据点的预测误差。我们随机选择我们线路的参数，然后计算误差。之后，我们将再次调整参数，然后计算误差。</p><p id="e7d1" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们将重复这一过程，直到得到尽可能小的误差。这个过程是梯度下降算法的一部分，我们将在后面的教程中介绍。我们认为现在很清楚，我们将重新计算线的参数，直到我们得到最佳拟合线，或者我们在预测中得到最小误差。</p><h2 id="dfcc" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">1.正误差:</h2><p id="769e" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">实际售价:22万美元</p><p id="fd78" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">预计售价:19.5万美元</p><p id="47e4" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">预测误差:220，000美元–195，000美元= 25，000美元</p><h2 id="6442" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">2.负误差:</h2><p id="ab0e" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">实际售价:16万美元</p><p id="6754" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">预计售价:19.5万美元</p><p id="3ab4" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">预测误差:160，000美元-195，000美元=-35，000美元</p><p id="8592" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如我们所看到的，也有可能得到一个负的误差。为了说明负误差，我们平方误差。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/5831995d6faace56a2ec1d106fc46300.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/0*rR_YhCTgB_A3QSPT.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图12:误差总和的公式。</figcaption></figure><p id="6a8e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">考虑到负值，我们将平方误差。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/f14ccd9da3660976db607cb4b2c50516.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/0*SnNlsA1Ih-puRvvt.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图13:误差平方和的公式。</figcaption></figure><p id="4fd6" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们要找到误差最小的一条线的参数。一旦我们有了这些，我们就可以形成一个直线方程，并预测数据集的数据值。我们将在本教程的后面部分讨论这一部分。</p><h2 id="a86d" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">回归线指南:</h2><ol class=""><li id="ba7b" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">当预测值有显著相关性时，使用回归线。</li><li id="a51f" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">保持在数据范围内，确保不要外推。例如，如果数据从10到60，不要试图预测500的值。</li><li id="96fb" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">不要根据另一个群体的回归线对一个群体进行预测。</li></ol><h2 id="e17b" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">线性回归的用例:</h2><ol class=""><li id="b83a" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">身高体重。</li><li id="9b18" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">饮酒量和血液酒精含量。</li><li id="f7a2" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">肺活量和多年吸烟量。</li><li id="250f" class="nk nl ji li b lj nv lm nw lp nx lt ny lx nz mb nr ns nt nu bi translated">行驶速度和耗油量。</li></ol><h1 id="f6e3" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">寻找线性最佳拟合的方程式</h1><p id="86dd" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">在我们深入探究简单线性回归公式的推导之前，我们将尝试在不使用任何公式的情况下找到最佳拟合线参数。考虑下表中的数据点X和Y。下一个表Y '是预测值，Y-Y '给出了预测误差。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/807e0d6d094d94d48de8526487f9e10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/0*ZU5n7iRys0IDoMGp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图14:数据点。</figcaption></figure><p id="819a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们将使用平方和方法来计算误差。因此，我们必须找到(Y-Y ')。请注意，在(Y—Y’)的每一行中，我们有三个术语。首先，我们将深入到公式中去寻找有三项的平方。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/5fdde0268c0bf5bf21f4fbb8325a1407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/0*gzdl2fqfRTs9eiRK.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图15 :( a+b+c)的展开。</figcaption></figure><p id="e5ef" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我们的例子中，每一行的(Y-Y’)值将是:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/df85527656139dfd0478bb48aa738c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*No0cEE7UOT37CQYP.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图16:扩展我们的术语。</figcaption></figure><p id="1795" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，请注意，我们需要将误差平方和公式中的所有平方项相加。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/36b3a53bb1f18f2a8cec57259f0db345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/0*0mc29bZqlVAVVegL.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图17:添加扩展的术语。</figcaption></figure><p id="a892" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们的目标是确定斜率(m)和y截距(b)的值。为了找出这些值，我们将使用二次多项式中顶点的公式。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/f8a1919858172946ac8933964265f164.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/0*2tQRxHYwqAANq6Zo.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图18:二次多项式的顶点。</figcaption></figure><p id="07ab" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们需要重新排列我们的中心方程，使其成为二次多项式形式。正如我们所知，如果我们有两个线性方程，我们可以很快解决他们，并获得所需的值。因此，我们的最终目标将是找到两个线性方程并求解它们。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/c68f57d3e74da0cbe75385aa72fb9054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/0*fQAANfkkqutXspHq.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图19:寻找线性方程。</figcaption></figure><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/50eda96fcd5006b0401a83b87dfdda8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/0*1mUJw9Nbhfd1ZRN7.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图20:寻找线性方程。</figcaption></figure><p id="7059" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们有了两个方程，我们可以求解它们来找到斜率和截距值。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qi"><img src="../Images/752917cb6b1c5d062c52fcf6d894b06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/0*sKgL4mlIORurlBdC.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图32:求解两个线性方程。</figcaption></figure><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/8e470adb7435de9dde613e56fab2ecc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/0*6ger10QOgYG2smkL.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图33:两个线性方程的解。</figcaption></figure><p id="698d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们有了最佳拟合线所需的所有值。因此，我们可以将最佳拟合线写成:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/69218afde147598b3929be38659151d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/0*-lI7WLhvyVhVFTZ0.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图34:直线方程。</figcaption></figure><p id="b0a5" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们也可以用最佳拟合线将数据绘制在散点图上。</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/4758de18413c22bc3906f8b6fedbf28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/0*UDFAuarp478SPVq3.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图35:散点图上的面积与房价。</figcaption></figure><p id="886a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这就是我们如何找到特定数据集的最佳拟合线。我们可以注意到，对于更大的数据集，这个任务可能会很麻烦。作为解决方案，我们将使用一个公式来给出所需的参数值。</p><p id="30c4" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">然而，我们不会深究这个公式。相反，我们将首先了解该公式是如何导出的，然后我们将在Python的代码示例中使用它来理解其背后的数学原理。</p><p id="fc43" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">总之，简单线性回归是一种技术，在这种技术中，我们找到一条最适合我们数据集的直线，一旦我们有了这条直线，我们就可以使用直线方程及其最佳参数，根据自变量的值来预测因变量的值。</p><h1 id="9a2b" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">简单线性回归公式的推导:</h1><ol class=""><li id="32ec" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">我们总共有n个数据点(X，Y)，范围从i=1到i=n。</li></ol><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/cd0e4e44adf5f3781231e117f87200f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:236/format:webp/0*TbrWeL-jcPTxpGT-.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图36:我们的数据点。</figcaption></figure><p id="6980" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">2.我们将线性最佳拟合定义为:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qn"><img src="../Images/edae176eec0cec74f838103d0fb89773.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/0*8R3Vl9Socgie9E7_.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图37:线性最佳拟合。</figcaption></figure><p id="54ed" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">3.我们可以将误差函数写成如下:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/b86cf92769f7858409b9e20570838f65.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/0*Ec2e5WgSnTW8MWkt.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图38:误差平方和。</figcaption></figure><p id="2c6d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">4.我们可以将等式2的值代入等式3:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/17c5b5a637c53bdfb5b234c0e30c7731.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/0*MG0C4T5xkY-yMU-j.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图39:简化误差平方和。</figcaption></figure><p id="30f5" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们的最终目标是找到最佳拟合线。为了找到最佳拟合线，误差函数S应该最小。为了使我们的误差函数S最小，我们必须找到关于a和b，S的一阶导数等于0的地方。</p><h2 id="fe1f" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">寻找a(截距):</h2><ol class=""><li id="769b" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">求S关于a的偏导数:</li></ol><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qq"><img src="../Images/57f8b98a7e6a48908da07e3abbb60fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/0*yT6px-_o0fumMjLN.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图40:S关于a的偏导数。</figcaption></figure><p id="670b" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">2.简化计算:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/4894f22a219d7a26e2c3371eac731d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/0*NYjEQVSmI0Fh77Bw.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图41:简化计算。</figcaption></figure><p id="6c0a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">3.使用偏导的链式法则:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qs"><img src="../Images/c92eb3206374e27b79a9c1c060a8fdbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/format:webp/0*oswu17uyj1JvgMAb.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图42:偏导数的链式法则。</figcaption></figure><p id="5c6c" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">4.寻找偏导数:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qt"><img src="../Images/e38529fc4e68b5b5c0e068bcbc4a95d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/0*dzojhVnRIQIiHoGp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图43:寻找偏导数。</figcaption></figure><p id="7dd2" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">5.综合起来看:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qu"><img src="../Images/d61ae8532915b78c942c78fbd18d1db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/0*pve1bOmpuuaLEbu4.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图44:将它们合并在一起。</figcaption></figure><p id="34fe" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">6.为了找到极值，我们取导数=0:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/fb9843777330f7b3d4fc0d51616d6601.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/0*9lMMMWKmpjIyAByf.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图45:求导= 0。</figcaption></figure><p id="c55f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">7.简化:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qw"><img src="../Images/1dd4c748916d074414536b4ca4510b41.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/0*D5vOQns2DjddBLqp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图46:简化等式。</figcaption></figure><p id="6f95" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">8.进一步简化:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qx"><img src="../Images/9251c5d0fc145e67ed10223798487193.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/0*4XfFsxCHUTUdGTx3.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图47:简化等式。</figcaption></figure><p id="192f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">9.求a的和:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/5a976e1b89b220f23c33719547fb56ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/0*YFJJFZ3CNwTHqR92.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图48:求a的和。</figcaption></figure><p id="87fa" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">10.代入主方程中的值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi qz"><img src="../Images/0a10889993234197a7f2908620db06cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/0*ad-ndmCuSwUDXQHr.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图49:把它放回到主方程中。</figcaption></figure><p id="3843" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">11.简化等式:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ra"><img src="../Images/9426bc84059a980dcfdcdd624fb141f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/0*Zh3b7BsvvyuNhtq9.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图50:简化等式。</figcaption></figure><p id="4283" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">12.进一步简化方程:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rb"><img src="../Images/ce1eba213956c3d753b7247b37a41961.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/0*o3kU2I8ApcRu5hl_.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图51:简化等式。</figcaption></figure><p id="3d15" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">13.简化a值的方程式:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rc"><img src="../Images/3af551642b16b2e842ff339c49c6a0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/0*-8n8TCU3Mt1cwUfz.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图52:a的值。</figcaption></figure><h2 id="c93f" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">结果B(斜率):</h2><ol class=""><li id="24df" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">求S关于B的偏导数:</li></ol><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rd"><img src="../Images/1380943ad70019842cea3fb7f7cc42cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/0*_0nePOsOv8P9te49.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图53:求S关于b的偏导数。</figcaption></figure><p id="f6dc" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">求S关于B的偏导数</p><p id="40b8" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">2.简化计算:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi re"><img src="../Images/72e3030a9f1ebf9f497db3edd72e6df9.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/0*sTUaDEhburpbgTaJ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图54:简化等式。</figcaption></figure><p id="73e2" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">3.使用偏导的链式法则:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rf"><img src="../Images/de3ce0f4c431886e97844fa6dc2c5129.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/0*vd1D1xAYuIrc3Cel.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图55:偏导数的链式法则。</figcaption></figure><p id="27fd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">4.寻找偏导数:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rg"><img src="../Images/67a8326ee2c35df3e3f9b6d8235a820b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/0*_XU0AKkQbRVX01_q.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图56:寻找偏导数。</figcaption></figure><p id="5778" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">5.综合起来看:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rh"><img src="../Images/8ef924db416c3aa4c233ed520810efac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/0*vWqf4M7GTw9llji7.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图57:将计算值放在一起。</figcaption></figure><p id="5af0" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">6.分发Xi:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ri"><img src="../Images/c914158b158eb5088728670d90e6bcf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*2fNpMyRH6ivN-m0q.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图58:分配Xi的价值。</figcaption></figure><p id="fa98" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">7.为了找到极值，我们取导数=0:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rj"><img src="../Images/582805f3427427b3a223e2fe7528d254.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/0*vj91k8DTHSbQvbAh.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图59:求导= 0。</figcaption></figure><p id="f42d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">8.简化:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rk"><img src="../Images/765e4e00b9a2148c07ff70239b7939f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/0*gR0NK7lvYV9acsjp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图60:简化等式。</figcaption></figure><p id="c485" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">9.代入等式中的a值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rl"><img src="../Images/6d1a89a02efa8dbfaf65fcea8ad3a944.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*TO2XUeafADQbgS9U.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图61:替换等式中的值。</figcaption></figure><p id="f4b3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">10.进一步简化:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rm"><img src="../Images/8793b30ba62e453510ceef46bb49c055.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/0*B9jcv-yiNgIQ3-1-.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图62:简化等式。</figcaption></figure><p id="ce5c" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">11.分割总和:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rn"><img src="../Images/6b25ee08164fb30a3b912bd73cbc0adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/0*dacVupnUpYSFhzs7.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图63:拆分术语。</figcaption></figure><p id="cd92" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">12.简化:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ro"><img src="../Images/2738c1a8a476bc5d5c41399b4553f077.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/0*BTsBroQOYJMl3W8P.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图64:简化等式。</figcaption></figure><p id="bcad" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">13.从上面的等式中找到B:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rp"><img src="../Images/56df0d730cf35f36364ba22b54ea8eec.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/0*PJTKziLSGY_3aLtj.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图65:b的值。</figcaption></figure><p id="aa55" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">16.进一步简化方程:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rq"><img src="../Images/c2fe34573e2c97c2eb7e3feff6ee2b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/0*5A3pL9qUs3sd7YcR.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图66:b的值。</figcaption></figure><h2 id="c513" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">找到一个(截距)的一般形式:</h2><ol class=""><li id="5ab9" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">获取a的值:</li></ol><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rr"><img src="../Images/a4351ded5b88a29f6c05951cf7fe5a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/0*-UcTf74dkuwKWwyp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图67:简化等式。</figcaption></figure><p id="9756" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">2.简化公式:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rs"><img src="../Images/9a861d7fdbb62a811470c2102358913d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/0*sVtktMlpIaBphZj0.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图68:a的简化值。</figcaption></figure><h2 id="deb5" class="ms mt ji bd mu mv mw dn mx my mz dp na lp nb nc nd lt ne nf ng lx nh ni nj jo bi translated">简单的线性回归公式:</h2><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rt"><img src="../Images/58f7fe556e74bd68ac661fc45f020d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*h8A4y8W3FLs5qt2P.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图69:简单线性回归公式总结。</figcaption></figure><h1 id="8b9a" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">从头开始简单的线性回归Python实现:</h1><p id="058f" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">在下面用于简单线性回归的Python代码中，我们不会使用Python库来为回归线寻找最优参数；相反，我们将使用前面导出的公式来为数据集找到回归(最佳拟合)线。</p><ol class=""><li id="a353" class="nk nl ji li b lj lk lm ln lp ru lt rv lx rw mb nr ns nt nu bi translated">导入所需的库:</li></ol><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rx"><img src="../Images/f76b40be6b507a1b95b835193d8d20d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/0*AtYB-qvGJ8Rndr5f.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图70:导入所需的库。</figcaption></figure><p id="77ee" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">2.阅读CSV文件:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ry"><img src="../Images/dd35567fda26ff986a9ec6b382b2c639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZZCq9xLPzyvGOdN9.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图71:读取CSV文件。</figcaption></figure><p id="3e4e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">3.获取数据集中的列列表:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi rz"><img src="../Images/050f295a6636628c759e64b1c23ee29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/0*wX3z6E33Md74Mk6d.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图72:我们的数据集的列。</figcaption></figure><p id="3fb1" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">4.检查空值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sa"><img src="../Images/0ab84081b28e2390b340e714fbacd4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/0*AHfmsiNhckqj324E.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图73:检查空值。</figcaption></figure><p id="ce8a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">5.选择构建模型的列:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sb"><img src="../Images/adeb6dffb8af8520878fd92e9059d62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/0*UnlqbJfiErSrHS8z.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图74:感兴趣的列。</figcaption></figure><p id="04a7" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">6.在散点图上绘制数据:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sc"><img src="../Images/b6f1ae9fb30cebfd797500d1d19a2830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/0*33uuXjWKgwCgbMza.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图75:在散点图上绘制数据。</figcaption></figure><p id="35bd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">7.将数据分为训练和测试数据集:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sd"><img src="../Images/a700bb5e3f7479976994901d13cf3d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/0*pfgL6CYwG6QOnfzX.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图76:将数据分成一个测试/训练数据集。</figcaption></figure><p id="7924" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">8.计算线性最佳拟合系数的主函数:</p><p id="ed03" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">以下代码中使用的公式是:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi se"><img src="../Images/5f2c4591fc9b3933316407bdbdae4532.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/0*FBmcBNS3VEDOmAJv.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图77:斜率和截距公式。</figcaption></figure><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sf"><img src="../Images/8c4ed1cad044d56a4d653ba79e63bec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*MuOH2DTFw2C9gIu4.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图78:计算斜率和截距的主函数。</figcaption></figure><p id="b7b0" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">9.使用虚拟数据检查功能的工作情况:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sg"><img src="../Images/c01a9d64d011d7a296a5355e21030788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/0*a55Dx9XEqcbSpAaH.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图79:用样本数据检查工作函数。</figcaption></figure><p id="496a" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">10.用回归线绘制虚拟数据:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sh"><img src="../Images/59e3aed553ada55b18309754ea6c4534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/0*rHqyqvCOZ6TyNEVf.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图80:在我们的散点图上绘制数据。</figcaption></figure><p id="8646" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">11.寻找实际数据集的系数:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi si"><img src="../Images/0d9e71703de8300be5f961536eb8ad32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fpk4Y24fyNE0EBIP.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图81:求斜率和截距。</figcaption></figure><p id="026d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">12.用实际数据绘制回归线:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sj"><img src="../Images/333d0da627c07c24114c45102b9d16de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jKyFOUPuomkyqyVS.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图82:在我们的散点图上绘制数据。</figcaption></figure><p id="6161" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">13.定义预测函数:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sk"><img src="../Images/d58c5033f0384f3ee8206b71694fe1ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/0*y9V23DP6ZiQZCmsj.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图83:定义我们的预测函数。</figcaption></figure><p id="7820" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">14.基于预测函数预测值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sl"><img src="../Images/9b5df49146b4a7ce44b8bdfb758b9518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yNzfJWgpo7QcAA5-.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图84:根据预测函数预测值。</figcaption></figure><p id="c9de" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">15.预测整个数据集的值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sm"><img src="../Images/52d7f9afb73a51a718c042a272cf1135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/0*tfuFmb0Kq-grv_eh.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图85:预测整个数据集的值。</figcaption></figure><p id="56a2" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">16.用回归线绘制测试数据:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sn"><img src="../Images/3efa544cc02d5d7cffa5a9448d50d8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gPJhdzFsfE8O7FXw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图86:用回归线在散点图上绘制测试数据。</figcaption></figure><p id="4313" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">17.用回归线绘制训练数据:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi so"><img src="../Images/d1893f97e99ff06172d561db994c783d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3vfQxt_vbPYt1k0k.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图87:用回归线绘制训练数据。</figcaption></figure><p id="f406" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">18.用回归线绘制完整数据:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sp"><img src="../Images/63245246b28909f1a5c785a00b50831a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2SLklCNXqUzrZnDI.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图88:用回归线在散点图上绘制数据。</figcaption></figure><p id="6a87" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">19.为实际值和预测值创建数据框:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sq"><img src="../Images/b23a4b1fcd282f92e0aea40de00b5f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/0*9J7aMgN4k0VvQYxt.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图89:实际值与预测值。</figcaption></figure><p id="b8c3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">19.绘制实际值和预测值的条形图:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sr"><img src="../Images/d30a41791b3518fd6c39c4198a246221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H2Kgucp1gZgYV8V1.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图90:实际值与预测值的条形图。</figcaption></figure><p id="5cfb" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">20.剩余平方和:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ss"><img src="../Images/10828cd805a9dc1d76912f1c962af6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/0*xwwAUaIKB3ccxxjj.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图91:误差计算功能。</figcaption></figure><p id="a0b8" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">21.计算误差:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi st"><img src="../Images/1988e9e72076800df410e45b6989bb81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JU9Pn9aGVAQnTsox.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图92:计算误差。</figcaption></figure><p id="b5cc" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这就是我们如何用Python从头开始执行简单的线性回归。尽管Python库可以执行所有这些计算而无需深入研究，但了解这些库如何执行这样的数学计算总是一种好的做法。</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="c307" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们将使用Python中的Scikit-learn库来查找同一数据集上的线性最佳拟合回归线。在下面的代码中，我们将看到一种使用Scikit-learn计算简单线性回归的简单方法。</p><h1 id="4924" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">使用Scikit-learn的简单线性回归:</h1><ol class=""><li id="14bf" class="nk nl ji li b lj nm lm nn lp no lt np lx nq mb nr ns nt nu bi translated">导入所需的库:</li></ol><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi su"><img src="../Images/69099c83983098ff43f99944ac41070f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/0*GPQGhdAeMm-eCXqt.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图93:为我们的Scikit实现导入所需的库。</figcaption></figure><p id="22b4" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">2.阅读CSV文件:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sv"><img src="../Images/c73a0343ef3f17c7b40ef09d91f398e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XIgdD7pE_evO5Eua.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图94:读取CSV文件。</figcaption></figure><p id="4a98" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">3.回归模型的特征选择:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sw"><img src="../Images/50d54c13aea8f836d08388845cd28c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2XV6EaTaPPg-jbLT.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图95:特性选择。</figcaption></figure><p id="ee1c" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">4.在散点图上绘制数据点:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sx"><img src="../Images/65e181e974634c6e1db112312c160dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*LmCyxvvVIKKqwIKc.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图96:在散点图上绘制数据点。</figcaption></figure><p id="fed5" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">5.将数据分为测试和训练数据集:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sy"><img src="../Images/05d8a8b76428c1156aefb4c955650116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/0*_gbY4detULhjK_lA.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图97:将我们的数据分为测试和训练。</figcaption></figure><p id="89df" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">6.训练模型:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/f4bb75f09f8653b3571e00fe5aeafef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/0*WW-KzpRH9em02do2.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图98:训练我们的模型。</figcaption></figure><p id="8744" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">7.预测完整数据集的值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sy"><img src="../Images/d89aac5d4f5d7f5eb2a7583c9066ec04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/0*Vu9yLr5_g3zmulaY.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图99:预测值。</figcaption></figure><p id="3d1f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">8.训练数据的预测值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sz"><img src="../Images/b8de36ba7073e371a6d60cd0945d0238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/0*djGW3rrM3adj_3tB.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图100:预测我们的训练数据集的值。</figcaption></figure><p id="5d27" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">9.测试数据的预测值:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi ta"><img src="../Images/b18def4d32935b9f855bdf60a39d00aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/0*2ZiCia30bdOPLmeX.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图101:预测我们的测试数据集的值。</figcaption></figure><p id="639b" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">10.绘制完整数据的回归线:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi tb"><img src="../Images/40b8933af789d65ad817dee527eec7af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/0*9MtfF-L2RDv_DuHk.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图102:用回归线在散点图上绘制数据。</figcaption></figure><p id="a909" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">11.用训练数据绘制回归线:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi tc"><img src="../Images/e91393ef8ec6abb44399bcde0fc75cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*HH_WOrHyQJyBmOGk.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图103:用回归线在散点图上绘制训练数据。</figcaption></figure><p id="b152" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">12.用测试数据绘制回归线；</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi td"><img src="../Images/6f8ceb60e09dd9c0b87073ea16f2f606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*hwnHGOlccrFVyeoN.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图104:用回归线在散点图上绘制测试数据。</figcaption></figure><p id="6377" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">13.为实际数据点和预测数据点创建数据框架:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi te"><img src="../Images/a2f7391dab7a1f0d262abfcedb81280e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8OaH9FCIldtVphvT.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图105:实际值和预测值的数据框。</figcaption></figure><p id="185b" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">14.绘制实际值和预测值的条形图:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi tf"><img src="../Images/5c95907472156bb89db0f109b0d3941f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4Y4HNO4-sNXkI4_8.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图106:绘制实际值与预测值的条形图。</figcaption></figure><p id="fbe3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">15.预测中的计算误差:</p><figure class="pg ph pi pj gt iv gh gi paragraph-image"><div class="gh gi sx"><img src="../Images/71e5e385ed308590f274a9be6fd931eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*lCmCdjvMdEgB4UyT.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图107:计算预测误差。</figcaption></figure><p id="b74d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这里我们可以看到，即使我们使用Scikit-learn库，我们也得到了相同的输出。因此，我们可以肯定，我们进行的所有计算和我们理解的推导都是精确的。</p><p id="621e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请注意，还有其他方法来计算预测误差，我们将在未来的教程中介绍这些方法。</p><p id="9842" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这就是本教程的全部内容。我们希望你喜欢它，并从中学习到新的东西。如果您有任何反馈，请给我们留下评论或直接发送电子邮件。感谢您的阅读！</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><figure class="pg ph pi pj gt iv gh gi paragraph-image"><a href="https://www.buymeacoffee.com/pratu"><div class="gh gi tg"><img src="../Images/7ba4f2d6d12c187d5442ad1a88605fe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-5oP6Xss4YY44doo.png"/></div></a><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">给普拉蒂克买杯咖啡！</figcaption></figure><p id="a49f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li js">免责声明:</strong>本文仅代表作者个人观点，不代表卡耐基梅隆大学的观点。这些文章并不打算成为最终产品，而是当前思想的反映，同时也是讨论和改进的催化剂。</p><p id="8f47" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">通过<a class="ae mc" href="https://towardsai.net/" rel="noopener ugc nofollow" target="_blank">向艾</a>发布</p><h1 id="f40d" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">资源:</h1><p id="0f4e" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated"><a class="ae mc" href="https://colab.research.google.com/drive/1WRdDbFFykiLv16-Vv-ghsregmfdbwtRX?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google colab实现</a>。</p><p id="02ea" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><a class="ae mc" href="https://github.com/towardsai/tutorials/tree/master/simple_linear_regression_tutorial" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p><h1 id="d41b" class="or mt ji bd mu os pt ou mx ov pu ox na kx pv ky nd la pw lb ng ld px le nj pb bi translated">参考资料:</h1><p id="82fe" class="pw-post-body-paragraph lg lh ji li b lj nm ks ll lm nn kv lo lp pc lr ls lt pd lv lw lx pe lz ma mb im bi translated">[1]什么是简单线性回归，宾夕法尼亚州立大学，<a class="ae mc" href="https://online.stat.psu.edu/stat462/node/91/" rel="noopener ugc nofollow" target="_blank">https://online.stat.psu.edu/stat462/node/91/</a></p><p id="910e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">[2]scikit-学习，入门，<a class="ae mc" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/</a></p><p id="0394" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">[3]维基百科，https://en.wikipedia.org/wiki/SpongeBob_SquarePants<a class="ae mc" href="https://en.wikipedia.org/wiki/SpongeBob_SquarePants" rel="noopener ugc nofollow" target="_blank">海绵宝宝</a></p><p id="782e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">[4]决定论:定义和例子，统计学如何，<a class="ae mc" href="https://www.statisticshowto.com/deterministic/" rel="noopener ugc nofollow" target="_blank">https://www.statisticshowto.com/deterministic/</a></p></div></div>    
</body>
</html>