<html>
<head>
<title>NLP using DeepLearning Tutorials: A Sentiment Classifier based on perceptron (Part 4/4)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习教程的NLP:基于感知器的情感分类器(第4/4部分)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-4-4-1022ed17d17d?source=collection_archive---------2-----------------------#2022-06-23">https://pub.towardsai.net/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-4-4-1022ed17d17d?source=collection_archive---------2-----------------------#2022-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/fb9e467b303085310e38fd6f16c6e66a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGLNMVZzkRdlQErPrESsGQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">该图像上传自<a class="ae kf" href="https://files.realpython.com/media/Use-Sentiment-Analysis-With-Python-to-Classify-Reviews_Watermarked.e73ba441d870.jpg" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="0e2c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">自然语言处理是机器学习中最复杂的领域之一，基本上是由于语言的复杂性和模糊性。然而，它也是最成功的领域之一，有许多我们每天都在使用的真实应用，像搜索引擎、翻译工具等等。</p><p id="b010" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有时最复杂的任务可以用最简单的技术解决。在这篇文章中，我将尝试探索这种说法。所以，我将基于最简单的神经网络“感知器”提出一个完整的情感分析解决方案，使用一个真实世界的任务和数据集:对Yelp上的餐厅评论进行正面或负面分类。</p><p id="6e0f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我将本文分为以下四个部分:</p><ol class=""><li id="b134" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">Yelp数据集评论(<a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-1-4-712eefe20899">链接</a></li><li id="38e1" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">词汇和矢量器(<a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-2-4-f9b90b3a06bd">链接</a>)</li><li id="7b4a" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">训练套路<strong class="ki iu"> </strong> ( <a class="ae kf" rel="noopener ugc nofollow" target="_blank" href="/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-3-4-88fd202dba2c">环节</a>)</li><li id="3a77" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">评估与推理(当前文章关注这部分)</strong></li></ol><blockquote class="ls lt lu"><p id="306e" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated"><strong class="ki iu">提前感谢大家的支持。如果你决定注册成为灵媒会员，这里是我的订阅页面</strong>:<a class="ae kf" href="https://abdelkader-rhouati.medium.com/membership" rel="noopener">https://abdelkader-rhouati.medium.com/membership</a></p></blockquote></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6763" class="mg mh it bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">第四部分:<strong class="ak">评估和推断</strong></h1><p id="a5f7" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">在训练例程之后，我们在上一篇文章中解释了，接下来的步骤是在测试数据集上评估模型，并使用它来推断新数据。</p><h2 id="1d5d" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">测试数据的评估</h2><p id="40c4" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">机器学习的评估是一个很大的研究领域。对于像我这样的情感分类器模型，许多测量和方法都是可能的。这个题目在这篇文章里解释的很好:<a class="ae kf" href="https://www.jeremyjordan.me/evaluating-a-machine-learning-model/" rel="noopener ugc nofollow" target="_blank">链接</a>。在这个例子中，为了简单起见，我们将只根据模型的准确性来评估它。</p><p id="60dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">评估的代码与训练例程中的验证步骤完全相同，但使用了“test”数据集而不是“val”:dataset . set _ split(“test”)。</p><p id="561f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还使用代码:classifier.eval()将模型置于“eval”模式。在这种模式下，在对测试数据集进行预测的过程中，不会更新模型权重。因此，我们可以使用测试准确性作为模型性能的精确度量。</p><figure class="nv nw nx ny gt ju"><div class="bz fp l di"><div class="nz oa l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在测试数据集上评估模型</figcaption></figure><p id="5d4f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们得到以下测试精度:</p><pre class="nv nw nx ny gt ob oc od oe aw of bi"><span id="7533" class="nj mh it oc b gy og oh l oi oj">Test Loss: 0.5374936538511884<br/>Test Acc: 0.930599256292907</span></pre><h2 id="803c" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">使用新的审查数据进行推断</h2><p id="f77a" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">评估模型的另一种方法是对新的综述数据进行推断。</p><p id="2edd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">推理评估基于定性判断。我们使用该模型在非常小的数据点(一般少于10个)上预测情绪，并逐一评估其性能。</p><figure class="nv nw nx ny gt ju"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0acd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下示例是推理测试结果的示例，它说明了模型的良好准确性。</p><pre class="nv nw nx ny gt ob oc od oe aw of bi"><span id="e1fc" class="nj mh it oc b gy og oh l oi oj">this is a pretty awesome book -&gt; positive</span></pre><h2 id="070c" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">保存和加载模型</h2><p id="8b3e" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">保存和加载模型的可能性允许使用模型预测，而不需要每次都重新进行训练，这需要几个小时甚至几天。这一特性使得在真实情况下部署机器学习模型成为可能。接下来的两节给出了一个保存和加载模型的简单方法。但是，还有更多设置选项和参数，例如，保存一个检查点，您可以在其中恢复模型训练。更多细节，可以参考<a class="ae kf" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html" rel="noopener ugc nofollow" target="_blank">这里</a>的文档。</p><p id="2242" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">保存模型:</strong></p><pre class="nv nw nx ny gt ob oc od oe aw of bi"><span id="c66d" class="nj mh it oc b gy og oh l oi oj">torch.save(classifier.state_dict(), "./saved_model/classifier")</span></pre><p id="fb55" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">加载模型:</strong></p><pre class="nv nw nx ny gt ob oc od oe aw of bi"><span id="9428" class="nj mh it oc b gy og oh l oi oj">model = ReviewClassifier(num_features=len(vectorizer.review_vocab))<br/>model.load_state_dict(torch.load("./saved_model/classifier"))<br/>model.eval()</span></pre><h2 id="ee6e" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">所有项目的代码</h2><p id="85ce" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">最后，您可以在我的git存储库中找到“使用感知器的情感分类模型”项目的所有代码:</p><div class="ok ol gp gr om on"><a href="https://github.com/arhouati/NLP_with_Pytorch/tree/master/Chapter-3/3.8_ClassfyingSentiment" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">NLP _ with _ py torch/Chapter-3/3.8 _ master arhouati的分类检测/NLP_with_Pytorch</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">这个库包含了Delip Rao和…所著的《用PyTorch进行自然语言处理》一书的所有实例</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">github.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb jz on"/></div></div></a></div><h1 id="9462" class="mg mh it bd mi mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd bi translated">结论</h1><p id="9b61" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">在这一系列文章中，我介绍了监督神经网络的一些基本原理和概念。我选择使用评论情感分类的案例研究，并使用最基本的神经网络“感知”。任何其他神经网络都遵循相同的阶段和步骤。</p><p id="46ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为简历，我们在4篇文章中谈到:</p><ul class=""><li id="8bdd" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld ph lk ll lm bi translated">最简单的神经网络模型感知器的概念</li><li id="f130" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ph lk ll lm bi translated">机器学习的一些主要概念如激活函数和损失函数。</li><li id="26d8" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ph lk ll lm bi translated">Yelp数据集的详细回顾，作为学习和实验NLP机器学习模型的良好数据集</li><li id="5e52" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ph lk ll lm bi translated">将单词转换成数字向量，这是在自然语言上实现神经网络所必需的。</li><li id="5f86" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ph lk ll lm bi translated">历元上的训练例程和使用一批数据集</li><li id="2bb0" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld ph lk ll lm bi translated">最后，如何评估一个模型</li></ul><h1 id="38ce" class="mg mh it bd mi mj pc ml mm mn pd mp mq mr pe mt mu mv pf mx my mz pg nb nc nd bi translated">参考资料:</h1><p id="2f84" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated"><strong class="ki iu"> 1。《用Pytorch进行自然语言处理》一书(</strong><a class="ae kf" href="https://www.amazon.fr/Natural-Language-Processing-Pytorch-Applications/dp/1491978236" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">https://www . Amazon . fr/Natural-Language-Processing-py torch-Applications/DP/1491978236</strong></a><strong class="ki iu">)</strong></p><p id="c397" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 2。保存和加载模型(</strong><a class="ae kf" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">)https://py torch . org/tutorials/初学者/saving _ Loading _ Models . html</strong></a><strong class="ki iu">)</strong></p><p id="4b6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 3。一个机器学习模型的评测(</strong><a class="ae kf" href="https://www.jeremyjordan.me/evaluating-a-machine-learning-model/" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">)https://www . Jeremy Jordan . me/evaluating-a-machine-learning-model/</strong></a><strong class="ki iu">)</strong></p></div></div>    
</body>
</html>