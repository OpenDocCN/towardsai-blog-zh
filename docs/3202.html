<html>
<head>
<title>Encoding Categorical Data- The Right Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类数据编码——正确的方法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/encoding-categorical-data-the-right-way-4c2831a5755?source=collection_archive---------2-----------------------#2022-10-11">https://pub.towardsai.net/encoding-categorical-data-the-right-way-4c2831a5755?source=collection_archive---------2-----------------------#2022-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aff7cdafa7aacde6f98c45a3d6ee148e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wVXC-ANjh8TeH9njFLukiw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Icons8团队提供的照片来自Unsplash</figcaption></figure><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="311f" class="kl km iq kh b gy kn ko l kp kq"><strong class="kh ir">Table of Contents</strong></span><span id="b173" class="kl km iq kh b gy kr ko l kp kq">· <a class="ae ks" href="#d708" rel="noopener ugc nofollow">Types of Data</a><br/>  ∘ <a class="ae ks" href="#b4c2" rel="noopener ugc nofollow">Continuous Data</a><br/>  ∘ <a class="ae ks" href="#8bdf" rel="noopener ugc nofollow">Discrete Data</a><br/>  ∘ <a class="ae ks" href="#f86d" rel="noopener ugc nofollow">Nominal Data</a><br/>  ∘ <a class="ae ks" href="#bc98" rel="noopener ugc nofollow">Ordinal Data</a></span><span id="2efc" class="kl km iq kh b gy kr ko l kp kq">· <a class="ae ks" href="#6222" rel="noopener ugc nofollow">How to Encode Categorical data?</a><br/>  ∘ <a class="ae ks" href="#8bac" rel="noopener ugc nofollow">Ordinal Encoding</a><br/>  ∘ <a class="ae ks" href="#99b1" rel="noopener ugc nofollow">Nominal Encoding</a><br/>  ∘ <a class="ae ks" href="#23f3" rel="noopener ugc nofollow">OneHotEncoding using Pandas</a><br/>  ∘ <a class="ae ks" href="#3848" rel="noopener ugc nofollow">Dummy Variable Trap</a><br/>  ∘ <a class="ae ks" href="#908d" rel="noopener ugc nofollow">OneHotEncoding using Sklearn</a></span></pre><h1 id="d708" class="kt km iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">数据类型</h1><p id="a6a1" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">在统计学和机器学习中，我们将数据分为两种类型，即<strong class="ls ir">数值型</strong>和<strong class="ls ir">分类型</strong></p><blockquote class="mo mp mq"><p id="f407" class="lq lr mr ls b lt ms lv lw lx mt lz ma mu mv md me mw mx mh mi my mz ml mm mn ij bi translated"><strong class="ls ir">数值</strong>数据分为<strong class="ls ir">离散</strong>和<strong class="ls ir">连续</strong>数据。<strong class="ls ir">分类</strong>数据分为两种类型，<strong class="ls ir">名义</strong>数据，和<strong class="ls ir">序数</strong>数据。</p></blockquote><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/f1ed2210f30af570c62515b88433ae98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3SAM6jdJOtWmUvozF8vEKw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者解释数据类型的图片</figcaption></figure><h2 id="b4c2" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">连续数据</h2><p id="8621" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">连续数据是采用任意数字的数据(可以包括小数值)。它有无限多的可能值，可以在给定的特定范围内选择。</p><p id="840a" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">举例:</strong>一个人的体重身高，体温，年龄，距离。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/d7f7871afa01ae5f572ecc1ebc9a31eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*qX4z1D_CyR7XyEoPlHGVAA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</figcaption></figure><div class="nn no gp gr np nq"><a rel="noopener  ugc nofollow" target="_blank" href="/step-by-step-approach-to-building-a-recommendation-system-a65be5a54045"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">一个完整的基于端到端机器学习的推荐项目</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">基于协同过滤和流行度过滤的机器学习推荐方案</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">pub.towardsai.net</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe jw nq"/></div></div></a></div><h2 id="8bdf" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">离散数据</h2><p id="9220" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">离散数据只能取离散值(不能有小数值)。离散信息只包含有限数量的可能值。这些价值无法进行有意义的细分。在这里，事情可以用整数来计算。</p><p id="88a1" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">举例:</strong>一个家庭的人数，一个人可以拥有的银行账户数，一个教室的学生数，一场足球赛的进球数。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/5d52e2fcd7e47295828db357629f23fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*4h9VScvgMRhDOqqzm8tA3Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</figcaption></figure><div class="nn no gp gr np nq"><a href="https://medium.com/@gowthamsr37/outlier-detection-and-treatment-9a9f41df0fb2" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">我们应该如何检测和处理异常值？</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">什么是离群值？我们需要如何检测异常值？我们需要如何处理异常值？</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="og l ob oc od nz oe jw nq"/></div></div></a></div><h2 id="f86d" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">标称数据</h2><p id="cf17" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">名义数据被定义为用于命名或标记变量而没有任何定量值的数据。它有时被称为“命名”数据。</p><p id="1a18" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">名义数据通常没有内在的顺序。例如，性别是一个名义变量，有两个类别，但没有特定的方式从最高到最低排序，反之亦然。</p><p id="fe06" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">例子:</strong>字母、符号、单词、性别、颜色等。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/1d61f02cf9304d0e7c08c3f2af7b9323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y6pE7rWQ7PJGf1xtvgTQfQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</figcaption></figure><h2 id="bc98" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">序数数据</h2><p id="a287" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">序数数据是一种遵循自然顺序的数据。它是一种有序的分类数据。序数数据中的变量是按顺序排列的。</p><p id="ea25" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">示例:</strong>客户评级(好、一般、差)、奥运会奖牌类别(金、银、铜)</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/59572ab1ebb79a671b4da5ca6980dd79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCsLznDxvo-HubkNG8XHtg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</figcaption></figure><div class="nn no gp gr np nq"><a href="https://medium.com/@gowthamsr37/pattern-programming-in-python-23d5af04211e" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">用Python编写复杂模式的简单方法，仅需4分钟。</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">用python编写复杂模式程序的简单方法</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oj l ob oc od nz oe jw nq"/></div></div></a></div></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h1 id="6222" class="kt km iq bd ku kv or kx ky kz os lb lc ld ot lf lg lh ou lj lk ll ov ln lo lp bi translated">分类数据如何编码？</h1><blockquote class="mo mp mq"><p id="1b16" class="lq lr mr ls b lt ms lv lw lx mt lz ma mu mv md me mw mx mh mi my mz ml mm mn ij bi translated">分类数据编码是<strong class="ls ir">将分类数据转换为整数格式的过程，以便数据可以提供给不同的模型</strong>。</p></blockquote><p id="bc68" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">分类数据将采用字符串或对象数据类型的形式。但是，机器学习或深度学习算法只能对数字起作用。因此，作为机器学习工程师，将分类数据转换为数字形式是我们的职责。</p><h2 id="8bac" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">顺序编码</h2><p id="04da" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">在将顺序数据转换为数值数据时，我们需要保持固有的顺序。因此，每个类别将被赋予从0到多个类别的数字。如果数据中有3个类别，如“坏”、“一般”和“好”，那么坏将被编码为0，一般为1，好为2。以便维持秩序。</p><p id="dcf9" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">当我们训练机器学习模型时，它将学习具有内在顺序的模式，从而给出更好的结果。</p><p id="14e2" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">我们使用sklearn中的OrdinalEncoder类对有序数据进行编码。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ow"><img src="../Images/0afd4cb7eed8f7976463025dd68c8c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIJUIaTtHDdsfSOngx61Vg.png"/></div></div></figure><div class="nn no gp gr np nq"><a href="https://medium.com/@gowthamsr37/which-feature-scaling-technique-to-use-standardization-vs-normalization-9dcf8eafdf8c" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">标准化与规范化</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">特征缩放是强制性的吗？什么时候使用标准化？何时使用规范化？会发生什么……</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="ox l ob oc od nz oe jw nq"/></div></div></a></div><p id="55fc" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">让我们看看如何实际编码序数数据。</p><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="6d02" class="kl km iq kh b gy kn ko l kp kq">import pandas as pd<br/>import numpy as np</span><span id="ba37" class="kl km iq kh b gy kr ko l kp kq">df = pd.read_csv('customer.csv')</span><span id="bb13" class="kl km iq kh b gy kr ko l kp kq">df.head()</span></pre><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/921b84a03c5c313652f149ef1629859c.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*gj2Sx4jtPSRgF7TdVSwhbQ.png"/></div></figure><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="aa2a" class="kl km iq kh b gy kn ko l kp kq"><strong class="kh ir">df['age'].unique()<br/></strong>array([30, 68, 70, 72, 16, 31, 18, 60, 65, 74, 98, 51, 57, 15, 75, 59, 22,19, 97, 32, 96, 53, 69, 48, 83, 73, 92, 89, 86, 34, 94, 45, 76, 39,23, 27, 77, 61, 64, 38, 25], dtype=int64)</span><span id="752e" class="kl km iq kh b gy kr ko l kp kq"><strong class="kh ir">df['gender'].unique()<br/></strong>array(['Female', 'Male'], dtype=object)</span><span id="bd51" class="kl km iq kh b gy kr ko l kp kq"><strong class="kh ir">df['review'].unique()<br/></strong>array(['Average', 'Poor', 'Good'], dtype=object)</span><span id="cfeb" class="kl km iq kh b gy kr ko l kp kq"><strong class="kh ir">df['education'].unique()<br/></strong>array(['School', 'UG', 'PG'], dtype=object)</span><span id="16b5" class="kl km iq kh b gy kr ko l kp kq"><strong class="kh ir">df['purchased'].unique()<br/></strong>array(['No', 'Yes'], dtype=object)</span></pre><p id="b194" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">【年龄】</strong> —数值数据</p><p id="d46a" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">‘性别’</strong>—名义分类数据</p><p id="aaef" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">‘回顾’</strong>—有序分类数据</p><p id="20ee" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">‘教育’</strong>—有序分类数据</p><p id="05ea" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">‘已购’</strong>—目标变量</p><p id="a901" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">让我们分离序数数据，并学习如何对它们进行编码。</p><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="53ec" class="kl km iq kh b gy kn ko l kp kq">df = df.iloc[:,2:]<br/>df.head()</span></pre><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/bab6e6cfe2de26326a7d3d6d951f5f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*UHQFCUItmabZ89C7yhv9TA.png"/></div></figure><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="9aa9" class="kl km iq kh b gy kn ko l kp kq">X = df.iloc[:,0:2]<br/>y = df.iloc[:,-1]</span><span id="76a2" class="kl km iq kh b gy kr ko l kp kq">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X,y,test_size =0.2, random_state=1)</span><span id="d9fe" class="kl km iq kh b gy kr ko l kp kq">from sklearn.preprocessing import OrdinalEncoder</span><span id="8ff1" class="kl km iq kh b gy kr ko l kp kq">ordinal_encoder = OrdinalEncoder(categories=[['Poor','Average','Good'],['School','UG','PG']])</span><span id="c257" class="kl km iq kh b gy kr ko l kp kq">ordinal_encoder.fit(X_train)</span><span id="3a07" class="kl km iq kh b gy kr ko l kp kq">X_train = ordinal_encoder.transform(X_train)<br/>X_test = ordinal_encoder.transform(X_test)</span></pre><p id="00d3" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">在上面的代码中，我们可以看到我们按照顺序将类别传递给了ordinalEncoder类，在特性审查的情况下，差是最低顺序，好是最高顺序。</p><p id="ecad" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">同样，在教育栏的情况下，学校是最低顺序，PG是最高顺序。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/b08a0c9f4fc8803cd59c3a8a7185dfee.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*BdBypKUsTSQTCvUoEGEJMQ.png"/></div></figure><p id="60ac" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">转换后，我们可以观察上面的结果，它显示了前5行。</p><p id="97b8" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">第一行有review = Average和education = UG，因此它被转换为[1，1]</p><p id="08d4" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">第二行的review = Poor，education = PG，因此转换为[0，2]</p><h2 id="99b1" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">名义编码</h2><p id="03b3" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">名义数据没有内在的顺序，我们使用sklearn的OneHotEncoder类对名义数据进行编码。</p><p id="7cd9" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">如果我们开始对从0，1，2到所有类别的类别进行编码，那么机器学习算法将赋予2重要性(大于0和1)，这将不是真的，因为数据是名义上的，并且没有内在的顺序。因此，这种方法不适用于名义数据。</p><p id="ac9d" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">这里，每个类别都将被转换为一个新列，并根据相应类别的出现情况被赋予值0或1。因此，转换后功能的数量将会增加。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pb"><img src="../Images/b4899255760436b0f9716ade9918cd85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JPnLmvUWlao_HajOgQt0Iw.png"/></div></div></figure><p id="a00f" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">让我们看看如何实际编码名义数据。让我们拿一个带有特征‘性’和‘上船’(两者都是名义特征)的泰坦尼克号数据集。</p><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="162e" class="kl km iq kh b gy kn ko l kp kq">import pandas as pd<br/>import numpy as np</span><span id="915b" class="kl km iq kh b gy kr ko l kp kq">df = pd.read_csv('titanic.csv')</span><span id="6740" class="kl km iq kh b gy kr ko l kp kq">df.head()</span></pre><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/530da27facfbbf10b8eb72a2f0765a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*gspRvptm9nLln15pd1CeMQ.png"/></div></figure><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="feed" class="kl km iq kh b gy kn ko l kp kq"><strong class="kh ir">df['Sex'].unique()</strong><br/>array(['male', 'female'], dtype=object)</span><span id="0af1" class="kl km iq kh b gy kr ko l kp kq"><strong class="kh ir">df['Embarked'].unique()<br/></strong>array(['S', 'C', 'Q'], dtype=object)</span><span id="4b13" class="kl km iq kh b gy kr ko l kp kq"><strong class="kh ir">df['Survived'].unique()<br/></strong>array([0, 1], dtype=int64)</span></pre><h2 id="23f3" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">OneHotEncoding使用熊猫</h2><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="0d57" class="kl km iq kh b gy kn ko l kp kq">pd.get_dummies(df,columns=['Sex','Embarked'])</span></pre><p id="cee9" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">下面的输出显示了每个类别是如何转换成一个列的。“Sex”列已转换为“Sex_female”和“Sex_male”，而“Embarked”列已转换为“Embarked_C”、“Embarked_Q”和“Embarked_S”。</p><p id="1feb" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">这些新创建的属性/列被称为<strong class="ls ir"> <em class="mr">虚拟变量</em> </strong>。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/07fb0b2e38d1840b89d2dd16bb4ce7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*GXvZNh4bNTYgDzjNZ_gNsQ.png"/></div></figure><h2 id="3848" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated"><strong class="ak">虚拟变量陷阱:</strong></h2><p id="c477" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">虚拟变量陷阱是一种场景，其中有高度相关的属性(多重共线性)，一个变量预测其他变量的值。当我们使用<em class="mr">一键编码</em>处理分类数据时，那么一个虚拟变量(属性)可以在其他虚拟变量的帮助下预测。因此，一个虚拟变量与其他虚拟变量高度相关。</p><p id="8fb3" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">对模型使用所有虚拟变量会导致<strong class="ls ir"> <em class="mr">虚拟变量陷阱</em> </strong>(一些机器学习算法，如线性回归、逻辑回归存在多重共线性)</p><div class="nn no gp gr np nq"><a href="https://medium.com/@gowthamsr37/why-multicollinearity-is-a-problem-4c273d1d1f2e" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">为什么多重共线性是一个问题？</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">什么是多重共线性？以及为什么我们应该在创建机器学习模型之前处理多重共线性</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="pe l ob oc od nz oe jw nq"/></div></div></a></div><p id="165c" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated"><strong class="ls ir">例如</strong> — <br/>让我们考虑性别有两个值<em class="mr">男</em> (0或1)和<em class="mr">女</em> (1或0)的情况。包含两个虚拟变量会导致冗余，因为在这种情况下，如果一个人不是男性，那么这个人将是女性，因此，我们不需要在回归模型中使用两个变量。这将保护我们远离虚拟变量陷阱。</p><div class="nn no gp gr np nq"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-verify-the-assumptions-of-linear-regression-54ba4d17c231"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">我如何验证线性回归的假设？</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">线性回归的假设有哪些？以及如何用python来验证它们？</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">pub.towardsai.net</p></div></div><div class="nz l"><div class="pf l ob oc od nz oe jw nq"/></div></div></a></div><p id="96d6" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">因此，模型的设计应该排除一个虚拟变量。通常，我们删除第一个变量，如下所示。</p><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="c5bf" class="kl km iq kh b gy kn ko l kp kq">pd.get_dummies(df,columns=[‘Sex’,’Embarked’],drop_first=True)</span></pre><p id="1677" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">结果显示第一个变量已被删除。<strong class="ls ir">性别_女性</strong>和<strong class="ls ir">上船_C </strong>是从结果中掉出来的两列。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/48456d0c6a6e87f060a94801ec461310.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*lwD1ipCmuMeT9lYGx88hfw.png"/></div></figure><h2 id="908d" class="kl km iq bd ku nb nc dn ky nd ne dp lc mb nf ng lg mf nh ni lk mj nj nk lo nl bi translated">使用Sklearn进行OneHotEncoding</h2><p id="7e0d" class="pw-post-body-paragraph lq lr iq ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">我们可以使用sklearn的OneHotEncoder类来执行上述步骤。</p><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="7c12" class="kl km iq kh b gy kn ko l kp kq">X = df.iloc[:,0:2]<br/>y = df.iloc[:,-1]</span><span id="f123" class="kl km iq kh b gy kr ko l kp kq">from sklearn.model_selection import train_test_split<br/>X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=1)</span></pre><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/515f72591a3a819a920f476b02611b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*xWKTUjUaXUbduyobJcTFJA.png"/></div></figure><pre class="kc kd ke kf gt kg kh ki kj aw kk bi"><span id="395b" class="kl km iq kh b gy kn ko l kp kq">from sklearn.preprocessing import OneHotEncoder<br/>ohe = OneHotEncoder(drop='first',sparse=False,dtype=np.int32)</span><span id="4b77" class="kl km iq kh b gy kr ko l kp kq">X_train_new = ohe.fit_transform(X_train)<br/>X_test_new = ohe.transform(X_test)</span></pre><p id="8572" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">请注意，将根据字母顺序创建新要素。在给定的示例中，按字母顺序将<strong class="ls ir">‘性别’</strong>列转换为<strong class="ls ir">性别_女性</strong>和<strong class="ls ir">性别_男性</strong>，女性被删除，因为它是第一列。</p><p id="0e2a" class="pw-post-body-paragraph lq lr iq ls b lt ms lv lw lx mt lz ma mb mv md me mf mx mh mi mj mz ml mm mn ij bi translated">并且在<strong class="ls ir">' emboaded '</strong>特性中，<strong class="ls ir">emboaded _ C</strong>，<strong class="ls ir">emboaded _ Q</strong>和<strong class="ls ir">emboaded _ S</strong>是按照字母顺序排列的新列，类别‘C’已经被删除，因此数组[0，0]将表示C，[1，0]表示‘Q’，而[0，1]表示‘S’。</p><figure class="kc kd ke kf gt jr gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/01e0326e417d9761b748599b784e8dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*u1WbpXHQ7hwWtBqOMD_eww.png"/></div></figure></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><div class="kc kd ke kf gt nq"><a rel="noopener  ugc nofollow" target="_blank" href="/regression-metrics-6690815bb51f"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">仅用5分钟解释5个回归指标</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">有哪些不同的回归指标？R2分数会变成0吗？R2分数什么时候会变成负数？什么是…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">pub.towardsai.net</p></div></div><div class="nz l"><div class="pj l ob oc od nz oe jw nq"/></div></div></a></div></div></div>    
</body>
</html>