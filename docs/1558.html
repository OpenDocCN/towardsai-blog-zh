<html>
<head>
<title>How to Dockerize Your Data Science Project — A Quick Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对您的数据科学项目进行分类——快速指南</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-dockerize-your-data-science-project-a-quick-guide-b6fa2d6a8ba1?source=collection_archive---------1-----------------------#2021-02-20">https://pub.towardsai.net/how-to-dockerize-your-data-science-project-a-quick-guide-b6fa2d6a8ba1?source=collection_archive---------1-----------------------#2021-02-20</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="000a" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="5214" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">我每次都是如何通过这些简单易行的步骤进行部署的！</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/fd25214e9d6c70c128cc064012e76aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BeYaU_yjuUR8CQP9"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">图片来自<a class="ae li" href="https://unsplash.com/@travelsourced?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">旅游来源</a>在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="17e5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在<a class="ae li" href="https://towardsdatascience.com/a-guide-to-streamlit-frontend-for-data-science-made-simpler-c6dda54e3183?source=your_stories_page-------------------------------------" rel="noopener" target="_blank">之前的文章</a>中，我详细描述了使用fastai从我们的图像分类模型制作一个完整的交互式web应用程序的所有步骤。在这里，我们将探讨如何使应用程序独立于平台并便于共享。</p><h2 id="0f03" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated">首先，简单介绍一下…</h2><p id="b94c" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated"><a class="ae li" href="https://www.docker.com" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je"> Docker </strong> </a>是一款软件开发工具，通过在一个名为<strong class="ll je">容器</strong>的整洁包中管理我们应用程序的代码和所有必需的库及其依赖项，使我们的生活变得更加轻松。</p><blockquote class="nc nd ne"><p id="e43f" class="lj lk nf ll b lm ln ke lo lp lq kh lr ng lt lu lv nh lx ly lz ni mb mc md me in bi translated"><strong class="ll je">这意味着:</strong></p><p id="6a88" class="lj lk nf ll b lm ln ke lo lp lq kh lr ng lt lu lv nh lx ly lz ni mb mc md me in bi translated">你只需拿起你的项目，在一个<strong class="ll je"> Dockerfile </strong>的帮助下，用一行代码将其转换成docker映像，然后可以在任何机器上简单地运行，用另一行代码执行应用程序，而无需手动运行任何其他命令或安装任何其他东西。Docker自动完成这一切。</p></blockquote><p id="55ec" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在您的机器上安装Docker的步骤最多不会超过五分钟，可在<a class="ae li" href="https://www.docker.com/get-started" rel="noopener ugc nofollow" target="_blank">这里的</a>简单步骤中找到。</p><p id="d28c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">对于大多数用例来说，Docker Desktop已经足够了，所以继续安装吧。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj nj"><img src="../Images/711a2b41c0a2d9c4f8ca7eb3d5d86073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*JOUt4fwZ57m6XRRr2wBcfA.png"/></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">docker桌面的首选项</figcaption></figure><p id="588d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">一个重要的注意事项:</strong>在你第一次启动Docker Desktop之后，确保点击<em class="nf"> preferences </em>并为Docker运行选择最低<strong class="ll je">3GB</strong>的内存，否则有时，它可能会给你将来安装的机器学习或深度学习库带来一些问题，最终需要更多内存。它发生在我身上，我把这个小提示放在这里，以确保你不会也面临它。:)</p><h2 id="2b2d" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated">现在，让我们继续讨论如何为我们的应用程序构建docker文件</h2><p id="6af6" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">该应用程序的完整代码库位于这个GitHub存储库中。如果您想在学习本教程的过程中全面了解一下代码，欢迎您。</p><p id="f60e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我承诺了简单易行的步骤，所以我来了。我们走吧:</p><h2 id="12b5" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated">构建您的需求文件</h2><p id="d482" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">我虔诚地使用<strong class="ll je"> pipenv </strong>来管理我所有的python项目和环境。我承认这是一个方便的工具，而且学习曲线也很短。设置您的数据科学环境应该尽可能容易和轻松，我在我的一篇文章<a class="ae li" href="https://medium.com/this-code/5-step-guide-to-setting-up-a-new-python-environment-for-data-science-fcae3c3951c7?source=your_stories_page-------------------------------------" rel="noopener">中也详细谈到了这一点。</a></p><p id="6323" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们将使用<strong class="ll je"> pip freeze </strong>命令为我们的图像分类应用程序构建文件。在终端中，键入并输入:</p><pre class="kt ku kv kw gu nk nl nm nn aw no bi"><span id="2b61" class="mf mg iu nl b gz np nq l nr ns">pipenv run pip freeze &gt; requirements.txt</span></pre><p id="e3b6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在您的根项目目录中，您将看到新文件已经创建。这是一个重要的步骤，因为它定义了我们构建docker映像时将包含的每个库和依赖项。</p><p id="e68d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下一步需要实际构建Dockerfile文件。</p><h2 id="092e" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated">写下你的文档</h2><p id="123a" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">在向您展示构建它的代码之前，让我先重申一下项目结构的重要性，以及我的结构在整个项目中的表现。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj nt"><img src="../Images/e56337a4b8fec2aef31d690f8bc9cd90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*1-cIci2D_LgMMdGBfYPQDg.png"/></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">我使用的项目结构</figcaption></figure><p id="c096" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">确保当<strong class="ll je">在上面显示的</strong>到<strong class="ll je">应用程序</strong>目录之外时，制作你的docker文件。</p><pre class="kt ku kv kw gu nk nl nm nn aw no bi"><span id="60f6" class="mf mg iu nl b gz np nq l nr ns">touch Dockerfile</span></pre><p id="98e6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在您最喜欢的文本编辑器中打开该文件，将以下代码片段粘贴到其中并保存该文件:</p><pre class="kt ku kv kw gu nk nl nm nn aw no bi"><span id="d8bd" class="mf mg iu nl b gz np nq l nr ns">FROM python:3.9.1<br/>EXPOSE 8501<br/>COPY ./requirements.txt /requirements.txt<br/>WORKDIR /<br/>RUN pip3 install -r requirements.txt<br/>COPY . /<br/>ENTRYPOINT ["streamlit", "run"]<br/>CMD ["start.py"]<br/>WORKDIR /app</span></pre><p id="9bdd" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">现在让我们一行一行地检查这些指令。</p><ul class=""><li id="33e3" class="nu nv iu ll b lm ln lp lq ls nw lw nx ma ny me nz oa ob oc bi translated"><strong class="ll je"> FROM </strong>是每个Dockerfile文件的开头。它陈述了我们的映像将在其中构建和运行的环境，在我们的例子中是Python环境。在其他情况下，这也可以是已经存在的docker映像，如Ubuntu等操作系统的映像，nginx等服务器的映像。</li><li id="1242" class="nu nv iu ll b lm od lp oe ls of lw og ma oh me nz oa ob oc bi translated"><strong class="ll je"> EXPOSE </strong>表示我们的应用程序将要运行的端口。在前一篇文章中，我们看到我们的streamlit应用程序总是在端口8501上运行，因此我们在Dockerfile中公开了它。</li><li id="5154" class="nu nv iu ll b lm od lp oe ls of lw og ma oh me nz oa ob oc bi translated"><strong class="ll je">复制</strong>命令在文件中使用了两次。它的基本功能是将所有重要的代码和其他文件复制到docker镜像中。<strong class="ll je">。(点)</strong>表示我们想要将整个应用程序目录复制到docker映像中。</li><li id="c123" class="nu nv iu ll b lm od lp oe ls of lw og ma oh me nz oa ob oc bi translated">正如你可能已经猜到的，WORKDIR 声明我们的应用程序将从哪个工作目录运行。为了运行下一行→ <code class="fe oi oj ok nl b"><strong class="ll je">pip3 install -r requirements.txt</strong></code> <strong class="ll je">,我们首先将它更改到app目录之外。</strong>在最后一行，我们将它改回app目录，因为我们的应用程序将要执行的<strong class="ll je"> start.py </strong>文件就在那里。</li><li id="5241" class="nu nv iu ll b lm od lp oe ls of lw og ma oh me nz oa ob oc bi translated">最后，<strong class="ll je"> CMD </strong>和<strong class="ll je"> ENTRYPOINT </strong>是两个关键字，用于描述在终端上运行的命令，以从容器内启动应用程序。运行我们app的行是:<strong class="ll je"> streamlit run start.py. </strong>这个也可以简单写成:<code class="fe oi oj ok nl b"><strong class="ll je">CMD [“streamlit”, “run”, “start.py”]</strong></code>。在很多情况下，CMD和ENTRYPOINT的结合是Docker容器的最佳解决方案。在这种情况下，<strong class="ll je">可执行文件是用ENTRYPOINT定义的，而CMD指定默认参数，</strong>就像我们在上面的代码片段中所做的一样。</li></ul><p id="1289" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们快完了！最后一步是构建并运行这个Dockerfile文件。</p><h2 id="27e6" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated"><strong class="ak">构建并运行docker映像</strong></h2><p id="7a21" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">我承诺这一步有两行代码，所以我们开始吧！</p><p id="60a3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">首先，我们使用以下命令构建映像:</p><pre class="kt ku kv kw gu nk nl nm nn aw no bi"><span id="cf83" class="mf mg iu nl b gz np nq l nr ns">docker build --tag rps:1.0 .</span></pre><p id="ceda" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe oi oj ok nl b">— tag</code>仅用于确保我们的docker图像附带有名称和版本。这只是我们图像的人类可读形式。在这里，我把象征<em class="nf">石头剪刀布</em>的<em class="nf">‘RPS’</em>作为这张图片的标签。</p><p id="175b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在运行这个命令的时候，你一定注意到下载了很多“层”。这是因为我们正在构建python 3.9.1环境，并安装docker文件中用RUN命令指定的所有依赖项。因此，我们的基本Python映像要么从docker hub下载，要么从本地机器获取(如果可用的话)。最重要的是，我们的库将从需求文件中安装。</p><p id="e4b6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe oi oj ok nl b">docker build</code>命令末尾的<code class="fe oi oj ok nl b">.</code>表示Docker应该在我们当前的目录中寻找Dockerfile。</p><h2 id="24f7" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated">最后一步是运行我们构建的容器映像</h2><pre class="kt ku kv kw gu nk nl nm nn aw no bi"><span id="dc96" class="mf mg iu nl b gz np nq l nr ns">docker run --publish 8501:8501 -it rps:1.0</span></pre><p id="b3aa" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe oi oj ok nl b">— it</code>用于确保终端命令等其他迭代过程可以从docker容器中运行。此外，<code class="fe oi oj ok nl b">—- publish</code>帮助我们在8501端口的浏览器中运行我们的streamlit web应用程序。</p><p id="93c3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">导航至:<code class="fe oi oj ok nl b">localhost:8501</code>查看应用程序的运行情况！</p><p id="62a9" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们做到了！</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ol"><img src="../Images/bb02e6e80f6f9f20a6cf5328919ead3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DYhQOUZKQ24LmE27"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">由<a class="ae li" href="https://unsplash.com/@a8ka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安东·舒瓦洛夫</a>在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl om on hy oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="in io ip iq ir"><h2 id="3943" class="mf mg iu bd mh mi mj dn mk ml mm dp mn ls mo mp mq lw mr ms mt ma mu mv mw ja bi translated">结束…</h2><p id="b9cc" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">构建数据科学项目需要付出很多努力，而让外部人员可以使用我们的工作是所有工作之上的一些额外工作。在这一系列文章中，我们看到了将我们的图像分类引擎打包到一个web应用程序中，然后确保它也可以由其他人在不同的机器上极其轻松地运行。</p><p id="22d3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">依我拙见，Docker的多功能性绝对令人惊叹，如果你想在我接下来的项目中探索更多，并在我记录更多关于它们的内容时，请继续关注。</p><p id="c5ec" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">您可以利用以下资源扩展您的知识:</strong></p><ul class=""><li id="5369" class="nu nv iu ll b lm ln lp lq ls nw lw nx ma ny me nz oa ob oc bi translated">用这个<a class="ae li" href="https://stackoverflow.com/questions/21553353/what-is-the-difference-between-cmd-and-entrypoint-in-a-dockerfile" rel="noopener ugc nofollow" target="_blank">栈溢出post </a>比较Dockerfile中的ENTRYPOINT和CMD命令。</li><li id="d4af" class="nu nv iu ll b lm od lp oe ls of lw og ma oh me nz oa ob oc bi translated">Docker在他们的官方页面上构建并运行流程概述<a class="ae li" href="https://docs.docker.com/get-started/overview/" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><p id="0fd3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">感谢您的阅读！😁</p><blockquote class="nc nd ne"><p id="2d0f" class="lj lk nf ll b lm ln ke lo lp lq kh lr ng lt lu lv nh lx ly lz ni mb mc md me in bi translated">我所有文章的github代码库都在这里:</p></blockquote><div class="ot ou gq gs ov ow"><a href="https://github.com/yashprakash13/data-another-day#ml-mini-projects-because-crash-courses-are-the-best" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fp"><div class="oy ab oz cl cj pa"><h2 class="bd je gz z fq pb fs ft pc fv fx jd bi translated">yashprakash 13/data-另一天</h2><div class="pd l"><h3 class="bd b gz z fq pb fs ft pc fv fx dk translated">我在我的…上学习和撰写的所有数据科学项目、概念、工具和资源的主存储库</h3></div><div class="pe l"><p class="bd b dl z fq pb fs ft pc fv fx dk translated">github.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk lc ow"/></div></div></a></div><p id="197e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在<a class="ae li" href="https://twitter.com/csandyash" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系。</p></div></div>    
</body>
</html>