<html>
<head>
<title>Customer Segmentation using K-Means Clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于K均值聚类的客户细分</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/customer-segmentation-using-k-means-clustering-c0c6307ec3f7?source=collection_archive---------0-----------------------#2022-01-14">https://pub.towardsai.net/customer-segmentation-using-k-means-clustering-c0c6307ec3f7?source=collection_archive---------0-----------------------#2022-01-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0523" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><p id="f8b6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">"市场营销的目的是充分了解和理解顾客，使产品或服务适合他并自我销售"。</p><p id="b345" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">彼得·德鲁克</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/4064ec67a1da223d5801a14f4ebac04e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*zHRd__mGafKHN1Vlg_K5CQ.jpeg"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">由<a class="ae lj" href="https://unsplash.com/@austindistel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>在<a class="ae lj" href="https://unsplash.com/s/photos/marketing-customer-targets?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="521c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">什么是客户细分？</strong></p><p id="266b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">客户细分是将公司的客户划分成组的过程，其中每个组内的客户在其组内共享共同的特征(例如，个性、兴趣、购买历史)。对客户进行细分的目标是决定如何与每一组中的客户建立联系，以最大化每个客户对企业的价值。</p><p id="f1a6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">细分提供了一种组织和管理公司与客户关系的简单方法。这一过程还使您的营销、服务和销售工作更容易个性化，以满足每个群体中个人的特定需求。</p><p id="4feb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">客户细分的好处</strong></p><p id="4ed1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">有几个原因说明了客户细分对企业的重要性。《客户细分终极指南》的作者Kristen Baker定义了使用客户细分可以获得的几个好处。其中包括以下内容:</p><p id="c714" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.更深入地了解您的客户，以便根据他们的独特需求和挑战定制您的内容。</p><p id="b040" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.创建有针对性的活动和广告，以引起客户的共鸣并转化客户群。</p><p id="567d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.通过了解不同群体可能遇到的挑战并做好准备，改善您的客户服务和客户支持工作。</p><p id="f3e7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.通过定制内容和互动提高客户忠诚度。</p><p id="9fdf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.了解谁是你最有价值的客户，为什么。</p><p id="def2" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">6.有效识别产品、支持和服务的新机会。</p><p id="014a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">利用机器学习进行客户细分</strong></p><p id="20a3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">机器学习模型是分析大型数据集和在数据中寻找见解和模式的伟大工具。他们可以准确地识别多个客户群，每个客户群中的客户都有共同的特征和兴趣。这些发现很难用手工或传统的分析方法发现。</p><p id="a96f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">有许多不同的机器学习算法适用于不同类型的问题。用于客户细分的一种非常常见的机器学习算法是k均值聚类算法。K-means聚类是一种无监督的学习技术，用于通过按特征而不是预定义的类别对未标记的数据进行分组来分类。变量K表示创建的集群(组)的数量。目标是将数据分成不同的聚类，并找到每个聚类的中心位置。然后，新的数据点可以被分配给其中心最接近该新的数据点的聚类。</p><p id="cad7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">路线图</strong></p><p id="362e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本文的剩余部分将展示一个程序，该程序将读取客户发票数据，使用K-Means聚类算法对客户数据进行分段，并发现关于每个客户群的见解。以下步骤将使用机器学习和Python来执行。</p><p id="eeb3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">1.导入所需的软件库。</p><p id="2dc6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">2.加载数据。</p><p id="5c57" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">3.数据分析。</p><p id="d869" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">4.数据清理和转换。</p><p id="c40f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">5.将数据标准化。</p><p id="69c1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">6.将数据可视化</p><p id="504c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">7.发现关于客户的见解。</p><p id="e10f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">程序</strong></p><p id="e700" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用K-Means聚类算法进行客户细分的程序如下所示。</p><p id="db3d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">导入所需的软件库</strong></p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="629c" class="lp lq it ll b gy lr ls l lt lu"><strong class="ll jd">import</strong> pandas <strong class="ll jd">as</strong> pd<br/><strong class="ll jd">import</strong> numpy <strong class="ll jd">as</strong> np<br/><strong class="ll jd">import</strong> seaborn <strong class="ll jd">as</strong> sns<br/><strong class="ll jd">import</strong> matplotlib.pyplot <strong class="ll jd">as</strong> plt<br/><strong class="ll jd">from</strong> sklearn.cluster <strong class="ll jd">import</strong> KMeans<br/><strong class="ll jd">from</strong> sklearn <strong class="ll jd">import</strong> cluster</span></pre><p id="da67" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">加载数据</strong></p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="c2e0" class="lp lq it ll b gy lr ls l lt lu"># Load data on Google Colab<strong class="ll jd"><br/>from</strong> google.colab <strong class="ll jd">import</strong> files <br/>uploaded <strong class="ll jd">=</strong> files<strong class="ll jd">.</strong>upload()</span></pre><p id="bbab" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">将数据存储到数据框变量中。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="7b08" class="lp lq it ll b gy lr ls l lt lu">retail <strong class="ll jd">=</strong> pd<strong class="ll jd">.</strong>read_excel('Online Retail.xlsx', sheet_name<strong class="ll jd">=</strong>'Online Retail')</span></pre><p id="1ec7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据分析</strong></p><p id="f887" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">打印数据框的前5行。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="48cc" class="lp lq it ll b gy lr ls l lt lu">retail<strong class="ll jd">.</strong>head()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lv"><img src="../Images/042f7db437417bf04a5935b49aafea99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lO8-Z1ayhyiwCjI0zVDMsw.png"/></div></div></figure><p id="b632" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">这些数据来自Kaggle的网站。该数据集包含一家总部位于英国的在线零售公司在八个月内的所有采购。数据可以在这个<a class="ae lj" href="https://www.kaggle.com/vijayuv/onlineretail" rel="noopener ugc nofollow" target="_blank">链接</a>找到。</p><p id="a8b1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下面列出了列和定义。</p><ol class=""><li id="3cd8" class="ma mb it kb b kc kd kg kh kk mc ko md ks me kw mf mg mh mi bi translated">发票号—发票号码。</li><li id="2c2b" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">库存代码——特定产品的库存标识符。</li><li id="d9d0" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">描述—产品的描述。</li><li id="d176" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">数量——购买产品的数量。</li><li id="ac39" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">InvoiceDate —创建发票的日期(年月日)。</li><li id="6be1" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">单价——单一产品的价格。</li><li id="713a" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">CustomerID —每个客户的唯一标识符。</li><li id="e479" class="ma mb it kb b kc mj kg mk kk ml ko mm ks mn kw mf mg mh mi bi translated">国家——购买产品的国家。</li></ol><p id="0621" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">显示有关数据列的信息。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="3ed9" class="lp lq it ll b gy lr ls l lt lu">retail<strong class="ll jd">.</strong>info()<br/>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 541909 entries, 0 to 541908<br/>Data columns (total 8 columns):<br/> #   Column       Non-Null Count   Dtype         <br/>---  ------       --------------   -----         <br/> 0   InvoiceNo    541909 non-null  object        <br/> 1   StockCode    541909 non-null  object        <br/> 2   Description  540455 non-null  object        <br/> 3   Quantity     541909 non-null  int64         <br/> 4   InvoiceDate  541909 non-null  datetime64[ns]<br/> 5   UnitPrice    541909 non-null  float64       <br/> 6   CustomerID   406829 non-null  float64       <br/> 7   Country      541909 non-null  object        <br/>dtypes: datetime64[ns](1), float64(2), int64(1), object(4)<br/>memory usage: 33.1+ MB</span></pre><p id="b456" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">发票记录541909条，8列。变量包含字母数字、数字和日期数据类型。Description和CustomerID列中有null值或缺少值。</p><p id="22fb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据清理和转换</strong></p><p id="e024" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">删除没有客户ID的记录。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="84cd" class="lp lq it ll b gy lr ls l lt lu">retail <strong class="ll jd">=</strong> retail[pd<strong class="ll jd">.</strong>notnull(retail['CustomerID'])]</span></pre><p id="55ce" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在数据框中为每张发票的总销售额创建一个新列。这是通过将数量乘以每行的单价来计算的。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="7c48" class="lp lq it ll b gy lr ls l lt lu">retail['Sales'] <strong class="ll jd">=</strong> retail['Quantity'] <strong class="ll jd">*</strong> retail['UnitPrice']<br/>retail<strong class="ll jd">.</strong>head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mo"><img src="../Images/33d9d64b3c081d1601a0b7abc11936ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRjIDeqxsy0kp8iULZDxxw.png"/></div></div></figure><p id="f438" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们需要转换数据，以便每个记录代表一个客户的购买历史。我们将使用group by功能按CustomerID汇总销售额。lambda函数将用于按客户ID对发票数量求和。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="89d4" class="lp lq it ll b gy lr ls l lt lu">customer_retail <strong class="ll jd">=</strong> retail<strong class="ll jd">.</strong>groupby('CustomerID')<strong class="ll jd">.</strong>agg({'Sales': sum, <br/>                               'InvoiceNo': <strong class="ll jd">lambda</strong> x: x<strong class="ll jd">.</strong>nunique()})<br/>customer_retail<strong class="ll jd">.</strong>head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mp"><img src="../Images/a1118b3353851e3a79986b4e016e446a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77qr8x_7yNCb_gHNDat3zA.png"/></div></div></figure><p id="2da4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将在数据框中选择要用于分析的列，并重命名列名以使其更加直观。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="be8e" class="lp lq it ll b gy lr ls l lt lu">customer_retail<strong class="ll jd">.</strong>columns <strong class="ll jd">=</strong> ['TotalSales', 'OrderCount'] <br/>customer_retail<strong class="ll jd">.</strong>head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mq"><img src="../Images/79b90e2503e8f1ce3a96c263c9e31fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wZcOpUlfOVBjIEfajmwH9w.png"/></div></div></figure><p id="8c44" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">为数据框中每个客户的平均订单值创建一个新列。计算方法是将总销售额除以每行的订单数。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="8607" class="lp lq it ll b gy lr ls l lt lu">customer_retail['AvgOrderValue'] <strong class="ll jd">=</strong> customer_retail['TotalSales'] <strong class="ll jd">/</strong> customer_retail['OrderCount']<br/>customer_retail<strong class="ll jd">.</strong>head()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mr"><img src="../Images/da10a71a67c67b8d8ba9fc5fe27d9e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chpdUC6wKbuNCXcVdK0cyQ.png"/></div></div></figure><p id="d9d7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">归一化数据</strong></p><p id="9a93" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们需要对数据进行标准化，使其分布的平均值为0，标准差为1。规范化使要素之间更加一致，从而使模型能够更准确地预测输出。这是针对数据框中的每个要素或列进行的。rank (method=first)函数按照数据在数据框中出现的顺序对数据进行排序。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="c2ea" class="lp lq it ll b gy lr ls l lt lu">rank_retail <strong class="ll jd">=</strong> customer_retail<strong class="ll jd">.</strong>rank(method<strong class="ll jd">=</strong>'first')<br/>normalized_retail <strong class="ll jd">=</strong> (rank_retail <strong class="ll jd">-</strong> rank_retail<strong class="ll jd">.</strong>mean()) <strong class="ll jd">/</strong> rank_retail<strong class="ll jd">.</strong>std()<br/>normalized_retail<strong class="ll jd">.</strong>head()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi ms"><img src="../Images/047f91f370cb74e2734488c4851e3ded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGGCR21jHBNccMpGTAQyFw.png"/></div></div></figure><p id="a9dc" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用K-means聚类算法来分割我们的客户发票数据。这是一种无监督的学习算法，旨在将n个观察值划分为k个聚类，其中每个观察值都属于质心最近的聚类(聚类的中心)。该算法的目标是最小化观测值与其所属聚类的质心之间的平方欧几里德距离。如果你想了解更多关于K-means聚类算法的知识，请点击这个<a class="ae lj" href="https://www.analyticsvidhya.com/blog/2021/11/understanding-k-means-clustering-in-machine-learningwith-examples/" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="7597" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们将使用K-means聚类算法的肘方法来选择最佳的聚类数。肘方法是一种最常用的方法，用于通过在K-means算法中用一系列K值拟合模型来选择最佳聚类数。肘形法需要在SSE(误差平方和)与多个聚类之间绘制一个线图，并找到代表“肘形点”的点(在该点之后SSE或惯性开始以线性方式下降)。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="371a" class="lp lq it ll b gy lr ls l lt lu">sse <strong class="ll jd">=</strong> []<br/>krange <strong class="ll jd">=</strong> list(range(2,11))<br/>X <strong class="ll jd">=</strong> normalized_retail[['TotalSales','OrderCount','AvgOrderValue']]<strong class="ll jd">.</strong>values<br/><strong class="ll jd">for</strong> n <strong class="ll jd">in</strong> krange:<br/>    model <strong class="ll jd">=</strong> cluster<strong class="ll jd">.</strong>KMeans(n_clusters<strong class="ll jd">=</strong>n, random_state<strong class="ll jd">=</strong>3)<br/>    model<strong class="ll jd">.</strong>fit_predict(X)<br/>    cluster_assignments <strong class="ll jd">=</strong> model<strong class="ll jd">.</strong>labels_<br/>    centers <strong class="ll jd">=</strong> model<strong class="ll jd">.</strong>cluster_centers_<br/>    sse<strong class="ll jd">.</strong>append(np<strong class="ll jd">.</strong>sum((X <strong class="ll jd">-</strong> centers[cluster_assignments]) <strong class="ll jd">**</strong> 2))<br/><br/># Plot the results.<br/>fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (8,5))<br/>plt<strong class="ll jd">.</strong>plot(krange, sse, marker<strong class="ll jd">=</strong>'o')<br/>plt<strong class="ll jd">.</strong>xlabel("$K - Number of Clusters$")<br/>plt<strong class="ll jd">.</strong>ylabel("Sum of Squares")<br/>plt<strong class="ll jd">.</strong>grid(<strong class="ll jd">True</strong>)<br/>plt<strong class="ll jd">.</strong>show()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mt"><img src="../Images/339bcf42208f952591f9cc172d5a69de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LbnWdgDBL9V7K1rx-wyLMg.png"/></div></div></figure><p id="c8ce" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">该图显示了4个聚类，这是该分析的最佳聚类数。如果我们将集群的数量增加到4个以上，那么惯性或者平方距离的和会有非常小的变化。</p><p id="af90" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们现在需要使用找到的最佳聚类数(4)在标准化数据帧上训练k-means聚类模型。该模型遍历训练数据，并将每个数据点分配给质心最接近该数据点的聚类。我们还会将聚类数添加到数据框中数据所属的每一行。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="e19e" class="lp lq it ll b gy lr ls l lt lu">kmeans <strong class="ll jd">=</strong> KMeans(n_clusters<strong class="ll jd">=</strong>4)<strong class="ll jd">.</strong>fit(normalized_retail[['TotalSales', 'OrderCount', 'AvgOrderValue']])<br/>four_clusters <strong class="ll jd">=</strong> normalized_retail[['TotalSales', 'OrderCount', 'AvgOrderValue']]<strong class="ll jd">.</strong>copy(deep<strong class="ll jd">=True</strong>)<br/>four_clusters['Cluster'] <strong class="ll jd">=</strong> kmeans<strong class="ll jd">.</strong>labels_<br/>four_clusters<strong class="ll jd">.</strong>head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mp"><img src="../Images/2415ebe57320d34cd76e5eb02b01a764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aBIRlldhUGNP5imqVXzi-A.png"/></div></div></figure><p id="fb4f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">数据框中的每一行现在都被分配给特定的聚类。</p><p id="d607" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们现在将根据之前的数据框创建一个新的数据框，其中每个记录代表一个客户在规范化之前的购买历史。我们还会将聚类列添加到该数据框中。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="06a2" class="lp lq it ll b gy lr ls l lt lu">df <strong class="ll jd">=</strong> customer_retail<br/>frame <strong class="ll jd">=</strong> pd<strong class="ll jd">.</strong>DataFrame(df)<br/>frame['Cluster'] <strong class="ll jd">=</strong> four_clusters['Cluster']<br/>frame<strong class="ll jd">.</strong>head(5)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mu"><img src="../Images/b2ac853c72cc0e83979e35efd1a14acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGQ5mpgI21ZS_X4pereBxQ.png"/></div></div></figure><p id="0745" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd">数据可视化和洞察</strong></p><p id="dd45" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化总销售额和每个分类之间的关系。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="6603" class="lp lq it ll b gy lr ls l lt lu">fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (8,5))<br/>sns<strong class="ll jd">.</strong>barplot(x <strong class="ll jd">=</strong> 'Cluster', <br/>            y <strong class="ll jd">=</strong> 'TotalSales', <br/>            data <strong class="ll jd">=</strong> frame,<br/>            ci <strong class="ll jd">=</strong> <strong class="ll jd">None</strong>)<br/># Add labels.<br/>plt<strong class="ll jd">.</strong>xlabel("Cluster", size<strong class="ll jd">=</strong>12)<br/>plt<strong class="ll jd">.</strong>ylabel("Total Sales ($)", size<strong class="ll jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mv"><img src="../Images/9d8887134f7a58f1305d2e6b427095c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fQJ5q0IRy8c53MMtNtCZQ.png"/></div></div></figure><p id="0469" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化订单计数和每个群之间的关系。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="fe84" class="lp lq it ll b gy lr ls l lt lu">fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (8,5))<br/>sns<strong class="ll jd">.</strong>barplot(x <strong class="ll jd">=</strong> 'Cluster', <br/>            y <strong class="ll jd">=</strong> 'OrderCount', <br/>            data <strong class="ll jd">=</strong> frame,<br/>            ci <strong class="ll jd">=</strong> <strong class="ll jd">None</strong>)<br/># Add labels<br/>plt<strong class="ll jd">.</strong>xlabel("Cluster", size<strong class="ll jd">=</strong>12)<br/>plt<strong class="ll jd">.</strong>ylabel("Order Count", size<strong class="ll jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mw"><img src="../Images/815a1c69896d6816ffa808cb3e77519b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oo6pVMtMIiBzB_NBWnItlQ.png"/></div></div></figure><p id="2c17" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可视化平均顺序值和每个分类之间的关系。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="3c44" class="lp lq it ll b gy lr ls l lt lu">fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (8,5))<br/>sns<strong class="ll jd">.</strong>barplot(x <strong class="ll jd">=</strong> 'Cluster', <br/>            y <strong class="ll jd">=</strong> 'AvgOrderValue', <br/>            data <strong class="ll jd">=</strong> frame,<br/>            ci <strong class="ll jd">=</strong> <strong class="ll jd">None</strong>)<br/># Add labels.<br/>plt<strong class="ll jd">.</strong>xlabel("Cluster", size<strong class="ll jd">=</strong>12)<br/>plt<strong class="ll jd">.</strong>ylabel("Average Order Value", size<strong class="ll jd">=</strong>12)</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mx"><img src="../Images/5c845a59e0ed1c3c0d39f27aee92a7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cr_WmcPRgTE1g4uuhjeDVA.png"/></div></div></figure><p id="24c4" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">创建一个数据框，包括4个聚类中每个聚类内所有数据点的平均值。数据点包括总销售额、订单计数和平均订单价值。聚类的中心是该聚类内所有点(元素)的平均值。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="8ac3" class="lp lq it ll b gy lr ls l lt lu">cluster1_metrics <strong class="ll jd">=</strong> kmeans<strong class="ll jd">.</strong>cluster_centers_[0]<br/>cluster2_metrics <strong class="ll jd">=</strong> kmeans<strong class="ll jd">.</strong>cluster_centers_[1]<br/>cluster3_metrics <strong class="ll jd">=</strong> kmeans<strong class="ll jd">.</strong>cluster_centers_[2]<br/>cluster4_metrics <strong class="ll jd">=</strong> kmeans<strong class="ll jd">.</strong>cluster_centers_[3]<br/><br/>data <strong class="ll jd">=</strong> [cluster1_metrics, cluster2_metrics, cluster3_metrics, cluster4_metrics]<br/>cluster_center_df <strong class="ll jd">=</strong> pd<strong class="ll jd">.</strong>DataFrame(data)<br/># Add the column lables.<br/>cluster_center_df<strong class="ll jd">.</strong>columns <strong class="ll jd">=</strong> four_cluster_df<strong class="ll jd">.</strong>columns[0:3]<br/>cluster_center_df</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi my"><img src="../Images/571a4ed74897989ca1bd16ce822e29dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrXCrqMGXoifdYis9Nst-g.png"/></div></div></figure><p id="062a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">集群编号显示在最左边的列中。</p><p id="0d43" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">按订单计数显示总销售额的分类。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="27e0" class="lp lq it ll b gy lr ls l lt lu">fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (9,6))<br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]['TotalSales'],<br/>    c<strong class="ll jd">=</strong>'blue')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 1]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 1]['TotalSales'],<br/>    c<strong class="ll jd">=</strong>'orange')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 2]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 2]['TotalSales'],<br/>    c<strong class="ll jd">=</strong>'green')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 3]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 3]['TotalSales'],<br/>    c<strong class="ll jd">=</strong>'red')<br/><br/>plt<strong class="ll jd">.</strong>title('Total Sales by Order Count', size<strong class="ll jd">=</strong>14)<br/>plt<strong class="ll jd">.</strong>xlabel('Order Count', size<strong class="ll jd">=</strong>12)<br/>plt<strong class="ll jd">.</strong>ylabel('Total Sales', size<strong class="ll jd">=</strong>12)<br/><br/>plt<strong class="ll jd">.</strong>grid()<br/>plt<strong class="ll jd">.</strong>show()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mu"><img src="../Images/92a9a336b455b5187753a9a52981f2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-IYbSBBS5RR0lHHSIA_GQ.png"/></div></div></figure><p id="17cf" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">红色客户的总销售额和订单数都很低，这意味着他们是低价值客户。蓝色的客户总销售额和订单数都很高，表明他们是高价值客户。</p><p id="0f72" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">按订单计数显示平均订单值的分类。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="a740" class="lp lq it ll b gy lr ls l lt lu"><em class="mz"># Visualize the clusters for average order value by order count</em><br/>fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (9,6))<br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'blue')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 1]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 1]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'orange')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 2]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 2]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'green')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 3]['OrderCount'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 3]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'red')<br/><br/>plt<strong class="ll jd">.</strong>title('Average Order Value by Order Count')<br/>plt<strong class="ll jd">.</strong>xlabel('Order Count')<br/>plt<strong class="ll jd">.</strong>ylabel('Average Order Value')<br/><br/>plt<strong class="ll jd">.</strong>grid()<br/>plt<strong class="ll jd">.</strong>show()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi na"><img src="../Images/0ccd83ea6fe7bba2d32e229bb4f79733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_hb4lZj5T6KBxQVW_4eLWw.png"/></div></div></figure><p id="101a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">红色客户的平均订单价值和订单数量较低，意味着他们是低价值客户。蓝色客户的平均订单价值和订单数量都很高，表明他们是价值最高的客户。橙色客户的平均订单价值较高，但订单数量较少，这意味着他们对高价产品的订单较少。</p><p id="31b5" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">按总销售额显示平均订单值的分类。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="821f" class="lp lq it ll b gy lr ls l lt lu">fig <strong class="ll jd">=</strong> plt<strong class="ll jd">.</strong>figure(figsize <strong class="ll jd">=</strong> (9,6))<br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]['TotalSales'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'blue')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 1]['TotalSales'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 1]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'orange')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 2]['TotalSales'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 2]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'green')<br/><br/>plt<strong class="ll jd">.</strong>scatter(<br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 3]['TotalSales'], <br/>    four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 3]['AvgOrderValue'],<br/>    c<strong class="ll jd">=</strong>'red')<br/><br/>plt<strong class="ll jd">.</strong>title('Average Order Value by Total Sales')<br/>plt<strong class="ll jd">.</strong>xlabel('Total Sales')<br/>plt<strong class="ll jd">.</strong>ylabel('Average Order Value')<br/><br/>plt<strong class="ll jd">.</strong>grid()<br/>plt<strong class="ll jd">.</strong>show()</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi ms"><img src="../Images/1d446cba957875aa230ee0234111c6ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTCN9n5MH8ShaaoM_8yUpw.png"/></div></div></figure><p id="8cd6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">蓝色客户的总销售额和平均订单价值都很高，这意味着他们是价值最高的客户。橙色客户的平均订单价值较高，但总销售额较低，这意味着他们对高价产品的订单较少。红色和绿色的客户是高机会客户。</p><p id="0ae3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">让我们确定最高价值群中的客户。通过更改簇号和数据帧名称，相同的代码可用于其他簇。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="b5b3" class="lp lq it ll b gy lr ls l lt lu">high_value_cluster <strong class="ll jd">=</strong> four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]<br/>high_value_cluster</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nb"><img src="../Images/7e92ab3e033a18bbfa0ce7993b23cf3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lqdaclqkpym4ODVi3hzc0g.png"/></div></div></figure><p id="3b55" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">让我们找出所有分类中最畅销的商品。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="7bb0" class="lp lq it ll b gy lr ls l lt lu">pd<strong class="ll jd">.</strong>DataFrame(retail<strong class="ll jd">.</strong>groupby('Description')<strong class="ll jd">.</strong>count()['StockCode']<strong class="ll jd">.</strong>sort_values(ascending<strong class="ll jd">=False</strong>)<strong class="ll jd">.</strong>head())</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nc"><img src="../Images/25694d1c7b6f3a8f51f2494bc2296f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iPOeVKRLE0YXhc6xlFOmRQ.png"/></div></div></figure><p id="e0a3" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">让我们确定最高价值群中最畅销的商品。通过更改簇号和数据帧名称，相同的代码可用于其他簇。</p><pre class="ky kz la lb gt lk ll lm ln aw lo bi"><span id="68b6" class="lp lq it ll b gy lr ls l lt lu">high_value_cluster <strong class="ll jd">=</strong> four_clusters<strong class="ll jd">.</strong>loc[four_clusters['Cluster'] <strong class="ll jd">==</strong> 0]<br/><br/>pd<strong class="ll jd">.</strong>DataFrame(retail<strong class="ll jd">.</strong>loc[retail['CustomerID']<strong class="ll jd">.</strong>isin(high_value_cluster<strong class="ll jd">.</strong>index)]<strong class="ll jd">.</strong>groupby(<br/>    'Description')<strong class="ll jd">.</strong>count()['StockCode']<strong class="ll jd">.</strong>sort_values(ascending<strong class="ll jd">=False</strong>)<strong class="ll jd">.</strong>head())</span></pre><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nd"><img src="../Images/fd532b8181624d610e3be94e0b1ca8d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgPkOlTDfHZJGZ7TJ90IHQ.png"/></div></div></figure><p id="d53e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">非常感谢你阅读我的文章！如果您有任何意见或反馈，请在下面添加。</p><p id="c05a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。会员资格让你可以无限制地接触媒体上的故事。你可以使用这个链接报名【https://medium.com/@dniggl/membership T2】</p><p id="0662" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi">-</p></div></div>    
</body>
</html>