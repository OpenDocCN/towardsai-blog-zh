<html>
<head>
<title>How To Improve Your Analytical Report With Conditional Formatting In Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Pandas中使用条件格式改进您的分析报告</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/improve-your-analytical-report-with-conditional-formatting-in-pandas-76039fd3ccb5?source=collection_archive---------1-----------------------#2022-07-01">https://pub.towardsai.net/improve-your-analytical-report-with-conditional-formatting-in-pandas-76039fd3ccb5?source=collection_archive---------1-----------------------#2022-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="32a0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Pandas中使用Styler API的类似Excel的条件格式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6e309460b24fd9c3c5f314aba249b3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LuirGXJAD1GzSOdXELcjfw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><blockquote class="ky"><p id="dbe2" class="kz la it bd lb lc ld le lf lg lh li dk translated">对于数据科学家/分析师来说，与利益相关方清楚地交流分析见解至关重要。</p></blockquote><p id="b1b2" class="pw-post-body-paragraph lj lk it ll b lm ln ju lo lp lq jx lr ls lt lu lv lw lx ly lz ma mb mc md li im bi translated">在分析报告中使用<strong class="ll iu">条件格式</strong>有助于快速识别数据框架(表格)中的细节。</p><p id="692e" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">先说个例子。以下数据透视表显示了2016年至2022年不同产品的总销售额。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/13c53e02493d2f12607aaa21d8bec823.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FkeibK-S0taZN7KDCrh-nA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">显示2016年至2022年产品总销售额的数据透视表—您能确定2016年的最高销售额吗？(图片由作者提供)</figcaption></figure><ul class=""><li id="737b" class="mk ml it ll b lm me lp mf ls mm lw mn ma mo li mp mq mr ms bi translated"><strong class="ll iu">你能找出销量最大的吗</strong>💰<strong class="ll iu">2016年产品？</strong> —是的，它是总销售额为169的产品_B，但仅通过外观很难识别<strong class="ll iu">👀在餐桌上。</strong></li></ul><p id="97c3" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">现在让我们给销量最大的产品上色💰每年的产品。突出显示后，回答上面的问题就变得容易多了，不是吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/bcfbe24bd37767e931d9b6b012c773ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2O0yvK7u6Xp_HZ4-Dlz9HA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">突出显示每年最畅销的产品-现在很容易识别产品_B是2016年最畅销的产品，销量为169(图片由作者提供)</figcaption></figure><p id="4747" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">让我告诉你如何在熊猫身上做到这一点。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h2 id="9315" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated"><strong class="ak">主题:</strong></h2><p id="aa25" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated">1.<a class="ae nz" href="#a08d" rel="noopener ugc nofollow">高亮显示缺失值</a> <br/> 2。<a class="ae nz" href="#7783" rel="noopener ugc nofollow">高亮显示每行/每列的最大(或最小)值</a>3。<a class="ae nz" href="#ad64" rel="noopener ugc nofollow">高亮显示一个范围内的数值</a> <br/> 4。<a class="ae nz" href="#3acf" rel="noopener ugc nofollow">绘制柱内条形图</a> <br/> 5。<a class="ae nz" href="#f6b9" rel="noopener ugc nofollow">使用颜色渐变</a> <br/> 6高亮显示数值。<a class="ae nz" href="#435e" rel="noopener ugc nofollow">奖金</a>🎁</p><p id="6863" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated"><strong class="ll iu">注意:我强烈建议使用最新版本的Pandas，以避免意外错误。可以运行</strong> <code class="fe oa ob oc od b"><strong class="ll iu">pip install --upgrade pandas</strong></code> <strong class="ll iu">获取熊猫最新稳定发布。</strong></p><h2 id="a08d" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated"><strong class="ak"> 1。突出显示缺失值</strong></h2><p id="d3c5" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated">使用<code class="fe oa ob oc od b">dataframe.style.highlight_null()</code>,您可以如下所示为空值着色。我将数据透视表存储在变量<code class="fe oa ob oc od b">df_pivoted</code>中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/5dd1d3c77852b42268d6aa6a5b5e66c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wWwau299bzoIBOJMqeXHsg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用`. highlight_null `以红色突出显示nan值(图片由作者提供)</figcaption></figure><p id="a119" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">没事的😀如果你不喜欢红色。让我们<strong class="ll iu">使用参数<code class="fe oa ob oc od b">props=’color:white;background-color:black’</code>自定义缺失值的文本和背景颜色</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/19246defa44c25e78a2ed8473d617dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cXJpb7gBL6UaTWYnzpy_wQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">` props '参数允许自定义突出显示的文本和背景颜色(图片由作者提供)</figcaption></figure><p id="33d3" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">突出显示后，我们可以<strong class="ll iu">快速获得2018年Product_H未售出的洞察</strong>。</p><h2 id="7783" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated">2.突出显示最大(或最小)值</h2><p id="6812" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated">要突出显示每列中的最大值，可以使用<code class="fe oa ob oc od b">dataframe.style.highlight_max()</code>。默认情况下，该方法对每列中<strong class="ll iu">的最大值进行着色，如下图所示。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/06f762dd202d4f85abff9889a6f4b435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tULi9iWptpLoEFKYOBB6w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">` . highlight_max `默认颜色每列中的最大值(图片由作者提供)</figcaption></figure><p id="11f8" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">为了给<strong class="ll iu">每行中的最大值着色，</strong>可以指定参数<code class="fe oa ob oc od b">axis=1</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/bba62bbf430e584da8083cf594d2b15a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zAnZiKTWTco7Sq3WozSPxg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">设置axis=1 in `.highlight_max` colors每行的最大值(图片由作者提供)</figcaption></figure><p id="574e" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated"><strong class="ll iu">注意:同样地，你可以使用</strong> <code class="fe oa ob oc od b">dataframe.style.highlight_min()</code> <strong class="ll iu">方法，通过适当的参数来给行/列中的最小值着色。</strong></p><h2 id="ad64" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated">3.突出显示某个范围内的值</h2><p id="8575" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated">现在让我们考虑想要突出显示100到200之间的值——用<code class="fe oa ob oc od b">dataframe.style.highlight_between(left, right)</code>很容易。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/11459809084812e654e12a7b0542521f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SpqAuKgVx8dPXBxWPgHFtg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用“. highlight_between”方法以黄色突出显示100到200之间的值(图片由作者提供)</figcaption></figure><h2 id="3acf" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated">4.绘制柱内条形图</h2><p id="2484" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated">柱形图绘制在柱形图内，视觉上很吸引人，也很有用。这种条形图可以使用如下所示的<code class="fe oa ob oc od b">dataframe.style.bar()</code>方法创建。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/6f3995bb402b358a8ab3a80c6cfdffb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5DOCpcBBqzQL22KiRNG71Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">使用“dataframe.style.bar”方法在每个列中绘制的条形图(图片由作者提供)</figcaption></figure><p id="676b" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">让我们自定义条形图来改变它的颜色和大小。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/f5c7a36de23b720e8814e187bba1507d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W803GIQ-mgKyfssZC5D4Cw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">列中的自定义条形图(图片由作者提供)</figcaption></figure><h2 id="f6b9" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated">5.使用颜色渐变突出显示值</h2><p id="4d21" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated">如果你想用颜色渐变突出显示整列。可以使用如下图所示的<code class="fe oa ob oc od b">dataframe.style.background_gradient()</code>来完成。在图像中，随着值的增加，颜色从红色变为绿色。您可以设置<code class="fe oa ob oc od b">subset=None</code>将渐变应用于整个数据框。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/ca315464d3834cf42299f84a50d89a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cEK8fie3VMRSYcl7l5GKCA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">列“Product_C”使用红色、黄色和绿色的渐变进行着色(图片由作者提供)</figcaption></figure><h2 id="435e" class="nb nc it bd nd ne nf dn ng nh ni dp nj ls nk nl nm lw nn no np ma nq nr ns nt bi translated">6.奖金🎁</h2><p id="3c39" class="pw-post-body-paragraph lj lk it ll b lm nu ju lo lp nv jx lr ls nw lu lv lw nx ly lz ma ny mc md li im bi translated"><strong class="ll iu">如何在数据中同时突出显示最小值、最大值和缺失值？嗯，你可以定义一个函数，如下图所示。该函数突出显示列'<code class="fe oa ob oc od b">Product_C</code>'中的最小值、最大值和nan值。通过设置<code class="fe oa ob oc od b">subset=None</code>，高亮显示整个数据帧中的值。这个功能是不是真的很酷？请在评论中告诉我你的想法！</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/11d138215e1d03f62859ebf76d29be94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UXPuS3gVE2zykR6k9mJisQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">定义并使用函数高亮显示数据框中的最小值、最大值和缺失值(图片由作者提供)</figcaption></figure><p id="d4e8" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">请随意探索<a class="ae nz" href="https://pandas.pydata.org/docs/user_guide/style.html#Builtin-Styles" rel="noopener ugc nofollow" target="_blank">熊猫文档</a>中的高亮显示方法。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><p id="85cc" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated"><strong class="ll iu">走之前！</strong></p><p id="115f" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated">我希望你喜欢这个故事，并发现它很有用。如果你想听更多这样的故事，请在<a class="ae nz" href="https://medium.com/@hrishikesh.pe" rel="noopener"> Medium </a>上关注我，并且请<a class="ae nz" href="https://www.buymeacoffee.com/hrishikeshds" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡</a>😊。</p><p id="d4bb" class="pw-post-body-paragraph lj lk it ll b lm me ju lo lp mf jx lr ls mg lu lv lw mh ly lz ma mi mc md li im bi translated"><em class="om">我的其他故事你可能会喜欢… </em></p><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/try-these-pandas-display-configurations-in-your-next-analysis-72589648d9a0"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">在您的下一个分析中尝试这些熊猫显示配置</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">在这些有用的熊猫展示定制后，满怀信心地分享您的分析笔记本</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">pub.towardsai.net</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe ks oq"/></div></div></a></div><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/regular-expression-regex-in-python-the-basics-b8f2cd041bdb"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">Python中的正则表达式:基础知识</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">正则表达式允许你从文本中提取重要信息。看看这个中型故事，学习正则表达式的基础知识…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">pub.towardsai.net</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe ks oq"/></div></div></a></div></div></div>    
</body>
</html>