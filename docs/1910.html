<html>
<head>
<title>Find the Desired Product Online with Less Time Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习，用更少的时间在线找到想要的产品</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/build-a-recommendation-system-using-amazon-review-data-11db1b2f912f?source=collection_archive---------2-----------------------#2021-06-11">https://pub.towardsai.net/build-a-recommendation-system-using-amazon-review-data-11db1b2f912f?source=collection_archive---------2-----------------------#2021-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fec4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用自然语言处理和情感分析构建推荐系统</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/11b4638c4639b713efb083c55b90b8e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FzqCnSbdYsFfAB-L"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">莎伦·麦卡琴在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="70e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<a class="ae ky" href="https://baby-car-seat-recommendation.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Web App </strong> </a>和我的<a class="ae ky" href="https://github.com/aaronzhuclover/CarSeat_Recommendation" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> GitHub </strong> </a>上的代码，如果有任何问题，请随时告诉我！</p><h1 id="86c1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">项目背景</h1><p id="4a4b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当你在网上购物时，你有和我一样的经历吗？您在电子商务网站上搜索产品名称。数百种产品可能会出现。你按照评级或价格对产品进行分类，逐一浏览这些相似的产品，浏览其他客户的评论，并试图找到其他客户是否对你感兴趣的产品功能给出过评论。<strong class="lb iu">这一过程非常耗时，很快就会让人不知所措。似乎网上购物并没有让我们的生活变得更容易。</strong></p><p id="0576" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一个像大多数人一样的普通购物者，我想创建一个应用程序，以便在从电子商务网站的众多产品中选择时快速找到所需的产品。</p><p id="4d12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">推荐系统是应对这一挑战的良好开端。但是在为电子商务网站开发推荐系统时，开发人员可能会面临一些问题。</p><ul class=""><li id="c3f2" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><strong class="lb iu">协同过滤</strong>方法中的冷启动问题，因为缺少购物者的历史销售数据</li><li id="6170" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">在研究产品的相关特性时，<strong class="lb iu">基于内容的过滤</strong>方法中的长期学习疗法</li></ul><p id="d639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个项目中，我想以不同的方式创建一个推荐系统。它将顾客的产品评论作为输入，这些评论现在在许多电子商务网站上都可以找到，比如Amazon.com，并对顾客想要的特征进行<strong class="lb iu">情感分析</strong>。</p><p id="5702" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法不同于我们在电子商务网站上发现的平均客户评级，因为这种方法是基于功能级别的评级。所有顾客在搜索产品时需要做的就是提供他们感兴趣的产品特性。然后，推荐系统会根据其他客户的评论自动返回具有最高特征评级的产品。这种方法与普通购物者手动操作非常相似，只是这个推荐系统可以在一秒钟内返回您想要的产品。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/65f3496fb7a7c9954a67effec5a60a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A9n_b6NDTe0AwzVwjcuUYQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">(作者创作)</figcaption></figure><h1 id="a10d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用硒和美汤获取亚马逊评论数据</h1><p id="2d98" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在从任何网站抓取数据之前，您需要了解并遵守网站的使用条款。您收集的数据不应受版权保护或包含敏感的消费者信息。你应该保持适度的数据提取率，这样抓取操作就不会给网站带来负担。此外，请记住，刮出的数据不能用于商业用途。</p><p id="5e57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">刮亚马逊产品评论直截了当用硒和美汤。</p><p id="95ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Selenium是一个以编程方式控制浏览器交互的框架，比如点击、表单提交和鼠标移动。此外，selenium使处理网页变得更加容易，网页中的内容由JavaScript生成。</p><p id="1dbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> BeautifulSoup </strong>是一个Python库，用于解析HTML、XML和其他标记语言。它创建了一个解析树，可以用来从HTML中提取数据。如果网页显示与您的项目相关的数据，但不提供下载数据的直接方式。BeautifulSoup可以帮助你解析网页中的特定内容，移除HTML标记并抓取信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/8995faed3aa8a4925a1573db39da96b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0bSAJbDD5VdU_YlT9m0sOg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Amazon.com</figcaption></figure><p id="94a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以亚马逊网页为例，在给定的评论页面中，我们可以使用BeautifulSoup中的“find”功能，利用HTML标签元素提取数据(如评论标题、评论日期、评论内容等)。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="85ac" class="nn lw it nj b gy no np l nq nr"># rating <br/>rating = i.find('i', {'data-hook': 'review-star-rating'}).get_text()<br/># title<br/>title = i.find('a', {'data-hook': 'review-title'}).get_text()<br/># date <br/>r_date = i.find('span', {'data-hook': 'review-date'}).get_text()<br/># review<br/>review = i.find('span', {'data-hook': 'review-body'}).get_text()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/81c6bd572f2cec212fa91664c3de7a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MxFXHRddkIeN6KeeXx4FA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Amazon.com</figcaption></figure><p id="b898" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在一个网页中导航，并使用Selenium函数“find_element_by_xpath”和“click”转到其他网页。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="7155" class="nn lw it nj b gy no np l nq nr">driver.find_element_by_xpath('//a[<a class="ae ky" href="http://twitter.com/data" rel="noopener ugc nofollow" target="_blank">@data</a>-hook="see-all-reviews-link-foot"]').click()<br/>WebDriverWait(driver, 5).until(EC.element_to_be_clickable((By.XPATH, "//*[contains(text(), 'Next page')]"))).click()</span></pre><h1 id="fe4a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用NLP预处理审阅数据</h1><p id="fbfa" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">从Amazon.com收集了评论数据后，我们需要通过分词、删除停用词、词干、将数字转换为文本和删除标点符号来预处理文本数据。Python库，“<a class="ae ky" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> NLTK </strong> </a>”为<strong class="lb iu">文本预处理</strong>任务提供了很多功能。</p><h1 id="c09d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">通过TF-IDF和余弦相似度过滤相关评论</h1><p id="1529" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在应用程序中，我创建了几个对产品很重要的预定义功能。当父母购买婴儿推车座椅时，他们会寻找一些关键的特征，如轻便、舒适、安全、易于安装、易于清洁、适合新生儿等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/4735391a42991f6c34d06c13105b5c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NcXWoB38Bs5fKE85jL5lVQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">(作者创作)</figcaption></figure><p id="bf69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并非所有的评论都会提到这些产品特性。有些评论与我们感兴趣的功能无关。为了过滤与预定义特征相关的评论，我使用了一些技术，比如<strong class="lb iu"> TF-IDF </strong>和<strong class="lb iu">余弦相似度</strong>来计算相关分数。</p><p id="58d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> TF-IDF </strong>代表“词频—逆文档频率”。将文本数据以数值的形式矢量化，使计算机能够理解文本，是一种流行的方法。与<strong class="lb iu"> Bag-Words </strong>不同，它只是创建包含文档中单词出现次数的向量，TF-IDF根据单词在文档中出现的次数成比例地增加单词的权重，但根据包含该单词的文档数量来抵消权重。例如，在每个文档中常见但不提供相关信息的单词(例如，这个、什么、如何和如果)将排名较低。</p><h1 id="513a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">计算余弦相似度</strong></h1><p id="0a5f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">将评论数据转换成数值后，我可以使用以下数学公式计算每个产品评论和预定义产品特征之间的相似性得分。余弦相似性得分的范围从0到1。余弦值为0意味着两个向量彼此成90度，这意味着这两个向量彼此不相关。余弦值越接近1，产品评论与预定义的特征越相关。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f50048b52c642f5445759cf4e4e5d956.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*lUYDES2AflSmHOP6pqL57Q.png"/></div></figure><p id="18e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用余弦相似度的阈值(0.1)来过滤与预定义特征相关的评论。这减少了审查数据，我们将实施情绪分析从100K到10K，使运行时间大大减少。</p><h1 id="93d0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">通过情感分析获得特征评级</h1><p id="783e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">尽管产品评论的总体情绪得分是有用的，但我进一步计算了产品特定功能的情绪得分。</p><p id="0e46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在跟踪客户评论时，如果客户对汽车座椅是否易于安装和调整感兴趣。<strong class="lb iu">以下评论中的“简单”一词将抓住“安装”和“调整”的情感，这是本推荐系统的精髓</strong>。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="cef2" class="nn lw it nj b gy no np l nq nr"><strong class="nj iu">Review 1</strong>: Easy to <strong class="nj iu"><em class="nv">install,</em></strong> easy to <strong class="nj iu"><em class="nv">adjust</em></strong> incline, 4 year old- almost 5, is comfortable.<br/><strong class="nj iu">Review 2</strong>: <strong class="nj iu"><em class="nv">Installation </em></strong>is difficult. Not easy to <strong class="nj iu"><em class="nv">adjust </em></strong>to the seat.</span></pre><p id="64c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了实现这一点，我做了一个假设，即客户将在特征词周围的词窗口中表达他们对某个特征的看法。所以我在特征词的左边和右边创建了一个由3个词组成的窗口，并将这个窗口的词输入情感分析器。</p><p id="247d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，对于每个评论，我将检测它是否包含特征关键字，如果包含，将产生与特定特征相关的情感分数。</p><p id="a7b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在计算情感得分的过程中，我使用了一个Python包，“<a class="ae ky" href="https://github.com/jmcarpenter2/swifter" rel="noopener ugc nofollow" target="_blank"> Swifter </a>”来加速Pandas的处理。Swifter可以通过并行处理帮助重复执行许多不同的代码。</p><p id="f8ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在产品层面，我计算了每个特性的平均情感分数。最终的数据输出是非常轻量级的，因为每个产品只有一条记录。因为复杂的后端计算可以提前实现，所以前端应用程序的运行速度会非常快。</p><p id="effd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当顾客选择他们感兴趣的特征时，推荐系统将基于所有选择的特征的情感分数的总和返回具有最高情感分数的顶级产品。</p><h1 id="3b20" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在Google BigQuery中存储数据，并使用<strong class="ak"> GitHub和Heroku </strong>创建Dash应用程序</h1><p id="6b5c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦数据被清理和预处理，数据将被存储在Google BigQuery中，以便我的应用程序可以访问后端数据。</p><p id="da39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">web应用程序使用Dash创建，使用GitHub和Heroku部署。如果你对如何设置感兴趣。更多详情见<a class="ae ky" href="https://aaron-zhu.medium.com/create-a-home-price-prediction-app-with-plotly-dash-google-bigquery-and-machine-learning-c86b715f8f04" rel="noopener">我之前的文章</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/6fedb07e530820623c408a31baf6a66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*H3fuYDbQVrfb77TKIiPt7A.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">(作者创作)</figcaption></figure><h2 id="0286" class="nn lw it bd lx nx ny dn mb nz oa dp mf li ob oc mh lm od oe mj lq of og ml oh bi translated">最后一个音符</h2><ul class=""><li id="6110" class="ms mt it lb b lc mn lf mo li oi lm oj lq ok lu mx my mz na bi translated">我可以尝试提出一个度量标准来捕捉评论者的可信度，并使用这个度量标准作为权重来计算总的情感分数，而不是在产品级别计算每个功能的简单平均情感分数。</li><li id="bf09" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">为了将来的改进，我可以尝试其他单词嵌入方法，比如<strong class="lb iu"> Word2Vec </strong>模型来包含单词的本地上下文。对于这种应用，TF-IDF就足够了</li></ul><h1 id="7c86" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">感谢您的阅读！！！</h1><p id="95ad" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果你喜欢这篇文章，并且想<strong class="lb iu">请我喝杯咖啡，</strong>请<a class="ae ky" href="https://ko-fi.com/aaronzhu" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p><p id="8834" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以注册一个<a class="ae ky" href="https://aaron-zhu.medium.com/membership" rel="noopener"> <strong class="lb iu">会员</strong> </a>来解锁我的文章的全部访问权限，并且可以无限制地访问介质上的所有内容。如果你想在我发表新文章时收到电子邮件通知，请订阅。</p></div></div>    
</body>
</html>