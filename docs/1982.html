<html>
<head>
<title>Maximizing Sharpe Ratio in Portfolio Optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">投资组合优化中夏普比率的最大化</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/portfolio-optimization-using-python-f63e6281373c?source=collection_archive---------0-----------------------#2021-07-13">https://pub.towardsai.net/portfolio-optimization-using-python-f63e6281373c?source=collection_archive---------0-----------------------#2021-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="306d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><p id="1c44" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">投资组合优化是数量金融学中最流行的问题之一。它是根据某些目标，从所有被考虑的资产集合中选择各种资产比例的过程。</p><p id="8457" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">它是由Markowitz在20世纪50年代首次提出的，表述为在给定的金融风险(波动性)水平下最大化投资组合的回报。还有其他优化目标，如最小化风险、最大化夏普比率等。有一些有趣的文章和论文讨论优化公式和求解技术[1，2，3，4]。</p><p id="e50e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">本文主要讨论这方面的夏普比率最大化问题。作者使用梯度下降搜索方法提出了一个温和的Python解决方案。它以常用的蒙特卡罗模拟为基准，如下图所示。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ku"><img src="../Images/879547ee3c3c2440d63413ee1f1caf9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vJhDSUgFcJssA87PkwEf7w.gif"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk translated">投资组合优化(作者图片)</figcaption></figure><p id="7bb6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">本文中使用的源代码可以在<a class="ae lk" href="https://github.com/steveyx/PortfolioOptimization" rel="noopener ugc nofollow" target="_blank">我的GitHub资源库</a>中找到。</p><h1 id="8bbe" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">数据源</h1><p id="16dd" class="pw-post-body-paragraph jw jx iq jy b jz mj kb kc kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt ij bi translated">这里使用的数据是使用<strong class="jy ja"> Yfinance </strong>包从雅虎财经下载的。你可以参考<a class="ae lk" href="https://towardsdatascience.com/financial-data-from-yahoo-finance-with-python-b5399743bcc6" rel="noopener" target="_blank">这篇文章</a>关于使用这个包来检索各种类型的财务数据[5]。</p><p id="49cd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">以下代码行用于下载历史每日股票数据:</p><figure class="kv kw kx ky gt kz"><div class="bz fp l di"><div class="mo mp l"/></div></figure><h1 id="7387" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">蒙特 卡罗模拟</h1><p id="6b01" class="pw-post-body-paragraph jw jx iq jy b jz mj kb kc kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt ij bi translated">模拟生成一定数量的投资组合，例如1000个。对于每个投资组合，股票的权重在0和1之间随机分配。假设不允许卖空(负权重)。所有股票权重之和等于1。</p><p id="c8fc" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">使用以下公式计算年度夏普比率。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mq"><img src="../Images/20ddbfb94f2a4c43c4985078b2996214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Zv6RiPyq1TJgppi7-d9-A.jpeg"/></div></div></figure><p id="b37d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">如下图所示，使用<strong class="jy ja"> Matplotlib </strong>软件包绘制波动率与回报率的关系图。具有最大夏普比率和最小波动性的投资组合也被突出显示。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mr"><img src="../Images/c048a7af809bb25d354f40cde878076d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nh89IKvkTwEhT1OQeADlcQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk translated">使用蒙特卡罗模拟的投资组合优化(图片由作者提供)</figcaption></figure><p id="025c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">此外，在我配有2.5GHz CPU和8Gb RAM的PC上，这1000个投资组合的计算时间约为0.43秒。</p><h1 id="46cf" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">梯度下降解</h1><p id="5340" class="pw-post-body-paragraph jw jx iq jy b jz mj kb kc kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt ij bi translated">梯度下降是用于凸优化的最流行的搜索方法之一[6]。因为这里的目标是最大化夏普比率，这种方法也可以称为梯度上升法[7]。该算法在以下步骤中给出。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ms"><img src="../Images/c7081666fcd16f5bd9c2774d07a06a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9B-1HX1QmU9gLvGtlVHbA.png"/></div></div></figure><p id="94af" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">为了加快优化速度，这里的算法使用多个学习率，如上面的步骤所述。它从更大的学习率开始。如果算法找到更好的夏普比率，它将继续以当前的学习速率进行搜索。否则学习率减半。</p><p id="c935" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">搜索停止标准是1)没有找到更好的夏普比率，以及2)学习率足够小，例如小于开始学习率的10%。</p><p id="aefd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">下图显示了两种方法中最佳夏普比率的搜索路径。在蒙特卡罗模拟中，从1000个随机投资组合中获得的最大夏普比率是1.477，而梯度下降解决方案仅在几次迭代中就可以获得1.478的更好的值。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mr"><img src="../Images/501983d24e5a2fb02233cfdb53f78e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqsRNvN2tiXb5Mj2PhXzPw.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk translated">夏普比率最大化路径的两种方法(图片由作者提供)</figcaption></figure><p id="259f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">如上图所示，梯度下降法只需几次迭代就能找到解。该方法的计算时间为0.02秒，比蒙特卡罗模拟(0.43秒)快10倍以上。</p><p id="a456" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">为了测试算法的性能，还包括大量资产，如下表所示。资产的数量从10到100不等。从模拟中产生的随机投资组合的数量与资产的数量成比例。算法中使用的学习率与上一节相同。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mt"><img src="../Images/e07e11967d7854b25a5ff280884b239f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eea11Lv4zI9DYQRc7sCy4w.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk translated">使用大量资产进行基准测试(图片由作者提供)</figcaption></figure><p id="2dfc" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">上表显示，随着资产数量的增加，通过算法获得的最大夏普比率越来越好于模拟。这也表明，对于所有这些情况，该算法导致优化目标的收敛。</p><p id="03d5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">另一方面，模拟需要生成更多的投资组合，以获得可比的目标。从100项资产的结果中可以看出，这大大降低了计算速度。</p><p id="9d89" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在需要以更实时的方式评估大量资产的情况下，这种梯度下降解决方案的优势比模拟更明显。</p><h1 id="c384" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="d1a2" class="pw-post-body-paragraph jw jx iq jy b jz mj kb kc kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt ij bi translated">本文主要研究投资组合优化中的夏普比率最大化问题。它使用梯度下降法给出了一个简单但更有效的解决方案。该解决方案的优势在基准测试中相对于常用的蒙特卡罗模拟得到了体现。</p><p id="186f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">关于本主题中其他优化方法和技术的进一步阅读，您可以参考那些文章[1，6，8]。</p><h1 id="c42c" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">参考</h1><ol class=""><li id="7981" class="mu mv iq jy b jz mj kd mk kh mw kl mx kp my kt mz na nb nc bi translated">《金融中的优化技巧》，安德鲁·莱斯尼夫斯基，<a class="ae lk" href="https://mfe.baruch.cuny.edu/wp-content/uploads/2014/12/Opt_Lecture5_2019.pdf" rel="noopener ugc nofollow" target="_blank">https://mfe . Baruch . CUNY . edu/WP-content/uploads/2014/12/Opt _ lecture 5 _ 2019 . pdf</a></li><li id="1ab8" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">Python中的高效前沿投资组合优化，<a class="ae lk" href="https://towardsdatascience.com/efficient-frontier-portfolio-optimisation-in-python-e7844051e7f" rel="noopener" target="_blank">https://towards data science . com/efficient-Frontier-Portfolio-optimization-in-Python-e 7844051 e7f</a></li><li id="7fab" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">了解投资组合优化，<a class="ae lk" href="https://towardsdatascience.com/understanding-portfolio-optimization-795668cef596" rel="noopener" target="_blank">https://towards data science . com/understanding-Portfolio-Optimization-795668 cef 596</a></li><li id="3dfe" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">从零开始的投资组合优化，<a class="ae lk" href="https://medium.com/swlh/portfolio-optimization-from-scratch-925f66c4020d" rel="noopener">https://medium . com/swlh/portfolio-Optimization-From-Scratch-925 f66c 4020d</a></li><li id="f75c" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">来自雅虎财经的财经数据与Python，<a class="ae lk" href="https://towardsdatascience.com/financial-data-from-yahoo-finance-with-python-b5399743bcc6" rel="noopener" target="_blank">https://towards Data science . com/financial-Data-from-Yahoo-Finance-with-Python-b 5399743 bcc 6</a></li><li id="cea1" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">梯度下降及其变体快速指南，<a class="ae lk" href="https://towardsdatascience.com/quick-guide-to-gradient-descent-and-its-variants-97a7afb33add" rel="noopener" target="_blank">https://towards data science . com/quick-Guide-to-Gradient-Descent-and-Its-Variants-97a AFB 33 add</a></li><li id="e49e" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">Python中带强化学习的交易第二部分:应用，<a class="ae lk" href="https://teddykoker.com/2019/06/trading-with-reinforcement-learning-in-python-part-ii-application/" rel="noopener ugc nofollow" target="_blank">https://teddykoker . com/2019/06/trading-with-Reinforcement-Learning-in-Python-Part-II-Application/</a></li><li id="ea3b" class="mu mv iq jy b jz nd kd ne kh nf kl ng kp nh kt mz na nb nc bi translated">寻找基于优越夏普比率的投资组合，<a class="ae lk" href="https://medium.com/@pai.viji/in-search-of-superior-sharpe-ratio-based-portfolios-3653d1ae989" rel="noopener">https://medium . com/@ pai . viji/in-search-of-superior-Sharpe-Ratio-based-Portfolios-3653 D1 AE 989</a></li></ol></div></div>    
</body>
</html>