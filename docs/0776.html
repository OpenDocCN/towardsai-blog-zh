<html>
<head>
<title>Deploying Algorithms on the Web with Flask and Heroku (for free)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Flask和Heroku在网上部署算法(免费)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/deploying-algorithms-on-the-web-with-flask-and-heroku-for-free-4964fc010a52?source=collection_archive---------0-----------------------#2020-08-08">https://pub.towardsai.net/deploying-algorithms-on-the-web-with-flask-and-heroku-for-free-4964fc010a52?source=collection_archive---------0-----------------------#2020-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0655" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/artificial-intelligence" rel="noopener ugc nofollow" target="_blank">人工智能</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="ccbb" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在部署一个人工智能模型之前，让我们从部署一个算法开始</h2></div><p id="d54c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在本文中，我将指导您使用Heroku在web上部署一个简单的算法。部署是完全免费的，你只需要下载一些软件包。你的应用程序部署到网络上后，每个人都可以使用它。</p><p id="6ac4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">注:</strong>原谅我算法的简单，AI模型的部署需要额外的库，这可能会在开发应用程序时导致更大的问题。现在，我想把重点放在最简单的问题上。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/188adede28c53b98b3befa9277d2f1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKVOaPECIiKX9aa7Aod9jg.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">这是最终版本，<a class="ae md" href="https://dice-roller-ardito-bryan.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">试试吧！</a></figcaption></figure><p id="760b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">本教程的整个步骤将是:</p><ol class=""><li id="20db" class="me mf it kt b ku kv kx ky la mg le mh li mi lm mj mk ml mm bi translated">算法的创建</li><li id="eda8" class="me mf it kt b ku mn kx mo la mp le mq li mr lm mj mk ml mm bi translated">创建一个简单的图形界面</li><li id="208e" class="me mf it kt b ku mn kx mo la mp le mq li mr lm mj mk ml mm bi translated">使用Flask连接两者:远程测试</li><li id="9886" class="me mf it kt b ku mn kx mo la mp le mq li mr lm mj mk ml mm bi translated">安装工具以在Windows 10上部署应用程序</li><li id="e10d" class="me mf it kt b ku mn kx mo la mp le mq li mr lm mj mk ml mm bi translated">部署应用程序</li></ol><h1 id="a0b3" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">1.算法的创建</h1><p id="d1d3" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">为了随机掷骰子，我将使用这个随机数发生器。当这个函数被调用时，它将返回一个介于1和6之间的随机数。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="4eb1" class="nu mt it nq b gy nv nw l nx ny">def dice_roller():<br/>  import random<br/>  #roll dice<br/>  return int(random.random()*6)+1</span></pre><h1 id="ca50" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">2.图形界面的创建</h1><p id="6ed1" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">不幸的是，如果您是后端程序员，您可能不愿意涉足前端编程的奇迹和奥秘。最难做的事情之一是计算机图形，包括网页界面和网页设计。这和一般的AI或者算法相比是完全不同的。事实上，我发现HTML比任何回溯算法都难。下面的代码创建web应用程序的图形。这将允许用户与应用程序背后的后端算法进行通信。</p><h2 id="d107" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">CSS部分</h2><p id="f529" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">通常，CSS和HTML被分成两个文档。然而，为了简单起见，我决定将它们合并到一个页面中。每当我需要编辑一些东西时(当我在使用网络应用程序时，一天要编辑10-15次)，我可以通过打开一个页面来完成。</p><p id="081b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">你可以立即在<a class="ae md" href="http://www.w3schools.com," rel="noopener ugc nofollow" target="_blank">www.w3schools.com上试用代码。我</a>发现它是<a class="ae md" href="https://www.w3schools.com/tryit/tryit.asp?filename=tryhtml_default" rel="noopener ugc nofollow" target="_blank">使用起来最简单的界面</a>。在这段代码中，当你在tryitEditor上运行代码时，CSS和HTML <strong class="kt jd">不是分开的文档</strong>在同一个编辑器中复制两个分区。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oj"><img src="../Images/9f63d4322533a6f3f4eaf9bc300277cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyDzqrvcW0PLmIk2kjbHUg.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">确保您在编辑器中正确地复制并粘贴了它们，然后单击Run以查看页面的外观。</figcaption></figure><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="d476" class="nu mt it nq b gy nv nw l nx ny">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;</span><span id="1510" class="nu mt it nq b gy ok nw l nx ny">&lt;style&gt;<br/>  html {<br/>    height: 100%;} <br/>  .wrapper {<br/>    margin-right: auto; /* 1 */<br/>    margin-left: auto; /* 1 */<br/>    max-width:700px; /* 2 */<br/>    height: 550px;<br/>    padding-right: 0px; /* 3 */<br/>    padding-left: 0px; /* 3 */<br/>    background-color: rgb(38, 38, 38);<br/>    border-radius: 25px;<br/>    text-align: center;<br/>  }<br/>  .text {<br/>    font-family: "Courier New";<br/>    #font-weight: bold;<br/>    #font-weight: 90;<br/>    font-size: 25px;<br/>    color: white;<br/>  }<br/>  .button{<br/>   margin:auto;<br/>    text-align: center;<br/>   display:block;<br/>    border-radius: 12px;<br/>    border-style: none;<br/>    font-size: 20px;<br/>    height: 50px;<br/>    width: 100px;<br/>  }<br/>  .submit{<br/>   margin:auto;<br/>   display:block;<br/>    border-radius: 12px;<br/>    border-style: none;<br/>    height:  150px;<br/>    width: 350px;<br/>    vertical-align: top;<br/>   text-align: center;<br/>    font-family: "Courier New";<br/>    font-size: 20px;<br/>    cursor: pointer;<br/>  }<br/>     /**<br/>     .<br/> */<br/>  }<br/>}<br/>&lt;/style&gt;</span></pre><h2 id="5e00" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">HTML部件</h2><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="8f14" class="nu mt it nq b gy nv nw l nx ny">&lt;br&gt;&lt;/br&gt;<br/>      <br/>&lt;body class="wrapper" style="background: linear-gradient(#e66465, #9198e5)"&gt;<br/>  &lt;div class="wrapper" style="background-color:rgb(255, 255, 255, 0.3)"&gt;<br/>      &lt;div class="text"&gt;<br/>      &lt;br&gt;&lt;/br&gt;<br/>      &lt;br&gt;&lt;/br&gt;<br/>   Dice Roller by Michelangiolo Mazzeschi<br/>      &lt;/div&gt;<br/>      &lt;br&gt;&lt;/br&gt;<br/>      <br/>      &lt;form&gt;<br/>     &lt;input class="submit" type="submit" value="Roll Dice" formmethod="post" style="background-color:rgb(208, 113, 133, 1); color: white; font-size: 30px;"&gt;<br/>      &lt;/form&gt;<br/>      <br/>      &lt;br&gt;&lt;/br&gt;<br/>      &lt;br&gt;&lt;/br&gt;<br/>      &lt;div class="text" style="font-size: 60px;"&gt;<br/>   {{coin_output}}<br/>      &lt;/div&gt;</span><span id="ff54" class="nu mt it nq b gy ok nw l nx ny">&lt;/div&gt;<br/>&lt;/body&gt;</span><span id="2908" class="nu mt it nq b gy ok nw l nx ny">&lt;br&gt;&lt;/br&gt;<br/>&lt;a href="<a class="ae md" href="https://medium.com/@ardito.bryan" rel="noopener">https://medium.com/@ardito.bryan</a>" class="text" &gt;<br/>   Follow me on Medium<br/>&lt;/a&gt;</span><span id="2173" class="nu mt it nq b gy ok nw l nx ny">&lt;/html&gt;</span></pre><ul class=""><li id="ec87" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">在结束这一部分之前，请注意{{coin_output}}，这是一个可以使用python代码传入的变量，它将作为代码和接口之间的一种通信方式。</li><li id="16cb" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">第二个需要强调的是“掷骰子”按钮被放在两个<form> </form>括号中。这将允许您的页面执行POST请求。</li></ul><p id="4c73" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">* * *记住将您的代码保存在pc中的HTML文档中。你可以把这个文件夹叫做form1.html。稍后我会提供进一步的指示。</p><h1 id="4a48" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">3.创建您自己的应用程序界面</h1><p id="621d" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">在这种情况下，您有两种选择:</p><ul class=""><li id="7090" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">自己写HTML + CSS代码</li><li id="6374" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">使用在线编辑器</li></ul><p id="1132" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">虽然最显而易见的选择是使用在线编辑器，因为简单，但是有一个<strong class="kt jd">意想不到的问题</strong>。经过几次令人沮丧的尝试后，我发现任何编辑都会在你的页面中添加大量的代码…</p><p id="01d4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我的意思是，它在你的源代码中嵌入了函数、预置、预制样式，甚至一些CSS引用和Javascript代码。在这种情况下，我决定从头开始制作整个东西的原因是，我想要:</p><ul class=""><li id="d48e" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">清晰的设计</li><li id="bfb3" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">清晰的代码</li></ul><p id="073e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我向你保证，我有点纠结，但是在做了结构化笔记后，结果让我比使用我在网上找到的任何预制样本更有效率。</p><h2 id="2983" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">正在创建app.py</h2><p id="43c7" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">现在是时候创建应用程序背后的代码了。本质上，您正在将您的算法连接到一个web应用程序，并且您需要非常特定的工具来完成这一点。主要是，您有两种选择(还有其他工具，但这些是开发人员中使用最多的):</p><ul class=""><li id="c78b" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">瓶</li><li id="7c47" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">姜戈</li></ul><p id="b457" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">虽然Django用于大型web应用程序(相信我，除非你真的知道自己在做什么，否则不要开始学习Django，因为它看起来很酷，是通往<strong class="kt jd">地狱深处</strong>的门户)，但对于较小的应用，我可以简单地使用Flask。所需的代码被简化，作为程序的架构。</p><p id="40b8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我现在要做的是在Google Colab中运行代码(你也可以使用其他IDE，我选择这个是为了方便)。我将解释部署所需的额外步骤。目前，我们仍处于开发阶段，所以要有耐心。</p><p id="0b25" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">注意事项:</p><ul class=""><li id="c88e" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">要在Google Colab上运行，首先必须安装flask-ngrok库。跑完了！pip install flask-ngrok，您可以简单地注释它，因为安装必须发生一次。</li><li id="a7d3" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">任何应用程序都必须遵循自己的结构和自己的文件夹。我将在您的文件中创建文件夹模板和静态。在它们出现之后，把你已经创建的HTML文件form1.html放在这个文件夹中。(在Google Colab的情况下，只需将它拖到templates文件夹中)。</li></ul><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="8155" class="nu mt it nq b gy nv nw l nx ny">!mkdir templates<br/>!mkdir static<br/>#place your .html files in /content/templates</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a06022d8f9bc916836a5adaf138ca2af.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*7wXs_mbXP09F5XmEB7Y7zg.png"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">这是您的文件夹在IDE中的样子。</figcaption></figure><p id="efa0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这将是整个代码的核心。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="8d8e" class="nu mt it nq b gy nv nw l nx ny">#we cannot break the following paragraph<br/>from flask import Flask, request, render_template</span><span id="ccf0" class="nu mt it nq b gy ok nw l nx ny">app = Flask(__name__)</span><span id="007b" class="nu mt it nq b gy ok nw l nx ny">#questo è per runnarla su colab, nel deployment ricordarsi di commentarla altrimenti da errore immagino<br/>!pip install flask-ngrok #only run the first time<br/>from flask_ngrok import run_with_ngrok<br/>run_with_ngrok(app)   #starts ngrok when the app is running</span><span id="0c31" class="nu mt it nq b gy ok nw l nx ny"><a class="ae md" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route("/", methods=['GET', 'POST'])<br/>def home():<br/>  if request.method == 'POST':<br/>    <br/>    def dice_roller():<br/>      import random<br/>      #roll dice<br/>      return int(random.random()*6)+1</span><span id="e44a" class="nu mt it nq b gy ok nw l nx ny">#ad ogni refresh<br/>    #***l'html deve essere dentro la cartella templates per funzionare /content/templates/form1.html<br/>    return render_template('form1.html',<br/>                           coin_output=dice_roller()<br/>                            )</span><span id="c9ca" class="nu mt it nq b gy ok nw l nx ny">else:<br/>    #WE BEGIN FROM HERE<br/>    #***l'html has to be into the folder templates to start correctly /content/templates/form1.html</span><span id="69ce" class="nu mt it nq b gy ok nw l nx ny">return render_template('form1.html',<br/>                           coin_output='')</span><span id="1083" class="nu mt it nq b gy ok nw l nx ny">if __name__ == "__main__":<br/>  app.run()</span><span id="2b21" class="nu mt it nq b gy ok nw l nx ny">#to export requirements.txt<br/>#!pip freeze &gt; requirements.txt<br/>#!pip freeze</span></pre><h2 id="bf44" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">解释代码</h2><p id="0d42" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">* * *我不能解释代码片段，请参考上面的代码作为参考</p><p id="3944" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我只用了一页来简化事情:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="f6b2" class="nu mt it nq b gy nv nw l nx ny"><a class="ae md" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route("/", methods=['GET', 'POST'])</span></pre><p id="11d1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正如方法声明中所指定的，它可以同时支持GET和POST方法。</p><p id="d158" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当您运行以下代码时，应用程序将检查run: if request.method == 'POST'…它将检查您是在执行GET请求还是POST请求。在第一种情况下，用户试图从页面获取信息(访问它属于这一类)，而如果它试图与页面交互并必须将信息发送到后端算法，它将使用POST函数。这段代码会立即将编译器重定向到<strong class="kt jd"> else </strong>，因为访问页面是一个简单的GET请求。</p><p id="1516" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">第一次访问页面时，算法将运行return:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="da0e" class="nu mt it nq b gy nv nw l nx ny">render_template(‘form1.html’,<br/>                coin_output=’’)</span></pre><p id="e3d2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">只需呈现整个页面，并将“”作为变量coin_output传递。</p><h2 id="3316" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">运行代码并查看</h2><p id="4fd0" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">即使不掷骰子(我还没到那一步)，我也会试着运行代码看看会发生什么。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi on"><img src="../Images/1c4f77e0c54f0a8be214d0d61b3caf7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mkagngl3HqYkPqB5kENqrw.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">输出应该是这样的</figcaption></figure><p id="54f3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">不幸的是，ngrok有点问题，你甚至可以说下面的错误是不可避免的…</p><h2 id="cdf6" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">在出错的情况下</h2><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="3306" class="nu mt it nq b gy nv nw l nx ny">Exception in thread Thread-4:<br/>Traceback (most recent call last):<br/>  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner<br/>    self.run()<br/>  File "/usr/lib/python3.6/threading.py", line 1182, in run<br/>    self.function(*self.args, **self.kwargs)<br/>  File "/usr/local/lib/python3.6/dist-packages/flask_ngrok.py", line 70, in start_ngrok<br/>    ngrok_address = _run_ngrok()<br/>  File "/usr/local/lib/python3.6/dist-packages/flask_ngrok.py", line 38, in _run_ngrok<br/>    tunnel_url = j['tunnels'][0]['public_url']  # Do the parsing of the get<br/>IndexError: list index out of range</span></pre><p id="8b89" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">不要惊慌，有时，我仍然需要了解原因，尝试崩溃，但这不是错误代码的过错。尝试运行代码，直到成功。</p><h2 id="dbeb" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">几次尝试后…</h2><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oo"><img src="../Images/37b9377676cdd74edc4a9414202b2ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wT0LmYi4Z9psM6lg20Y8Cg.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">任何用户首次访问网页</figcaption></figure><p id="fbbf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">到目前为止，无论你在代码的<strong class="kt jd"> if语句</strong>中放入什么，算法的这一部分都是完全起作用的。只有当用户开始与web应用程序交互时，POST请求才会激活它。</p><p id="81bd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我必须关注代码中if语句的核心。如果用户与界面中的按钮(掷骰子)交互，将触发POST请求:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="4a3d" class="nu mt it nq b gy nv nw l nx ny">if request.method == 'POST':</span></pre><p id="3661" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此时，我可以调用dice_roller函数并获得掷骰子的值。用下面的代码，我会把它作为一个变量传递给网页，所以会显示在界面里。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="b7db" class="nu mt it nq b gy nv nw l nx ny">return render_template('form1.html',<br/>                           coin_output=dice_roller()<br/>                            )</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oo"><img src="../Images/5a6800cee0a557b68da761b307afd81b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0cg25W-AT8nTS8NiTS6bPw.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">按下滚动按钮后</figcaption></figure><p id="f7ee" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在完成之前，现在您已经成功地测试了您的应用程序，请对以下行进行注释:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="2d6f" class="nu mt it nq b gy nv nw l nx ny">#!pip install flask-ngrok<br/>#from flask_ngrok import run_with_ngrok<br/>#run_with_ngrok(app)</span></pre><p id="f47d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Flask-ngrok只在Google Colab中工作，在web应用程序中不受支持，所以现在应该忽略它。</p><h2 id="3ef1" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">下载你的作品</h2><p id="c7eb" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">现在您的代码已经完成，请确保下载您的:</p><ul class=""><li id="3744" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">HTML表单</li><li id="d4c4" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">Python代码</li></ul><p id="6203" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因为Flask应用程序需要非常精确的结构，所以请确保从我的repo下载了<a class="ae md" href="https://github.com/arditoibryan/Projects/tree/master/20200803_flask_skeleton" rel="noopener ugc nofollow" target="_blank"> flask-skeleton </a>。</p><p id="1b49" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">* * *从网上选择随机结构时要非常小心。它们可能看起来和这个一样，但是，例如，我一直在尝试的一个有一个错误，阻止了requirements.txt被读取，浪费了我一个小时的时间。我一直和你分享的文件都是我自己测试过的。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi op"><img src="../Images/ab7f5e67c438c6cb6cfcba5c976eb294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*j1PlMFyCNg-zD-YPU7YqoA.png"/></div></figure><p id="8633" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">将该文件下载到您电脑中的一个新文件夹中(我将称之为dice-roller，只要您知道如何访问它，名称并不重要)。如果你想避免整个过程，从我的回购下载已经设置的。然后:</p><ol class=""><li id="bf03" class="me mf it kt b ku kv kx ky la mg le mh li mi lm mj mk ml mm bi translated">将HTML代码放在模板中。</li><li id="8f71" class="me mf it kt b ku mn kx mo la mp le mq li mr lm mj mk ml mm bi translated">删除app.py并放置您在本教程中开发的Flask代码，将其重命名为app.py</li></ol><p id="1347" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您应该准备好了:准备部署！</p><h1 id="3174" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">4.安装工具:git和Heroku</h1><p id="2f27" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">现在是事情变得艰难的时候了！！！到目前为止，我一直专注于简单的部分。如果这是您的第一次部署，并且您不熟悉git和cmd的工作方式，请不要担心！</p><p id="1f20" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我还没有找到一种简单地通过互联网部署web应用程序的方法。您需要下载两个简单的工具，这样您就可以从cmd界面进行操作:</p><ul class=""><li id="7c52" class="me mf it kt b ku kv kx ky la mg le mh li mi lm ol mk ml mm bi translated">Git ( <a class="ae md" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">此处下载</a>)</li><li id="5726" class="me mf it kt b ku mn kx mo la mp le mq li mr lm ol mk ml mm bi translated">Heroku ( <a class="ae md" href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install" rel="noopener ugc nofollow" target="_blank">此处下载</a>)</li></ul><p id="2e01" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">确保您在这两个工具上都有一个帐户，并且拥有自己的用户名和密码。首次进行部署时，您可能需要使用您的凭据进行访问。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oq"><img src="../Images/5d0c6a354d0b72265af4f912a65c5454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEcT3TwlWmAJ5c3XfH8qVw.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">在您的中打开cmd</figcaption></figure><p id="248e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">要检查Heroku和git是否正确安装，只需在cmd中键入它们:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="104c" class="nu mt it nq b gy nv nw l nx ny">C:\Users\Michelangiolo&gt;git<br/>C:\Users\Michelangiolo&gt;heroku</span></pre><p id="270d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果他们没有运行任何错误或报告缺少库，那么到目前为止，一切都很好。</p><h1 id="4c77" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">5.使用命令提示符部署应用程序</h1><p id="41db" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">现在，在cmd中转到dice_roller文件夹的位置并输入。您可以使用以下命令在文件夹之间移动:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="3376" class="nu mt it nq b gy nv nw l nx ny">cd ..</span></pre><p id="a2ec" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">…退出文件夹。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="e642" class="nu mt it nq b gy nv nw l nx ny">cd 'Folder Name'</span></pre><p id="7bdf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">…从您的位置访问任何可访问的文件夹。例如，我在C:\Users\Michelangiolo文件夹中。因为Downloads在Michelangiolo文件夹中，所以我只需编写cd Downloads，然后是cd dice_roller(它在Downloads文件夹中)。因此，我可以从cmd中看到我在文件夹内。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="80a0" class="nu mt it nq b gy nv nw l nx ny">C:\Users\Michelangiolo\Downloads\dice-roller&gt;git init<br/>C:\Users\Michelangiolo\Downloads\dice-roller&gt;git add .<br/>C:\Users\Michelangiolo\Downloads\dice-roller&gt;git commit -m "X"<br/>C:\Users\Michelangiolo\Downloads\dice-roller&gt;heroku create dice-roller-ardito-bryan</span></pre><p id="309f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后一行，Heroku用上面的名字创建了一个空的应用空间。如果你把名字留空，Heroku会用一个随机的名字创建一个应用程序，这是一个非常有用的应用程序。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="6c57" class="nu mt it nq b gy nv nw l nx ny">C:\Users\Michelangiolo\Downloads\dice-roller&gt;heroku git:remote -a dice-roller-ardito-bryan<br/>&gt;&gt;&gt; set git remote heroku to <a class="ae md" href="https://git.heroku.com/dice-roller-ardito-bryan.git" rel="noopener ugc nofollow" target="_blank">https://git.heroku.com/dice-roller-ardito-bryan.git</a></span></pre><p id="aba6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，您已经设置了git文件夹，可以在Heroku应用程序中部署了。</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="1ff3" class="nu mt it nq b gy nv nw l nx ny">C:\Users\Michelangiolo\Downloads\dice-roller&gt;git push heroku master<br/>...<br/>remote: -----&gt; Launching...<br/>remote:        Released v3<br/>remote:        <a class="ae md" href="https://dice-roller-ardito-bryan.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://dice-roller-ardito-bryan.herokuapp.com/</a> deployed to Heroku<br/>remote:<br/>remote: Verifying deploy... done.<br/>To <a class="ae md" href="https://git.heroku.com/dice-roller-ardito-bryan.git" rel="noopener ugc nofollow" target="_blank">https://git.heroku.com/dice-roller-ardito-bryan.git</a><br/> * [new branch]      master -&gt; master</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/188adede28c53b98b3befa9277d2f1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKVOaPECIiKX9aa7Aod9jg.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk translated">【https://dice-roller-ardito-bryan.herokuapp.com/ T4】</figcaption></figure><p id="a252" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">链接<a class="ae md" href="https://dice-roller-ardito-bryan.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">已经部署了应用</a>在描述中可用。我希望你觉得这个教程有用，如果是这样，请留下掌声。</p><h2 id="f244" class="nu mt it bd mu nz oa dn my ob oc dp nc la od oe ne le of og ng li oh oi ni iz bi translated">在致命错误的情况下</h2><p id="d1e1" class="pw-post-body-paragraph kr ks it kt b ku nk kd kw kx nl kg kz la nm lc ld le nn lg lh li no lk ll lm im bi translated">如果出于某种原因，您遇到一些错误或应用程序在访问时无法正确呈现，只需在cmd中键入:</p><pre class="lo lp lq lr gt np nq nr ns aw nt bi"><span id="2733" class="nu mt it nq b gy nv nw l nx ny">heroku logs</span></pre><p id="bd01" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Heroku会告诉你错误在哪里。</p></div></div>    
</body>
</html>