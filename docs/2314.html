<html>
<head>
<title>How Rasa Calculates The Number Of Turns In A Story</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rasa如何计算故事的循环次数</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-rasa-calculates-the-number-of-turns-in-a-story-841d9300f9de?source=collection_archive---------6-----------------------#2021-11-08">https://pub.towardsai.net/how-rasa-calculates-the-number-of-turns-in-a-story-841d9300f9de?source=collection_archive---------6-----------------------#2021-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="904d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><div class=""><h2 id="41dc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用VS代码学习他人源代码的一些工具和技巧</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b416a7bed6b306bb76a56a7a0ed181ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YGR_QAiyT8JDx__boXKWzQ.png"/></div></div></figure><h1 id="e1a8" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">介绍</h1><p id="7061" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">在这篇文章中，我将分享一些工具和技术来研究一个项目的源代码，以找到答案。目标是能够快速找到项目文档中没有涉及的一些实现细节问题的答案。</p><p id="2603" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">为了更具体，我将使用<a class="ae mw" href="https://github.com/rasahq/rasa" rel="noopener ugc nofollow" target="_blank"> rasa开源</a>项目作为例子。不一定要熟悉这个项目才能理解，因为理解代码所需的领域知识会在过程中解释。</p><p id="e599" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">重现本文中描述的结果的代码可以在<a class="ae mw" href="https://github.com/hsm207/rasa_story_steps" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="647f" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">问题陈述</h1><p id="d1dd" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">假设我们对微调聊天机器人使用的<a class="ae mw" href="https://rasa.com/docs/rasa/policies/#memoization-policy" rel="noopener ugc nofollow" target="_blank">记忆策略</a>感兴趣。根据文档，该策略有一个<code class="fe mx my mz na b">max_history</code>参数，用于执行以下操作:</p><blockquote class="nb nc nd"><p id="378a" class="lv lw ne lx b ly mr kd ma mb ms kg md nf mt mg mh ng mu mk ml nh mv mo mp mq im bi translated">在您的训练数据中寻找匹配时，该策略会将对话的最后<code class="fe mx my mz na b">max_history</code>轮次考虑在内。</p></blockquote><p id="4c3e" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">“转弯”被描述为:</p><blockquote class="nb nc nd"><p id="a65d" class="lv lw ne lx b ly mr kd ma mb ms kg md nf mt mg mh ng mu mk ml nh mv mo mp mq im bi translated">一个“回合”包括用户发送的消息和助理在等待下一个消息之前执行的任何动作。</p></blockquote><p id="c802" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">所以，给定这个故事:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/aab03d279e03761626d761b53a066048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*5aFwys8nBiJYqYr_LtTTuA.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图1:一个例子</figcaption></figure><p id="a200" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">当机器人需要预测意图<code class="fe mx my mz na b">affirm</code>(第19行)之后的动作时，它将回顾的最大回合数是6，因为第20行之前的每个意图和动作都算作一个回合……或者是5，因为第17和18行中的连续动作实际上算作一个回合？或者，可能是3，因为每个意图和动作都被配对来计算一次(除了第19行的<code class="fe mx my mz na b">affirm</code>意图)？</p><p id="4a82" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">如果文档中提供了一些关于如何计算故事情节转折的例子就好了…</p><p id="8c5c" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">在这一点上，我们可以在项目的<a class="ae mw" href="https://forum.rasa.com/" rel="noopener ugc nofollow" target="_blank">论坛</a>上问这个问题，但是考虑到未回答问题的数量，我们不太可能很快得到答案(如果有的话)。</p><p id="d971" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">让我们看看，在VS代码的帮助下，我们能否自己解决问题。</p><h1 id="5686" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">方法</h1><h2 id="dc57" class="nn le it bd lf no np dn lj nq nr dp ln me ns nt lp mi nu nv lr mm nw nx lt iz bi translated">概观</h2><p id="8b2e" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">一般来说，找出不是你写的代码的实现细节是一个5步的过程:</p><ol class=""><li id="c31a" class="ny nz it lx b ly mr mb ms me oa mi ob mm oc mq od oe of og bi translated"><strong class="lx jd">设置项目</strong>:这通常意味着将项目的源代码克隆到您的本地机器上</li><li id="71cb" class="ny nz it lx b ly oh mb oi me oj mi ok mm ol mq od oe of og bi translated"><strong class="lx jd">设置调试器</strong>:这一步包括如何在项目启动时让调试器运行</li><li id="d9e8" class="ny nz it lx b ly oh mb oi me oj mi ok mm ol mq od oe of og bi translated"><strong class="lx jd">确定一个好的起点</strong>:人们总是可以从主入口点开始阅读代码，但是如果我们只对一个特定的行为感兴趣，这是低效的。熟悉一下项目的设计架构将有助于节省时间，因为它允许我们快速地将注意力集中在更小的一组功能或模块上。</li><li id="f788" class="ny nz it lx b ly oh mb oi me oj mi ok mm ol mq od oe of og bi translated"><strong class="lx jd">添加日志点</strong>:这是指将感兴趣的变量的值记录到控制台，以查看它们在程序执行过程中是如何演变的</li><li id="3e83" class="ny nz it lx b ly oh mb oi me oj mi ok mm ol mq od oe of og bi translated"><strong class="lx jd">使用断点:</strong>如果事情变得太复杂，比如要跟踪的变量太多，那么你应该考虑暂停程序的执行，以便使用控制台更详细地检查其状态，或者一次执行一行程序。</li></ol><h2 id="c351" class="nn le it bd lf no np dn lj nq nr dp ln me ns nt lp mi nu nv lr mm nw nx lt iz bi translated">步骤1: Bot设置</h2><p id="b4f7" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">首先，在训练机器人时，我们将只关注图1中的一个训练故事。</p><p id="b0ec" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">接下来，我们还简化了机器人的<code class="fe mx my mz na b">config.yml</code>，以便我们可以专注于<code class="fe mx my mz na b">MemoizationPolicy</code>的机制:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/8438fee2cc70ba308ace500eeb8d4ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T3E0YrHuiK74C_Bpii4JBw.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图2:我们将用来计算max_history的config.yml</figcaption></figure><p id="6d51" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">请注意，我们将<code class="fe mx my mz na b">max_history</code>设置为一个高得离谱的数字。我们这样做是为了当机器人试图预测第20行时，包含图1中的整个故事。我们可能还不知道什么是“转折”，但这个故事不可能有超过10，000个转折。</p><h2 id="39ee" class="nn le it bd lf no np dn lj nq nr dp ln me ns nt lp mi nu nv lr mm nw nx lt iz bi translated">步骤2:调试器设置</h2><p id="1385" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">我们希望运行训练逻辑，这样我们可以在中途暂停执行，以便在必要时检查机器人的内部。</p><p id="cd8e" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">这可以通过在VS代码中创建一个<a class="ae mw" href="https://code.visualstudio.com/docs/python/debugging#_initialize-configurations" rel="noopener ugc nofollow" target="_blank">启动配置</a>来调试<code class="fe mx my mz na b">rasa</code>模块来实现:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/dd6efd4f4eb4d99906be14baa2fdb09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*r7hJtZ9TPCIUJs6KkTWFSQ.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图3:创建启动配置来调试rasa模块</figcaption></figure><p id="af87" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">需要注意的是，我们已经将<code class="fe mx my mz na b">justMyCode</code>参数设置为<code class="fe mx my mz na b">false</code>。如果我们不这样做，那么我们在模块<code class="fe mx my mz na b">rasa</code>的任何地方插入的断点都将不起作用，因为源代码不在我们的项目中。</p><p id="7afe" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">现在，我们可以随时转到<code class="fe mx my mz na b">Run and Debug</code>并点击<code class="fe mx my mz na b">Train core model</code>按钮，启动一个附带调试器的培训任务:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/35a6be0ff58762db0532fdeea7635265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DjYZTfZLp4Toktrny3yKBg.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图4:如何在附带调试器的中启动培训作业</figcaption></figure><h2 id="38f5" class="nn le it bd lf no np dn lj nq nr dp ln me ns nt lp mi nu nv lr mm nw nx lt iz bi translated">步骤3:找到开始调查的起点</h2><p id="29e6" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">从文档中，我们知道rasa源代码中的某个地方是<code class="fe mx my mz na b">MemoizationPolicy</code>类的定义。从文档中我们还知道这个类必须有一个<code class="fe mx my mz na b">train</code>方法。所以用这种方法作为我们的起点来弄清楚这个故事是如何被记住的是有意义的。</p><p id="3c0e" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">我们可以使用VS代码的搜索功能找到在哪里定义了<code class="fe mx my mz na b">MemoizationPolicy</code>类:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/b2b13680f927e66261e60621eb46ebda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sggEDsR3d1uNiDqgCrvdlA.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图5:快速找到类的定义</figcaption></figure><p id="6384" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">我们首先打开一个终端，找出<code class="fe mx my mz na b">rasa</code>模块安装在哪里。然后，我们使用搜索窗格来查找<code class="fe mx my mz na b">memoizationpolicy</code>，并将搜索位置限制为仅在安装了<code class="fe mx my mz na b">rasa</code>模块的位置进行搜索。最后，我们挑选任何使用<code class="fe mx my mz na b">MemoizationPolicy</code>类的结果，并使用智能感知来实际访问类定义。</p><p id="472a" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">使用VS代码的<code class="fe mx my mz na b">Outline</code>视图定位<code class="fe mx my mz na b">MemoizationPolicy</code>类的<code class="fe mx my mz na b">train</code>方法很容易:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/8c7deb31f83c0fc1e2e6a80619d715ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kg4KU9yzj59_wUYxHTNeDQ.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图6:使用Outline视图探索一个类的方法</figcaption></figure><h2 id="d48f" class="nn le it bd lf no np dn lj nq nr dp ln me ns nt lp mi nu nv lr mm nw nx lt iz bi translated">步骤4:使用日志来验证事情</h2><p id="f351" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">训练记忆化策略的代码非常简洁:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/08fb2fbd51b2964d8d2e0509cba10f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KL1ZiCfFDiGy5iPCpfCbSg.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图7:记忆策略是如何被训练的</figcaption></figure><p id="9f4b" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">对记忆化工作原理的总体理解清楚地表明，第185到188行创建了一个状态和动作对，其中状态是特征，动作是表示基本事实的标签。第189行使用这个状态和动作对来构建一个查找表。</p><p id="a72d" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">因此，当记忆策略被训练时，我们应该检查对应于动作<code class="fe mx my mz na b">utter_happy</code>的状态的内容。这可以在VS代码中使用<a class="ae mw" href="https://code.visualstudio.com/blogs/2018/07/12/introducing-logpoints-and-auto-attach" rel="noopener ugc nofollow" target="_blank">日志点</a>来完成:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/f592ee2ee1a306ce65be7ac9d6eee69e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*NQc6qBAzWjx4RaqXazi_AQ.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图8:如何添加一个日志点</figcaption></figure><p id="2861" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">这是我们启动<code class="fe mx my mz na b">Train core model</code>并观看<code class="fe mx my mz na b">Debug Console</code>时发生的情况:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/a3ff1eca31bf4dadfbf8d1d93e791ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PpvMu4JwQ9diHKEx55B6KQ.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图9:如何在运行时查看日志点</figcaption></figure><p id="618a" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">根据图9，图1中的故事创建了8个状态，用于预测<code class="fe mx my mz na b">utter_happy</code>的状态有7个转折。所以，我们的猜测没有一个是正确的。</p><h2 id="6ad7" class="nn le it bd lf no np dn lj nq nr dp ln me ns nt lp mi nu nv lr mm nw nx lt iz bi translated">步骤5:使用断点进行详细调查</h2><p id="646b" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">我们需要找出用于预测动作<code class="fe mx my mz na b">utter_happy</code>的状态转动次数的猜测中的误差来源。</p><p id="0376" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">我们可以继续记录更多的细节，但是每次我们改变我们想要记录的东西时，都必须重新运行训练，这变得很乏味。此外，复杂的数据结构，例如字典列表，在调试控制台中打印不出来。</p><p id="6768" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">如果我们能够暂停代码的执行，并使用任意python代码检查代码的状态，那就更好了。这就是断点出现的地方。</p><p id="bc15" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">我们可以用一个断点替换我们在图8中添加的日志点，以便在创建了<code class="fe mx my mz na b">trackers_as_states</code>和<code class="fe mx my mz na b">trackers_as_actions</code>之后立即暂停代码执行。然后，我们可以运行任意的python代码<code class="fe mx my mz na b">Debug Console</code>来检查这些变量:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/bbcd1605721b58db598c421fc3464b1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*UO684fS-CGRYYHvLCNk1xA.gif"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图10:使用断点检查内部状态</figcaption></figure><p id="c9dd" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">图10显示了用于预测<code class="fe mx my mz na b">utter_happy</code>的状态中的第一个元素是一个空字典，即<code class="fe mx my mz na b">{}</code>。第二个元素对应于意图<code class="fe mx my mz na b">greet</code>，即图1中的线14。其余的元素也可以用一种明显的方式映射到故事中。</p><p id="a875" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">查看预测的标签，即<code class="fe mx my mz na b">trackers_as_actions</code>变量，我们看到第一个元素是<code class="fe mx my mz na b">action_listen</code>，因此我们得出结论，如果状态为空，即<code class="fe mx my mz na b">{}</code>(例如，在对话开始时)，那么机器人应该只侦听用户输入。</p><h1 id="7318" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">回答</h1><p id="be03" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">上一节已经表明，对以下内容的实际解释:</p><blockquote class="nb nc nd"><p id="e477" class="lv lw ne lx b ly mr kd ma mb ms kg md nf mt mg mh ng mu mk ml nh mv mo mp mq im bi translated">一个“回合”包括用户发送的消息和助理在等待下一个消息之前执行的任何动作。</p></blockquote><p id="a4c9" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">每个意图和行为构成一个回合。此外，还有一个<code class="fe mx my mz na b">action_listen</code>会自动附加在故事的开头(在结尾也是！)这也算一个回合。</p><p id="81ef" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">因此，图1中的故事可以看作是:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/6e945e283087660507ba060ab46254da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*ZgNNwsYg-MBQY66yZw28EQ.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图11:添加到图1中故事的隐含动作</figcaption></figure><p id="760f" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">这意味着故事实际上有8个回合，当机器人需要预测意图<code class="fe mx my mz na b">affirm</code>之后的动作时，记忆策略将使用从第3行的<code class="fe mx my mz na b">action_listen</code>开始的状态(7个回合，从第9行的意图<code class="fe mx my mz na b">affirm</code>开始计数)，当然假设<code class="fe mx my mz na b">max_history</code>被设置为大于7。</p><p id="0f38" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">一个经常被问到的问题是:如果故事有很多<code class="fe mx my mz na b">slot_was_set</code>事件会怎样？例如:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/b1d9848a324853c3f4a8f036b79b65e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ao3k2N91XASru8b3cqkQVQ.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">图12:一个包含许多插槽设置事件的故事</figcaption></figure><p id="6619" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">每条<code class="fe mx my mz na b">slot_was_set</code>线是否构成一个“转弯”？答案留给读者作为练习。</p><h1 id="bb5b" class="ld le it bd lf lg lh li lj lk ll lm ln ki lo kj lp kl lq km lr ko ls kp lt lu bi translated">结论</h1><p id="48a2" class="pw-post-body-paragraph lv lw it lx b ly lz kd ma mb mc kg md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">本文描述了使用VS代码研究他人编写的一段代码的内部工作的一般方法。它以rasa开源项目为例来说明故事中的“转折”意味着什么，但同样的方法可以应用于任何编程语言的任何项目。</p><p id="4d73" class="pw-post-body-paragraph lv lw it lx b ly mr kd ma mb ms kg md me mt mg mh mi mu mk ml mm mv mo mp mq im bi translated">我希望你已经发现这是有用的。</p></div></div>    
</body>
</html>