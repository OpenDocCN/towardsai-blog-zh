<html>
<head>
<title>Create and Deploy your First Flask App using Python and Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Heroku创建并部署您的第一个Flask应用程序</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/create-and-deploy-your-first-flask-app-using-python-and-heroku-aee04eaddc71?source=collection_archive---------0-----------------------#2020-08-27">https://pub.towardsai.net/create-and-deploy-your-first-flask-app-using-python-and-heroku-aee04eaddc71?source=collection_archive---------0-----------------------#2020-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6aa2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/bce5bb89f0f8a854dc60af81a817b0b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tRhiCu75pUVHeAJTliJTbA.png"/></div></div></figure><p id="806f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">Flask是一个用Python写的web应用框架。在这里，我使用Python创建了一个应用程序，并部署在Heroku上。</p><p id="b14a" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><a class="ae lf" href="https://trending-shows.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">点击此处</a>启动我的演示网络应用。</p><h2 id="598b" class="lg lh iq bd li lj lk dn ll lm ln dp lo ks lp lq lr kw ls lt lu la lv lw lx iw bi translated">先决条件</h2><ul class=""><li id="8485" class="ly lz iq kj b kk ma ko mb ks mc kw md la me le mf mg mh mi bi translated"><a class="ae lf" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">巨蟒</a></li><li id="f464" class="ly lz iq kj b kk mj ko mk ks ml kw mm la mn le mf mg mh mi bi translated">瓶</li><li id="96e8" class="ly lz iq kj b kk mj ko mk ks ml kw mm la mn le mf mg mh mi bi translated"><a class="ae lf" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank"> Git </a></li><li id="eb6e" class="ly lz iq kj b kk mj ko mk ks ml kw mm la mn le mf mg mh mi bi translated">Heroku CLI </li></ul><h2 id="60b5" class="lg lh iq bd li lj lk dn ll lm ln dp lo ks lp lq lr kw ls lt lu la lv lw lx iw bi translated">装置</h2><p id="acff" class="pw-post-body-paragraph kh ki iq kj b kk ma km kn ko mb kq kr ks mo ku kv kw mp ky kz la mq lc ld le ij bi translated">安装Python之后，安装列出的其他框架和库。您可以使用以下命令轻松安装flask。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="4b22" class="lg lh iq mw b gy na nb l nc nd">pip install Flask<br/>#pip install &lt;package_name&gt;</span></pre><h1 id="42b1" class="ne lh iq bd li nf ng nh ll ni nj nk lo nl nm nn lr no np nq lu nr ns nt lx nu bi translated">定义您的web应用程序的结构</h1><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="cfec" class="lg lh iq mw b gy na nb l nc nd">static<br/>    |_main.css<br/>template<br/>    |_display.html<br/>app.py<br/>trending.py<br/>requirements.txt</span></pre><p id="d779" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">静态目录包含您的CSS文件，模板包含用于呈现的HTML文件。</p><p id="91bb" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">您可以创建一个单独的。py文件为你的逻辑和其他操作或者在同一个app里写代码. py我建议创建一个单独的文件会减少混乱。</p><h1 id="3fd4" class="ne lh iq bd li nf ng nh ll ni nj nk lo nl nm nn lr no np nq lu nr ns nt lx nu bi translated">第一步:</h1><blockquote class="nv nw nx"><p id="2f91" class="kh ki ny kj b kk kl km kn ko kp kq kr nz kt ku kv oa kx ky kz ob lb lc ld le ij bi translated">创建你的<strong class="kj ja"> app.py </strong>文件</p></blockquote><p id="08fd" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我使用了waste服务，使用这个库的原因是它是一个生产质量的纯Python WSGI服务器，具有非常好的性能。除了Python标准库中的依赖项之外，它没有其他依赖项。</p><p id="9983" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja">安装服务员</strong></p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="c655" class="lg lh iq mw b gy na nb l nc nd">pip install waitress</span></pre><figure class="mr ms mt mu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oc"><img src="../Images/196a181ff4bee8bf0ee8298d6b768988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7qcgOXBcIj8VClWBeLt2ZA.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">app.py</figcaption></figure><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9723" class="lg lh iq mw b gy na nb l nc nd">import requests<br/>from flask import Flask, render_template, redirect, url_for, request<br/>from datetime import datetime, timedelta<br/>import time<br/>import json<br/>import os<br/>from trending import get_trending</span><span id="a734" class="lg lh iq mw b gy oh nb l nc nd">app = Flask(__name__)</span><span id="b9c7" class="lg lh iq mw b gy oh nb l nc nd">@app.route('/')</span><span id="b7d0" class="lg lh iq mw b gy oh nb l nc nd">def trending():</span><span id="0dc4" class="lg lh iq mw b gy oh nb l nc nd">info = get_trending()<br/>   render_template('display.html', info=info['data'])</span><span id="e549" class="lg lh iq mw b gy oh nb l nc nd">return res</span><span id="b8d6" class="lg lh iq mw b gy oh nb l nc nd">if __name__ == "__main__":<br/>     app.debug = False<br/>     port = int(os.environ.get('PORT', 33507))<br/>     waitress.serve(app, port=port)</span></pre><p id="612c" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">如上所示，我们使用了<strong class="kj ja"> GET </strong>方法从服务器发送数据。</p><p id="d3f9" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">还有其他几种可用的方法，它们是</p><p id="6ab3" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> <em class="ny"> POST: </em> </strong> <em class="ny">用于将用户/表单数据发送到服务器，不缓存传输的数据。</em></p><p id="8bea" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> <em class="ny">头:</em> </strong> <em class="ny">它类似于GET，但不同的是它是在没有响应体的情况下使用的</em></p><p id="5459" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> <em class="ny"> PUT: </em> </strong> <em class="ny">它是</em> <strong class="kj ja"> <em class="ny"> </em> </strong> <em class="ny">用来用上传的内容替换当前资源</em></p><p id="89b4" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> <em class="ny">删除:</em> </strong> <em class="ny">用于删除URL中提供的目标资源。</em></p><h1 id="d992" class="ne lh iq bd li nf ng nh ll ni nj nk lo nl nm nn lr no np nq lu nr ns nt lx nu bi translated">第二步:</h1><blockquote class="nv nw nx"><p id="6a76" class="kh ki ny kj b kk kl km kn ko kp kq kr nz kt ku kv oa kx ky kz ob lb lc ld le ij bi translated"><strong class="kj ja"> <em class="iq">创建trending.py文件，基本上就是在app.py文件</em> </strong>中创建导入主函数后包含您的业务逻辑的文件</p></blockquote><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="844f" class="lg lh iq mw b gy na nb l nc nd">from trending import get_trending</span></pre><p id="50c7" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">我的trending.py文件如下所示:</p><figure class="mr ms mt mu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oi"><img src="../Images/f07efbd8eaf1af0798efc062c6dd2048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*roXMOYAJXdR15qfTZHn9tw.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">trending.py</figcaption></figure><p id="c115" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">收集数据后，我们可以使用HTML文件呈现输出</p><p id="30b5" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">输出数据将显示在HTML页面上。</p><h1 id="cace" class="ne lh iq bd li nf ng nh ll ni nj nk lo nl nm nn lr no np nq lu nr ns nt lx nu bi translated">第三步:</h1><blockquote class="nv nw nx"><p id="684b" class="kh ki ny kj b kk kl km kn ko kp kq kr nz kt ku kv oa kx ky kz ob lb lc ld le ij bi translated">创建一个HTML文件，用于呈现从响应对象收集的输出。</p></blockquote><p id="51fb" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">下面是我的display.html文件的样子</p><figure class="mr ms mt mu gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oj"><img src="../Images/c2e4fb787157e1dbaccfd20a695dad3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ya6kNdtxUpCMv4I6X-lG4w.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">display.html</figcaption></figure><p id="dee4" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">您几乎完成了编码部分，现在是时候部署我们的第一个flask应用程序了。</p><p id="aef0" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在部署应用程序之前，首先检查本地主机上的flask应用程序。</p><h1 id="3b13" class="ne lh iq bd li nf ng nh ll ni nj nk lo nl nm nn lr no np nq lu nr ns nt lx nu bi translated">部署步骤</h1><ol class=""><li id="476a" class="ly lz iq kj b kk ma ko mb ks mc kw md la me le ok mg mh mi bi translated"><strong class="kj ja">使用CLI登录您的Heroku帐户</strong></li></ol><p id="cb50" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">您可以通过在终端中写入以下命令来登录。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="6206" class="lg lh iq mw b gy na nb l nc nd">heroku login</span></pre><p id="ee90" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> 2。在Heroku上创建一个web应用程序</strong></p><p id="fd6f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">您可以使用以下命令在Heroku上创建一个新的应用程序</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="0c87" class="lg lh iq mw b gy na nb l nc nd">heroku create &lt;your_app_name&gt;</span></pre><p id="9433" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> 3。</strong> <strong class="kj ja">在同一个项目目录</strong>下创建<em class="ny"> requirements.txt </em>文件</p><p id="e04d" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">要生成requirement.txt文件，可以使用下面的命令</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5ad0" class="lg lh iq mw b gy na nb l nc nd">pip freeze &gt; requirements.txt</span></pre><p id="303f" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> 4。创建一个过程文件</strong></p><p id="5d82" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> Procfile </strong>是所有Heroku应用程序所需的工艺文件。</p><p id="e4dc" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">Procfile指定了应用程序在启动时执行的命令。</p><p id="1b5e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><a class="ae lf" href="https://devcenter.heroku.com/articles/procfile" rel="noopener ugc nofollow" target="_blank">点击此处</a>阅读更多关于<strong class="kj ja"> Procfile </strong>的信息</p><p id="b21e" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">在Procfile中输入以下内容</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="a369" class="lg lh iq mw b gy na nb l nc nd">web: gunicorn app:app</span></pre><p id="0b16" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">这里的应用程序是你的主(。py)文件在我的例子中是app.py</p><p id="b901" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">如果您没有安装gunicorn web服务器，那么使用以下命令安装它</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="925f" class="lg lh iq mw b gy na nb l nc nd">pip install gunicorn</span></pre><blockquote class="nv nw nx"><p id="2ad6" class="kh ki ny kj b kk kl km kn ko kp kq kr nz kt ku kv oa kx ky kz ob lb lc ld le ij bi translated">注意:您必须创建一个没有任何文件扩展名的Procfile</p></blockquote><p id="b491" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> 5。创建<em class="ny"> runtime.txt </em>来指定运行时的python版本</strong></p><p id="2eab" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">创建runtime.txt后，添加您的构建python版本，如下所示</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="99a4" class="lg lh iq mw b gy na nb l nc nd">python-3.8.1</span></pre><p id="b172" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">现在，我们都准备好了！</p><p id="5789" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">6.初始化空的git存储库并推送代码</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="6223" class="lg lh iq mw b gy na nb l nc nd">git init</span></pre><p id="9257" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">接下来，是时候使用以下步骤提交您的最终代码了</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="f812" class="lg lh iq mw b gy na nb l nc nd">git add .<br/>git commit -m "My first commit"<br/>git push heroku master</span></pre><p id="b7ce" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">您的应用程序现已上线，您可以使用生成的URL查看您的web应用程序</p><p id="dc84" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ja"> <em class="ny">请查看我的演示网络应用</em> </strong></p><p id="b650" class="pw-post-body-paragraph kh ki iq kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><a class="ae lf" href="https://trending-shows.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://trending-shows.herokuapp.com/</a></p></div></div>    
</body>
</html>