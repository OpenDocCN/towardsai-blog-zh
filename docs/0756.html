<html>
<head>
<title>Image Classifier — Zalando Clothing Store using Monk Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像分类器— Zalando服装店使用Monk库</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/image-classifier-zalando-clothing-store-using-monk-library-18ce2d8a6418?source=collection_archive---------2-----------------------#2020-08-03">https://pub.towardsai.net/image-classifier-zalando-clothing-store-using-monk-library-18ce2d8a6418?source=collection_archive---------2-----------------------#2020-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="77b4" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><p id="45e9" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">本教程是关于使用Monk库对Zalando服装店数据集进行图像分类的。在这个数据集中，有服装和模特的高分辨率、彩色和多样的图像。</p><p id="aa2f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20Zalando%20Clothing%20Store.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja"> GitHub </strong> </a>上有教程。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/68eaad44d489c326e263f0e410e97f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*It5ANODAKzEfZEhjT0znlw.png"/></div></figure><h2 id="d712" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">关于蒙克</h2><ul class=""><li id="5ace" class="lv lw iq jy b jz lx kd ly kh lz kl ma kp mb kt mc md me mf bi translated">使用Monk，您可以编写更少的代码并创建端到端的应用程序。</li><li id="f7bc" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt mc md me mf bi translated">只学习一种语法，使用任何深度学习库——py torch、Mxnet、Keras、TensorFlow等，创建应用。</li><li id="3f68" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt mc md me mf bi translated">通过多个实验轻松管理您的整个项目。</li></ul><p id="351a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这是在Kaggle、Codalab、HackerEarth、AiCrowd等平台举行的比赛中使用的最佳工具。</p><h1 id="c0fe" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">目录</h1><ol class=""><li id="5921" class="lv lw iq jy b jz lx kd ly kh lz kl ma kp mb kt nc md me mf bi translated">安装Monk</li><li id="0212" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">Zalando服装店分类器演示</li><li id="03d9" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">下载数据集</li><li id="0bbe" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">背景工作</li><li id="f753" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">从零开始训练:vgg16</li><li id="2a0d" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">超参数调谐实验综述</li><li id="08de" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">专家模式</li><li id="cb9e" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">确认</li><li id="0ccf" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">推理</li><li id="5043" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">从头开始培训:mobilenet_v2</li><li id="0d94" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">比较vgg16和mobilenet_v2</li><li id="fab2" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt nc md me mf bi translated">结论</li></ol><h1 id="111c" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">安装Monk</h1><h2 id="0589" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">第一步:</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="ca46" class="ld le iq ne b gy ni nj l nk nl"><em class="nm"># Use this command if you're working on colab.</em><br/>!pip install -U monk-colab</span></pre><p id="56b4" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">其他安装方式，访问<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1" rel="noopener ugc nofollow" target="_blank">僧库</a>。</p><h2 id="8360" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">步骤2:添加到系统路径(每个终端或内核运行都需要)</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="158f" class="ld le iq ne b gy ni nj l nk nl"><strong class="ne ja">import</strong> <strong class="ne ja">sys</strong><br/>sys.path.append("monk_v1/")</span></pre><h1 id="b8b4" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">Zalando服装店分类器演示</h1><p id="0f25" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">本节将在深入讨论细节之前向您演示这个分类器。</p><p id="c4c7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">让我们先下载重量。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="b45e" class="ld le iq ne b gy ni nj l nk nl">! wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&amp;confirm=$(wget --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=1SO7GUcZlo8jRtLnGa6cBn2MGESyb1mUm' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/<strong class="ne ja">\1\n</strong>/p')&amp;id=1SO7GUcZlo8jRtLnGa6cBn2MGESyb1mUm" -O cls_zalando_trained.zip &amp;&amp; rm -rf /tmp/cookies.txt</span></pre><p id="46bc" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">解压文件夹。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="94c1" class="ld le iq ne b gy ni nj l nk nl">! unzip -qq cls_zalando_trained.zip<br/>ls workspace/</span></pre><p id="ef9f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:<code class="fe nq nr ns ne b">comparison/ Project-Zalando/ test/</code></p><p id="8e64" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">有三个文件夹供您探索:</p><ol class=""><li id="d552" class="lv lw iq jy b jz ka kd ke kh nt kl nu kp nv kt nc md me mf bi translated">比较-检查不同模型和超参数之间的所有比较。</li></ol><p id="a602" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">2.项目-Zalando-最终重量和日志。</p><p id="917f" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">3.测试—测试模型的图像。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="08f4" class="ld le iq ne b gy ni nj l nk nl">ls workspace/Project-Zalando/</span></pre><p id="323a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:<code class="fe nq nr ns ne b">expert_mode_vgg16/</code></p><p id="b4a1" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><code class="fe nq nr ns ne b">expert_mode_vgg16</code>是我们最后的模型。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="167e" class="ld le iq ne b gy ni nj l nk nl"><em class="nm">#Using keras backend </em><br/><strong class="ne ja">from</strong> <strong class="ne ja">monk.keras_prototype</strong> <strong class="ne ja">import</strong> prototype</span></pre><h2 id="89a0" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">暗示</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="fc98" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)<br/>ktf.Prototype("Project-Zalando", "expert_mode_vgg16", eval_infer=<strong class="ne ja">True</strong>)</span></pre><p id="54a7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">给出图像的位置。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="cfca" class="ld le iq ne b gy ni nj l nk nl">img_name = "/content/workspace/test/0DB22O007-A11@8.jpg"<br/>predictions = ktf.Infer(img_name=img_name)</span><span id="bd83" class="ld le iq ne b gy nw nj l nk nl"><em class="nm">#Display </em><br/><strong class="ne ja">from</strong> <strong class="ne ja">IPython.display</strong> <strong class="ne ja">import</strong> Image<br/>Image(filename=img_name)</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/2bd996e86aa5bd5500ef6072da80abd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*FMdHooNn5fSh8KpY_lHVOA.png"/></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="ae65" class="ld le iq ne b gy ni nj l nk nl">img_name = "/content/workspace/test/1FI21J00A-A11@10.jpg"<br/>predictions = ktf.Infer(img_name=img_name)</span><span id="a745" class="ld le iq ne b gy nw nj l nk nl"><em class="nm">#Display </em><br/><strong class="ne ja">from</strong> <strong class="ne ja">IPython.display</strong> <strong class="ne ja">import</strong> Image<br/>Image(filename=img_name)</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/6825f70d6b2f06f767fe344a13dfda32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*Y_e6nS7NuNmh-M1pVfOqaw.png"/></div></figure></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><h1 id="daf5" class="ml le iq bd lf mm og mo li mp oh mr ll ms oi mu lo mv oj mx lr my ok na lu nb bi translated">下载数据集</h1><p id="1c2b" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">让我们使用Kaggle的API命令安装一个数据集。在此之前，请遵循以下步骤:</p><p id="f359" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">转到您的Kaggle个人资料&gt;我的帐户&gt;向下滚动找到<em class="nm"> API </em>部分&gt;现在点击过期API令牌&gt;，点击<em class="nm">创建新的API令牌</em> &gt;在您的本地系统上保存<em class="nm"> kaggle.json </em>。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="0501" class="ld le iq ne b gy ni nj l nk nl">! pip install -q kaggle</span><span id="70a0" class="ld le iq ne b gy nw nj l nk nl"><strong class="ne ja">from</strong> <strong class="ne ja">google.colab</strong> <strong class="ne ja">import</strong> files</span><span id="3180" class="ld le iq ne b gy nw nj l nk nl"># Upload your <em class="nm">kaggle.json</em> file here.<br/>files.upload()</span><span id="8a51" class="ld le iq ne b gy nw nj l nk nl">! mkdir ~/.kaggle</span><span id="c9a2" class="ld le iq ne b gy nw nj l nk nl">! cp kaggle.json ~/.kaggle/</span><span id="e0e3" class="ld le iq ne b gy nw nj l nk nl">! chmod 600 ~/.kaggle/kaggle.json</span></pre><p id="49d4" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">该下载数据集了。在Kaggle上转到想要下载的数据集，复制Kaggle提供的API命令。应该如下图所示:</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="b586" class="ld le iq ne b gy ni nj l nk nl">! kaggle datasets download -d dqmonn/zalando-store-crawl</span><span id="4c09" class="ld le iq ne b gy nw nj l nk nl">! unzip -qq zalando-store-crawl.zip -d zalando</span></pre><p id="292b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">解压文件后，将您的数据集/文件存储在您自己的<em class="nm"> Google Drive </em>中，以备将来实验之用。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="7444" class="ld le iq ne b gy ni nj l nk nl">%cd /content/drive/My Drive/Data</span><span id="d39b" class="ld le iq ne b gy nw nj l nk nl">%cp -av /content/zalando/zalando zalando</span></pre><h1 id="5d04" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">背景工作</h1><p id="90cc" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated"><strong class="jy ja"> 1。问题</strong>:我应该选择哪个后端来训练我的分类器？</p><p id="f81b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">回答</strong>:跟随<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/1_getting_started_roadmap/2_elemental_features_of_monk/4)%20Feature%20-%20Compare%20experiments%20-%20compare%20experiments%20across%20backends.ipynb" rel="noopener ugc nofollow" target="_blank">本教程</a>跨后端对比实验。</p><p id="47f2" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja"> 2。问题</strong>:选择后端后，我应该选择哪个模型来训练我的分类器？</p><p id="ba36" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">回答</strong>:在当前的实验中，我选择了<strong class="jy ja"> Keras </strong> backend来训练我的分类器。因此，使用下面的代码列出Keras下所有可用的模型。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="2e09" class="ld le iq ne b gy ni nj l nk nl"># Using keras backend <br/>from keras_prototype import prototype<br/> <br/>ktf = prototype(verbose=1)<br/>ktf.List_Models()<br/> <br/>Models List: <br/>    1. mobilenet<br/>    2. densenet121<br/>    3. densenet169<br/>    4. densenet201<br/>    5. inception_v3<br/>    6. inception_resnet_v3<br/>    7. mobilenet_v2<br/>    8. nasnet_mobile<br/>    9. nasnet_large<br/>    10. resnet50<br/>    11. resnet101<br/>    12. resnet152<br/>    13. resnet50_v2<br/>    14. resnet101_v2<br/>    15. resnet152_v2<br/>    16. vgg16<br/>    17. vgg19<br/>    18. xception</span></pre><p id="7581" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在，你可以选择任何3-5个模型开始做你的实验。按照本教程<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/1_getting_started_roadmap/2_elemental_features_of_monk/3)%20Feature%20-%20Compare%20experiments%20-%20compare%20experiments%20within%20same%20backend.ipynb" rel="noopener ugc nofollow" target="_blank">来比较相同后端的实验。</a></p><h1 id="dfdf" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">进口和尚</h1><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="be65" class="ld le iq ne b gy ni nj l nk nl">#Using keras backend</span><span id="7a7e" class="ld le iq ne b gy nw nj l nk nl">from monk.keras_prototype import prototype</span></pre><p id="144e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">您可以在一个项目下创建多个实验。这里，我的项目命名为<strong class="jy ja"> Project-Zalando，</strong>，我的第一个实验命名为<strong class="jy ja"> vgg16_exp1 </strong>。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="a3a8" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)</span><span id="03b5" class="ld le iq ne b gy nw nj l nk nl">ktf.Prototype("Project-Zalando", "vgg16_exp1")</span></pre><p id="3a4c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="6e2d" class="ld le iq ne b gy ni nj l nk nl">Keras Version: 2.3.1 Tensorflow Version: 2.2.0  <br/>Experiment Details     <br/>Project: Project-Zalando     <br/>Experiment: vgg16_exp1     <br/>Dir: /content/drive/My Drive/Monk_v1/workspace/Project-Zalando/vgg16_exp1/</span></pre><p id="efad" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">您可以使用下面的代码用默认参数来训练您的模型。然而，我们的目标是提高准确性。因此，我们将跳到<em class="nm">调整我们的超参数</em>。使用<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/tree/master/study_roadmaps/1_getting_started_roadmap/6_hyperparameter_tuning" rel="noopener ugc nofollow" target="_blank">这个链接</a>来学习如何为你的分类器做<strong class="jy ja">超参数调整</strong>。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="67c4" class="ld le iq ne b gy ni nj l nk nl">ktf.Default(dataset_path="/content/drive/My Drive/Data/zalando", model_name="vgg16", freeze_base_network=False, num_epochs=5)</span><span id="cc23" class="ld le iq ne b gy nw nj l nk nl">#Read the summary generated once you run this cell.</span></pre><p id="da23" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi ol"><img src="../Images/38243f5c7fb21ce9285fc6b57d458b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jpcoaNkrya91wZJQyD7Cg.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi oq"><img src="../Images/67d775e0793c22d7525fd4bfac693c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDh9RmaqiM2stn2A6Tstag.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi or"><img src="../Images/42103f47bee8f8c3fe133ddc47c40090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vOVyzV6DFvfdlKI8DIKh5w.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="2108" class="ld le iq ne b gy ni nj l nk nl">ktf.Train()</span></pre><h2 id="6bd4" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">a.分析学习率</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="9255" class="ld le iq ne b gy ni nj l nk nl"># Analysis Project Name<br/>analysis_name = "analyse_learning_rates_vgg16"</span><span id="5d82" class="ld le iq ne b gy nw nj l nk nl"># Learning rates to explore<br/>lrs = [0.1, 0.05, 0.01, 0.005, 0.0001]</span><span id="f527" class="ld le iq ne b gy nw nj l nk nl"># Number of epochs for each sub-experiment to run<br/>epochs=5</span><span id="a9b0" class="ld le iq ne b gy nw nj l nk nl"># Percentage of original dataset to take in for experimentation<br/># We're taking 5% of our original dataset.<br/>percent_data=5</span><span id="875f" class="ld le iq ne b gy nw nj l nk nl"># I made sure that all the GPU processors are running<br/>ktf.update_num_processors(2)</span><span id="78c7" class="ld le iq ne b gy nw nj l nk nl"># Very important to reload post updating<br/>ktf.Reload()</span></pre><p id="4ccc" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi os"><img src="../Images/1002d3b585cc130961f361ee0101376f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-h4Au1mEC-o-k-iUNsPUw.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="cdbb" class="ld le iq ne b gy ni nj l nk nl"># "keep_all" - Keep all the sub experiments created<br/># "keep_none" - Delete all sub experiments created</span><span id="474f" class="ld le iq ne b gy nw nj l nk nl">analysis = ktf.Analyse_Learning_Rates(analysis_name, lrs, percent_data, num_epochs=epochs, state="keep_none")</span></pre><p id="0d6a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi ot"><img src="../Images/2f742507e39ea6a14a4cbd97a486f0f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UjcKf9Troc5vP5-Sa7X3Q.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi ou"><img src="../Images/ef14bab69eed8502b5bec9275cf7ee9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1B5XWH0AJI6nxtXrEaN_-w.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi ov"><img src="../Images/593fe32008f27494be8181f304406da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LuweuzXQ4oxwDWgJqWeC6Q.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi ow"><img src="../Images/8ed8d06903924742c76f2c505cb9bafb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v3ivaTENGIi3CHnTe_VjSw.png"/></div></div></figure><h2 id="0efe" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">结果</h2><p id="74eb" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">从上表可以明显看出<code class="fe nq nr ns ne b">Learning_Rate_0.0001</code>的<strong class="jy ja">验证损失最小</strong>。我们将用这个来更新我们的学习率。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="97a0" class="ld le iq ne b gy ni nj l nk nl">ktf.update_learning_rate(0.0001)<br/><em class="nm"># Very important to reload post updates</em> ktf.Reload()</span></pre><h2 id="ba42" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">b.分析批量大小</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="b06b" class="ld le iq ne b gy ni nj l nk nl"># Analysis Project Name<br/>analysis_name = "analyse_batch_sizes_vgg16"</span><span id="bb1a" class="ld le iq ne b gy nw nj l nk nl"># Batch sizes to explore<br/>batch_sizes = [2, 4, 8, 12]</span><span id="048a" class="ld le iq ne b gy nw nj l nk nl"># <strong class="ne ja">Note:</strong> We're using the same <!-- -->percent_data<!-- --> and <!-- -->num_epochs<!-- -->.<br/># "keep_all" - Keep all the sub experiments created<br/># "keep_none" - Delete all sub experiments created</span><span id="3976" class="ld le iq ne b gy nw nj l nk nl">analysis_batches = ktf.Analyse_Batch_Sizes(analysis_name, batch_sizes, percent_data, num_epochs=epochs, state="keep_none")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi ox"><img src="../Images/4c934854f572d1b21c8efcf0a865718f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0M3j6aQ3PFKwjzFQaIn3eg.png"/></div></div></figure><h2 id="9055" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">结果</h2><p id="05fd" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">从上表可以明显看出<code class="fe nq nr ns ne b">Batch_Size_12</code>的<strong class="jy ja">验证损失最小</strong>。我们将用它来更新模型。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="792b" class="ld le iq ne b gy ni nj l nk nl">ktf.update_batch_size(12)</span><span id="c98b" class="ld le iq ne b gy nw nj l nk nl"># Very important to reload post updates<br/>ktf.Reload()</span></pre><h2 id="1835" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">c.分析优化器</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="9aa2" class="ld le iq ne b gy ni nj l nk nl"># Analysis Project Name<br/>analysis_name = "analyse_optimizers_vgg16"</span><span id="ad46" class="ld le iq ne b gy nw nj l nk nl"># Optimizers to explore<br/>optimizers = ["sgd", "adam", "adagrad"]</span><span id="def3" class="ld le iq ne b gy nw nj l nk nl"># "keep_all" - Keep all the sub experiments created<br/># "keep_non" - Delete all sub experiments created</span><span id="05f5" class="ld le iq ne b gy nw nj l nk nl">analysis_optimizers = ktf.Analyse_Optimizers(analysis_name, optimizers, percent_data, num_epochs=epochs, state="keep_none")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi oy"><img src="../Images/e27b0edd09bf69622824f95c1c20c795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gfAUm-mTgR-Xzt6CZzL_A.png"/></div></div></figure><h2 id="31af" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">结果</h2><p id="d184" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">从上表可以清楚地看出，我们应该选择<code class="fe nq nr ns ne b">Optimizer_adagrad</code>，因为它的验证损失最小。</p><h2 id="991d" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">超参数调谐实验综述</h2><p id="12f9" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">我们的实验到此结束，现在是时候打开<strong class="jy ja">专家模式</strong>，使用上述<strong class="jy ja">超参数</strong>训练我们的分类器。</p><p id="801d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">总结:</p><ul class=""><li id="5c07" class="lv lw iq jy b jz ka kd ke kh nt kl nu kp nv kt mc md me mf bi translated">学习率— 0.0001</li><li id="dd67" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt mc md me mf bi translated">批量大小— 12</li><li id="5e30" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt mc md me mf bi translated">优化器— adagrad</li></ul><h1 id="d975" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">1.从零开始训练:vgg16</h1><h2 id="3bb6" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">专家模式</h2><p id="000f" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">让我们创建另一个名为<strong class="jy ja"> expert_mode_vgg16 </strong>的<em class="nm">实验</em>，从头开始训练我们的分类器。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="8db4" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)</span><span id="6e35" class="ld le iq ne b gy nw nj l nk nl">ktf.Prototype("Project-Zalando", "expert_mode_vgg16")</span><span id="4771" class="ld le iq ne b gy nw nj l nk nl">ktf.Dataset_Params(dataset_path="/content/drive/My Drive/Data/zalando", split=0.8, input_size=224, batch_size=12, shuffle_data=True, num_processors=2)</span><span id="e23f" class="ld le iq ne b gy nw nj l nk nl"># Load the dataset<br/>ktf.Dataset()</span><span id="bf29" class="ld le iq ne b gy nw nj l nk nl">ktf.Model_Params(model_name="vgg16", freeze_base_network=True, use_gpu=True, use_pretrained=True)</span><span id="f4e8" class="ld le iq ne b gy nw nj l nk nl">ktf.Model()</span><span id="c635" class="ld le iq ne b gy nw nj l nk nl">ktf.Training_Params(num_epochs=5, display_progress=True, display_progress_realtime=True, save_intermediate_models=True, intermediate_model_prefix="intermediate_model_", save_training_logs=True)</span><span id="6d84" class="ld le iq ne b gy nw nj l nk nl"># Update optimizer and learning rate<br/>ktf.optimizer_adagrad(0.0001)</span><span id="1896" class="ld le iq ne b gy nw nj l nk nl">ktf.loss_crossentropy()</span><span id="5828" class="ld le iq ne b gy nw nj l nk nl"># Training<br/>ktf.Train()</span></pre><p id="4d40" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">输出:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi oz"><img src="../Images/7a015a15ab9c8e4792a02643851d9ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1QJHJwYHztqJRPvCUFXuSA.png"/></div></div></figure><h2 id="8a8d" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">确认</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="3803" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1);</span><span id="f8f8" class="ld le iq ne b gy nw nj l nk nl">ktf.Prototype("Project-Zalando", "expert_mode_vgg16", eval_infer=True)</span><span id="820f" class="ld le iq ne b gy nw nj l nk nl"># Just for example purposes, validating on the training set itself<br/>ktf.Dataset_Params(dataset_path="/content/drive/My Drive/Data/zalando")</span><span id="5098" class="ld le iq ne b gy nw nj l nk nl">ktf.Dataset()</span><span id="9631" class="ld le iq ne b gy nw nj l nk nl">accuracy, class_based_accuracy = ktf.Evaluate()</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/6e269bfdbf76e27f0ed7660eecf6bd62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*ZsErUBr_xjSOT9CZl4WXbg.png"/></div></figure><h2 id="83fd" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">推理</h2><p id="962b" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">让我们看看样本图像上的预测。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="0597" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)</span><span id="fb9e" class="ld le iq ne b gy nw nj l nk nl">ktf.Prototype("Project-Zalando", "expert_mode_vgg16", eval_infer=True)</span></pre><p id="2c94" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">模型现在已加载。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="ca13" class="ld le iq ne b gy ni nj l nk nl">img_name = "/content/1FI21J00A-A11@10.jpg"<br/>predictions = ktf.Infer(img_name=img_name)</span><span id="0ad4" class="ld le iq ne b gy nw nj l nk nl"><em class="nm">#Display </em><br/><strong class="ne ja">from</strong> <strong class="ne ja">IPython.display</strong> <strong class="ne ja">import</strong> Image<br/>Image(filename=img_name)</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pb"><img src="../Images/83b496ce42938b5f461ec2170bf12008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cGSb5ZND9kM_N9V3rA7fmQ.png"/></div></div></figure><p id="ba9d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">我们已经成功完成了分类器的训练。查看本实验下<em class="nm">日志</em>、<em class="nm">模型</em>文件夹，查看模型权重等洞见。</p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><h1 id="73bc" class="ml le iq bd lf mm og mo li mp oh mr ll ms oi mu lo mv oj mx lr my ok na lu nb bi translated">2.从头开始培训:mobilenet_v2</h1><p id="2ad3" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">我以同样的方式从头开始训练<code class="fe nq nr ns ne b">mobilenet_v2</code>来比较<code class="fe nq nr ns ne b">vgg16</code>和<code class="fe nq nr ns ne b">mobilenet_v2</code>。</p><p id="d6fb" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">实验结束后<code class="fe nq nr ns ne b">mobilenet_v2</code>的最佳超参数为:</p><ul class=""><li id="aa61" class="lv lw iq jy b jz ka kd ke kh nt kl nu kp nv kt mc md me mf bi translated">学习率-0.0001</li><li id="9a64" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt mc md me mf bi translated">批量-8</li><li id="4505" class="lv lw iq jy b jz mg kd mh kh mi kl mj kp mk kt mc md me mf bi translated">优化程序adam</li></ul><h2 id="0249" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">专家模式</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="0482" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)<br/>ktf.Prototype("Project-Zalando", "expert_mode_mobilenet_v2")</span><span id="e987" class="ld le iq ne b gy nw nj l nk nl">ktf.Dataset_Params(dataset_path="/content/drive/My Drive/Data/zalando", split=0.8, input_size=224, batch_size=8, shuffle_data=True, num_processors=2)</span><span id="b680" class="ld le iq ne b gy nw nj l nk nl">ktf.Dataset()</span><span id="668c" class="ld le iq ne b gy nw nj l nk nl">ktf.Model_Params(model_name="mobilenet_v2", freeze_base_network=True, use_gpu=True, use_pretrained=True)</span><span id="5741" class="ld le iq ne b gy nw nj l nk nl">ktf.Model()</span><span id="3f8b" class="ld le iq ne b gy nw nj l nk nl">ktf.Training_Params(num_epochs=5, display_progress=True, display_progress_realtime=True, save_intermediate_models=True, intermediate_model_prefix="intermediate_model_", save_training_logs=True)</span><span id="9858" class="ld le iq ne b gy nw nj l nk nl">ktf.optimizer_adam(0.0001)</span><span id="9bee" class="ld le iq ne b gy nw nj l nk nl">ktf.loss_crossentropy()</span><span id="c946" class="ld le iq ne b gy nw nj l nk nl">ktf.Train()</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pc"><img src="../Images/936c63ada8a4c0a8f839f84dfaf65589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2IsjvIkpcnL30OGzmjuKvA.png"/></div></div></figure><h2 id="e5d1" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">确认</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="8541" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)<br/>ktf.Prototype("Project-Zalando", "expert_mode_mobilenet_v2", eval_infer=True)</span><span id="bc68" class="ld le iq ne b gy nw nj l nk nl"># Just for example purposes, validating on the training set itself<br/>ktf.Dataset_Params(dataset_path="/content/drive/My Drive/Data/zalando")</span><span id="d342" class="ld le iq ne b gy nw nj l nk nl">ktf.Dataset()</span><span id="5a56" class="ld le iq ne b gy nw nj l nk nl">accuracy, class_based_accuracy = ktf.Evaluate()</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/a3334b329ea2e9a90544579751c1b85b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*oteCVrNMXYj6nOUMHUvWMg.png"/></div></figure><h2 id="dffb" class="ld le iq bd lf lg lh dn li lj lk dp ll kh lm ln lo kl lp lq lr kp ls lt lu iw bi translated">推理</h2><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="e10e" class="ld le iq ne b gy ni nj l nk nl">ktf = prototype(verbose=1)</span><span id="03b8" class="ld le iq ne b gy nw nj l nk nl">ktf.Prototype("Project-Zalando", "expert_mode_mobilenet_v2", eval_infer=True)</span></pre><p id="45d3" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">模型现在已加载。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="96d1" class="ld le iq ne b gy ni nj l nk nl">img_name = "/content/0DB22O007-A11@8.jpg"<br/>predictions = ktf.Infer(img_name=img_name)</span><span id="0ec9" class="ld le iq ne b gy nw nj l nk nl">#Display<br/>from IPython.display import Image<br/>Image(filename=img_name)</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pe"><img src="../Images/c377e17fff36a12d90d4e7ba03e83cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9NSFUg9wx-bJoHZloW4zg.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="c76f" class="ld le iq ne b gy ni nj l nk nl">img_name = "/content/TOB22O01W-A11@8.jpg"<br/>predictions = ktf.Infer(img_name=img_name)</span><span id="3cc7" class="ld le iq ne b gy nw nj l nk nl">#Display<br/>from IPython.display import Image<br/>Image(filename=img_name)</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pf"><img src="../Images/e91c3739f7dad4d05791688f50b3df9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TrF6DysuDUx6agGlvSHlJg.png"/></div></div></figure><h1 id="a46d" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">比较vgg16和mobilenet_v2</h1><p id="b854" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">我用了前面提到的同样的教程<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/1_getting_started_roadmap/2_elemental_features_of_monk/4)%20Feature%20-%20Compare%20experiments%20-%20compare%20experiments%20across%20backends.ipynb" rel="noopener ugc nofollow" target="_blank"/>来比较这两个实验。</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="364f" class="ld le iq ne b gy ni nj l nk nl"># Invoke the comparison class<br/># import monk_v1<br/>from compare_prototype import compare</span><span id="ddbc" class="ld le iq ne b gy nw nj l nk nl"># Create a project<br/>ctf = compare(verbose=1)<br/>ctf.Comparison("vgg-mobilenet-Comparison")</span><span id="99f1" class="ld le iq ne b gy nw nj l nk nl">ctf.Add_Experiment("Project-Zalando", "expert_mode_vgg16")<br/>ctf.Add_Experiment("Project-Zalando", "expert_mode_mobilenet_v2")</span><span id="2f8f" class="ld le iq ne b gy nw nj l nk nl">ctf.Generate_Statistics()</span></pre><p id="3923" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">生成统计数据后，</p><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="8e9a" class="ld le iq ne b gy ni nj l nk nl">from IPython.display import Image</span><span id="b326" class="ld le iq ne b gy nw nj l nk nl">Image(filename="/content/drive/My Drive/Monk_v1/workspace/comparison/vgg-mobilenet-Comparison/train_accuracy.png")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pg"><img src="../Images/e8839e19df02e4005211efc28743263e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I2unBWJJ4jtWaNVWf3XLuQ.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="cdcf" class="ld le iq ne b gy ni nj l nk nl">from IPython.display import Image</span><span id="3001" class="ld le iq ne b gy nw nj l nk nl">Image(filename="/content/drive/My Drive/Monk_v1/workspace/comparison/vgg-mobilenet-Comparison/train_loss.png")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pg"><img src="../Images/500402011a08ddf47797cd2c9163c999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ogvs_I4y1T-jIQPEAfgMSA.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="c8b0" class="ld le iq ne b gy ni nj l nk nl">from IPython.display import Image</span><span id="b201" class="ld le iq ne b gy nw nj l nk nl">Image(filename="/content/drive/My Drive/Monk_v1/workspace/comparison/vgg-mobilenet-Comparison/val_accuracy.png")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pg"><img src="../Images/c1acbac380b777eba9afe45d53f868bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4c7Rhl43yetN0cwoELHQw.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="eb9b" class="ld le iq ne b gy ni nj l nk nl">from IPython.display import Image</span><span id="05b7" class="ld le iq ne b gy nw nj l nk nl">Image(filename="/content/drive/My Drive/Monk_v1/workspace/comparison/vgg-mobilenet-Comparison/val_loss.png")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pg"><img src="../Images/1b8bf74b41a70905c71dafa51ad5e5bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vA6S-KXTtS7v6wrRYLsPQ.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="8777" class="ld le iq ne b gy ni nj l nk nl">from IPython.display import Image</span><span id="26f4" class="ld le iq ne b gy nw nj l nk nl">Image(filename="/content/drive/My Drive/Monk_v1/workspace/comparison/vgg-mobilenet-Comparison/stats_training_time.png")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pg"><img src="../Images/160e765f2e0286c4d02e7886ae29242e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2pYmfOTq4XHsKsPkgAvRg.png"/></div></div></figure><pre class="kw kx ky kz gt nd ne nf ng aw nh bi"><span id="0236" class="ld le iq ne b gy ni nj l nk nl">from IPython.display import Image</span><span id="4bb2" class="ld le iq ne b gy nw nj l nk nl">Image(filename="/content/drive/My Drive/Monk_v1/workspace/comparison/vgg-mobilenet-Comparison/stats_best_val_acc.png")</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="om on di oo bf op"><div class="gh gi pg"><img src="../Images/14502b29a58ef343cf5b4d3e5825bc1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mvjI0Yz_MjZjHbcXukNc_A.png"/></div></div></figure><h1 id="d084" class="ml le iq bd lf mm mn mo li mp mq mr ll ms mt mu lo mv mw mx lr my mz na lu nb bi translated">结论</h1><p id="9991" class="pw-post-body-paragraph jw jx iq jy b jz lx kb kc kd ly kf kg kh nn kj kk kl no kn ko kp np kr ks kt ij bi translated">从以上的比较中，可以明显看出<code class="fe nq nr ns ne b">vgg16</code>模型在各个方面都表现得更好。</p><p id="97a8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">通过进一步调整超参数，提高模型精度的空间很大。更多教程请参见<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/tree/master/study_roadmaps/4_image_classification_zoo" rel="noopener ugc nofollow" target="_blank">图像分类动物园</a>。</p><p id="af2b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">教程可在<a class="ae ku" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20Zalando%20Clothing%20Store.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。如果这篇文章对你有帮助，请鼓掌或分享！</p></div></div>    
</body>
</html>