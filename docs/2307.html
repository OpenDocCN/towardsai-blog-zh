<html>
<head>
<title>Neural Style Transfer using a simple python library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用简单的python库进行神经风格转换</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/neural-style-transfer-using-a-python-library-112c08ee93c6?source=collection_archive---------5-----------------------#2021-11-07">https://pub.towardsai.net/neural-style-transfer-using-a-python-library-112c08ee93c6?source=collection_archive---------5-----------------------#2021-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3762" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><p id="f4b8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">使用惊人的<strong class="jy ja">神经样式转移</strong> python库和几行代码的神经样式转移指南。</p><p id="2155" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在这个<a class="ae ku" href="https://colab.research.google.com/drive/1ZMX9POGds87CZyIgagLbnAN-eEa8fr2L?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <em class="kv">教程</em> </a>中，我们将学习如何使用<a class="ae ku" href="https://pypi.org/project/neural-style-transfer/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja">神经样式转移</strong> </a> <strong class="jy ja"> </strong>库，使用几行代码就可以将图像合成为其他图像的样式。</p><p id="c81b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">神经样式转移基本上是一种优化技术，它将两张图片作为输入，一张图片<strong class="jy ja">参考样式图片</strong>，另一张图片是<strong class="jy ja">输入</strong>您想要样式化的图片——模型将这两张图片混合在一起，并生成一张看起来像给定输入(<strong class="jy ja">内容</strong>)但在给定参考样式图片中绘制的转换后的图片。</p><p id="945d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">看起来很有趣，对吧..但是它需要很多东西，包括图像预处理代码、模型训练代码、优化函数和许多其他小函数，但是为了摆脱所有这些东西，我们有一个惊人的库，叫做<a class="ae ku" href="https://pypi.org/project/neural-style-transfer/" rel="noopener ugc nofollow" target="_blank"> <strong class="jy ja">神经类型转移</strong> </a> <strong class="jy ja"> </strong>，它只用几行代码就为我们做了所有这些事情，所以在这个博客中，我们将向你展示如何使用这个漂亮的库。</p><p id="6e6e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">首先，安装库</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="53f5" class="lf lg iq lb b gy lh li l lj lk">pip install neural-style-transfer</span></pre><p id="0a27" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">导入库并创建一个类对象</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="d9fe" class="lf lg iq lb b gy lh li l lj lk">from neuralstyletransfer.style_transfer import NeuralStyleTransfer</span><span id="e491" class="lf lg iq lb b gy ll li l lj lk">nst = NeuralStyleTransfer()</span></pre><p id="0de9" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">现在我们需要使用给定的命令加载内容和引用样式图像。</p><p id="a01e" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这里我使用了一个来自外部URL的图像，你也可以通过提供一个绝对路径和pathType='local '直接从本地机器加载图像。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="6aba" class="lf lg iq lb b gy lh li l lj lk">content_url = 'https://i.ibb.co/6mVpxGW/content.png'<br/>style_url = 'https://i.ibb.co/30nz9Lc/style.jpg'</span><span id="9380" class="lf lg iq lb b gy ll li l lj lk">nst.LoadContentImage(content_url, pathType='url')<br/>nst.LoadStyleImage(style_url, pathType='url')</span></pre><p id="2254" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">内容图片</strong></p><figure class="kw kx ky kz gt ln gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/5f8f2429ef7a36dccdc1eb2c4364f66a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*0mGgc4BDHyck6Z4W"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">内容图像</figcaption></figure><p id="3fcc" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">风格图像</strong></p><figure class="kw kx ky kz gt ln gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/0ffa2d150b023cdad8e1ac66cf183bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*zKVK5XRLn3WQGoiQ"/></div></figure><p id="d117" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">太好了！现在我们都准备好开始模特训练了..</p><p id="3dd8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">不需要写任何长代码，你只需要调用应用函数和模型开始优化，并给出最终结果作为输出。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="a82a" class="lf lg iq lb b gy lh li l lj lk">output = nst.apply(contentWeight=1000, styleWeight=0.01, epochs=600)</span></pre><p id="34f8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">输出</strong>变量包含最终转换的图像，您可以使用枕头库保存输出。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="b666" class="lf lg iq lb b gy lh li l lj lk">from PIL import Image<br/>output.save('output.jpg')</span></pre><p id="daa6" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">这个过程需要一些时间，基于你机器的硬件，我建议使用一个<strong class="jy ja"> GPU </strong>机器来使这个过程快得多。</p><p id="04e8" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在应用功能中，您可以根据自己的需求提供不同的超参数。</p><ul class=""><li id="53a7" class="lu lv iq jy b jz ka kd ke kh lw kl lx kp ly kt lz ma mb mc bi translated"><strong class="jy ja">内容权重</strong>→使用此参数，我们可以指定内容图像的权重，如果该值设置得比转换后的(结果)图像低，则图像看起来不清晰。要使内容图像更清晰，您可以增加内容权重的值。</li><li id="afcb" class="lu lv iq jy b jz md kd me kh mf kl mg kp mh kt lz ma mb mc bi translated"><strong class="jy ja">样式重量</strong>→使用这个参数我们可以指定样式图像的重量，通常它被设置为0.01，但是如果你想使它变轻，你可以根据你的要求降低这个值。</li><li id="a179" class="lu lv iq jy b jz md kd me kh mf kl mg kp mh kt lz ma mb mc bi translated"><strong class="jy ja">纪元</strong>→使用此参数，您可以设置模型训练的纪元数量，因为这是一个优化问题，您可以将其设置为更高的值，如500或600，甚至更高。如果您希望您的图像更清晰，基本上纪元图像的数量越高越优化，在训练期间，它会打印内容和样式图像的损失，因此基于此，您可以决定您的纪元以获得最佳结果。</li></ul><p id="1ab5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">转换后的图像(输出)</strong></p><figure class="kw kx ky kz gt ln gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/6b6f65058dceb37003e7bdaeb7511cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*2BGp6BVmvJVfvlkd"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">输出图像</figcaption></figure><p id="57dd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">哇..上面我们做的就是我们改造后的形象的样子</p><p id="f565" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">检验这款用于演示的笔记本电脑。</p></div></div>    
</body>
</html>