<html>
<head>
<title>Using Gridsearchcv To Build SVM Model for Breast Cancer Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Gridsearchcv建立乳腺癌数据集的SVM模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/using-gridsearchcv-to-build-svm-model-for-breast-cancer-dataset-7ca8e5cd6273?source=collection_archive---------2-----------------------#2021-03-30">https://pub.towardsai.net/using-gridsearchcv-to-build-svm-model-for-breast-cancer-dataset-7ca8e5cd6273?source=collection_archive---------2-----------------------#2021-03-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="63d9" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><div class=""><h2 id="2028" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">Python中理解和实现支持向量机的指南。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c14ae60fe058bae0010cd6d599756bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j3LLxvC7qFyNJFMa"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@nci?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">国立癌症研究所</a>在<a class="ae le" href="https://unsplash.com/s/photos/cancer-cells?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="8d5e" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">什么是支持向量机？</h1><p id="304e" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">支持向量机缩写为SVMs，是一种用于分类任务和回归分析的监督学习算法。它分析数据并识别模式。在这篇文章中，SVM将演示一个分类问题。</p><h1 id="0d40" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">为什么SVM是非概率二元线性分类器？</h1><p id="87e7" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">对于具有两个类别标签的一组数据点，SVM算法建立一个模型，将任何新的数据点分配给其中一个类别，从而使其成为非概率二元线性分类器。</p><h1 id="b355" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">SVM是如何工作的？</h1><p id="c6d2" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">SVM以这样一种方式表示空间中的所有数据点，在单独类的例子之间有一个明显的宽间隙。然后，每个新的数据点被映射到这个空间中，并放置在间隙的任一侧。</p><h1 id="3da9" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">如何用Python实现？</h1><p id="0ebf" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">使用的数据集将是来自sklearn“乳腺癌”的内置数据集。目标是将肿瘤分类为恶性或良性。</p><p id="d45f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →导入库</strong></p><p id="c55e" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">导入Pandas和numpy来处理数据，并使用matplotlib和seaborn来实现数据可视化。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="ecb4" class="nd lg iq mz b gy ne nf l ng nh"><strong class="mz ja">&gt;&gt;&gt; import</strong> pandas <strong class="mz ja">as</strong> pd<br/><strong class="mz ja">&gt;&gt;&gt; import</strong> numpy <strong class="mz ja">as</strong> np<br/><strong class="mz ja">&gt;&gt;&gt; import</strong> matplotlib.pyplot <strong class="mz ja">as</strong> plt<br/><strong class="mz ja">&gt;&gt;&gt; import</strong> seaborn <strong class="mz ja">as</strong> sns<br/><strong class="mz ja">&gt;&gt;&gt; %</strong>matplotlib inline</span></pre><p id="4a32" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →读取数据</strong></p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="91c3" class="nd lg iq mz b gy ne nf l ng nh"><strong class="mz ja">&gt;&gt;&gt; from</strong> sklearn.datasets <strong class="mz ja">import</strong> load_breast_cancer<br/>&gt;&gt;&gt; data <strong class="mz ja">=</strong> load_breast_cancer()</span></pre><p id="3200" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">数据以字典的形式呈现。使用关键字和其中的信息创建数据帧。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="411c" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; data.keys()<br/>dict_keys(['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename'])</span></pre><p id="6252" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">提取数据和要素名称以形成数据集。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="9453" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; df <strong class="mz ja">=</strong> pd.DataFrame(data['data'],columns<strong class="mz ja">=</strong>data['feature_names'])<br/>&gt;&gt;&gt; df.head()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ni"><img src="../Images/f626160868ba109a718f02562c3e404c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHAWfSrY61B2u9iEkSkBUw.png"/></div></div></figure><p id="4b81" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →将数据分成训练和测试集</strong></p><p id="bc71" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">列车测试拆分功能是从sklearn导入的。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="5103" class="nd lg iq mz b gy ne nf l ng nh"><strong class="mz ja">&gt;&gt;&gt; from</strong> sklearn.model_selection <strong class="mz ja">import</strong> train_test_split</span><span id="b3b7" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; X <strong class="mz ja">=</strong> df<br/>&gt;&gt;&gt; y <strong class="mz ja">=</strong> data['target']</span><span id="7b95" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; X_train, X_test, y_train, y_test <strong class="mz ja">=</strong> train_test_split(X, y, test_size<strong class="mz ja">=</strong>0.30)</span></pre><p id="d203" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →建立模型</strong></p><p id="8b15" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">SVC包是从sklearn导入的，它的对象是在对训练数据集拟合模型之后创建的。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="e965" class="nd lg iq mz b gy ne nf l ng nh"><strong class="mz ja">&gt;&gt;&gt; from</strong> sklearn.svm <strong class="mz ja">import</strong> SVC</span><span id="d406" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; model <strong class="mz ja">=</strong> SVC()<br/>&gt;&gt;&gt; model.fit(X_train,y_train)<br/>SVC()</span></pre><p id="6cb8" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →预测</strong></p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="0a76" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; pred <strong class="mz ja">=</strong> model.predict(X_test)</span></pre><p id="2edd" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →评估指标</strong></p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="f1f2" class="nd lg iq mz b gy ne nf l ng nh"><strong class="mz ja">&gt;&gt;&gt; from</strong> sklearn.metrics <strong class="mz ja">import</strong> classification_report,confusion_matrix</span><span id="c002" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; confusion_matrix(y_test,pred)<br/>array([[ 53,  13],<br/>       [  2, 103]], dtype=int64)</span><span id="8c13" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; print(classification_report(y_test,pred))<br/>precision    recall  f1-score   support</span><span id="4523" class="nd lg iq mz b gy nj nf l ng nh">           0       0.96      0.80      0.88        66<br/>           1       0.89      0.98      0.93       105</span><span id="5717" class="nd lg iq mz b gy nj nf l ng nh">    accuracy                           0.91       171<br/>   macro avg       0.93      0.89      0.90       171<br/>weighted avg       0.92      0.91      0.91       171</span></pre><p id="25a5" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> →改进模型</strong></p><p id="7858" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">通过选择合适的参数，该模型可以进一步改进。使用sklearn的GridSearchCV功能可以有效地做到这一点。创建参数“网格”并尝试所有可能的组合被称为网格搜索。</p><p id="a95c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">GridSearchCV将一个字典作为输入，该字典包含应该尝试的参数和要训练的模型。参数网格被定义为一个字典，其中键是参数，值是要测试的设置。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="6d39" class="nd lg iq mz b gy ne nf l ng nh"><strong class="mz ja">&gt;&gt;&gt; from</strong> sklearn.model_selection <strong class="mz ja">import</strong> GridSearchCV</span></pre><p id="ebef" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">参数“C”控制错误分类的成本。如果“C”值较大，则偏差较低，方差较大。如果“C”值较低，则偏差较大，方差较小。“γ”是径向基函数(RBF)的一个参数。如果“gamma”很小，则会导致高偏差和低方差，反之亦然。</p><p id="9ded" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">因此,“C”和“gamma”的值的范围将通过在网格参数字典中定义它来测试。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="fd65" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; grid_param <strong class="mz ja">=</strong> {'C': [0.1,1, 10, 100, 1000],'gamma':[1,0.1,0.01,0.001,0.0001],'kernel': ['rbf']}</span></pre><p id="dcd3" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">模型中的“GridSearchCV”估计值以及网格参数。然后选择详细。数字越大，越详细。verbose是描述流程的文本输出。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="1b18" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; grid <strong class="mz ja">=</strong> GridSearchCV(SVC(),grid_param,verbose<strong class="mz ja">=</strong>3)</span></pre><p id="9860" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">接下来，这个网格适合训练数据。首先，它通过交叉验证运行相同的循环来找到最佳的参数组合。在获得最佳组合后，它对传递到fit的所有数据再次运行fit，而不进行交叉验证，以使用最佳参数设置构建单个新模型。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="c1fc" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; grid.fit(X_train,y_train)<br/>Fitting 5 folds for each of 25 candidates, totalling 125 fits<br/>[CV] C=0.1, gamma=1, kernel=rbf ......................................<br/>[CV] .......... C=0.1, gamma=1, kernel=rbf, score=0.637, total=   0.0s<br/>[CV] ........ C=0.1, gamma=0.1, kernel=rbf, score=0.637, total=   0.0s<br/>.<br/>.<br/>.<br/>.<br/>.<br/>[CV] C=1000, gamma=0.0001, kernel=rbf ................................<br/>[CV] .... C=1000, gamma=0.0001, kernel=rbf, score=0.924, total=   0.0s<br/>[Parallel(n_jobs=1)]: Done 125 out of 125 | elapsed:    4.3s finished</span><span id="d622" class="nd lg iq mz b gy nj nf l ng nh">GridSearchCV(estimator=SVC(),<br/>             param_grid={'C': [0.1, 1, 10, 100, 1000],<br/>                         'gamma': [1, 0.1, 0.01, 0.001, 0.0001],<br/>                         'kernel': ['rbf']},<br/>             verbose=3)</span></pre><p id="9667" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">最佳参数设置可通过使用“最佳参数”函数获得，最佳估计值可通过使用“最佳估计值”设置获得。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="2c04" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; grid.best_params_<br/>{'C': 1, 'gamma': 0.0001, 'kernel': 'rbf'}</span><span id="9a79" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; grid.best_estimator_<br/>SVC(C=1, gamma=0.0001)</span></pre><p id="f5f8" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在可以使用这些新设置进行预测。</p><pre class="kp kq kr ks gt my mz na nb aw nc bi"><span id="c47c" class="nd lg iq mz b gy ne nf l ng nh">&gt;&gt;&gt; pred2 <strong class="mz ja">=</strong> grid.predict(X_test)</span><span id="8569" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; confusion_matrix(y_test,pred2)<br/>array([[ 59,   7],<br/>       [  2, 103]], dtype=int64)</span><span id="3e65" class="nd lg iq mz b gy nj nf l ng nh">&gt;&gt;&gt; print(classification_report(y_test,pred2))<br/>precision    recall  f1-score   support</span><span id="5b17" class="nd lg iq mz b gy nj nf l ng nh">           0       0.97      0.89      0.93        66<br/>           1       0.94      0.98      0.96       105</span><span id="8398" class="nd lg iq mz b gy nj nf l ng nh">    accuracy                           0.95       171<br/>   macro avg       0.95      0.94      0.94       171<br/>weighted avg       0.95      0.95      0.95       171</span></pre><p id="0a6a" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">因此使用网格搜索方法，模型性能有所提高。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><blockquote class="nr"><p id="175d" class="ns nt iq bd nu nv nw nx ny nz oa ms dk translated"><em class="ob">这里指笔记本</em><a class="ae le" href="https://github.com/jayashree8/Machine_learning_supervised_models/blob/master/Classification%20models/SVM.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="ob"/></a><em class="ob">。</em></p></blockquote><h2 id="624a" class="nd lg iq bd lh oc od dn ll oe of dp lp mg og oh lr mk oi oj lt mo ok ol lv iw bi translated">初级机器学习书籍可以参考:</h2><div class="om on gp gr oo op"><a href="https://amzn.to/3i3XU1A" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ja gy z fp ou fr fs ov fu fw iz bi translated">Python机器学习:机器学习和深度学习的Python编程初学者指南</h2></div><div class="ow l"><div class="ox l oy oz pa ow pb ky op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://amzn.to/3fQc6IW" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ja gy z fp ou fr fs ov fu fw iz bi translated">一百页的机器学习书</h2></div><div class="ow l"><div class="pc l oy oz pa ow pb ky op"/></div></div></a></div><h2 id="ab42" class="nd lg iq bd lh oc pd dn ll oe pe dp lp mg pf oh lr mk pg oj lt mo ph ol lv iw bi translated">可以参考的高级机器学习书籍:</h2><div class="om on gp gr oo op"><a href="https://amzn.to/2SxwQNw" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ja gy z fp ou fr fs ov fu fw iz bi translated">用Scikit-Learn、Keras和张量流进行机器学习:概念、工具和技术…</h2></div><div class="ow l"><div class="pi l oy oz pa ow pb ky op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://amzn.to/3wz62eE" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ja gy z fp ou fr fs ov fu fw iz bi translated">模式识别和机器学习(信息科学和统计学)</h2></div><div class="ow l"><div class="pj l oy oz pa ow pb ky op"/></div></div></a></div><blockquote class="pk pl pm"><p id="1fda" class="lx ly pn lz b ma mt ka mc md mu kd mf po mv mi mj pp mw mm mn pq mx mq mr ms ij bi translated"><em class="iq">联系我:</em> <a class="ae le" href="https://www.linkedin.com/in/jayashree-domala8/" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> LinkedIn </em> </a></p><p id="f13e" class="lx ly pn lz b ma mt ka mc md mu kd mf po mv mi mj pp mw mm mn pq mx mq mr ms ij bi translated"><em class="iq">查看我的其他作品:</em> <a class="ae le" href="https://github.com/jayashree8" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> GitHub </em> </a></p></blockquote></div></div>    
</body>
</html>