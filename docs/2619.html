<html>
<head>
<title>Decision Tree Classification: Explain It To Me Like I’m 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策树分类:像我10岁一样解释给我听</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/decision-tree-classification-explain-it-to-me-like-im-10-59a53c0b338f?source=collection_archive---------1-----------------------#2022-03-16">https://pub.towardsai.net/decision-tree-classification-explain-it-to-me-like-im-10-59a53c0b338f?source=collection_archive---------1-----------------------#2022-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3efa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将是<strong class="jp ir">向10岁的</strong>系列解释机器学习算法的第4部分。我们之前讨论过一个<strong class="jp ir"><em class="kl"/></strong>回归算法(<a class="ae km" href="https://medium.com/towards-data-science/xgboost-regression-explain-it-to-me-like-im-10-2cf324b0bbdb" rel="noopener"> XGBoost </a>)和两个<strong class="jp ir"> <em class="kl">聚类</em> </strong>算法(<a class="ae km" href="https://medium.com/towards-data-science/k-means-clustering-explain-it-to-me-like-im-10-e0badf10734a" rel="noopener"> K-Means </a>和<a class="ae km" href="https://medium.com/towards-data-science/hierarchical-clustering-explain-it-to-me-like-im-10-f949f8f3f80" rel="noopener">层次化</a>)。为了改变现状，今天我们将学习一种经典的<strong class="jp ir"> <em class="kl">分类</em> </strong>技术——决策树，一种老掉牙的好东西。</p><p id="3d6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用一个由7个人组成的超级简化的训练数据集来构建一个<strong class="jp ir">决策树</strong>，它可以根据一个人的<em class="kl">性别</em>，是否患有<em class="kl">运动诱发的心绞痛</em>(运动时胸痛)，以及年龄<em class="kl"/>来预测这个人是否患有<em class="kl">心脏病</em>。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/cd23492fb3c9a109adcb9c5361b30d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RXK_cDZVuc5ocwXm"/></div></div></figure><h1 id="ebaa" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">步骤1:找到根节点</h1><p id="d5d3" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">让我们从寻找我们树的根节点开始。出于启发的目的，我们将根据变量类型来划分寻找根节点的过程。</p><h2 id="47ac" class="mc la iq bd lb md me dn lf mf mg dp lj jy mh mi ln kc mj mk lr kg ml mm lv mn bi translated">分类变量</h2><p id="6678" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">先看看<strong class="jp ir"><em class="kl"/></strong>对某人是否患有<em class="kl">心脏病</em>的预测有多准确。我们通过将<em class="kl">性别</em>设置为我们的根节点，并仅基于<em class="kl">性别</em>统计有多少人患有和没有患有<em class="kl">心脏病</em>来做到这一点。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mo"><img src="../Images/e72f6d71d6ed437b02bc466c40756dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nQvFpeaw9pe9AfA9"/></div></div></figure><p id="dcfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对<strong class="jp ir"> <em class="kl">运动诱发的心绞痛做同样的事情</em> </strong> <em class="kl"> : </em></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mp"><img src="../Images/29683c5aac0869a6b386690c6284bab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gc4gCvAu-jz0jewP"/></div></div></figure><p id="700c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看着这些树，我们发现预测一个人是否患有心脏病也不是一项完美的工作。含有患<em class="kl">心脏病</em>和未患<em class="kl">心脏病的人的混合物的叶子，称为<em class="kl"/><strong class="jp ir"><em class="kl"/></strong>。我们可以用<em class="kl">基尼系数、熵、</em>和<em class="kl">信息增益</em>来量化杂质。在我们的例子中，让我们使用<strong class="jp ir"> <em class="kl">基尼杂质</em> </strong>。<em class="kl">基尼杂质</em>越高，叶子越不纯。所以我们希望该值尽可能低。我们先计算每片叶子的<em class="kl">基尼杂质</em>，然后再计算分割的总<em class="kl">基尼杂质</em>。计算叶子的<em class="kl">基尼杂质</em>的公式为-</em></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mq"><img src="../Images/b25de920e701e8d9363f552caabf83e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NkoDjASiFi6iPoJvgQO8EA.png"/></div></div></figure><p id="d8b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">左叶:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mr"><img src="../Images/1aa66f310b2b1dfd0128f0fe3e62e536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vi7gEbejVmgAOD6h"/></div></div></figure><p id="9c5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">右叶:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mr"><img src="../Images/985e95ba84a03650327cdb90ef02ff38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lqhDPw2BtPvutbS8"/></div></div></figure><p id="c61c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">分割的总基尼系数杂质是叶子的基尼系数杂质的加权平均值。因为左叶有4个人，右叶有3个人:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mr"><img src="../Images/46d4462962bcbeeda9e4a1df27b48bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WK8uKDTkfqVqqymf"/></div></div></figure><p id="d31b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">类似地，使用上面相同的公式，<em class="kl">运动诱发的心绞痛</em>的总<em class="kl">基尼系数</em>为<strong class="jp ir"> 0.214 </strong>。</p><h2 id="4413" class="mc la iq bd lb md me dn lf mf mg dp lj jy mh mi ln kc mj mk lr kg ml mm lv mn bi translated">连续变量</h2><p id="10da" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">为连续变量寻找<em class="kl">基尼系数要复杂一些。首先，将<em class="kl">年龄</em>从最低到最高排序:</em></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ms"><img src="../Images/31584d793a16537f45690b5f1a43648a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G7P1YHcEZfkWSrSm"/></div></div></figure><p id="00e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后计算相邻行的平均年龄:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/36dde65d5190c35e5803f5937c58b7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/0*8PG50v4U2SX9iSGa"/></div></figure><p id="fe69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些平均年龄将是我们的根节点阈值的候选者。最后，我们计算每个平均年龄的基尼系数。例如，为计算<em class="kl">年龄&lt; 39.5 </em>的<em class="kl">基尼系数</em>:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mu"><img src="../Images/dd83ea9f351fbd69c3f9580d233328b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CyE1J62jb-Q3kl-EE3o-gg.png"/></div></div></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mr"><img src="../Images/9d03addf8f0363387ef9837ed2b781bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FNvSMH4AKjvMTIvi"/></div></div></figure><p id="afaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，<em class="kl">基尼系数</em>对其余平均<em class="kl">年龄</em>的拆分是:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/5de80ec949dcd2ef1c43fcfa6c30d679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*XJD1LKQLejABxWrt"/></div></figure><p id="6b5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样做后，<em class="kl">基尼杂质</em>值最低的候选阈值为<em class="kl">年龄&lt; 58.5 </em>。因此，这将是<em class="kl">年龄</em>分裂的候选根节点。</p><h2 id="488b" class="mc la iq bd lb md me dn lf mf mg dp lj jy mh mi ln kc mj mk lr kg ml mm lv mn bi translated"><strong class="ak"> <em class="mw">根节点应该是什么？</em> </strong></h2><p id="c96a" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">现在我们已经有了三个候选根节点，具有最低<em class="kl"> Gini杂质</em>的那个将成为我们的根节点。在这个例子中，<strong class="jp ir"> <em class="kl">运动性心绞痛</em>的<em class="kl">基尼杂质</em>值<em class="kl"> </em>最低为0.214 </strong>，所以我们用的是<em class="kl">。</em></p><h1 id="fbcc" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">步骤2:添加分支</h1><p id="c7c7" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">我们向不纯的节点添加分支以减少不纯。添加分支的过程与查找根节点的过程非常相似。让我们先用<em class="kl">运动诱发的心绞痛、</em>来划分这个树，这样患有<em class="kl">运动诱发的心绞痛</em>的人走左边，没有的人走右边:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mx"><img src="../Images/569a17ff90adc8ba15fbc338ce78d7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gf95UmmO3ADa2JUOxij8zQ.png"/></div></div></figure><p id="ca5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到右边的节点是纯的，具有<em class="kl"> Gini杂质</em> 0，左边的节点是不纯的，具有<em class="kl"> Gini杂质</em> 0.375。现在，我们检查是否可以通过添加分支或通过<em class="kl">年龄</em>或<em class="kl">性别</em>进一步分裂来减少杂质。由于我们只关注分裂左侧淋巴结，我们应该只关注患有<em class="kl">运动诱发性心绞痛</em>的人。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi my"><img src="../Images/ebec21ff4aea8eb4c142b1fc69bed26d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8Qe0ejwvsu-xGvZp"/></div></div></figure><p id="f7d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，尝试按<em class="kl">性别</em>分割左侧节点:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mz"><img src="../Images/38b41a40cef01590fefeaff7b055c7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*flUxePSY6RbFrMXI"/></div></div></figure><p id="791d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在以与之前相同的方式计算分割的<em class="kl">基尼系数</em>，并看到该值为<strong class="jp ir"> 0.25 </strong>。</p><p id="de04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，为了找到<em class="kl">年龄</em>分割的候选阈值，我们将4个突出显示的行按升序排序，并计算每个平均年龄的<em class="kl">基尼系数杂质</em>:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi na"><img src="../Images/c0cb47c687587fbb2ea69ef7f1000707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CrQ-clQ9GVvrL8sS"/></div></div></figure><p id="7af9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到<em class="kl">年龄&lt; 41 </em>给出最低的基尼杂质值为0。所以，这将是我们的候选人的<em class="kl">年龄</em>分裂。现在因为<strong class="jp ir"> 0 </strong> <em class="kl">(基尼不纯的年龄&lt; 41拆分)</em><strong class="jp ir"/><strong class="jp ir">0.25</strong><em class="kl">(基尼不纯的性别拆分)</em>，用<em class="kl">年龄&lt; 41 </em>将这个节点拆分成叶子。</p><blockquote class="nb nc nd"><p id="bb1d" class="jn jo kl jp b jq jr js jt ju jv jw jx ne jz ka kb nf kd ke kf ng kh ki kj kk ij bi translated">注意:我们将输出叶保留为叶，因为没有理由继续通过添加分支将这些人分成更小的组。</p></blockquote><p id="fefd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在这棵树看起来像这样:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nh"><img src="../Images/0094297e49de273629110b50a011eac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*esxs68OCYIVfkfaJhjkxww.png"/></div></div></figure><h1 id="8c7b" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">步骤3:为每片叶子分配输出值</h1><p id="c000" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">一般来说，一个叶子的输出是哪个类别的投票数最多。在我们的情况下，这将是大多数人是否有心脏病。所以，我们最后的树是:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ni"><img src="../Images/109a245338395659b3b024fc25843553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tsP4Ol0H5AwOhMQo6XHDiQ.png"/></div></div></figure><h1 id="1b78" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">步骤4:检查是否过度拟合</h1><p id="c830" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">数据的过度拟合是指模型完全符合训练数据集。理想情况下，我们希望防止训练数据集的过度拟合，因为这会影响模型在新数据上的性能。避免这种情况的方法是修剪树木。这意味着我们通过去掉树枝来减小树的大小。这可以通过两种方式实现:</p><ol class=""><li id="c34c" class="nj nk iq jp b jq jr ju jv jy nl kc nm kg nn kk no np nq nr bi translated"><strong class="jp ir">预修剪</strong>:这里，我们在模型构建过程的开始，通过控制树的最大深度、在节点中向树添加分支所需的最小观察次数和/或在叶节点中所需的最小观察次数来修剪树。</li><li id="a6a9" class="nj nk iq jp b jq ns ju nt jy nu kc nv kg nw kk no np nq nr bi translated">后期修剪:这样可以让树长到最大深度，然后我们会移除树枝。</li></ol><p id="be2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仅此而已。你简单而有效的决策树！</p><p id="6e31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个大喊到<a class="ae km" href="https://statquest.org/" rel="noopener ugc nofollow" target="_blank"> StatQuest </a>，我最喜欢的统计和机器学习资源。请随时在LinkedIn上与我联系，或者给我发电子邮件到shreya.statistics@gmail.com，给我发送任何10岁孩子需要理解的其他算法的建议！</p></div></div>    
</body>
</html>