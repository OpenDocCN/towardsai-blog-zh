<html>
<head>
<title>Essential Mathematical Equations for Predictive Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测模型的基本数学方程</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/essential-mathematical-equations-for-predictive-models-fcb79630ec96?source=collection_archive---------0-----------------------#2021-11-05">https://pub.towardsai.net/essential-mathematical-equations-for-predictive-models-fcb79630ec96?source=collection_archive---------0-----------------------#2021-11-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1631" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="9e2e" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">以及如何用Python计算它们</h2></div><p id="6b08" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">简介</strong></p><p id="b5e0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">数学模型是用来描述变量行为的方程，如果足够好，可以用来预测未来的行为或描述模式。在这篇文章中，我将使用我们在高中学习的数学方程来描述一些最常见和最容易拟合的模型。为了适应模型，我将通过谷歌Colab使用Python。所有的代码和数据集也可以在<a class="ae ln" href="https://github.com/cdanielaam/math_models_medium" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p><p id="7be9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">对于本文中提供的所有示例，我们将使用来自葡萄牙人口的新冠肺炎数据集，该数据集每天更新，可以在<a class="ae ln" href="https://github.com/cdanielaam/covid19pt-data" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><p id="e3fb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">(请注意，我使用的样本来自2021年10月26日下载的数据集)</p><p id="de1d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在我们开始拟合模型之前，我们需要加载一些python库:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="20fa" class="lx ly it lt b gy lz ma l mb mc">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>import seaborn as sns<br/>from sklearn.linear_model import LinearRegression<br/>from numpy.random import randn<br/>from numpy.random import seed<br/>from scipy.stats import pearsonr<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn import datasets, linear_model<br/>from sklearn.metrics import *<br/>import statistics<br/>import statsmodels.api as sm<br/>from lmfit import Model</span></pre><p id="32f1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">线性方程组</strong></p><p id="8bd3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">线性方程用于拟合线性回归模型，其形式为<em class="md"> y = mx+b，</em>其中<em class="md"> m </em>是斜率，b是与<em class="md"> y轴</em>的截距。使用显示每天病例数的新冠肺炎数据集样本，我们获得了以下数据:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="2655" class="lx ly it lt b gy lz ma l mb mc">df = pd.read_csv('/content/lm.csv')<br/>df</span><span id="e817" class="lx ly it lt b gy me ma l mb mc">plt.scatter(df["ID"], df["confirmados"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/9e1675074a2dc6733c42d2dedc3c508f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*LS7mS2iBnrbe9OooPt9HJw.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图一。每日新冠肺炎累积病例的增加。</figcaption></figure><p id="de45" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">很容易看出，该图从第500天到第550天呈线性增长。为了拟合此数据的模型，我们将使用:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="2d14" class="lx ly it lt b gy lz ma l mb mc">y = df['confirmados']<br/>X = df['ID']<br/>X1 = sm.add_constant(X)<br/>model = sm.OLS(y, X1)<br/>results_model = model.fit()<br/>print(results_model.summary())</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/157b503a08dcd296d34db8b5e0abb897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*10qmwCzOM18OSGP-XpPJ3w.png"/></div></figure><p id="c566" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">从模型总结中，我们可以看到R的平方为0.99，并获得我们方程的参数:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/9fc3d3e8e7a76f6d3da388c814ce76a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*6bkvJCBMUJ1Jl3zJBi_MoA.png"/></div></figure><blockquote class="mp mq mr"><p id="10fd" class="kr ks md kt b ku kv kd kw kx ky kg kz ms lb lc ld mt lf lg lh mu lj lk ll lm im bi translated">如果你想了解更多关于线性回归的知识，你可以查看我的另一篇文章。</p></blockquote><p id="99c0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">多项式方程</strong></p><p id="7699" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">多项式方程的形式为:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/adc6580d3472fc13cf2bb32cad787853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*M4bGV2O1pO1P175eF10E9Q.png"/></div></figure><p id="f719" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">其中<strong class="kt jd"> <em class="md"> a </em> </strong> <em class="md">，</em> <strong class="kt jd"> <em class="md"> b </em> </strong> <em class="md">，</em> <strong class="kt jd"> <em class="md"> c </em> </strong> <em class="md">，</em> <strong class="kt jd"> <em class="md">，</em> </strong>，<strong class="kt jd"><em class="md"/></strong>e<strong class="kt jd"><em class="md">x</em></strong>是多项式而<strong class="kt jd"> <em class="md"/></strong></p><p id="6076" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">多项式函数可用于预测疾病流行的进程，如新冠肺炎。在本例中，我们将分析来自葡萄牙新冠肺炎数据集的样本，其中包含每天确诊的病例数。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="3982" class="lx ly it lt b gy lz ma l mb mc">#Load and view dataset:<br/>datas = pd.read_csv('poly.csv')<br/>datas</span></pre><p id="e306" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将只使用“ID”和“confirmados”列。ID是自卫生当局开始发布新冠肺炎病例每日报告以来的天数，“confirmados”是当天确认的新冠肺炎阳性病例数。我们将用这两个变量来绘制图表，并检查它们是否有线性关系。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="3f64" class="lx ly it lt b gy lz ma l mb mc">#Plotting the number of cases according to the number of elapsed days:<br/>sns.regplot(x=datas["ID"], y=datas["confirmados"])</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/604b1c4ecf023ca5c552a5db6d509219.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ACvW5C2nXQfl9zOhqc8Jcg.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图二。根据每日报告开始后经过的天数确定的确诊病例数。</figcaption></figure><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="3209" class="lx ly it lt b gy lz ma l mb mc">#Deriving the polynomial model:<br/>mymodel = numpy.poly1d(numpy.polyfit(datas["ID"], datas["confirmados"], 4)) # The number 4 at the end is the degree we want for our polynomial equation. </span><span id="3f17" class="lx ly it lt b gy me ma l mb mc">#Drawing a new plot with new regression line:<br/>myline = numpy.linspace(300, 620, 320)<br/>plt.scatter(datas["ID"], datas["confirmados"])<br/>plt.plot(myline, mymodel(myline))<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/80be82e501958a0070ffb46ad4ac7b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*7K0ohajBTD76DoaimIkKXQ.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图3。一个新的多项式回归线图。</figcaption></figure><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="6164" class="lx ly it lt b gy lz ma l mb mc">#Obtaining the equation:<br/>poly = np.poly1d(mymodel)<br/>print(poly)</span></pre><p id="0adb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我们有了模型的多项式方程:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi my"><img src="../Images/2a71c2906b04f70bd90d183a676c04f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*pGRB_iRxo6v08OKt-oxSCQ.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">形象。多项式模型的最终方程。</figcaption></figure><p id="2b7d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">指数方程</strong></p><p id="8970" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">指数函数的形式如下:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/e5feaa3ad793fd84cca78c46a3a38557.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*obA-7bU7xp0azF7Ar4_TJA.png"/></div></figure><p id="8cb8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">其中<em class="md">a</em>T18】0≠1，<em class="md"> x </em>为实数。多项式函数有不止一个指数表达式，而指数方程只有一个，我们的<em class="md"> x </em>就是那个值。指数模型可以用来解释增长和衰退模式。再次使用新冠肺炎数据集，我们可以预测由于新冠肺炎导致的入院人数，作为自每日报告开始以来经过天数的函数。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="287a" class="lx ly it lt b gy lz ma l mb mc">#Plotting the graph:<br/>plt.scatter(datas["ID"], datas["internados"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi na"><img src="../Images/9cf296e1816932e6bf04b8abafa9cfc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*uyajVI-l83ZV79AMhNmiKA.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图4。根据每日报告开始后经过的天数计算的住院人数。</figcaption></figure><p id="0357" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">然后，我们选择希望包含在模型中的变量:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="d0a0" class="lx ly it lt b gy lz ma l mb mc">x = datas["ID"]<br/>y = datas["internados"]</span></pre><p id="e48c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们建立了这个模型:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="df0e" class="lx ly it lt b gy lz ma l mb mc">#Model building using log transformation to y variable:<br/>fit = np.polyfit(x, np.log(y), 1)<br/>print(fit)</span></pre><p id="39bf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当我们对<em class="md"> y </em>变量进行对数变换时，我们得到了以下线性方程:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="4460" class="lx ly it lt b gy lz ma l mb mc">ln(y) = 0.2368051 + 0.0295562(x)</span></pre><p id="3f23" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，为了获得一个指数方程，我们需要将<em class="md"> e(欧拉数)</em>应用到方程的两边:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="01b4" class="lx ly it lt b gy lz ma l mb mc">print(np.exp(0.2368051))<br/>#output:  1.2671941175723809</span><span id="8790" class="lx ly it lt b gy me ma l mb mc">print(np.exp(0.0295562))<br/>#output:  1.0299973196946968</span></pre><p id="2a0d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们得到了等式:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9f499df39b5a3a0bd2c4f9536b785a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*VH52FjXnP0_mZX6uo2cLfw.png"/></div></figure><p id="f4d0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">平方根方程</strong></p><p id="7b85" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">根模型实际上是幂函数，其中幂的形式为1/2 <em class="md">。</em>该功能</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/d3c17d33724860aca0d7b3263bb82619.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*IyXOruAaM0AmL0kxVoNbjA.png"/></div></figure><p id="3aa1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">方法</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/ff530dc583f86f1e51a9f17d323aa44b.png" data-original-src="https://miro.medium.com/v2/resize:fit:274/format:webp/1*jqoXBxOmIAZ2Xtyc7s1E6Q.png"/></div></figure><p id="515d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">平方根模型用于描述在开始时快速增长，但增长趋于缓慢的函数。平方根函数的行为类似于对数函数。在平方根变换或对数变换之间进行选择时，我们可以两者都尝试，看看哪一个对可用数据更有效。在本例中，我们将使用新冠肺炎新增确诊病例数来预测活跃病例数。当我们绘制图表时，我们可以看到它具有平方根形式:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="2f91" class="lx ly it lt b gy lz ma l mb mc">df = pd.read_csv('/covid19.csv')<br/>plt.scatter(df["confirmados_novos"], df["ativos"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/2a49cc866ecf4b2b997e0288bd270fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*L66_kXPGG9f4iMwPBBDxvA.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图5。根据新确诊病例数计算的新冠肺炎活跃病例数。</figcaption></figure><p id="a5bd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们还可以看到，使用的数据是右偏的。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="429a" class="lx ly it lt b gy lz ma l mb mc">sns.distplot( a=df["confirmados_novos"], hist=True, kde=False, rug=False )</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/507ca93016ed585657717e741d5668f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*GtQXWzewvcHLmYjeVtMZNw.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图6。新冠肺炎新增确诊病例数</figcaption></figure><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="33dd" class="lx ly it lt b gy lz ma l mb mc">sns.distplot( a=df["ativos"], hist=True, kde=False, rug=False )</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6a7dabeebba9d0bdd49e79a9fc506697.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*e-AnM61st-iLgR7pKSP44g.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图7。新冠肺炎的活跃病例数。</figcaption></figure><p id="1374" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">下一步是对新确诊病例的可变数量应用平方根变换:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="4552" class="lx ly it lt b gy lz ma l mb mc">df["conf_new_root"] = np.sqrt(df["confirmados_novos"])</span></pre><p id="8d75" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">而如果我们再绘制一次，我们会阿瑟更多的线性关系:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="7d25" class="lx ly it lt b gy lz ma l mb mc">plt.scatter(df["conf_new_root"], df["ativos"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/f0bd48a6a0f5b73f667ff62c96e2d437.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*mOVZHfh0V7ucR_KVKJNukg.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图8。新冠肺炎活跃病例数按新增确诊病例数的平方根计算。</figcaption></figure><p id="ca59" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我们可以拟合一个简单的线性回归模型:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="1748" class="lx ly it lt b gy lz ma l mb mc">y = df['ativos']<br/>X1 = df['conf_new_root']<br/>X1a = sm.add_constant(X1)<br/>model_1a = sm.OLS(y, X1a)</span><span id="f9f6" class="lx ly it lt b gy me ma l mb mc">results_model_1a = model_1a.fit()<br/>print(results_model_1a.summary())</span></pre><p id="ab47" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">根据从模型中获得的总结，我们现在可以建立平方根方程:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/37abad8ec64155be967a5e281abac0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*vN5yUlCGv5uCQNpRBDJxzw.png"/></div></figure><p id="6b4e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">对数方程</strong></p><p id="925e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">和所有其他函数一样，对数函数可以用来解释增长和衰退。当对数函数用于解释衰变时，首先是快速衰变的行为，然后趋于减速。下图中可以看到一个例子，该图显示，随着分娩开始时间的推移，新冠肺炎新增病例数在减少。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="0a08" class="lx ly it lt b gy lz ma l mb mc">df = pd.read_csv('/content/covid19se.csv')</span><span id="5ddf" class="lx ly it lt b gy me ma l mb mc">plt.scatter(df["confirmados_novos"], df["ID"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b483a928e28133782f54c14b80e79075.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*4PetkSSJCa85TeqhJIU84Q.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图9。分娩开始后，随着时间的推移，新的新冠肺炎病例数量会减少。</figcaption></figure><p id="f906" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">然后，我们对“confirmados_novos”应用自然对数变换，并再次检查散点图，以查看现在我们有一个更线性的关系。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="0c32" class="lx ly it lt b gy lz ma l mb mc">df["conf_new_log"] = np.log(df["confirmados_novos"])</span><span id="6fbb" class="lx ly it lt b gy me ma l mb mc">plt.scatter(df["conf_new_log"], df["ID"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/a6c9902f171987819bf1de0b19575e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*Yosw4piXc_9dAzW9FS5M5A.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图10。分娩开始后，新冠肺炎新增病例数随着时间的推移而减少的自然记录。</figcaption></figure><p id="3504" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我们可以应用线性回归模型。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="c08c" class="lx ly it lt b gy lz ma l mb mc">y2 = df['ID']<br/>X2 = df['conf_new_log']<br/>X2a = sm.add_constant(X2)<br/>model_2a = sm.OLS(y2, X2a)</span><span id="2a5f" class="lx ly it lt b gy me ma l mb mc">results_model_2a = model_2a.fit()<br/>print(results_model_2a.summary())</span></pre><p id="3ced" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的最终等式可以写成:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/86d3a5cca2ad9e3326524ef9aad3b3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*XtNQGEeLlysVX5N8bFs6kw.png"/></div></figure><p id="21f9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">正弦方程</strong></p><p id="e853" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正弦模型用于描述周期模式，即使我们只对正弦曲线的一个周期使用该函数。一般正弦方程为:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/58949eaa495914e356f1bf3ea81e0a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*iLsUyxNYcrJ_soieD5oW8Q.png"/></div></figure><p id="6815" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正弦函数的图形是:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/59fdcb26b8525de9b030bf65cfe787e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrDDLdv2KwwlcX3391kJhA.png"/></div></div></figure><p id="37f7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">新冠肺炎数据集中周期性模式的一个例子是随着隔离措施的收紧或放松，新病例的增加和减少。对于这个例子，我们从新冠肺炎数据集中选择了一个具有这种模式行为的样本，即使它不是完美的正弦曲线。我们将使用<strong class="kt jd"> lmfit </strong>来拟合我们的正弦模型<strong class="kt jd">T5(你可以在<strong class="kt jd"/><a class="ae ln" href="https://lmfit.github.io/lmfit-py/" rel="noopener ugc nofollow" target="_blank">https://lmfit.github.io/lmfit-py/</a>了解更多)。</strong></p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="cc92" class="lx ly it lt b gy lz ma l mb mc">plt.scatter(df["ID"], df["confirmados_novos"])<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi np"><img src="../Images/2a9c2a18ab81d70ce32746b74231296f.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*qqk7dj-68ial7EhCbpFFyg.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图11。随着隔离措施的收紧或放松，新诊断的新冠肺炎病例数量的增加和减少。</figcaption></figure><p id="4b9d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为了用正弦模型拟合数据，我们将使用:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="868d" class="lx ly it lt b gy lz ma l mb mc">#To define the model function:<br/>def sinfunc(x, a, b, c, d):<br/>    return a * np.sin(b*(x - c)) + d</span><span id="b1b0" class="lx ly it lt b gy me ma l mb mc">#To define our parameters:<br/>predictor = df["ID"]<br/>predicted = df["confirmados_novos"]</span><span id="dccd" class="lx ly it lt b gy me ma l mb mc">#Create a model variable:<br/>model  = Model(sinfunc)</span><span id="63c0" class="lx ly it lt b gy me ma l mb mc">#To define the parameters of the function (note that a, b, c and d are guessed parameters that we could try by error by analysing the scatterplot):<br/>params = model.make_params(a=1000, b=0.1, c=0, d=0)</span><span id="8011" class="lx ly it lt b gy me ma l mb mc">#Model fitting:<br/>result = model.fit(predicted, params, x=predictor)</span><span id="5484" class="lx ly it lt b gy me ma l mb mc">#Print models summary to get our final parameters:<br/>print(result.fit_report())</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/872622c916afd2d197708c2cd05eba03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*DN93o0eaMxyIC_68Z-blSg.png"/></div></figure><p id="150f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在本报告中，我们可以检查<em class="md"> a </em>、<em class="md"> b </em>、<em class="md"> c、</em>和<em class="md"> d </em>的最终值，并建立等式:</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f13362d01071a4ef1188de5551eebc34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*Z5LgagXOnjZ46rZqCOXccw.png"/></div></figure><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="683a" class="lx ly it lt b gy lz ma l mb mc">#To build the graph and plot the model line:<br/>plt.scatter(predictor,predicted,label='Confirmados_Novos')<br/>plt.plot(predictor, result.best_fit, 'r-',label='Fitted function')<br/>plt.title("ID vs Confirmados_Novos")<br/>plt.xlabel('ID')<br/>plt.ylabel('Confirmados_Novos')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/beb3f8acf809e4c27b3be76dd0167ebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*zj6N6wpg0dh11TFg5Gzhyw.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">图12。带有拟合函数的数据。</figcaption></figure><p id="415e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后，我们可以看到拟合函数的数据。</p><p id="c12f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些只是可以通过回归在预测模型中使用的一些最基本的例子，这比线性回归稍微多一点。如果您有任何其他想要讨论的模型，或者您有任何建议或更正，请告诉我。</p><p id="50ee" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果你喜欢这篇文章，别忘了关注我，这样你就能收到所有关于新出版物的更新。</p><p id="8d9c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果想了解更多，可以通过<a class="ae ln" href="https://cdanielaam.medium.com/membership" rel="noopener">我的推荐链接</a>订阅Medium会员。它不会花你更多的钱，但会给我一杯咖啡。</p></div></div>    
</body>
</html>