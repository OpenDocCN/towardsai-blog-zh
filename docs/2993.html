<html>
<head>
<title>Forecasting Electricity Production-Probabilistic Time Series Algorithm from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测发电量-从零开始的概率时间序列算法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/forecasting-electricity-production-probabilistic-time-series-algorithm-from-scratch-2449eed70ace?source=collection_archive---------2-----------------------#2022-07-27">https://pub.towardsai.net/forecasting-electricity-production-probabilistic-time-series-algorithm-from-scratch-2449eed70ace?source=collection_archive---------2-----------------------#2022-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/375fcdd65f891d72d45a633bb923b8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHEQO0RFzGz80uKKCYxCWg.png"/></div></div></figure><p id="b470" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一个随机时间序列算法，我从头开始创建的。</p><h2 id="bfed" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">一.获取数据</h2><h2 id="14bc" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">二。重要</h2><h2 id="55c2" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">三。方向</h2><h2 id="b88a" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">四。把它放在一起</h2><h2 id="fd5f" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">动词 （verb的缩写）平均绝对百分比误差(MAPE)</h2></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h2 id="15b2" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">一.获取数据</h2><p id="a843" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">我去了这个链接:<a class="ae me" href="https://www.kaggle.com/datasets/shenba/time-series-datasets?select=Electric_Production.csv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/八神/time-series-datasets？select = Electric _ production . CSV</a></p><p id="3cf1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我下载了电动生产CSV。</p><p id="8b91" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下载这个CSV文件后，我将它放入excel中，并对数据进行排序，使最新的数据位于顶部。</p><p id="13af" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">二世。变化幅度</strong></p><p id="e86b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了使用时间序列进行预测，我们需要计算变化的幅度。变化的幅度是公正的</p><p id="7233" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当天值—前一天的值。</p><p id="a0a2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">请注意，当我们使用震级进行预测时，我们将不会使用当天的震级，而是使用之前震级的调和平均值。</strong></p><p id="880a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如上所述，我们现在将计算前几天的调和平均值。</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="a75a" class="kz la it mk b gy mo mp l mq mr">=HARMEAN(ABS($D396:D$397))</span></pre><p id="1dd1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个公式基本上锁定在单元格397，这是我们数据的最后一行。但是，当我们将公式一直拖动到第一行时，公式的第一部分将继续向上移动。这里的基本情况是，我们正在计算前n天发生的变化幅度绝对值的调和平均值。这个量级就是我们在预测中使用的步长。</p><h2 id="9063" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">三。方向</h2><p id="a008" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">现在我们需要理解方向。</p><p id="308b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">方向是概率性的。首先，让我们编写一个up/down变量</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="bace" class="kz la it mk b gy mo mp l mq mr">=IF(B396-B397&gt;0,"up","down")</span></pre><p id="4ed8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以把这个公式一直拖到今天。这告诉我们一天是比前一天上涨还是下跌。</p><p id="c37d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，我们需要在上涨/下跌的先验分布中计算上涨和下跌的概率:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="39c6" class="kz la it mk b gy mo mp l mq mr">=COUNTIF($E397:E$398,"up")/COUNT($B397:B$398)</span></pre><p id="bad1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们将编写一个随机函数，根据概率给出符号的大小。这意味着，如果我们在0和1之间的随机数大于公式中所示的上概率，那么我们将有一个负号，否则，我们将有一个正号，用于我们之前确定的步长。</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="1663" class="kz la it mk b gy mo mp l mq mr">=IF(RAND()&gt;=G395,-1,1)</span></pre><h2 id="6f6d" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">四。把它放在一起</h2><p id="8d5c" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">我们会把它和这个公式一起一路拖上来。</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="dc08" class="kz la it mk b gy mo mp l mq mr">=B397+(F396*H396)</span></pre><p id="25cd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个公式转化为:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="e439" class="kz la it mk b gy mo mp l mq mr">=previous known actual value + (harmonic mean of previous magnitude of known change * probability that this step size will positive or negative) </span></pre><p id="b91e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们绘制时间序列时，我们得到这个:</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ac46af39c9a27a5f272149e30fad05b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYmGyVPBwJl8TyAT-YY5jw.png"/></div></div></figure><h2 id="79c8" class="kz la it bd lb lc ld dn le lf lg dp lh km li lj lk kq ll lm ln ku lo lp lq lr bi translated">动词 （verb的缩写）平均绝对百分比误差(MAPE)</h2><p id="d5b7" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">我们可以计算MAPE:</p><pre class="mf mg mh mi gt mj mk ml mm aw mn bi"><span id="4bac" class="kz la it mk b gy mo mp l mq mr">=abs(B396-C396)/B396</span></pre><p id="6650" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> MAPE是以下各项的平均值→实际值与预测值之差的绝对值与实际值的百分比之间的误差。</strong></p><p id="2ccc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这种情况下，当我平均所有的百分比误差时，误差是-.19%，这是相当低的。MAPE为7.65%。</p><p id="6920" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数据参考:</p><ol class=""><li id="83ad" class="ms mt it kd b ke kf ki kj km mu kq mv ku mw ky mx my mz na bi translated"><a class="ae me" href="https://www.kaggle.com/datasets/shenba/time-series-datasets?select=Electric_Production.csv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/八神/时间序列-数据集？select = Electric _ production . CSV</a></li></ol></div></div>    
</body>
</html>