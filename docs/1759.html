<html>
<head>
<title>NLP using DeepLeaning Tutorials: A Sentiment Classifier based on Perceptron (Part 1/4)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习教程的NLP:基于感知器的情感分类器(第1/4部分)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-1-4-712eefe20899?source=collection_archive---------0-----------------------#2021-04-14">https://pub.towardsai.net/nlp-using-deepleaning-tutorials-a-sentiment-classifier-based-on-perceptron-part-1-4-712eefe20899?source=collection_archive---------0-----------------------#2021-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c71b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/c78312765114e2fe1d6706951cd1ba68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZfNEjcq5NR_3LYRuqQV0A.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">这张图片上传自<a class="ae ko" href="https://www.ntaskmanager.com/wp-content/uploads/2020/01/Sentiment-Analysis.png" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="f66a" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">自然语言处理是最复杂的机器学习领域之一，基本上是由于语言的复杂性和模糊性。然而，它也是最成功的领域之一，我们每天都在使用许多真实的应用程序，如搜索引擎、翻译工具等等。</p><p id="b010" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有时最复杂的任务可以用最简单的技术解决。在这篇文章中，我将尝试探索这种说法。因此，我将基于最简单的神经网络“感知器”提出一个完整的情感分析解决方案，使用真实世界的任务和数据集:对Yelp上的餐馆评论进行正面或负面分类。</p><p id="6e0f" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为此，我将本文分为以下四个部分:</p><ol class=""><li id="b134" class="ln lo it kr b ks kt kw kx la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kr jd">Yelp数据集评论(当前文章关注这部分)</strong></li><li id="38e1" class="ln lo it kr b ks lw kw lx la ly le lz li ma lm ls lt lu lv bi translated">词汇和矢量器</li><li id="7b4a" class="ln lo it kr b ks lw kw lx la ly le lz li ma lm ls lt lu lv bi translated">训练程序</li><li id="3a77" class="ln lo it kr b ks lw kw lx la ly le lz li ma lm ls lt lu lv bi translated">评估和推理</li></ol></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="1e7e" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">第一部分:Yelp数据集评论</h1><p id="33a7" class="pw-post-body-paragraph kp kq it kr b ks ng ku kv kw nh ky kz la ni lc ld le nj lg lh li nk lk ll lm im bi translated">2015年，Yelp组织了一场机器学习竞赛，要求参与者根据餐馆的评论预测餐馆的评级。这将我们带回到了5个类别(从1、2、3、4和5星级)的多分类问题。之后，张、赵和乐存[2]通过将1星和2星转换为“负面”情绪，将3星、4星和5星转换为“正面”情绪，将该问题简化为二元情绪分类这项工作的结果是一个新的标记数据集。每行对应一对餐馆评论的自然文本和代表星级的情绪“正面”或“负面”。这个数据集然后被分成两组:560，000行的训练集和38，000行的测试集。</p><p id="e249" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">数据集可以从这个链接下载:<a class="ae ko" href="https://www.yelp.com/dataset" rel="noopener ugc nofollow" target="_blank">https://www.yelp.com/dataset</a></p><p id="9a1e" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jd"> <em class="nl">在本文中，我们将只使用训练集作为数据集来说明如何根据需要将它分成多个数据集。</em>T11】</strong></p><p id="94fe" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将数据集分成三部分:70%用于训练，20%用于验证，10%用于测试。这些百分比是最常用的，但可以根据数据集进行更改。但是，训练永远是最大的一块。总而言之，训练分区显然是用于导出模型参数的。验证分区用于在每个时期之后在超参数中进行选择，而测试用于最终评估和报告。</p><p id="0d12" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这种数据集分割适用于大型数据集。在相反的情况下，当数据集很小时，我们可以使用K-fold交叉验证(** <em class="nl">这是我希望在我未来的一篇文章中涉及的另一个主题</em> **)。</p><p id="a7a4" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">以下代码通过添加具有三个可能值的新标记列来拆分初始数据集“raw _ train . CSV”:“train”、“val”和“test”。新数据集被导出到新的CSV文件“raw_split.csv”中:</p><figure class="nm nn no np gt kd"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="3695" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这段代码还对每一行进行了基本的清理处理，将文本转换为小写，在标点符号前后添加空格，并删除所有不是标点符号或字母的符号。</p><p id="fe48" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">之后，我们创建ReviewDataSet类来通过训练步骤操作数据集。该类从Pytorch抽象迭代器“Dataset”继承而来，并重新定义了__getitem__()和__len__()方法。这使得各种Pytorch实用程序能够正确地处理我们的数据集，比如将在下一部分中讨论的“数据加载器”。</p><p id="d29d" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">ReviewDataSet类的内容是:</p><figure class="nm nn no np gt kd"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="5e72" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">请注意，类ReviewDataset使用名为ReviewVectorizer的类，负责将评论文本转换为神经网络工作所需的矢量数字。这个类将在下一部分详细介绍。</p><p id="d170" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后，为了理解数据集，这里是每个子集内容的一些示例，您可以使用以下代码来显示:</p><pre class="nm nn no np gt ns nt nu nv aw nw bi"><span id="174f" class="nx mj it nt b gy ny nz l oa ob">dataset_review = ReviewDataset.load_dataset_and_make_vectorize(review_csv=<strong class="nt jd">'./data/raw_split.csv'</strong>)<br/><br/>print(<strong class="nt jd">"Train Dataset size :"</strong>, dataset_review.train_size)<br/>print(<strong class="nt jd">"Train Dataset examples ::"</strong>)<br/>print(dataset_review.train_df.head())</span></pre><ul class=""><li id="af44" class="ln lo it kr b ks kt kw kx la lp le lq li lr lm oc lt lu lv bi translated"><strong class="kr jd">训练数据集:</strong></li></ul><figure class="nm nn no np gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi od"><img src="../Images/3d1def16da02e567c848c613bb28fbcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LL9nxojFQk1edwL5m343Fg.png"/></div></div></figure><ul class=""><li id="af7b" class="ln lo it kr b ks kt kw kx la lp le lq li lr lm oc lt lu lv bi translated"><strong class="kr jd">有效数据集:</strong></li></ul><figure class="nm nn no np gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/e7d47a61f20837e43484fd5a2d062525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_MTjykigIG6avJ50ixM4oQ.png"/></div></div></figure><ul class=""><li id="f50d" class="ln lo it kr b ks kt kw kx la lp le lq li lr lm oc lt lu lv bi translated"><strong class="kr jd">测试或评估数据集:</strong></li></ul><figure class="nm nn no np gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi of"><img src="../Images/122ec3f210346411a10dac82e2758518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3nfF5HN4fvoio2kMoN2WhA.png"/></div></div></figure><h1 id="ec17" class="mi mj it bd mk ml og mn mo mp oh mr ms mt oi mv mw mx oj mz na nb ok nd ne nf bi translated">结论:</h1><p id="6b2c" class="pw-post-body-paragraph kp kq it kr b ks ng ku kv kw nh ky kz la ni lc ld le nj lg lh li nk lk ll lm im bi translated">在这一部分中，我们回顾了我们将用于训练和评估基于感知的情感分类器的数据集。下一部分涉及矢量化过程。</p><p id="2146" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jd">参考文献:</strong></p><ol class=""><li id="3cc9" class="ln lo it kr b ks kt kw kx la lp le lq li lr lm ls lt lu lv bi translated">《用Pytorch进行自然语言处理》一书(<a class="ae ko" href="https://www.amazon.fr/Natural-Language-Processing-Pytorch-Applications/dp/1491978236" rel="noopener ugc nofollow" target="_blank">https://www . Amazon . fr/Natural-Language-Processing-py torch-Applications/DP/1491978236</a>)</li><li id="9645" class="ln lo it kr b ks lw kw lx la ly le lz li ma lm ls lt lu lv bi translated">张、项、赵军波、杨乐存。"用于文本分类的字符级卷积网络."<em class="nl"> arXiv预印本arXiv:1509.01626 </em> (2015)。</li></ol></div></div>    
</body>
</html>