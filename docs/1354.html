<html>
<head>
<title>Bitcoin Price Prediction with LSTM using Q Blocks (Part II)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Q块的LSTM比特币价格预测(下)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/bitcoin-price-prediction-with-lstm-using-q-blocks-part-ii-ae2168bafd6d?source=collection_archive---------4-----------------------#2021-01-06">https://pub.towardsai.net/bitcoin-price-prediction-with-lstm-using-q-blocks-part-ii-ae2168bafd6d?source=collection_archive---------4-----------------------#2021-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0ea1" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="7b9e" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated"><a class="ae kr" href="https://www.qblocks.cloud/" rel="noopener ugc nofollow" target="_blank"> Q块</a> GPU使用指南，顺序到<a class="ae kr" href="https://medium.com/towards-artificial-intelligence/bitcoin-price-prediction-with-lstm-using-q-blocks-part-i-43322abf7556" rel="noopener">第一部分</a></h2></div><p id="82d6" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在这一系列文章中，我将创建一个软件，尝试使用LSTMs神经网络预测比特币价格。</p><ul class=""><li id="b942" class="lo lp it ku b kv kw ky kz lb lq lf lr lj ls ln lt lu lv lw bi translated">第一部分:我解释了如何下载比特币数据来进行分析</li><li id="b999" class="lo lp it ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">第二部分:使用Q块GPU</li><li id="ae81" class="lo lp it ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">第三部分:创建LSTM神经网络</li><li id="3da9" class="lo lp it ku b kv lx ky ly lb lz lf ma lj mb ln lt lu lv lw bi translated">第四部分:调整网络并比较结果</li></ul><p id="969a" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">为了进行这个实验，我需要高计算能力:神经网络，尤其是大规模的，可能需要几个小时，甚至几天的训练。在我的实验中，我将需要尝试超参数的不同组合(调整)，直到我找到满意的结果。除非我想使用任何免费的GPU笔记本电脑，并等待几天来完成我的实验，否则我将租用GPU来加速这个过程，最多几个小时。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/ca085188d1c0b5d632b51c39ad66d366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NuJ9Lyx_hbW2y83D"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">照片由<a class="ae kr" href="https://unsplash.com/@denarium_bitcoin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿列克西·里斯</a>在<a class="ae kr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="88c7" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">q块</h1><p id="2bf1" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">我将租用的平台叫做Q Blocks。它仍然处于早期访问阶段，所以你甚至可以在购买之前尝试一下(这个平台给你20小时的免费GPU，一个很好的开始)，看看你是否适应它。</p><p id="9d25" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">云计算很快将成为新的规范。有了区块链和像素流技术等革命性创新，人们将不再需要购买GPU硬件。像Q Blocks这样使用对等计算的提供商通过使计算能力更容易获得和加速创新做出了贡献。</p><h2 id="928a" class="np mt it bd mu nq nr dn my ns nt dp nc lb nu nv ne lf nw nx ng lj ny nz ni iz bi translated">GPU是怎么租的？</h2><p id="4872" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">GPU不是用使用量买的，是用时间买的。这项服务每小时只需0.05美元。这是一个非常合理的价格，你基本上是以与CPU相同的成本购买一个GPU。Q Blocks使用的分布式计算技术允许该提供商在不降低质量的情况下保持低价。</p><h2 id="a11b" class="np mt it bd mu nq nr dn my ns nt dp nc lb nu nv ne lf nw nx ng lj ny nz ni iz bi translated">我需要购买GPU来运行这段代码吗？</h2><p id="3ec3" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">不。我所有的代码都可以在免费的笔记本上运行，比如Colab、Jupyter或Kaggle。然而，当您增加模型的复杂性，并且您想要可靠的结果时，您必然想要使用高计算能力。对于我要运行的代码，我强烈建议你租一个GPU，除非你想连续等几天。</p><p id="648f" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">与免费的云编译器的GPU相比，Q块可以达到快10倍的速度。例如，在Google Colab上运行这种算法甚至可能需要一天的连续计算。你可以用更少的时间达到同样的效果，仅仅是因为你有GPU的使用权。</p><h2 id="7cb1" class="np mt it bd mu nq nr dn my ns nt dp nc lb nu nv ne lf nw nx ng lj ny nz ni iz bi translated">设置实例</h2><p id="3b2e" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">创建帐户后，您可以开始创建个性化实例。Q Blocks允许你从大量的图形卡中进行选择。每张显卡都是按块购买的(100块= 0.10美元)。如果你想加速你的模型，你需要一个更强大的图形处理器。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/87d571709c51cc585ad6ff0ee5b2666a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*XicJDxhHnHn8nxbOZsu87g.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">* * *选择TensorFlow V.1.3，否则这段代码不会运行</figcaption></figure><h2 id="a3c6" class="np mt it bd mu nq nr dn my ns nt dp nc lb nu nv ne lf nw nx ng lj ny nz ni iz bi translated">我为什么要租GPU？</h2><p id="2aee" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">LSTMs是人工智能中最麻烦的结构之一。构建模型(尤其是预处理部分)非常具有挑战性，耗时很长，而且并不总是有效的。</p><p id="2b6c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">假设我已经正确地设置了模型，我将需要调整模型。为了达到模型的足够性能(例如最小化MSE ),本质上，我将不得不多次使用变量，直到我找到最佳的超参数。</p><p id="df8c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这将需要多次迭代(多次尝试)。鉴于500个或更多样本的时间序列的LSTM可能需要多达3000个历元，我期待在一个普通的免费笔记本上用各种调整训练我的模型长达24小时或更长时间。</p><p id="582f" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">我唯一能加快这个过程的方法就是租用GPU。AWS可能是您的首选，但相当昂贵。Q Blocks将为您提供低至每小时0.05美元的GPU。</p><h2 id="d4c4" class="np mt it bd mu nq nr dn my ns nt dp nc lb nu nv ne lf nw nx ng lj ny nz ni iz bi translated">创建一个模拟Jupyter笔记本</h2><p id="5d2c" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">(第三部分中有关代码的详细信息)</p><p id="b1bc" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">当激活Q块时，它将允许你以Jupyter笔记本的形式打开你自己的实例。因为实例立即开始消耗GPU，而不是直接在那里编码，所以我要做的是<a class="ae kr" href="https://jupyter.org/try" rel="noopener ugc nofollow" target="_blank">在其他地方</a>创建一个免费的Jupyter笔记本，然后下载笔记本。第二次，我会将笔记本上传到Q Blocks上，以节省宝贵的时间(尤其是如果你运行的是非常昂贵的GPU)。点击描述中的链接访问网站。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ob"><img src="../Images/4f03132e16d7a61b835dc84b94e30977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5imwKAmlpHBGEnCcgjgnwA.png"/></div></div></figure><p id="1e16" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">通过点击尝试JupyterLab，它将允许你在一个新的笔记本上操作。在编写完代码并确保它可以在免费的Jupyter笔记本版本上顺利运行之后，您就可以导出笔记本了。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi oc"><img src="../Images/089a4a95cd3b3e3d6806c1fa8e87c0db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n9biLHo6edldkYGjUoMBOw.png"/></div></div></figure><p id="2387" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在第三部分中，我将介绍构建LSTM的所有代码。通过创建笔记本的副本，您可以轻松地将其导入到另一个Jupyter笔记本中，而无需复制和粘贴任何代码片段或从零开始重新启动。</p><p id="2a56" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">这样会给你一个时间优势，你要用的GPU也会最小化。例如，假设你要使用GTX 180 Ti，每小时0.30美元，你不需要在任何调试上花钱。</p><h2 id="400c" class="np mt it bd mu nq nr dn my ns nt dp nc lb nu nv ne lf nw nx ng lj ny nz ni iz bi translated">保存文件</h2><p id="5dae" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">创建笔记本后，只需将文件保存在桌面上。当然，你可以在我的回购协议上找到这些已经准备好的文件。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b858d67d7025469d3d2cae8e4b7d272e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*ibVcxWPJlifmvutrDFidfw.png"/></div></figure><p id="b632" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">我们准备进入下一部分(III)，我将详细解释如何对整个项目进行编码。在第四部分，我将调整LSTM，看看哪个是最适合的预测。</p><h1 id="6516" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">结论</h1><p id="e7bf" class="pw-post-body-paragraph ks kt it ku b kv nk kd kx ky nl kg la lb nm ld le lf nn lh li lj no ll lm ln im bi translated">与GPU相比，免费的云编译器可以达到快10倍的速度。如果你打算在Q块上租用更强大的GPU，根据你的需求，这个数字只会增加。</p></div></div>    
</body>
</html>