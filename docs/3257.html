<html>
<head>
<title>(Part I) Fostering Criminal Justice with Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">(第一部分)用数据科学促进刑事司法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/fostering-criminal-justice-with-data-science-part-i-be4cabdeb0a1?source=collection_archive---------4-----------------------#2022-10-25">https://pub.towardsai.net/fostering-criminal-justice-with-data-science-part-i-be4cabdeb0a1?source=collection_archive---------4-----------------------#2022-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a8f3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">统一犯罪报告2021 DC逮捕数据的数据驱动分析</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/548943a428744d147cbc0802fdbdbaf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwTzBdBYNQSPdQDnSmnAPg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来源:【NIBRS官方网站</figcaption></figure><p id="b72a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一名犯罪研究人员，我总是对一年内发生多少起犯罪以及在这些犯罪中，有多少是由警察逮捕的这类问题感兴趣。我在这里明确提到逮捕，因为这两个概念是不同的，因为不是所有的犯罪都会导致逮捕。大多数案件根本达不到批准逮捕所需的严重程度，因此我们应该关注执法人员的行为偏差(警务中的种族歧视)，逮捕通常是一个更好的衡量标准。</p><p id="93f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将使用统一犯罪报告(UCR)系统的数据来讲述一个关于2021年在美国首都和政治中心DC被捕的人的故事。我特别关心这三个问题:</p><ul class=""><li id="9775" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">哪个种族、性别或年龄组被大都会警察局的警察逮捕的最重？</li><li id="0aab" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这些逮捕是如何按犯罪类型和武器使用分类的</li><li id="a17a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">某个种族或社会经济群体是否更有可能因某些类型的违法行为而被捕？</li></ul><p id="64d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在回答这些问题的同时，我也将展示我一直倡导的:用数据科学作为理解领域知识的工具。我来自社会科学背景，我对社会科学的兴趣先于我对数据科学的兴趣。因此，我认为数据科学的重要性在于它为研究科学家、决策者和公司提供了工具。数据科学领域的许多人更关心数据算法，而不是数据本身。我认为它们同等重要。</p><h1 id="a4d3" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">什么是UCR，为什么是UCR犯罪数据？</h1><p id="449d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我选择UCR作为我的数据来源是有原因的。当我在明尼苏达大学双城分校读法律社会学、犯罪学和越轨学生时，统一犯罪报告(UCR)数据是我许多主要课程中的常见“客人”，我们许多人将其称为“犯罪研究的圣经”。这并不是说UCR是最好的来源，而是说它是最权威的来源。它的权威性体现在两点:它来自一个高度可信的来源(由FBI收集)，而且它非常全面(包含了无数关于犯罪的信息)。无论研究人员是否关心他们所在州的具体犯罪或逮捕数字，或者过去十年的犯罪趋势，UCR都是他们的首选数据集。</p><p id="e321" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">UCR指的不是单一的数据，而是联邦调查局使用的数据报告系统，由五个以上不同的数据库组成。一些比较著名的数据包括国家基于事件的报告系统、仇恨犯罪统计数据、执法人员被杀和被袭击的数据以及最近的国家使用武力数据收集。UCR系统中的数据来自18，000多个不同级别的学术机构和执法机构，它们自愿报告犯罪信息。</p><p id="300a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们来看看我们的数据。</p><h1 id="6c5a" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">获取数据和设置:提高热度</h1><p id="2ef8" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">2021年DC逮捕数据来自国家基于事件的报告系统(NIBRS)数据库，可以在联邦调查局的<a class="ae kv" href="https://crime-data-explorer.app.cloud.gov/pages/downloads" rel="noopener ugc nofollow" target="_blank">犯罪数据浏览器门户</a>上访问。要下载数据，请转到“各州基于犯罪事件的数据”部分，在下拉列表中选择“DC”和“2021”，然后按“下载”。这会以压缩的形式给你一组相关的数据集和它们的码本，抓捕数据就在其中！</p><p id="000f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在进行真正的数据科学任务之前，先加载库总是一个好习惯。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="336e" class="ni mh iq ne b gy nj nk l nl nm">library(dplyr) # for easy data cleaning and wrangling<br/>library(forcats) # dealing with factor variables<br/>library(stringr) # string manipulations<br/>library(ggplot2) # data visualizations<br/>library(GGally) # an extension of the ggplot2 library<br/>library(lubridate) # dealing with dates and times<br/>library(readr) # reading data<br/>library(kableExtra) # beautiful formatting of tables</span></pre><p id="2942" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要两个数据集:<em class="nn">逮捕</em>数据和<em class="nn">用武器逮捕</em>数据。前者记录逮捕的时间和性质，后者补充前者，增加关于罪犯使用武器的信息。为了连接它们，我们做了一个左连接，在连接过程中保留数据<em class="nn"> x </em>中的所有行(语法:<em class="nn"> left_join(x，y，by = " "</em>)。我将连接的数据集命名为<em class="nn"> dc21_arrests_weapon </em>。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="1e9f" class="ni mh iq ne b gy nj nk l nl nm">dc21_arrests &lt;- read_csv("data/DC2021_NIBRS_ARRESTEE.csv")<br/>dc21_weapon &lt;- read_csv("data/DC2021_NIBRS_ARRESTEE_WEAPON.csv")</span><span id="3be8" class="ni mh iq ne b gy no nk l nl nm">dc21_arrests_weapon &lt;- dc21_arrests %&gt;%<br/>  left_join(<br/>  dc21_weapon, <br/>  by = "arrestee_id")</span></pre><p id="b284" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，<em class="nn"> dc21_weapon </em>中的某些行出现了不止一次，对于这些行，无论连接类型如何，都将在结果数据集中包含重复的行。这可以很容易地用下面的方法来测试(没有警告消息意味着测试通过，即两种情况下呈现相同的输出)。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="c662" class="ni mh iq ne b gy nj nk l nl nm">testthat::expect_equal(dc21_arrests %&gt;% count(arrestee_id) %&gt;% nrow(),<br/>                       dc21_weapon %&gt;% count(arrestee_id) %&gt;% nrow())</span></pre><p id="a730" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们来看看数据里有什么。我们通过检查前五行和浏览变量类型来做到这一点。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="0988" class="ni mh iq ne b gy nj nk l nl nm">dc21_arrests_weapon %&gt;%<br/>  head(5) %&gt;% <br/>  kbl(format="html") %&gt;%<br/>  kable_styling(bootstrap_options = c("striped", <br/>                                      "hover", <br/>                                      "condensed"))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/6ad54680b43d6aa70e7b1f7fe72f94b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HJ8BKWoOoA9hzERAu8DlFw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">我们合并数据框架的一瞥</figcaption></figure><p id="b903" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有很多方法可以检查变量类型。许多人喜欢使用<em class="nn"> glimpse() </em>，因为它与<em class="nn"> tidyverse </em>系统集成得很好。在这里，我使用了base R的<em class="nn"> str() </em>方法，因为我非常喜欢它的布局。这两种方法做的事情非常相似，所以这里没有权衡。你喜欢哪个就用哪个。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="f2a1" class="ni mh iq ne b gy nj nk l nl nm">str(dc21_arrests_weapon)<br/>#dc21_arrests_weapon %&gt;% glimpse() # alternative way</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/5749bf8076be3e7eabececf7dc6adbb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hjJm-ynB_Waf3r7Lev3zMg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">输出的屏幕截图</figcaption></figure><p id="5fdc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们看到数据有4，508行和21列。前者表明在2021年，DC总共有4508起逮捕，而后者告诉我们这个数据中包含了21个变量。大多数是数字，一些是字符串，还有一些是布尔值(<em class="nn"> logi </em>)和数据类型。检查变量类型有助于我们更好地理解我们的数据，并使我们的数据清理更容易。</p><h1 id="287f" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">清理和争论数据:弄脏手</h1><p id="3d10" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">让我们进入数据清理阶段。我认为我真正喜欢数据清理的一个原因是它非常有逻辑性和系统性。当我们发现未使用的变量时，我们丢弃它们，如果有什么不对，我们用尽可能多的步骤和尽可能少的步骤操纵和操作它们。我们也一步一步地清理数据，在一步之后，我们回头看看我们做得对不对。事实上，我们需要不断回头看，并对我们以前的代码进行更改，以确保我们不会偏离正确的轨道。这种思维模式还将帮助我们(新兴或有经验的)数据科学家更熟悉并更好地理解我们的数据。</p><p id="bde1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对我来说，数据清洗实际上让我进入了数据科学领域。当我在本科学习R编程作为一个统计专业(我追求两个专业)时，没有关于<em class="nn"> dplyr </em>或<em class="nn"> ggplot2 </em>的课，我在从事一个数据科学项目时，在两周内学会了如何自己清理数据。一开始并不容易，因为<em class="nn"> tidyverse </em>语法与base R非常不同，然而，我用得越多，就越发现自己对它上瘾。正如我所说，我来自一个研究背景，所以tidyverse框架内部的问题驱动思维模式对我来说是如此自然和直观，这让我几乎瞬间爱上了做数据清理。</p><h2 id="a639" class="ni mh iq bd mi nr ns dn mm nt nu dp mq lf nv nw ms lj nx ny mu ln nz oa mw ob bi translated">选择感兴趣的变量</h2><p id="8ef0" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">回到我们的数据，在最激动人心的部分——探索性数据分析之前，我们需要做一些事情。我们需要去掉不必要的变量，这样我们的数据就只抓住了我们分析的要点。如果我们的数据有几百列，这一点尤其重要，这在公共和非营利部门很常见。对于我们正在分析的这个，有21个变量，这是一个适中的数字，所以数据选择是不必要的，但这样做也无妨。然而，我们必须小心，确保我们没有过滤掉我们实际需要的变量。要做到这一点，通常需要查找代码簿或在线代码文档页面，以确保我们不会主观地解释变量。NIBRS数据集的密码本可以在我们下载数据的同一页面上找到，或者在这里访问<a class="ae kv" href="https://s3-us-gov-west-1.amazonaws.com/cg-d4b776d0-d898-4153-90c8-8336f86bdfec/NIBRS_DataDictionary.pdf" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="e020" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这21个变量中，我们发现<em class="nn">逮捕_id，事件_id，被逮捕者_sql_num </em>都用于识别逮捕/被逮捕者，变量<em class="nn">年龄_id，年龄_num，18岁以下_处置_代码，年龄_范围_低_数量，年龄_范围_高_数量</em>都代表被逮捕者的年龄(我们在这里有变量变化，因为青少年经过不同的起诉系统，并且通常与成年人分开编码以保护他们的隐私)。此外，还有一些变量与我们的主题无关，因此被过滤掉了。</p><p id="7381" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果是我们只保留了8个变量。我还重命名了这些变量，使它们的名称更能反映它们的含义。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="2947" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21_arrests_weapon %&gt;%<br/>  select(data_year.x, arrest_date, arrest_type_id, offense_code, <br/>         age_id, sex_code, race_id, weapon_id) %&gt;%<br/>  rename(year = data_year.x, <br/>         date = arrest_date,<br/>         arrest_type = arrest_type_id,<br/>         offense = offense_code, <br/>         age = age_id,<br/>         sex = sex_code,<br/>         race = race_id,<br/>         weapon = weapon_id)</span></pre><h2 id="8fc9" class="ni mh iq bd mi nr ns dn mm nt nu dp mq lf nv nw ms lj nx ny mu ln nz oa mw ob bi translated">变量操作</h2><p id="d570" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">现在，注意到<em class="nn">种族</em>、<em class="nn">逮捕_类型</em>和<em class="nn">武器</em>都用数字标注，这是数据输入中的常见做法。但是，如果不参考码本，很难知道每个数字是什么意思。因此，让我们做一些重新编码，从变量<em class="nn"> race </em>开始。</p><p id="71ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过一些简单的操作，我们发现种族有6个类别，其中类别30、40和50有20个以下的逮捕案例。因为与其他种族群体相比，他们的数量很少，所以我们可以将他们结合在一起。第98类代表种族信息未知的被捕者，要么是因为警官忘记写下来(这种情况时有发生！)或其他原因而被退学。</p><p id="8f23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用<strong class="ky ir">预测</strong>包中的函数来简化任务</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="0d57" class="ni mh iq ne b gy nj nk l nl nm">dc21 %&gt;%<br/>  count(race) # see what racial groups we have</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/905d774d0b00e3a2821aa9b62d59816f.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*ZPsDYRKW8KuPjNkTZVaxRg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">count()是执行group_by()和summarise()的快捷方式</figcaption></figure><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="84e0" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  filter(!race == "98") %&gt;%<br/>  mutate(race = factor(race)) %&gt;%<br/>  mutate(race = fct_collapse(race,<br/>    White = "10",<br/>    `Black or African American` = "20",<br/>    `Asian` = "40",<br/>    `American Indian or Pacific Islander` = c("30","50")<br/>  )) %&gt;%<br/>  mutate(race = fct_relevel(race,  # relevel<br/>                            "Black or African American",<br/>                            after = 1)) %&gt;%<br/>   mutate(race = fct_relevel(race,  # relevel<br/>                            "Asian",<br/>                            after = 2))</span></pre><p id="8e7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对变量<em class="nn">武器</em>和<em class="nn">性别</em>重复上述过程。对于<em class="nn">性</em>，我们需要的只是重命名因子。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="b286" class="ni mh iq ne b gy nj nk l nl nm">dc21 %&gt;%<br/>  count(weapon)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/bc6b4fc9cee68b51688b57def4b90b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*ts34l4Be9hvc55Nj3uhiUg.png"/></div></figure><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="ad6e" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  mutate(weapon = factor(weapon)) %&gt;%<br/>  mutate(weapon = fct_collapse(weapon,<br/>    Unarmed = "51",<br/>    `Firearm-involved` = c("1", "3", "4", "5", "6", "7", "9"),<br/>    `Weapon with a blade` = c("52", "53")<br/>  )) %&gt;%<br/>  mutate(weapon = fct_relevel(weapon,  <br/>                            "Firearm-involved",<br/>                            after = 1))</span></pre><p id="1b2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nn"> fct_recode </em>函数提供了一个重新编码因子等级的简单解决方案。或者，您可以使用base R的<em class="nn"> recode </em>函数来做同样的事情。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="a8d7" class="ni mh iq ne b gy nj nk l nl nm">dc21$sex = fct_recode(dc21$sex, Male = "M", Female = "F")</span></pre><p id="002f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于<em class="nn">进攻</em>，我们需要有一些额外的考虑。我注意到大多数犯罪类别由两部分组成:一个两位数的数字和一个字母。这两个部分分别代表第一组和第二组罪行。例如，13代表殴打，13后面的A、B和C指定殴打的类型和程度，因此13A代表严重殴打，而13B代表简单殴打。这种分类方法具有重要的法律和政策意义。我们还可以利用这种分类方法来减少我们的工作量。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="b768" class="ni mh iq ne b gy nj nk l nl nm">dc21 %&gt;%<br/>  count(offense)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/925bb452b55f4ea36851f6aefb141071.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*GxMNZ-8QaTSLohIZT6AgUw.png"/></div></figure><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="611d" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  mutate(offense = factor(offense)) %&gt;%<br/>  mutate(offense = fct_collapse(offense,<br/>    `Murder and Nonnegligent Manslaughter` = "09A",<br/>    `Aggravated Assault` = "13A",<br/>    `Assault or Intimidation` = c("13B", "13C"),<br/>    `Sexual Assault or Rape` = c("11A", "11C", "11D"),<br/>    `Robbery` = c("120"),<br/>    `Arson and Kidnapping/Abduction` = c("100", "200"),<br/>   `Burglary or Trespassing` = c("220", "90J"),<br/>   `Theft, Auto-theft, and Larceny` = c("23A", "23B", "23C", "23D", "23F", <br/>                                        "23G","23H", "240"),<br/>   `Fraud` = c("26A", "26C", "26D", "26E", "26F", "26G"),<br/>   `Drug-related` = c("35A", "35B"),<br/>   `Property Destruction` = c("250", "280", "290"),<br/>   `Crime against sociey` = c("370","39A", "520", "90Z")<br/>  ))</span></pre><p id="688d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据犯罪对象，上述12种犯罪类型可以大致分为四类:暴力犯罪(或对人犯罪)、财产犯罪(对财产犯罪)和其他犯罪(毒品犯罪和危害社会犯罪)。这种分类方法遵循刑法中对犯罪的定义，是执法机构常用的方法。为了重新衡量，我们把这个新变量作为一个因素。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="5b14" class="ni mh iq ne b gy nj nk l nl nm">Violent_crimes &lt;- c("Murder and Nonnegligent Manslaughter",<br/>    "Aggravated Assault",<br/>    "Assault or Intimidation",<br/>    "Sexual Assault or Rape",<br/>    "Robbery",<br/>    "Arson and Kidnapping/Abduction")<br/>   <br/>Property_crimes &lt;- c("Burglary or Trespassing", <br/>                      "Theft, Auto-theft, and Larceny", <br/>                      "Fraud", <br/>                      "Property Destruction")</span><span id="6f0b" class="ni mh iq ne b gy no nk l nl nm">Drug_crimes = c("Drug-related")<br/>Crime_sociey = c("Crime against sociey")</span><span id="45e6" class="ni mh iq ne b gy no nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  mutate(offense_group = case_when(<br/>    offense %in% Violent_crimes ~ "Violent Crimes",<br/>    offense %in% Property_crimes ~ "Property Crimes",<br/>    offense %in% Drug_crimes ~ "Drug Crimes",<br/>    offense %in% Crime_sociey ~ "Crime Against Society"<br/>  )) %&gt;%<br/>  mutate(offense_group = fct_relevel(offense_group,<br/>                                     c("Violent Crimes",<br/>                                       "Property Crimes",<br/>                                       "Drug Crimes",<br/>                                       "Crime Against Society")<br/>                                     ))</span></pre><p id="066d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">剩下的几个变量有点棘手。对于<em class="nn">日期</em>，知道逮捕发生在哪一天没有什么意义，相反，知道月份可以提供一些见解。由于<em class="nn">日期</em>属于自己的类型(默认情况下，R将所有与日期/时间相关的变量都设为POSIXIt格式)，我们使用<em class="nn"> lubridate </em>包中的函数来进行转换。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="87f8" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  mutate(month = month(date, label = TRUE), <br/>         .after = date) # add label = T makes month a ordered factor</span></pre><p id="cd36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于<em class="nn"> arrest_type </em>，该变量代表被捕者处于逮捕的哪个阶段。具体来说，有些人被逮捕了，有些人在等待法院的传唤，有些人被拘留了(用专业术语来说，这些都是“刑事司法漏斗”中的阶段)。因为它代表三个停止阶段，我们需要使它成为一个分类变量。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="1d70" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  mutate(arrest_type = factor(arrest_type)) %&gt;%<br/>  mutate(arrest_type = fct_recode(arrest_type, <br/>                                `On View`  = "1", <br/>                                `Summoned/Cited` = "2",<br/>                                `Custodied` = "3"))<br/>#On View: arresting based on observations in lieu of written probable cause</span></pre><p id="535b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，对于<em class="nn">年龄</em>，我们可以保留它(适用于柱状图或面积图)或使用它来创建一个新的变量age_group(适用于柱状图、折线图等)。)，具体取决于数据科学家的偏好和/或分析目的。这里，我采用后一种方法。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="54d5" class="ni mh iq ne b gy nj nk l nl nm">dc21 &lt;- dc21 %&gt;%<br/>  mutate(age_group = case_when(<br/>    age &lt; 20 ~ "Under 20",<br/>    age &lt; 30 &amp; age &gt;=20 ~ "20-29",<br/>    age &gt;=30 &amp; age &lt;40 ~ "30-39",<br/>    age &gt;= 40 &amp; age &lt; 50 ~ "40-49",<br/>    age &gt;= 50 ~ "50 or above"<br/>  )) %&gt;%<br/>  mutate(age_group = factor(age_group, <br/>                            levels = c("Under 20", "20-29", "30-39",<br/>                                       "40-49", "50 or above"))) %&gt;%<br/>  relocate(age_group, .after = age)</span></pre><h2 id="9f1d" class="ni mh iq bd mi nr ns dn mm nt nu dp mq lf nv nw ms lj nx ny mu ln nz oa mw ob bi translated">最终检查:操作后是否出现任何丢失的数据？</h2><p id="5c7d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">现在我们已经完成了数据争论，但是在我们进入数据探索之前，让我们确保我们没有遗漏任何值。我们可以通过检查没有丢失数据来做到这一点。</p><pre class="kg kh ki kj gt nd ne nf ng aw nh bi"><span id="a543" class="ni mh iq ne b gy nj nk l nl nm">colSums(is.na(dc21))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/a4023c14df9d3ef410c23aee9c01d9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnfCJOoS52WjQRmks3I-IQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">按列列出的缺失值的概要表</figcaption></figure><p id="322c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看起来我们在前面的步骤中没有犯错误。干得好！这是我们最终的数据。你觉得怎么样？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/f58a3aaa0b168cb54b5b0e947f63f1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xP1QA0qrJs4_PgXWiPt7gw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">最终数据</figcaption></figure><h1 id="96fd" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">接下来</h1><p id="eec3" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">在下一节中，我们将重点关注使用探索性数据分析(EDA)工具来检查我们的数据，并回答我在本文开始时提出的问题。我们还将讨论数据讲故事——使用数据讲述故事的艺术。敬请期待！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/8fc664ca9f9f7ba952037aa4289d7a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-_bF7W6MRgX7J3620DlJA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">我们下一部分的额外津贴！</figcaption></figure><p id="d697" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="nn">注:</em> </strong> <em class="nn">博客原创使用Quarto，新时代Rmarkdown，所有代码可在</em> <a class="ae kv" href="https://github.com/jcvincentliu/data-blogging/blob/main/UCR%202021%20DC%20Arrest%20Data%20Analysis.qmd" rel="noopener ugc nofollow" target="_blank"> <em class="nn">我的GitHub资源库</em> </a> <em class="nn">找到。</em></p><p id="6ccf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于我自己的更多信息，请随时查看我的<a class="ae kv" href="https://www.linkedin.com/in/jcvincentliu/" rel="noopener ugc nofollow" target="_blank"> LinkedIn页面</a>或我的<a class="ae kv" href="https://jcvincentliu.netlify.app" rel="noopener ugc nofollow" target="_blank">个人网站</a>。</p></div></div>    
</body>
</html>