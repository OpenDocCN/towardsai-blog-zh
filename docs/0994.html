<html>
<head>
<title>Product Recommendation based on Visual Similarity on the web: Machine Learning / Data Science/ Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于网页视觉相似性的产品推荐:机器学习/数据科学/深度学习</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/product-recommendation-based-on-visual-similarity-on-the-web-machine-learning-project-end-to-end-6d38d68d414f?source=collection_archive---------0-----------------------#2020-10-02">https://pub.towardsai.net/product-recommendation-based-on-visual-similarity-on-the-web-machine-learning-project-end-to-end-6d38d68d414f?source=collection_archive---------0-----------------------#2020-10-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f593" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/c7beb8a7f6c6570cb08f25812d849010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Owpm0FI51WKilKVCL62NAA.jpeg"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">推荐系统</figcaption></figure><p id="de55" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">众所周知，谷歌、亚马逊、网飞等大型科技公司正在使用推荐系统，根据我们的观察名单提供推荐，他们正通过这些技术获得大量利润…</p><p id="ac31" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">根据麦肯锡最近的一项研究，消费者在网飞上观看的节目中，高达75%来自该公司的推荐系统，这不仅是因为消费者发现了更多的节目，而且推荐系统可以为该公司节省大量营销资金</p><blockquote class="lm ln lo"><p id="2e3b" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">我们将在本文中涉及的内容</strong></p></blockquote><ol class=""><li id="d21d" class="lt lu it kq b kr ks kv kw kz lv ld lw lh lx ll ly lz ma mb bi translated">什么是推荐系统？</li><li id="6850" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll ly lz ma mb bi translated">推荐系统的类型。</li><li id="5cd6" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll ly lz ma mb bi translated">什么是视觉相似？</li><li id="a7a8" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll ly lz ma mb bi translated">如何实现一个基于视觉相似性的推荐系统(Python)？</li><li id="def1" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll ly lz ma mb bi translated">使用Streamlit在web上实现。</li></ol><blockquote class="lm ln lo"><p id="089f" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">那么让我们开始:</strong></p></blockquote><p id="831f" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在了解更多细节之前，如果你想看最终结果，请查看我的YouTube视频👉:-  <a class="ae mh" href="https://www.youtube.com/watch?v=JzEzBYtjBsE&amp;t=68s&amp;ab_channel=HimanshuTripathi" rel="noopener ugc nofollow" target="_blank"> <strong class="kq jd"> YouTube </strong> </a></p><blockquote class="lm ln lo"><p id="23e7" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">什么是推荐系统？</strong></p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mi"><img src="../Images/26b23770f659d0c3edc10d2f3813a898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TVhjMgHdaPCi-qsP.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">大型科技公司</figcaption></figure><p id="92fa" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一个<strong class="kq jd">推荐系统</strong>，或者一个<strong class="kq jd">推荐系统</strong>(有时用一个同义词如一个平台或者一个<strong class="kq jd">引擎</strong>来代替<strong class="kq jd">系统</strong>)，是一个信息过滤<strong class="kq jd">系统</strong>的子类，它试图预测一个用户对一个项目的“评分”或者“偏好”。</p><p id="6d4d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">推荐系统通过基于用户提供的数据和照顾用户偏好和兴趣的其他因素过滤最重要的信息来处理大量存在的信息。它找出用户和项目之间的匹配，并估算出用户和项目之间的相似度以进行推荐。</p><p id="2121" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">用户和所提供的服务都从这类系统中受益。通过这些系统，质量和决策过程也得到改善。</p><blockquote class="lm ln lo"><p id="5952" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated">为什么推荐系统很重要？</p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mn"><img src="../Images/f8cab9f612ea8678ddcd21b5fd072499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QY4lJoQfHHWT2Ov_.jpeg"/></div></div></figure><ul class=""><li id="e544" class="lt lu it kq b kr ks kv kw kz lv ld lw lh lx ll mo lz ma mb bi translated">帮助用户找到他们感兴趣的项目。</li><li id="24b3" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">帮助物品供应商将物品交付给正确的用户。</li><li id="7c27" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">识别与用户最相关的产品。</li><li id="05cd" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">个性化内容。</li><li id="c3f4" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">帮助网站提高用户参与度。</li></ul><blockquote class="lm ln lo"><p id="c2aa" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">有什么可以推荐的？</strong></p></blockquote><p id="e61a" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">系统可以推荐许多不同的东西，如电影、书籍、新闻、文章、工作、广告等。网飞使用推荐系统向用户推荐电影和网络系列。同样，YouTube推荐不同的视频。现在有许多广泛使用的推荐系统的例子。</p><blockquote class="lm ln lo"><p id="a31c" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">推荐系统的类型。</strong></p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mi"><img src="../Images/340a299a2b723789a11914ba2336f201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1mdmVjmD8yo3ATeJ.png"/></div></div></figure><h1 id="4141" class="mp mq it bd mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm bi translated">1.基于流行度的推荐系统</h1><p id="56f4" class="pw-post-body-paragraph ko kp it kq b kr nn kt ku kv no kx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">这是一种推荐系统，它的工作原理是流行或任何流行的东西。这些系统检查流行的或最受用户欢迎的产品或电影，并直接推荐它们。</p><p id="12e0" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">例如，如果一个产品经常被大多数人购买，那么系统将知道该产品是最受欢迎的，因此对于每个刚刚签署该产品的新用户，系统也将向该用户推荐该产品，并且新用户也将购买该产品的机会变高。</p><h2 id="76dd" class="ns mq it bd mr nt nu dn mv nv nw dp mz kz nx ny nd ld nz oa nh lh ob oc nl iz bi translated">优点</h2><ul class=""><li id="272b" class="lt lu it kq b kr nn kv no kz od ld oe lh of ll mo lz ma mb bi translated">它没有冷启动问题，这意味着在业务的第一天，它还可以推荐各种不同过滤器的产品。</li><li id="c700" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">不需要用户的历史数据。</li></ul><h2 id="89d0" class="ns mq it bd mr nt nu dn mv nv nw dp mz kz nx ny nd ld nz oa nh lh ob oc nl iz bi translated">缺点</h2><ul class=""><li id="c346" class="lt lu it kq b kr nn kv no kz od ld oe lh of ll mo lz ma mb bi translated">不个性化</li><li id="3f71" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">该系统将向每个其他用户推荐完全基于受欢迎程度的同类产品/电影。</li></ul><h2 id="8d62" class="ns mq it bd mr nt nu dn mv nv nw dp mz kz nx ny nd ld nz oa nh lh ob oc nl iz bi translated">例子</h2><ul class=""><li id="301f" class="lt lu it kq b kr nn kv no kz od ld oe lh of ll mo lz ma mb bi translated">谷歌新闻:通过趋势和最受欢迎的新闻过滤的新闻。</li><li id="1749" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">YouTube:趋势视频。</li></ul><h1 id="b3e1" class="mp mq it bd mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm bi translated">2.基于内容的推荐系统</h1><p id="0641" class="pw-post-body-paragraph ko kp it kq b kr nn kt ku kv no kx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">这是另一种基于相似内容原理的推荐系统。如果用户正在观看电影，则系统将检查与用户正在观看的电影内容相似或类型相同的其他电影。在检查相似内容时，有各种用于计算相似性的基本属性。</p><p id="a27a" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">基于内容的系统使用不同类型的方法来获得相似性</p><ul class=""><li id="f194" class="lt lu it kq b kr ks kv kw kz lv ld lw lh lx ll mo lz ma mb bi translated">欧几里得距离</li><li id="eadb" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">余弦相似度(我们将使用余弦相似度矩阵)</li><li id="d197" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">雅克卡相似性</li></ul><h1 id="5a59" class="mp mq it bd mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm bi translated">3.协同过滤</h1><p id="01e2" class="pw-post-body-paragraph ko kp it kq b kr nn kt ku kv no kx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">它被认为是非常智能的推荐系统之一，可以处理不同用户之间的相似性，也可以广泛用于电子商务网站和在线电影网站。它会检查相似用户的口味并进行推荐。</p><p id="47ad" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">相似性不限于用户的喜好，此外，还可以考虑不同项目之间的相似性。如果我们有大量关于用户和项目的信息，系统会给出更有效的推荐。</p><p id="8e68" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">协同过滤主要使用两种方法</p><ul class=""><li id="158e" class="lt lu it kq b kr ks kv kw kz lv ld lw lh lx ll mo lz ma mb bi translated">基于用户的最近邻协同过滤</li><li id="5bf2" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated">基于项目的最近邻协同过滤</li></ul><blockquote class="lm ln lo"><p id="ce3a" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">什么是视觉相似？</strong></p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi og"><img src="../Images/859f9c54424957edaacee0d6b30b40b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H7MQ5Umb5fGgEVER.jpg"/></div></div></figure><p id="2acf" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">视觉相似性检索“看起来相似”的图像，而不管图像内容如何。检索到的图像与选择的图像具有相似的视觉属性，例如可比较的颜色、纹理和形状。</p><p id="6ae2" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了获得图像的视觉相似性，我们将使用CNN并提取图像特征</p><blockquote class="lm ln lo"><p id="d2ef" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">如何实现基于视觉相似度的推荐系统(Python)。</strong></p></blockquote><p id="c4d0" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">基于视觉相似度的产品推荐</strong></p><p id="4627" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个实验的目标是做一个非常基本的推荐系统:对于一个给定的时尚产品，我们想要推荐看起来相似的产品。</p><p id="0fb6" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这种推荐系统经常在浏览购物网站时使用。它们通常出现在产品页面上，就像“你可能也会喜欢”部分。</p><p id="02c5" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这种推荐系统背后的想法很简单:如果一个顾客通过浏览一个产品的页面表现出对该产品的兴趣，他也可能对类似的副产品感兴趣。</p><blockquote class="lm ln lo"><p id="5b62" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">如何进行？</strong></p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oh"><img src="../Images/4255147ee13e752365dc6e30718fcd4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*taFS2n0ry_cAAVy7.jpg"/></div></div></figure><p id="9220" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将使用来自Keras的预训练CNN模型来提取图像特征。然后，我们将使用先前提取的图像特征来计算不同产品之间的相似性。</p><blockquote class="lm ln lo"><p id="52ff" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">第一步:</strong></p></blockquote><p id="d222" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">下载数据集:</strong></p><p id="48be" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将使用“风格彩色图像数据集”。我们可以从“Kaggle”下载数据集</p><p id="7e27" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">数据集:——<a class="ae mh" href="https://www.kaggle.com/olgabelitskaya/style-color-images" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/olgabelitskaya/style-color-images</a></p><blockquote class="lm ln lo"><p id="a622" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">第二步:</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="3a97" class="ns mq it oj b gy on oo l op oq"># imports<br/>from keras.applications import vgg16<br/>from keras.preprocessing.image import load_img,img_to_array<br/>from keras.models import Model<br/>from keras.applications.imagenet_utils import preprocess_input<br/>from PIL import Image<br/>import os<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>from sklearn.metrics.pairwise import cosine_similarity<br/>import pandas as pd</span></pre><blockquote class="lm ln lo"><p id="bf26" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #参数设置</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="2582" class="ns mq it oj b gy on oo l op oq"># parameters setup</span><span id="2fac" class="ns mq it oj b gy or oo l op oq">imgs_path = "/content/data/style"</span><span id="9629" class="ns mq it oj b gy or oo l op oq">imgs_model_width, imgs_model_height = 224, 224</span><span id="798d" class="ns mq it oj b gy or oo l op oq">nb_closest_images = 5 # number of most similar images to retrieve</span></pre><blockquote class="lm ln lo"><p id="95aa" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #从Keras加载VGG预训练模型</strong></p></blockquote><p id="d525" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Keras模块包含几个预训练的模型，可以很容易地加载。对于我们基于视觉相似性的推荐系统，我们需要加载一个卷积神经网络(CNN)来解释图像内容。在这个例子中，我们将加载在imagenet上训练的VGG16模型，imagenet是一个大的带标签的图像数据库。如果我们采用整个模型，我们将得到一个包含属于某些类的概率的输出，但这不是我们想要的。我们希望检索模型能够从图像中获得的所有信息。为了做到这一点，我们必须删除CNN的最后几层，它们只用于类别预测。</p><blockquote class="lm ln lo"><p id="65d8" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #加载模型</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="a01b" class="ns mq it oj b gy on oo l op oq"># load the model<br/>vgg_model = vgg16.VGG16(weights='imagenet')</span><span id="eb05" class="ns mq it oj b gy or oo l op oq"># remove the last layers in order to get features instead of predictions<br/>feat_extractor = Model(inputs=vgg_model.input,<br/>outputs=vgg_model.get_layer("fc2").output)</span><span id="5681" class="ns mq it oj b gy or oo l op oq"># print the layers of the CNN<br/>feat_extractor.summary()</span></pre><blockquote class="lm ln lo"><p id="6d79" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #获取图像路径:</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="7d56" class="ns mq it oj b gy on oo l op oq">files = []<br/>for x in os.listdir(imgs_path):<br/>    if 'png' in x:<br/>        # print(x)<br/>        files.append(f"{imgs_path}/{x}")<br/>        # break</span></pre><blockquote class="lm ln lo"><p id="3580" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #将一幅图像输入CNN </strong></p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oh"><img src="../Images/5739d7834113e716412ef35a5de8bbd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Go367Chvr8h4tZr2"/></div></div></figure><p id="cd44" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">首先，我们观察当把一个图像放入CNN时我们得到什么输出。</p><p id="efa5" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">以下步骤是:</strong></p><ul class=""><li id="349b" class="lt lu it kq b kr ks kv kw kz lv ld lw lh lx ll mo lz ma mb bi translated"><strong class="kq jd">加载图像</strong></li><li id="95e4" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated"><strong class="kq jd">准备将图像输入CNN </strong></li><li id="d4b1" class="lt lu it kq b kr mc kv md kz me ld mf lh mg ll mo lz ma mb bi translated"><strong class="kq jd">获取与图像特征相对应的CNN输出</strong></li></ul><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="0063" class="ns mq it oj b gy on oo l op oq"># load an image in PIL format<br/>original = load_img(files[1],target_size=(imgs_model_width,                           imgs_model_height))<br/>plt.imshow(original)<br/>plt.show()<br/>print("image loaded successfully!")</span></pre><blockquote class="lm ln lo"><p id="cb42" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #一个图像的特征提取</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="1324" class="ns mq it oj b gy on oo l op oq"># in PIL - image is in (width, height, channel)<br/># in Numpy - image is in (height, width, channel)<br/>numpy_image = img_to_array(original)</span><span id="a209" class="ns mq it oj b gy or oo l op oq"># convert the image / images into batch format<br/># expand_dims will add an extra dimension to the data at a particular axis<br/># we want the input matrix to the network to be of the form (batchsize, height, width, channels)<br/># thus we add the extra dimension to the axis 0.</span><span id="d7e1" class="ns mq it oj b gy or oo l op oq">image_batch = np.expand_dims(numpy_image, axis=0)<br/>print('image batch size', image_batch.shape)</span><span id="806b" class="ns mq it oj b gy or oo l op oq"># prepare the image for the VGG model<br/>processed_image = preprocess_input(image_batch.copy())</span></pre><blockquote class="lm ln lo"><p id="fc44" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #把所有的图像输入CNN </strong></p></blockquote><p id="11de" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们能够对一幅图像进行特征提取。现在让我们为我们所有的图像这样做！</p><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="0e43" class="ns mq it oj b gy on oo l op oq"># load all the images and prepare them for feeding into the CNN</span><span id="484b" class="ns mq it oj b gy or oo l op oq">importedImages = []</span><span id="44b7" class="ns mq it oj b gy or oo l op oq">for f in files:<br/>    filename = f<br/>    original = load_img(filename, target_size=(224, 224))<br/>    numpy_image = img_to_array(original)<br/>    image_batch = np.expand_dims(numpy_image, axis=0)<br/>    importedImages.append(image_batch)</span><span id="e9d2" class="ns mq it oj b gy or oo l op oq">images = np.vstack(importedImages)<br/>processed_imgs = preprocess_input(images.copy())</span></pre><blockquote class="lm ln lo"><p id="b259" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #提取图片特征</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="ba0e" class="ns mq it oj b gy on oo l op oq">imgs_features = feat_extractor.predict(processed_imgs)<br/>print("features successfully extracted!")<br/>imgs_features.shape</span></pre><blockquote class="lm ln lo"><p id="f56a" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #计算余弦相似度</strong></p></blockquote><p id="da25" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在我们有了每幅图像的特征，我们可以计算每对图像之间的相似性度量。</p><p id="4a39" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">我们将在这里使用余弦相似性度量。</strong></p><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="2b85" class="ns mq it oj b gy on oo l op oq"># compute cosine similarities between images<br/>cosSimilarities = cosine_similarity(imgs_features)</span><span id="b48f" class="ns mq it oj b gy or oo l op oq"># store the results into a pandas dataframe<br/>cos_similarities_df = pd.DataFrame(cosSimilarities,</span><span id="8052" class="ns mq it oj b gy or oo l op oq">columns=files, index=files)<br/>cos_similarities_df.head()</span></pre><blockquote class="lm ln lo"><p id="409d" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">将预处理数据集保存为csv文件，以便我们以后使用</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="b708" class="ns mq it oj b gy on oo l op oq">cos_similarities_df.to_csv("model.csv")</span></pre><blockquote class="lm ln lo"><p id="d28c" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #检索最相似产品</strong></p></blockquote><p id="fb9d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">最后一步是实现一个函数，对于任何给定的产品，返回视觉上最相似的产品。</strong></p><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="62a1" class="ns mq it oj b gy on oo l op oq">def retrieve_most_similar_products(given_img):<br/>    print("-"*50)<br/>    print("original product:")<br/>    original = load_img(given_img, target_size=(imgs_model_width,      imgs_model_height))<br/>    plt.imshow(original)<br/>    plt.show()</span><span id="2829" class="ns mq it oj b gy or oo l op oq">    print("-"*50)<br/>    print("most similar products:")</span><span id="b762" class="ns mq it oj b gy or oo l op oq">    closest_imgs = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1].index<br/>    closest_imgs_scores = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1]</span><span id="898b" class="ns mq it oj b gy or oo l op oq">    for i in range(0,len(closest_imgs)):<br/>        original = load_img(closest_imgs[i], target_size=(imgs_model_width, imgs_model_height))<br/>        plt.imshow(original)<br/>        plt.show()<br/>        print("similarity score : ",closest_imgs_scores[i])</span></pre><blockquote class="lm ln lo"><p id="2b0b" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">使用Streamlit在web上实现。</strong></p></blockquote><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mi"><img src="../Images/8ee6a984da5d8c1436565254d18bc921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OS0HKsuJNovEHXHS.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">细流</figcaption></figure><p id="9342" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">制作好预处理的CSV文件和数据源后，我们的文件目录看起来是这样的:</strong></p><figure class="mj mk ml mm gt kd gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d5da1ee576a9a50d1d112373ffd5094c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/0*ySZv2qmnWq301gDG"/></div></figure><p id="1899" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">内容:- </strong>是数据文件(图片)</p><p id="4a88" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd"> Main:- </strong>运行应用程序的主文件(streamlit)</p><p id="8ce7" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">模型:- </strong>预处理后的CSV文件</p><blockquote class="lm ln lo"><p id="bd0d" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">第一步:</strong></p><p id="5248" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #安装流线</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="aa90" class="ns mq it oj b gy on oo l op oq"><strong class="oj jd">pip install streamlit</strong></span></pre><blockquote class="lm ln lo"><p id="b996" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">第二步:</strong></p><p id="5662" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #导入必要的库</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="7746" class="ns mq it oj b gy on oo l op oq"><strong class="oj jd">import streamlit as st<br/>from tensorflow.keras.applications import vgg16<br/>from tensorflow.keras.preprocessing.image import load_img,img_to_array<br/>from tensorflow.keras.models import Model<br/>from tensorflow.keras.applications.imagenet_utils import preprocess_input</strong></span><span id="5f40" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">from PIL import Image<br/>import os<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>from sklearn.metrics.pairwise import cosine_similarity<br/>import pandas as pd</strong></span></pre><blockquote class="lm ln lo"><p id="6ec6" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #设定图像宽度和图像高度</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="310a" class="ns mq it oj b gy on oo l op oq"><strong class="oj jd">imgs_model_width, imgs_model_height = 224, 224</strong></span><span id="c7e9" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">nb_closest_images = 5</strong></span></pre><blockquote class="lm ln lo"><p id="bf33" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #加载CSV文件</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="6ea9" class="ns mq it oj b gy on oo l op oq"><strong class="oj jd">@st.cache<br/>def load_data():<br/>    df = pd.read_csv('model.csv')<br/>    df.set_index("Unnamed: 0", inplace=True)<br/>    return df</strong></span></pre><blockquote class="lm ln lo"><p id="8237" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #检索产品(主要功能)</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="b8bc" class="ns mq it oj b gy on oo l op oq"><strong class="oj jd">def retrieve_most_similar_products(given_img,df):<br/>    st.write("-"*50)<br/>    st.success("original product:")</strong></span><span id="c153" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">    original = load_img(given_img, target_size=(imgs_model_width,  imgs_model_height))<br/>    plt.imshow(original)<br/>    st.pyplot()</strong></span><span id="40e7" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">    st.write("-"*50) <br/>    st.error("most similar products:")<br/>    given_img = "/"+given_img<br/>    closest_imgs = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1].index<br/>    closest_imgs_scores = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1]<br/>    # st.write(closest_imgs[1][1:])<br/>    for i in range(0,len(closest_imgs)):<br/>        original = load_img(closest_imgs[i][1:], target_size=(imgs_model_width, imgs_model_height))<br/>        plt.imshow(original)<br/>        st.write("Simillarity",closest_imgs_scores[i])<br/>        st.pyplot()<br/>        plt.show()</strong></span></pre><blockquote class="lm ln lo"><p id="9a94" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #用于加载图像</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="848e" class="ns mq it oj b gy on oo l op oq"><a class="ae mh" href="http://twitter.com/st" rel="noopener ugc nofollow" target="_blank"><strong class="oj jd">@st</strong></a><strong class="oj jd">.cache()<br/>def names():<br/>    list_data = os.listdir('content/data/style')<br/>   <br/>    return list_data</strong></span></pre><blockquote class="lm ln lo"><p id="b665" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd"> #主要功能</strong></p></blockquote><pre class="mj mk ml mm gt oi oj ok ol aw om bi"><span id="8752" class="ns mq it oj b gy on oo l op oq"><strong class="oj jd">def main():<br/>    st.sidebar.title("Himanshu Tripathi")<br/>    <br/>    st.sidebar.subheader('A recommender system, or a recommendation system, is a subclass of information filtering system that seeks to predict the "rating" or "preference" a user would give to an item. They are primarily used in commercial applications.')</strong></span><span id="4c21" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">activites = ['Product','About']<br/>    choice = st.sidebar.selectbox("Select Actvity", activites)</strong></span><span id="bca6" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">if choice == 'Product':<br/>        st.title("Product Recommendation System")<br/>    <br/>    <br/>        name = names()<br/>        n = st.selectbox("Select Image",name)<br/>        if n is not None:<br/>            path = "content/data/style/"+n<br/>            df = load_data()<br/>           <br/>            retrieve_most_similar_products(path,df)<br/>        else:<br/>            st.error("Write the path name")</strong></span><span id="4ee4" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">elif choice =='About':<br/>        st.title("About Me")</strong></span><span id="2afa" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">st.success("Machine Learning and Data Science enthusiast, Android Developer, programmer and always willing to learn and work across new technologies and domains.")<br/>        st.error("If you like the project Please Like Share and Subscribe")<br/>        st.title("Please Like Share and Subscribe....")</strong></span><span id="911f" class="ns mq it oj b gy or oo l op oq"><strong class="oj jd">if __name__ == '__main__':<br/> main()</strong></span></pre><p id="007f" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">在我的YouTube上查看更多有趣的机器学习、深度学习、数据科学项目👉:-</strong><a class="ae mh" href="https://www.youtube.com/c/himanshutripathi" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">YouTube</strong></a><strong class="kq jd"/>(👍)</p><p id="a8fc" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">暂时就这样了👏👏。下一篇文章再见。</p><p id="c467" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果你觉得这篇文章有趣，有帮助，如果你从这篇文章中学到了什么，请鼓掌👏👏)<strong class="kq jd">并留下反馈。</strong></p><p id="bb0c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">感谢阅读！</strong></p><blockquote class="lm ln lo"><p id="e022" class="ko kp lp kq b kr ks kt ku kv kw kx ky lq la lb lc lr le lf lg ls li lj lk ll im bi translated"><strong class="kq jd">参考文献:- </strong></p></blockquote><p id="9b12" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><a class="ae mh" href="https://www.kaggle.com/olgabelitskaya/style-color-images/notebooks" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">https://www . ka ggle . com/olgabelitskaya/style-color-images/notebooks</strong></a></p><p id="ef9a" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><a class="ae mh" href="https://www.analyticssteps.com/blogs/what-are-recommendation-systems-machine-learning" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">https://www . analyticssteps . com/blogs/what-are-recommendation-systems-machine-learning</strong></a></p><p id="6b4d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">还有，让我们在</strong><a class="ae mh" href="https://www.linkedin.com/in/iamhimanshu0/" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">Linkedin</strong></a><strong class="kq jd"/><a class="ae mh" href="https://twitter.com/iam_himanshu0" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">Twitter</strong></a><strong class="kq jd"/><a class="ae mh" href="https://instagram.com/iamhimanshu0/" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">insta gram</strong></a><strong class="kq jd"/><a class="ae mh" href="https://github.com/iamhimanshu0" rel="noopener ugc nofollow" target="_blank"><strong class="kq jd">Github</strong></a><strong class="kq jd">，以及</strong> <a class="ae mh" href="https://www.facebook.com/iamhimanshu0" rel="noopener ugc nofollow" target="_blank"> <strong class="kq jd">脸书</strong> </a> <strong class="kq jd">。</strong></p></div></div>    
</body>
</html>