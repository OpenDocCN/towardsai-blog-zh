<html>
<head>
<title>Having a Hard Time Building the Perfect Model?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">很难建立一个完美的模型？</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/having-a-hard-time-building-the-perfect-model-bc94ec380ac0?source=collection_archive---------0-----------------------#2020-05-24">https://pub.towardsai.net/having-a-hard-time-building-the-perfect-model-bc94ec380ac0?source=collection_archive---------0-----------------------#2020-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="bdbd" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">机器学习</h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/03d037345f07e6815bd6d0c7ded04648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJYo_EDhLwvkPoC4ly2R2g.jpeg"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">演职员表:<a class="ae kl" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>中的<a class="ae kl" href="https://unsplash.com/@aronvisuals" rel="noopener ugc nofollow" target="_blank"> Aron视觉效果</a></figcaption></figure><p id="3f23" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><a class="ae kl" href="https://businessoverbroadway.com/2019/02/19/how-do-data-professionals-spend-their-time-on-data-science-projects/" rel="noopener ugc nofollow" target="_blank">最近对23，000多名数据专业人员的研究结果</a>发现，数据科学家花费约40%的时间收集和清理数据，20%的时间构建和选择模型，11%的时间寻找见解并与利益相关者交流。作为初学者，你可能很难找到你的问题陈述的完美模型。</p><p id="1b18" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">因此，我在这里向您展示一个用Python编写的开源低代码机器学习工具，它允许您在几秒钟内从准备数据到在您选择的笔记本环境中部署模型。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi lk"><img src="../Images/98a67db42d597edf8329218fd2abca85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qh_TL5MzvoWt3FWw.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">版权:<a class="ae kl" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank"> PyCaret </a></figcaption></figure><p id="a4a6" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">PyCaret库拥有数据科学家需要的一切。T13】</p><p id="84d1" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">快速让我们进入安装，并建立一个完美的模型。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="lq lr l"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">来源:<a class="ae kl" href="https://giphy.com/" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></figcaption></figure><h2 id="68a6" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤1:创建虚拟环境</h2><p id="1e44" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">建议使用类似python3虚拟环境或Conda环境的虚拟环境。这样就不会与安装的其他软件包冲突。使用虚拟环境的好处是我们可以下载任何想要使用的库的特定版本。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi mp"><img src="../Images/8c4fe2fde75f60ced7a76e0567a2d735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_86JKVPrb5nCRukVF8A9w.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">使用Anaconda提示符安装</figcaption></figure><p id="65d1" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">安装大约需要5到10分钟，这取决于你的网速。如果你发现安装库有任何问题，请查阅官方文档(<a class="ae kl" href="https://pycaret.org/install/" rel="noopener ugc nofollow" target="_blank">点击这里</a>)。</p><h2 id="271d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">第二步:检查它是否安装正确</h2><ol class=""><li id="0fa2" class="mq mr iq ko b kp mk kt ml kx ms lb mt lf mu lj mv mw mx my bi translated"><strong class="ko ja">命令终端</strong></li></ol><p id="0710" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在终端中激活conda或python环境，然后键入以下代码。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/e7cf914f180d749cfe1707564712a06c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*HfEpi3ndWvlTB3CiB_m2AA.png"/></div></figure><p id="6ce0" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您应该得到以下输出。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/09582067aaf53a8d12164cad2be8c5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*taJ75Poftv_WoeOzUAa7Hg.png"/></div></figure><p id="0451" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我用Ubuntu作为我的操作系统，所以你的可能看起来不一样。</p><p id="a520" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">2.<strong class="ko ja">朱庇特笔记本</strong></p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi na"><img src="../Images/b7f154032c167568914e95a243889c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBG1e3TMjmeVO470wkF8Ew.png"/></div></div></figure><p id="8451" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">键入上面的代码并运行jupyter单元。您将获得版本号作为输出。现在你已经成功地在你的机器上安装了PyCaret库。让我通过解决一个回归问题来告诉你如何使用它。</p><h1 id="f6c1" class="nb lt iq bd lu nc nd ne lx nf ng nh ma ni nj nk md nl nm nn mg no np nq mj nr bi translated">实际用法</h1><p id="8a26" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated"><strong class="ko ja">问题陈述:</strong></p><p id="ad44" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">使用身高和体重作为输入特征，建立一个可以预测人的身体质量指数的模型。</p><p id="f338" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja"> <em class="lp">常识</em> </strong></p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/7518cafb317135af4603791f2df0c31a.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/0*6ys1AMjsgECKUcMu"/></div></figure><p id="d09c" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你可以从下面的Github链接获得数据集。</p><div class="nt nu gp gr nv nw"><a href="https://github.com/HemanthDavuluri/MediumBlog/tree/master/BMI" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ja gy z fp ob fr fs oc fu fw iz bi translated">HemanthDavuluri/MediumBlog</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok kf nw"/></div></div></a></div><h2 id="67e1" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤1:加载数据</h2><p id="6949" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">注:我用的是Kaggle笔记本环境</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><h2 id="0001" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤2:分割训练和测试集</h2><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi om"><img src="../Images/1dd88eba6dbb8b14a2ec8843287b1254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*5t3Qv03jw5WPVSNfi2aL1g.png"/></div></figure><p id="8e2e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">注意:用于建模的数据中的列数等于用于预测的看不见的数据，这对于那些熟悉使用Sklearn的人来说可能看起来很奇怪。PyCaret就是这样工作的，没什么好担心的。当我们用训练好的模型预测看不见的数据时，你会清楚地理解它。</p><h2 id="db2e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤3:设置Pycaret环境</h2><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="f5e8" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">set-up函数初始化Pycaret创建用于数据建模的转换管道并部署它所需的环境。记住应该在使用任何Pycaret函数之前调用setup函数。该函数有两个主要参数data和target。数据是我们正在使用的数据集，目标是相关的列名。运行该函数时，会创建一个表，如下图所示。如果数据集中的所有数据类型都正确显示，请按enter键继续实验。该函数执行任何机器学习实验所需的预处理任务。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi on"><img src="../Images/88c6db9a8a7e8481c90bafcf5be74113.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*rX5bdSXRK8dbxLG_-Itv7A.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">您将得到41行的输出</figcaption></figure><h2 id="81d1" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">你必须知道的主要关键词定义</h2><ul class=""><li id="bae1" class="mq mr iq ko b kp mk kt ml kx ms lb mt lf mu lj oo mw mx my bi translated"><strong class="ko ja"> session_id: </strong>创建一个随机数，用于以后的再现性。如果不初始化变量，函数会自动将123指定为会话id。</li><li id="7ec5" class="mq mr iq ko b kp op kt oq kx or lb os lf ot lj oo mw mx my bi translated"><strong class="ko ja">原始数据:</strong>显示数据集的形状。</li><li id="fbe4" class="mq mr iq ko b kp op kt oq kx or lb os lf ot lj oo mw mx my bi translated"><strong class="ko ja">缺失值:</strong>如果数据集中的数据缺失，则显示一个布尔值。如果有缺失数据，则显示True如果没有缺失值，则显示False。</li><li id="dc2e" class="mq mr iq ko b kp op kt oq kx or lb os lf ot lj oo mw mx my bi translated"><strong class="ko ja">数字特征:</strong>推断为数字的特征数量。</li><li id="407d" class="mq mr iq ko b kp op kt oq kx or lb os lf ot lj oo mw mx my bi translated"><strong class="ko ja">分类特征:</strong>显示分类特征计数的数量。</li><li id="43de" class="mq mr iq ko b kp op kt oq kx or lb os lf ot lj oo mw mx my bi translated"><strong class="ko ja">变换后的训练集:</strong>显示预处理后变换后的数据帧形状。</li><li id="c388" class="mq mr iq ko b kp op kt oq kx or lb os lf ot lj oo mw mx my bi translated"><strong class="ko ja">转换后的测试集:</strong>显示转换后的训练和测试集的形状。训练集的默认值为70%，训练集的默认值为30%。</li></ul><h2 id="4d60" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤4:比较所有模型</h2><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="75ae" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这个函数调用开始根据性能比较所有的模型。建议在设置完成后对数据进行建模。所有模型都经过训练，并使用k倍评分验证对它们进行评分以进行评估。该函数的输出创建了一个表，以型号名称、MAE、MSE、RMSE、R2、RMSLE和MAPE为列。这个函数调用完成了繁重的工作，节省了大量时间。根据数据集的大小，此步骤可能需要一段时间才能完成。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ou"><img src="../Images/bd32f8e583667b1808232d8c3087a8ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2J7ponMMJVEfabVrEI33Pw.png"/></div></div></figure><p id="a1fc" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">它训练了21个模型，并按照从最好到最差的顺序排列。现在，您可以选择最适合自己的型号。最适合我的问题陈述的算法是额外树的回归器。</p><h2 id="9b5e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤5:创建模型</h2><p id="e997" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">比较模型后，该函数不会返回已训练的模型。我们必须使用create model函数创建模型，该函数返回一个网格，其中所有得分都与上述步骤中的相同</p><p id="6a37" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">你可以在这里找到<a class="ae kl" href="https://pycaret.org/create-model/" rel="noopener ugc nofollow" target="_blank">描述的所有车型。</a></p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="474f" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/09ba9c86d77a1b67bab4f9cffa7ba194.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*pNs1Uu-F-d4EL3iYDBnEBA.png"/></div></figure><p id="1503" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要查看模型中使用的所有超参数，请使用这行代码打印模型。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="0f00" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/943ac5732a8a0db83e0ece9876fa705e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Btlr_0OFk5QRXQRxZwhTOw.png"/></div></div></figure><h2 id="d835" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤6:调整模型</h2><p id="5ab0" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">在上述步骤中创建的模型使用默认的超参数，并且该模型可能不是非常有效。因此，调整模型需要使用调整模型功能。该函数自动调整超参数，并使用k-fold交叉验证对其进行评分。输出打印出一个网格，其中包含了调优模型的所有分数。</p><p id="912d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="ko ja">注意:</strong> tune_model()不接受一个训练好的模型对象作为输入(在创建模型函数中模型的缩写名称)</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="1d16" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/c1845924d27dcf96fb7958e5ebfeff75.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*3LWZQZcrNxPq1GLbUTrtaA.png"/></div></figure><p id="1d3b" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以打印模型并查看调整后的超参数。</p><h2 id="67e7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤7:绘制模型</h2><p id="b8e9" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">在最终确定之前，我们可以使用绘图模型功能绘制模型，以分析不同方面的性能。此函数以训练好的模型作为参数，并基于测试集返回一个图。通过<a class="ae kl" href="https://pycaret.org/plot-model/" rel="noopener ugc nofollow" target="_blank">文档</a>，有10种类型的图可供进一步了解。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="70ce" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/b68e05751231fddc1b58b08084f2e2a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*BBmheR1g6qt_9n1XNm8Xfw.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">完美的残差图</figcaption></figure><p id="a002" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">还有很多其他的情节可以尝试。浏览<a class="ae kl" href="https://pycaret.org/plot-model/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h2 id="14f6" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">第八步:交互模式分析模型性能</h2><p id="d05a" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">我发现Pycaret中最有用的功能之一是评估模型。该功能显示给定模型的所有可用图的用户界面。绘图模型功能用于在该功能内部创建所有绘图。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="cf2e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oz"><img src="../Images/8c67f0f9ece4fefed8f71f2b390c20a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-0FsXSghzZdW3QJVbMkSPQ.png"/></div></div></figure><p id="0c97" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以选择绘图类型，因为这都是交互式的。</p><h2 id="428e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤9:在最终确定之前检查模型</h2><p id="1c4d" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">整个过程的主要重要步骤是在最终确定之前检查模型。通过预测测试集和评估分数来执行最终检查是一个很好的做法。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="dbfd" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/31447854beb1d856f774383150af15a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*ne_iE_r1Oz0yVEf3L9kJuQ.png"/></div></figure><h2 id="3538" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤10:最终确定部署模型</h2><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><h2 id="0488" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤11:预测看不见的数据</h2><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="b548" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">打印新的预测数据帧。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pb"><img src="../Images/1239fe88667f14a1e794bd4454c0df14.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*uJUnDOdg8C5s6o4DjTsVgA.png"/></div></div></figure><p id="8aca" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您仔细观察数据框，会发现一个名为“标签”的新列，它只是预测值列。</p><p id="0f02" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我想现在它有意义了，为什么在看不见的数据集中有3列作为训练(数据)集。</p><h2 id="5c0d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kx mb mc md lb me mf mg lf mh mi mj iw bi translated">步骤12:保存模型</h2><p id="028a" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">通过这样做，您可以随时在新数据上使用您的模型。如果保存模型，您需要再次经历整个过程。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="aeb9" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">保存模型函数有两个参数，一个是模型名，另一个是保存模型的名称。</p><p id="2b3e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要再次重用该模型，请尝试以下代码。</p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="ol lr l"/></div></figure><p id="b6c6" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/38c19c950dcb500fc4d27fada99ab66f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*4kfic-8F0kaqL-wFfcgDTw.png"/></div></figure><p id="1f21" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">一旦模型加载到环境中，您就可以使用相同的<code class="fe pd pe pf pg b">predict_model()</code>函数简单地使用它来预测任何新数据。</p><h1 id="2642" class="nb lt iq bd lu nc nd ne lx nf ng nh ma ni nj nk md nl nm nn mg no np nq mj nr bi translated">结论</h1><p id="f80b" class="pw-post-body-paragraph km kn iq ko b kp mk kr ks kt ml kv kw kx mm kz la lb mn ld le lf mo lh li lj ij bi translated">你只花了7分钟就装好了库，找到了一个完美的模型。</p><p id="f4e4" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">那么你对PyCaret相当满意吗？<br/>你还在等什么？<br/>开始实施你的项目，节省你的宝贵时间，就像我为你节省我的时间和写文章一样。<br/>如能跟随并鼓掌，我们将不胜感激。谢谢你一直读到最后。<br/>下次见。</p></div></div>    
</body>
</html>