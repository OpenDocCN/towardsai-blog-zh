<html>
<head>
<title>Toyota v/s BMW v/s Tesla: Stock Analysis using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">丰田v/s宝马v/s特斯拉:使用Python进行股票分析</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/toyota-v-s-bmw-v-s-tesla-stock-analysis-using-python-3762caa1713a?source=collection_archive---------0-----------------------#2021-01-28">https://pub.towardsai.net/toyota-v-s-bmw-v-s-tesla-stock-analysis-using-python-3762caa1713a?source=collection_archive---------0-----------------------#2021-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6f72" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><div class=""><h2 id="0bd3" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">汽车公司股票分析的实用实现，使用Python获得可视化和财务洞察力。</h2></div><p id="6d75" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">Python的使用是巨大的，它在几乎每个用例中都有帮助。通过这篇文章，我希望向你介绍在股票分析中使用Python。从获得股票的数据到可视化它并获得洞察力，一切都在这里解释。财务术语以更简单的术语与实现代码一起强调，以帮助更好地理解概念。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/c20c2c3be08e8b976970f8f263deab04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ICa4dh9fLgMnvWLH"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">照片由克里斯·利维拉尼(<a class="ae ma" href="https://unsplash.com/photos/dBI_My696Rk" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>)拍摄</figcaption></figure><p id="ebb0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了促进学习过程，考虑了3家著名汽车公司的股票:丰田、宝马和特斯拉。这些股票表现不同，有助于区分和获得洞察力。所以让我们开始吧！</p><h1 id="9ec9" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">→导入包</h1><p id="a754" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">我们将从导入数据分析和可视化所需的必要包和库开始。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="0698" class="nd mc iq mz b gy ne nf l ng nh"><strong class="mz ja">import</strong> numpy <strong class="mz ja">as</strong> np<br/><strong class="mz ja">import</strong> pandas <strong class="mz ja">as</strong> pd<br/><strong class="mz ja">import</strong> matplotlib.pyplot <strong class="mz ja">as</strong> plt<br/><strong class="mz ja">%</strong>matplotlib inline</span></pre><p id="e00c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">接下来，我们将导入获取数据所必需的包。Pandas DataReader将用于提取数据。</p><p id="96cb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要了解更多关于熊猫DataReader的信息，请查看我下面的文章:</p><div class="ni nj gp gr nk nl"><a href="https://medium.com/nerd-for-tech/how-to-get-financial-data-using-python-7a508f25fc39" rel="noopener follow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd ja gy z fp nq fr fs nr fu fw iz bi translated">如何用Python获取财务数据？</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">理解如何获取数据以使用Python进行金融分析的指南。</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">medium.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz lu nl"/></div></div></a></div><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="e9f8" class="nd mc iq mz b gy ne nf l ng nh"><strong class="mz ja">import</strong> pandas_datareader<br/><strong class="mz ja">import</strong> datetime<br/><strong class="mz ja">import</strong> pandas_datareader.data <strong class="mz ja">as</strong> web</span></pre><h1 id="c2a0" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">→获取数据</h1><p id="520c" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">现在我们将获得汽车公司的数据，这些数据将被分析。将提到开始日期和结束日期，在此期间将进行分析。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="ba04" class="nd mc iq mz b gy ne nf l ng nh">start <strong class="mz ja">=</strong> datetime.datetime(2015,1,1)<br/>end <strong class="mz ja">=</strong> datetime.datetime(2020,1,1)</span></pre><h2 id="e310" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated"><strong class="ak">丰田</strong></h2><p id="3509" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">将被考虑的汽车公司有丰田、宝马和特斯拉。因此，从网络中提取所需时间段的数据。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="9d24" class="nd mc iq mz b gy ne nf l ng nh">toyota <strong class="mz ja">=</strong> web.DataReader('TM','yahoo',start,end)<br/>toyota.head()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/7c0f2ed90f706e9fe267a0fa71a4b4d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*IHfPinzunGbGceRmcwd4Zw.png"/></div></figure><h2 id="a270" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">德国宝马汽车公司(Bavarian Motor Works)</h2><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="8cb3" class="nd mc iq mz b gy ne nf l ng nh">bmw <strong class="mz ja">=</strong> web.DataReader('BMWYY','yahoo',start,end)<br/>bmw.head()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/84fe260c11d9b52853ad635814e98db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*XVyet42Acv86jw2yHBRXgA.png"/></div></figure><h2 id="8405" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">特斯拉</h2><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="5aa0" class="nd mc iq mz b gy ne nf l ng nh">tesla <strong class="mz ja">=</strong> web.DataReader('TSLA','yahoo',start,end)<br/>tesla.head()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi om"><img src="../Images/4f2862d0ccbdce592b5821ba1c54916d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*6nBlY4C1id2WPGj5IQG6Sw.png"/></div></figure><h1 id="3dbe" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">→数据的可视化</h1><p id="37e9" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">规定时间段内的趋势将通过图形可视化，并获得洞察力。从所有3只股票的开盘价的线性图开始。</p><h2 id="f680" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">线性图</h2><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="0e1f" class="nd mc iq mz b gy ne nf l ng nh">toyota['Open'].plot(label<strong class="mz ja">=</strong>'Toyota',title<strong class="mz ja">=</strong>'Open Prices',figsize<strong class="mz ja">=</strong>(12,8))<br/>bmw['Open'].plot(label<strong class="mz ja">=</strong>'BMW')<br/>tesla['Open'].plot(label<strong class="mz ja">=</strong>'Tesla')<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi on"><img src="../Images/4669b7d00b0a0d34684ac8a13d9cb01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qOGxzn5Jix1pBdGCZc0c_w.png"/></div></div></figure><blockquote class="oo op oq"><p id="8daa" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">从上面的图中可以看出，与其他两家公司相比，丰田的开盘价较高。</p></blockquote><h2 id="d2f0" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">库存数量图</h2><p id="f7ac" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">接下来绘制每天的股票交易量。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="32c1" class="nd mc iq mz b gy ne nf l ng nh">toyota['Volume'].plot(label<strong class="mz ja">=</strong>'Toyota',title<strong class="mz ja">=</strong>'Volume Traded',figsize<strong class="mz ja">=</strong>(12,8))<br/>bmw['Volume'].plot(label<strong class="mz ja">=</strong>'BMW')<br/>tesla['Volume'].plot(label<strong class="mz ja">=</strong>'Tesla')<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ov"><img src="../Images/57c62a0cde1b2b502abfc47cb5d134b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BsQsrLML2o73cgYWl3ttDA.png"/></div></div></figure><blockquote class="oo op oq"><p id="11fd" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">我们了解到，特斯拉在2018年底出现了大幅飙升，达到了高交易量。</p></blockquote><p id="bd1c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">所以让我们找出交易量最高的确切日期。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="bfbd" class="nd mc iq mz b gy ne nf l ng nh">m <strong class="mz ja">=</strong> tesla['Volume'].max()<br/>tesla.loc[tesla['Volume']<strong class="mz ja">==</strong>m]</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/32413b97ea19b16aee2b5b5c414ecc4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*mkiFjZ5caMgcMLt79cXhWw.png"/></div></figure><p id="2d35" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">根据上面的情节，感觉特斯拉比其他两家公司处于更好的位置。但是，当不仅考虑股票，而且考虑总市值时，情况就会清楚了。一个简单的方法是通过交易量乘以开盘价来计算交易总额。因此创建了另一列“总交易量”。</p><h2 id="c613" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">交易总额图</h2><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="6ee6" class="nd mc iq mz b gy ne nf l ng nh">toyota['Total trade amount'] <strong class="mz ja">=</strong> toyota['Open']<strong class="mz ja">*</strong>toyota['Volume']<br/>bmw['Total trade amount'] <strong class="mz ja">=</strong> bmw['Open']<strong class="mz ja">*</strong>bmw['Volume']<br/>tesla['Total trade amount'] <strong class="mz ja">=</strong> tesla['Open']<strong class="mz ja">*</strong>tesla['Volume']</span></pre><p id="8799" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，交易总额将被绘制出来，以查看其趋势。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="efea" class="nd mc iq mz b gy ne nf l ng nh">toyota['Total trade amount'].plot(label<strong class="mz ja">=</strong>'Toyota',figsize<strong class="mz ja">=</strong>(10,8))<br/>bmw['Total trade amount'].plot(label<strong class="mz ja">=</strong>'BMW')<br/>tesla['Total trade amount'].plot(label<strong class="mz ja">=</strong>'Tesla')<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ox"><img src="../Images/2475c95558139210960fbf7e4cf26672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPHHTwwk1SZJotZPd0LOFQ.png"/></div></div></figure><blockquote class="oo op oq"><p id="8287" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">在这里，我们可以观察到特斯拉在2018年年中的某个地方出现了大幅飙升，交易了大量股票。</p></blockquote><p id="4098" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">所以让我们获得它发生的确切日期。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="bd86" class="nd mc iq mz b gy ne nf l ng nh">m1 <strong class="mz ja">=</strong> tesla['Total trade amount'].max()<br/>tesla.loc[tesla['Total trade amount']<strong class="mz ja">==</strong>m1]</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oy"><img src="../Images/354d2fae72d55ef86e11db376a3a0743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkINaMt6erJN0staqO1r3Q.png"/></div></div></figure><blockquote class="oo op oq"><p id="c2fd" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">当你在网上搜索这个日期时，你会发现激增是因为埃隆·马斯克表示特斯拉可能会私有化。</p></blockquote><p id="f9af" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">只是看看丰田和宝马公司，因为特斯拉的规模更大。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="7ec7" class="nd mc iq mz b gy ne nf l ng nh">toyota['Total trade amount'].plot(label<strong class="mz ja">=</strong>'Toyota',figsize<strong class="mz ja">=</strong>(10,8))<br/>bmw['Total trade amount'].plot(label<strong class="mz ja">=</strong>'BMW')<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oz"><img src="../Images/c38613540e742bdc74a441a55e58c00d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ecgH2LHaG9VVvhbtclN_Q.png"/></div></div></figure><blockquote class="oo op oq"><p id="6db4" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">丰田在2015年年中和宝马在2016年年中也出现了飙升。</p></blockquote><h2 id="54b6" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">移动平均图</h2><p id="8569" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">现在让我们继续绘制移动平均线。我们拿宝马的数据来画50天和250天的移动平均线。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="26f7" class="nd mc iq mz b gy ne nf l ng nh">bmw['MA50'] <strong class="mz ja">=</strong> bmw['Open'].rolling(50).mean()<br/>bmw['MA250'] <strong class="mz ja">=</strong> bmw['Open'].rolling(250).mean()<br/>bmw[['Open','MA50','MA250']].plot(figsize<strong class="mz ja">=</strong>(16,8))</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pa"><img src="../Images/58473725cd859c3f95d1bf0642710dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a10zdHCtNo0DHYH9sk2lBQ.png"/></div></div></figure><h2 id="d779" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">烛台图</h2><p id="9b3e" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">在做股票分析的时候，蜡烛图是最广泛使用的。因此，让我们开始绘制汽车公司丰田的烛台图表。安装了mplfinance模块。它有一个绘制烛台的“类型”参数。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="f822" class="nd mc iq mz b gy ne nf l ng nh"><em class="or">!pip install mplfinance</em></span><span id="1009" class="nd mc iq mz b gy pb nf l ng nh"><strong class="mz ja">import</strong> mplfinance <strong class="mz ja">as</strong> mpf</span></pre><p id="ad0e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们从2016年中提取了5月的日期，并绘制了这个区间的蜡烛图。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="4d63" class="nd mc iq mz b gy ne nf l ng nh">toyota_month <strong class="mz ja">=</strong> toyota['2016-05-01' :'2016-06-01']<br/>mpf.plot(toyota_month,type<strong class="mz ja">=</strong>'candle',style<strong class="mz ja">=</strong>'charles')</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pc"><img src="../Images/729a6e00ef67c9b00108647fd6849868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRXvi0hRSiioyqioD-R7Hg.png"/></div></div></figure><p id="df1c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你想显示交易量，只需将参数volume设置为true。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="6de3" class="nd mc iq mz b gy ne nf l ng nh">mpf.plot(toyota_month,type<strong class="mz ja">=</strong>'candle',style<strong class="mz ja">=</strong>'charles',volume<strong class="mz ja">=True</strong>,figratio<strong class="mz ja">=</strong>(10,5))</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pd"><img src="../Images/f9a43554c9278771ca45f9b799201b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RP8fLM9P8RpXha2Ys7oN-w.png"/></div></div></figure><h1 id="3e27" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">→财务分析</h1><p id="48e7" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">现在我们将研究一些金融术语及其计算方法。</p><h2 id="009a" class="nd mc iq bd md oa ob dn mh oc od dp ml kx oe of mn lb og oh mp lf oi oj mr iw bi translated">每日百分比回报</h2><p id="0b48" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">第一项是每日百分比变化。它的公式如下:</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/261df9c29df710c381ddf0ff851f8913.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/0*NSFVeUa_zjd5YgSW"/></div></figure><p id="731c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">其中r(t)是t时刻的收益，p(t)是t时刻的价格，这有助于确定收益或损失的百分比，并分析股票的波动性。波动性是衡量股票收益离差的指标。因此，如果股票在一段时间内的涨跌幅度超过1%，那么它就被称为波动市场。因此，当我们绘制直方图时，分布很宽，那么我们可以说它更不稳定。</p><p id="6cde" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">所以现在创建了一个“return”列，它是使用收盘价列计算的。对于时间(t-1)，使用“移位”方法向下/向前移位周期1。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="43ef" class="nd mc iq mz b gy ne nf l ng nh">toyota['returns'] <strong class="mz ja">=</strong> (toyota['Close']<strong class="mz ja">/</strong>toyota['Close'].shift(1))<strong class="mz ja">-</strong>1<br/>bmw['returns'] <strong class="mz ja">=</strong> (bmw['Close']<strong class="mz ja">/</strong>bmw['Close'].shift(1))<strong class="mz ja">-</strong>1<br/>tesla['returns'] <strong class="mz ja">=</strong> (tesla['Close']<strong class="mz ja">/</strong>tesla['Close'].shift(1))<strong class="mz ja">-</strong>1</span></pre><p id="4552" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在我们将绘制直方图。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="29a1" class="nd mc iq mz b gy ne nf l ng nh">tesla['returns'].hist(bins<strong class="mz ja">=</strong>100, label<strong class="mz ja">=</strong>'Tesla',figsize<strong class="mz ja">=</strong>(10,8))<br/>bmw['returns'].hist(bins<strong class="mz ja">=</strong>100, label<strong class="mz ja">=</strong>'BMW',figsize<strong class="mz ja">=</strong>(10,8))<br/>toyota['returns'].hist(bins<strong class="mz ja">=</strong>100, label<strong class="mz ja">=</strong>'Toyota',figsize<strong class="mz ja">=</strong>(10,8))<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pf"><img src="../Images/b9b44c03b24a31cba65584bcd9fb571d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYp_s3110LzOkOQvQquqUw.png"/></div></div></figure><blockquote class="oo op oq"><p id="74d5" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">从上面的情节可以看出，丰田和宝马有点稳定，但特斯拉有波动性，因为它的分布很广。</p></blockquote><p id="86e3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们可以从核密度估计(KDE)图中获得更好的洞察力。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="4f7c" class="nd mc iq mz b gy ne nf l ng nh">toyota['returns'].plot(kind<strong class="mz ja">=</strong>'kde', label<strong class="mz ja">=</strong>'Toyota',figsize<strong class="mz ja">=</strong>(10,8))<br/>bmw['returns'].plot(kind<strong class="mz ja">=</strong>'kde', label<strong class="mz ja">=</strong>'BMW',figsize<strong class="mz ja">=</strong>(10,8))<br/>tesla['returns'].plot(kind<strong class="mz ja">=</strong>'kde', label<strong class="mz ja">=</strong>'Tesla',figsize<strong class="mz ja">=</strong>(10,8))<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pg"><img src="../Images/851294f3163a3d45f1b4f55a5ea0afff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SnNzTWY5P8HSHoGEf_Eig.png"/></div></div></figure><blockquote class="oo op oq"><p id="cb4d" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">从图中可以看出，丰田的分布达到一个峰值，表明与其他两家公司的股票相比，它非常稳定。</p></blockquote><p id="d18b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在我们可以比较股票之间的收益来分析它们之间的相关性。这可以通过创建散点图来实现。scatter_matrix方法是从pandas引入的。为了能够创建这个图，我们需要创建一个数据框架，其中的列是每只股票的收益。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="c4a7" class="nd mc iq mz b gy ne nf l ng nh"><strong class="mz ja">from</strong> pandas.plotting <strong class="mz ja">import</strong> scatter_matrix</span><span id="60eb" class="nd mc iq mz b gy pb nf l ng nh">comp_df <strong class="mz ja">= </strong>pd.concat([toyota['returns'],bmw['returns'],tesla['returns']],axis<strong class="mz ja">=</strong>1)<br/>comp_df.columns <strong class="mz ja">=</strong> ['Toyota returns','BMW returns','Tesla returns']</span><span id="0024" class="nd mc iq mz b gy pb nf l ng nh">scatter_matrix(comp_df,figsize<strong class="mz ja">=</strong>(8,8),hist_kwds<strong class="mz ja">=</strong>{'bins':100})</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pc"><img src="../Images/11043aa2bf42865f6a821d9dd9de677f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jXuH0q-DONDsOIVCeRDYw.png"/></div></div></figure><blockquote class="oo op oq"><p id="64f1" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">我们可以看出宝马和丰田之间存在关联，但特斯拉与任何公司都没有关联。</p></blockquote><p id="9981" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">累计收益</strong></p><p id="b256" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在我们将分析累积收益。累积是指一段时间内数值(此处为存量)的集合。因此，当考虑累积回报时，它是根据投资当天计算的，而不是根据前一天计算的每日回报。如果累计回报率高于1，则产生利润，否则就是亏损。</p><p id="abd6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">公式是:</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/de212ea8289707d53cb1bc222de86444.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/0*FBDBo8TEuRsMx93z"/></div></figure><p id="0b2b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">其中i(t)是时间t时的投资，r(t)是时间t时的回报。我们将使用熊猫的“cumprod()”方法来计算它。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="9998" class="nd mc iq mz b gy ne nf l ng nh">toyota['cumulative return'] <strong class="mz ja">=</strong> (1 <strong class="mz ja">+</strong> toyota['returns']).cumprod()<br/>bmw['cumulative return'] <strong class="mz ja">=</strong> (1 <strong class="mz ja">+</strong> bmw['returns']).cumprod()<br/>tesla['cumulative return'] <strong class="mz ja">=</strong> (1 <strong class="mz ja">+</strong> tesla['returns']).cumprod()</span></pre><p id="e6dd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，我们将绘制累积回报图，看看哪些股票的回报最高。</p><pre class="ll lm ln lo gt my mz na nb aw nc bi"><span id="51e6" class="nd mc iq mz b gy ne nf l ng nh">toyota['cumulative return'].plot(label<strong class="mz ja">=</strong>'Toyota',figsize<strong class="mz ja">=</strong>(16,8))<br/>bmw['cumulative return'].plot(label<strong class="mz ja">=</strong>'BMW')<br/>tesla['cumulative return'].plot(label<strong class="mz ja">=</strong>'Tesla')<br/>plt.legend()</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi pi"><img src="../Images/00f98a7cc684f7b69a8285f1e29144dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-Swu_8EZSIchQnDl6_aLg.png"/></div></div></figure><blockquote class="oo op oq"><p id="c2ef" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated">我们可以断言，特斯拉的累计回报率最高，而宝马的回报率最低。</p></blockquote><p id="d8bf" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们来到文章的结尾。我希望你了解了如何处理股票数据，也了解了其中的趋势。</p><blockquote class="pj"><p id="3f89" class="pk pl iq bd pm pn po pp pq pr ps lj dk translated"><em class="pt">关于</em> <a class="ae ma" href="https://github.com/jayashree8/Finance_Trading_In_Python/blob/main/Car%20stock%20analysis/Car%20stock%20analysis.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="pt"> Github </em> </a> <em class="pt">上的完整代码参考Jupyter笔记本。</em></p></blockquote><blockquote class="oo op oq"><p id="7364" class="ko kp or kq b kr pu ka kt ku pv kd kw os pw kz la ot px ld le ou py lh li lj ij bi translated"><em class="iq">联系我:</em> <a class="ae ma" href="https://www.linkedin.com/in/jayashree-domala8/" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> LinkedIn </em> </a></p><p id="b3b0" class="ko kp or kq b kr ks ka kt ku kv kd kw os ky kz la ot lc ld le ou lg lh li lj ij bi translated"><em class="iq">查看我的其他作品:</em> <a class="ae ma" href="https://github.com/jayashree8" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> GitHub </em> </a></p></blockquote></div></div>    
</body>
</html>