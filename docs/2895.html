<html>
<head>
<title>Computing and Visualizing Brain Topological Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大脑拓扑数据分析的计算和可视化</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/computing-and-visualizing-brain-topological-data-analysis-511635158ae2?source=collection_archive---------1-----------------------#2022-07-03">https://pub.towardsai.net/computing-and-visualizing-brain-topological-data-analysis-511635158ae2?source=collection_archive---------1-----------------------#2022-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="440e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">超越大脑连通性的成对网络分析</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b787b22a5988d73796715981ec14d17b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_LAc9eE1OhPTumhYLfjxg.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">演职员表:来自www.pexels.com的龟背竹</figcaption></figure><p id="0b5a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">古迪帕德瓦</strong>是一些印度少数民族庆祝传统新年(尽管是在春天)的节日。它也是一个由<a class="ae le" href="https://www.inria.fr/en" rel="noopener ugc nofollow" target="_blank"> INRIA </a>单元开发的用于计算拓扑和拓扑数据分析(TDA)的开源<a class="ae le" href="https://gudhi.inria.fr/" rel="noopener ugc nofollow" target="_blank">库</a>(实际上GUDHI是更高维度中<em class="lf">几何理解</em>的首字母缩写，最后3个字母交换为<em class="lf"> ) </em>。它提供了几种算法来构造多种类型的单纯复形，以及表示它们的数据结构。它是用C++编写的，通过Cython用Python包装。鉴于自然界中许多类型的数据和结构中互连图的性质，这种表示方式正引起越来越多的兴趣。TDA是二十世纪初从应用代数拓扑和计算几何中出现的一个新领域。为了理解为什么这在计算神经科学中很重要，我们首先需要修正什么是<em class="lf">连接体。</em></p><p id="199f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">连接体是大脑的图形/网络表示，其中一个节点是大脑区域，边是结构连接的表示或大脑活动的相关性强度。我们在第一种情况下谈论<em class="lf">结构连接体</em>，在后一种情况下谈论<em class="lf">功能连接体</em>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lg"><img src="../Images/3ad18698e9be4b0588967d58433804b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ua_IOgc5OlBJhAZsc0PvPg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">大脑连接体。来源:图片由作者用Biorender创建。</figcaption></figure><p id="75e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">成千上万的研究人员已经使用这种表示法来提取生物标记或研究大脑的内在方面。</p><p id="e288" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它允许识别本地网络的差异或使用将网络的重要方面总结为<a class="ae le" href="https://www.sciencedirect.com/science/article/abs/pii/S105381190901074X?via%3Dihub" rel="noopener ugc nofollow" target="_blank">隔离和整合</a>的指标。然而，为了捕捉区域(节点)之间的高阶相互作用，我们需要从成对的网络度量转移到单纯的复合体。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="eadf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">单纯复形是由点、线段、三角形及其n维对应物组成的集合。0-单形是顶点，1-单形是连接2个节点的边，2-单形是三角形，以此类推。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lj"><img src="../Images/c02727053a0e6927c041e8706b4afb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPlYauh4bkwxb61UHHvANQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">单纯复元素。来源:图片由作者提供。</figcaption></figure><h1 id="00f0" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">持久同源性</h1><p id="a417" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">持久同调是一种在各种空间分辨率下计算空间(在网络的离散情况下)拓扑属性的技术。为了确定是否有同源类通过几次过滤“持续存在”,持续同源记录了在过滤过程中进化的单纯复合物中循环的出现。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mn"><img src="../Images/8ecd929e05be9453656a7ae2533d0f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3D6O_xoC5QzDA-K5qniJw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">大脑网络的过滤示例</figcaption></figure><p id="3ef7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更正式地说，这是通过条形码(持久性图)可视化的。这是带有Gudhi的持久性条形码的结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/ac1db7be178b842875e146d190478f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*v9zi3SrEuGYJZ84VexxCeA.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">用Gudhi生成的图像。来源:图片由作者提供。</figcaption></figure><p id="0c92" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设我们已经以邻接矩阵的形式加载了大脑连接体，这是获得上图的代码:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="cce3" class="mu ll it mq b gy mv mw l mx my">import gudhi<br/>import numpy as np<br/>matrix = np.genfromtxt(‘Connectome.txt’)<br/>mattop = 1 — matrix</span><span id="ca5a" class="mu ll it mq b gy mz mw l mx my"># Computing and plotting barcode<br/>rips_complex = gudhi.RipsComplex(distance_matrix=mattop, max_edge_length=1)<br/>simplex_tree = rips_complex.create_simplex_tree(max_dimension=2)<br/>diag = simplex_tree.persistence()<br/>gudhi.plot_persistence_barcode(diag, legend=True, max_intervals=0)</span></pre><p id="18fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用Gudhi的一个重要步骤是，在相关矩阵(来自功能连接)或纤维束连接强度(来自结构连接)的情况下，我们需要将一切转换为距离。</p><p id="f934" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他拓扑度量是贝蒂数、欧拉特征和曲率。贝蒂数<em class="lf"> β </em>统计给定单纯复形中的<em class="lf"> k </em>维洞的数量。而欧拉特征由表达式V-E+F(顶点数和面数减去边数)给出，考虑了多面体的单纯复形拓扑。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="d18b" class="mu ll it mq b gy mv mw l mx my">from gudhi import PeriodicCubicalComplex as pcc <br/>cc = pcc(dimensions=[3],  top_dimensional_cells= [0, 1, 0],  periodic_dimensions=[True]) <br/>bettival = cc.betti_numbers()</span></pre><h1 id="e258" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">大脑TDA可视化</h1><p id="bbf0" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">获得TDA度量的图形度量是有用的。然而，将这些值直接可视化(可能覆盖在大脑网格上)肯定更有帮助。</p><p id="b8e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一般来说，从事大脑连通性工作的人使用基于Matlab的可视化工具，如<a class="ae le" href="https://www.nitrc.org/projects/bnv/#:~:text=BrainNet%20Viewer%20is%20a%20brain,%2C%20easy%2C%20and%20flexible%20way." rel="noopener ugc nofollow" target="_blank"> BrainNetViewer </a>、<a class="ae le" href="http://www.brainnetome.org/" rel="noopener ugc nofollow" target="_blank"> Brainnetome Toolkit </a>，以及其他基于VTK或<a class="ae le" href="https://mrtrix.readthedocs.io/en/latest/quantitative_structural_connectivity/connectome_tool.html" rel="noopener ugc nofollow" target="_blank"> MRTRIX </a>的可视化工具。</p><p id="e970" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最近，<a class="ae le" href="https://nilearn.github.io/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Nilearn </a> visualizer和<a class="ae le" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>为基础的可视化有了很大的改进。Plotly是一个Python框架，提供绘图、分析和统计。它旨在集成到web应用程序中，例如通过使用相关工具<a class="ae le" href="https://plotly.com/dash/" rel="noopener ugc nofollow" target="_blank"> Dash </a>。Nilearn是一个专注于脑成像的统计Python库。我个人发现Nilearn的默认玻璃大脑可视化在美学上确实没有吸引力，但<em class="lf"> view_connectome </em>函数反而在某种程度上令人满意。以下是假设您以3D形式加载节点坐标(例如，来自大脑图谱)和矩阵形式的连接性值的结果。我从来没有深入研究过，但我相信这种可视化是用在类似Plotly的东西下面。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="8e3f" class="mu ll it mq b gy mv mw l mx my">import pandas as pd<br/>from nilearn import plotting</span><span id="d7f0" class="mu ll it mq b gy mz mw l mx my"># Brain atlas centroids<br/>coords = pd.read_csv("coords.txt", header=None)<br/># Adjacency matrix (brain connectivity)<br/>connectome = pd.read_csv("Conn_mat.txt", header=None)<br/>plotting.view_connectome(connectome.values, coords.values, linewidth=5.0, node_size=5.0)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi na"><img src="../Images/664c357f3c6bf5e5661ca00b36d0b58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*zt7wwsfWKNvh3nDoZKuCsg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">从上面的代码中学习输出。来源:图片由作者提供。</figcaption></figure><p id="9a8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者，使用Plotly可以加载网格，然后将3D图形作为散点图覆盖:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="65d0" class="mu ll it mq b gy mv mw l mx my">import meshio<br/>import plotly.graph_objs as go<br/>from IPython.display import SVG, display</span><span id="f94a" class="mu ll it mq b gy mz mw l mx my">path_brainobj = "brain.stl"<br/>mesh_data = meshio.read(path_brainobj)</span><span id="a990" class="mu ll it mq b gy mz mw l mx my">fig = go.Figure()<br/>fig.add_trace(go.Mesh3d(x=mesh_data.points[:,0],y=mesh_data.points[:, 1], z=mesh_data.points[:, 2], i=mesh_data.cells[0].data[:, 0], j=mesh_data.cells[0].data[:, 1], k=mesh_data.cells[0].data[:, 2],intensity=mesh_data.points[:, 2], colorscale='Viridis'))</span><span id="535a" class="mu ll it mq b gy mz mw l mx my">fig.show()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nb"><img src="../Images/1967d0fe559df7f73ed0b6dd19efa438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vKjdUsjTqDcQr2LTV57xLA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上面代码的Plotly输出。来源:图片由作者提供。</figcaption></figure><p id="5c8a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了这些工具，我们现在就可以从单纯复合体中绘制成对连通性度量和高阶特征了。Plotly还可以同时绘制多个元素。每个元素称为一个“痕迹”。例如，一个轨迹可以是大脑网格，另一个轨迹可以是对集团的参与(作为散点图，给出来自图谱的区域的质心)，另一个轨迹可以是单纯形的边。</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="9002" class="mu ll it mq b gy mv mw l mx my">#Brain mesh from file<br/>brain_trace =go.Mesh3d(x=mesh_data.points[:,0],y=mesh_data.points[:, 1],z=mesh_data.points[:, 2],i=mesh_data.cells[0].data[:, 0],j=mesh_data.cells[0].data[:, 1],k=mesh_data.cells[0].data[:, 2],opacity=0.1,hoverinfo=None,showlegend = True, name ='Brain Shell' )<br/></span><span id="da49" class="mu ll it mq b gy mz mw l mx my"># sizec : clique participation per region<br/># x,y,z : centroids coordinate of region from an atlas<br/>trace1 = go.Scatter3d(x=x, y=y, z=z, text=areas, mode='markers', marker=dict(sizemode='diameter', symbol='circle', showscale=True,opacity=0.85,size=10*sizec, color=colorV, colorscale=plasma,cauto=value, cmin=0, cmax=5), hoverinfo='skip',showlegend=True)</span><span id="b1c3" class="mu ll it mq b gy mz mw l mx my"># Simplex edges</span><span id="59a2" class="mu ll it mq b gy mz mw l mx my">for edge in Graph.edges():<br/>  Xed += [pos3d[edge[0]][0],pos3d[edge[1]][0], None]<br/>  Yed += [pos3d[edge[0]][1],pos3d[edge[1]][1], None]<br/>  Zed += [pos3d[edge[0]][2],pos3d[edge[1]][2], None]</span><span id="1cbe" class="mu ll it mq b gy mz mw l mx my">trace2 = go.Scatter3d(x=Xed, y=Yed, z=Zed, mode='lines', line=dict(color='black', width=2), hoverinfo='none', showlegend=False, opacity=0.3)</span><span id="07a8" class="mu ll it mq b gy mz mw l mx my">data = [brain_trace, trace1, trace2]<br/>go.Figure(data=data)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nc"><img src="../Images/6cdeef45be668dce4c206c9676b58eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3HC5wQcQf2WlKj8CVyK4g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">从上面的代码Plotly图形。来源:图片由作者提供。</figcaption></figure><h1 id="f67e" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">结论</h1><p id="33bf" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">TDA是分析数据和创建新的生物标记的进一步工具，因为它们捕捉节点之间更高级别的相互作用。很难说这些是真的有用还是多余。过去一直假设<strong class="js iu"> <em class="lf"> </em> </strong>大部分<a class="ae le" href="https://www.nature.com/articles/ncomms13812" rel="noopener ugc nofollow" target="_blank">脑网络测度可以归结为程度分析，剩下的大多是摆设</a>。</p><p id="18ee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从可视化的角度来看。直接为网络神经科学打造的工具，大概比Plotly更友好。鉴于人们对使用机器学习工具(如Scikit-learn、Scikit-TDA、Gudhi、Tensorflow等)的兴趣越来越大，如果提供编码技能，像Nilearn或Plotly这样的集成可视化也将非常有用。</p><h1 id="a56b" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">如果你想连接</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b1fff1953cdeeba2cdac8f6277b8785b.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*Z4NRW9QtjdIsj6na"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://twitter.com/Dr_Alex_Crimi" rel="noopener ugc nofollow" target="_blank">@ Dr _ Alex _克里米</a></figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/e3e218f48aaf7884cec598ad1610a7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*lkNIukJMXnOD_t85"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://www.instagram.com/dr.alecrimi/" rel="noopener ugc nofollow" target="_blank">@阿列克里米博士</a></figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9ec1be66dfa998cbb0c8ea39facb3daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*OFwTKymZow2u7s1-5L0tWQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">亚历山德罗·克里米——YouTube</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/ba817e1293a0a6fd09edd178fd8c2334.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*sLZlo7l1jyePsE33"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://www.facebook.com/alexyawcrimi" rel="noopener ugc nofollow" target="_blank">亚历克斯·亚乌·克里米</a></figcaption></figure></div></div>    
</body>
</html>