<html>
<head>
<title>Music Genre Prediction by Extracted Audio-Features + Comparison To the Spotify-API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过提取的音频特征+与Spotify-API的比较进行音乐流派预测</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/music-genre-prediction-by-extracted-audio-features-and-comparison-to-the-spotify-api-ebf82232e31a?source=collection_archive---------0-----------------------#2021-01-01">https://pub.towardsai.net/music-genre-prediction-by-extracted-audio-features-and-comparison-to-the-spotify-api-ebf82232e31a?source=collection_archive---------0-----------------------#2021-01-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="ec07" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="3738" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">我们能从一首音乐中提取出比Spotify通过他们的API提供的特征更精确的流派分类吗？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/cd901d20ae30424dbdefd27e3fd597f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vX9D-2xoiLWuNLf5"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@sgcreative?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> sgcdesignco </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8b79" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">毫无疑问，对我们来说，决定一首音乐是属于流派“<em class="mb">古典</em>”还是属于流派“<em class="mb">朋克摇滚</em>”是超级容易的。但是你怎么能教一台计算机在不同的流派之间做出决定呢？计算机或算法不知道莫扎特的柔和钢琴音符属于古典音乐类型，也不知道进来的电吉他即兴重复片段经常用于朋克摇滚类型。<br/>当然，你可以告诉一个算法，莫扎特的所有音乐都属于古典流派，但是随着时间的推移在不同流派之间游走的艺术家，和一张专辑中属于不同流派的歌曲会发生什么？以玛奇恩·冈·凯利为例(顺便说一句，这是我最喜欢的电影之一。)为例，而他以前显然是属于说唱这一流派的。但他的最新专辑(截至2020年底)主要由更适合摇滚风格的歌曲组成。<br/>此外，尽管本文对歌曲进行了分析，但是所使用的方法可以毫无问题地转移到其他信号处理任务中！由于大多数人喜欢音乐，我认为这个例子是最能说明问题的。</p><p id="a46b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因此，如果你对如何使用Python来分析不同的信号(音乐曲目)，基于不同的流派对它们进行聚类，并最终将歌曲分类为4种不同的流派感兴趣，这比使用Spotify提供的功能要好得多，那么这篇文章就是为你准备的！</p><h2 id="9ee4" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated">在我们开始之前，请不要跳过这一部分</h2><ul class=""><li id="24b9" class="mu mv iq lh b li mw ll mx lo my ls mz lw na ma nb nc nd ne bi translated">这个项目包括信号处理方法和各种机器学习技术，如主成分分析和支持向量机。由于项目的规模，并不是每种方法都可以详细解释。</li><li id="89a7" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">我也绝不是信号处理方法方面的专家，因此这里获得的结果只应被认为是第一个建议，当然也为优化提供了空间！</li><li id="b98d" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">出于隐私和许可的原因，我不能提供原始的音乐数据。然而，我亲自使用伟大的命令行应用程序<strong class="lh ja"> youtube-dl </strong> ( <a class="ae le" href="https://github.com/ytdl-org/youtube-dl" rel="noopener ugc nofollow" target="_blank"> Github链接</a>)提取了这些歌曲。我用来提取歌曲的Youtube上的一个播放列表的例子是<a class="ae le" href="https://www.youtube.com/watch?v=NUTGr5t3MoY&amp;list=PLpUmlJahfz1NieOw-QMBaVfxxUA1Fqfst" rel="noopener ugc nofollow" target="_blank">这个是朋克摇滚歌曲</a>。<br/>然而，在与这篇文章相关的GitHub存储库中，有一个<em class="mb"> features.csv </em>，其中包含了我使用的所有歌曲的所有提取特征。所以这个文件可以作为你自己分析的基础。</li></ul><p id="06c2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了不扩大项目范围，满足了以下条件:</p><ul class=""><li id="eae8" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated">只使用了四种风格的歌曲，<strong class="lh ja">朋克、古典、硬派和</strong>豪斯。总共使用了<strong class="lh ja"> 311首歌曲</strong>，在四个流派中的分布大致相等(详细分布如下)。</li><li id="9844" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">在选择流派时，我试图选择非常不同的流派，以便在歌曲之间有一定的分离。这里的一个例外是House和Hardstyle，它们在某些特征上是重叠的。这也是特意选择的，以便预测不太容易。<br/>由于摇滚&amp;硬摇滚等流派之间的界限变得越来越模糊，每个人对这些流派的定义都有所不同，理论上每个流派都可以划分得更细。我选择了非常明确的类型。在流派的定义中同样重要的是，Spotify上也有相同的流派，以便以后能够进行比较。</li></ul><p id="ed8a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">澄清这一点后，这里是我的GitHub页面的链接:</p><ul class=""><li id="4338" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated"><a class="ae le" href="https://github.com/maxistaebler/towardsdatascience/tree/main/music-genre-prediction" rel="noopener ugc nofollow" target="_blank"> GitHub库</a></li></ul><h2 id="7739" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated">行动（或活动、袭击）计划</h2><ul class=""><li id="e5ae" class="mu mv iq lh b li mw ll mx lo my ls mz lw na ma nb nc nd ne bi translated">第一步，我将描述我是如何为311首歌曲中的每一首提取特征的，以及提取了哪些特征——所有这些都借助于一个例子。</li><li id="a201" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">然后可用的数据将通过一个简短的探索性数据分析呈现，我将解释降维的必要性。</li><li id="e51f" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">在数据被降维后，我们将运行一个支持向量机，并尝试根据它们的声音特征将未见过的歌曲分类到四个流派中的一个。</li><li id="e825" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">此后，我将简要讨论如何使用Spotify API来提取Spotify上每首歌曲的特征。<br/>Spotify特征也将被降维并用于训练支持向量机。</li><li id="bc16" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">在最后一步中，将两个训练好的模型相互比较，并决定哪种方法给出更好的结果。</li></ul><h2 id="ed5c" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated">特征抽出</h2><p id="57a8" class="pw-post-body-paragraph lf lg iq lh b li mw ka lk ll mx kd ln lo nn lq lr ls no lu lv lw np ly lz ma ij bi translated">为了分析这些歌曲，从而能够创建描述给定声音的相应特征，我们将使用内置于<code class="fe nq nr ns nt b">librosa</code>中的不同的<em class="mb">特征提取</em>工具。Librosa是一个用于音乐和音频分析的python包。它提供了创建音乐信息检索系统所必需的构件。</p><p id="4c60" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一旦您使用曲库导入了一首歌曲，您就可以快速提取众多不同的特征来反映基础歌曲的特征。这方面的一个例子是分离歌曲的和声和乐器部分，这可以用几行Python代码来完成。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="91ee" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">但是为什么要进行这种分离呢？<br/> </strong>和声/打击乐分离的目的是将原始音乐信号分解为<em class="mb">和声</em>(即音高乐器)和<em class="mb">打击乐</em>(非音高乐器、打击乐)部分的信号。这种方法可以应用于音频混合软件，或者可以用作其他音乐信息检索方法的预处理，例如节奏分析或和弦/音调识别。该方法基于这样的假设，即谐波分量在声谱图上表现为水平线，而敲击声表现为垂直线。通过采用应用于声谱图的非线性图像滤波器来滤除该分量，所提出的方法是简单的、直观的，并且不对目标音乐的流派、风格或乐器进行任何先验假设。</p><p id="8a1e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">就不同乐器对不同流派的重要性而言，分成这两个部分是绝对有意义的。像古典音乐这样的流派通常没有占主导地位的打击乐器，而是专注于钢琴或长笛这样的和声乐器。另一方面，Hardstyle显然是由传入的鼓/低音节拍主导的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/553fab3cf607931a63e87496206a7683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_5Uq5ts07K1UFMQJK1yXgg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="http://mir.ilsp.gr/harmonic_percussive_separation.html" rel="noopener ugc nofollow" target="_blank">http://mir.ilsp.gr/harmonic_percussive_separation.html</a></figcaption></figure><p id="ce9b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">更多提取特征:</strong></p><ul class=""><li id="c560" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated"><strong class="lh ja"> RMS值及相关特性:</strong><br/>RMS(均方根)值是总波形的有效值。真的是曲线下的面积。在音频中，它是放大器可以提供的连续或音乐功率。<br/>使用RMS值使得计算更容易完成。<br/>底线:对于音频应用，我们的耳朵是均方根仪器，而不是峰值读数。因此，使用均方根值是有意义的，也是放大器通常的额定值。</li><li id="4d58" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">频谱质心:</strong>它表示声音的“质量中心”所在的位置，并计算为声音中频率的加权平均值。如果音乐中的频率始终相同，那么，频谱质心将围绕一个中心，如果在声音的末端有高频，那么质心将朝向其末端。</li><li id="626d" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">色度频率:</strong>色度特征是一种有趣而强大的音乐音频表示，其中整个频谱被投影到代表音乐八度音阶的12个不同半音(或色度)的12个箱上。这是人类如何将颜色与音符联系起来的表现。换句话说，我们认为来自两个不同八度的相同音符是相同的颜色。因此，每个窗口有12个可能的值。A，A#，B，C，C#，D，D#，E，F，F#，G，G#。当然，它们并不相互排斥；因此，对于给定的时间框架，一个人可以有一个以上的笔记。但是为了简单起见，我们将只为特定窗口选择最突出的音符。让我们用色度图来显示色度矢量。</li><li id="287d" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">光谱带宽:</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/acf8f683a93fe18be75fb2dd23f625f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/1*m33N4cJ5A7zjPE1theS-GA.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">计算p阶频谱带宽</figcaption></figure><p id="9752" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">其中<em class="mb"> S(k) </em>是频率仓k处的频谱幅度，<em class="mb"> f(k) </em>是仓k处的频率，fc是频谱质心。当p=2时，这就像一个加权标准差。</p><ul class=""><li id="ce4d" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated"><strong class="lh ja">谱对比:</strong> <br/>谱对比考虑了谱峰、谱谷，以及它们在各个频率子带中的差异。<br/>自动音乐类型分类对于数字音乐数据库的管理非常有帮助。提出了基于八进制的频谱对比度特征来表示音乐片段的频谱特征。它代表相对光谱分布，而不是平均光谱包络。实验表明，基于八度的谱对比度特征在音乐类型分类中表现良好。另一个对比实验表明，基于八度的谱对比度特征比以往音乐类型分类系统中常用的梅尔倒谱系数(MFCC)具有更好的音乐类型区分能力。<br/>声谱图S的每一帧被分成子带。对于每个子带，通过比较顶部分位数的平均能量(峰值能量)和底部分位数的平均能量(谷值能量)来估计能量对比。高对比度值通常对应于清晰的窄带信号，而低对比度值对应于宽带噪声。</li><li id="7e60" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">多项式特征:</strong> <br/>获取将n阶多项式拟合到声谱图各列的系数。</li><li id="8bcc" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">音调质心特征(tonnetz): </strong> <br/>在音乐调律与和声中，tonnetz(德语:tone-network)是一种代表音调空间的概念点阵图，最早由莱昂哈德·欧拉于1739年描述。Tonnetz的各种视觉表现可以用来展示欧洲古典音乐中的传统和声关系。</li><li id="7338" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">过零率:</strong> <br/>过零率是信号随符号变化的速率，即信号由正变负或由负变正的速率。这个特性已经在语音识别和音乐信息检索中大量使用。它通常具有较高的值，适用于像金属和摇滚这样的高敲击声。</li><li id="e221" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">频谱衰减:</strong>它是信号形状的量度。它表示总频谱能量的特定百分比(例如85%)低于的频率。</li><li id="7b8a" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">开始强度:</strong> <br/>计算光谱通量开始强度包络。t时刻的起始强度由<br/> <code class="fe nq nr ns nt b">mean_f max(0, S[f, t] - ref[f, t - lag])</code>确定，其中ref为沿频率轴进行局部最大滤波后的S。默认情况下，如果提供时间序列y，S将是对数幂Mel谱图。</li><li id="0425" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><strong class="lh ja">节拍信息:</strong> <br/>动态编程节拍跟踪器。按照以下方法在三个阶段检测节拍:<em class="mb">测量开始强度，根据开始相关性估计节奏，挑选开始强度中与估计节奏近似一致的峰值</em></li></ul><h2 id="c791" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated"><strong class="ak">特征提取的结果数据帧:</strong></h2><p id="069b" class="pw-post-body-paragraph lf lg iq lh b li mw ka lk ll mx kd ln lo nn lq lr ls no lu lv lw np ly lz ma ij bi translated">作为提取步骤的结果，我们得到一个28×311的数据帧，它包含每首歌曲的27个特征。这里要提到的重要一点是<strong class="lh ja">不是每个流派在数据集中都有相同数量的歌曲！</strong>我们有如下分布:</p><ul class=""><li id="aa04" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated">0: 经典:37 (~ 13%)</li><li id="3c1e" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">1: 硬风格:60 (~ 19%)</li><li id="2271" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">房子:80 (~ 25%)</li><li id="02e8" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">朋克:134人(~ 43%)</li></ul><p id="54ee" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这个CSV文件可以在我的<a class="ae le" href="https://github.com/maxistaebler/towardsdatascience/tree/main/music-genre-prediction" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到或者直接在这里下载<a class="ae le" href="https://raw.githubusercontent.com/maxistaebler/towardsdatascience/main/music-genre-prediction/data/features.csv" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="9457" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated">探索性数据分析</h2><p id="6161" class="pw-post-body-paragraph lf lg iq lh b li mw ka lk ll mx kd ln lo nn lq lr ls no lu lv lw np ly lz ma ij bi translated">现在我们已经提取了所有的特征，我们可以查看数据并为预测做准备。根据我的经验，首先要看的是数据的性质和不同协变量可能的相关性。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ny nv l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">不同协变量的相关性</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nz"><img src="../Images/ab738aa7eba952a41fdd3c5d0a9f852a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GrhRlW2TV2v_gArvGxdhOA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">数据框架的性质——不同协变量大小的巨大差异</figcaption></figure><p id="2752" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在我们分析这里显示的图片之前，我想指出的是，出于许可的原因，我也对个别歌曲的名称进行了匿名处理。单首歌曲的名称在这里仅由流派和每个流派的连续数字组成。查看这两个图，我们注意到，一方面，有些特征与其他特征密切相关，另一方面，单个特征的取值范围完全不同。一些协变量包含的值仅在0.04和0.05之间，而其他协变量的值超过4000。这两个问题都很正常，很容易解决。</p><p id="d76e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">由于较大的值在当前版本中将对机器学习模型具有更大的影响，但是对于流派预测来说，不一定比具有较小范围值的协变量更重要，所以所有列都被缩放到0和1之间的范围。接下来，我们通过执行主成分分析(PCA)来最小化数据内的相关性。<br/>这两种方法都是数据科学领域的绝对标准，并且已经在许多文章中进行了解释。因此，我将假定您了解这些方法。</p><p id="082b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这里有两篇很棒的文章，详细介绍了这两种方法:</p><ul class=""><li id="4a0c" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated"><a class="ae le" href="https://towardsdatascience.com/how-and-why-to-standardize-your-data-996926c2c832" rel="noopener" target="_blank">正常化</a>由<em class="mb">塞拉菲姆·卢卡斯</em></li><li id="c162" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated"><a class="ae le" href="https://towardsdatascience.com/understanding-pca-fae3e243731d" rel="noopener" target="_blank"> PCA </a>由<em class="mb">饶彤彤</em></li></ul><p id="f6af" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">归一化和降维的结果现在显示在这里。如果有兴趣，欢迎自行考察剧情。在这一点上，我想表明我是一个来自Plotly的交互式可视化的超级粉丝！如果你还不知道这个图书馆，你一定要花时间去探索它！绝对小费！</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ny nv l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">三种主要成分的三维散点图</figcaption></figure><p id="bdb0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">广告之后，现在回到主题:<br/>查看PCA图，我们看到虽然各个流派在某些地方重叠，但它们仍然形成了四个相对分离的簇。这已经是很好的迹象了！在进一步的检查中，我们可以从数据中得出进一步的结论，当从逻辑上并在四种流派和各自音乐的背景下考虑时，这些结论是绝对有意义的:</p><ul class=""><li id="e197" class="mu mv iq lh b li lj ll lm lo nk ls nl lw nm ma nb nc nd ne bi translated">古典歌曲代表了一种离群值，并且远离所有其他聚类。与其他音乐相比，古典音乐也包含了一种完全不同的音乐类型和不同的乐器。</li><li id="d07f" class="mu mv iq lh b li nf ll ng lo nh ls ni lw nj ma nb nc nd ne bi translated">Hardstyle和House比任何一种朋克风格都更相似。这也是绝对有道理的。Hardstyle和house绝对比punk流派有更多的音乐成分。</li></ul><p id="e859" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">人们当然可以从PCA图中得出进一步的见解和解释，例如聚类内的分散等。，但我把这个留给你。</p><p id="9df7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">到目前为止的步骤总结:</strong> <br/>我们分析了311首歌曲，提取特征，清理，降维。因此，这些数据现在可以用于机器学习模型了。在我们找到并训练了一个合适的模型后，我们会将我们的模型与Spotify API进行比较，以评估整个过程。准备好了吗？我们走吧！</p><h2 id="01cf" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated">现在有趣的部分是:火车，一个模型</h2><p id="f6da" class="pw-post-body-paragraph lf lg iq lh b li mw ka lk ll mx kd ln lo nn lq lr ls no lu lv lw np ly lz ma ij bi translated">让我们面对它当我刚开始接触数据科学时，我认为一个项目的大部分工作都花在创建和评估机器学习模型上。哦，天啊…要是我知道就好了…任何和机器学习打过交道的人都知道，数据的准备工作占据了大部分工作。当然，数据的质量对于从模型中获得可靠和稳健的结果极其重要——但幸运的是，我们现在已经做到了这两点！</p><blockquote class="oa ob oc"><p id="1249" class="lf lg mb lh b li lj ka lk ll lm kd ln od lp lq lr oe lt lu lv of lx ly lz ma ij bi translated">机器学习模型很简单:sh*t in，sh*t out！<br/> —我的数据挖掘教授</p></blockquote><p id="1eaf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这个项目的背景下，我测试了几个模型，但我想在这篇文章中只展示其中最好的。在这里，当然是请每一位读者自己做实验，寻找更好的模型！我也非常想知道利用现有的数据可以实现哪些其他或更好的分析！有这方面的可以随时联系我或者留言评论！</p><p id="f0f4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> SVM进行分类</strong></p><p id="da9a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了避免不必要地夸大文章的篇幅，我将不再解释SVM是如何运作的，也不再解释我对SVM的决策过程。但是，如果你对如何评估分类和比较不同的模型感兴趣，欢迎你阅读我关于它的文章(<a class="ae le" href="https://medium.com/towards-artificial-intelligence/data-science-evaluation-metrics-unravel-algorithms-267c55f09fa2" rel="noopener">数据科学评估度量标准—解开分类的算法</a>)。</p><p id="e1e2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">关于SVM的实现，我想指出的是，我能够通过分层训练和测试数据集实现更高的准确性。在传统的<em class="mb"> train_test_split </em>中可以传递的参数负责处理这一点，并确保在每个训练和验证折叠中近似保留相对类频率。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">为分类训练一个SVM</figcaption></figure><p id="2986" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在所有四种类型中，我们得到了平均95%的预测准确率。从分类报告和混淆矩阵中可以看出，就精确度或召回率而言，各个流派甚至被完美地分类为“<em class="mb">”。<br/>简而言之:Precision表示选择了多少个相关项，recall表示选择了多少个相关项。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/9368f2571a3d35ea83c321f190b59f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sWu4o4NV-6Pf8s03yalQUw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">混淆矩阵和分类报告</figcaption></figure><p id="0d0e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">95%的准确率已经很不错了，现在我们要弄清楚，利用Spotify API提供的功能和相同的机器学习模型&amp;准备步骤，我们能获得什么样的准确率。</p><h2 id="4a9e" class="mc md iq bd me mf mg dn mh mi mj dp mk lo ml mm mn ls mo mp mq lw mr ms mt iw bi translated">Spotify API——强大的工具！</h2><p id="70a2" class="pw-post-body-paragraph lf lg iq lh b li mw ka lk ll mx kd ln lo nn lq lr ls no lu lv lw np ly lz ma ij bi translated">Spotify和AppleMusic可能是西方世界最知名的音乐流媒体服务。然而，不为人知的是Spotify提供给每位付费用户的强大API。你可以写一整篇关于你可以用这个API做什么的文章(也许我会写)，但是在这篇文章中，我想参考我的GitHub库中相应的笔记本，并且简单地解释一下我到底做了什么。还有许多关于如何使用API的文章。</p><p id="381f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在Spotify注册为开发者(任何人都可以这样做)并被分配API令牌后，您可以使用库<a class="ae le" href="https://spotipy.readthedocs.io/en/2.16.1/" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja"> <em class="mb"> Spotify </em> </strong> </a>来提取Spotify上任何可用歌曲的信息。下面是乐队<em class="mb"> Green Day </em>的经典朋克经典<em class="mb">废人</em>的一个例子:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">使用Spotify进行特征提取的Python代码</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/16cfd2a9973ed422d03f63729233f7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dd7Mz4DnuqC3SwQptNjwtQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">绿日的Spotify功能</figcaption></figure><p id="88b7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下表显示了Spotify提供的功能。在Spotify的API文档中可以直接找到对这些功能的详细描述和解释。该文档还提供了一个交互式部分，您可以在其中分析自己的歌曲——请查看[ <a class="ae le" href="https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/" rel="noopener ugc nofollow" target="_blank"> SPOTIFY API链接</a> ]。</p><p id="ec68" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">无论如何，API也提供了直接分析整个播放列表的可能性，并为播放列表中的每个曲目准确提取上面显示的这些特征。<br/>因此，为了获得一个可比较的数据集，我在我的个人资料中创建了一个播放列表，其中包含我已经用于自己的特征提取的相同歌曲，然后用API对其进行解析。因为我现在还不确定是否允许我发表这些数据，所以我没有这样做。但是有了我提供的笔记本，你就可以通过自定义凭证，用自己的播放列表(或者Spotify预先制作的播放列表)创建自己的数据集了！该笔记本名为<em class="mb"> SPOTIFY_FEATURES.ipynb </em>。</p><p id="5917" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在执行相同的预处理步骤后，我们可以再次查看数据的前三个主要组成部分，并与我们自己提取的特征进行第一次比较:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ny nv l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">链接:<a class="ae le" href="https://chart-studio.plotly.com/~maximuskarlson/11" rel="noopener ugc nofollow" target="_blank">https://chart-studio.plotly.com/~maximuskarlson/11</a></figcaption></figure><p id="2aad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你一眼就能看出来，经典歌曲与其他三个流派的区分甚至比以前更加明显，但其余三个流派却极其重叠。朋克、豪斯和硬派之间没有明确的界限。因此，我们也期望在我们的SVM的实施中有低得多的准确度。这遵循与之前完全相同的方法，并提供以下结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oi"><img src="../Images/3369fdd2f1049b05cd16938c67e4b82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kj6wDLStm0uziV9K1wEXfw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Spotify分类结果</figcaption></figure><p id="61a5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">正如预期的那样，分类的准确性要差得多。现在的机器学习模型，加上现在的特征，好像把大部分的歌都分配给了流派朋克。在任何情况下，总体精度都比具有自提取特征的模型差得多。</p><blockquote class="oj"><p id="3c06" class="ok ol iq bd om on oo op oq or os ma dk translated">巨大成功<br/> —波拉特</p></blockquote><h2 id="a7fa" class="mc md iq bd me mf ot dn mh mi ou dp mk lo ov mm mn ls ow mp mq lw ox ms mt iw bi translated">摘要</h2><p id="7482" class="pw-post-body-paragraph lf lg iq lh b li mw ka lk ll mx kd ln lo nn lq lr ls no lu lv lw np ly lz ma ij bi translated">在本文中，介绍了一种从音乐曲目中提取属性的方法，该方法允许比Spotify为每首歌曲提供的属性更精确地分类为四种风格。虽然Spotify只提供了9个功能，而不是我们自己的方法中的27个，但可以表明，这9个提供的功能并不真正适合将一首音乐分配给四个选定流派中的一个。<br/>Spotify API的巨大规模和可能性无疑是在这一领域进行进一步研究的良好起点。这个接口当然也适用于其他项目。</p><p id="ee40" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">非常感谢您的关注！</p><p id="2421" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">保持联系:</strong></p><p id="979d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">领英:【https://www.linkedin.com/in/maximilianstaebler】T4T6】推特:<a class="ae le" href="https://twitter.com/ms_staebler" rel="noopener ugc nofollow" target="_blank">https://twitter.com/ms_staebler</a></p></div></div>    
</body>
</html>