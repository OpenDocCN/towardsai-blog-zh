<html>
<head>
<title>Custom Network with Resnet, Densenet, Inception blocks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Resnet、Densenet、Inception模块的自定义网络</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/custom-network-with-resnet-densenet-inception-blocks-c32fc595085d?source=collection_archive---------1-----------------------#2020-03-17">https://pub.towardsai.net/custom-network-with-resnet-densenet-inception-blocks-c32fc595085d?source=collection_archive---------1-----------------------#2020-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d9a9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Monk，低代码深度学习工具和计算机视觉的统一包装器，使计算机视觉变得简单。</h2></div><p id="fd89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有没有想过尝试用Resnet、Densenet、Inception等不同的块来搭建一个网络？</p><p id="dfdb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我假设你已经熟悉计算机视觉的基础知识。在深入研究之前，确保你知道什么是Resnet，什么是Densenet，什么是Inception。</p><blockquote class="lb"><p id="bc55" class="lc ld iq bd le lf lg lh li lj lk la dk translated">我们开始吧</p></blockquote></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h1 id="7e5d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">目录</h1><ol class=""><li id="246a" class="mk ml iq kh b ki mm kl mn ko mo ks mp kw mq la mr ms mt mu bi translated"><strong class="kh ir">安装</strong></li><li id="c3b4" class="mk ml iq kh b ki mv kl mw ko mx ks my kw mz la mr ms mt mu bi translated"><strong class="kh ir">加载数据</strong></li><li id="842b" class="mk ml iq kh b ki mv kl mw ko mx ks my kw mz la mr ms mt mu bi translated"><strong class="kh ir">创建并调试网络</strong></li><li id="42d7" class="mk ml iq kh b ki mv kl mw ko mx ks my kw mz la mr ms mt mu bi translated"><strong class="kh ir">列车</strong></li></ol></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h1 id="5a48" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">安装</strong></h1><p id="013b" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">安装Monk，一个低代码深度学习工具，也是计算机视觉的统一包装器。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="cc19" class="nm lt iq ni b gy nn no l np nq">$git clone <a class="ae nr" href="https://github.com/Tessellate-Imaging/monk_v1.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Tessellate-Imaging/monk_v1.git</a></span><span id="7f68" class="nm lt iq ni b gy ns no l np nq">#Select the requirements file as per OS and CUDA version</span><span id="87be" class="nm lt iq ni b gy ns no l np nq">$cd monk_v1/installation/Linux &amp;&amp; pip install -r requirements_cu9.txt</span></pre></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h1 id="ce14" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">加载数据</strong></h1><p id="9f54" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">这里我们使用的是<a class="ae nr" href="https://www.kaggle.com/jessicali9530/stanford-dogs-dataset" rel="noopener ugc nofollow" target="_blank">斯坦福狗分类数据集</a>。</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="dd1f" class="nm lt iq ni b gy nn no l np nq">$! wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&amp;confirm=$(wget --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=1b4tC_Pl1O80of7U-PJ7VExmszzSX3ZEM' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/<strong class="ni ir">\1\n</strong>/p')&amp;id=1b4tC_Pl1O80of7U-PJ7VExmszzSX3ZEM" -O dogs-species-dataset.zip &amp;&amp; rm -rf /tmp/cookies.txt</span></pre></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h1 id="25b9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">创建并调试网络</strong></h1><p id="8c75" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">这里我们创建一个网络，并追加resnet_v1_block和resnet_v2_block。</p><figure class="nd ne nf ng gt nt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b48f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">调试定制模型</strong></p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="8628" class="nm lt iq ni b gy nn no l np nq">$ gtf.debug_custom_model_design(network);</span></pre><figure class="nd ne nf ng gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/40ba2ea6c383335e73d59f7375e5f539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFKbOT2S1bYL5SI5SZxCIg.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">从下往上看</figcaption></figure><p id="eb70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将追加resnet _ v1 _瓶颈_块和resnet _ v2 _瓶颈_块</p><figure class="nd ne nf ng gt nt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b17a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">调试定制模型</strong></p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="2e8c" class="nm lt iq ni b gy nn no l np nq">$ gtf.debug_custom_model_design(network);</span></pre><figure class="nd ne nf ng gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/4553ecd872c9f09550565d6eef1c78ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gRD0fpPmjgScSIi1EdBQag.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">从下往上看</figcaption></figure><p id="1367" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们将追加densenet_block，inception_a_block和inception_c_block。</p><figure class="nd ne nf ng gt nt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="1e51" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">调试定制模型</strong></p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="fa91" class="nm lt iq ni b gy nn no l np nq">$ gtf.debug_custom_model_design(network);</span></pre><figure class="nd ne nf ng gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/f276080065ba9ff75ac03e88fa9d54bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m66yhxZ_hhG0VKlKZWEVvw.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">从下往上看</figcaption></figure><p id="98fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们展平，添加一个完全连接的层，然后是一个完全连接的层，其中神经元(单元)的数量=自定义数据集中的类的数量。</p><figure class="nd ne nf ng gt nt"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="bcf6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">调试定制模型</strong></p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="247a" class="nm lt iq ni b gy nn no l np nq">$ gtf.debug_custom_model_design(network);</span></pre><figure class="nd ne nf ng gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/7beab85c37b99c6d469b3a5366bab895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GmPtoQLjSz6X6WPDUv4q1w.png"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">从下往上看</figcaption></figure><h1 id="2080" class="ls lt iq bd lu lv oh lx ly lz oi mb mc jw oj jx me jz ok ka mg kc ol kd mi mj bi translated">用Netron可视化</h1><figure class="nd ne nf ng gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi om"><img src="../Images/02205cdfba57c38044faf66a1f6cedaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoVRlvRTY5WE1y1RM69XUg.png"/></div></div></figure></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h1 id="991e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">列车</strong></h1><p id="dfc1" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated"><em class="on">设置时期、优化器、损耗和学习率调度程序。</em></p><figure class="nd ne nf ng gt nt"><div class="bz fp l di"><div class="nu nv l"/></div></figure></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="3470" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在<a class="ae nr" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/1_getting_started_roadmap/9_custom_network_builder/3)%20Create%20a%20custom%20network%20with%20blocks%20while%20debugging%20it-Copy1.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到完整的jupyter笔记本。</p><p id="e260" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如有疑问，可联系<a class="ae nr" href="https://www.linkedin.com/in/abhishek-kumar-annamraju/" rel="noopener ugc nofollow" target="_blank">阿布舍克</a>和<a class="ae nr" href="https://www.linkedin.com/in/akashdeepsingh01/" rel="noopener ugc nofollow" target="_blank">阿卡什</a>。请随意联系他们。</p><p id="d37c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我对计算机视觉和深度学习充满热情。我是<a class="ae nr" href="https://github.com/Tessellate-Imaging/Monk_Object_Detection" rel="noopener ugc nofollow" target="_blank"> Monk </a>库的开源贡献者。</p><p id="e413" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你也可以在以下网址看到我的其他作品:</p><div class="oo op gp gr oq or"><a href="https://medium.com/@akulahemanth" rel="noopener follow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd ir gy z fp ow fr fs ox fu fw ip bi translated">阿库拉·赫曼思·库马尔培养基</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">阅读阿库拉·赫曼思·库马尔在媒介上的作品。计算机视觉爱好者。每天，阿库拉·赫曼思·库马尔和…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ob or"/></div></div></a></div></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><figure class="nd ne nf ng gt nt gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi pg"><img src="../Images/4c37da5168beeeff28953982b4788120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ehOY2buBocQcdD2feAuSQ.jpeg"/></div></div><figcaption class="od oe gj gh gi of og bd b be z dk translated">照片由<a class="ae nr" href="https://unsplash.com/@hectorfalcon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">赫克托隼</a>在<a class="ae nr" href="https://unsplash.com/t/architecture?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div></div>    
</body>
</html>