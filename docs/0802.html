<html>
<head>
<title>Fire Detection using CCTV images — Monk Library Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CCTV图像的火灾探测— Monk库应用程序</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/fire-detection-using-cctv-images-monk-library-application-242df1fca2b9?source=collection_archive---------1-----------------------#2020-08-15">https://pub.towardsai.net/fire-detection-using-cctv-images-monk-library-application-242df1fca2b9?source=collection_archive---------1-----------------------#2020-08-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="01cc" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a>，<a class="ae ep" href="https://towardsai.net/p/category/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="574a" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">关于如何在火灾探测等现实应用中使用Monk库的文章。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b98466790a124f4a97f590ea7b447258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bKoRLjT5YJcIoIEs"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@lemondyt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马尔科·霍尔瓦特</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="f68c" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">目标</h1><ul class=""><li id="92a9" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">用<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1" rel="noopener ugc nofollow" target="_blank">僧库</a>做一个探火深度学习模型，转移学习。</li><li id="d450" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">比较<a class="ae le" href="https://keras.io/api/applications/mobilenet/#mobilenetv2-function" rel="noopener ugc nofollow" target="_blank"> mobilenet-v2 </a>、<a class="ae le" href="https://keras.io/api/applications/densenet/#densenet121-function" rel="noopener ugc nofollow" target="_blank"> densenet121 </a>和<a class="ae le" href="https://keras.io/api/applications/densenet/" rel="noopener ugc nofollow" target="_blank"> densenet201 </a>。</li></ul><p id="7690" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">详细的教程可以在<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20Fire%20presence%20recognition%20in%20cctv-images.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h2 id="522e" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">关于数据集。</h2><ul class=""><li id="5235" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">因为闭路电视图像的数据集非常少。因此，我从Kaggle获取了2个数据集。</li><li id="3dc9" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">第一个<a class="ae le" href="https://www.kaggle.com/phylake1337/fire-dataset" rel="noopener ugc nofollow" target="_blank">包含火灾和非火灾图像，第二个</a><a class="ae le" href="https://www.kaggle.com/ritupande/fire-detection-from-cctv" rel="noopener ugc nofollow" target="_blank">包含CCTV火灾和非火灾图像。</a></li><li id="0106" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">然后我合并了这两个数据集以获得更高的准确性。</li></ul><h2 id="38f9" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">关于Monk库和Monk如何让图像分类变得简单</h2><ul class=""><li id="7622" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">编写更少的代码，创建端到端的应用程序。</li><li id="4e16" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">只学习一种语法，使用任何深度学习库——py torch、mxnet、Keras、TensorFlow等，创建应用。</li><li id="6f21" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">通过多个实验轻松管理您的整个项目。</li></ul><h2 id="1fb5" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">这座图书馆是为谁而建的</h2><ul class=""><li id="fc5e" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">学生:使用我们的综合学习路线图无缝学习计算机视觉。</li><li id="ddeb" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">研究人员和开发人员:创建和管理多个深度学习项目。</li><li id="cd69" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">Kaggle、Codalab、HackerEarth、AiCrowd等上的比赛参与者。</li></ul><h2 id="4d19" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">目录</h2><ol class=""><li id="68c5" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk nu mm mn mo bi translated">安装Monk</li><li id="c9bb" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated">使用预先训练的火灾探测模型</li><li id="1f1e" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated">从头开始训练分类器</li></ol><ul class=""><li id="0fcd" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated"><em class="ny">加载数据集</em></li><li id="1bc4" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated"><em class="ny">导入Keras后端</em></li><li id="ed3f" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated"><em class="ny">使用mobilenet_v2作为迁移学习架构的培训模型</em></li><li id="9c9c" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated"><em class="ny">使用desnenet121作为迁移学习架构的培训模式</em></li><li id="86d7" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated"><em class="ny">使用densenet201作为迁移学习架构的培训模式</em></li><li id="1972" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated"><em class="ny">比较所有型号。</em></li></ul><p id="f2c1" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">4.结论</p><h1 id="6d19" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">1.安装Monk</h1><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="a3ae" class="nj lg iq oa b gy oe of l og oh">#using cuda10.0 download monk using following command<br/>pip install -U monk-cuda100</span></pre><p id="b393" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">更多安装方法请访问<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1#installation" rel="noopener ugc nofollow" target="_blank"> Monk库</a>。</p><h1 id="8ca6" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">2.使用预先训练好的模型进行演示</h1><p id="740b" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">首先，从google drive下载预先训练好的模型。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="7b46" class="nj lg iq oa b gy oe of l og oh">#download the pre-trained models</span><span id="7f9c" class="nj lg iq oa b gy ol of l og oh">! wget --load-cookies /tmp/cookies.txt "<a class="ae le" href="https://docs.google.com/uc?export=download&amp;confirm=$(wget" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/uc?export=download&amp;confirm=$(wget</a> --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate '<a class="ae le" href="https://docs.google.com/uc?export=download&amp;id=1tTJ6KEkzv1GIRsvo_-wI6YQh7iztbDCW'" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/uc?export=download&amp;id=1tTJ6KEkzv1GIRsvo_-wI6YQh7iztbDCW'</a> -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&amp;id=1tTJ6KEkzv1GIRsvo_-wI6YQh7iztbDCW" -O cls_fire_trained.zip &amp;&amp; rm -rf /tmp/cookies.txt</span></pre><p id="e311" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">上面会下载预训练模型的zip文件，命名为cls_fire_trained.zip，现在我们要解压文件了。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="9423" class="nj lg iq oa b gy oe of l og oh">! unzip -qq cls_fire_trained.zip</span></pre><p id="6635" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">导入<strong class="lz ja"><em class="ny">monk . keras _ prototype</em></strong><em class="ny"/>用于使用monk库。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="8c20" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#Using keras backend</em></span><span id="8cf3" class="nj lg iq oa b gy ol of l og oh"><em class="ny"># When installed using pip</em><br/><strong class="oa ja">from</strong> <strong class="oa ja">monk.keras_prototype</strong> <strong class="oa ja">import</strong> <strong class="oa ja">prototype</strong></span></pre><p id="cb5f" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">以推断模式加载模型。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="79f4" class="nj lg iq oa b gy oe of l og oh">keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "mobilenet_v2", eval_infer=<strong class="oa ja">True</strong>);<br/><br/><em class="ny">#uncomment to use these model</em><br/><em class="ny">#keras_gtf.Prototype("Fire-detection", "densenet121", eval_infer=True);</em><br/><em class="ny">#keras_gtf.Prototype("Fire-detection", "densenet201", eval_infer=True);</em></span></pre><h2 id="3fb4" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">根据一些样本推断</h2><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="9fe4" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/1.jpg"<br/>predictions = gtf.Infer(img_name=img_name);<br/>from IPython.display import Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/dbd48ee315eb566110cdf902a348965e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z99noWqOyXdGAMOeakF3iQ.png"/></div></div></figure><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="cbb2" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/9.jpg"<br/>predictions = keras_gtf.Infer(img_name=img_name)<br/><em class="ny">#Display </em><br/><strong class="oa ja">from</strong> <strong class="oa ja">IPython.display</strong> <strong class="oa ja">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi on"><img src="../Images/dae6e1e6625b3385317692412b521f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8UL2-biyL9SV2YPPOAAhw.png"/></div></div></figure><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="1b92" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/11.jpg"<br/>predictions = keras_gtf.Infer(img_name=img_name)<br/><em class="ny">#Display </em><br/><strong class="oa ja">from</strong> <strong class="oa ja">IPython.display</strong> <strong class="oa ja">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/dd24010b76ac3c4b1b0b4956eaca5b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jc5u8xBwsHg7aHPKW18f7Q.png"/></div></div></figure><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="6834" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/5.jpg"<br/>predictions = keras_gtf.Infer(img_name=img_name)<br/><em class="ny">#Display </em><br/><strong class="oa ja">from</strong> <strong class="oa ja">IPython.display</strong> <strong class="oa ja">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi op"><img src="../Images/f62e04af9840b9b6d3d732244ccea55a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7LTQUrg4pV09J3OQ67E5vg.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/ec9ceccb05d9037789f20e1def12ab14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/1*OaM_s768IcAUJdQFnJm4CA.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">输出</figcaption></figure><p id="c13b" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">如需更多示例，请访问笔记本。</p><h1 id="26f8" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">3.从头开始训练分类器</h1><h2 id="b51e" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">近期内容</h2><ul class=""><li id="ad57" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">加载数据集</li><li id="8762" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">正在导入Keras后端</li><li id="a143" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">使用mobilenet_v2作为迁移学习架构的训练模型</li><li id="3dfe" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">使用desnenet121作为迁移学习架构的训练模型</li><li id="790d" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">使用densenet201作为迁移学习架构的训练模型</li><li id="6b65" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">比较所有的模型。</li></ul><h2 id="461c" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">加载数据集</h2><p id="bd50" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">数据集配额:</p><ol class=""><li id="967a" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk nu mm mn mo bi translated"><a class="ae le" href="https://www.kaggle.com/phylake1337/fire-dataset" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/phylake1337/fire-dataset</a></li><li id="a983" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated"><a class="ae le" href="https://www.kaggle.com/ritupande/fire-detection-from-cctv" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/ritupande/fire-detection-from-cctv</a></li></ol><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="c2fa" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#since dataset is from kaggle we have to install it</em><br/>! pip install -q kaggle<br/><br/>! mkdir ~/.kaggle<br/>! cp kaggle.json ~/.kaggle/ <br/>! chmod 600 ~/.kaggle/kaggle.json</span><span id="96fa" class="nj lg iq oa b gy ol of l og oh">! kaggle datasets download -d ritupande/fire-detection-from-cctv<br/><br/>! unzip -qq fire-detection-from-cctv.zip -d fire-dataset</span></pre><h2 id="f34d" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">正在导入Keras后端</h2><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="921b" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#Using keras backend</em><br/><em class="ny">#when installed using pip</em><br/><strong class="oa ja">from</strong> <strong class="oa ja">monk.keras_prototype</strong> <strong class="oa ja">import</strong> prototype<br/><br/><em class="ny"># When installed manually (Uncomment the following)</em><br/><em class="ny">#import os</em><br/><em class="ny">#import sys</em><br/><em class="ny">#sys.path.append("monk_v1/");</em><br/><em class="ny">#sys.path.append("monk_v1/monk/");</em><br/><em class="ny">#from monk.keras_prototype import prototype</em></span></pre><h2 id="4bc9" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">使用mobilenet_v2作为迁移学习架构的训练模型</h2><p id="d1f8" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">步骤1:加载实验并插入数据。更多详情请访问。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="b214" class="nj lg iq oa b gy oe of l og oh"><em class="ny"># Load experiment</em><br/>keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "mobilenet_v2");<br/><br/><em class="ny"># Insert data and set params in default mode</em><br/>keras_gtf.Default(dataset_path="fire-dataset/fire_dataset", <br/>                  model_name="mobilenet_v2", <br/>                  freeze_base_network=<strong class="oa ja">False</strong>,<br/>                  num_epochs=15)</span></pre><p id="d2a2" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤2:训练模型。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="e821" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#Start Training</em><br/>keras_gtf.Train();<br/><br/><em class="ny">#Read the training summary generated once you run the cell and training is completed</em></span></pre><p id="1353" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤3:在推断模式下加载模型，检查它的工作情况。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="f47a" class="nj lg iq oa b gy oe of l og oh"><em class="ny"># Load for test</em><br/>keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "mobilenet_v2", eval_infer=<strong class="oa ja">True</strong>);</span></pre><p id="e75e" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤4:给出测试图像的路径。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="8f68" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/1.jpg"<br/>predictions = keras_gtf.Infer(img_name=img_name)<br/><em class="ny">#Display </em><br/><strong class="oa ja">from</strong> <strong class="oa ja">IPython.display</strong> <strong class="oa ja">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/434a548ce825f00a24bdef572637cfbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*jqYxqG-civbfhzBcVWl-Uw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上面代码的输出</figcaption></figure><p id="a8c7" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">欲了解更多详情和结果，请访问<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20Fire%20presence%20recognition%20in%20cctv-images.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>。</p><h2 id="97f2" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">使用desnenet121作为迁移学习架构的训练模型</h2><p id="b0ee" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">步骤1:加载实验并插入数据。更多详情请访问。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="56bc" class="nj lg iq oa b gy oe of l og oh"><em class="ny"># Load experiment</em><br/>keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "densenet121");<br/><br/><em class="ny"># Insert data and set params in default mode</em><br/>keras_gtf.Default(dataset_path="fire-dataset/fire_dataset", <br/>                  model_name="densenet121", <br/>                  freeze_base_network=<strong class="oa ja">False</strong>, <br/>                  num_epochs=15)</span></pre><p id="5e5d" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤2:训练模型。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="b1e8" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#Start Training</em><br/>keras_gtf.Train();<br/><br/><em class="ny">#Read the training summary generated once you run the cell and training is completed</em></span></pre><p id="04b0" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤3:在推断模式下加载模型，检查它的工作情况。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="f69c" class="nj lg iq oa b gy oe of l og oh"><em class="ny"># Load for test</em><br/>keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "densenet121", eval_infer=<strong class="oa ja">True</strong>);</span></pre><p id="6ae3" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤4:给出测试图像的路径。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="1d56" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/1.jpg"<br/>predictions = keras_gtf.Infer(img_name=img_name)<br/><em class="ny">#Display </em><br/><strong class="oa ja">from</strong> <strong class="oa ja">IPython.display</strong> <strong class="oa ja">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi os"><img src="../Images/6934aacca23236bd45d7f1b9500a00ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*0vhgivQh-wLD-vm_ouNphA.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上面代码的输出</figcaption></figure><p id="fb4c" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">欲了解更多详情和结果，请访问<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20Fire%20presence%20recognition%20in%20cctv-images.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>。</p><h2 id="7e1f" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">以desnenet201为迁移学习架构的训练模型</h2><p id="25ee" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">步骤1:加载实验并插入数据。更多详情请访问<a class="ae le" href="https://clever-noyce-f9d43f.netlify.app/#/quick_mode/quickmode_keras" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="2829" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#Load experiment</em><br/>keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "densenet201");<br/><br/><em class="ny"># Insert data and set params in default mode</em><br/>keras_gtf.Default(dataset_path="fire-dataset/fire_dataset", <br/>                  model_name="densenet201", <br/>                  freeze_base_network=<strong class="oa ja">False</strong>, <br/>                  num_epochs=15)</span></pre><p id="35b7" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤2:训练模型。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="4226" class="nj lg iq oa b gy oe of l og oh"><em class="ny">#Start Training</em><br/>keras_gtf.Train();<br/><br/><em class="ny">#Read the training summary generated once you run the cell and training is completed</em></span></pre><p id="06c3" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤3:在推断模式下加载模型，检查它的工作情况。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="30b9" class="nj lg iq oa b gy oe of l og oh"><em class="ny"># Load for test</em><br/>keras_gtf = prototype(verbose=1);<br/>keras_gtf.Prototype("Fire-detection", "densenet201", eval_infer=<strong class="oa ja">True</strong>);</span></pre><p id="5376" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤4:给出测试图像的路径。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="f642" class="nj lg iq oa b gy oe of l og oh">img_name = "workspace/Fire-detection/test/1.jpg"<br/>predictions = keras_gtf.Infer(img_name=img_name)<br/><em class="ny">#Display </em><br/><strong class="oa ja">from</strong> <strong class="oa ja">IPython.display</strong> <strong class="oa ja">import</strong> Image<br/>Image(filename=img_name, height=300, width=300)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a84f49d328e9d29ba840a5473ccffbd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*FyEuRXezz8mDALY_xFUD7A.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上面代码的输出</figcaption></figure><p id="b9bd" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">更多详情和结果，请访问<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20Fire%20presence%20recognition%20in%20cctv-images.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>。</p><h2 id="dbaf" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">比较所有的模型。</h2><p id="f776" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">步骤1:使用Monk库的比较类。更多详情<a class="ae le" href="https://clever-noyce-f9d43f.netlify.app/#/compare_experiment" rel="noopener ugc nofollow" target="_blank">请访问</a>。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="4f1f" class="nj lg iq oa b gy oe of l og oh"><em class="ny"># Invoke the comparison class</em><br/>from monk.compare_prototype import compare</span></pre><p id="5d4c" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤2:创建和管理比较实验。提供项目名称。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="71c5" class="nj lg iq oa b gy oe of l og oh">gtf = compare(verbose=1);<br/>gtf.Comparison("Comparison-fire-detector");</span></pre><p id="91d3" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">这将按照以下结构创建文件和目录</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="1fb4" class="nj lg iq oa b gy oe of l og oh">workspace<br/>    |<br/>    |--------comparison<br/>                    |<br/>                    |<br/>                    |-----Compare-fire-detection<br/>                                |<br/>                                |------stats_best_val_acc.png<br/>                                |------stats_max_gpu_usage.png<br/>                                |------stats_training_time.png<br/>                                |------train_accuracy.png<br/>                                |------train_loss.png<br/>                                |------val_accuracy.png<br/>                                |------val_loss.png                    <br/>                    |-----comparison.csv (Contains necessary details of all experiments)</span></pre><p id="8745" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤3:步骤3:将实验添加到比较对象中。</p><ul class=""><li id="8923" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">第一个参数—项目名称。</li><li id="ba7c" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk ml mm mn mo bi translated">第二个参数—实验名称。</li></ul><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="90f5" class="nj lg iq oa b gy oe of l og oh">#Add the trained models<br/>gtf.Add_Experiment("Fire-detection", "mobilenet_v2");<br/>gtf.Add_Experiment("Fire-detection", "densenet121");<br/>gtf.Add_Experiment("Fire-detection", "densenet201");</span></pre><p id="e668" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤4:运行分析。该步骤生成七幅图像。</p><pre class="kp kq kr ks gt nz oa ob oc aw od bi"><span id="3f14" class="nj lg iq oa b gy oe of l og oh">gtf.Generate_Statistics();</span></pre><p id="dd8c" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">步骤5:可视化研究比较指标。</p><ul class=""><li id="aebd" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">训练准确度曲线</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/ba020e722dfd1afff76c977abdf107cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqXozwOKBBl1lHB8Ij0fng.png"/></div></div></figure><ul class=""><li id="b9b5" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">训练损失曲线</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/cb4a3f9823dfc829eae7e64907c6a893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aX0X5bHAZAHGl-gTLLmbig.png"/></div></div></figure><ul class=""><li id="dd27" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">验证准确度曲线</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/adbfe6104da98d8630334633f0b9636e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Llwjk5oV6XVRnuH16tED-w.png"/></div></div></figure><ul class=""><li id="853b" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">验证损失曲线</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/32e77d700bee246e4b41a79328244dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyoQJQiTC-116Cez36ooUA.png"/></div></div></figure><ul class=""><li id="08b7" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">花费的培训时间。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/c57a39550f97335a261612404544df31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UqCSC6FMFTySGF3mDol3DQ.png"/></div></div></figure><ul class=""><li id="dc2e" class="lx ly iq lz b ma mw mc my me nv mg nw mi nx mk ml mm mn mo bi translated">最佳验证准确性。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/a892f1f8ca9ea1b7c2d3d6344c1718e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f4fSX-Iqix2jnCLROmsVRQ.png"/></div></div></figure><h1 id="eeb6" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">4.结论</h1><ol class=""><li id="8f08" class="lx ly iq lz b ma mb mc md me mf mg mh mi mj mk nu mm mn mo bi translated">Monk library让学生、研究人员和竞争对手可以非常轻松地创建深度学习模型，并尝试不同的超参数调整来提高模型的准确性。</li><li id="f3ff" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated">预先训练的模型可以直接下载使用，而无需进入模型创建部分。</li><li id="d568" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated">从上面的图表中，我们可以看到，在这个数据集中，densenet121优于其他模型。</li><li id="7fcf" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated">densenet201型号所用的时间约为1500秒，比densenet121多50%,比mobilenet_v2多60%。</li><li id="1c25" class="lx ly iq lz b ma mp mc mq me mr mg ms mi mt mk nu mm mn mo bi translated">训练时间的不同是由于训练层数的不同。</li></ol><h2 id="fac8" class="nj lg iq bd lh nk nl dn ll nm nn dp lp me no np lr mg nq nr lt mi ns nt lv iw bi translated">感谢阅读。</h2><p id="8d52" class="pw-post-body-paragraph mu mv iq lz b ma mb ka mx mc md kd mz me oi nb nc mg oj ne nf mi ok nh ni mk ij bi translated">再举一个例子</p><p id="5f06" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated"><a class="ae le" href="https://towardsdatascience.com/image-classifier-house-room-type-classification-using-monk-library-d633795a42ef" rel="noopener" target="_blank">https://towards data science . com/image-classifier-house-room-type-class ification-using-monk-library-d 633795 a 42 ef</a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/3cffcc23a3bdde0ec87c128b6d0ca8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/1*x5_q0fLXelcDMZfA4luH7w.gif"/></div></figure><p id="745c" class="pw-post-body-paragraph mu mv iq lz b ma mw ka mx mc my kd mz me na nb nc mg nd ne nf mi ng nh ni mk ij bi translated">嗨，我是Rohit，我是BTech。最后一年学生。我有机器学习和深度学习的知识。我有兴趣在人工智能和人工智能领域工作。目前，我在Tessellate Imaging公司做计算机视觉实习生。在<a class="ae le" href="https://www.linkedin.com/in/rohit96/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上与我联系。</p></div></div>    
</body>
</html>