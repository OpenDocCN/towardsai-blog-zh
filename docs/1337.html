<html>
<head>
<title>Using Prophet to predict Bitcoin prices for 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Prophet预测2021年比特币价格</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/using-prophet-to-predict-bitcoin-prices-for-2021-1dd65c86c858?source=collection_archive---------3-----------------------#2021-01-03">https://pub.towardsai.net/using-prophet-to-predict-bitcoin-prices-for-2021-1dd65c86c858?source=collection_archive---------3-----------------------#2021-01-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f61b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><div class=""><h2 id="9c1b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">完整的代码可在我的回购的<a class="ae kr" href="https://github.com/arditoibryan/Projects/tree/master/20202312_Prophet_BTC" rel="noopener ugc nofollow" target="_blank"/></h2></div><p id="7ed6" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated"><a class="ae kr" href="http://www.michelangiolo.best/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku jd">点击这里了解我，我的项目，我的最新文章。</strong> </a></p><p id="0dfc" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">Prophet library是一个开源的加法回归模型，由脸书提供，用于时间序列预测。虽然有一个使用神经网络的更高级版本的prophet，NeuralProphet，但我将使用这个使用机器学习技术(回归模型)来估计未来价格的简化版本。</p><h2 id="e94c" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">先知的局限性</h2><p id="07da" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">你能在什么上面使用先知图书馆？这个工具最大的局限性就是局限于单变量模型。这意味着只能对一个变量起作用。例如，如果我们真的想建立一个现实的模型，我们会考虑其他变量来预测资产的价格。经济怎么样了？新冠肺炎是如何扩张的？有没有可能让比特币变得不那么重要的竞争对手？政府干预让比特币变得更相关还是更不相关？通过量化所有这些其他变量并将其输入到我们的模型中，我们可以创建一个更可靠的回归模型，该模型考虑了所有这些因素来预测价格。</p><p id="27b0" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">通过使用具有单变量限制的prophet，我们假设所有其他变量都不存在，因为它们根本不适合我们的模型。最终，我们假设比特币本身的价格将足以让我们对其未来趋势有所了解:这是否足以创造一个可行的模型？</p><h1 id="e502" class="ml lp it bd lq mm mn mo lt mp mq mr lw ki ms kj lz kl mt km mc ko mu kp mf mv bi translated">步伐</h1><ol class=""><li id="7be8" class="mw mx it ku b kv mg ky mh lb my lf mz lj na ln nb nc nd ne bi translated">下载BTC数据</li><li id="a13b" class="mw mx it ku b kv nf ky ng lb nh lf ni lj nj ln nb nc nd ne bi translated">导入库</li><li id="94cc" class="mw mx it ku b kv nf ky ng lb nh lf ni lj nj ln nb nc nd ne bi translated">导入数据</li><li id="78d8" class="mw mx it ku b kv nf ky ng lb nh lf ni lj nj ln nb nc nd ne bi translated">拟合模型</li><li id="15e1" class="mw mx it ku b kv nf ky ng lb nh lf ni lj nj ln nb nc nd ne bi translated">做预测</li><li id="9dd1" class="mw mx it ku b kv nf ky ng lb nh lf ni lj nj ln nb nc nd ne bi translated">图形和最终结果</li></ol><h2 id="6786" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">1.下载BTC数据</h2><p id="72e8" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">下载加密货币数据有多种选择。对于大量的分析和数据(例如同时下载10种不同的加密货币)，我更喜欢使用代码。然而，对于这个实验，我很乐意手动下载数据集。数据集也可以在我的回购，但这里是程序，如果你想下载最新的:<a class="ae kr" href="https://finance.yahoo.com/quote/BTC-USD/history/" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/BTC-USD/history/</a></p><figure class="nl nm nn no gt np gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi nk"><img src="../Images/11c0099b416d3b7b911c2844f40d5f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PlLS7mwXlkOQDRTWfhbsKg.png"/></div></div><figcaption class="nw nx gj gh gi ny nz bd b be z dk translated">按照以下步骤下载5年的BTC历史</figcaption></figure><h2 id="9515" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">2.导入库</h2><p id="8f0e" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">要运行这段代码，我需要安装并导入以下库:</p><pre class="nl nm nn no gt oa ob oc od aw oe bi"><span id="5628" class="lo lp it ob b gy of og l oh oi">!pip install pystan<br/>!pip install fbprophet</span><span id="9ba1" class="lo lp it ob b gy oj og l oh oi">import pandas as pd<br/>from fbprophet import Prophet</span></pre><h2 id="fe43" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">3.导入数据集</h2><p id="db9a" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">根据您用来运行代码的IDE，您需要指定。csv定位，然后用熊猫导入。Prophet只处理名为“ds”的列中包含字符串时间序列格式的数据和名为“y”的列中包含连续值的数据。我必须相应地创建数据集。</p><pre class="nl nm nn no gt oa ob oc od aw oe bi"><span id="9db5" class="lo lp it ob b gy of og l oh oi">df = pd.read_csv('BTC-USD.csv')<br/>df = df[['Date', 'Close']]<br/>df.columns = ['ds', 'y']<br/>df</span></pre><h2 id="c9c3" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">4.拟合模型</h2><p id="f950" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">先知库遵循sklearn文档。我需要将模型与数据进行拟合。</p><pre class="nl nm nn no gt oa ob oc od aw oe bi"><span id="f111" class="lo lp it ob b gy of og l oh oi">m = Prophet()<br/>m.fit(df)</span></pre><h2 id="7f38" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">5.做预测</h2><p id="7383" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">现在，我将告诉模型我想要一个未来365天的预测:</p><pre class="nl nm nn no gt oa ob oc od aw oe bi"><span id="1312" class="lo lp it ob b gy of og l oh oi">#estabilish prediction period<br/>future = m.make_future_dataframe(periods=365)<br/>future</span><span id="8059" class="lo lp it ob b gy oj og l oh oi">#make forecast<br/>forecast = m.predict(future)<br/>forecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail()</span></pre><p id="88e0" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">该模型将输出关于<strong class="ku jd">预测</strong>数据帧的预测。</p><h2 id="8407" class="lo lp it bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf iz bi translated">6.图形和最终结果</h2><p id="3c82" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">通过绘制结果，这是我最后得到的结果:</p><pre class="nl nm nn no gt oa ob oc od aw oe bi"><span id="f881" class="lo lp it ob b gy of og l oh oi">#graphing<br/>from fbprophet.plot import plot<br/>fig1 = m.plot(forecast, figsize=(20, 9))</span></pre><figure class="nl nm nn no gt np gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ok"><img src="../Images/62522a44a7af64b115388251b6a6b9c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VsUhGG-SCXpEqW3lwzT3eA.png"/></div></div></figure><h1 id="1ca9" class="ml lp it bd lq mm mn mo lt mp mq mr lw ki ms kj lz kl mt km mc ko mu kp mf mv bi translated">结论</h1><p id="613a" class="pw-post-body-paragraph ks kt it ku b kv mg kd kx ky mh kg la lb mi ld le lf mj lh li lj mk ll lm ln im bi translated">对Prophet计算的预测有几种解释:比特币价格目前的势头已经飙升，我们很可能会看到非常快速的下跌。到目前为止，比特币的表现就像一个周期性的泡沫，因此空气会猛烈地冲出泡沫是有道理的。</p></div></div>    
</body>
</html>