<html>
<head>
<title>Machine Learning and Deep Learning — a Systematic Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习和深度学习——系统应用</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/machine-learning-and-deep-learning-a-systematic-application-f53b51f3b098?source=collection_archive---------3-----------------------#2020-07-18">https://pub.towardsai.net/machine-learning-and-deep-learning-a-systematic-application-f53b51f3b098?source=collection_archive---------3-----------------------#2020-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1226" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="96c2" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用特征选择、交叉验证、scikit-learn和神经网络来识别价值</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/25fdfd6fed8efbb33f4e01eaa025cc60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Rfro3TYx-DFroasj"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@ikukevk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯文·Ku</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="3c56" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我之前的<a class="ae lh" href="https://medium.com/@rangys3" rel="noopener">帖子</a>已经使用Python可视化来探索美国的炼油和环境排放。在将机器学习和深度学习技术应用于能源行业的海量数据之前，我将在UCI机器学习资源库的<a class="ae lh" href="https://archive.ics.uci.edu/ml/datasets/Energy+efficiency" rel="noopener ugc nofollow" target="_blank">能效数据集</a>上进行实践。</p><h2 id="6938" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">TL/DR:回归在UCI能效数据集上提供了优于分类的性能。神经网络回归器并不比像梯度推进或随机森林这样的集成技术更有效。</h2><p id="8ed4" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">这篇文章有代码和输出的例子，所有的工作都可以在这个<a class="ae lh" href="https://github.com/Ranga2904/EnergyEfficiency_ML_DL" rel="noopener ugc nofollow" target="_blank"> Github repo </a>上获得。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="75aa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您将在本文中看到执行的关键步骤是:</p><p id="bfe2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第一步</strong> =在开始建模之前，确保理解目标和大局。</p><p id="52f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">步骤2 </strong> =加载并获得数据的高级洞察</p><p id="e7d6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第三步</strong> =进一步可视化以探索数据。目标:尽早了解最具杠杆作用的特性。</p><p id="fa76" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第四步</strong> =建模计划。这里的关键是为训练和测试模型准备好数据。</p><p id="76fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第五步 =执行建模并评估绩效。根据需要完成灵敏度分析</p><p id="85b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第6步</strong> =从工作中得出结论，让最终用户受益</p><p id="d2fe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">步骤4和5分享了测试分类和回归算法时的一些过程。</p><p id="2c65" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">请注意，我已经强调了一些我不打算使用但还是尝试过的工具和步骤，只是为了说明它们的影响并分享为什么我不会使用它们。在其他情况下，我列出了我没有采取的步骤和相应的理由。</p><p id="9b84" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后—请就其他步骤或现有步骤的变化提供反馈。这都是为了持续改进！</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="95bd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">步骤1 </strong>:目标=给定建筑物的描述符，预测这些建筑物的热负荷和冷负荷。这可以帮助我们优化空调和加热器负载，最大限度地降低建筑能耗。</p><p id="e16b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">作为第一步的一部分，我将假设我的客户不会在回归预测和基于分类的预测之间进行选择。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="21e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第二步</strong>:加载并获得高层次的数据洞察。有一些auto-EDA软件包可供使用，但我暂时不会使用它们，而是依赖。头()和。描述()</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="a4dc" class="me mf it nk b gy no np l nq nr">data = pd.read_csv('ENB2012_data.csv')</span><span id="da05" class="me mf it nk b gy ns np l nq nr">data.head()<br/>data.describe()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nt"><img src="../Images/622af16e0b83b568ffbe2916bce8047a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7nrvm-4Qax4QOoSjuPeNIA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图1:高级数据探索的命令和输出</figcaption></figure><p id="287c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">来自上面的见解:</p><ul class=""><li id="a261" class="nu nv it lk b ll lm lo lp lr nw lv nx lz ny md nz oa ob oc bi translated">高度、方向和玻璃面积变量代表不同类型的建筑。</li><li id="724e" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">不同的特征有不同的量级，<strong class="lk jd">在训练模型之前需要注意数据缩放需求。</strong></li><li id="167e" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">加热和冷却是连续的标签，但快速matplotlib.pyplot直方图表明，如果四舍五入，则加热和冷却负荷可以分组并用于拟合分类器。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/a0e87d7db58d66d773adb2f1a346f41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*bVCWz26yICRohTzrHm2VqA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图2:标签直方图</figcaption></figure><p id="e7e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，检查数据的偏斜度——如下所示，所有列的偏斜度都非常接近0，表明接近高斯分布，很少考虑离群数据。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/db3ff865fa6c88e417a48d3cee6ef038.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*Rh662J8SSQevTLJBEkaang.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图3:显示数据不对称的命令和输出</figcaption></figure><p id="0d47" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果上述数据偏斜度远远超出-1比1的范围，那么<strong class="lk jd">将触发对某种数据转换</strong>的需求，例如在应用机器学习之前进行对数转换。</p><p id="3195" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi ok translated">ne预测:这个数据集有8个特征和768个实例。这不是一个非常大的数据集，我不指望深度神经网络能提供比机器学习算法更多的东西。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="95f1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">步骤3: </strong>追求更详细的可视化，探索各种特征对输出变量或“标签”的影响。</p><p id="63e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将使用Seaborn的分类绘图:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="df4f" class="me mf it nk b gy no np l nq nr">c = sns.catplot(y='Cooling Load', data=data,col='Overall Height', row='Orientation', height=3, aspect=1.2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/4cf71d4275b08467b18ed80e08ae8e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*PRxKbrQm6Accyo6VDd6D9g.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图4: Seaborn分类图，用于评估特征对标注的影响</figcaption></figure><p id="05ec" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以上是最终得出以下结论的分析样本:</p><ul class=""><li id="61e3" class="nu nv it lk b ll lm lo lp lr nw lv nx lz ny md nz oa ob oc bi translated">建筑高度=3.5的热负荷为10–20，高度=7的热负荷为25–45，与其他功能无关。</li><li id="f0b0" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">建筑朝向与能量负荷没有明显的相关性，玻璃面积分布也是如此。</li><li id="edb0" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">热负荷和冷负荷随着玻璃面积的增加而增加。</li><li id="fd60" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">屋顶面积&gt; 200，表面积&gt; 670导致较低的能量负荷</li></ul><p id="9caf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">我认为方向和玻璃面积分布是影响最小的变量，高度是第二或第三个影响最小的变量。</strong></p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="44cc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我先从机器学习说起。</p><p id="a4bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第4步:</strong>让我们使用回归来执行<strong class="lk jd">使用递归特征消除(RFE)的特征选择。</strong></p><p id="af2f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">步骤4a)将数据分成x个独立变量或特征，以及y1、y2个独立变量或标签。然后使用递归特征消除来评估哪些变量被认为是可利用的。以下结果与冷负荷相同。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/022186c28b13f83acc277254955d9013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*80G3iPC-VxWzZySAI0DbEQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图4:x和y分割以及RFE运动的输出</figcaption></figure><p id="5499" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们从上面了解到，对于线性回归模型中的选择来说，朝向和玻璃区域分布(以及潜在的高度)并不是最佳的。这符合探索性数据分析的最初预期——您可以在<a class="ae lh" href="https://github.com/Ranga2904/EnergyEfficiency_ML_DL" rel="noopener ugc nofollow" target="_blank">报告</a>中看到k-best过滤的结果。</p><p id="ab8e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">步骤4b)从x中删除高度、方向和玻璃区域分布，然后设置10重交叉验证。<em class="ni">我也做过测试列车分裂，其结果在表1中。</em></p><p id="24f2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ni">这是我的测试序列分割代码的一个例子，我没有使用它——我过去犯过的一个错误是在将输入特性分割成测试序列分割</em> <strong class="lk jd"> <em class="ni">之前缩放所有输入特性，从而无意中将信息从序列测试泄露给测试集。</em>T9】</strong></p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="9d80" class="me mf it nk b gy no np l nq nr">std = StandardScaler()<br/>x_std = std.fit(x).transform(x)</span><span id="3b5e" class="me mf it nk b gy ns np l nq nr">x1_train, x1_test, y1_train, y1_test = train_test_split(x_std, y1, test_size=0.33, random_state=42)<br/>x2_train, x2_test, y2_train, y2_test = train_test_split(x_std, y2, test_size=0.33, random_state=24)</span></pre><p id="e090" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第五步</strong>:执行建模。在深入研究之前，请注意:能源数据集没有指定加热和冷却负荷的测量单位。因此，我假设测量值为几千Btu/hr(或kBtu/hr ),因为我们讨论的是建筑物的加热和冷却，而不是大型工业加热器/冷却器。</p><p id="67d9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面的代码片段用于回归，并完成以下任务:</p><p id="e5c1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(1)标准化数据</p><p id="1c58" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(2)创建要迭代的模型向量</p><p id="9466" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(3)使用for-loop应用10倍cv</p><p id="1037" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(4)用每个回归变量cv分数的平均值创建一个向量</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="e702" class="me mf it nk b gy no np l nq nr">x_sc = std.fit(x).transform(x)</span><span id="17c5" class="me mf it nk b gy ns np l nq nr">Heating_Load_crossval_explvar = []<br/>Cooling_Load_crossval_explvar = []</span><span id="11fe" class="me mf it nk b gy ns np l nq nr">regressors = [RandomForestRegressor(),  SVR(),<br/>    GradientBoostingRegressor(),<br/>    KNeighborsRegressor(),<br/>    AdaBoostRegressor(),<br/>    DecisionTreeRegressor(),    <br/>    DummyRegressor()]</span><span id="dd5c" class="me mf it nk b gy ns np l nq nr">cv = KFold(10,True,1)</span><span id="2eec" class="me mf it nk b gy ns np l nq nr">for rgr in regressors:<br/>    rgrscore_heat_load = cross_val_score(rgr,x_sc,y1,cv=cv,scoring='explained_variance')<br/>    rgrscore_heat_load = round(np.mean(rgrscore_heat_load),3)<br/>    Heating_Load_crossval_explvar.append(rgrscore_heat_load)<br/>    <br/>    rgrscore_cool_load = cross_val_score(rgr,x_sc,y2,cv=cv,scoring='explained variance')<br/>    rgrscore_cool_load = round(np.mean(rgrscore_cool_load),3)<br/>    Cooling_Load_crossval_explvar.append(rgrscore_cool_load)</span></pre><p id="d01f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在查看下面的结果摘要之前，添加一个代码块:对于分类算法，标签的连续值是不可接受的。如上面第2步所述，我将热负荷和冷负荷四舍五入，以创建有助于训练分类器的标签类别。如下所示，标签远不止2个，这使得某些评分指标无法用于k倍交叉验证。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="e9e6" class="me mf it nk b gy no np l nq nr">data['Heating Load'] = round(data['Heating Load'])<br/>data['Cooling Load'] = round(data['Cooling Load'])</span><span id="79c3" class="me mf it nk b gy ns np l nq nr">class_counts_heat = data.groupby('Heating Load').size()<br/>class_counts_cool = data.groupby('Cooling Load').size()</span><span id="891e" class="me mf it nk b gy ns np l nq nr">print("Number of classes in Cooling Load: %d" % len(class_counts_cool))<br/>print("Number of classes in Heating Load: %d" % len(class_counts_heat))<br/></span><span id="38b6" class="me mf it nk b gy ns np l nq nr">Number of classes in Cooling Load: 38<br/>Number of classes in Heating Load: 37</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/4874248906a6dc038d7025dc5a640640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qnDuGmBkj9colahN9Zd5zw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图5:分类和回归得分汇总</figcaption></figure><p id="eaae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">我们的主要收获:</strong></p><ul class=""><li id="5bad" class="nu nv it lk b ll lm lo lp lr nw lv nx lz ny md nz oa ob oc bi translated">在这个阶段，回归预测优于分类预测，无需进行大量的模型调整。</li><li id="c233" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">与热负荷相比，冷负荷建模更具挑战性，因此模型性能较差。</li><li id="803b" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated"><strong class="lk jd">回归:</strong>梯度推进回归器和随机森林集合技术更优越，因为它们导致0.5-1.7 kBtu/HR的误差，并且模型解释了95-99%的方差。</li><li id="e80f" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated"><strong class="lk jd">分类:</strong>测试列车分裂Kappa评分对于冷负荷预测统一在0.6以下，对于热负荷预测统一在0.6以上。经常被引用的Landis论文建议0.41-0.60表示中度同意，0.61-0.80表示基本同意。请记住，与随机分类相比，这是对模型性能的度量。</li><li id="3b48" class="nu nv it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated"><strong class="lk jd">使用多输出分类器并不能比使用单独的算法对热负荷和冷负荷进行分类提高性能</strong></li></ul><p id="e28f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi ok translated"><span class="l ol om on bm oo op oq or os di"> B </span>在讨论神经网络的机器学习之前，我想谈谈最后一点:调整机器学习模型的超参数，尝试提高模型性能。我已经在<a class="ae lh" href="https://github.com/Ranga2904/EnergyEfficiency_ML_DL" rel="noopener ugc nofollow" target="_blank">回购</a>中这样做了，这里有我工作的样本。鉴于上述表现，这不是重点。</p><p id="2225" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是KNearestNeighbors分类器查询的邻居数量变化的结果-我们观察到，随着查询的增加，性能平均增加，最终稳定在n=18左右。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/7e3aa870446a2611cf3d9356fc60cf0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*IeVRzFdgOp55WUczvPBm4g.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图6: KNN模型超参数测试</figcaption></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h2 id="ca22" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">现在谈谈深度学习——出于这个练习的目的，我将构建一个回归神经网络。</h2><p id="8696" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated"><strong class="lk jd">第4步:</strong>神经网络在特征选择和/或工程方面需要较少的工作，所以我不会在这里花时间。数据缩放将是下面管道的一部分。</p><p id="a61e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">步骤5 </strong>:我将在Keras中使用顺序API。导入Keras和TensorFlow后，我将使用Keras回归器。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="d485" class="me mf it nk b gy no np l nq nr">%pip install keras<br/>%pip install tensorflow</span><span id="60d4" class="me mf it nk b gy ns np l nq nr">from keras.models import Sequential<br/>from keras.layers import Dense</span><span id="e876" class="me mf it nk b gy ns np l nq nr">from keras.wrappers.scikit_learn import KerasRegressor</span></pre><p id="8187" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Keras还有一个分类器，我不会在这个练习中使用它。</p><p id="b02a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面的代码实现了以下功能:</p><ol class=""><li id="678a" class="nu nv it lk b ll lm lo lp lr nw lv nx lz ny md ox oa ob oc bi translated">创建基线序列模型，第一个隐藏层接受8个特征和8个节点，第二个隐藏层接受8个节点，输出层接受2个输出，因为我想预测两个变量</li><li id="7278" class="nu nv it lk b ll od lo oe lr of lv og lz oh md ox oa ob oc bi translated">创建一个标准化数据的管道，然后使用创建的模型为50个epochs定型数据，批量大小为5。使用10重交叉验证对性能进行分级。</li></ol><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="5ed4" class="me mf it nk b gy no np l nq nr">def baseline_model_two():<br/>    model = Sequential()<br/>    model.add(Dense(8, input_dim=8, kernel_initializer='normal', activation='relu'))<br/>    model.add(Dense(8, activation='relu'))<br/>    model.add(Dense(2, kernel_initializer='normal'))<br/>    # Compile model<br/>    model.compile(loss='mean_squared_error', optimizer='adam')<br/>    return model</span><span id="f350" class="me mf it nk b gy ns np l nq nr">estimators = []<br/>estimators.append(('standardize', StandardScaler()))<br/>estimators.append(('mlp', KerasRegressor(build_fn=baseline_model_two, epochs=50, batch_size=5, verbose=0)))<br/>pipeline = Pipeline(estimators)<br/>kfold = KFold(n_splits=10)<br/>results = cross_val_score(pipeline, x, y, cv=kfold)<br/>print("Error: %.2f (%.2f) MSE" % (results.mean(), results.std()))</span></pre><p id="0af2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">模型性能如下:</p><p id="e8f1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">50个时期:均方误差为9.56 (kBtu/hr)</p><p id="7b35" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">150个时期:均方误差为9.57 (kBtu/hr)</p><p id="588e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">50个历元、额外层和除输出层之外的所有层中的10个节点:均方误差为9.58 (kBtu/hr)</p><p id="a6d9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">对我们来说，关键的一点是:正如上文第二步结束时预测的那样，神经网络并没有提供优于传统机器学习技术的优势。</strong></p><p id="9cce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">第六步</strong></p><p id="059f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们创建了分类和回归模型，以帮助我们的最终用户设计优化能耗的建筑。训练神经网络很有趣，但考虑到标准机器学习技术所达到的性能，最终不值得付出努力。</p><p id="446a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们的客户可能对我们模型中最少和/或最多的杠杆变量感兴趣？我们能告诉他们什么？</p><p id="53a9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">拟合后，模型的feature_importances_ property可以告诉我们每个特征的相对重要性分数。然后可以对其进行分析/绘制，以回答我们客户的问题。请看下面的图7:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/04c9459356fb20f5ca97ed6a3580b4a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CEWumbfxHd1k38k4JrPIFw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图7:特性重要性</figcaption></figure><p id="87e4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以告诉我们的客户，朝向、玻璃面积分布是最不具杠杆作用的变量——相对紧凑性、屋顶面积和表面积是最具杠杆作用的变量。有趣的是，总高度系数仅比表面积系数低0.02。我们在这里得到的答案取决于我们选择应用features_importance的模型。</p><p id="ebf6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如前所述，我欢迎任何有利于持续改进的反馈。这项练习帮助我增强了信心，并计划迎接能源行业的挑战。</p></div></div>    
</body>
</html>