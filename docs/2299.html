<html>
<head>
<title>How AI Captions Your Photos?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能如何给你的照片加标题？</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/artificial-intelligence-6d47bedbed3e?source=collection_archive---------4-----------------------#2021-11-05">https://pub.towardsai.net/artificial-intelligence-6d47bedbed3e?source=collection_archive---------4-----------------------#2021-11-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="77d4" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">假人图像字幕的概念指南</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/9e73578962c7c0ad439f5d96855f3471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwctwJ67xjR2Nh-HolqUyA.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">拉杰·拉纳在<a class="ae kz" href="https://unsplash.com/@theranaman?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="c958" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">看下图。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj lw"><img src="../Images/b794b90c560a755339b3a5f8ce5921fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/0*EGxwk_2fEhYarEoQ"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">图片来源:Flickr 8k数据集。2712787899_d85048eb6a.jpg</figcaption></figure><p id="ee58" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果我让你描述一下这幅图像，你可能会说“有一个年轻的女人坐在窗台上，手里拿着一个黑色的钱包，看着自己的指甲”。“这充分描述了图像内容。图像字幕是描述图像内容。一个合适的标题不仅可以帮助一个正常人欣赏图像，还可以帮助盲人想象图像是关于什么的。字幕是一种技能——不恰当的字幕会导致错误的解读。我们可以训练一个AI模型来为任何图像生成醒目的标语(标题)吗？在这篇文章中，我将描述图像字幕背后的完整概念，为其开发一个机器学习模型需要什么，最后为那些铁杆开发者提供完整的实现。</p><h1 id="760c" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">基本必需品</h1><p id="59ef" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated">任何机器学习模型的基本需要是数据集。除非你有一个合适的数据集来训练算法，否则你甚至不能开始ML开发。幸运的是，Flickr已经发布了这样一个数据集供公众使用。他们的资料库里有数百万张照片。他们没有给这些照片贴标签——没有说明。然而，他们已经付出了一些额外的努力来为更多的图像编写说明——他们有两个训练数据集，一个包含<a class="ae kz" href="https://github.com/jbrownlee/Datasets/releases/download/Flickr8k/Flickr8k_Dataset.zip" rel="noopener ugc nofollow" target="_blank"> 8K </a>图像，另一个包含<a class="ae kz" href="https://www.kaggle.com/hsankesara/flickr-image-dataset" rel="noopener ugc nofollow" target="_blank"> 30K </a>图像。对于所有这些图片，他们提供了多种说明——每种大约4-5个。让我们看几个例子。</p></div><div class="ab cl mv mw hy mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="in io ip iq ir"><p id="4706" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">1.带有说明的图像(<em class="lx">来源:下载的数据集</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nc"><img src="../Images/d8056d336e5f8e74c824eb8668016f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*GPKw5FH3L45YP7-Q"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">图片来源:Flickr 8k数据集。2738255684_0324ed062d.jpg</figcaption></figure><ul class=""><li id="dc96" class="nd ne iu lc b ld le lg lh lj nf ln ng lr nh lv ni nj nk nl bi translated">一群灰狗在一条土路上奔跑。</li><li id="ab63" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">灰狗在沙地跑道上赛跑，穿绿色衣服的狗领先。</li><li id="7d31" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated"><em class="lx">赛狗绕着曲线跑。</em></li><li id="634c" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">这些马正在泥路上赛跑。</li><li id="4317" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">三只戴着口套的灰狗在跑道上绕着一个转弯处比赛。</li></ul></div><div class="ab cl mv mw hy mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="in io ip iq ir"><p id="5754" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.带有说明的图像(<em class="lx">来源:下载的数据集</em>)</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nc"><img src="../Images/373f1719fa35f4413a484b4f939bee85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*97lqnJb0fMUKqQZG"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">图片来源:Flickr 8k数据集。3443351431_7b4061df5c.jpg</figcaption></figure><ul class=""><li id="3612" class="nd ne iu lc b ld le lg lh lj nf ln ng lr nh lv ni nj nk nl bi translated">一只蜜蜂在白花上盘旋。</li><li id="803a" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">一只黑蓝色的昆虫飞过一朵白色的花。</li><li id="55ca" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated"><em class="lx">一只黑色昆虫接近一朵花。</em></li><li id="b924" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated"><em class="lx">一只蓝色的昆虫正在一株开花植物的花期附近飞翔。</em></li><li id="d410" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">蜜蜂在花的上方盘旋</li></ul></div><div class="ab cl mv mw hy mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="in io ip iq ir"><p id="e02d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.带有说明的图像(<em class="lx">来源:下载的数据集</em>)</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nc"><img src="../Images/e26643a3dd581d63679ebfe70c38d924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*kH4Mizhbxl8WB8ea"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">图片来源:Flickr 8k数据集。3145967019_1a83ebf712.jpg</figcaption></figure><ul class=""><li id="7ff1" class="nd ne iu lc b ld le lg lh lj nf ln ng lr nh lv ni nj nk nl bi translated">三个女人在喝酒，拥抱。</li><li id="1416" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated"><em class="lx">三个女人正在摆姿势拍照</em></li><li id="5db1" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">三个女人一起微笑着摆姿势，其中一个举起了手势。</li><li id="a668" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">三个女人一起摆姿势拍照。</li><li id="f114" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv ni nj nk nl bi translated">三个微笑的女人，一个背着双肩包，一个拿着蓝色的杯子，一个在用手语拍照。</li></ul></div><div class="ab cl mv mw hy mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="in io ip iq ir"><p id="22f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">他们给了每张图片提示性的说明，如每张图片右侧所示。这是我们的训练数据集——图片总数为30K，每张图片有4-5个适当的标题。</p><p id="baa7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们的下一个任务是理解如何将图像中的内容与人类创造的说明联系起来。</p><h1 id="7d4c" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">将图像内容与字幕相关联</h1><p id="4a47" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated">再次考虑Flickr数据集中给定的图像。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nc"><img src="../Images/6d9e3727f4e6fdeaf4e326ee9752e611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*WiTtsTHpiZGCER_1"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><em class="nr">图片来源:Flickr 8k数据集。3143980056_7a64a94b58.jpg </em></figcaption></figure><p id="4bcc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这张图片的一个建议标题是“<em class="lx">一个婴儿在和一个女人玩耍。”</em>让我们试着分析一下这个标题。句子包含三个关键词——<em class="lx">婴儿</em>、<em class="lx">女人</em>、<em class="lx">玩</em>。我们今天拥有的对象检测模型将检测两个对象，婴儿和女人。然而，他们将错过这次行动。图像上的评论员用单词<em class="lx">播放</em>连接了这两个物体。希望你能理解如何创建标题？首先，我们需要一个人工智能模型来识别照片中的主要物体。其次，我们需要一个经过NLP(自然语言处理)训练的模型，将这些单词连接在一起，形成一个合理的陈述。因此，我们在这里使用了两个人工智能领域——计算机视觉和NLP。这两者的融合有助于创建合适的字幕。现在，让我们来看看这两种技术。</p><h1 id="aaab" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">目标检测</h1><p id="fefa" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated">物体检测是一项相当成熟的技术。我们有几个良好的预训练模型，可以识别和分类成千上万种不同类型的对象。YOLO就是这样一个预训练模型，它以高精度检测对象，并将检测到的对象分类为20个主要类别，例如猫、汽车、人等等。还有其他型号，如InceptionV3、VGG-16等等。</p><p id="7d46" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所有这些对象检测模型分两部分运行。在第一部分中，它提取特征来识别图像中的对象。然后，他们通过分类器运行这些识别出的对象，将它们分组到不同的类中。因为我们只对识别的对象感兴趣，所以我们将忽略模型的分类。幸运的是，该模型允许我们提取中间输出。下图描述了这一点。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ns"><img src="../Images/60dcc3316a760bb2f9af50155c4cedf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-vTcWJXuKLw-4J6H44cBgQ.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><em class="nr">图片来源:作者</em></figcaption></figure><p id="d549" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们从图像中提取特征，选择高度重要的对象，并形成英语语句来连接这些对象，以创建有意义的标题。我现在将解释这是如何做到的？</p><h1 id="fe34" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">创建有意义的标题</h1><p id="fece" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated">考虑下图。你在里面看到了什么物体？</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nc"><img src="../Images/d01686f588380bd617425a4dc4cb79dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*8zrLAgI-bSlnX6jq"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><em class="nr">图片来源:Flickr 8k数据集。256283122_a4ef4a17cb.jpg </em></figcaption></figure><p id="d698" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">狗、人、飞盘、观众是一些被检测的对象。你不能简单地创建一个这些物体的列表，然后说照片显示了“<em class="lx">狗、人、飞盘和一些观众。</em>“这显然不是一个好的图片标题。一个更好的标题应该是“<em class="lx">一只狗跳过一个人去抓一个圆盘。</em>“然而，另一个更好的说法是”<em class="lx">一只狗跳过一个戴白色帽子的人去抓一个橙色的飞盘。</em>“你甚至可以添加观众，让标题看起来像——”<em class="lx">几个人站在或坐在草地上，看着一只狗跳过一个人去抓一个橙色的飞盘。</em></p><p id="f413" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从这些讨论中，你很容易理解获得图像上下文对于创建更有意义的标题是非常重要的。这就是NLU(自然语言理解)的全部内容。到目前为止，我已经描述了我们的图像标题模型的第一个任务，那就是获取图像中的对象列表。下一步是创建一个英语语句，建立这些对象之间的关系。</p><div class="nt nu gq gs nv nw"><a href="https://medium.com/subscribe/@profsarang" rel="noopener follow" target="_blank"><div class="nx ab fp"><div class="ny ab nz cl cj oa"><h2 class="bd iv gz z fq ob fs ft oc fv fx it bi translated">每当Poornachandra Sarang发布内容时，都会收到一封电子邮件。</h2><div class="od l"><h3 class="bd b gz z fq ob fs ft oc fv fx dk translated">每当Poornachandra Sarang发布内容时，都会收到一封电子邮件。通过注册，您将创建一个中等帐户，如果您没有…</h3></div><div class="oe l"><p class="bd b dl z fq ob fs ft oc fv fx dk translated">medium.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok kt nw"/></div></div></a></div><h1 id="613a" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">选择自然语言处理/NLU模型</h1><p id="c95b" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated">和物体检测一样，NLP背后的技术已经相当成熟。今天，我们谈论NLU(自然语言理解)。NLP始于文本分析——标记化、用于减少特征计数的词袋方法、以机器可理解的格式表示标记等等。NLU技术超越了这一点。我们训练NLU模型理解英语语句中的上下文。他们使用TF-IDF、Attention、Transformers等技术来识别最相关的单词。一个预先训练的NLU模型现在将能够围绕这些重要的单词生成有意义的句子。考虑到早期的一个人、一只狗和一个飞盘的形象，这三个物体在描述这个形象中起着主要的作用。注意力机制会更关注这些物体而不是旁观者。TF-IDF或Attention如何工作超出了本文的范围。对你来说，重要的是要明白，一个经过训练的NLU模型会根据那些重要的单词(物体)创造出一个有意义的句子。如果你听说过GPT3/4，它是一个甚至可以写小说的模型，更糟糕的是，它甚至可以制造假新闻。</p><p id="a485" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了总结整个过程，我现在将呈现字幕算法的鸟瞰图。</p><h1 id="46b8" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">图像字幕算法</h1><ol class=""><li id="896a" class="nd ne iu lc b ld mq lg mr lj ol ln om lr on lv oo nj nk nl bi translated">加载预训练模型，如用于特征提取的InceptionV3</li><li id="1834" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">通过忽略分类层来创建您自己的模型</li><li id="6d98" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">在Flickr(或任何其他)数据集上训练模型</li><li id="5d76" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">创建标题数据集中给定单词的词汇表</li><li id="477b" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">为训练和测试准备数据集</li><li id="a167" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">定义具有嵌入式注意机制的编码器/解码器人工神经网络架构</li><li id="0fba" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">模特培训</li><li id="dc2a" class="nd ne iu lc b ld nm lg nn lj no ln np lr nq lv oo nj nk nl bi translated">对看不见的图像的推断</li></ol><p id="eb0a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们可以描绘完整的模型，如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj op"><img src="../Images/1186014532fcdd93d1727757c69cfc49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-9ZD_bT3mP0JmZzSH0HzA.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><em class="nr">图片来源:作者</em></figcaption></figure><h1 id="ce56" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">最后的想法</h1><p id="7ca5" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated">我已经描述了AI如何为图像添加字幕以便普通人理解的完整过程(dummy？)如果您不向开发人员展示实现，他们会感到不舒服。所以，对于那些铁杆开发者，欢迎你们来看看我的GitHub <a class="ae kz" href="https://github.com/Apress/artificial-neural-networks-with-tensorflow-2/tree/main/ch10" rel="noopener ugc nofollow" target="_blank">库</a>中的实现。对于那些想知道我在实现中使用了什么的人来说，这是一个预训练的InceptionV3模块，用于我的编码器/解码器中的特征提取和Bahdanau注意。</p><p id="afe1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">再见，下次再见！</p><h1 id="b939" class="ly lz iu bd ma mb mc md me mf mg mh mi ka mj kb mk kd ml ke mm kg mn kh mo mp bi translated">信用</h1><p id="d8ad" class="pw-post-body-paragraph la lb iu lc b ld mq jv lf lg mr jy li lj ms ll lm ln mt lp lq lr mu lt lu lv in bi translated"><a class="ae kz" href="/@poojagramo" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv">Pooja Gramopadhye</strong></a>—复制编辑</p><blockquote class="oq"><p id="530c" class="or os iu bd ot ou ov ow ox oy oz lv dk translated">阅读我即将发布的故事<a class="ae kz" href="https://medium.com/@profsarang/membership" rel="noopener">加入Medium </a></p></blockquote></div></div>    
</body>
</html>