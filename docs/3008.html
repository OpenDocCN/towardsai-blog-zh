<html>
<head>
<title>GANs for Synthetic Data Generation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于合成数据生成的GANs</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/gans-for-synthetic-data-generation-1cca50317d87?source=collection_archive---------0-----------------------#2022-08-02">https://pub.towardsai.net/gans-for-synthetic-data-generation-1cca50317d87?source=collection_archive---------0-----------------------#2022-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4f44" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">使用开源GAN实现生成合成数据的实用指南</em></h2></div><p id="d70d" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi lc translated"><span class="l ld le lf bm lg lh li lj lk di"> T </span>技术的进步为在一分钟内生成数百万千兆字节的真实世界数据铺平了道路，这对任何组织或个人利用这些数据来说都是非常好的。然而，大量的时间和资源将消耗在清理、处理和从大量数据中提取重要信息上。</p><p id="0195" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">处理这种问题的答案是通过生成<em class="ll">合成数据</em>。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/8158fe53da314ab75c941ceab4173b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcabvpI-I888k-gCY1VZXQ.jpeg"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">照片由<a class="ae mc" href="https://unsplash.com/s/photos/artificial-data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae mc" href="https://unsplash.com/@vackground?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">真空背景</a>拍摄。</figcaption></figure></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="1f65" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">内容</strong></p><ol class=""><li id="6428" class="mk ml iq ki b kj kk km kn kp mm kt mn kx mo lb mp mq mr ms bi translated"><a class="ae mc" href="#a1c8" rel="noopener ugc nofollow"> <strong class="ki ir">什么是合成数据？</strong>T15】</a></li><li id="6325" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#a967" rel="noopener ugc nofollow"> <strong class="ki ir">甘斯简介</strong> </a></li><li id="d481" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#79cd" rel="noopener ugc nofollow"> <strong class="ki ir">模式崩溃</strong> </a></li><li id="65f1" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#7ddb" rel="noopener ugc nofollow"> <strong class="ki ir">瓦瑟斯坦甘(WGAN) </strong> </a></li><li id="8ec0" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#5abc" rel="noopener ugc nofollow"> <strong class="ki ir">实现用于合成数据生成的GAN</strong></a></li><li id="fd33" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#65dc" rel="noopener ugc nofollow"> <strong class="ki ir">数据集</strong> </a></li><li id="1a98" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#333c" rel="noopener ugc nofollow"> <strong class="ki ir">设计和训练合成器</strong> </a></li><li id="7fc2" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#f5d3" rel="noopener ugc nofollow"> <strong class="ki ir">最后的话</strong> </a></li><li id="6116" class="mk ml iq ki b kj mt km mu kp mv kt mw kx mx lb mp mq mr ms bi translated"><a class="ae mc" href="#a143" rel="noopener ugc nofollow"> <strong class="ki ir">参考文献</strong> </a></li></ol></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="24cd" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">什么是合成数据？</strong></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi my"><img src="../Images/c8498262aa40c6411ca8b0f79484e640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4t5G0Qb_XUg34sf7UwhOLA.png"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">作者使用<a class="ae mc" href="https://labs.openai.com/s/pphalwrtTUy9erVtIsvZTQej" rel="noopener ugc nofollow" target="_blank"> DALL-E生成的照片。</a></figcaption></figure><p id="e378" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">合成数据的定义非常简单:模拟真实世界数据的人工生成的数据。组织和个人可以利用合成数据来满足他们的需求，并能够根据他们的规范生成他们需要的数据。</p><p id="a4e5" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">使用合成数据非常有利于保护信息敏感领域的隐私:患者的医疗数据和银行客户的交易细节是合成数据可用于掩盖真实数据的几个例子，这将使组织之间能够共享敏感数据。</p><p id="ffca" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">很少标记良好的数据可以用来生成大量的合成数据，这将快速跟踪处理大量真实世界数据所需的时间和精力。</p><p id="e0f7" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有许多生成合成数据的方法:SMOTE、ADASYN、变分自动编码器和生成对抗网络是一些用于合成数据生成的技术。</p><p id="f3ef" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">本文将重点关注使用生成式对抗网络来生成合成数据，以及使用开源库生成合成数据的实际演示。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="3457" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">GANs简介</strong></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mz"><img src="../Images/a7563d2018fc1b3a557ed5e1ab78431c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sKQKxkQ5bBKGvs1IvmSBVQ.png"/></div></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">基于StyleGAN3研究的GANs生成真实感人脸。图片来自[1]。</figcaption></figure><p id="5294" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">许多机器学习和深度学习架构容易受到敌对操纵，也就是说，当输入的数据与用于训练的数据不同时，模型就会失败。为了解决对抗问题，Ian Goodfellow [2]引入了生成对抗网络(GANs ),目前，GANs在生成合成数据方面非常流行。</p><p id="8e9a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">典型的GAN由两部分组成:发生器和鉴别器，两个网络相互竞争。</p><p id="ac5f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">生成器是GAN的核心，它试图通过从真实数据中学习特征来生成看起来真实的假数据。</p><p id="0794" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">鉴别器使用真实数据评估生成的数据，并对生成的数据看起来是否真实进行分类，并向生成器提供反馈以改进其数据生成。</p><p id="a46c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">生成器的目标是生成可以欺骗鉴别器的数据。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/d65ffd9a2852f01e471363e9d05fa2e0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*oaYMhHDr5NdKhO1HqErXjQ.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">一个香草甘架构。图片来自[3]。</figcaption></figure></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="aa8f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">模式崩溃</strong></p><p id="c989" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">模式崩溃是基于GAN的架构在对抗训练期间面临的一个常见问题，其中生成器重复生成一种特定类型的数据。当生成器发现它可以用一种类型的数据欺骗鉴别器时，就会发生这种情况，生成器会继续生成相同的数据。</p><p id="9ad3" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这个问题很容易被发现，因为度量将指示模型训练正在顺利运行，但是生成的结果将指示其他情况。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/0f78f7f202d1053a71d9483bb6db46cc.png" data-original-src="https://miro.medium.com/v2/format:webp/1*a5praSy8RR-yjClgeYLqVg.jpeg"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">基于图像的GANs中模式崩溃的一个例子。图片来自[4]。</figcaption></figure></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="a3dc" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">瓦瑟斯坦甘</strong></p><p id="6118" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">标准GAN的主要问题是发生器和鉴频器输出的复杂性不同。</p><p id="fe76" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">标准普通GAN使用二进制交叉熵(BCE)损失函数[5]来评估生成的数据是否真实，其中损失函数的输出介于0和1之间。生成器的任务是生成可能具有大量特征和值的合成数据，来自鉴别器的输出不足以供生成器学习，并且由于缺乏指导，生成器很容易陷入模式崩溃。</p><p id="9f54" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">WGAN [6]通过用鉴别器代替鉴别器来缓解该问题，其中鉴别器将使用生成数据的分布来评估真实数据的分布，并输出生成数据与真实数据相比看起来有多真实的分数。WGAN中使用的Wasserstein损失函数测量实际分布和基于推土机距离产生的分布之间的差异。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/ca9c78e35896071c7829c86afeaadb71.png" data-original-src="https://miro.medium.com/v2/format:webp/1*UPESaCzXpY8vvMSnEPas-w.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">推土机距离的可视化。图片来自<a class="ae mc" href="https://www.coursera.org/learn/build-basic-generative-adversarial-networks-gans?specialization=generative-adversarial-networks-gans" rel="noopener ugc nofollow" target="_blank"> Coursera球场</a> [8]</figcaption></figure><p id="e12b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">推土机的距离测量使生成数据的分布看起来与真实数据的分布相似所需的努力。因此，对输出的值没有限制。也就是说，如果两个分布相距很远，推土机的距离将给出真正的正值，而BCE损失将输出更接近于零的梯度值。因此，Wasserstein损失函数能够解决训练期间的消失梯度问题。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/b8a9d5da53a3a35caf24f5c7d46d3ac1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Z6dGhyqSWVuNO8GcntCx9A.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">瓦瑟斯坦失落的表情。图片来自<a class="ae mc" href="https://www.coursera.org/learn/build-basic-generative-adversarial-networks-gans?specialization=generative-adversarial-networks-gans" rel="noopener ugc nofollow" target="_blank"> Coursera球场</a>【8】。</figcaption></figure><p id="b972" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">上图显示了Wasserstein损耗的公式，与BCE损耗相比，该公式相对简单。等式的初始部分是评论家根据真实数据提供的预测的期望值。等式的第二部分是评论家对生成的数据提供的预测的期望值。批评家的目标是最大化真实数据和生成数据之间的距离，而生成器的目标是最小化这种差异。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/283f4244593fac813020602c28d5f8b9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*FEPWX5ZVkrcnTP5nA3T--A.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">BCE(左)和Wasserstein(右)损失之间的差异。图片来自<a class="ae mc" href="https://www.coursera.org/learn/build-basic-generative-adversarial-networks-gans?specialization=generative-adversarial-networks-gans" rel="noopener ugc nofollow" target="_blank"> Coursera球场</a>【8】。</figcaption></figure><p id="2b53" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">WGANs容易出现爆炸梯度问题，因为Wasserstein损失输出任何正值和实数；因此，当生成数据的分布不同于真实数据的分布时，梯度值会不受控制地增加。这是通过引入正则化项梯度惩罚[7]来解决的，它确保梯度被包含，这确保了WGAN模型的更好优化。</p><p id="555a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">为了深入了解GANs，强烈推荐由<a class="ae mc" href="https://www.deeplearning.ai/" rel="noopener ugc nofollow" target="_blank"> deeplearning.ai </a>和<a class="ae mc" href="https://www.coursera.org/instructor/sharon-zhou" rel="noopener ugc nofollow" target="_blank"> Sharon Zhou </a>制作的<a class="ae mc" href="https://www.coursera.org/specializations/generative-adversarial-networks-gans" rel="noopener ugc nofollow" target="_blank">Coursera specialization on GANs</a>。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="4f30" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">实现用于合成数据生成的GAN</strong></p><p id="e304" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">ydata-synthetic 库在构建GANs以生成表格数据集的合成数据方面提供了巨大的帮助，否则这将是一项艰巨而乏味的工作。</p><p id="a6d6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有大量不同类型的GAN可用于生成合成数据:标准普通GAN和条件GAN，以及高级WGAN、带梯度惩罚的WGAN、深度遗憾分析GAN、CramerGAN和条件WGAN，以及可用于时间序列的GAN选项(TimeGAN)。</p><p id="4614" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这些模型可以开箱即用，只需稍加修改，几乎可以用于任何表格数据集。</p><p id="1304" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">只需一个简单的命令，就可以在python环境中安装这个库:</p><pre class="ln lo lp lq gt nb nc nd ne aw nf bi"><span id="0e07" class="ng nh iq nc b gy ni nj l nk nl">pip install ydata-synthetic</span></pre><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/4b37f749a6ab32de91ace41e20f1558a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*zDIe_iAomJwkiMMhYY9EXg.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">ydata-synthetic的GitHub库。作者截图自<a class="ae mc" href="https://github.com/ydataai/ydata-synthetic" rel="noopener ugc nofollow" target="_blank"> ydata-synthetic </a>。</figcaption></figure></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="bd1c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">数据集</strong></p><p id="3091" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">选择<a class="ae mc" href="https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset" rel="noopener ugc nofollow" target="_blank">糖尿病健康指标数据集</a>，其为<a class="ae mc" href="https://creativecommons.org/publicdomain/zero/1.0/" rel="noopener ugc nofollow" target="_blank"> CC0许可</a>。数据集具有敏感数据，即患者的医疗记录，并且需要获得更多关于诊断为糖尿病的患者的数据；因此，使用合成数据将非常有益。数据集由21个特征组成，目标特征是患者是否被诊断为糖尿病。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/62e0950ce7260a933c3c50551290ac5e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TSlUpmMalpSOV5eA9FuEFw.jpeg"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">在<a class="ae mc" href="https://unsplash.com/s/photos/diabetes-awareness?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae mc" href="https://unsplash.com/@towfiqu999999?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Towfiqu barbhuiya </a>拍摄的照片。</figcaption></figure><p id="705b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">另一个开源工具<a class="ae mc" href="https://github.com/ydataai/pandas-profiling" rel="noopener ugc nofollow" target="_blank"> pandas-profiling </a>对于探索性数据分析非常有用，只需两行代码即可将特征和关系可视化，该工具用于对糖尿病健康指标数据集进行探索性数据分析。这将生成有关数据集中存在的所有变量的详细报告，对数据中存在的任何异常发出警报，显示变量之间的关系(或相关性)，并显示每列中缺少的值和数据中存在的重复值。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/c71c9def54cf5e6b036fba14bc57ab04.png" data-original-src="https://miro.medium.com/v2/format:webp/1*P5K-E0TwnqqToM_Rwgx9xQ.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">GitHub熊猫档案库。作者从<a class="ae mc" href="https://github.com/ydataai/pandas-profiling" rel="noopener ugc nofollow" target="_blank">熊猫档案</a>截取的截图。</figcaption></figure><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">加载数据并运行pandas-profiling。</figcaption></figure><p id="8095" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有超过218，000例非糖尿病患者和超过35，000例诊断为糖尿病的患者。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/51a18364ebb46ddf05de36446a17f162.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-JitL-mg9u0gpKv9p21Pfg.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">有和没有糖尿病的病人数量。图片来自作者。</figcaption></figure><p id="3e7e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">所有变量都是浮点型的，因为数据集已经过预处理。在pandas-profiling库的帮助下，发现有3个数值变量(身体质量指数、曼氏和PhysHlth)，其他变量是分类变量。pandas-profiling工具强调了大约4%的数据集包含重复项。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/e8ff676564ad74b17233205aed59ba43.png" data-original-src="https://miro.medium.com/v2/format:webp/1*X0Rn7JGGCmM4VSUS4hayhA.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">数据的概述。图片来自作者。</figcaption></figure><p id="10ba" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">pandas-profiling工具还强调了某些变量之间的高度相关关系，这可以在以后的特征工程任务中加以考虑。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/0adab3fec17dc23392b0267a52865a7b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*EAxmvkR-w_Lm1iY6DqrLKw.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">熊猫图谱库检测到的异常。图片来自作者。</figcaption></figure><p id="833b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有选项可以查看变量之间的关系，从上图中可以看出，pandas-profiling工具已经检测到六个数值变量，并绘制了描述变量之间关系的散点图。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/db405aa32e1994001914ce6a30001ae1.png" data-original-src="https://miro.medium.com/v2/1*x0eBNsAJyrG8GD4IFD8UTw.gif"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">查看数值变量之间的相互作用。作者GIF。</figcaption></figure><p id="2f1f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">该工具在进行变量之间的统计相关性测试时也非常有用，因为它提供了进行数值相关性测试和类别相关性测试的选项。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/9220f5738d28a30d1366d91417f6238c.png" data-original-src="https://miro.medium.com/v2/1*EF3-Ls-JJmiFn1ZAX6MX1A.gif"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">pandas-profiling库中提供了不同的相关性测试。作者GIF。</figcaption></figure><p id="98a8" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">pandas-profiling工具表明数据集中没有缺失值。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/e29faa81bfb48e5fd63ca0842afdd93e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5kvsAxaWOgOjvWEKHTRMnw.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">数据中不存在缺失值。图片来自作者。</figcaption></figure><p id="160e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">由于4.5%的数据由重复数据组成，因此可以检查准确的重复行以及这些行重复的次数。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/f5bb6a033c9ec2ac8023a2f6c82b06ae.png" data-original-src="https://miro.medium.com/v2/format:webp/1*APCAIDLr3uVAULDccGe_pg.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">数据中存在的重复项。</figcaption></figure><p id="00da" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">完整的熊猫概况报告可以在<a class="ae mc" href="https://vaseekaran-v.github.io/real_diabetes_pd_prof_report/" rel="noopener ugc nofollow" target="_blank">这里</a>查看。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="4ff5" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">合成器的设计和训练</strong></p><p id="6dfd" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">最初，数字和分类列是分开的，因为变量的类型是训练GAN模型所必需的。根据之前完成的数据分析，有三个数值变量，其余的是分类变量。</p><p id="eb70" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">为了开始生成合成数据的过程，基于患者的糖尿病状态来分离患者的标签。首先，GAN被训练为糖尿病患者生成合成数据。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">选择分类变量和数值变量，并只选择糖尿病患者的数据。</figcaption></figure><p id="9698" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下一步是选择GAN模型，如前所述，选择具有梯度惩罚的Wasserstein GAN。使用ydata-synthetic库初始化GAN非常容易。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">初始化GAN模型。</figcaption></figure><p id="d62c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">一旦GAN初始化，训练过程就开始了。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">开始GAN的训练过程。</figcaption></figure><p id="212a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">培训时间取决于用于培训的机器。与在CPU上训练相比，使用NVIDIA GPU进行训练要快得多。但是，该库也经过优化，可以在CPU上很好地运行。</p><p id="6d11" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">一旦训练完成，下一步就是生成合成数据。GAN模型被训练以理解糖尿病患者数据的分布，并且生成了代表糖尿病患者的100，000行数据。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">为糖尿病患者生成合成数据。</figcaption></figure><p id="c524" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">与原始数据集中存在的35，000行糖尿病患者相比，使用基于GAN的模型，可获得100，000行糖尿病患者的合成数据。使用ydata-synthetic的另一个优点是，合成数据以输入数据的形式返回，所有列保持不变。</p><p id="6119" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在多数类上训练GAN的步骤类似于先前为少数类生成数据所采取的步骤。为非糖尿病患者的数据训练GAN的时期数被设置为100，以减少训练时间。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">为非糖尿病患者的数据生成合成示例。</figcaption></figure><p id="738b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">使用简单的代码函数来合并多数类和少数类的合成样本。</p><figure class="ln lo lp lq gt lr"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">连接合成的多数和少数数据帧。</figcaption></figure><p id="0945" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">pandas-profiling工具用于获得合成数据的快速探索性数据分析。</p><p id="c593" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">评估来自真实数据集和生成的数据集的数字列的分布。</p><p id="8e78" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">考虑到身体质量指数特征，合成数据具有真实数据集的可接受的表示。合成数据的值的范围在真实数据的值的范围内。合成数据的平均值已向右移动，但总体而言，合成数据的身体质量指数列与真实数据相当。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/24f3c31288725c8f0f1243abc035b12f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*U7OIdwDxAPpUxu_B0hXlLg.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">身体质量指数柱与真实和合成数据的比较。图片由作者提供。</figcaption></figure><p id="78c1" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">比较“身体健康”和“精神健康”可能有点棘手。根据基于数据的列的定义，这两列分别代表过去30天中精神健康状况不佳的天数和过去30天中身体受伤的天数。因此，这些列中的许多值都是零，并且数据是数字的，因为考虑了天数。</p><p id="1b1a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">合成数据为两列生成了负值，这需要在继续建模之前进行一些特征处理，因为负值将被转换为零。</p><p id="3d7c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">当考虑特征“薄荷健康”时，合成数据产生了可接受的分布，因为所有产生的值都在30以下。合成数据的平均值已经向左移动。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/449eb9bc81b70541a8ef78b2271f37e1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*OLg9PTX1CsfVWSTaFu0zgA.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">曼氏柱与真实数据和合成数据的比较。图片由作者提供。</figcaption></figure><p id="7e55" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">然而，列“PhysHlth”的合成数据的平均值已经显著向右移动。但是生成的值小于30，用零替换负值可能会稍微改善生成的结果。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="ab gu cl na"><img src="../Images/24aae0537ba7dfec3e1fb6278c88e641.png" data-original-src="https://miro.medium.com/v2/format:webp/1*XHlsYWG9PobQV5ptLjgdHg.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">PhysHlth柱与真实数据和合成数据的比较。图片由作者提供。</figcaption></figure><p id="5d40" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">需要注意的是，对于真实数据中的“PhysHlth”和“MentHlth”字段，近70%的值为零。剩下的30%分布在1-30之间，但没有任何特定的模式。与“身体质量指数”字段不同，在这两列中看不到特定的分布。这可能是GAN为“物理长度”和“精神长度”字段产生负值的另一个重要原因。</p><p id="ddbc" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在合成的“PhysHlth”和“MentHlth”列的分布中，零值周围有一个峰值，这表明合成器已经识别出这两列的许多值都是零，但是由于这两个字段都被初始化为数值，GAN试图预测精确的数值，因此产生了负值。</p><p id="8770" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">合成数据的完整的pandas-profiling HTML报告可以在<a class="ae mc" href="https://vaseekaran-v.github.io/synth_data_pd_prof_report/" rel="noopener ugc nofollow" target="_blank">这里</a>查看，整个工作的存储库可以在<a class="ae mc" href="https://github.com/Vaseekaran-V/Synthetic_Data_Generation_Diabetes" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="fe8f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">遗言</strong></p><p id="71b6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">人工智能的范式正在从以模型为中心转变为以数据为中心的方法，合成数据的使用加速了这种转变。</p><p id="d365" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">合成数据提供了一种低成本和隐私安全的替代方法来收集和标记真实世界的数据，任何人都可以利用开源的强大工具来为他们的特定用例生成数据。</p><p id="1881" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有许多<a class="ae mc" href="https://github.com/ydataai/awesome-data-centric-ai" rel="noopener ugc nofollow" target="_blank">开源工具</a>可用于生成高质量的合成数据，正如本文所讨论的，在ydata-synthetic的帮助下，通过利用GANs的能力来生成合成数据相对容易。</p><p id="4fa7" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我希望您已经了解了为表格数据集生成合成数据有多简单，并期待看到您将如何使用这些强大的工具来处理和创建合成数据。干杯！</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="3e49" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">参考文献</strong></p><p id="1afe" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[1] T. Karras，S. Laine和T. Aila，“一种基于风格的生成式对抗网络生成器体系结构”，<em class="ll"> IEEE模式分析和机器智能事务</em>，第1-1页，2020，doi:10.1109/tpami . 2020 . 297091999916</p><p id="2283" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[2]I . j . good feller<em class="ll">等</em>，【生成性对抗网络】<em class="ll">arXiv.org</em>，2014。<a class="ae mc" href="https://arxiv.org/abs/1406.2661" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1406.2661</a></p><p id="0716" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[3] G. H. de Rosa和J. P. Papa，“利用生成性对抗网络的文本生成研究综述”，<em class="ll">模式识别</em>，第119卷，第108098页，2021年11月，doi:10.1016/j . pat cog . 2021.108098098</p><p id="89a8" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[4] M. Pasini，“我在一年的培训中吸取的10个教训”，<em class="ll">中</em>，2019年7月28日。<a class="ae mc" href="https://towardsdatascience.com/10-lessons-i-learned-training-generative-adversarial-networks-gans-for-a-year-c9071159628" rel="noopener" target="_blank">https://towards data sciences . com/10-教训-我-吸取-培训-生成-对抗-网络-gan s-for-a-year-c 9071159628</a></p><p id="1ffd" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[5]u . r . Dr . A，“二进制交叉熵结合深度学习技术用于图像分类”，<em class="ll">国际计算机科学与工程高级趋势杂志</em>，第9卷，第4期，第5393-5397页，2020年8月，doi:10.30534/I jatcse/2020/175942020。</p><p id="6998" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[6] M. Arjovsky，S. Chintala，L. Bottou，“Wasserstein GAN”，<em class="ll">arXiv.org</em>，2017 .<a class="ae mc" href="https://arxiv.org/abs/1701.07875" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1701.07875</a></p><p id="f8c5" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[7] I. Gulrajani，F. Ahmed，M. Arjovsky，V. Dumoulin，a .库维尔，“Wasserstein GANs的改进培训”，<em class="ll"> arXiv:1704.00028 [cs，stat] </em>，2017年12月，[Online]。可用:<a class="ae mc" href="https://arxiv.org/abs/1704.00028" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1704.00028</a></p><p id="07e0" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[8]“建立基本的生成性对抗网络(GANs)，”<em class="ll"> Coursera </em>。<a class="ae mc" href="https://www.coursera.org/learn/build-basic-generative-adversarial-networks-gans?specialization=generative-adversarial-networks-gans" rel="noopener ugc nofollow" target="_blank">https://www . coursera . org/learn/build-basic-generative-adversarial-networks-gans？特殊化=生成-对抗-网络-gans</a>(2022年7月28日访问)。</p></div></div>    
</body>
</html>