<html>
<head>
<title>R Script for Data Science Coding Exercise</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学编码练习的r脚本</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/r-script-for-data-science-coding-exercise-633800dd63ec?source=collection_archive---------1-----------------------#2020-04-11">https://pub.towardsai.net/r-script-for-data-science-coding-exercise-633800dd63ec?source=collection_archive---------1-----------------------#2020-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/60308999c8b4c1d9b19de4fd64ab4def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ILcumWSaYr7dzY-_"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">萨法尔·萨法罗夫在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="1b58" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">一些编码挑战问题会指定一个正式的项目报告与一个Jupyter笔记本或R脚本文件一起提交</h2></div><h1 id="055a" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">一.导言</h1><p id="f3b6" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">带回家的挑战问题或编码练习是数据科学家面试流程中最重要的一步。这通常是一个数据科学问题，例如机器学习模型、线性回归、分类问题、时间序列分析等。一般来说，面试团队会给你提供项目方向和数据集。</p><p id="423b" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">一些编码挑战问题会指定一个正式的项目报告与一个Jupyter笔记本或R脚本文件一起提交。在本文中，我们给出了一个带回家的挑战问题的示例R脚本。</p><h1 id="1a40" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">二。项目说明</h1><p id="8da7" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated"><em class="mr">在这个问题中，你将预测贷款组合的结果。每笔贷款计划在3年内偿还，结构如下:</em></p><ul class=""><li id="c2a5" class="ms mt jj ls b lt mm lw mn lz mu md mv mh mw ml mx my mz na bi translated"><em class="mr">首先，借款人收到资金。这一事件被称为起源。</em></li><li id="2a09" class="ms mt jj ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated"><em class="mr">然后，借款人定期还款，直到发生以下情况之一:</em></li></ul><p id="5753" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><em class="mr"> (i)借款人在3年期限结束前停止付款，通常是由于财务困难。这一事件被称为销账，然后贷款被称为已销账。</em></p><p id="746f" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><em class="mr"> (ii)借款人继续还款，直到发放日之后3年。至此，债务已全部还清。</em></p><p id="a71b" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><em class="mr">在附加的CSV中，每行对应一笔贷款，列的定义如下:</em></p><ul class=""><li id="488d" class="ms mt jj ls b lt mm lw mn lz mu md mv mh mw ml mx my mz na bi translated"><em class="mr">标题为“自发起以来的天数”的列表示发起和数据收集日期之间经过的天数。</em></li><li id="4d6a" class="ms mt jj ls b lt nb lw nc lz nd md ne mh nf ml mx my mz na bi translated"><em class="mr">对于在收集数据之前已经销账的贷款，标题为“从发起到销账的天数”的列表示发起和销账之间经过的天数。对于所有其他贷款，此栏为空白。</em></li></ul><p id="1b78" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls jk"> <em class="mr">目标</em> </strong> <em class="mr">:我们希望您估计这些贷款在全部3年期限结束时将会被冲销的比例。请包括你如何得到你的答案的一个严格的解释，并且包括你使用的任何代码。你可以做出简化的假设，但是请明确地陈述这些假设。</em> <strong class="ls jk"> <em class="mr">请随意以您喜欢的任何格式提交您的答案；特别是PDF和Jupyter笔记本都不错</em> </strong> <em class="mr">。此外，我们希望这个项目不会占用您超过3-6个小时的时间。</em></p><h1 id="3f15" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">三。用于执行数据分析的r脚本</h1><p id="c012" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在为数据科学编码练习准备Jupyter notebook的R脚本时，请确保您的代码组织良好，并且它应该能够很好地反映预测建模的工作流:数据导入、探索性数据分析、模型选择、模型构建、模型测试和模型评估。</p><pre class="ng nh ni nj gt nk nl nm nn aw no bi"><span id="130e" class="np kz jj nl b gy nq nr l ns nt"><strong class="nl jk"><em class="mr"># R CODE FOR PREDICTING LOAN STATUS</em></strong></span><span id="c7c2" class="np kz jj nl b gy nu nr l ns nt"><em class="mr">#author: Benjamin O. Tayo<br/>#Date: 11/22/2018</em></span><span id="aef9" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#IMPORT NECESSARY LIBRARIES</em></strong></span><span id="35f8" class="np kz jj nl b gy nu nr l ns nt">library(readr)<br/>library(tidyverse)<br/>library(broom)<br/>library(caret)</span><span id="f41d" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#IMPORTATION OF DATASET</em></strong></span><span id="4029" class="np kz jj nl b gy nu nr l ns nt">df&lt;-read_csv("loan_timing.csv",na="NA")<br/>names(df)=c("origination","chargeoff")</span><span id="501a" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Partition dataset into two: default (charged off ) and current</em></strong></span><span id="2576" class="np kz jj nl b gy nu nr l ns nt">index&lt;-which(!(df$chargeoff=="NA"))<br/>default&lt;-df%&gt;%slice(index)<br/>current&lt;-df%&gt;%slice(-index)</span><span id="58f9" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr"># EXPLORATORY DATA ANALYSIS</em></strong></span><span id="df7e" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk">#Figure 1: Histogram of days since origination for current loans</strong></span><span id="44ae" class="np kz jj nl b gy nu nr l ns nt">current%&gt;%ggplot(aes(origination))+geom_histogram(color="white",fill="skyblue")+ xlab('days since origination')+ylab('count')+ ggtitle("Histogram of days since origination for current loans")+ theme(plot.title = element_text(color="black", size=12, hjust=0.5, face="bold"),axis.title.x = element_text(color="black", size=12, face="bold"),axis.title.y = element_text(color="black", size=12, face="bold"),legend.title = element_blank())</span><span id="128d" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Figure 2: Histogram of days to charge-off for defaulted loans</em></strong></span><span id="66ac" class="np kz jj nl b gy nu nr l ns nt">default%&gt;%ggplot(aes(chargeoff))+geom_histogram(color="white",fill="skyblue")+ xlab('days to charge-off')+ylab('count')+ ggtitle("Histogram of days to charge-off for defaulted loans")+ theme(plot.title = element_text(color="black", size=12, hjust=0.5, face="bold"), axis.title.x = element_text(color="black", size=12, face="bold"), axis.title.y = element_text(color="black", size=12, face="bold"), legend.title = element_blank())</span><span id="b114" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Figure 3: Histogram of days since origination for defaulted loans</em></strong></span><span id="7167" class="np kz jj nl b gy nu nr l ns nt">default%&gt;%ggplot(aes(origination))+geom_histogram(color="white",fill="skyblue")+ xlab('days since origination')+ylab('count')+ ggtitle("Histogram of days since origination for defaulted loans")+ theme(plot.title = element_text(color="black", size=12, hjust=0.5, face="bold"),axis.title.x = element_text(color="black", size=12, face="bold"),axis.title.y = element_text(color="black", size=12, face="bold"), legend.title = element_blank())</span><span id="f28d" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Figure 4: Plot of days to charge-off vs. days since origination for defaulted loans</em></strong></span><span id="5baf" class="np kz jj nl b gy nu nr l ns nt">default%&gt;%ggplot(aes(origination,chargeoff))+geom_point()+ xlab('days since origination')+ylab('days to charge-off')+ ggtitle("days to charge-off vs. days since origination")+ <br/>theme( plot.title = element_text(color="black", size=12, hjust=0.5, face="bold"), axis.title.x = element_text(color="black", size=12, face="bold"), axis.title.y = element_text(color="black", size=12, face="bold"),legend.title = element_blank())</span><span id="0eaf" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Figure 5: Monte Carlo Simulation of Defaulted Loans</em></strong></span><span id="36e6" class="np kz jj nl b gy nu nr l ns nt">set.seed(2)<br/>N &lt;- 3*365 <strong class="nl jk"><em class="mr"># loan duration in days</em></strong><br/>df_MC&lt;<br/>data.frame(u=round(runif(15500,0,N)),v=round(runif(15500,0,N)))<br/>df_MC&lt;-df_MC%&gt;%filter(v&lt;=u)<br/>df_MC&lt;-df_MC%&gt;%filter(u&lt;=730 &amp; v&lt;=730)<strong class="nl jk"><em class="mr">#select loans within 1st 2 yrs</em></strong></span><span id="1116" class="np kz jj nl b gy nu nr l ns nt">df_MC[1:nrow(default),]%&gt;%ggplot(aes(u,v))+geom_point()+ xlab('days since origination')+ylab('days to charge-off')+ ggtitle("MC simulation of days to charge-off vs. days since origination")+ theme(plot.title = element_text(color="black", size=12, hjust=0.5, face="bold"),axis.title.x = element_text(color="black", size=12, face="bold"),axis.title.y = element_text(color="black", size=12, face="bold"),legend.title = element_blank())</span><span id="791e" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Predicting fraction of these loans will have charged off by the time all of their 3-year terms are finished</em></strong></span><span id="b632" class="np kz jj nl b gy nu nr l ns nt">set.seed(2)<br/>B&lt;-1000<br/>fraction&lt;-replicate(B, {<br/>df2&lt;-data.frame(u=round(runif(50000,0,N)),v=round(runif(50000,0,N))) df2&lt;-df2%&gt;%filter(v&lt;=u) <br/>b2&lt;-(df2%&gt;%filter(u&lt;=730 &amp; v&lt;=730))<br/>total&lt;-(nrow(df2)/nrow(b2))*nrow(default)<br/>100.0*(total/50000.0)})</span><span id="a296" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Figure 6: Histogram for fraction of charged off loans after 3-year term using N = 1000 samples</em></strong></span><span id="4b10" class="np kz jj nl b gy nu nr l ns nt">fdf&lt;-data.frame(fraction=fraction)<br/>fdf%&gt;%ggplot(aes(fraction))+geom_histogram(color="white",fill="skyblue")+ xlab('fraction of charged off loans after 3-year term')+ylab('count')+ ggtitle("Histogram of total fraction of charged off loans")+ <br/>theme( plot.title = element_text(color="black", size=12, hjust=0.5, face="bold"),axis.title.x = element_text(color="black", size=12, face="bold"),axis.title.y = element_text(color="black", size=12, face="bold"),legend.title = element_blank())</span><span id="61d3" class="np kz jj nl b gy nu nr l ns nt"><strong class="nl jk"><em class="mr">#Calculate Confidence Interval for Percentage of Defaulted Loans After 3-year Term</em></strong></span><span id="6a5d" class="np kz jj nl b gy nu nr l ns nt">mean&lt;-mean(fraction)<br/>sd&lt;-sd(fraction)<br/>confidence_interval&lt;-c(mean-2*sd, mean+2*sd)</span></pre><h1 id="b909" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">四。数据分析的输出</h1><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/9ae55a3e9faa0d11fb7a9bb065ffbb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/0*J5jEo_x2PKtUGnIh.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd la">图1 </strong>:当前贷款发放后天数柱状图。</figcaption></figure><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/9751680d8bc4d0d135cc3858a2ff9340.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/0*rri7U5rZWGHN71BJ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd la">图2 </strong>:违约贷款销账天数直方图。</figcaption></figure><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/019c31bf3b35aaa8d4e07a532aaae0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/0*wEsXul0Swh0h6-eY.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd la">图3 </strong>:违约贷款发放以来天数柱状图。</figcaption></figure><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/d1ac063adb297dd9ee3888a89a12397d.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/0*fe5Le6E7Ivxa8w9T.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd la">图4 </strong>:违约贷款的核销天数与发放后天数的关系图。</figcaption></figure><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/f3a226c4ac048ab0efc396d9aeab4fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/0*0GBvPrV5nBPSgm-4.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd la">图5 </strong>:违约贷款的核销天数与发放后天数的蒙特卡洛模拟。</figcaption></figure><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/4ac7b40e3173e8aa309feb78bec29184.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/0*_i5nRn8tmm20K2Tq.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd la">图6 </strong>:使用N = 1000个样本的3年期后核销贷款比例直方图。</figcaption></figure><p id="f225" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls jk">置信区间结果</strong>:通过创建1000次随机试验，我们获得了3年贷款期限内违约贷款比例的如下分布(见<strong class="ls jk">图6 </strong>)。根据我们的计算，3年贷款期限后将被冲销的贷款部分的95%置信区间相应地为14.8% +- 0.2%。</p><h1 id="930b" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">动词 （verb的缩写）摘要</h1><p id="0f2e" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">总之，我们已经为数据科学编码练习展示了一个示例R脚本。数据集、代码和项目报告可从以下链接下载:<a class="ae jg" href="https://github.com/bot13956/Monte_Carlo_Simulation_Loan_Status" rel="noopener ugc nofollow" target="_blank">贷款状况蒙特卡洛模拟</a>。</p><h1 id="eedd" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">参考</h1><ol class=""><li id="783b" class="ms mt jj ls b lt lu lw lx lz nx md ny mh nz ml oa my mz na bi translated"><a class="ae jg" href="https://github.com/bot13956/Monte_Carlo_Simulation_Loan_Status" rel="noopener ugc nofollow" target="_blank">贷款状态的蒙特卡洛模拟</a>。</li><li id="87f8" class="ms mt jj ls b lt nb lw nc lz nd md ne mh nf ml oa my mz na bi translated"><a class="ae jg" href="https://medium.com/towards-artificial-intelligence/data-scientist-coding-exercise-e62f4de7df9e" rel="noopener">数据科学家编码练习</a>。</li><li id="bdb1" class="ms mt jj ls b lt nb lw nc lz nd md ne mh nf ml oa my mz na bi translated"><a class="ae jg" href="https://medium.com/towards-artificial-intelligence/data-scientist-interview-process-a-personal-experience-33295495b4a0" rel="noopener">数据科学家面试流程——个人经历。</a></li></ol></div></div>    
</body>
</html>