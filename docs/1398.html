<html>
<head>
<title>Predicting the Future With AI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用人工智能预测未来</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/predicting-the-future-with-ai-be0bd1296d92?source=collection_archive---------3-----------------------#2021-01-17">https://pub.towardsai.net/predicting-the-future-with-ai-be0bd1296d92?source=collection_archive---------3-----------------------#2021-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2fe4" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a>，<a class="ae ep" href="https://towardsai.net/p/category/future" rel="noopener ugc nofollow" target="_blank">未来</a></h2><div class=""/><div class=""><h2 id="b31d" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated"><em class="kr">利用ARIMA模型对以太坊每日价格进行时间序列分析</em></h2></div><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/db2b992a519914b4f4fca2e8178775f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tkV2uxwqUOFANHoJ"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@heyerlein?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> h heyerlein </a>在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="7ad0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><em class="mf">我们能预测未来吗？</em>大多数人会说不会。让我们改变一下问题的措辞:<em class="mf">过去的数据能告诉我们一些关于未来的事情吗？</em>这似乎更直观，这也是<strong class="ll jd">时间序列分析</strong>试图回答的问题。</p><p id="fc2f" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">因此，亲爱的读者，在这里我向你介绍一些我认为对时间序列分析很重要的技术。今天，考虑到这一点，我们将使用ARIMA模型来分析以太坊的每日价格。</p><p id="ebfc" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">首先，与每个数据科学项目一样，我们需要了解我们正在研究的领域。让我们从这个开始:</p><h2 id="6489" class="mg mh it bd mi mj mk dn ml mm mn dp mo ls mp mq mr lw ms mt mu ma mv mw mx iz bi translated"><strong class="ak">以太坊是什么？而我们为什么要分析它？</strong></h2><p id="2f7f" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">以太坊是最著名的加密货币之一。如果你不知道什么是加密货币，这里是我的快速全景概述:一种<strong class="ll jd">加密货币</strong>是一种使用一种叫做<strong class="ll jd">区块链技术的货币系统。</strong>这项技术让人们可以虚拟地拥有某些东西——就像你可以物理地拥有一样。我们为什么关心？嗯，不仅区块链是一项创新技术，而且市场对它有一些极端的反应。尽管预测市场走势并不简单，但我们可以通过研究在这个过程中走得更远。此外，加密货币为研究时间序列分析提供了一个完美的环境。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="b1ec" class="nk mh it bd mi nl nm nn ml no np nq mo ki nr kj mr kl ns km mu ko nt kp mx nu bi translated">好了，让我们开始分析吧</h1><p id="082b" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">在整篇文章中，我将假设您已经掌握了一些计算机科学、统计学和Python的知识。然而，我会检查这个分析的每一部分，所以如果你没有这些主题的重要背景，我认为你仍然可以享受这个项目并从中学习。</p><p id="4a8d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在整个分析过程中，我将使用Python。你可以在下面的Github repo下找到完整的Jupyter笔记本以及所有的代码和注释:<a class="ae li" href="https://github.com/leonardosavasta/ethereum_analysis.git" rel="noopener ugc nofollow" target="_blank">https://github.com/leonardosavasta/ethereum_analysis.git</a>。您还可以找到包含数据的CSV文件。</p><p id="7e3e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">首先，让我们将数据导入Pandas。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">我们将数据导入Pandas，这只是一个用于操作数据的Python库</figcaption></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nx"><img src="../Images/40191f5f54bf77bf8b350557ff9cfec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YO56Ex15BwlYiMitHzt6iQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">数据集的前5行</figcaption></figure><h1 id="4bc2" class="nk mh it bd mi nl ny nn ml no nz nq mo ki oa kj mr kl ob km mu ko oc kp mx nu bi translated"><strong class="ak">数据探索</strong></h1><p id="36ed" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">我们将花一些时间进行我们称之为数据探索的工作。为什么？因为我们想在开始创建模型之前了解我们的数据。在数据科学中，我们的目标是从我们拥有的数据中洞察某个主题。通常，我们会创建一个模型来根据我们的数据预测值或自动决策。但是如果我们不明白我们首先要处理的是什么，我们怎么能创建一个好的模型呢？</p><p id="741d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">理解我们数据的一个好方法是通过可视化。让我们从一个简单的每日价格图表开始:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi od"><img src="../Images/65d6ce784d3fcdca763d713279804b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yIY3o-6ml0aLE56havPsYQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">以太坊收盘价(美元)</figcaption></figure><p id="c829" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们看到数据的波动性很大(从数学角度来说，我们有很高的方差)。我们也可以看到某种上升趋势。</p><p id="d0e3" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">让我们创建一个价格直方图:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oe"><img src="../Images/b5fb0ed23add1fc7eab9d4816fa7855d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SL9vrkfUMACSHE88AX2VGA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">以太坊收盘价柱状图</figcaption></figure><p id="10e5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这里，我们去掉了时间成分。我们想看看我们所说的价格的“T2”分布。如你所见，这里很乱。我们的大部分价格在100美元到300美元之间，但是我们有一条向右的长尾(右偏)。这种分布不是我们所说的“<em class="mf">正态</em>或“<em class="mf">高斯</em>”分布，这使得分析起来很有挑战性。</p><h2 id="6b71" class="mg mh it bd mi mj mk dn ml mm mn dp mo ls mp mq mr lw ms mt mu ma mv mw mx iz bi translated">综合</h2><p id="1d82" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">让我给你展示一种叫做整合的技术。整合是一个花哨的术语，用来描述一天与下一天的价格差异。别担心，这和微积分里的积分没关系。所以现在，我们不绘制价格，而是绘制价格的每日变化:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">我们计算1阶和2阶的积分</figcaption></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi of"><img src="../Images/addf60b38bd4eb112d58f483130902a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ak3zYPTK9ANiRjbXNITF6Q.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">订单1的整合</figcaption></figure><p id="a5e5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">瞧啊。多美啊。结果是，当我们执行集成时，我们“<em class="mf">归一化</em>我们的数据。我们的分配不再混乱。这是我们可以利用的数据。为什么？大多数统计模型和公式都设计为使用正态分布。积分是一种使我们的分布标准化的技术(对时间序列数据特别有效)。有时，即使在应用集成之后，我们的数据可能仍然不正常。在这种情况下，我们可以再次积分并得到变化的<em class="mf">变化</em>——这被称为二阶积分。正如你可能猜到的，你可以积分任意多次来得到一个正态分布。</p><p id="feb4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">让我们看看订单2在我们的发行版中的集成情况:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi og"><img src="../Images/275ce80191f7a1089f99cb3758058144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eT96WdvTnVnl9cH54JydNA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">2阶积分</figcaption></figure><p id="2a8e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">非常好。二阶积分去除了一些异常值。</p><p id="2906" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">当我们绘制这个时间图时，我们得到了这样一幅图:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oh"><img src="../Images/af93266b0ecb2e43c8c273140cf4f289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e4ImjlmxlBiAZEWUZoPrVg.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">以太坊时间序列的积分阶2</figcaption></figure><p id="7018" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这里我们看到了随着时间的推移，整合的效果。我们排除了价格的上升趋势，这个序列看起来完全是随机的。换句话说，以太坊每日价格的<em class="mf">变化</em>看起来是随机的。这导致了时间序列分析中的一个重要问题——平稳性:</p><h2 id="b0ad" class="mg mh it bd mi mj mk dn ml mm mn dp mo ls mp mq mr lw ms mt mu ma mv mw mx iz bi translated">平稳性——什么？为什么呢？</h2><p id="1abf" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">为了分析时间序列数据(比如我们的价格)，我们需要我们的时间序列是平稳的。平稳性有一个正式的数学定义。但是对于那些想跳过这一点的人来说，这里有一个简单的定义——在任何时间点看起来随机的图表，没有明确的趋势或季节性，很可能是<em class="mf">平稳的</em>。</p><p id="3b3e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">如果你感兴趣，这里有一个关于平稳性的更正式解释的链接:【https://people.duke.edu/~rnau/411diff.htm<a class="ae li" href="https://people.duke.edu/~rnau/411diff.htm" rel="noopener ugc nofollow" target="_blank"/></p><p id="4386" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">只要看一眼图表，你就可能知道它是否是静止的。然而，作为数据科学家，我们希望量化这些决定(我们需要证明我们的研究)。一种被称为<strong class="ll jd">迪基-富勒测试</strong>的统计测试给我们一个时间序列是非平稳的概率(在这里，我重复一遍，它是非平稳的概率<em class="mf"/>)。因此，如果你想要一个平稳的时间序列，就像我们一样，你希望得到一个非常低的值。</p><p id="d0a7" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">从理论上讲，你永远无法说一个时间序列是否是平稳的，这就是为什么我们要处理概率。你可以决定什么概率让你舒服(或者用更统计学的术语来说，当你拒绝你的假设时)。</p><p id="1992" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">如果我们将Dickey-Fuller测试应用于我们的原始价格时间序列，我们得到:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7b0c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><em class="mf">此代码打印的值为0.8506393361925488。</em></p><p id="d9f7" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">所以我们有85%的把握这个时间序列不是平稳的。让我们看看综合时间序列:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="4e28" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><em class="mf">此代码打印值2.0959246928695642e-14。</em></p><p id="d6b0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">太棒了。这个值对我们来说已经足够低了，我们可以称这个时间序列为平稳的用于我们的研究。</p><p id="5428" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们的目标是执行价格预测，为此，我们将使用<strong class="ll jd">监督学习</strong>。由于我们在探索中发现我们的时间序列在积分后是平稳的，所以我们可以使用<strong class="ll jd">自回归积分移动平均</strong>模型<strong class="ll jd"> (ARIMA) </strong>。我们来谈谈那是什么。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="db6c" class="nk mh it bd mi nl nm nn ml no np nq mo ki nr kj mr kl ns km mu ko nt kp mx nu bi translated">自回归综合移动平均(ARIMA)</h1><p id="59bf" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">在整合数据后，ARIMA将自回归模型与移动平均模型结合起来。我们已经讨论过积分，所以我将快速回顾一下自回归和移动平均。</p><p id="e0ee" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">自回归模型是一种使用历史值作为预测值的回归。根据定义，它假设我们可以根据历史数据预测时间序列的当前值。如果您想更深入地了解这一特定模型的数学，下面是数学函数:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b04d53c343cf924a8deaa1d1e830d118.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*1qBRfsR4s5oioqcs31Ygwg.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">一阶自回归模型</figcaption></figure><p id="3e8c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这里有一个更正式的解释链接<a class="ae li" href="https://online.stat.psu.edu/stat501/lesson/14/14.1" rel="noopener ugc nofollow" target="_blank">https://online.stat.psu.edu/stat501/lesson/14/14.1</a></p><p id="b70c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">均线模型也类似。我们试图使用以前的预测误差作为预测值来预测当前值。这是数学符号:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/daca3a7cbb9d68b4c412c863d3868bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*9CY--BH6PteEeQqD7cuokw.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">一阶移动平均模型</figcaption></figure><p id="864d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这里有一个进一步解释它的链接:<a class="ae li" href="https://online.stat.psu.edu/stat510/lesson/2/2.1" rel="noopener ugc nofollow" target="_blank">https://online.stat.psu.edu/stat510/lesson/2/2.1</a></p><p id="867e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">ARIMA模型集成了时间序列，然后将自回归模型与移动平均模型相结合来创建预测。</p><p id="6ac5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">让我们看看我们的代码是什么样子的:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="a0c0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">首先，我们划分数据，只使用前500天来训练我们的模型，剩下的时间用于测试。从一开始就留出一部分数据集进行测试是一个很好的做法，这样可以减少我们的偏见。</p><p id="bc63" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd">现在，ARIMA模型有三个参数:</strong></p><ul class=""><li id="6e98" class="ok ol it ll b lm ln lp lq ls om lw on ma oo me op oq or os bi translated">第一个是您希望在模型的自回归部分使用的历史数据点的数量</li><li id="f0f8" class="ok ol it ll b lm ot lp ou ls ov lw ow ma ox me op oq or os bi translated">第二个参数是您想要使用的积分顺序。为此，我们已经讨论过我们将使用二阶。</li><li id="aaec" class="ok ol it ll b lm ot lp ou ls ov lw ow ma ox me op oq or os bi translated">第三个是您希望在模型的移动平均部分使用的历史错误的数量。</li></ul><h2 id="a7c3" class="mg mh it bd mi mj mk dn ml mm mn dp mo ls mp mq mr lw ms mt mu ma mv mw mx iz bi translated">我们如何识别这些参数？</h2><p id="6f4f" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">我们已经讨论了为什么我们使用二阶积分。现在，我们来谈谈如何找到第一个和第三个参数。</p><p id="f5e7" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd">自相关</strong></p><p id="47c2" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">自相关告诉我们历史价格与当前价格的相关程度。如果x是我们在t时刻的价格，我们想知道我们的价格在t-1，t-2时刻的相关程度。为了找到我们的第三个参数(我们的移动平均线模型的阶)，我们想要确定超过某个阈值的与我们的当前价格自相关的历史价格的数量。令人欣慰的是，一个简单的库将帮助我们做到这一点，但首先，让我解释一下我们的第一个参数。</p><p id="012f" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd">部分自相关</strong></p><p id="c7f0" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">如果x是我们在时间t的价格，我们可能会发现我们在时间t-2的价格(比如p2)和我们在时间t-1的价格(比如p1)与x相关。我们还知道p2和p1本身也是相关的。这意味着p2可能仅由于<strong class="ll jd">传递性</strong>而与x相关。偏相关函数会告诉我们，去掉传递性之后，我们的历史价格与当前价格的相关程度。在显著性阈值以上部分相关的历史价格的数量给了我们第一个参数(自相关顺序)。</p><p id="09d7" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd">这里是我们在Python中如何做的。</strong></p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="219b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们得到下面的图表:</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oy"><img src="../Images/e71fab4c400a7aea0eb285e62bbeb540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQ5e8MYGxRD9-waNkoEMPw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">自相关和偏自相关</figcaption></figure><p id="03f8" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们的第一个元素(在t-0)的值总是1，因为它是当前价格。在自相关图中，我们只有2个历史价格点超过了显著性阈值。另一方面，我们的部分自相关图显示，我们有9个元素超过了显著性阈值。</p><p id="a855" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们找到参数(2，2，9)。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="9467" class="nk mh it bd mi nl nm nn ml no np nq mo ki nr kj mr kl ns km mu ko nt kp mx nu bi translated">现在，让我们来测试一下！</h1><p id="2827" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">通常在测试一个模型时，我们随机分离数据作为测试环境的一部分，但是时间序列是不同的。由于我们数据的连续性很重要(时间是一个因素)，我们将最后150个左右的值分开进行测试。此外，随着我们远离上一个训练数据点，我们模型的性能将会下降。或者换句话说，我们对明天价格的预测会比我们对下周的预测更准确。</p><p id="f72c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd">构建我们的测试环境</strong></p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="13af" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们将在前500个数据点上训练我们的模型。然后，我们将预测下一个值，并将其添加到我们的预测序列中。然后我们获得实际价格并再次训练。我们迭代我们的测试数据。</p><p id="1d34" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这个过程允许我们为每天的测试数据测试我们的模型，总是提前一天预测。我们的模型预测综合数据，因此我们现在需要将这些预测转换为实际价格。下面的函数从我们的集成数据中返回真实值。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="8740" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">使用该函数，我们可以在预测中反转积分并绘制图表:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/79ff7ec77a9b8822c8ba9258c04c0d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*eMfQ56B989Y9ECuFdT172A.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">提前一天的价格预测与实际价格</figcaption></figure><p id="0fe4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们的模型可以适度预测以太币美元的价格变化。正如我们在图表中看到的，在许多情况下，该模型未能正确预测价格。在某些情况下，我们预测了方向，但低估了运动的程度。其他时候，我们是准确的。我们可以从ARIMA模型中期待这一点。毕竟，预测未来不是一项简单的任务，但希望时间序列分析能给我们一些以前没有的洞察力。</p><h2 id="5730" class="mg mh it bd mi mj mk dn ml mm mn dp mo ls mp mq mr lw ms mt mu ma mv mw mx iz bi translated">接下来呢？</h2><p id="79eb" class="pw-post-body-paragraph lj lk it ll b lm my kd lo lp mz kg lr ls na lu lv lw nb ly lz ma nc mc md me im bi translated">其他模型也有广泛的研究，包括用于时间序列分析的深度学习(神经网络)。我将留下一篇文章的链接，这篇文章探索了一种不同的方法。希望跟随这个项目为您分析时间序列数据打下了良好的基础。</p><p id="f0a2" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><a class="ae li" href="https://towardsdatascience.com/how-to-use-deep-learning-for-time-series-forecasting-3f8a399cf205" rel="noopener" target="_blank">https://towards data science . com/how-to-use-deep-learning-for-time-series-forecasting-3f8a 399 cf 205</a></p></div></div>    
</body>
</html>