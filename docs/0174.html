<html>
<head>
<title>Feature Selection and Dimensionality Reduction Using Covariance Matrix Plot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用协方差矩阵图的特征选择和降维</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/feature-selection-and-dimensionality-reduction-using-covariance-matrix-plot-b4c7498abd07?source=collection_archive---------0-----------------------#2019-10-07">https://pub.towardsai.net/feature-selection-and-dimensionality-reduction-using-covariance-matrix-plot-b4c7498abd07?source=collection_archive---------0-----------------------#2019-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="987b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/c0a40003c557d00185c8d335e4f29c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXfQAFTxQVe13zrO9N-jQQ.png"/></div></div></figure><p id="e17a" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">本文将讨论如何将协方差矩阵图用于特征选择和降维。</p><h2 id="eb84" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated"><strong class="ak">为什么特征选择和降维很重要？</strong></h2><p id="d3e9" class="pw-post-body-paragraph kk kl it km b kn ma kp kq kr mb kt ku kv mc kx ky kz md lb lc ld me lf lg lh im bi translated">机器学习算法(如分类、聚类或回归)使用训练数据集来确定权重因子，这些权重因子可应用于未知数据以实现预测目的。在实现机器学习算法之前，有必要在训练数据集中仅选择相关特征。转换数据集以便只选择训练所需的相关特征的过程称为降维。特征选择和维数减少是重要的，因为有三个主要原因:</p><ol class=""><li id="5a0b" class="mf mg it km b kn ko kr ks kv mh kz mi ld mj lh mk ml mm mn bi translated"><strong class="km jd">防止过度拟合</strong>:拥有太多特征的高维数据集有时会导致过度拟合(模型捕捉真实和随机效果)。</li><li id="bbfb" class="mf mg it km b kn mo kr mp kv mq kz mr ld ms lh mk ml mm mn bi translated"><strong class="km jd">简单性</strong>:具有太多特征的过于复杂的模型可能很难解释，尤其是当特征相互关联的时候。</li><li id="353c" class="mf mg it km b kn mo kr mp kv mq kz mr ld ms lh mk ml mm mn bi translated"><strong class="km jd">计算效率</strong>:在低维数据集上训练的模型在计算上是高效的(算法的执行需要较少的计算时间)。</li></ol><p id="8fce" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">因此，降维在数据预处理中起着至关重要的作用。</p><p id="26e4" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们将使用游轮数据集<a class="ae mt" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank"><strong class="km jd">cruise _ ship _ info . CSV</strong></a>用协方差矩阵图来说明特征选择和降维的过程。假设我们要建立一个回归模型来预测邮轮<strong class="km jd">的船员人数</strong>，基于以下特征:【’<strong class="km jd">年龄</strong>’、<strong class="km jd">吨位</strong>’、<strong class="km jd">乘客</strong>、<strong class="km jd">长度</strong>、<strong class="km jd">舱室</strong>、<strong class="km jd">乘客_密度</strong>。我们的模型可以表示为:</p><figure class="mv mw mx my gt kd gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/e043848211e667766f984b2d2e977de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*zbG8jIqHCJ6NKF-Emfg2rQ.png"/></div></figure><p id="cc96" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">其中<strong class="km jd"> X </strong>为特征矩阵，<strong class="km jd"> w </strong>为训练时需要学习的权重。我们要解决的问题如下:</p><p id="c747" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在6个特征[' <strong class="km jd">年龄</strong>'、<strong class="km jd">吨位</strong>'、<strong class="km jd">乘客</strong>'、<strong class="km jd">长度</strong>'、<strong class="km jd">车厢</strong>'、<strong class="km jd">乘客_密度</strong> ]中，哪一个最重要？</p><p id="e2c1" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们将确定训练模型需要哪些特征。</p><p id="2f51" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">本文的数据集和jupyter笔记本文件可以从这个存储库下载:<a class="ae mt" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank">https://github . com/bot 13956/ML _ Model _ for _ Predicting _ Ships _ Crew _ Size</a>。</p><h2 id="40ba" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated">1.导入必要的库</h2><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="8d4e" class="li lj it na b gy ne nf l ng nh"><strong class="na jd">import</strong> <strong class="na jd">numpy</strong> <strong class="na jd">as</strong> <strong class="na jd">np</strong> <br/><strong class="na jd">import</strong> <strong class="na jd">pandas</strong> <strong class="na jd">as</strong> <strong class="na jd">pd</strong> <br/><strong class="na jd">import</strong> <strong class="na jd">matplotlib.pyplot</strong> <strong class="na jd">as</strong> <strong class="na jd">plt</strong> <br/><strong class="na jd">import</strong> <strong class="na jd">seaborn</strong> <strong class="na jd">as</strong> <strong class="na jd">sns</strong></span></pre><h2 id="063a" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated">2.读取数据集并显示列</h2><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="95d0" class="li lj it na b gy ne nf l ng nh">df=pd.read_csv("cruise_ship_info.csv")<br/>df.head()</span></pre><figure class="mv mw mx my gt kd gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5f7c16b21a48fff2b1af4d2062c1ac0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*iNlNvR0hj3i3XFHyvxIMfg.png"/></div></figure><h2 id="cfef" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated">3.计算数据的基本统计</h2><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="3001" class="li lj it na b gy ne nf l ng nh">df.describe()</span></pre><figure class="mv mw mx my gt kd gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8d0ec69bfc7fc1ca9ecb5313fbd57315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*kw4-J0dsmMmhDNBhvoJccA.png"/></div></figure><h2 id="3c95" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated">4.生成配对图</h2><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="7c50" class="li lj it na b gy ne nf l ng nh">cols = ['Age', 'Tonnage', 'passengers', 'length', 'cabins','passenger_density','crew']</span><span id="619c" class="li lj it na b gy nk nf l ng nh">sns.pairplot(df[cols], size=2.0)</span></pre><figure class="mv mw mx my gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nl"><img src="../Images/6b8c81da53da4819580a31ca4c58b946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YL6DMZ0mcsedfOtjWpDoZw.png"/></div></div></figure><p id="ae75" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们从配对图中观察到，目标变量'<strong class="km jd">乘务人员</strong>'与4个预测变量有很好的相关性，即'<strong class="km jd">吨位</strong>'、<strong class="km jd">乘客</strong>'、<strong class="km jd">长度</strong>'和'<strong class="km jd">客舱</strong>'。</p><p id="4b98" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">为了量化相关程度，我们计算协方差矩阵。</p><h2 id="b479" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated"><strong class="ak"> 5。预测“团队”规模的变量选择</strong></h2><h2 id="d8b9" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated"><strong class="ak"> 5 (a)协方差矩阵的计算</strong></h2><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="fe80" class="li lj it na b gy ne nf l ng nh">cols = ['Age', 'Tonnage', 'passengers', 'length', 'cabins','passenger_density','crew'] </span><span id="e5fa" class="li lj it na b gy nk nf l ng nh"><strong class="na jd">from</strong> <strong class="na jd">sklearn.preprocessing</strong> <strong class="na jd">import</strong> StandardScaler <br/>stdsc = StandardScaler() <br/>X_std = stdsc.fit_transform(df[cols].iloc[:,range(0,7)].values)</span><span id="3bc8" class="li lj it na b gy nk nf l ng nh">cov_mat =np.cov(X_std.T)<br/>plt.figure(figsize=(10,10))<br/>sns.set(font_scale=1.5)<br/>hm = sns.heatmap(cov_mat,<br/>                 cbar=True,<br/>                 annot=True,<br/>                 square=True,<br/>                 fmt='.2f',<br/>                 annot_kws={'size': 12},<br/>                 cmap='coolwarm',                 <br/>                 yticklabels=cols,<br/>                 xticklabels=cols)<br/>plt.title('Covariance matrix showing correlation coefficients', size = 18)<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="mv mw mx my gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/c0a40003c557d00185c8d335e4f29c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXfQAFTxQVe13zrO9N-jQQ.png"/></div></div></figure><h2 id="fbf1" class="li lj it bd lk ll lm dn ln lo lp dp lq kv lr ls lt kz lu lv lw ld lx ly lz iz bi translated"><strong class="ak"> 5 (b)选择重要变量(列)</strong></h2><p id="28ec" class="pw-post-body-paragraph kk kl it km b kn ma kp kq kr mb kt ku kv mc kx ky kz md lb lc ld me lf lg lh im bi translated">从上面的协方差矩阵图中，如果我们假设重要特征具有0.6或更大的相关系数，那么我们看到"<strong class="km jd">船员</strong>变量与4个预测变量强烈相关:"<strong class="km jd">吨位</strong>"、"<strong class="km jd">乘客</strong>"、"<strong class="km jd">长度</strong>和"<strong class="km jd">客舱</strong>"。</p><pre class="mv mw mx my gt mz na nb nc aw nd bi"><span id="080c" class="li lj it na b gy ne nf l ng nh">cols_selected = ['Tonnage', 'passengers', 'length', 'cabins','crew']<br/>  <br/>df[cols_selected].head()</span></pre><figure class="mv mw mx my gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nm"><img src="../Images/a60ebbe22693819835b33893ae04bb89.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ZdNULE_le7vNZHguLPtNaQ.png"/></div></div></figure><p id="9650" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">总之，我们已经展示了协方差矩阵如何用于变量选择和维度缩减。我们已经将原始维度从6减少到4。</p><p id="901c" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">其他高级的特征选择和降维方法有<strong class="km jd">主成分分析</strong>(PCA)<strong class="km jd">线性判别分析</strong>(LDA)<strong class="km jd">套索回归</strong>、<strong class="km jd">岭回归</strong>。点击以下链接了解更多信息:</p><p id="35f9" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><a class="ae mt" href="https://medium.com/towards-artificial-intelligence/training-a-machine-learning-model-on-a-dataset-with-highly-correlated-features-debddf5b2e34" rel="noopener"> <strong class="km jd">在特征高度相关的数据集上训练机器学习模型</strong> </a></p><p id="497b" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><a class="ae mt" href="https://medium.com/towards-artificial-intelligence/machine-learning-dimensionality-reduction-via-principal-component-analysis-1bdc77462831" rel="noopener"> <strong class="km jd">机器学习:通过主成分分析进行降维</strong> </a></p><p id="1e48" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><a class="ae mt" href="https://medium.com/towards-artificial-intelligence/machine-learning-dimensionality-reduction-via-linear-discriminant-analysis-cc96b49d2757" rel="noopener"> <strong class="km jd">机器学习:通过线性判别分析进行降维</strong> </a></p><p id="3746" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><a class="ae mt" href="https://medium.com/towards-artificial-intelligence/machine-learning-model-for-recommending-the-crew-size-for-cruise-ship-buyers-6dd478ad9900" rel="noopener"> <strong class="km jd">从零开始构建机器学习推荐模型</strong> </a></p></div></div>    
</body>
</html>