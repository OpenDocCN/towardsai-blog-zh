<html>
<head>
<title>Exploring Deep Dream using Tensorflow 2.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tensorflow 2.0探索深层梦境</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/exploring-deep-dream-using-tensorflow-2-0-93ecd1091fa3?source=collection_archive---------0-----------------------#2019-09-13">https://pub.towardsai.net/exploring-deep-dream-using-tensorflow-2-0-93ecd1091fa3?source=collection_archive---------0-----------------------#2019-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0f94" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">使用Tensorflow | <a class="ae ep" href="https://towardsai.net" rel="noopener ugc nofollow" target="_blank">向AI </a>潜入深梦</h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/fea82c523b34100dee62073a0d451025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lf4xTIYt1minBvceeAr69g.jpeg"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">使用张量流的深度梦</figcaption></figure><figure class="km kn ko kp gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi kl"><img src="../Images/75b4b1d79d8ebb7f2d91976c32048ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4W_ov8dmK4-qDCDpYLRuJA.jpeg"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">我深深的梦所产生的形象。</figcaption></figure><p id="b13f" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">每当任何人听到深度学习或神经网络时，他们首先想到的是它用于物体检测、人脸识别、自然语言处理和语音识别。<br/>但是神经网络也能够生成图像。其中一种最先进的方法叫做深度梦境。</p><h1 id="cd0f" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">这是什么？</h1><p id="8aef" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">Deep Dream是谷歌工程师Alex Mordvintsev创建的一个计算机视觉程序，它使用卷积神经网络通过算法pareidolia来寻找和增强图像中的模式，从而在故意过度处理的图像中创建一个梦一样的幻觉外观。</p><h2 id="4271" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">一些使用深梦生成的图像</h2><figure class="km kn ko kp gt ka gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/aaac8d3e8054eb421d85c7b47419ffd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*3E2O-2ZlXHlqWzPxVTQWxA.jpeg"/></div></figure><figure class="km kn ko kp gt ka gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/666262189aab65015f567275c41dc42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*KtXxRlN5vTIbYfA-SYm4tg.jpeg"/></div></figure><figure class="km kn ko kp gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ne"><img src="../Images/b39d3d33049bd3b013eabf53bcda0847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KncLstAsawToa3hTQiU1Kg.jpeg"/></div></div></figure><figure class="km kn ko kp gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nf"><img src="../Images/878906c1050453cfadf814616a7e5dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AMI3rUyybuSEbMqm6pS8Lg.jpeg"/></div></div></figure><h1 id="384c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">它是如何工作的？</h1><p id="2f82" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">简单地说，许多层次的神经网络处理输入到程序中的图像。人工神经元被计算，它们总和的权重通过大致三层的网络进行处理:低层、中层和高层。较低的级别负责更基本的边、角和纹理。通过最大化这些层次，这幅画最终会看起来更像梵高的作品。更高的层次负责更详细、更层次化的输入，比如建筑物和其他精致的物体。当更高的级别被最大化时，图片看起来更像一个乱糟糟的达利。</p><h1 id="6c01" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">让我们创造我们第一个简单的梦。</h1><p id="6394" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">在本教程中，我们将使用Tensorflow 2.0，并在Google Colab上运行它。<br/>在接下来的6个步骤中，我们将建立第一个深度梦境模型。<br/>那么让我们开始吧。</p><h2 id="5d45" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">1.导入所有依赖项</h2><p id="a831" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">在这里，我们将使用印度女演员迪皮卡·帕度柯妮的形象，然后预处理它。</p><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="7c15" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">输出:-</p><figure class="km kn ko kp gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ni"><img src="../Images/51b1e3bdf4a39cbe822618b9a65767cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PqA_PdYHSnss9DnGBZrbVA.jpeg"/></div></div></figure><h2 id="6b67" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">2.准备特征提取模型</h2><p id="03f4" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">下载并准备一个预先训练好的图像分类模型。您将使用InceptionV3，它类似于DeepDream中最初使用的模型。<br/>InceptionV3架构相当庞大(关于模型架构的图表，请参见TensorFlow的研究报告)。对于DeepDream，感兴趣的层是那些卷积连接在一起的层。在InceptionV3中有11个这样的层，命名为‘mixed 0’到‘mixed 10’。使用不同的图层会产生不同的梦幻般的图像。较深的层响应较高级别的特征(例如眼睛和脸)，而较早的层响应较简单的特征(例如边缘、形状和纹理)。随意试验下面选择的层，但是请记住，更深的层(那些具有更高指数的层)将需要更长的时间来训练，因为梯度计算更深。</p><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="c842" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">3.计算损失</h2><p id="df02" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">损失是所选层中激活的总和。损耗在每一层都是归一化的，因此较大层的贡献不会超过较小层。</p><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="f083" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">4.梯度上升</h2><p id="1b2b" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">一旦你计算了所选层的损失，剩下的就是计算图像的梯度，并将它们添加到原始图像中。向图像添加梯度增强了网络看到的图案。在每一步，你都会创造出一个图像，这个图像会越来越多地激发网络中某些层的活动。</p><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="4ac9" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">输出:-</p><figure class="km kn ko kp gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nj"><img src="../Images/892b542ec017c5c1561c005845ce2847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y6cbbE35DhF3cYJGQvM3eg.png"/></div></div></figure><h2 id="018f" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">5.把它提高一个八度</h2><p id="3358" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">很好，但是第一次尝试有一些问题:<br/> (a)输出有噪声(这可以通过tf.image.total_variation loss解决)。<br/> (b)图像分辨率低。<br/> (c)这些模式看起来好像都是以相同的粒度发生的。<br/>为了克服这些问题，我们可以执行前面的梯度上升方法，然后增加图像的大小(称为八度音阶)，并对多个八度音阶重复这个过程。</p><figure class="km kn ko kp gt ka"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="e108" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">输出:-</p><figure class="km kn ko kp gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nj"><img src="../Images/4bf4aa457676f4487c87ec942e29e8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Sl3gptaiSGcN2a3eebqsg.png"/></div></div></figure><p id="f7c5" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">万岁，我们刚刚使用深度梦境生成了一个图像。<br/>如果您不喜欢手动编写深度梦境算法，而是想用深度梦境创建图像，以下是解决方案。<br/>可以使用DeepDreamGenerator。</p><p id="f71c" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">链接:-</p><div class="nk nl gp gr nm nn"><a href="https://deepdreamgenerator.com/" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ja gy z fp ns fr fs nt fu fw iz bi translated">深度梦境发生器</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">这项技术是原始深度梦境方法的更高级版本。它能够使用自己的…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">deepdreamgenerator.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob kf nn"/></div></div></a></div><p id="a8c6" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">注意:-在上面的例子中，一些代码行没有显示，因为在Medium中只显示了GitHub gist的前11行。所以强烈建议你下载colab笔记本(。ipnyb文件)。</p><p id="666b" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我的深梦回购链接:-</p><div class="nk nl gp gr nm nn"><a href="https://github.com/abhinavsp0730/Deep_Dream" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ja gy z fp ns fr fs nt fu fw iz bi translated">abhinavsp 0730/深_梦</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">我的媒体博客的深梦模式。通过在…上创建帐户，为abhinavsp0730/Deep_Dream开发做贡献</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="oc l ny nz oa nw ob kf nn"/></div></div></a></div><h2 id="101e" class="mr lp iq bd lq ms mt dn lu mu mv dp ly lb mw mx mc lf my mz mg lj na nb mk iw bi translated">参考资料:Tensorflow官方文档</h2><p id="a89e" class="pw-post-body-paragraph kq kr iq ks b kt mm kv kw kx mn kz la lb mo ld le lf mp lh li lj mq ll lm ln ij bi translated">你知道吗，你可以按50次拍手键？如果你喜欢这个博客，鼓掌来表达你的爱。</p><figure class="km kn ko kp gt ka gh gi paragraph-image"><div class="gh gi od"><img src="../Images/61ee3c58d4b040be8643e984391dfde0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*HnhqbqJ1vlHFEZmO5oEtqQ.gif"/></div></figure><p id="e84c" class="pw-post-body-paragraph kq kr iq ks b kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">谢谢你。</p></div></div>    
</body>
</html>