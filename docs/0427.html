<html>
<head>
<title>Covariance Matrix Visualization Using Seaborn’s Heatmap Plot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Seaborn热图的协方差矩阵可视化</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/covariance-matrix-visualization-using-seaborns-heatmap-plot-64332b6c90c5?source=collection_archive---------1-----------------------#2020-04-23">https://pub.towardsai.net/covariance-matrix-visualization-using-seaborns-heatmap-plot-64332b6c90c5?source=collection_archive---------1-----------------------#2020-04-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4f09" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">本教程演示了如何使用seaborn库创建和可视化协方差矩阵</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/425b631712dbc22e89f59dc8b837cebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0SRT5CfIJ009pFQrJe9Tsg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Benjamin O. Tayo的图片</figcaption></figure><h1 id="9e1c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">一.导言</h1><p id="bf9c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在实现机器学习算法之前，有必要在训练数据集中仅选择相关特征。转换数据集以便只选择训练所需的相关特征的过程称为降维。特征选择和维数减少是重要的，因为有三个主要原因:</p><ol class=""><li id="38b1" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated"><strong class="ls iu">防止过度拟合</strong>:具有太多特征的高维数据集有时会导致过度拟合(模型捕捉真实和随机效果)。</li><li id="6ee6" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><strong class="ls iu">简单性</strong>:一个拥有太多特性的过于复杂的模型可能很难解释，尤其是当特性相互关联的时候。</li><li id="47e5" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><strong class="ls iu">计算效率</strong>:在低维数据集上训练的模型在计算上是高效的(执行算法需要更少的计算时间)。</li></ol><p id="0f95" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">协方差矩阵是一种非常简单、有效和可靠的特征选择和降维方法。本教程将说明如何使用seaborn库创建和可视化协方差矩阵图。</p><p id="e996" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">我们将使用游轮数据集<a class="ae nf" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">cruise _ ship _ info . CSV</strong></a>用协方差矩阵图来说明特征选择和维数减少的过程。假设我们要建立一个回归模型来预测邮轮<strong class="ls iu">的船员人数</strong>，基于以下特征:【12】年龄、14】吨位、16乘客、18长度、20船舱、22乘客密度。我们的模型可以表示为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl ng"><img src="../Images/0406b24bed96026cfd0afc35ab96af03.png" data-original-src="https://miro.medium.com/v2/format:webp/0*mzn3yw8IMQYvkZKZ.png"/></div></figure><p id="ecd6" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">其中<strong class="ls iu"> X </strong>为特征矩阵，<strong class="ls iu"> w </strong>为训练时需要学习的权重。我们要解决的问题如下:</p><p id="beec" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">在6个特征[' <strong class="ls iu">年龄</strong>'、<strong class="ls iu">吨位</strong>'、<strong class="ls iu">乘客</strong>'、<strong class="ls iu">长度</strong>'、<strong class="ls iu">车厢</strong>'、<strong class="ls iu">乘客_密度</strong> ]中，哪一个最重要？我们可以通过创建和可视化协方差矩阵来回答这个问题。</p><h1 id="6454" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">二。使用Seaborn库创建和可视化协方差矩阵</h1><h2 id="0f9a" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">导入必要的库</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="8d9d" class="nh kz it nu b gy ny nz l oa ob"><strong class="nu iu">import</strong> <strong class="nu iu">numpy</strong> <strong class="nu iu">as</strong> <strong class="nu iu">np</strong> </span><span id="6f64" class="nh kz it nu b gy oc nz l oa ob"><strong class="nu iu">import</strong> <strong class="nu iu">pandas</strong> <strong class="nu iu">as</strong> <strong class="nu iu">pd</strong> </span><span id="bcb9" class="nh kz it nu b gy oc nz l oa ob"><strong class="nu iu">import</strong> <strong class="nu iu">matplotlib.pyplot</strong> <strong class="nu iu">as</strong> <strong class="nu iu">plt</strong> </span><span id="19c0" class="nh kz it nu b gy oc nz l oa ob"><strong class="nu iu">import</strong> <strong class="nu iu">seaborn</strong> <strong class="nu iu">as</strong> <strong class="nu iu">sns</strong></span></pre><h2 id="ebae" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">读取数据集并显示列</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="b7f6" class="nh kz it nu b gy ny nz l oa ob">df = pd.read_csv("cruise_ship_info.csv")</span><span id="6c52" class="nh kz it nu b gy oc nz l oa ob">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/3b4e7dd66d9b7d65eb3b755978fc558e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TnZBUDvcjiYmzxWBs-XoJA.png"/></div></div></figure><h2 id="3aa6" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">计算协方差矩阵</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="59ba" class="nh kz it nu b gy ny nz l oa ob">cols = ['Age', 'Tonnage', 'passengers', 'length', 'cabins','passenger_density','crew']</span><span id="90d2" class="nh kz it nu b gy oc nz l oa ob"><strong class="nu iu">from</strong> <strong class="nu iu">sklearn.preprocessing</strong> <strong class="nu iu">import</strong> StandardScaler</span><span id="4e4c" class="nh kz it nu b gy oc nz l oa ob">stdsc = StandardScaler()</span><span id="5e9a" class="nh kz it nu b gy oc nz l oa ob">X_std = stdsc.fit_transform(df[cols].iloc[:,range(0,7)].values</span><span id="37d3" class="nh kz it nu b gy oc nz l oa ob">cov_mat =np.cov(X_std.T)</span></pre><h2 id="8d0f" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">生成用于显示协方差矩阵的热图</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="5d74" class="nh kz it nu b gy ny nz l oa ob">plt.figure(figsize=(10,10))</span><span id="9b2c" class="nh kz it nu b gy oc nz l oa ob">sns.set(font_scale=1.5)</span><span id="b208" class="nh kz it nu b gy oc nz l oa ob">hm = sns.heatmap(cov_mat,<br/>                 cbar=<strong class="nu iu">True</strong>,<br/>                 annot=<strong class="nu iu">True</strong>,<br/>                 square=<strong class="nu iu">True</strong>,<br/>                 fmt='.2f',<br/>                 annot_kws={'size': 12},<br/>                 yticklabels=cols,<br/>                 xticklabels=cols)</span><span id="002c" class="nh kz it nu b gy oc nz l oa ob">plt.title('Covariance matrix showing correlation coefficients')</span><span id="b55b" class="nh kz it nu b gy oc nz l oa ob">plt.tight_layout()</span><span id="28d9" class="nh kz it nu b gy oc nz l oa ob">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/425b631712dbc22e89f59dc8b837cebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0SRT5CfIJ009pFQrJe9Tsg.png"/></div></div></figure><h2 id="c07b" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">使用协方差矩阵图的特征选择</h2><p id="c4e1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">从上面的协方差矩阵图中，我们看到“船员”变量与4个预测变量“吨位”、“乘客”、“长度”和“客舱”密切相关(相关系数≥ 0.6)。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="5fdf" class="nh kz it nu b gy ny nz l oa ob">cols_selected = ['Tonnage', 'passengers', 'length', 'cabins','crew']</span><span id="f2d9" class="nh kz it nu b gy oc nz l oa ob">df[cols_selected].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/595252f5c0080656383ecc65a2ff3f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*a2URz3F5LvV2aH_ckTN85A.png"/></div></figure><h2 id="ce22" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">定义您的特征和目标变量</h2><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="a0f4" class="nh kz it nu b gy ny nz l oa ob">X = df[cols_selected].iloc[:,0:4].values    <em class="of"># features matrix </em> </span><span id="32d0" class="nh kz it nu b gy oc nz l oa ob">y = df[cols_selected]['crew'].values        <em class="of"># target variable</em></span></pre><p id="e5cd" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">上面获得的特征矩阵和目标变量然后可以用于<a class="ae nf" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank">模型建立</a>。</p><h1 id="e70f" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">三。总结和结论</h1><p id="6bc3" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">总之，我们已经展示了如何使用seaborn的热图工具创建和可视化协方差矩阵。利用协方差矩阵的可视化，使用特征选择将原始维数从6降低到4。</p><p id="fcfe" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">其他高级的特征选择和降维方法有<strong class="ls iu">主成分分析</strong>(PCA)<strong class="ls iu">线性判别分析</strong>(LDA)<strong class="ls iu">套索回归</strong>、<strong class="ls iu">岭回归</strong>。点击以下链接了解更多信息:</p><p id="31fc" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><a class="ae nf" href="https://medium.com/towards-artificial-intelligence/machine-learning-dimensionality-reduction-via-principal-component-analysis-1bdc77462831" rel="noopener"> <strong class="ls iu">机器学习:通过主成分分析进行降维</strong> </a></p><p id="1ca0" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><a class="ae nf" href="https://medium.com/towards-artificial-intelligence/machine-learning-dimensionality-reduction-via-linear-discriminant-analysis-cc96b49d2757" rel="noopener"> <strong class="ls iu">机器学习:通过线性判别分析进行降维</strong> </a></p><p id="650a" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">本文的数据集和jupyter笔记本文件可以从这个存储库下载:<a class="ae nf" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank">https://github . com/bot 13956/ML _ Model _ for _ Predicting _ Ships _ Crew _ Size</a>。</p></div></div>    
</body>
</html>