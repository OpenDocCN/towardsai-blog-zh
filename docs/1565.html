<html>
<head>
<title>How to Evaluate your Model using the Confusion Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用混淆矩阵评估你的模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/deep-understanding-of-confusion-matrix-6ab1f88a267e?source=collection_archive---------1-----------------------#2021-02-22">https://pub.towardsai.net/deep-understanding-of-confusion-matrix-6ab1f88a267e?source=collection_archive---------1-----------------------#2021-02-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b411" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/658d538707530c2b9b75d44c6ae9b0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PPgItHcPSaskyjLMWFC-Kw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">作者图片</figcaption></figure><p id="623f" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在我攻读数据科学硕士学位的第一年，我遇到过混淆矩阵。教授第一次讲解的时候，我没什么感觉，但是<strong class="kq jd">困惑</strong>！由于这个原因，我想用简单的语言解释这个矩阵之外的概念，那将是你每次需要评估模型性能时的伙伴。</p><p id="b1db" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">那么，什么是混淆矩阵呢？我们为什么需要它？一般来说，这是一个有助于了解模型是否运行良好的工具。而且从中可以衍生出很多评价指标，比如准确率、精确度、召回率等。这是基于这样一个事实，即我们需要将分类器预测的<strong class="kq jd">类别</strong>与每次观察的<strong class="kq jd">实际类别</strong>进行比较。</p><p id="aa9a" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以，一个模型的效率可以用这个惊人的矩阵来看。每一列对应于预测的类别，而每一行表示实际的类别。例如，如果我们有一个包含3个类的分类器，我们将有一个3x3的矩阵。当类别为4时，矩阵将由4×4的单元构成，依此类推。在任何情况下，<strong class="kq jd">类都是按照排序顺序</strong>使用的。由于这个原因，阳性类位于第二列和第二行，这与许多将真阳性的数量放在矩阵的第一个单元格中的例子形成了对比。</p><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi lm"><img src="../Images/d95957e9066d79f8f5700084ae4308ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUW_kw8H98PL6yU-ItAvlQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">混淆矩阵的例子。作者图片</figcaption></figure><p id="f086" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在值为0和1的二元分类器的情况下，预测分为四类:</p><ul class=""><li id="ff0d" class="lr ls it kq b kr ks kv kw kz lt ld lu lh lv ll lw lx ly lz bi translated"><strong class="kq jd">真阳性</strong>:预测类与实际类相同。在本例中，预测值为1，与该特定观察的实际类别相符。</li><li id="dc11" class="lr ls it kq b kr ma kv mb kz mc ld md lh me ll lw lx ly lz bi translated"><strong class="kq jd">假阴性</strong>:预测类别为阴性，但与实际类别不一致，实际类别为阳性<em class="mf"/>。在示例中，预测值为0，但该观察的实际类为1！所以，预测是错误的。</li><li id="0ba0" class="lr ls it kq b kr ma kv mb kz mc ld md lh me ll lw lx ly lz bi translated"><strong class="kq jd">误报</strong>:预测类为正，实际类为<em class="mf">负</em>。在本例中，预测类别为1，而该观察的实际类别为0。预测又错了！</li><li id="5fce" class="lr ls it kq b kr ma kv mb kz mc ld md lh me ll lw lx ly lz bi translated"><strong class="kq jd">真阴性</strong>:预测类为阴性，与实际相符，也为阴性。在示例中，我们预测了类0，而该观察的实际类是0！最后，我们发现了其他正确的预测，而不仅仅是真阳性。</li></ul></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="4745" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">正如我之前所说的，我们可以从这个工具中获得许多指标。</p><h1 id="2f2c" class="mn mo it bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">准确(性)</h1><p id="0c27" class="pw-post-body-paragraph ko kp it kq b kr nl kt ku kv nm kx ky kz nn lb lc ld no lf lg lh np lj lk ll im bi translated">评估模型时最常用的衡量标准是准确性。让我们记住我所说的矩阵的四个类别。哪些值构成了正确的预测？真阳性(例如:1正确分类)和真阴性(例如:0正确分类)。所以，我们需要将真阳性和真阴性相加，然后除以总数，这是混淆矩阵所有单元的总和。</p><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nq"><img src="../Images/f19aa9bb302d84cd25c965ea3f4fa162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYLvqpvkXAGCJeYz2dk-FQ.png"/></div></div></figure><p id="cb46" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在每一类都有相同数量的观察值的情况下，精确度似乎还可以。但在大多数情况下，我们有不平衡的类，所以我们需要其他的评价措施。</p><h1 id="4621" class="mn mo it bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">精确</h1><p id="16ef" class="pw-post-body-paragraph ko kp it kq b kr nl kt ku kv nm kx ky kz nn lb lc ld no lf lg lh np lj lk ll im bi translated">精度的计算方法是将真阳性除以被<strong class="kq jd"> <em class="mf">标记为阳性</em> </strong>的观察总数。</p><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nr"><img src="../Images/d4846c5ad304551e3ca833132ba0affb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dxpOjBpJjhhIOd2SA_JxFg.png"/></div></div></figure><h1 id="e82b" class="mn mo it bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">回忆</h1><p id="3a54" class="pw-post-body-paragraph ko kp it kq b kr nl kt ku kv nm kx ky kz nn lb lc ld no lf lg lh np lj lk ll im bi translated">回忆表明有多少阳性类别的观察结果被正确分类为阳性。将真阳性除以正确属于阳性类别 的<em class="mf"> </em> <strong class="kq jd"> <em class="mf">的观察总数。</em></strong></p><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ns"><img src="../Images/225337570319347e9024c9e476b0f911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdIqgS4QKK3lfJvdU6E44g.png"/></div></div></figure><h1 id="9dd4" class="mn mo it bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">f1-分数</h1><p id="2c76" class="pw-post-body-paragraph ko kp it kq b kr nl kt ku kv nm kx ky kz nn lb lc ld no lf lg lh np lj lk ll im bi translated">我们可以将精确度和召回率合并为一个度量，称为F1-score。这是精确和回忆的调和平均值:</p><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nt"><img src="../Images/3cc4d6e02f137c9ed7969b7fe3dd01a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PXp8SVbCP8l45FcCyoM65w.png"/></div></div></figure><p id="651a" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">当准确率和召回率接近0时，F1-score也接近0。如果两个测量值都接近1，这意味着F1得分将会很高。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="fbea" class="mn mo it bd mp mq nu ms mt mu nv mw mx my nw na nb nc nx ne nf ng ny ni nj nk bi translated">示例:</h1><p id="9619" class="pw-post-body-paragraph ko kp it kq b kr nl kt ku kv nm kx ky kz nn lb lc ld no lf lg lh np lj lk ll im bi translated">让我们使用Kaggle的Titanic数据集来看一个二进制分类问题。完整的Github代码在这里是<a class="ae nz" href="https://github.com/eugeniaring/sklearn-tutorial/blob/main/titanic-kcv.ipynb" rel="noopener ugc nofollow" target="_blank"/>。我们需要预测乘客是否能生还。正如我们所知，大部分乘客没能保住自己的性命，所以班级是不平衡的。目标变量称为survivet:如果乘客幸存，则为1，否则为0。</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/13f8196ef742c95ad238ef98f32438f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*Iqw1H0MhDNaGP4m_w_CXSg.png"/></div></figure><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi od"><img src="../Images/6c31a414907d7f9f64820d5df2985672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTd6FvWkQKOrqQujCWvvfA.png"/></div></div></figure><p id="95d5" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将分析训练集，因为测试集不包括目标标签。让我们将训练数据分成80%用于训练，20%用于验证。</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/02382f324c03feee7c13239e4caf5858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p29r4-RRSgE39_hOqEN0Qw.png"/></div></div></figure><p id="f5e0" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">数据分割完成后，我们训练决策树分类器，并在验证集中对其进行评估。为了获得混淆矩阵，sklearn中已经提供了一个函数:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi of"><img src="../Images/b893a3d048a7e39990ced04df43697cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yf5ydVXfzzUkQcqqgisErQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">混淆矩阵</figcaption></figure><p id="1d5d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，我将手动获取评估指标。每一次计算之后都是sklearn库中已经实现的函数:</p><figure class="ln lo lp lq gt kd"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="ln lo lp lq gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi og"><img src="../Images/dede05cdc0c84639dec95b787fe0bd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PUTBW8Z0nMXJcdS7C6iIw.png"/></div></div></figure><p id="db05" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">从结果中，我们可以观察到:</p><ul class=""><li id="655a" class="lr ls it kq b kr ks kv kw kz lt ld lu lh lv ll lw lx ly lz bi translated">81%被预测为<strong class="kq jd">幸存和</strong>未幸存的人被决策树正确分类。</li><li id="7ebe" class="lr ls it kq b kr ma kv mb kz mc ld md lh me ll lw lx ly lz bi translated">77.8%预测为幸存的人真的幸存了！总的来说，我们认为被分类器标记的所有人<strong class="kq jd">都是阳性类别</strong>(幸存)。</li><li id="dcde" class="lr ls it kq b kr ma kv mb kz mc ld md lh me ll lw lx ly lz bi translated">幸存的人有75.6%的几率被正确预测！分母考虑数据集的所有<strong class="kq jd">正类。</strong></li><li id="4b03" class="lr ls it kq b kr ma kv mb kz mc ld md lh me ll lw lx ly lz bi translated">76.7%是准确率和召回率的调和平均值。这很重要，因为它考虑到了<strong class="kq jd"> FP </strong>(预测为存活，但他们没有存活的人数)和<strong class="kq jd"> FN </strong>(预测为没有存活，但他们设法保住了自己生命的人数)。</li></ul><h1 id="9987" class="mn mo it bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">最终想法:</h1><p id="ba58" class="pw-post-body-paragraph ko kp it kq b kr nl kt ku kv nm kx ky kz nn lb lc ld no lf lg lh np lj lk ll im bi translated">恭喜你！我希望这篇教程能让你对混淆矩阵的关键概念有所了解。准确性是评估模型最常见的方式，但这还不够。您需要其他措施来确保经过训练的模型运行良好。还有许多其他可能的评估指标可以使用，您只需要搜索它们。谢谢你阅读它。</p><p id="37b0" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有兴趣看其他文章吗？下面我给你推荐另一个故事:</p><div class="oh oi gp gr oj ok"><a rel="noopener  ugc nofollow" target="_blank" href="/k-fold-cross-validation-for-machine-learning-models-918f6ccfd6d"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd jd gy z fp op fr fs oq fu fw jc bi translated">机器学习模型的k重交叉验证</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">使用sklearn的交叉验证技术概述</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">pub.towardsai.net</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ki ok"/></div></div></a></div></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="a62b" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq jd">你喜欢我的文章吗？</strong> <a class="ae nz" href="https://eugenia-anello.medium.com/membership" rel="noopener"> <strong class="kq jd"> <em class="mf">成为会员</em> </strong> </a> <strong class="kq jd"> <em class="mf">每天无限获取数据科学新帖！这是一种间接的支持我的方式，不会给你带来任何额外的费用。如果您已经是会员，</em> </strong> <a class="ae nz" href="https://eugenia-anello.medium.com/subscribe" rel="noopener"> <strong class="kq jd"> <em class="mf">订阅</em> </strong> </a> <strong class="kq jd"> <em class="mf">每当我发布新的数据科学和python指南时，您都可以收到电子邮件！</em>T25】</strong></p></div></div>    
</body>
</html>