<html>
<head>
<title>An Overview of the SQL Query Clauses and Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL查询子句和函数概述</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/an-overview-of-the-major-sql-query-clauses-and-most-commonly-used-functions-60720e2a20d7?source=collection_archive---------0-----------------------#2022-04-06">https://pub.towardsai.net/an-overview-of-the-major-sql-query-clauses-and-most-commonly-used-functions-60720e2a20d7?source=collection_archive---------0-----------------------#2022-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/bedb7d8ffd8c5507532f38ec5c0168d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uN7EffQoB3IYoP2d"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">Ignacio Amenábar 在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="a75f" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">可以用作备忘单</h2></div><p id="acf9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SQL可能是数据科学、分析或工程领域中使用最广泛的工具。在大多数职位发布中，SQL是常见的要求之一。也有很多教程和文章。我决定收集SQL select查询、子句和常见的内置函数。有经验的SQL用户可能已经记住了所有这些命令。但是对于正在找工作的新毕业生来说，帮助他们进行面试或者最近的SQL用户仍然需要查看备忘单，这应该是有帮助的。</p><blockquote class="lu"><p id="bc54" class="lv lw jj bd lx ly lz ma mb mc md lt dk translated">在本文中，我将尝试解释最基本的内容，从最基本的开始，然后转向一些更复杂的查询。</p></blockquote><p id="acfe" class="pw-post-body-paragraph ky kz jj la b lb me kk ld le mf kn lg lh mg lj lk ll mh ln lo lp mi lr ls lt im bi translated">在这个演示中，我使用了来自Kaggle和Microsoft SQL Management Studio的Heart.csv数据集。</p><p id="71d9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请随意从这里下载数据集:</p><div class="is it gp gr iu mj"><a href="https://www.kaggle.com/datasets/johnsmith88/heart-disease-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">心脏病数据集</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">公共卫生数据集</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.kaggle.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx ja mj"/></div></div></a></div><h2 id="e9f2" class="my mz jj bd na nb nc dn nd ne nf dp ng lh nh ni nj ll nk nl nm lp nn no np nq bi translated">选择查询</h2><p id="7595" class="pw-post-body-paragraph ky kz jj la b lb nr kk ld le ns kn lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">最基本的查询是使用*从表中取出所有内容:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="b605" class="my mz jj ob b gy of og l oh oi">select * from Heart;</span></pre><p id="ca7b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它给了你整张红心表。</p><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oj"><img src="../Images/26d26410c9d362d49babb70e8a210d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cbm1vYOPpuoOslkLBvgsjg.jpeg"/></div></div></figure><p id="4bc5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是输出的一部分。它显示所有的列。它总共有303行。</p><p id="a566" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在大多数教程中，你会发现用大写字母书写子句和SQL表达式。但是SQL命令不区分大小写。所以这是你的选择。你可以使用大写、小写或适当的大小写。</p><p id="f851" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择我选择的几个列:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="d639" class="my mz jj ob b gy of og l oh oi">select Age, Sex, Chol, AHD from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/2bbcade2d2f87a266ccc33692e386aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/1*pW9OCWH04hlYFuVT9BNx2g.jpeg"/></div></figure><p id="b21b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可以在选择查询中转换列值。这里，我在Chol列前添加了一个负号(虽然这没有意义，但我这样做只是为了表明这是可能的),并将Oldpeak列四舍五入到1位小数:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="9bee" class="my mz jj ob b gy of og l oh oi">select Age, Sex, -Chol, round(Oldpeak, 1), AHD from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/1dff811f7cee515f1289f6374272d5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*ySPkxJGgsHiEg-8Wg__tzA.jpeg"/></div></figure><p id="a158" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它在Chol列中的每个值前添加了一个负号，并将Oldpeak列中的值四舍五入到小数点后1位。如果您注意到，两个转换后的列没有名称。您可以添加称为列别名的名称。</p><p id="ee29" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我使用列别名来命名这两个转换后的列:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="596c" class="my mz jj ob b gy of og l oh oi">select Age, Sex, -Chol as negativeChol, round(Oldpeak, 1) as roundedOldpeak, AHD from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a8069ec5bc93dc265a1f8bc3d686589f.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*uZ8aL9juu3h8PZl6o-4liQ.jpeg"/></div></figure><p id="30b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">两个转换后的列现在有了名称。</p><blockquote class="on oo op"><p id="3d35" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">Where子句</p></blockquote><p id="dd75" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“Where”子句使用该条件。例如，AHD列有两个唯一值:0和1。如果您只想获得AHD值为1的数据，那么“where”子句可以做到这一点。或者，如果我们需要Chol大于或小于某个值的数据，我们可以使用“where”子句来完成。这里有几个例子:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="7236" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD from Heart where AHD = 0;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/7526e36a306ca187dbbdc4fbed7246c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/1*VP_PAF-fFzUQLryaSIM4fg.jpeg"/></div></figure><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="d298" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD from Heart where Chol &gt; 250;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/d04bb6b04e8cc068297e9dec06170a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:294/format:webp/1*yBiIff0kbbRLVUkZHUoFaA.jpeg"/></div></figure><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="a639" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, RestBP, MaxHR from Heart where RestBP &gt; MaxHR;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/14c2bbadd192f8cefa8ad53106975c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*HfWE2Wq_2-Suq-tnBSCR2w.jpeg"/></div></figure><p id="5cb7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我想介绍这个有趣的符号&lt;&gt;，它检查不匹配。如果在一个条件中使用&lt;&gt;，意味着它将返回不匹配的值。这里有一个例子:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="d040" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD from Heart where AHD &lt;&gt; 0;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/2dc835af78f5db0685b5c911dd67ed71.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*eHLtVbzV-pHTD4B3Z9bghw.jpeg"/></div></figure><p id="802f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它返回AHD不等于0的行。</p><blockquote class="on oo op"><p id="92a6" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">带有where子句的数学运算</p></blockquote><p id="b4a3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个例子将展示一个简单的带有“where”子句的数学运算。我们将返回RestBP和MaxHR之和大于300的行。但是我还必须使用cast(RestBP as int)和cast(MaxHR as int ),因为它们的数据类型是tinyint。所以我不得不把它们转换成int。否则，它将通过我的SQL引擎中的一个错误。在这种情况下，不同的SQL引擎可能表现不同。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="5947" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, RestBP, MaxHR, cast(RestBP as int) + cast(MaxHR as int) as Sum_BPHR from Heart where cast(RestBP as int) + cast(MaxHR as int)&gt; 300;</span></pre><p id="9b46" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者这个表达式也可以:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="060f" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, RestBP, MaxHR, 1.0*RestBP + 1.0*MaxHR as Sum_BPHR from Heart where 1.0*RestBP + 1.0*MaxHR&gt; 300;</span></pre><p id="d4d5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/0279ae85e37e3ad2eded3d97534804da.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*BlM4j7FAaSkzc9xodoFH6g.jpeg"/></div></figure><blockquote class="on oo op"><p id="dc37" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">在where子句中使用“between”</p></blockquote><p id="03f5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果Chol的值介于200和300之间，并且AHD不为0，则此表达式将返回select语句中的指定列:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="522f" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD from Heart where Chol between 200 and 300 and AHD &lt;&gt;0;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/69bbedc513f9c8aee797043e83c29149.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*HkA7-Vtd_VPgIH0QUhmXlw.jpeg"/></div></figure><p id="164e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，我们可以使用“not between”返回不在指定范围内的行:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="79e3" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD from Heart where Chol not between 200 and 300 and AHD &lt;&gt;0;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c2874548cb5f8dc88eefd745a725722a.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/1*ES06q6wiHo8UlH7UoPh2tg.jpeg"/></div></figure><blockquote class="on oo op"><p id="14f6" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">过滤空值</p></blockquote><p id="451a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Where子句对于筛选空值很有用。让我们从RestBP列中过滤出空值:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="3c51" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD from Heart where RestBP is not NULL;</span></pre><p id="af0d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我没有在这里显示输出，因为这个数据集没有任何空值。</p><blockquote class="on oo op"><p id="c675" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">带有where子句的IN运算符</p></blockquote><p id="08a6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“In”运算符可以从值列表中进行检查。例如，假设我们需要具有特定年龄的行:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="32e6" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart where Age in (45, 23, 50, 52, 65, 60);</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/4efa4c051a8f78dfdaba739de6d0264e.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*-Wf6titKbt414K6V1Cjiag.jpeg"/></div></figure><blockquote class="on oo op"><p id="379a" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">带有where子句的Or运算符</p></blockquote><p id="0411" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本例中，我们将返回胸痛为“典型”或“非典型”的行。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="a25a" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart where ChestPain = 'typical' or ChestPain = 'nontypical';</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/a99185423a343ab464ec91c7c1709654.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*i9m6XQ5ueE1yLGW7CRwPpw.jpeg"/></div></figure><p id="3acd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用“in”操作符也可以达到同样的效果:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="e4ce" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart where ChestPain in ('typical', 'nontypical');</span></pre><blockquote class="on oo op"><p id="8d38" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">或者，和运算符在一起</p></blockquote><p id="d723" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">返回年龄小于50且胸痛为“典型”或“非典型”的行:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="d358" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart</span><span id="aea0" class="my mz jj ob b gy pc og l oh oi">where Age &lt; 50 and</span><span id="4d6b" class="my mz jj ob b gy pc og l oh oi">(ChestPain = 'typical' or ChestPain = 'nontypical');</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/fdf8cf358691b9a7719f271d93f54704.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*ycLdZO3BwuBKT2ngIAvSWg.jpeg"/></div></figure><blockquote class="on oo op"><p id="4adb" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">不，和运营商在一起</p></blockquote><p id="0499" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在此示例中，我们将返回胸痛不等于“典型”且AHD等于1的行:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="23e6" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain</span><span id="0f77" class="my mz jj ob b gy pc og l oh oi">from Heart where not ChestPain = 'typical'</span><span id="a314" class="my mz jj ob b gy pc og l oh oi">and AHD = 1;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/510de1eb24ff032cf171b16c09664f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*0l4DR0hb8rXKMye6vOUTtw.jpeg"/></div></figure><blockquote class="on oo op"><p id="9d35" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">通配符</p></blockquote><p id="4c85" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这对字符串数据很有用。下面的表达式检索ChestPain值中有“typ”的所有行。“typical”之前或之后是否有其他部分并不重要。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="3f6f" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain</span><span id="debd" class="my mz jj ob b gy pc og l oh oi">from Heart where ChestPain like '%typ%';</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/763510a122c5101ef504fb231bf87715.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*RjzBnNRxpzGOe3X86D0VUQ.jpeg"/></div></figure><p id="6489" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们使用“ChestPain like“% typical”，它将返回chest pain值为“typical”或+ typical的行。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="770c" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain</span><span id="1308" class="my mz jj ob b gy pc og l oh oi">from Heart where ChestPain like '%typical';</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/3a3e4e833d9725d94fe1f9db3bdb1f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*Bt8gKb3TBV72Bea4LUDk1w.jpeg"/></div></figure><p id="3d93" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，我们得到了“典型”或“非典型”的胸痛值</p><p id="1ebb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当ChestPain值为non + something时，下面的表达式将返回，因为“non”的末尾有“%”:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="95b3" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain</span><span id="d72d" class="my mz jj ob b gy pc og l oh oi">from Heart where ChestPain like 'non%';</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/011d726fdf54dce9cdbe2e2b61f9ec6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*HNoF5dRpJXVHZdtrcgRC-A.jpeg"/></div></figure><p id="9d1e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们得到了ChestPain值开头为“non”的所有行。</p><blockquote class="on oo op"><p id="30e2" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">Order By子句</p></blockquote><p id="d072" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是一个简单的order by子句用例示例。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="83d3" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart</span><span id="5982" class="my mz jj ob b gy pc og l oh oi">order by Chol;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/a211701c7a52efa3efaed754562f6ac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*BVNK4O5_Xy4uH8Fd2ziWPw.jpeg"/></div></figure><p id="19b0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当order by Chol被指定时，我们得到了Chol以降序排列的输出。</p><p id="7cac" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">order by子句中也可以使用多个变量:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="561b" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart</span><span id="607e" class="my mz jj ob b gy pc og l oh oi">order by Age, Chol;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/1d0fd5d6fb057a3a272d4d0dadc9a1f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*zK3FPRyZzIOfbFfkMkqoqQ.jpeg"/></div></figure><p id="d74f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">默认情况下，order by子句按升序排列。但是您可以指定您想要升序还是降序。即使对两个变量使用order，一个变量可以是升序，另一个变量可以是降序:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="2703" class="my mz jj ob b gy of og l oh oi">select Age, Chol, AHD, ChestPain from Heart</span><span id="2e9e" class="my mz jj ob b gy pc og l oh oi">order by Age DESC,</span><span id="4e66" class="my mz jj ob b gy pc og l oh oi">Chol ASC;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/1a0222668299a0b1c5f17484492af6d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*Wxvma4vmjQKkw58460C9Ig.jpeg"/></div></figure><blockquote class="on oo op"><p id="dd8e" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">数学运算</p></blockquote><p id="80fb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我使用年龄列计算可能的最大小时数:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="e6b0" class="my mz jj ob b gy of og l oh oi">select Age, Chol, MaxHR, ChestPain,</span><span id="b095" class="my mz jj ob b gy pc og l oh oi">210 - (0.5*Age) as calculated_MaxHR</span><span id="4c13" class="my mz jj ob b gy pc og l oh oi">from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/3e9ceb888b679b605fe53bf9ffd58152.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*QU1dsHxJO75vz4awKMevXQ.jpeg"/></div></figure><p id="f795" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还可以找出MaxHR和calculated_MaxHR之间的差异，并创建不同的列:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="8680" class="my mz jj ob b gy of og l oh oi">select Age, Chol, MaxHR, ChestPain,</span><span id="8e80" class="my mz jj ob b gy pc og l oh oi">210 - (0.5*Age) as calculated_MaxHR,</span><span id="fc93" class="my mz jj ob b gy pc og l oh oi">MaxHR - 210 - (0.5*Age) as Diff_in_MaxHR</span><span id="6783" class="my mz jj ob b gy pc og l oh oi">from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/3df7cfc985c688e100be71bc01ed0ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*wNWeFL8g1Cxtihlt2U3GLQ.jpeg"/></div></figure><blockquote class="on oo op"><p id="b07a" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">聚合函数</p></blockquote><p id="2543" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">聚合函数非常受欢迎。这些是SQL中的聚合函数:</p><ul class=""><li id="679a" class="pk pl jj la b lb lc le lf lh pm ll pn lp po lt pp pq pr ps bi translated">平均</li><li id="0acc" class="pk pl jj la b lb pt le pu lh pv ll pw lp px lt pp pq pr ps bi translated">总和</li><li id="8846" class="pk pl jj la b lb pt le pu lh pv ll pw lp px lt pp pq pr ps bi translated">最大</li><li id="a59e" class="pk pl jj la b lb pt le pu lh pv ll pw lp px lt pp pq pr ps bi translated">部</li><li id="cafe" class="pk pl jj la b lb pt le pu lh pv ll pw lp px lt pp pq pr ps bi translated">数数</li><li id="32e7" class="pk pl jj la b lb pt le pu lh pv ll pw lp px lt pp pq pr ps bi translated">定义变量</li><li id="2d6f" class="pk pl jj la b lb pt le pu lh pv ll pw lp px lt pp pq pr ps bi translated">标准差（standarddeviation）</li></ul><p id="5172" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是使用“avg”来计算数据集中人口的平均年龄:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="111c" class="my mz jj ob b gy of og l oh oi">select avg(Age) as avg_age from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi py"><img src="../Images/0911d4e68ec997af471ca5932c72bf47.png" data-original-src="https://miro.medium.com/v2/resize:fit:186/format:webp/1*0XAR5ZsbTdy5ylu33c2MuQ.jpeg"/></div></figure><p id="18c1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我将使用count函数找出数据集中的样本数:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="2b3b" class="my mz jj ob b gy of og l oh oi">select count(Chol) as total_sample from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/c07500660c9702cadccbcbad178dd7b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/format:webp/1*-fMgHYxdtR8-eUDFjay2eg.jpeg"/></div></figure><p id="1cee" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用count函数中的任何其他列来获得这里的样本数。请记住，我们可以使用count(Chol)获得样本数，因为Chol列没有任何空值。如果在Chol列中有空值，我们将无法在这里获得总样本数。因为count函数只给出非空值的数量。</p><p id="7b3f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">寻找最大年龄和最小年龄:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="6bb7" class="my mz jj ob b gy of og l oh oi">select max(Age) as max_age,</span><span id="673e" class="my mz jj ob b gy pc og l oh oi">min(Age) as min_age</span><span id="c551" class="my mz jj ob b gy pc og l oh oi">from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/07ff2e24ca572ac2b10ca811791bb8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*RmdyG8Nf_ZxtrkeuoByYcA.jpeg"/></div></figure><p id="202b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">计算年龄数据的分布:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="bbbf" class="my mz jj ob b gy of og l oh oi">select max(Age) - min(Age)</span><span id="a8ab" class="my mz jj ob b gy pc og l oh oi">as Age_spread</span><span id="b2a4" class="my mz jj ob b gy pc og l oh oi">from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/c5de5ddb1249fbb8b69a97708afd77b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:212/format:webp/1*DcEbdwDFj67p-OB-AbrSQw.jpeg"/></div></figure><blockquote class="on oo op"><p id="6bf7" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">独特的功能</p></blockquote><p id="35c8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用distinct函数来查找表中所有不同的行。该表达式将返回所有不同的行，并排除任何重复的行(如果有的话):</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="2e89" class="my mz jj ob b gy of og l oh oi">select distinct * from Heart;</span></pre><p id="18ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“年龄”列中有多少个不同的年龄值:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="d73f" class="my mz jj ob b gy of og l oh oi">select count(distinct(Age)) as distinct_age from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/ad568abc89b65d5e0df028ab3dc1b27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:212/format:webp/1*Hm7LzIEYRpKsPQc8bt11lQ.jpeg"/></div></figure><p id="2959" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以得到一个明显的年龄，胸痛的组合如下:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="a45f" class="my mz jj ob b gy of og l oh oi">select distinct Age, ChestPain from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/88788ccc23a4b3f3fb8e474fa511b21a.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*sHEAFuxnkNqW462ekET98Q.jpeg"/></div></figure><p id="36d7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我只想得到两列的不同组合。您可以添加更多列并进行检查。</p><blockquote class="on oo op"><p id="5022" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">具有聚合函数的Group by子句</p></blockquote><p id="c3ef" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们得到了每种类型胸痛的样本数:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="f8a7" class="my mz jj ob b gy of og l oh oi">select ChestPain, count(*) as numberOfSample</span><span id="dd73" class="my mz jj ob b gy pc og l oh oi">from Heart group by ChestPain;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/b6581b744eedcb62c2d5e1db61697f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*ESe8EnoQvSDzweS8HbGafg.jpeg"/></div></figure><p id="0c8f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里再举一个例子。计算每种胸痛的平均年龄:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="87b9" class="my mz jj ob b gy of og l oh oi">select ChestPain, avg(Age) as Avg_Age</span><span id="2a33" class="my mz jj ob b gy pc og l oh oi">from Heart group by ChestPain;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/0e884ee710612a6684268b98844a2bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*YL2GMB-gVbPWBCnGm0CHqg.jpeg"/></div></figure><p id="f2b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">平均年龄非常接近。</p><p id="d0a5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以使用多个变量进行分组。在下一个例子中，我按胸痛和AHD分组，得到每个分组的平均年龄:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="3c4f" class="my mz jj ob b gy of og l oh oi">select ChestPain, AHD, avg(Age) as Avg_Age</span><span id="6752" class="my mz jj ob b gy pc og l oh oi">from Heart group by ChestPain, AHD;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/9936f65cceee6b5b16cf2e33c7674ab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*zSOBChT0nUovVvLS0k0pMQ.jpeg"/></div></figure><p id="059d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看输出。它首先显示每种类型胸痛的平均年龄和0的AHD值，然后我们得到每种类型胸痛的平均年龄和1的AHD值。</p><blockquote class="on oo op"><p id="6c6c" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">Having子句</p></blockquote><p id="e3b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Having子句用于从组中筛选数据。让我们看一个例子:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="c4a5" class="my mz jj ob b gy of og l oh oi">select ChestPain,</span><span id="46f6" class="my mz jj ob b gy pc og l oh oi">count(*) from Heart</span><span id="cb37" class="my mz jj ob b gy pc og l oh oi">group by ChestPain</span><span id="8e1e" class="my mz jj ob b gy pc og l oh oi">having count(*) &gt; 50;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/055b167c3957ddcfac1ceb5668a13c6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*qGyyDfIUOoqca6R4nKkekg.jpeg"/></div></figure><p id="7027" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们得到每种类型胸痛的样本数，然后使用样本数必须大于50的条件。</p><p id="6396" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Having子句不一定要在组上。它也可以在其他一些列上。如果胸痛类型的MaxHR + RestBP之和大于10000，则我们在此选择胸痛类型</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="990e" class="my mz jj ob b gy of og l oh oi">select ChestPain from Heart</span><span id="20f1" class="my mz jj ob b gy pc og l oh oi">group by ChestPain Having sum(1.0*MaxHR + 1.0*RestBP) &gt; 10000;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/2684c2c54bc6062a171b9a4fadcad1ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*9YG6BzIe_sJ5NqjlHyIK8A.jpeg"/></div></figure><p id="73e3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下示例显示了如何对几列使用聚合函数，然后使用having子句来使用条件。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="b7bb" class="my mz jj ob b gy of og l oh oi">select ChestPain, SUM(1.0*MaxHR + 1.0*RestBP) as sum_HRBP,</span><span id="6e15" class="my mz jj ob b gy pc og l oh oi">Min(Age) as min_Age,</span><span id="bca0" class="my mz jj ob b gy pc og l oh oi">count(*) as total_sample from Heart group by ChestPain</span><span id="85db" class="my mz jj ob b gy pc og l oh oi">having SUM(1.0*MaxHR + 1.0*RestBP) &gt; 10000;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/a35c43569eddd28a14933276b26ceccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*zOUkXhUvMXSX7RwnKLggqQ.jpeg"/></div></figure><blockquote class="on oo op"><p id="54b7" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">Where和having子句在一起</p></blockquote><p id="9595" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Having子句几乎相当于组中的where子句。我们可以同时使用where和having子句。在这种情况下，首先where子句从总数据集中筛选出数据，然后group by子句根据指定对数据进行分组，最后having子句根据having子句中提供的条件从组中筛选出数据。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="923d" class="my mz jj ob b gy of og l oh oi">select ChestPain, count(*) as Num_people</span><span id="bc53" class="my mz jj ob b gy pc og l oh oi">from Heart where Age &gt;= 40</span><span id="9eb2" class="my mz jj ob b gy pc og l oh oi">group by ChestPain</span><span id="9310" class="my mz jj ob b gy pc og l oh oi">having count(*) &gt; 50;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/f0dadbe0410115ffd5c536fe4a4c26a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*vfbmN82hpuYTnNWX-HMgDg.jpeg"/></div></figure><p id="8ad5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Having子句可以使用多个条件:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="9720" class="my mz jj ob b gy of og l oh oi">select ChestPain, avg(RestBP) as avg_BP</span><span id="48bb" class="my mz jj ob b gy pc og l oh oi">from Heart where Age &gt;= 40</span><span id="0d3a" class="my mz jj ob b gy pc og l oh oi">group by ChestPain</span><span id="44d0" class="my mz jj ob b gy pc og l oh oi">having avg(RestBP) &gt; 120 and count(*) &gt; 30;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/dd7c0f45c10ad3a809d63ca38b697f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*cBBomJHY5416yrjuanwLAQ.jpeg"/></div></figure><blockquote class="on oo op"><p id="8383" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">Order by和group by一起</p></blockquote><p id="2c36" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们之前看到的，胸痛是一个分类变量。在这里，我们计算每种类型胸痛的平均胆固醇，并按照平均胆固醇升序排列:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="ae41" class="my mz jj ob b gy of og l oh oi">select ChestPain, avg(Chol) as avg_Chol from Heart</span><span id="08c7" class="my mz jj ob b gy pc og l oh oi">where Chol is not null</span><span id="a49f" class="my mz jj ob b gy pc og l oh oi">group by ChestPain</span><span id="0e8a" class="my mz jj ob b gy pc og l oh oi">order by avg_Chol;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qi"><img src="../Images/3098ba6cf949aa27ae22a65e1f620217.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*gs1JagIHLNCCBB-RXXHuOA.jpeg"/></div></div></figure><blockquote class="on oo op"><p id="cf80" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">串联函数</p></blockquote><p id="5f38" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用concat函数连接两个列值:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="0a3d" class="my mz jj ob b gy of og l oh oi">select ChestPain, Thal,</span><span id="a2e6" class="my mz jj ob b gy pc og l oh oi">CONCAT(ChestPain, ' ', Thal) as ChestPainThal</span><span id="55b4" class="my mz jj ob b gy pc og l oh oi">from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/f8dcf3702a3dc3323dd4c8b0b166d1bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*uva2kjfwIova90ovBdC2fQ.jpeg"/></div></figure><p id="da2d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看看上图中的ChestPainThal柱。</p><blockquote class="on oo op"><p id="0ace" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">整理</p></blockquote><p id="0c7e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">trim函数修剪字符串开头或结尾的任何空格。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="2dfe" class="my mz jj ob b gy of og l oh oi">SELECT TRIM('  Test string    ') as trimmed;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/09235e2151a3f02d74b8d3f05ff6f4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*-3_ZzkUSqnp2-Z49c8xTTw.jpeg"/></div></figure><p id="f7b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的例子中，我们简单地使用了trim函数，默认情况下，它从开头和结尾修剪了多余的空格。但是，如果您想从开头或结尾修剪某些特定的字符，您可以在trim函数中指定这些字符。</p><p id="5dba" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我指定我要修剪“%”和“.”从字符串。它将删除“%”或“.”如果出现在开头或结尾。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="06e6" class="my mz jj ob b gy of og l oh oi">SELECT TRIM('.%' from  '%%Test... string...') as trimmed;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi ql"><img src="../Images/e40196d9657d28d289fdea54fc4bdd3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:216/format:webp/1*Tz_xBDJet2H1MJuZo_nXtQ.jpeg"/></div></figure><blockquote class="on oo op"><p id="39fa" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">子串函数</p></blockquote><p id="25ec" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果列值是字符串，substring函数可用于返回部分字符串。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="f6d3" class="my mz jj ob b gy of og l oh oi">select ChestPain, substring(ChestPain, 2, 4) as short_cp</span><span id="7f5f" class="my mz jj ob b gy pc og l oh oi">from Heart where Age &gt; 40;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/9f06b0b7f33904d18b85b98f7969ece7.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*F3lebUFhxZfdef9Py0mhoA.jpeg"/></div></figure><p id="5c22" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的substring函数中，我们传递了ChestPain、2和4。这意味着我们要求函数从ChestPain列获取子串，2表示子串应该从字符串的第二个元素开始，4表示我们希望子串的长度为4。</p><p id="21f4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将Thal列转换为大写:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="2e3d" class="my mz jj ob b gy of og l oh oi">select upper(Thal) from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qm"><img src="../Images/60df9a5c5a7886ed8069fb2116af6b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*8N5CW5ssuSIVJb3ohezvig.jpeg"/></div></figure><blockquote class="on oo op"><p id="1ed2" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">Case-When语法</p></blockquote><p id="952a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用case-when几乎类似于if-else语句。</p><p id="f840" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个例子，我们从Chol列中生成一个分类列。我们设置了不同的范围，将胆固醇定义为最佳、临界高、高和非常高。这个新的分类列被命名为Chol_Category，它在“结尾”中提到。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="6205" class="my mz jj ob b gy of og l oh oi">select Age, Sex, ChestPain, Chol,</span><span id="e2b7" class="my mz jj ob b gy pc og l oh oi">case</span><span id="bdca" class="my mz jj ob b gy pc og l oh oi">when Chol &gt;= 100 and Chol &lt;= 129 then 'Optimal'</span><span id="df3f" class="my mz jj ob b gy pc og l oh oi">when Chol &gt;=130 and Chol &lt;= 159 then 'Borderline High'</span><span id="8f9d" class="my mz jj ob b gy pc og l oh oi">when Chol &gt;= 160 and Chol &lt;= 189 then 'High'</span><span id="c1e1" class="my mz jj ob b gy pc og l oh oi">when Chol &gt; 189 then 'Very High'</span><span id="b944" class="my mz jj ob b gy pc og l oh oi">End Chol_Category</span><span id="5186" class="my mz jj ob b gy pc og l oh oi">from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qn"><img src="../Images/9f5260615a9acfc9a02ca16f197d9949.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*yBEVPYeZzZvOLKtoQm6LGA.jpeg"/></div></figure><blockquote class="on oo op"><p id="934e" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">限制条款</p></blockquote><p id="3309" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们并不总是需要查询的全部结果。有时候某一份就够了。在这种情况下，我们可以使用limit子句将输出限制在特定的行数。这种语法适用于大多数SQL引擎。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="4857" class="my mz jj ob b gy of og l oh oi">select Age, Chol, ChestPain from Heart</span><span id="da21" class="my mz jj ob b gy pc og l oh oi">limit 10;</span></pre><p id="6886" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是我在本教程中使用了Microsoft SQL management studio。此语法在Microsoft SQL management studio中不起作用。我不得不用这个来代替:</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="cf63" class="my mz jj ob b gy of og l oh oi">select top 10 Age, Chol, ChestPain from Heart;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/3a909337dd0d5db7f646be3a4dce2ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*En-Y_vl60vsbAn43OaUFYw.jpeg"/></div></figure><p id="4865" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它给出了前10行或您在这里提到的数字。</p><blockquote class="on oo op"><p id="5c3e" class="ky kz oq la b lb lc kk ld le lf kn lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">页码</p></blockquote><p id="7903" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您有一个大数据集，查询也可以返回一个长表。您可以在单独页面中组织长表，每个页面只包含指定数量的行。</p><pre class="nw nx ny nz gt oa ob oc od aw oe bi"><span id="f927" class="my mz jj ob b gy of og l oh oi">select Age, Chol, ChestPain from Heart</span><span id="7462" class="my mz jj ob b gy pc og l oh oi">order by Chol offset 15 rows</span><span id="f7c0" class="my mz jj ob b gy pc og l oh oi">fetch next 15 rows only;</span></pre><figure class="nw nx ny nz gt iv gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/b3c50fd01cf81d8320eb378a768e41df.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*oIsP3x8ffjaTe--lueTaHA.jpeg"/></div></figure><p id="0ba0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是我今天想学习的所有函数和子句。</p><p id="00ca" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我没有在这里讨论连接，因为这篇文章太长了。那是另一篇文章。</p><h2 id="e606" class="my mz jj bd na nb nc dn nd ne nf dp ng lh nh ni nj ll nk nl nm lp nn no np nq bi translated">结论</h2><p id="af62" class="pw-post-body-paragraph ky kz jj la b lb nr kk ld le ns kn lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">在本文中，我想使用Microsoft SQL Management Studio演示SQL的所有主要子句和常用函数的示例。如果你能记住所有这些子句和函数，那么编写SQL查询对你来说就很容易了。我会在未来制作更多关于SQL的更高级主题的教程。</p><p id="85bb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请随时关注我的<a class="ae jg" href="https://twitter.com/rashida048" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae jg" href="https://www.facebook.com/Regenerative-149425692134498" rel="noopener ugc nofollow" target="_blank">脸书页面</a>，并查看我的<a class="ae jg" href="https://www.youtube.com/channel/UCzJgOvsJJPCXWytXWuVSeXw" rel="noopener ugc nofollow" target="_blank"> YouTube频道</a>。</p><h2 id="224c" class="my mz jj bd na nb nc dn nd ne nf dp ng lh nh ni nj ll nk nl nm lp nn no np nq bi translated">更多阅读</h2><div class="is it gp gr iu mj"><a href="https://towardsdatascience.com/20-very-commonly-used-functions-of-pyspark-rdd-90b8271c25b2" rel="noopener follow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">PySpark RDD的20个非常常用的功能</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">每个功能都用清晰的例子演示</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ms l"><div class="qq l mu mv mw ms mx ja mj"/></div></div></a></div><div class="is it gp gr iu mj"><a href="https://towardsdatascience.com/details-of-violinplot-and-relplot-in-seaborn-30c63de23a15" rel="noopener follow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">Seaborn的Violinplot和Relplot的细节</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">充分发挥潜力在Seaborn使用小提琴和Relplots</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ms l"><div class="qr l mu mv mw ms mx ja mj"/></div></div></a></div><div class="is it gp gr iu mj"><a href="https://towardsdatascience.com/simple-explanation-on-how-decision-tree-algorithm-makes-decisions-34f56be344e9" rel="noopener follow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">浅谈决策树算法如何决策</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">决策树算法背后的直觉</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ms l"><div class="qs l mu mv mw ms mx ja mj"/></div></div></a></div><div class="is it gp gr iu mj"><a rel="noopener  ugc nofollow" target="_blank" href="/data-analysis-91a38207c92b"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">数据分析</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">Python中数据科学家/分析师日常工作中的常见数据清理任务</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">pub.towardsai.net</p></div></div><div class="ms l"><div class="qt l mu mv mw ms mx ja mj"/></div></div></a></div><div class="is it gp gr iu mj"><a href="https://towardsdatascience.com/30-very-useful-pandas-functions-for-everyday-data-analysis-tasks-f1eae16409af" rel="noopener follow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">30个非常有用的熊猫函数，用于日常数据分析任务</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">熊猫小型张</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ms l"><div class="qu l mu mv mw ms mx ja mj"/></div></div></a></div><div class="is it gp gr iu mj"><a href="https://towardsdatascience.com/exploratory-data-analysis-with-some-cool-visualizations-in-pythons-matplotlib-and-seaborn-library-99dde20d98bf" rel="noopener follow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd jk gy z fp mo fr fs mp fu fw ji bi translated">利用Python的Matplotlib和Seaborn中的高级可视化进行探索性数据分析…</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">探索国际足联数据集</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ms l"><div class="qv l mu mv mw ms mx ja mj"/></div></div></a></div></div></div>    
</body>
</html>