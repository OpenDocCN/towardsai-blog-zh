<html>
<head>
<title>Build Your Own Generative Adversarial Network (GAN) Using Pytorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pytorch构建您自己的生成性对抗网络(GAN)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/build-your-own-generative-adversarial-network-gan-using-pytorch-c367b8506987?source=collection_archive---------0-----------------------#2021-07-10">https://pub.towardsai.net/build-your-own-generative-adversarial-network-gan-using-pytorch-c367b8506987?source=collection_archive---------0-----------------------#2021-07-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f46f" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="a5d2" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用PyTorch使用DCGANS生成面的简单分步指南。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/7d1938f00f85e73b8ef63327d21de284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*_LLc-bNzKzFJXVqs.jpg"/></div></figure><blockquote class="kw kx ky"><p id="e1f3" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">生成对抗网络是近十年来机器学习中最有趣的概念</p><p id="f0cd" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">——Yann le Cun(脸书艾导演)</p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="5c1f" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">GANs是由蒙特利尔大学的博士生Ian Goodfellow在2014年首次提出的。GANs最常见的例子是生成图像。有一个<a class="ae mg" href="https://thispersondoesnotexist.com/" rel="noopener ugc nofollow" target="_blank">网站</a>包含不存在的人的面孔。这是甘斯所能做的一个例子。这就是我们在本课中要构建的内容。</p><p id="f913" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">生成对抗网络由两个相互竞争的神经网络<strong class="lc ja">生成器</strong>和<strong class="lc ja">鉴别器</strong>组成。我将在本课的后面部分详细解释每个步骤。如果你对这个话题完全不熟悉。我建议你先学习以下课程。</p><ul class=""><li id="cd46" class="mh mi iq lc b ld le lg lh md mj me mk mf ml lv mm mn mo mp bi translated">Luis Serrano对GANs的介绍</li><li id="0e7f" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">伊恩·古德菲勒的研究论文</li></ul><p id="1000" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">本课结束时，你将能够从头开始训练和构建自己的生成性对抗网络。所以事不宜迟，让我们开始吧。</p><p id="e5eb" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我也在Google Colab <a class="ae mg" href="https://github.com/Ahmad-shaikh575/Face-Generation-using-GANS/blob/master/dlnd_face_generation_colab.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>建立了这个生成网络。你可以很容易地打开Google Colabatory，然后很容易地跟进。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="42f6" class="mv mw iq bd mx my mz na nb nc nd ne nf kf ng kg nh ki ni kj nj kl nk km nl nm bi translated">前方的路</h1><ul class=""><li id="ac36" class="mh mi iq lc b ld nn lg no md np me nq mf nr lv mm mn mo mp bi translated">步骤0:导入数据集</li><li id="c32f" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">步骤1:图像的加载和预处理</li><li id="87f7" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">步骤2:定义鉴别器算法</li><li id="f028" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">步骤3:定义生成器算法</li><li id="6960" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">步骤4:编写训练算法</li><li id="80d6" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">第五步:训练模型</li><li id="9161" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">步骤6:测试模型</li></ul><p id="c336" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">你兴奋吗？？？让我们开始吧！</p><h1 id="6df5" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">步骤0:导入数据集</h1><p id="b7fe" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">第一步是下载数据并将其加载到内存中。所以我们在这里做。我们将使用<a class="ae mg" href="http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html" rel="noopener ugc nofollow" target="_blank">名人面孔属性数据集(CelebA) </a>来训练你的敌对网络。</p><ul class=""><li id="4922" class="mh mi iq lc b ld le lg lh md mj me mk mf ml lv mm mn mo mp bi translated">点击从<a class="ae mg" href="https://s3.amazonaws.com/video.udacity-data.com/topher/2018/November/5be7eb6f_processed-celeba-small/processed-celeba-small.zip" rel="noopener ugc nofollow" target="_blank">下载数据集。</a></li><li id="b09c" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">解压缩数据集。</li><li id="a23d" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv mm mn mo mp bi translated">克隆这个Github <a class="ae mg" href="https://github.com/Ahmad-shaikh575/Face-Generation-using-GANS.git" rel="noopener ugc nofollow" target="_blank">库</a>。</li></ul><p id="7426" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">完成后，您可以在colab环境中打开它，也可以使用自己的pc来训练模型。</p><h1 id="a824" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">导入必要的库</h1><p id="4396" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">在笔记本的第一个块中导入所有要使用的库总是被认为是一个好的做法。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h1 id="8948" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">步骤1:图像的加载和预处理</h1><p id="b2dd" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">在这一步中，我们将对在上一节中下载的图像数据进行预处理。</p><p id="649b" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">将采取以下步骤</p><ol class=""><li id="fbd4" class="mh mi iq lc b ld le lg lh md mj me mk mf ml lv oc mn mo mp bi translated">调整图像大小</li><li id="d8f0" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv oc mn mo mp bi translated">转换成张量</li><li id="762b" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv oc mn mo mp bi translated">将其加载到PyTorch数据集中</li><li id="438c" class="mh mi iq lc b ld mq lg mr md ms me mt mf mu lv oc mn mo mp bi translated">将其加载到PyTorch数据加载器中</li></ol><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="fdf0" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">图像的大小应该足够小，这将有助于更快地训练模型。张量基本上是NumPy数组，我们只是将图像转换成PyTorch中需要的NumPy数组。</p><p id="1a92" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后，我们将这个转换加载到PyTorch数据集。之后，我们将训练我们的数据成小批量。这个数据加载器将在每次迭代中为我们的模型提供图像数据。</p><p id="e70a" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后，我们将使用NumPy和pyplot检查加载的图像数据。该显示<a class="ae mg" href="https://www.javatpoint.com/pytorch-testing-of-image-recognition-model" rel="noopener ugc nofollow" target="_blank">助手功能</a>在笔记本中提供。调用这个函数后，你会得到这样的输出。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="oe of di og bf oh"><div class="gh gi od"><img src="../Images/8491e4d69c6c96f179b7e99349b932e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UHdlJmHLmK564Yhvnxf2A.png"/></div></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk translated">从数据集中加载</figcaption></figure><p id="3e31" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">当数据被加载时。现在，我们可以对图像进行预处理。</p><h1 id="2608" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">图像预处理</h1><p id="8192" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">我们将在训练中使用<a class="ae mg" href="https://stackoverflow.com/questions/41489907/generative-adversarial-networks-tanh" rel="noopener ugc nofollow" target="_blank"> tanh </a>激活发电机。这台发电机的输出功率在1比1的范围内。我们也需要在这个范围内重新调整我们的图像。所以你会照做。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="a1ec" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这个函数将缩放任何输入图像。我们将在稍后的培训中使用该功能。</p><p id="2bb4" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在我们完成了无聊的预处理步骤。</p><p id="4d04" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">激动人心的部分来了。现在我们需要为我们的生成器和鉴别器神经网络编写代码。</p><h1 id="3958" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">步骤2:定义鉴别器算法</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi om"><img src="../Images/bf7e177f4926b445a92b879e3d7382b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/0*ndLQ1l1fL3BuGdpW.png"/></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk translated">鉴别器模型视觉效果。<a class="ae mg" href="https://www.google.com/search?q=generator+model+in+gans&amp;tbm=isch&amp;ved=2ahUKEwiNwfSS-dLxAhUHXxoKHSLfBsUQ2-cCegQIABAA&amp;oq=generator+model+in+gans&amp;gs_lcp=CgNpbWcQAzoECAAQGFD5K1jnMmDfOWgAcAB4AIABgwKIAbYMkgEDMi03mAEAoAEBqgELZ3dzLXdpei1pbWfAAQE&amp;sclient=img&amp;ei=najmYM3-HYe-aaK-m6gM&amp;bih=819&amp;biw=1920#imgrc=6zeXQnrqCq4NMM" rel="noopener ugc nofollow" target="_blank">礼遇</a></figcaption></figure><p id="bef0" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">鉴别器是一种神经网络，可以区分真假图像。真实图像和生成器生成的图像都将被提供给它。</p><p id="ece9" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们将首先定义一个助手函数，它在创建卷积网络层时非常方便。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="8838" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这个助手函数接收创建任何卷积层所需的参数，并返回一个顺序容器。现在我们将使用这个辅助函数来创建我们自己的鉴别器网络。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h1 id="3add" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">步骤3:定义生成器算法</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/a7e94ccd1f7bd4512c41eca03ea67099.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*nFN47MqkPhzKUR4f.jpg"/></div><figcaption class="oi oj gj gh gi ok ol bd b be z dk translated">发电机模型视觉效果<a class="ae mg" href="https://www.google.com/search?q=generator+model+in+gans&amp;tbm=isch&amp;ved=2ahUKEwiNwfSS-dLxAhUHXxoKHSLfBsUQ2-cCegQIABAA&amp;oq=generator+model+in+gans&amp;gs_lcp=CgNpbWcQAzoECAAQGFD5K1jnMmDfOWgAcAB4AIABgwKIAbYMkgEDMi03mAEAoAEBqgELZ3dzLXdpei1pbWfAAQE&amp;sclient=img&amp;ei=najmYM3-HYe-aaK-m6gM&amp;bih=819&amp;biw=1920#imgrc=6zeXQnrqCq4NMM" rel="noopener ugc nofollow" target="_blank">。礼遇</a></figcaption></figure><p id="6ebe" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">从图中可以看出，我们将一个高斯或噪声矢量输入网络，它以s为单位输出，图中的“z”表示噪声，右边的G(z)表示生成的样本。</p><p id="fe9e" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">与鉴别器一样，我们将首先创建一个助手函数来构建我们的生成器网络，如下所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="2589" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在，是时候建立发电机网络了！！</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="5c66" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">为了帮助模型更快地收敛，我们将初始化线性层和卷积层的权重。根据<a class="ae mg" href="https://arxiv.org/pdf/1511.06434.pdf" rel="noopener ugc nofollow" target="_blank">的研究论文。</a></p><blockquote class="kw kx ky"><p id="1dc3" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">所有权重均从以零为中心的正态分布初始化，标准偏差为0.02。</em></p></blockquote><p id="07ec" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们将为此定义一个函数，如下所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="3035" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在，我们将初始化超参数和两个网络，如下所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="36d7" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">输出应该是这样的:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/06688ce502921482045ae30d98f0a344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*mJsIIwgdLOon8eA9.jpg"/></div></figure><p id="112d" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">鉴频器损耗:</p><blockquote class="kw kx ky"><p id="ac84" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">对于鉴别器，总损失是真实和虚假图像的损失之和，d_loss = d_real_loss + d_fake_loss。</em></p><p id="6113" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">记住，我们希望鉴别器为真实图像输出1，为虚假图像输出0，因此我们需要设置损耗来反映这一点。</em></p><p id="eaaa" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">来源:</em> <a class="ae mg" href="https://arxiv.org/pdf/1511.06434.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> DCGAN研究论文</em> </a></p></blockquote><p id="092b" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们将定义双损失函数。一个是真实损失，另一个是虚假损失，如下所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="c885" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">发电机损耗:</p><blockquote class="kw kx ky"><p id="a8b7" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">发电机损耗仅在标签翻转时看起来相似。生成器的目标是让鉴别器</em>认为<em class="iq">它生成的图像是</em>真实的<em class="iq">。</em></p><p id="5161" class="kz la lb lc b ld le ka lf lg lh kd li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">来源:</em> <a class="ae mg" href="https://arxiv.org/pdf/1511.06434.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> DCGAN研究论文</em> </a></p></blockquote><p id="0156" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在，是时候为我们的网络设置优化器了</p><p id="fa2c" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我将使用Adam optimizer进行培训。因为它被认为对甘的身体有好处。看<a class="ae mg" href="https://arxiv.org/abs/1906.04848" rel="noopener ugc nofollow" target="_blank">这个</a>就可以选择自己的了。超参数的值是根据这篇研究论文设定的。他们用它做了实验，结果证明这些是最好的！</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h1 id="1029" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">步骤4:编写训练算法</h1><p id="74b5" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">我们必须为我们的两个神经网络编写训练算法。首先，我们需要初始化噪声向量。我们会在整个训练过程中保持固定。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="1f78" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">对于鉴别器:</strong></p><p id="c227" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们首先将真实图像通过鉴别器网络，然后计算它的真实损耗。然后，我们将生成假图像并通过鉴别器网络，以便计算假损失。</p><p id="bf61" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">在计算真实和虚假损失后，我们将它们相加，并采取优化步骤进行训练。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="ded2" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">发电机:</strong></p><p id="734a" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们将对发电机网络的训练做同样的事情。刚才在通过鉴别器传递假图像后，我们将计算它的真实损失。然后优化我们的发电机网络。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h1 id="7a54" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">第五步:训练模型</h1><p id="31fb" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">现在我们将开始关于<strong class="lc ja"> 100个纪元:D </strong>的训练</p><p id="0dde" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">经过训练后，损失图看起来会像这样。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi on"><img src="../Images/78050d0928960d0c7c9201ad2df3ebe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/0*4kIhC7X87fm3sW5N.png"/></div></figure><p id="3769" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们可以看到，鉴频器损耗非常平滑，甚至在100个历元之后也收敛到某个特定数值。但由于发电机损耗，损耗急剧上升。</p><p id="da99" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们可以从下面的结果中看到，在60个时期之后，生成的图像是失真的。因此，我们可以得出结论，60岁的时期可以被认为是最佳的训练时期。</p><p id="c9ac" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">因为这两个损失在那一点上是最小的，并且发生器正在产生一些非常好的图像！</p><h1 id="b03a" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">步骤6:测试模型</h1><p id="9fee" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated"><strong class="lc ja">10个时期后:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/cee68131939cf674596ba50649b10589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*QDtLBmNWHeXY35-T.jpg"/></div></figure><p id="d773" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">20个周期后:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/70604c63e032f0089fd3353cd9962ce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*oxdTE39yaeDiGFR-.jpg"/></div></figure><p id="57ff" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">30个时期后:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/72bf755f6c01fbfb8e1075e00f3cd954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*yl4Es6THz9bwEBHh.jpg"/></div></figure><p id="a0ee" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">40个时期后:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/35d9ae29378b74069b28430dc82a7dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*iZOAy7-JC_dZ3fS0.jpg"/></div></figure><p id="4f41" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">50个时期后:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/8e85a713e45e54db4a4450ab2f8583a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*LGws0Iva8oYwS-fM.jpg"/></div></figure><p id="753b" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><strong class="lc ja">60个时期后:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/0ff2313a588c00baabc49fdddd329e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*V3cpXCBIxaWHM6op.jpg"/></div></figure><h1 id="4b12" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">结论:</h1><p id="a927" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated">我们可以看到，训练一个生成性对抗网络并不意味着它会生成好的图像。</p><p id="26f6" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们可以从结果中看到，在40-60个时期中，生成器生成的图像相对其他生成器更好。</p><p id="7136" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">你可以尝试改变优化器，学习率，和其他超参数，使其产生更好的图像！你能坚持到现在真是太好了！</p><p id="726a" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这整个笔记本可以在<a class="ae mg" href="https://github.com/Ahmad-shaikh575/Face-Generation-using-GANS" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="3339" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这是我的Github 和Linkedin 账户。请随意连接。</p><h1 id="f6a4" class="mv mw iq bd mx my ns na nb nc nt ne nf kf nu kg nh ki nv kj nj kl nw km nl nm bi translated">参考</h1><p id="dd9d" class="pw-post-body-paragraph kz la iq lc b ld nn ka lf lg no kd li md nx ll lm me ny lp lq mf nz lt lu lv ij bi translated"><a class="ae mg" href="https://arxiv.org/pdf/1511.06434.pdf" rel="noopener ugc nofollow" target="_blank"> DCGAN原始论文</a></p><p id="8321" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">亚历克·拉德福德的研究论文。</p><p id="0bde" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><a class="ae mg" href="https://arxiv.org/abs/1906.04848" rel="noopener ugc nofollow" target="_blank">研究论文作者</a> <a class="ae mg" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Berard%2C+H" rel="noopener ugc nofollow" target="_blank">雨果·贝拉德</a></p><p id="d6e7" class="pw-post-body-paragraph kz la iq lc b ld le ka lf lg lh kd li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><a class="ae mg" href="https://www.udacity.com/course/deep-learning-nanodegree--nd101" rel="noopener ugc nofollow" target="_blank"> Udacity深度学习纳米学位</a></p></div></div>    
</body>
</html>