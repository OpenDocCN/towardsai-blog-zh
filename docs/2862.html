<html>
<head>
<title>How To Choose Your Loss Function — Where I Disagree With Cassie Kozyrkov</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何选择你的损失函数——我不同意凯西·科兹尔科夫的观点</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-choose-your-loss-function-where-i-disagree-with-cassie-kozyrkov-2038d19b5e0a?source=collection_archive---------2-----------------------#2022-06-21">https://pub.towardsai.net/how-to-choose-your-loss-function-where-i-disagree-with-cassie-kozyrkov-2038d19b5e0a?source=collection_archive---------2-----------------------#2022-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6b99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择正确的损失函数和评估指标对于数据科学项目的成功至关重要。但是，尽管已经有很多关于机器学习算法和我们行业整体趋势的文章，我还没有遇到很多关于这个主题的有用建议。</p><p id="c3db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在最近的<a class="ae kl" href="https://towardsdatascience.com/whats-the-difference-between-a-metric-and-a-loss-function-38cac955f46d" rel="noopener" target="_blank">文章</a>中，Cassie Kozyrkov解释了损失函数和评估指标之间的区别。当谈到数据科学和分析时，Cassie是一个伟大的沟通者，她对我们社区的贡献是不可否认的。但这次她提出了一些我不同意的观点。<br/>在这篇文章中，我将回答她的一些陈述，并就如何在实践中选择这些指标给出我的两点意见。</p><h1 id="5d7f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">有很多选项可以选择你的损失函数</h1><p id="dd20" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Cassie的评论:<em class="lp">“在实践中，你将会引入其他人的算法，所以你将不得不忍受其中已经实现的任何损失函数。他们选择的是最容易优化的，而不是对您的用例最有意义的。”</em></p><p id="a39c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的论点是，机器学习库不允许你选择你的损失度量，在实践中实现一个新的机器学习算法将是太多的努力。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/79be91ddc8680680b83d294d0f38961c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yRhiESZW5D_ChxNw"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated"><a class="ae kl" href="https://unsplash.com/@homajob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="f244" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对此的简短回答是双重的。</p><ol class=""><li id="ece7" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">你可以自由选择另一个最小化你想要使用的损失函数的机器学习库。例如，当您想要使用线性模型时，您不需要最小化MSE，<a class="ae kl" href="https://www.statsmodels.org/stable/api.html#generalized-linear-models" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">stats models</strong></a><strong class="jp ir"/>为您提供了广泛的广义线性模型选择—所有模型都具有不同的损失函数。</li><li id="c45a" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">许多机器学习库实际上允许你指定定制的损失函数。有了<a class="ae kl" href="https://xgboost.readthedocs.io/en/stable/tutorials/custom_metric_obj.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> xgboost </strong> </a>、<a class="ae kl" href="https://lightgbm.readthedocs.io/en/latest/Parameters.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> lightGBM </strong> </a>和<a class="ae kl" href="https://catboost.ai/en/docs/concepts/python-reference_catboostclassifier#" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> catboost </strong> </a>所有最流行的boosting框架都允许指定自定义损失函数。<a class="ae kl" href="https://pytorch.org/docs/stable/nn.html#loss-functions" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Pytorch </strong> </a>和<a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/keras/losses" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Tensorflow </strong> </a>允许你从广泛的损失函数中进行选择，等等。<br/>的确，<strong class="jp ir"> sklearn </strong>不允许指定自定义损失函数，同样<a class="ae kl" href="https://spark.apache.org/docs/latest/mllib-linear-methods.html#loss-functions" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">spark ml</strong></a><strong class="jp ir"/>在这方面也没有提供太多选择。但总的来说，有很多选择来建立不同损失函数的模型，你不需要自己实现任何东西来使用它们。</li></ol><blockquote class="mu"><p id="ab5a" class="mv mw iq bd mx my mz na nb nc nd kk dk translated">总之，损失函数是可以改变的，它的选择对于模型的质量是非常重要的。</p></blockquote><p id="bce1" class="pw-post-body-paragraph jn jo iq jp b jq ne js jt ju nf jw jx jy ng ka kb kc nh ke kf kg ni ki kj kk ij bi translated">我们日常使用的大多数机器学习方法都是基于统计假设的统计学习方法。如果这些没有实现，估计的模型将表现不佳。例如，如果您处理计数数据，最小化泊松模型的对数似然比最小化MSE更好。这是因为MSE是误差正态分布的假设所隐含的损失度量。正态分布的随机变量可以取正值和负值，而计数数据通常为零或正值。此外，计数数据通常会产生一些非常大的值，这在正态分布中是极不可能的。<br/>因此，使用MSE将导致严重的错误指定模型，这将产生糟糕的预测——无论它训练了多少数据。</p><p id="f1d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一般来说，如果想要统计意义上的最佳模型，应该选择最符合误差分布的损失函数。</p><h1 id="dc5f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">您的评估指标的选择应该由您的业务问题决定</h1><p id="d82f" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Cassie的评论:<em class="lp">“只有一个新手坚持用他们的损失函数做绩效评估；专业人士通常有两个或两个以上的得分功能。”</em></p><p id="2feb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">评估指标主要是数据科学家了解其模型性能的不同方面的工具，通常用于制定建模决策。</p><p id="e122" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我看不出为什么损失函数不应该被用作这些指标之一。相反，由模型生成的预测的统计准确性通常对实现您的业务目标至关重要。因为损失函数通常衡量预测的准确性，所以在我看来，将它们包括在决定你决策的一系列指标中是一个好主意。</p><p id="4dc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Cassie认为评估指标应该是人类可以理解的。对于损失函数，例如logloss(或者可能是泊松回归的可能性),这可以通过将其与没有任何特征的简单模型的相同度量相关联来容易地实现。然后你可以报告，例如，你的对数损失是一个简单模型的三分之二——这基本上是一个“伪R2”所做的。</p><p id="a399" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终，任何现实世界的数据科学项目的成功都将以其业务影响来衡量。因此，如果可能的话，您应该根据对模型预期产生的业务影响的估计来判断模型的质量。你的利益相关者真正关心的KPI是点击、销售、收入或流失，而不是像RMSE或F1分数这样的评估指标。</p><p id="57fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果无法直接优化您的业务KPI，您别无选择，只能求助于评估指标。然而，您的决策应该由那些适合您的业务问题的标准来驱动。</p><p id="f081" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你是不是在尝试根据你流失客户的概率来给客户排名，却不那么在乎实际的概率预测？那么AUC-ROC可能是一个不错的选择，因为它本质上是基于排名的。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nj"><img src="../Images/2364098ccee2ea7478ce82ace2e666a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z735r1Uu3noQZ4nS"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">照片由<a class="ae kl" href="https://unsplash.com/@dancristianpaduret?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹-克里斯蒂安·pădureț</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="3b6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您是否希望预测您应该向客户提供的价格，以便优化您的收入？好吧，这样的话，某个价格的预期收益就是转换概率乘以价格。所以你真的很在乎得到正确的转换概率。因此，您可能希望使用logloss作为评估函数，因为它是二元决策问题中的对数似然函数，并且利用了模型的精确概率预测。</p><h1 id="18cc" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">损失函数和评估指标之间的差异可能会限制您的表现</strong></h1><p id="cb8e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Cassie的评论:<em class="lp">“你有没有用你的</em> <a class="ae kl" href="http://bit.ly/quaesita_emperorm" rel="noopener ugc nofollow" target="_blank"> <em class="lp">损失函数</em> </a> <em class="lp">来评估你的</em> <a class="ae kl" href="http://bit.ly/quaesita_simplest" rel="noopener ugc nofollow" target="_blank"> <em class="lp">机器学习</em> </a> <em class="lp">系统的性能？那是个错误，……”</em></p><p id="3c17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们刚刚讨论的，使用logloss作为评估指标和损失函数可能没有错，但如果这与您的业务问题相符，确实非常合理。</p><blockquote class="mu"><p id="02ca" class="mv mw iq bd mx my nk nl nm nn no kk dk translated">如果您的评估指标与您的业务问题一致，那么使用该评估指标作为损失函数甚至是理想的。这是因为，在数学上，两个不同的函数通常没有相同的极值。</p></blockquote><p id="97c3" class="pw-post-body-paragraph jn jo iq jp b jq ne js jt ju nf jw jx jy ng ka kb kc nh ke kf kg ni ki kj kk ij bi translated">如果你将对数损失最小化，你的AUC-ROC一般不会最大。如果你最小化MSE，你不会最小化MAE。这些指标可能是相关的，但这种相关性并不完美。所以，如果MAE是你和你的商业利益相关者所关心的，那么请尽量减少MAE。</p><div class="np nq gp gr nr ns"><a href="https://medium.com/@christian_leschinski/why-you-should-not-try-to-predict-stock-markets-3f7d291b1a29" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">为什么你不应该试图预测股票市场</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">我遇到过数量惊人的人，他们试图在某个时候建立一个交易算法。这就是为什么…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og ma ns"/></div></div></a></div><p id="f33b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一个理想的世界里，你会把基于你的预测而采取的行动作为你的模型的一部分，你会直接计算隐含的(负面的)点击、销售、收入等等。，并把它们作为你的损失函数。</p><p id="fac0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不幸的是，通常不可能将最适合您的业务目标的评估指标转化为损失函数。这是因为评估指标通常是不可微的，所以它们不容易进行数值优化。因此，它们中的许多不能用作损失度量。但是，如果你的损失函数和你的评估指标一致，这通常不是一个错误，而是一种提高模型性能的方法。想象一下，你可以直接最大化你的收入！</p><h1 id="9d71" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">细微的理解与经验法则</h1><p id="87bf" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Cassie的评论:<em class="lp">“你最终将依赖的损失函数是机器便利性的问题，而不是对你的业务问题或现实世界解释的适当性。”</em></p><p id="7abd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你做到了这一步，你已经阅读了我所有的论点，为什么值得仔细考虑你选择的损失函数。</p><p id="a2a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据我的经验，成功的机器学习产品的关键是对业务问题和业务KPI，以及您的数据结构，不同的机器学习算法及其实现(包括计算复杂性)，以及与不同解决方案相关的开发工作有深入细致的了解。</p><p id="853c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为数据科学家，我们必须根据所有这些因素的相互作用找到最佳解决方案。这就是我们的工作如此艰难的原因——但同时，时间又特别有趣。</p></div></div>    
</body>
</html>