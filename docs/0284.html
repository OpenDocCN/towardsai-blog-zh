<html>
<head>
<title>Will Your Education Pay You Well?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的教育会给你带来丰厚的报酬吗？</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/will-your-education-pay-you-well-d6aeb44248fa?source=collection_archive---------0-----------------------#2020-01-21">https://pub.towardsai.net/will-your-education-pay-you-well-d6aeb44248fa?source=collection_archive---------0-----------------------#2020-01-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/51346544da5667adfb303489ea802800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MUWhjCFpm-r1cTPa.jpg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://pixabay.com/photos/woman-adult-people-money-3261425/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/photos/woman-大人-人-钱-3261425/ </a></figcaption></figure><div class=""/><div class=""><h2 id="d322" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用随机森林的工资分析</h2></div><p id="ddad" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">工资分析是根据员工的属性对工资进行比较的过程。当然，有几个因素，比如公司、地点，对工资有影响。然而，我们将分析大西洋中部的工资数据，可在<a class="ae jg" href="https://rdrr.io/cran/ISLR/man/Wage.html" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="2131" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">出于执行原因，我使用了PySpark和Apache Spark Docker Jupyter Notebook，您也可以使用python和scikit或其他一些包。</p><p id="b69f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们应该仔细阅读我们的信息并理解它的样子:</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ma"><img src="../Images/36f1ac5d2a588ea0ceb385e6328cca1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oG1ylILYg_JWyUPDDGHYtA.png"/></div></div></figure><h1 id="78ca" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">特征工程</h1><p id="d992" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们有许多分类变量，如婚姻、种族、教育、工作类别、健康和健康信息，所以我们需要将它们转换为整数，因为ML模型不能处理分类特征。因此，我们使用<a class="ae jg" href="https://spark.apache.org/docs/latest/ml-features#stringindexer" rel="noopener ugc nofollow" target="_blank"> StringIndexer </a>将一个列转换为索引列。我们还使用<a class="ae jg" href="http://en.wikipedia.org/wiki/One-hot" rel="noopener ugc nofollow" target="_blank"> One-hot编码</a>，它将一个分类特征(表示为标签索引)映射到一个二进制向量，该向量最多具有一个单值，指示所有特征值集合中特定特征值的存在。最后，我们使用vector assembler，合并所有变量，并将它们存储在features列中。我们创建一个管道来组织预处理代码。具体来说，一个<a class="ae jg" href="https://www.kaggle.com/alexisbcook/pipelines" rel="noopener ugc nofollow" target="_blank">管道</a>捆绑了预处理和建模步骤，因此我们可以使用整个捆绑包，就像它是一个单独的步骤一样。</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/08a20e3c8f8c8a408f4fac245b83ea2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WtzE4n6eba2uQ6SSJKIpTA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">特征工程的结果</figcaption></figure><h1 id="b987" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">建模—随机森林</h1><p id="b95d" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">现在，我们创建三个管道，包含三个不同的随机森林回归，这些回归接受来自<code class="fe mz na nb nc b"><strong class="la jk">wage_df</strong></code>的所有特征来预测<code class="fe mz na nb nc b"><strong class="la jk">wage</strong></code></p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><h1 id="6a75" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">估价</h1><p id="6c56" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们将利用<strong class="la jk"> RMSE </strong>检查我们模型的展示。我们在<strong class="la jk">验证</strong>数据上注册RMSE，然后，我们将最佳管道归入变量best_model。最后，我们利用<strong class="la jk"> best_model </strong>流水线来计算<strong class="la jk">测试数据</strong>上的RMSE。</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/0fa8960efa0941c2c84aaaf574c90d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*oaHGER6PrQyEc5y9VYY5kQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">3种不同型号的性能</figcaption></figure><p id="9029" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们看到<strong class="la jk"> pipe_rf3 </strong>在验证数据上执行<strong class="la jk">最好</strong>，所以我们将使用它来检查测试数据上的性能。</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/495714106e093a1db5c1a9a6ebd68806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JtL3vsDpWOsrnVgM31zYag.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">测试数据上最佳模型的性能</figcaption></figure><h1 id="aa53" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">推理</h1><p id="75b8" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们用这些列的特征和重要性制作一个pandas数据框<strong class="la jk"> feature_importance </strong>。我们将利用<strong class="la jk">最佳模型</strong>来决定特征的重要性</p><p id="916e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们希望给出适当的名称，以便有人可以直接推断并理解整个模型。</p><p id="5414" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好吧，这是一个非常愚蠢的获得像<strong class="la jk"> maritl_1这样的名字的方法。_未婚</strong>！如果有人能想到一个很好的作品，请平我！尽管如此，我们还是得到了我们所需要的</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/7611c2e0112317e9909390ccce06d904.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*f3uPpaMz67vQqqie7ZKQDQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">特征重要性</figcaption></figure><p id="09ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">兰登森林令人钦佩地降低了每个组件的重要性。拥有<em class="ng">高级学位</em>和<em class="ng">年长</em>会带来高收入，这是个好兆头。此外，<em class="ng">婚姻状况</em>和<em class="ng">种族</em>被赋予最小的宽松度</p><h2 id="50b5" class="nh mc jj bd md ni nj dn mh nk nl dp ml lh nm nn mn ll no np mp lp nq nr mr ns bi translated">参考:</h2><p id="e551" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><a class="ae jg" href="https://www.datacamp.com/community/tutorials/categorical-data#spark" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/categorial-data # spark</a></p></div></div>    
</body>
</html>