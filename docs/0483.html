<html>
<head>
<title>Bayes’ Theorem Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释贝叶斯定理</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/bayes-theorem-explained-66ebf8285fcc?source=collection_archive---------0-----------------------#2020-05-12">https://pub.towardsai.net/bayes-theorem-explained-66ebf8285fcc?source=collection_archive---------0-----------------------#2020-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e110939fae48110d321c2431f1e99f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oHjW-kyjyeoRu9ZB0RpX0g.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">Benjamin O. Tayo的图片。</figcaption></figure><h2 id="f207" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="f6be" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">贝叶斯定理对于解释二元分类算法的结果至关重要，是有抱负的数据科学家必须知道的</h2></div><h1 id="2505" class="lh li jj bd jg lj lk ll lm ln lo lp lq ky lr kz ls lb lt lc lu le lv lf lw lx bi translated">一.导言</h1><p id="c51e" class="pw-post-body-paragraph ly lz jj ma b mb mc kt md me mf kw mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated"><a class="ae mu" href="https://en.wikipedia.org/wiki/Bayes'_theorem" rel="noopener ugc nofollow" target="_blank">贝叶斯定理</a>在二分类问题中起着重要的作用。它用于解释二进制分类算法的输出。在本文中，我们将使用<a class="ae mu" href="https://github.com/bot13956/Bayes_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="ma jt"> <em class="mv">高度</em> </strong> </a>数据集来演示贝叶斯定理。该数据集包含1050个个体(男性和女性)样本的身高。我们将建立一个机器学习模型来预测一个人的性别(男性或女性)，基于他们的身高。使用male (M)作为测试的正值，将演示贝叶斯定理(如上图所示)。图中数量<strong class="ma jt"><em class="mv">P(y = M | y _ hat = M)</em></strong>是预测值为男性(M)则实际值也为男性的条件概率。这也被称为<strong class="ma jt"><em class="mv">【PPV】</em></strong>或<strong class="ma jt"> <em class="mv">正精度</em> </strong>，假设男性(M)为正类，女性(F)为负类。同样，量<strong class="ma jt"><em class="mv">P(y _ hat = M | y = M)</em></strong>是条件概率，如果实际值是男性，那么预测值也是男性。这也被称为<strong class="ma jt"><em class="mv"/></strong><strong class="ma jt"><em class="mv">回忆</em> </strong>或<strong class="ma jt"> <em class="mv">灵敏度</em> </strong>。我们将说明贝叶斯定理仅仅是<strong class="ma jt"><em class="mv"/></strong><strong class="ma jt"><em class="mv">回忆</em> </strong>之间的关系。</p><p id="e268" class="pw-post-body-paragraph ly lz jj ma b mb mw kt md me mx kw mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">虽然我们将集中在正类(M)上，但是对于负类(F)也可以建立类似的关系。在这种情况下，<strong class="ma jt"> <em class="mv"> P(y = F| y_hat = F) </em> </strong>是条件概率，如果预测值是女性(F)，那么实际值也是女性。这也称为<strong class="ma jt"> <em class="mv">阴性</em> </strong> <strong class="ma jt"> <em class="mv">预测值(NPV) </em> </strong>或<strong class="ma jt"> <em class="mv">阴性精度</em> </strong>为阴性测试。同样，量<strong class="ma jt"><em class="mv">P(y _ hat = F | y = F)</em></strong>是条件概率，如果实际值是女性，那么预测值也是女性。这也被称为<strong class="ma jt"> <em class="mv">阴性召回</em>或<em class="mv">特异性</em> </strong>为阴性检测<strong class="ma jt"> <em class="mv">。</em>T29】</strong></p><h1 id="d7c1" class="lh li jj bd jg lj lk ll lm ln lo lp lq ky lr kz ls lb lt lc lu le lv lf lw lx bi translated">二。数据集的来源</h1><p id="de9f" class="pw-post-body-paragraph ly lz jj ma b mb mc kt md me mf kw mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated"><a class="ae mu" href="https://github.com/bot13956/Bayes_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="ma jt"> <em class="mv">高度</em> </strong> </a>数据集包含在R的dslabs包中，并在R Studio中使用以下代码获得:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="5100" class="nk li jj ng b gy nl nm l nn no">install.packages('dslabs')</span><span id="40f2" class="nk li jj ng b gy np nm l nn no">library(dslabs)</span><span id="396d" class="nk li jj ng b gy np nm l nn no">write.csv(heights, "heights.csv", row.names = F)</span></pre><h1 id="752b" class="lh li jj bd jg lj lk ll lm ln lo lp lq ky lr kz ls lb lt lc lu le lv lf lw lx bi translated">三。使用Sklearn的监督学习</h1><h2 id="f646" class="nk li jj bd jg nq nr dn lm ns nt dp lq mh nu nv ls ml nw nx lu mp ny nz lw jp bi translated">III A .导入必要的库</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="5010" class="nk li jj ng b gy nl nm l nn no">import numpy as np</span><span id="8508" class="nk li jj ng b gy np nm l nn no">import pandas as pd</span><span id="5a99" class="nk li jj ng b gy np nm l nn no">import matplotlib.pyplot as plt</span><span id="99ad" class="nk li jj ng b gy np nm l nn no">import seaborn as sns</span><span id="316c" class="nk li jj ng b gy np nm l nn no">from sklearn import datasets</span><span id="f95d" class="nk li jj ng b gy np nm l nn no">from sklearn.model_selection import train_test_split</span><span id="bc03" class="nk li jj ng b gy np nm l nn no">from sklearn.neighbors import KNeighborsClassifier</span><span id="719c" class="nk li jj ng b gy np nm l nn no">from sklearn.metrics import confusion_matrix</span><span id="a730" class="nk li jj ng b gy np nm l nn no">from sklearn.metrics import classification_report</span><span id="194c" class="nk li jj ng b gy np nm l nn no">plt.style.use("ggplot")</span><span id="354e" class="nk li jj ng b gy np nm l nn no">%matplotlib inline</span></pre><h2 id="e623" class="nk li jj bd jg nq nr dn lm ns nt dp lq mh nu nv ls ml nw nx lu mp ny nz lw jp bi translated">探索性数据分析</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0344" class="nk li jj ng b gy nl nm l nn no">df=pd.read_csv("heights.csv")</span><span id="305e" class="nk li jj ng b gy np nm l nn no">df.head()</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/34c0797e29a3bfeba0d7b6dd84231933.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*rqtdsTSn2hyQ5fWDclqAzQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">表1。数据集的头。</strong></figcaption></figure><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="d635" class="nk li jj ng b gy nl nm l nn no">plt.figure()</span><span id="b8be" class="nk li jj ng b gy np nm l nn no">sns.countplot(x="sex", data=df)</span><span id="77bd" class="nk li jj ng b gy np nm l nn no">plt.show</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/19fc93b9c9d54723ebe62b949c31192c.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*YDgFP6ll2y3s0cU_g7iPiQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">图一。数据集的分布。N=1050: 812(男性)和238(女性)身高。这表明我们有一个非常不平衡的数据集，男性身高占77%，女性身高占23%。</strong></figcaption></figure><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="7347" class="nk li jj ng b gy nl nm l nn no">df2 = df</span><span id="a6c6" class="nk li jj ng b gy np nm l nn no">df2['count'] = range(df.shape[0])</span><span id="089f" class="nk li jj ng b gy np nm l nn no">sns.lmplot( x="count", y="height", data=df2, hue='sex', <br/>                  legend=False, fit_reg=False, aspect=1.6)</span><span id="3920" class="nk li jj ng b gy np nm l nn no">plt.legend(loc='upper left')</span><span id="9d37" class="nk li jj ng b gy np nm l nn no">plt.title('Scatter plot of heights')</span><span id="a546" class="nk li jj ng b gy np nm l nn no">plt.ylabel('height (inch)')</span><span id="1e41" class="nk li jj ng b gy np nm l nn no">plt.show()</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/2b39b8bcbafa9ebc3e72e54c1bbb5e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*VxqqaOF8IaKOoqFfwwVNEQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">图二。高度数据集的散点图。我们观察到数据集是不平衡的(77%是男性类，23%是女性类)。</strong></figcaption></figure><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0c10" class="nk li jj ng b gy nl nm l nn no">plt.figure(figsize=(10,6))</span><span id="7d59" class="nk li jj ng b gy np nm l nn no">sns.distplot(df['height'],bins=20)</span><span id="1e87" class="nk li jj ng b gy np nm l nn no">plt.title('probability distribution of all heights')</span><span id="4578" class="nk li jj ng b gy np nm l nn no">plt.xlabel('height (inch)')</span><span id="4938" class="nk li jj ng b gy np nm l nn no">plt.show()</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/45629761bd834312e04bab27daee00f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*QdTHyz-VoQB3KiIk4DH8ag.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">图三。所有身高的概率分布(男女)。</strong></figcaption></figure><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b880" class="nk li jj ng b gy nl nm l nn no">plt.figure(figsize=(10,6))</span><span id="e533" class="nk li jj ng b gy np nm l nn no">sns.distplot(df[df.sex=='Male']['height'],bins=None, hist=False, label = 'Male')</span><span id="172e" class="nk li jj ng b gy np nm l nn no">plt.title('probability distribution of Male and Female heights')</span><span id="d4bd" class="nk li jj ng b gy np nm l nn no">sns.distplot(df[df.sex=='Female']['height'],bins=None, hist = False, label = 'Female')</span><span id="b945" class="nk li jj ng b gy np nm l nn no">plt.legend()</span><span id="7917" class="nk li jj ng b gy np nm l nn no">plt.xlabel('height (inch)')</span><span id="3977" class="nk li jj ng b gy np nm l nn no">plt.show()</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/0052da1a4c35055f96719b96fb3ae105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*SgC2CvxHy0qmfHuyfLwEww.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">图4。男女身高的概率分布。</strong></figcaption></figure><h2 id="b268" class="nk li jj bd jg nq nr dn lm ns nt dp lq mh nu nv ls ml nw nx lu mp ny nz lw jp bi translated">三. c .模型建立和评估</h2><p id="4596" class="pw-post-body-paragraph ly lz jj ma b mb mc kt md me mf kw mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">为简单起见，我们将使用KNN分类器。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e777" class="nk li jj ng b gy nl nm l nn no">from sklearn.preprocessing import LabelEncoder</span><span id="5dce" class="nk li jj ng b gy np nm l nn no">class_le = LabelEncoder()</span><span id="2f2e" class="nk li jj ng b gy np nm l nn no">y = class_le.fit_transform(df['sex'].values)</span><span id="193b" class="nk li jj ng b gy np nm l nn no">pd.value_counts(y)</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/40f68736ba318fa82c6883aa096548a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*-F6XYJcVHoTYJvNnn031DQ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">表二。显示1是男性(M)类，0是女性(F)类。</strong></figcaption></figure><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="acaf" class="nk li jj ng b gy nl nm l nn no">X = df['height']</span><span id="a1ce" class="nk li jj ng b gy np nm l nn no">X_train, X_test, y_train, y_test = train_test_split(X, y,   <br/>                          test_size=0.3, random_state=0, stratify=y)</span><span id="593e" class="nk li jj ng b gy np nm l nn no">X_train = X_train.values.reshape(X_train.shape[0],1)</span><span id="e9f8" class="nk li jj ng b gy np nm l nn no">X_test = X_test.values.reshape(X_test.shape[0],1)</span><span id="24f1" class="nk li jj ng b gy np nm l nn no">knn = KNeighborsClassifier(n_neighbors=5)</span><span id="2552" class="nk li jj ng b gy np nm l nn no">knn.fit(X_train, y_train)</span><span id="7ee1" class="nk li jj ng b gy np nm l nn no">y_pred = knn.predict(X_test)</span></pre><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/ed990534a6b869630c19b9520800800b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*aAxnOo7-0rPJpillgjOpkw.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">图5。准确性评分和分类报告。</strong></figcaption></figure><h2 id="2d12" class="nk li jj bd jg nq nr dn lm ns nt dp lq mh nu nv ls ml nw nx lu mp ny nz lw jp bi translated">贝叶斯定理</h2><p id="1e3b" class="pw-post-body-paragraph ly lz jj ma b mb mc kt md me mf kw mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">使用计算出的混淆矩阵可以建立贝叶斯定理，如下图所示:</p><figure class="nb nc nd ne gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e110939fae48110d321c2431f1e99f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oHjW-kyjyeoRu9ZB0RpX0g.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd jg">图6:使用二元分类算法的结果演示贝叶斯定理。</strong></figcaption></figure><h2 id="95da" class="nk li jj bd jg nq nr dn lm ns nt dp lq mh nu nv ls ml nw nx lu mp ny nz lw jp bi translated"><strong class="ak">评论和意见:</strong></h2><p id="b97a" class="pw-post-body-paragraph ly lz jj ma b mb mc kt md me mf kw mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在<strong class="ma jt">图6 </strong>中，概率<strong class="ma jt"> P(A/B) = 222/254 = 0.87 </strong>称为<strong class="ma jt"> <em class="mv"> PPV </em> </strong>或<strong class="ma jt"> <em class="mv">精度</em> </strong>。就是预测为男性身高的身高实际上是(真实的)男性身高的概率。概率<strong class="ma jt"> P(B/A) = 222/244 = 0.91 </strong>称为<strong class="ma jt"> <em class="mv">召回</em> </strong>。它只是给出了244个实际男性身高中被我们的分类算法正确预测的百分比。我们看到贝叶斯定理简单来说就是<strong class="ma jt"> <em class="mv">回忆</em> </strong>和<strong class="ma jt"> <em class="mv">精度</em> </strong>之间的关系。</p><p id="f9af" class="pw-post-body-paragraph ly lz jj ma b mb mw kt md me mx kw mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">我们还观察到(从<strong class="ma jt">图5 </strong>)使用<strong class="ma jt"><em class="mv">【KNN . score(X _ test，y_test) </em> </strong>计算的模型的总体<strong class="ma jt"><em class="mv"/></strong>精度为<strong class="ma jt"> 0.83 </strong>，低于我们的<strong class="ma jt"> <em class="mv"> PPV </em> </strong>和<strong class="ma jt"> <em class="mv">召回</em> </strong>值。分类报告(<strong class="ma jt">见上图5</strong>)还显示，阴性类(雌性)的<strong class="ma jt"><em class="mv">【NPV】</em></strong>为<strong class="ma jt"> 0.64 </strong>。</p><p id="1d5b" class="pw-post-body-paragraph ly lz jj ma b mb mw kt md me mx kw mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">这是意料之中的，因为与女性身高相比，该模型更倾向于预测男性身高。这是由于不平衡的数据集(数据集的77%由男性阶层构成)。所以模型在预测男性身高方面做的很好(<strong class="ma jt"><em class="mv">【0.87精度</em> </strong>)，在预测女性身高方面做的不好(<strong class="ma jt"> <em class="mv"> 0.64精度</em> </strong>)。因此，总体精度(<strong class="ma jt"> <em class="mv"> 0.83 </em> </strong>)在这种情况下不是一个好的度量。相反，重要的是使用<strong class="ma jt"> <em class="mv"> PPV </em> </strong>用于正值(雄性)，使用<strong class="ma jt"> <em class="mv"> NPV </em> </strong>用于阴性测试(雌性)，因为数据集是不平衡的。</p><h1 id="d6c6" class="lh li jj bd jg lj lk ll lm ln lo lp lq ky lr kz ls lb lt lc lu le lv lf lw lx bi translated">四。总结和结论</h1><p id="404e" class="pw-post-body-paragraph ly lz jj ma b mb mc kt md me mf kw mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">总之，我们已经讨论了贝叶斯定理在解释二元分类算法的结果中的作用。贝叶斯定理是统计学中最重要的定理之一，因此有抱负的数据科学家完全理解该定理及其含义是值得的。本文的数据集和Jupyter笔记本可以从下面的链接下载:</p><p id="773a" class="pw-post-body-paragraph ly lz jj ma b mb mw kt md me mx kw mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated"><a class="ae mu" href="https://github.com/bot13956/Bayes_theorem" rel="noopener ugc nofollow" target="_blank">https://github.com/bot13956/Bayes_theorem</a></p><h1 id="0af6" class="lh li jj bd jg lj lk ll lm ln lo lp lq ky lr kz ls lb lt lc lu le lv lf lw lx bi translated">参考</h1><ol class=""><li id="1e43" class="og oh jj ma b mb mc me mf mh oi ml oj mp ok mt ol om on oo bi translated"><a class="ae mu" href="https://en.wikipedia.org/wiki/Bayes'_theorem" rel="noopener ugc nofollow" target="_blank">贝叶斯定理维基百科页面</a>。</li><li id="674e" class="og oh jj ma b mb op me oq mh or ml os mp ot mt ol om on oo bi translated">https://github.com/bot13956/Bayes_theorem<a class="ae mu" href="https://github.com/bot13956/Bayes_theorem" rel="noopener ugc nofollow" target="_blank">。</a></li></ol></div></div>    
</body>
</html>