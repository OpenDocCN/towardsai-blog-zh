<html>
<head>
<title>Classification Using Monk AI by Using a Slice of the Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Monk AI通过使用数据集的切片进行分类</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/classification-using-monk-ai-while-using-some-part-of-dataset-48606f4d35e7?source=collection_archive---------1-----------------------#2020-04-28">https://pub.towardsai.net/classification-using-monk-ai-while-using-some-part-of-dataset-48606f4d35e7?source=collection_archive---------1-----------------------#2020-04-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cfd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在机器学习中，分类是将给定的一组数据归类到类中的过程。它可以在结构化或非结构化数据上执行。</p><p id="30db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我预测了一类给定的数据点。这些类通常被称为目标、标签或类别。主要目标是确定新数据将属于哪个类或类别。</p><p id="e88b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我尝试在我获取的数据集上训练模型，但是由于数据集非常大，这是一个非常耗时的过程。因此，我使用了不同的方法。我用Monk AI在数据集的某些部分上对它进行了训练。</p><p id="fa2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">人们还可以知道他们的超参数是否允许网络收敛。</p><p id="f916" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有多种架构可供分类，但我使用的是Densenet-121，其架构如下图所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/ac032ead9aa1d6b09209364ae0af4706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*5X7w5JHsNySbWzNWKTtEOQ.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">Densenet-121架构来自原始论文</figcaption></figure><p id="6834" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于这个任务，我使用了<a class="ae kx" href="https://www.kaggle.com/c/iwildcam-2020-fgvc7" rel="noopener ugc nofollow" target="_blank"> iWildCam 2020 — FGVC7数据集</a>，它可以在Kaggle上的给定链接上下载。该数据集包含从全球各地的相机陷阱中拍摄的动物图像，主要目的是对这些图像进行分类。</p><p id="95ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在开始之前，我们需要安装MONK库和densenet-121模型的需求。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/cc1aa7dcd2ea502b4d1c559ff607e21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*cLSbA6ltYJiW7wnDmL9BiA.png"/></div></figure><p id="8a09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您使用的是Colab，请使用以下命令进行安装:</p><p id="7e61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">！CD monk _ v1/installation/Misc &amp; &amp; pip install-r要求_colab.txt</p><p id="bb16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您使用Kaggle，请使用以下命令进行安装:</p><p id="6333" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">！CD monk _ v1/installation/Misc &amp; &amp; pip install-r要求_kaggle.txt</p><p id="e087" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用本地系统或云时，根据OS和CUDA版本选择需求文件</p><p id="dfae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">！CD monk _ v1/installation/Linux &amp; &amp; pip install-r需求_cu9.txt</p><p id="f3bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是来自数据集的样本图像:-</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/24766cdbfb3c2767fe791997a6e7de6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*DrTcwUk-wHV40EhhQSWJrg.png"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/6fc201052aaa953b91528c2b93dbb6c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*f23L7kTxXUSEktkMOJIo-g.png"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/52c54b05141d3d4e245a2f2ba3bf6b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*PxW-b0Fjj3FvXZiM_ymvwg.png"/></div></figure><p id="d6aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来很可爱！</p><p id="87f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将导入原型来使用胶子后端</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/3c4aebe924ce8c6face4ba96f6570e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*IPBcLwezX_rdf_kI1eJtrw.png"/></div></figure><p id="7b37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是创建和管理实验。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi la"><img src="../Images/bc6d2de45faa8069d4883e0a873a1733.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*SeSEA_Hc55Z6fYLdL34-HA.png"/></div></figure><p id="9b99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一步中，我们将加载数据和模型。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/e5050d62aed361e324a2f5259173279e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*bZc157CExhCZngQ_aV0Mbw.png"/></div></figure><p id="96b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在加载数据和模型之后，使用下面的命令从数据集中获取样本，例如，我取了整个数据集的3%。</p><p id="53bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">样本数据集将以CSV格式保存，文件名为<strong class="jp ir">sampled _ dataset _ train . CSV</strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/faf12948ebed406a47922745a5e846ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*1ApoDBKNjMl4sL52Cp3Cnw.png"/></div></figure><p id="4d26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在创建和管理实验，并加载数据和模型。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/8f0a88651118acbf723d4cc18670ef78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*_6kGdwfRed0eIXhCHeBNzQ.png"/></div></figure><p id="5c4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型将运行6次，在每次迭代中，我们将看到模型的准确性如何提高。</p><p id="74c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于损坏的图像，请使用以下命令:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/c2652e6b12bb46a42606d1914a12bb46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*KlqR1fsge0hORWw27hTfLw.png"/></div></figure><p id="9a04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该命令将有助于在3%的数据集中找到损坏的图像。</p><p id="0e4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到，在3%的数据集中没有损坏的图像。</p><p id="64f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一步中，我们将在训练数据集上训练模型。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/a65a812992bc55b73e2bbd9cc00f91f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*Dl-tUfmjExluRQ1vhmmQlA.png"/></div></figure><p id="8209" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将在训练数据集上训练该模型。</p><p id="e066" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">训练完成后，我们可以对测试图像进行推理。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/1f686ba47948adcde58af3c3d3164383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*5gpM4PnT394o0JQGAqjITg.png"/></div></figure><p id="6c80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行推理后，选择任意图像并对该图像运行推理。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/e1b74c1b3d300d23bcdb70387e83c886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*s_MdbCRmnXC_v31Likbs2Q.png"/></div></figure><p id="e259" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将得到该图像的预测，这将给出该图像中动物的类别。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/3a7a78da9ce568c7f34c1e4cd35fe8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*vOBMKUPbErV3HYu2HwcQdg.png"/></div></figure><p id="0fea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个模型在3%的数据集上给出了相当不错的准确度。</p><p id="6769" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文中的所有代码都位于这个Github链接上</p><div class="ld le gp gr lf lg"><a href="https://github.com/shubham7169/MonkAI/blob/master/WildCam" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd ir gy z fp ll fr fs lm fu fw ip bi translated">shubham7169/MonkAI</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">导入NumPy为np #线性代数导入熊猫为PD #数据处理，CSV文件I/O(如PD.read_csv)导入…</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">github.com</p></div></div><div class="lp l"><div class="lq l lr ls lt lp lu kr lg"/></div></div></a></div><p id="cf4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">参考文献</strong></p><p id="e953" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和尚艾GitHub回购<em class="lv">——</em><a class="ae kx" href="https://github.com/Tessellate-Imaging/monk_v1" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a></p></div></div>    
</body>
</html>