<html>
<head>
<title>Hands-on k-fold Cross-validation for Machine Learning Model Evaluation — Cruise Ship Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于机器学习模型评估的实践k-fold交叉验证—游轮数据集</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/hands-on-k-fold-cross-validation-for-machine-learning-model-evaluation-cruise-ship-dataset-27390d58776d?source=collection_archive---------0-----------------------#2019-10-28">https://pub.towardsai.net/hands-on-k-fold-cross-validation-for-machine-learning-model-evaluation-cruise-ship-dataset-27390d58776d?source=collection_archive---------0-----------------------#2019-10-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b8eb" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">使用对AI的交叉验证来评估ML模型的性能| <a class="ae ep" href="https://towardsai.net" rel="noopener ugc nofollow" target="_blank"/></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/d07837d9c5965bca8c3d4c2d4e42a6c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ynMQ0vLLN40gxhj758-Afg.png"/></div></div></figure><p id="799c" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在上一篇文章中(<a class="ae li" href="https://medium.com/towards-artificial-intelligence/feature-selection-and-dimensionality-reduction-using-covariance-matrix-plot-b4c7498abd07" rel="noopener"> <strong class="km jd">使用协方差矩阵图进行特征选择和降维</strong> </a>)，我们已经展示了协方差矩阵图可以用于特征选择和降维。</p><p id="371e" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">使用游轮数据集<a class="ae li" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank"><strong class="km jd">cruise _ ship _ info . CSV</strong></a><strong class="km jd">，</strong>我们发现，在6个预测特征[' <strong class="km jd">年龄</strong>'、<strong class="km jd">吨位</strong>'、<strong class="km jd">乘客</strong>'、<strong class="km jd">长度</strong>'、<strong class="km jd">舱室</strong>、<strong class="km jd">乘客密度</strong> ]中，如果我们假设重要特征具有相关系数 那么目标变量“<strong class="km jd">乘员</strong>”与4个预测变量:“<strong class="km jd">吨位</strong>”、“<strong class="km jd">乘客</strong>”、“<strong class="km jd">长度</strong>、“<strong class="km jd">车厢</strong>”强相关。 因此，我们能够将特征空间的维数从6降低到4。</p><p id="3653" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">现在，假设我们想在新的特征空间上建立一个模型来预测船员变量。我们的模型可以用以下形式表示:</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/48ab44088d7ed93480f0b54a8c4b2915.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/0*Rug5fXzIuh0uYZ96.png"/></div></figure><p id="f2af" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在本文中，我们展示了如何使用一种叫做k-fold交叉验证的方法来训练、测试和评估我们的模型。</p><h1 id="2843" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">什么是k倍交叉验证？</h1><p id="dab3" class="pw-post-body-paragraph kk kl it km b kn mm kp kq kr mn kt ku kv mo kx ky kz mp lb lc ld mq lf lg lh im bi translated">交叉验证是一种跨数据集的随机样本评估机器学习模型性能的方法。这确保了数据集中的任何偏差都被捕获。交叉验证可以帮助我们获得模型泛化误差的可靠估计值，即模型对未知数据的表现。</p><p id="bde0" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在k-fold交叉验证中，数据集被随机划分为训练集和测试集。该模型在训练集上被训练，并在测试集上被评估。该过程重复k次。然后，通过对k倍进行平均来计算平均训练和测试分数。</p><p id="86e1" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">以下是k倍交叉验证伪代码:</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mr"><img src="../Images/6681a30d6f7f0b779195868b3afd53c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SuwdPdWoJA3I8Y8_OJtrA.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated"><strong class="bd lq"> k倍交叉验证伪代码。</strong></figcaption></figure><h1 id="ba47" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">实现k重交叉验证</h1><h2 id="4b2c" class="mw lp it bd lq mx my dn lu mz na dp ly kv nb nc mc kz nd ne mg ld nf ng mk iz bi translated">1.导入必要的库</h2><pre class="lk ll lm ln gt nh ni nj nk aw nl bi"><span id="5a3a" class="mw lp it ni b gy nm nn l no np">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span></pre><h2 id="0efa" class="mw lp it bd lq mx my dn lu mz na dp ly kv nb nc mc kz nd ne mg ld nf ng mk iz bi translated">2.读取数据集并选择重要特征</h2><pre class="lk ll lm ln gt nh ni nj nk aw nl bi"><span id="833f" class="mw lp it ni b gy nm nn l no np">df=pd.read_csv("cruise_ship_info.csv")<br/>  <br/>cols_selected = ['Tonnage', 'passengers', 'length', 'cabins','crew']<br/>  <br/>df[cols_selected].head()</span></pre><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nq"><img src="../Images/628c2dddca10e1681b3baddc2e764f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/0*Iq-WgG1FiKPKYayA.png"/></div></div></figure><h2 id="d754" class="mw lp it bd lq mx my dn lu mz na dp ly kv nb nc mc kz nd ne mg ld nf ng mk iz bi translated"><strong class="ak"> 3。使用k-fold交叉验证进行模型构建和评估</strong></h2><pre class="lk ll lm ln gt nh ni nj nk aw nl bi"><span id="e7c6" class="mw lp it ni b gy nm nn l no np">X = df[cols_selected].iloc[:,0:4].values     <br/>y = df[cols_selected]['crew']</span><span id="2a7a" class="mw lp it ni b gy nr nn l no np"><strong class="ni jd">from</strong> <strong class="ni jd">sklearn.preprocessing</strong> <strong class="ni jd">import</strong> StandardScaler<br/><strong class="ni jd">from</strong> <strong class="ni jd">sklearn.decomposition</strong> <strong class="ni jd">import</strong> PCA<br/><strong class="ni jd">from</strong> <strong class="ni jd">sklearn.linear_model</strong> <strong class="ni jd">import</strong> LinearRegression<br/><strong class="ni jd">from</strong> <strong class="ni jd">sklearn.pipeline</strong> <strong class="ni jd">import</strong> Pipeline</span><span id="e77a" class="mw lp it ni b gy nr nn l no np"><strong class="ni jd">from</strong> <strong class="ni jd">sklearn.model_selection</strong> <strong class="ni jd">import</strong> train_test_split<br/><strong class="ni jd">from</strong> <strong class="ni jd">sklearn.metrics</strong> <strong class="ni jd">import</strong> r2_score</span><span id="3ea2" class="mw lp it ni b gy nr nn l no np"><br/>sc_y = StandardScaler()<br/>sc_x = StandardScaler()<br/>y_std = sc_y.fit_transform(y_train[:, np.newaxis]).flatten()</span><span id="de5b" class="mw lp it ni b gy nr nn l no np">train_score = [] <br/>test_score  = []</span><span id="bade" class="mw lp it ni b gy nr nn l no np"><strong class="ni jd">for</strong> i <strong class="ni jd">in</strong> range(10):<br/>    X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.4, random_state=i)<br/>    y_train_std = sc_y.fit_transform(y_train[:, np.newaxis]).flatten()<br/>    <br/>    pipe_lr = Pipeline([('scl', StandardScaler()),<br/>                        ('pca', PCA(n_components=4)),<br/>                        ('slr', LinearRegression())])</span><span id="d318" class="mw lp it ni b gy nr nn l no np">    pipe_lr.fit(X_train, y_train_std)</span><span id="9d8d" class="mw lp it ni b gy nr nn l no np">    y_train_pred_std = pipe_lr.predict(X_train)<br/>    y_test_pred_std = pipe_lr.predict(X_test)</span><span id="167a" class="mw lp it ni b gy nr nn l no np">    y_train_pred = sc_y.inverse_transform(y_train_pred_std)<br/>    y_test_pred = sc_y.inverse_transform(y_test_pred_std)</span><span id="5b38" class="mw lp it ni b gy nr nn l no np">    train_score = np.append(train_score, r2_score(y_train, y_train_pred))<br/>    test_score = np.append(test_score, r2_score(y_test, y_test_pred))</span></pre><h2 id="c4d0" class="mw lp it bd lq mx my dn lu mz na dp ly kv nb nc mc kz nd ne mg ld nf ng mk iz bi translated">4.模型训练、测试和评估的输出</h2><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ns"><img src="../Images/ac8cec025bc86c1d3723eba3bb6b670f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BbcNDWba-kfsxYJ-nWAZA.png"/></div></div></figure><p id="b853" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">总之，我们已经展示了如何使用交叉评估来评估机器学习模型的性能。交叉验证计算的结果可以很好地估计模型在部署到生产中并根据真实的未知数据进行测试时的准确性。因此，交叉验证是一种非常强大的技术，可以帮助我们获得模型泛化误差的可靠估计，即模型对未知数据的表现如何。</p><h1 id="7581" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">参考</h1><ol class=""><li id="7d20" class="nt nu it km b kn mm kr mn kv nv kz nw ld nx lh ny nz oa ob bi translated"><a class="ae li" href="https://medium.com/towards-artificial-intelligence/training-a-machine-learning-model-on-a-dataset-with-highly-correlated-features-debddf5b2e34" rel="noopener">在具有高度相关特征的数据集上训练机器学习模型</a>。</li><li id="f491" class="nt nu it km b kn oc kr od kv oe kz of ld og lh ny nz oa ob bi translated"><a class="ae li" href="https://medium.com/towards-artificial-intelligence/feature-selection-and-dimensionality-reduction-using-covariance-matrix-plot-b4c7498abd07" rel="noopener">使用协方差矩阵图进行特征选择和降维</a>。</li><li id="580a" class="nt nu it km b kn oc kr od kv oe kz of ld og lh ny nz oa ob bi translated">拉什卡、塞巴斯蒂安和瓦伊德·米尔贾利利<strong class="km jd">。</strong> <em class="oh"> Python机器学习，第二版</em>。Packt出版公司，2017年。</li><li id="fa75" class="nt nu it km b kn oc kr od kv oe kz of ld og lh ny nz oa ob bi translated">Benjamin O. Tayo，<em class="oh">预测船只船员规模的机器学习模型</em>，<a class="ae li" href="https://github.com/bot13956/ML_Model_for_Predicting_Ships_Crew_Size" rel="noopener ugc nofollow" target="_blank">https://github . com/bot 13956/ML _ Model _ for _ Predicting _ Ships _ Crew _ Size</a>。</li></ol></div></div>    
</body>
</html>