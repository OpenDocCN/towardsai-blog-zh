<html>
<head>
<title>Complete Guide to Pandas Dataframe With Real-time Use Case</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据框架完整指南及实时使用案例</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/complete-guide-to-pandas-dataframe-with-real-time-use-case-c576d3e20fb3?source=collection_archive---------0-----------------------#2022-09-08">https://pub.towardsai.net/complete-guide-to-pandas-dataframe-with-real-time-use-case-c576d3e20fb3?source=collection_archive---------0-----------------------#2022-09-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="fc2d" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在我的Pyspark系列——读者对Pyspark数据框架和Pyspark RDD最感兴趣——之后，我收到了一些建议和请求，要求我在Pandas数据框架上写作，这样人们就可以在Pyspark和Pandas之间进行比较，而不是在消费方面，而是在语法方面。所以今天在这篇文章中，我们将使用泰坦尼克号数据集集中讨论熊猫数据框架的功能。</p></blockquote><p id="33ca" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> <em class="js">熊猫</em>T3】参考面板数据/ Python数据分析。一般来说，Pandas是一个用于处理数据集的python库。</strong></p><p id="6959" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">熊猫中的<strong class="jt ir"> <em class="js"> DataFrame </em> </strong>是一个二维的数据结构或者是一个有行和列的表格。DataFrames提供了创建、分析、清理、浏览和操作数据的功能。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/b2a0abdf2b21c39a820668f91d78d9bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hryXSP4nL2IExot7ymZndA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">资料来源:pandas.pydata.org</figcaption></figure><p id="f7c5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">安装:</strong></p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="c4d8" class="ln lo iq lj b gy lp lq l lr ls">pip install pandas</span></pre><p id="a4de" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">进口熊猫:</strong></p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="0d4a" class="ln lo iq lj b gy lp lq l lr ls">import pandas as pd<br/>print(pd.__version__)</span></pre><p id="2197" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如果Pandas安装成功，这将打印Pandas版本。</p><p id="1d3e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">创建数据帧:</strong></p><p id="5c22" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">创建一个空的数据框架—</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="181f" class="ln lo iq lj b gy lp lq l lr ls">df=pd.DataFrame()<br/>df.head(5) # prints first 5 rows in DataFrame</span></pre><p id="52c0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">从字典中创建数据帧—</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="ce2e" class="ln lo iq lj b gy lp lq l lr ls">employees = {'Name':['chandu','rohith','puppy'],'Age':[26,24,29],'salary':[180000,130000,240000]}</span><span id="1b62" class="ln lo iq lj b gy lt lq l lr ls">df = pd.DataFrame(employees)<br/>df.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/bfe1b5e0203f0fc54ae7da8bb4b429f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*EebdoGk8z6F3XlMvBwW8yg.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="d3b6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">从列表的列表中创建数据帧—</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="b224" class="ln lo iq lj b gy lp lq l lr ls">employees = [['chandu',26,180000], ['rohith', 24, 130000],['puppy', 29 ,240000]]</span><span id="9f1a" class="ln lo iq lj b gy lt lq l lr ls">df = pd.DataFrame(employees, columns=["Name","Age","Salary"])<br/>df.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/bfe1b5e0203f0fc54ae7da8bb4b429f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*EebdoGk8z6F3XlMvBwW8yg.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="7d73" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">从CSV文件导入数据这里提到<a class="ae lv" href="https://github.com/muttinenisairohith/Encoding-Categorical-Data/blob/e59a04b303662effb037981fb47211450973c2a0/data/titanic_train.csv" rel="noopener ugc nofollow" target="_blank"><strong class="jt ir"/></a><strong class="jt ir">。</strong></p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="23fe" class="ln lo iq lj b gy lp lq l lr ls">df = pd.read_csv("/content/titanic_train.csv")</span><span id="838c" class="ln lo iq lj b gy lt lq l lr ls">df.head(5)</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lw"><img src="../Images/8c3914de3b0339bfdcff4d86a917fc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TVpB471nxeTY_Q6PcKIDVA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:数据来自泰坦尼克号数据集</figcaption></figure><p id="0200" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如上图所示，<strong class="jt ir"> <em class="js"> df.head(n) </em> </strong>将返回DataFrame的前n行，而<strong class="jt ir"> <em class="js"> df.tail(n) </em> </strong>将返回DataFrame的后n行。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="59d1" class="ln lo iq lj b gy lp lq l lr ls">print(df.shape)  #prints the shape of DataFrame - rows * columns</span><span id="7278" class="ln lo iq lj b gy lt lq l lr ls">print(df.columns)  #returns the column names</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lx"><img src="../Images/35001d0fc80c871bf82daddd3c2fc268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ASpryQIQUZ04BRXXJVbfYw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="fc9b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> value_counts()— </strong>返回特定列中的唯一值及其计数。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="768a" class="ln lo iq lj b gy lp lq l lr ls">df["Embarked"].value_counts()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/524aeaf17c5aa77ed452ab11d6c6ee13.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*5npQoZfplpxRwxj7VwuP0Q.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="23eb" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> df.describe() — </strong>获取数据帧中所有数字列的信息</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="1326" class="ln lo iq lj b gy lp lq l lr ls">df.describe()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lz"><img src="../Images/dee9ca07821d236b67419fca30224b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AEkaiYa-Ed0EuZDO6_100g.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="98d9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> df.info() — </strong>返回DataFrame中所有列的计数和数据类型</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="90fd" class="ln lo iq lj b gy lp lq l lr ls">df.info()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/a10b84960a5ff3867a0f05269429f098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*kXG3-QGPP_u4v57frdhd6w.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="4c6c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如上所述，有年龄和客舱计数小于891，所以在这些列中可能会有丢失的值。我们还可以看到数据帧中列的数据类型。</p><p id="2707" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">处理缺失值</strong></p><p id="b6ad" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">获取缺失值的计数—</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="c8c8" class="ln lo iq lj b gy lp lq l lr ls">df.isnull().sum()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/564360393c60fe34f1d7ca53c2de3029.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*iqR1j0V_uUIWjBaMGjQYDg.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="282f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如上所示，列“年龄”、“客舱”和“已上船”缺少值。</p><p id="79db" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">得到缺失值的百分比—</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="05b8" class="ln lo iq lj b gy lp lq l lr ls">df.isnull().sum() / df.shape[0] * 100</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/d9eb68eec160722ef2454b55bf498144.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*cKFXaxnhrtW-k6OEZDvV4g.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="09b0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如我们所见，Cabin的缺失值百分比超过75%,所以让我们删除该列。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="9d89" class="ln lo iq lj b gy lp lq l lr ls">df=df.drop(['Cabin'],axis=1)</span></pre><p id="70e2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">上述命令用于从DataFrame中删除某些列。</p><p id="5e4f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">输入缺失值</strong></p><p id="c5e5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">让我们用平均值来估算年龄栏中缺失的值。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="17e4" class="ln lo iq lj b gy lp lq l lr ls">df['Age'].fillna(df['Age'].mean(),inplace=True)</span></pre><p id="efb1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">并通过模式值来估算装载列中的缺失值。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="bffa" class="ln lo iq lj b gy lp lq l lr ls">df['Embarked'].fillna(df['Embarked'].mode().item(),inplace=True)</span></pre><p id="20d1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在上面的例子中。item()在我们处理字符串列时使用。我想所有丢失的值都被处理了，让我们检查一下—</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi md"><img src="../Images/a5f5d0ad8e11ece0478f9e07afeb42a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*W6LWS3OPL1yBiPR1Lu0urQ.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="8a7d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">重命名列</strong></p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="0d31" class="ln lo iq lj b gy lp lq l lr ls">df=df.rename(columns={'Sex':'Gender','Name':'Full Name'})<br/>df.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi me"><img src="../Images/bb3642a30d283c315ca84e35c9381ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ny76_blZiZDkSXDUbR2iBA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="7434" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">添加/修改栏目</strong></p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="c7a7" class="ln lo iq lj b gy lp lq l lr ls">df['last_name']=df['Full Name'].apply(lambda x: x.split(',')[0])</span><span id="a53c" class="ln lo iq lj b gy lt lq l lr ls">df['first_name']=df['Full Name'].apply(lambda x: ' '.join(x.split(',')[1:]))</span><span id="f0c6" class="ln lo iq lj b gy lt lq l lr ls">df.head(5)</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mf"><img src="../Images/4f73f9619eb229cf649d009450f98929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bilcMJ3zzbpfurTnssg1AQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="aea8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">添加行— </strong>我们使用<em class="js"> df.append() </em>方法来添加行</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="5238" class="ln lo iq lj b gy lp lq l lr ls">row=dict({'Age':24,'Full Name':'Rohith','Survived':'Y'})</span><span id="b956" class="ln lo iq lj b gy lt lq l lr ls">df=df.append(row,ignore_index=True)</span><span id="84a4" class="ln lo iq lj b gy lt lq l lr ls">df.tail()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mg"><img src="../Images/7b933f95f040cb83ee6903e126825195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9CHgxGTdcDznvQPjrZnHuA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="1f85" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">创建一个新行，并为没有值的列初始化NaN值</p><p id="1338" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用loc()方法:</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="f16b" class="ln lo iq lj b gy lp lq l lr ls">df.loc[len(df.index)]=row<br/>df.tail()</span></pre><p id="9f98" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">删除行</strong></p><p id="7e14" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用df.index()方法—</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="c3fa" class="ln lo iq lj b gy lp lq l lr ls">df=df.drop(df.index[-1],axis=0) <em class="js"># Deletes last row</em><br/>df.head()</span></pre><p id="3567" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">编码列</strong></p><p id="df46" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">对于大多数机器学习算法，我们应该有数字数据，而不是字符串格式的数据。所以编码数据是必须的操作。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="9ced" class="ln lo iq lj b gy lp lq l lr ls">df['Gender']=df['Gender'].map({"male":'0',"female":"1"})</span><span id="7fb0" class="ln lo iq lj b gy lt lq l lr ls">df.head(5)</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mh"><img src="../Images/5ccafe498b729a2be3ab0aaae8175d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_81Rg2O516JJbF8XXhzZA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="dd84" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如果我们使用上面的方法，这个过程对于所有的列都变得非常繁忙，因此有许多方法可以用来编码数据帧，例如LabelEncoder、OneHotEncoder和MultiColumnLabelEncoder。它们在下面的文章中有清楚的解释—</p><div class="mi mj gp gr mk ml"><a href="https://blog.devgenius.io/encoding-methods-to-encode-categorical-data-in-machine-learning-717b5509933c" rel="noopener  ugc nofollow" target="_blank"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd ir gy z fp mq fr fs mr fu fw ip bi translated">机器学习中分类数据的编码方法</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">在机器学习领域，在进行建模之前，数据准备是一项强制性任务。有…</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">blog.devgenius.io</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz lc ml"/></div></div></a></div><p id="a031" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">过滤数据</strong></p><p id="1c63" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">仅在年龄大于25时选择数据。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="5aeb" class="ln lo iq lj b gy lp lq l lr ls">df[df["Age"]&gt; 25].head(5)</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi na"><img src="../Images/cd4e269fdf92acba9139f75fdf964241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eC62us7UJvVnLe46_ntLlQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="1dcf" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">同样我们可以使用&gt;，&lt; and == operations.</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="0008" class="ln lo iq lj b gy lp lq l lr ls">df[(df["Age"]&lt; 25) &amp; (df["Gender"]=="1")].head(5)</span></pre><p id="d9a2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">selecting data when Age is less than 25 and Gender is 1. In the above way, we can also filter multiple columns.</p><p id="1b75" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> apply()函数</strong>:</p><p id="dd44" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">假设15岁以下，60岁以上的人要先被救。让我们使用<em class="js"> apply() </em>函数创建一个<em class="js"> save_first </em>列。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="4898" class="ln lo iq lj b gy lp lq l lr ls">def save_first(age):<br/>    if age&lt;15:<br/>        return 1<br/>    elif age&gt;=15 and age&lt;60:<br/>        return 0<br/>    elif age&gt;=60:<br/>        return 1</span><span id="b6d7" class="ln lo iq lj b gy lt lq l lr ls">df['save_first']=df['Age'].apply(lambda x: save_first(x))</span></pre><p id="e2f3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">选择特定的列和行:</strong></p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="34c1" class="ln lo iq lj b gy lp lq l lr ls">df_1 = df[['Age','Survived','Gender']]</span><span id="3aac" class="ln lo iq lj b gy lt lq l lr ls">df_1.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nb"><img src="../Images/b050b6c4437a0c9440f4121f8029b647.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*xN1aYxXK4wEVRmOhVYyoNw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="fd3f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用<strong class="jt ir">。iloc() — </strong>它使用数字索引返回数据帧中的特定行和列</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="029c" class="ln lo iq lj b gy lp lq l lr ls">df_2 = df.iloc[0:100,:]</span><span id="d753" class="ln lo iq lj b gy lt lq l lr ls">df_2.head()</span></pre><p id="b097" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">返回DataFrame中的前100行和所有列</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="88aa" class="ln lo iq lj b gy lp lq l lr ls">df_2 = df.iloc[0:100, [0,1,2]]</span><span id="d7fc" class="ln lo iq lj b gy lt lq l lr ls">df_2.head()</span></pre><p id="2dac" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">返回数据帧中的前100行和前3列</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/c52d9aa12d1a27d74f2e857d5928675d.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*iFrs2bcQJWRo-c-Su8HxcQ.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="3a45" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">。loc() </strong>功能—类似于。iloc()，但是它使用列名而不是数字索引。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="c4de" class="ln lo iq lj b gy lp lq l lr ls">df_2 = df.loc[0:100, ['Age','Survived','Gender']]</span><span id="411e" class="ln lo iq lj b gy lt lq l lr ls">df_2.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3355b3981383fbaaec5bb6d02bb3d5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*NpKHXlpHTqlJzhPo-KQLUA.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="d7f0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">排序</strong></p><p id="cb0d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">我们可以使用<strong class="jt ir"><em class="js">sort _ values</em>()</strong>方法在DataFrame中进行排序操作。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="0cc1" class="ln lo iq lj b gy lp lq l lr ls">df=df.sort_values(by=['Age'],ascending=False)</span><span id="0640" class="ln lo iq lj b gy lt lq l lr ls">df.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lw"><img src="../Images/51ff6c579ebcb0a92fa0b3c8aeccaec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3vTEr06N0oN7rR2zuCp4Q.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="cf38" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">我们也可以使用多列——首先按第一列排序，然后按第二列排序。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="ed46" class="ln lo iq lj b gy lp lq l lr ls">df=df.sort_values(by=['Age', 'Survived'],ascending=False)</span><span id="9bf9" class="ln lo iq lj b gy lt lq l lr ls">df[15:20]</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ne"><img src="../Images/3164ad83ed0443408a7f914f95ef0a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lkz0BfubeI-L9dqfnxCbaQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="e01f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">加入</strong></p><p id="c466" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">Join只不过是基于特定的列组合多个数据帧。</p><p id="1142" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">让我们执行5种类型的连接——交叉、内部、左侧、右侧和外部</p><p id="f828" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> <em class="js">交叉连接</em> </strong> <em class="js"> — </em>也称为笛卡尔连接，返回每个表中行的所有组合。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="8b0d" class="ln lo iq lj b gy lp lq l lr ls">cross_join = pd.merge( df1 , df2 ,how='cross')</span></pre><p id="090f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> <em class="js">内部连接</em> </strong> <em class="js"> — </em>只返回那些在两个数据帧中都有匹配值的行。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="a1dd" class="ln lo iq lj b gy lp lq l lr ls">inner_join = pd.merge( df1 , df2 ,how='inner', on='column_name')</span></pre><p id="f127" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> <em class="js">左连接</em> </strong> <em class="js"> — </em>返回第一个数据帧的所有行，如果没有匹配的值，则返回第二个数据帧的空值</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="5521" class="ln lo iq lj b gy lp lq l lr ls">left_join = pd.merge( df1 , df2 ,how='left', on='column_name')</span></pre><p id="d797" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> <em class="js">右连接</em> </strong> <em class="js"> — </em>返回第二个数据帧的所有行。如果没有匹配的值，那么它为第一个数据帧返回空值</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="5a17" class="ln lo iq lj b gy lp lq l lr ls">right_join = pd.merge( df1 , df2 ,how='right', on='column_name')</span></pre><p id="3d86" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> <em class="js">外部连接</em> </strong> <em class="js"> — </em>返回第一个和第二个数据帧的所有行。如果第一个数据帧中没有匹配，第二个数据帧中的值将为空，反之亦然</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="ee57" class="ln lo iq lj b gy lp lq l lr ls">outer_join = pd.merge( df1 , df2 ,how='outer', on='column_name')</span></pre><p id="625d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir"> GroupBy() </strong></p><p id="fb8e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">此方法用于根据几列对数据帧进行分组。</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="b47c" class="ln lo iq lj b gy lp lq l lr ls">groups = df.groupby(['Survived'])</span><span id="047b" class="ln lo iq lj b gy lt lq l lr ls">groups.get_group(1)</span></pre><p id="d4dc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">get_group()方法用于获取属于某个组的数据。</p><p id="dc15" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">GroupBy()通常与mean()、min()、max()等数学函数一起使用。,</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="8713" class="ln lo iq lj b gy lp lq l lr ls">groups['Age'].mean()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/21b1650cfb50a530cc56d509a2038e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*yNY84jLwBTF4oO-w5hZifA.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="bac5" class="ln lo iq lj b gy lp lq l lr ls">groups['Age'].count()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/cc4d4e5281a8e86188840318f16694c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*30LUE6Y0txgWRn4yfZnTwQ.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="40ec" class="ln lo iq lj b gy lp lq l lr ls">groups['Age'].min()<br/>groups['Age'].max()</span></pre><p id="48da" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用<strong class="jt ir">。</strong>函数agg()</p><pre class="kt ku kv kw gt li lj lk ll aw lm bi"><span id="0056" class="ln lo iq lj b gy lp lq l lr ls">import numpy as np</span><span id="753e" class="ln lo iq lj b gy lt lq l lr ls">group_agg =df.groupby(['Survived']).agg({'Age':lambda x: np.mean(x)})</span><span id="c192" class="ln lo iq lj b gy lt lq l lr ls">group_agg.head()</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi nh"><img src="../Images/08cbc5911a2c7fe42e4034fb29efa4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5o8Gz-42Np8ECwHEf52vZw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">来源:产出</figcaption></figure><p id="f292" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">所以我想我已经涵盖了与熊猫数据框架相关的大部分基本概念。</p><p id="cee3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">快乐编码…</p></div></div>    
</body>
</html>