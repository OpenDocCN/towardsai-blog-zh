<html>
<head>
<title>Predicting Heart Failure Survival with Machine Learning Models — Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习模型预测心力衰竭存活率——第一部分</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/predicting-heart-failure-survival-with-machine-learning-models-part-i-7ff1ab58cff8?source=collection_archive---------0-----------------------#2020-08-25">https://pub.towardsai.net/predicting-heart-failure-survival-with-machine-learning-models-part-i-7ff1ab58cff8?source=collection_archive---------0-----------------------#2020-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c2e56690b2bf36763d5c65d9cba62f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBRYys-rO_HlD2XGt00ckw.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://wallpapercave.com/w/wp2314623" rel="noopener ugc nofollow" target="_blank">壁纸洞穴</a></figcaption></figure><h2 id="8d92" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>，<a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="8659" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">一步一步的pythonic式的生存数据分析，以及领域级的解释。</h2></div><h1 id="0329" class="lh li jj bd lj lk ll lm ln lo lp lq lr ky ls kz lt lb lu lc lv le lw lf lx ly bi translated">前言</h1><p id="fc1c" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">心血管疾病是心脏和血管的疾病，通常包括心脏病发作、中风和心力衰竭[1]。根据世界卫生组织(世卫组织)的数据，在过去的十五年里，缺血性心脏病和中风等心血管疾病已经成为全球范围内的主要死亡原因[2]。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="869d" class="lh li jj bd lj lk nc lm ln lo nd lq lr ky ne kz lt lb nf lc lv le ng lf lx ly bi translated">动机</h1><p id="ebab" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">几个月前，一个新的心力衰竭数据集被上传到<a class="ae jg" href="https://www.kaggle.com/andrewmvd/heart-failure-clinical-data" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上。该数据集包含299名匿名患者的健康记录，有12个临床和生活方式特征。任务是使用这些特征来预测心力衰竭。</p><p id="7d35" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">通过这篇文章，我的目标是记录我在这个任务上的工作流程，并把它作为一个研究练习来展示。因此，这自然会涉及一些领域知识，参考期刊论文，并从中获得见解。</p><p id="94c4" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">警告:这篇文章将近10分钟长，当你向下滚动时，内容可能会变得有点密集，但我鼓励你尝试一下。</em></p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="e5e6" class="lh li jj bd lj lk nc lm ln lo nd lq lr ky ne kz lt lb nf lc lv le ng lf lx ly bi translated">关于数据</h1><p id="821a" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">该数据集最初由Ahmed等人在2017年发布[3]，作为对他们在巴基斯坦费萨拉巴德心脏病研究所和联合医院的心力衰竭患者存活率分析的补充。Chicco和Jurman随后在2020年访问并分析了该数据集，以使用一系列机器学习技术预测心力衰竭[4]。Kaggle上的数据集引用了这些作者和他们的研究论文。</p><p id="2e3f" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">数据集主要由105名女性和194名男性心力衰竭患者的临床和生活方式特征组成。您可以在下图中找到每个功能的解释。</p><figure class="no np nq nr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nn"><img src="../Images/90371d574d50098b8dda0c8b9b5f961d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLpJUHm7hiQC3dRp_k5t0g.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图1-数据集中299名患者的临床和生活方式特征(作者)</figcaption></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="654f" class="lh li jj bd lj lk nc lm ln lo nd lq lr ky ne kz lt lb nf lc lv le ng lf lx ly bi translated">项目工作流程</h1><p id="61f4" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">工作流程会非常简单——</p><ol class=""><li id="3835" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu nx ny nz oa bi translated"><strong class="mb jt">数据预处理— </strong>清理数据、输入缺失值、根据需要创建新特征等。</li><li id="2f3d" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu nx ny nz oa bi translated"><strong class="mb jt">探索性数据分析— </strong>这将涉及汇总统计、绘制关系、绘制趋势等。</li><li id="176b" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu nx ny nz oa bi translated"><strong class="mb jt">模型构建— </strong>构建基线预测模型，之后至少2个分类模型进行训练和测试。</li><li id="8444" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu nx ny nz oa bi translated"><strong class="mb jt">超参数调整— </strong>微调每个模型的超参数，以达到可接受的预测指标水平。</li><li id="55ba" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu nx ny nz oa bi translated"><strong class="mb jt">整合结果— </strong>以清晰简洁的方式展示相关调查结果。</li></ol><p id="65a5" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">整个项目可以在我的</em><a class="ae jg" href="https://github.com/ani-rudra-chan/Heart-Failure-Survival-Project.git" rel="noopener ugc nofollow" target="_blank"><em class="nm">GitHub</em></a><em class="nm">资源库中作为Jupyter笔记本找到。</em></p><h2 id="cf45" class="og li jj bd lj oh oi dn ln oj ok dp lr mi ol om lt mm on oo lv mq op oq lx jp bi translated">让我们开始吧！</h2></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="1e31" class="lh li jj bd lj lk nc lm ln lo nd lq lr ky ne kz lt lb nf lc lv le ng lf lx ly bi translated">数据预处理</h1><p id="a6fd" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">让我们看看报纸。csv文件转换成数据帧—</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="8072" class="og li jj os b gy ow ox l oy oz">df = pd.read_csv('heart_failure_clinical_records_dataset.csv')</span></pre><p id="d223" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><code class="fe pa pb pc os b">df.info()</code>是一种快速获取dataframe数据类型摘要的方法。我们看到数据集没有丢失或虚假的值，并且足够干净，可以开始数据探索。</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="6088" class="og li jj os b gy ow ox l oy oz">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 299 entries, 0 to 298<br/>Data columns (total 13 columns):<br/> #   Column                    Non-Null Count  Dtype  <br/>---  ------                    --------------  -----  <br/> 0   age                       299 non-null    float64<br/> 1   anaemia                   299 non-null    int64  <br/> 2   creatinine_phosphokinase  299 non-null    int64  <br/> 3   diabetes                  299 non-null    int64  <br/> 4   ejection_fraction         299 non-null    int64  <br/> 5   high_blood_pressure       299 non-null    int64  <br/> 6   platelets                 299 non-null    float64<br/> 7   serum_creatinine          299 non-null    float64<br/> 8   serum_sodium              299 non-null    int64  <br/> 9   sex                       299 non-null    int64  <br/> 10  smoking                   299 non-null    int64  <br/> 11  time                      299 non-null    int64  <br/> 12  DEATH_EVENT               299 non-null    int64  <br/>dtypes: float64(3), int64(10)<br/>memory usage: 30.5 KB</span></pre><p id="52ed" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">但在此之前，让我们重新排列和重命名一些特性，添加另一个名为<code class="fe pa pb pc os b">chk</code>(稍后在EDA 中会有用的<em class="nm">)的特性，并用标签替换分类特性中的二进制值(再次使用<em class="nm">，在EDA </em>中会有用)。</em></p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="d603" class="og li jj os b gy ow ox l oy oz">df = df.rename(columns={'smoking':'smk',<br/>                        'diabetes':'dia',<br/>                        'anaemia':'anm',<br/>                        'platelets':'plt',<br/>                        'high_blood_pressure':'hbp',<br/>                        'creatinine_phosphokinase':'cpk',<br/>                        'ejection_fraction':'ejf',<br/>                        'serum_creatinine':'scr',<br/>                        'serum_sodium':'sna',<br/>                        'DEATH_EVENT':'death'})</span><span id="c6cc" class="og li jj os b gy pd ox l oy oz">df['chk'] = 1</span><span id="84ea" class="og li jj os b gy pd ox l oy oz">df['sex'] = df['sex'].apply(lambda x: 'Female' if x==0 else 'Male')<br/>df['smk'] = df['smk'].apply(lambda x: 'No' if x==0 else 'Yes')<br/>df['dia'] = df['dia'].apply(lambda x: 'No' if x==0 else 'Yes')<br/>df['anm'] = df['anm'].apply(lambda x: 'No' if x==0 else 'Yes')<br/>df['hbp'] = df['hbp'].apply(lambda x: 'No' if x==0 else 'Yes')<br/>df['death'] = df['death'].apply(lambda x: 'No' if x==0 else 'Yes')</span><span id="d9cc" class="og li jj os b gy pd ox l oy oz">df.info()</span><span id="fa85" class="og li jj os b gy pd ox l oy oz">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 299 entries, 0 to 298<br/>Data columns (total 14 columns):<br/> #   Column  Non-Null Count  Dtype  <br/>---  ------  --------------  -----  <br/> 0   sex     299 non-null    object <br/> 1   age     299 non-null    float64<br/> 2   smk     299 non-null    object <br/> 3   dia     299 non-null    object <br/> 4   hbp     299 non-null    object <br/> 5   anm     299 non-null    object <br/> 6   plt     299 non-null    float64<br/> 7   ejf     299 non-null    int64  <br/> 8   cpk     299 non-null    int64  <br/> 9   scr     299 non-null    float64<br/> 10  sna     299 non-null    int64  <br/> 11  time    299 non-null    int64  <br/> 12  death   299 non-null    object <br/> 13  chk     299 non-null    int64  <br/>dtypes: float64(3), int64(5), object(6)<br/>memory usage: 32.8+ KB</span></pre><p id="89d4" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">我们观察到，<code class="fe pa pb pc os b">sex</code>、<code class="fe pa pb pc os b">dia</code>、<code class="fe pa pb pc os b">anm</code>、<code class="fe pa pb pc os b">hbp</code>、<code class="fe pa pb pc os b">smk</code>和<code class="fe pa pb pc os b">death</code>是类别特征(<em class="nm">宾语</em>)，而<code class="fe pa pb pc os b">age</code>、<code class="fe pa pb pc os b">plt</code>、<code class="fe pa pb pc os b">cpk</code>、<code class="fe pa pb pc os b">ejf</code>、<code class="fe pa pb pc os b">scr</code>、<code class="fe pa pb pc os b">time</code>和<code class="fe pa pb pc os b">sna</code>是数值特征(<em class="nm"> int64或float64 </em>)。除了<code class="fe pa pb pc os b">death</code>之外的所有特征都将是潜在的预测器，而<code class="fe pa pb pc os b">death</code>将是我们的预期ML模型的目标。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="69f2" class="lh li jj bd lj lk nc lm ln lo nd lq lr ky ne kz lt lb nf lc lv le ng lf lx ly bi translated">探索性数据分析</h1><h2 id="f89e" class="og li jj bd lj oh oi dn ln oj ok dp lr mi ol om lt mm on oo lv mq op oq lx jp bi translated">A.数字特征的汇总统计</h2><p id="3cc8" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">由于我们的数据集有许多数字特征，借助于<code class="fe pa pb pc os b">df.describe()</code> ( <em class="nm">通常，这种方法给出最多6位小数的值，因此最好通过</em> <code class="fe pa pb pc os b">df.describe().round(2)</code> <em class="nm"> ) </em>将其四舍五入为两位，这将有助于查看手头数据的一些聚合度量</p><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/3f501ea5938ce8ea0f3187585df276c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*wmCW3p9x7KIeBZV0VKA71w.jpeg"/></div></figure><ul class=""><li id="e40f" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu pf ny nz oa bi translated"><strong class="mb jt">年龄</strong>:我们可以看到患者的平均年龄是60岁，大多数患者(&lt; 75%)在70岁以下，40岁以上。他们心力衰竭后的随访时间也从4天到285天不等，平均为130天。</li><li id="378a" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">血小板</strong> : <em class="nm">这是一种负责修复受损血管的血细胞。</em>正常人的血小板计数为150，000–400，000千血小板/毫升血液[5]。<strong class="mb jt">在我们的数据集中，75%的患者的血小板计数都在这个范围内。</strong></li><li id="ae6b" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">射血分数</strong> : <em class="nm">这是对每次收缩中从心室中泵出的血液量的度量(单位为%)。复习一下人体解剖学——心脏有4个腔室，其中心房接收来自身体不同部位的血液，心室将血液泵回心脏。左心室是最厚的腔室，将血液泵送到身体的其他部位，而右心室将血液泵送到肺部。</em>在健康成人中，该分数为55%，射血分数降低的心力衰竭意味着该值为&lt;40%【6】。在我们的数据集中，<strong class="mb jt"> 75%的患者具有该值&lt; 45% </strong>，这是意料之中的，因为他们首先都是心力衰竭患者。</li><li id="7654" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">肌酸酐磷酸激酶</strong> : <em class="nm">这是一种存在于血液中的酶，有助于修复受损组织。高水平的CPK意味着心力衰竭或损伤。</em>男性的正常水平为55–170微克/升，女性为30–135微克/升【7】。在我们的数据集中，由于所有患者都患有心力衰竭，<strong class="mb jt">平均值(550 mcg/L)和中位数(250 mcg/L)都高于正常值。</strong></li><li id="03fa" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">血清肌酸酐</strong> : <em class="nm">这是肌肉新陈代谢的一部分产生的废物，尤其是在肌肉分解过程中。这种肌酐被肾脏过滤，升高的水平表明心输出量不良和可能的肾衰竭</em>【8】。正常水平在0.84到1.21毫克/分升之间[9]，在我们的数据集中，平均值和中值都在1.10毫克/分升以上，这<strong class="mb jt">非常接近正常范围的上限</strong>。</li><li id="f359" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">血清钠</strong> : <em class="nm">这是指血液中的钠水平，135 mEq/L的高水平被称为高钠血症，这被认为是心力衰竭患者的典型症状</em> [10]。在我们的数据集中，我们发现平均值和中位数是<strong class="mb jt"> &gt; 135 mEq/L </strong>。</li></ul><p id="4e7b" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">直观显示这些统计数据的一个简洁方法是使用<code class="fe pa pb pc os b">boxenplot</code>来显示数值的分布和分布(<em class="nm">中间的线是中值，末端的菱形是异常值</em>)。</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="844f" class="og li jj os b gy ow ox l oy oz">fig,ax = plt.subplots(3,2,figsize=[10,10])<br/>num_features_set1 = ['age', 'scr', 'sna']<br/>num_features_set2 = ['plt', 'ejf', 'cpk']<br/>for i in range(0,3):<br/>    sns.boxenplot(df[num_features_set1[i]], ax=ax[i,0], color='steelblue')<br/>    sns.boxenplot(df[num_features_set2[i]], ax=ax[i,1], color='steelblue')</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/7f44325399bbcfe83a469c31a45d78a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*P7CiC2kGfp1a-Uj3tyaqGA.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图2 —显示数据集数字特征的汇总统计数据</figcaption></figure><h2 id="7a6a" class="og li jj bd lj oh oi dn ln oj ok dp lr mi ol om lt mm on oo lv mq op oq lx jp bi translated">B.分类特征的汇总统计</h2><p id="6cde" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">属于每个生活方式分类特征的患者数量可以用一个简单的<code class="fe pa pb pc os b">bar plot</code>进行总结。</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="3d2b" class="og li jj os b gy ow ox l oy oz">fig = plt.subplots(figsize=[10,6])</span><span id="4eef" class="og li jj os b gy pd ox l oy oz">bar1 = df.smk.value_counts().values<br/>bar2 = df.hbp.value_counts().values<br/>bar3 = df.dia.value_counts().values<br/>bar4 = df.anm.value_counts().values<br/>ticks = np.arange(0,3, 2)<br/>width = 0.3<br/>plt.bar(ticks, bar1, width=width, color='teal', label='smoker')<br/>plt.bar(ticks+width, bar2, width=width, color='darkorange', label='high blood pressure')<br/>plt.bar(ticks+2*width, bar3, width=width, color='limegreen', label='diabetes')<br/>plt.bar(ticks+3*width, bar4, width=width, color='tomato', label='anaemic')</span><span id="4ecd" class="og li jj os b gy pd ox l oy oz">plt.xticks(ticks+1.5*width, ['Yes', 'No'])<br/>plt.ylabel('Number of patients')<br/>plt.legend()</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/292db815a5a0035e51380cff81a0a025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*a4cWuxaCN4lJQBevHweLbg.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图3——每种生活方式分类特征的患者总数</figcaption></figure><p id="3cc2" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">使用pandas中的<code class="fe pa pb pc os b">crosstab</code>功能可以生成额外的摘要。显示了分类特征<code class="fe pa pb pc os b">smk</code>的示例。结果可以根据吸烟者总数(<em class="nm">“指数”</em>)或死亡总数(<em class="nm">“列”</em>)进行标准化。因为我们的兴趣是预测生存，我们对死亡标准化。</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="4c43" class="og li jj os b gy ow ox l oy oz">pd.crosstab(index=df['smk'], columns=df['death'], values=df['chk'], aggfunc=np.sum, margins=True)</span><span id="8903" class="og li jj os b gy pd ox l oy oz">pd.crosstab(index=df['smk'], columns=df['death'], values=df['chk'], aggfunc=np.sum, margins=True, normalize='columns').round(2)*100</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/a8d359748a5c1a0c5b151ed9372399ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*1QH0KkO6UBhBUZSVxiaygw.jpeg"/></div></figure><p id="e7f7" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">我们看到68%的心力衰竭患者不吸烟，而32%的患者吸烟。在死亡的人中，69%不吸烟，31%吸烟。在<strong class="mb jt">幸存</strong>的人中，67%不吸烟，33%吸烟。在这一点上，很难说吸烟的心力衰竭患者有更大的死亡机会。</p><p id="cf08" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">以类似的方式，让我们总结其余的分类特征，并对死亡结果进行标准化。</p><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/2d9c4ec69dbbb7747a571d70a98dd934.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*kZla_MbHyUbZ0Cxq0YcjWA.jpeg"/></div></figure><ul class=""><li id="9899" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu pf ny nz oa bi translated">65%的男性和35%的女性心脏病患者死亡。</li><li id="eadf" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">48%死亡的患者贫血，而41%存活的患者也贫血。</li><li id="098c" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">42%死亡的患者和42%存活的患者是糖尿病患者。</li><li id="125e" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">31%的死者是吸烟者，而33%的幸存者是吸烟者。</li><li id="8389" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">41%的死亡者患有高血压，而33%的幸存者也患有高血压。</li></ul><p id="a67d" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">基于这些统计数据，我们得到了一个粗略的想法，即那些死去的人和幸存的人的生活方式特征分布几乎相似。这种差异在高血压的情况下最大，这可能对心脏病患者的生存有更大的影响。</p><h2 id="2039" class="og li jj bd lj oh oi dn ln oj ok dp lr mi ol om lt mm on oo lv mq op oq lx jp bi translated">C.探索数字特征之间的关系</h2><p id="9c9e" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">下一步是可视化特征之间的关系。我们从数字特征开始，编写一行代码，使用seaborn的<code class="fe pa pb pc os b">pairplot</code>绘制成对的特征图</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="3538" class="og li jj os b gy ow ox l oy oz">sns.pairplot(df[['plt', 'ejf', 'cpk', 'scr', 'sna', 'death']], <br/>             hue='death', palette='husl', corner=True)</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pk"><img src="../Images/6d9ea3ec76e25513a94846c112463c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTw4I8xJddlBL86pJqsKRg.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图4-数据集中数值特征之间的成对散点图</figcaption></figure><p id="f407" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">我们观察到一些有趣的现象—</p><ul class=""><li id="19c0" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu pf ny nz oa bi translated">大多数死于心力衰竭的患者的射血分数似乎比幸存的患者低。他们的血清肌酐和肌酸磷酸激酶水平似乎也略高。他们也倾向于80岁以上。</li><li id="5434" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">特征之间没有强相关性，这可以通过计算Spearman R相关系数来验证(<em class="nm">我们考虑Spearman，因为我们不确定从中提取特征值的总体分布</em>)。</li></ul><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="a8aa" class="og li jj os b gy ow ox l oy oz">df[['plt', 'ejf', 'cpk', 'scr', 'sna']].corr(method='spearman')</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/bc2a519c22b8a422e2e1a5c67e7dccce.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*tOL5jutxUmWh45zFMSicYg.jpeg"/></div></figure><ul class=""><li id="cc53" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu pf ny nz oa bi translated">正如所观察到的，对于<strong class="mb jt">年龄-血清肌酐</strong>和<strong class="mb jt">血清肌酐-血清钠</strong>，相关系数为<strong class="mb jt">适度鼓励</strong>。从文献中，我们看到随着年龄的增长，血清肌酐含量增加[11]，这解释了它们的<strong class="mb jt">略呈正相关</strong>。文献还告诉我们[12]，在慢性肾脏疾病的情况下，钠与血清肌酐的比率较高，这意味着两者之间存在<strong class="mb jt">负相关</strong>。轻微的负相关系数也暗示了患者中肾脏问题的患病率。</li></ul><h2 id="231b" class="og li jj bd lj oh oi dn ln oj ok dp lr mi ol om lt mm on oo lv mq op oq lx jp bi translated">D.探索分类特征之间的关系</h2><p id="5bae" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">关联分类特征的一种方法是创建一个数据透视表，并以特征的子集为中心。这将为我们提供特定特征值子集的值的数量。对于这个数据集，让我们来看看生活方式的特征——吸烟、贫血、高血压和糖尿病。</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="4023" class="og li jj os b gy ow ox l oy oz">lifestyle_surv = pd.pivot_table(df.loc[df.death=='No'], <br/>                                values='chk', <br/>                                columns=['hbp','dia'], <br/>                                index=['smk','anm'], <br/>                                aggfunc=np.sum)</span><span id="a161" class="og li jj os b gy pd ox l oy oz">lifestyle_dead = pd.pivot_table(df.loc[df.death=='Yes'], <br/>                                values='chk', <br/>                                columns=['hbp','dia'], <br/>                                index=['smk','anm'], <br/>                                aggfunc=np.sum)</span><span id="45af" class="og li jj os b gy pd ox l oy oz">fig, ax= plt.subplots(1, 2, figsize=[15,6])<br/>sns.heatmap(lifestyle_surv, cmap='Greens', annot=True, ax=ax[0])<br/>ax[0].set_title('Survivors')<br/>sns.heatmap(lifestyle_dead, cmap='Reds', annot=True, ax=ax[1])<br/>ax[1].set_title('Deceased')</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pm"><img src="../Images/e44b2ec1ac2b5d0c82b0384b70949d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iX7in7oL3eDxmt1U0a7nAA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5—每个生活方式特征子集的患者数量热图</figcaption></figure><p id="426c" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">可以得出一些见解——</p><ul class=""><li id="18db" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu pf ny nz oa bi translated">许多患者不吸烟，不贫血，也没有高血压或糖尿病。</li><li id="d631" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">很少有患者同时具备这四种生活方式。</li><li id="6561" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">许多幸存者要么只是吸烟者，要么只是糖尿病患者。</li><li id="6c1f" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">大多数死者没有生活方式的特征，或者最多是贫血。</li><li id="0104" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated">许多死者患有贫血和糖尿病。</li></ul><h2 id="24fd" class="og li jj bd lj oh oi dn ln oj ok dp lr mi ol om lt mm on oo lv mq op oq lx jp bi translated">E.探索所有功能之间的关系</h2><p id="c0de" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">将分类特征和数字特征组合成一个图的简单方法是绕过分类特征作为<code class="fe pa pb pc os b">hue</code>输入。在这种情况下，我们使用二元<code class="fe pa pb pc os b">death</code>特性并绘制violin-plots来可视化所有特性之间的关系。</p><pre class="no np nq nr gt or os ot ou aw ov bi"><span id="f937" class="og li jj os b gy ow ox l oy oz">fig,ax = plt.subplots(6, 5, figsize=[20,22])<br/>cat_features = ['sex','smk','anm', 'dia', 'hbp']<br/>num_features = ['age', 'scr', 'sna', 'plt', 'ejf', 'cpk']<br/>for i in range(0,6):<br/>    for j in range(0,5):<br/>        sns.violinplot(data=df, x=cat_features[j],y=num_features[i], hue='death', split=True, palette='husl',facet_kws={'despine':False}, ax=ax[i,j])<br/>        ax[i,j].legend(title='death', loc='upper center')</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pn"><img src="../Images/0f816ef19f3f8741dcc84baef8a3c17e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzsWRd9MnS0zu1sOZUY4nw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图6-用于关联数据集中的数字和分类特征的紫线图</figcaption></figure><p id="1908" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated">这是从这些图中得到的一些见解—</p><ul class=""><li id="bdb9" class="ns nt jj mb b mc nh mf ni mi nu mm nv mq nw mu pf ny nz oa bi translated"><strong class="mb jt">性别</strong>:死亡患者中，男性射血分数似乎低于女性。此外，肌酸酐磷酸激酶在男性中似乎高于女性。</li><li id="1ac6" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">吸烟</strong>:死亡的吸烟者的射血分数略低于死亡的非吸烟者。存活的吸烟者的肌酸酐磷酸激酶水平似乎高于存活的非吸烟者。</li><li id="0ea1" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">贫血</strong>:与非贫血患者相比，贫血患者往往具有较低的肌酸酐磷酸激酶水平和较高的血清肌酸酐水平。在贫血患者中，死亡患者的射血分数低于存活者。</li><li id="845e" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">糖尿病</strong>:糖尿病患者往往钠水平较低，同样，死亡患者的射血分数低于存活者。</li><li id="6bad" class="ns nt jj mb b mc ob mf oc mi od mm oe mq of mu pf ny nz oa bi translated"><strong class="mb jt">高血压</strong>:高血压死亡患者的射血分数似乎比无高血压死亡患者的射血分数变化更大。</li></ul></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="689a" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">我希望你觉得这有用。构建ML模型、调整超参数以及整合结果的步骤将在下一篇文章中展示。</em></p><p id="a8ea" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">再见！</em></p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="aca0" class="lh li jj bd lj lk nc lm ln lo nd lq lr ky ne kz lt lb nf lc lv le ng lf lx ly bi translated">参考</h1><p id="ae14" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><em class="nm">【1】</em><a class="ae jg" href="https://www.who.int/cardiovascular_diseases/world-heart-day/en/" rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . who . int/心血管_疾病/world-heart-day/en/ </em> </a></p><p id="cb2e" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【2】</em><a class="ae jg" href="https://www.who.int/gho/mortality_burden_disease/causes_death/top_10/en/" rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . who . int/gho/mortality _ burden _ disease/causes _ death/top _ 10/en/</em></a></p><p id="f808" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm"> [3] Ahmad T，Munir A，Bhatti SH，Aftab M，Ali Raza M .心力衰竭患者的生存分析:案例研究。数据集。</em><a class="ae jg" href="https://plos.figshare.com/" rel="noopener ugc nofollow" target="_blank">【https://plos.figshare.com/】</a><em class="nm">文章/生存_分析_心力衰竭_患者_病例_研究/ 5227684/1。</em></p><p id="bc2d" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm"> [4] Chicco和Jurman，BMC医学信息学和决策(2020) 20:16 </em></p><p id="3852" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【5】</em><a class="ae jg" href="https://www.hopkinsmedicine.org/heart_vascular_institute/centers_excellence/women_cardiovascular_health_center/patient_information/health_topics/platelets.html" rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . Hopkins medicine . org/heart _ vascular _ institute/centers _ Excellence/women _ cardio vascular _ health _ center/patient _ information/health _ topics/platelets . html</em></a></p><p id="fae3" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【6】</em><a class="ae jg" href="https://www.uwhealth.org/health/topic/special/heart-failure-with-reduced-ejection-fraction-systolic-heart-failure/tx4090abc.html#:~:text=A%20normal%20ejection%20fraction%20is,fraction%20is%2040%25%20or%20less." rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . uw health . org/health/topic/special/heart-failure-with-reduced-ejection-fraction-systolic-heart-failure/tx 4090 ABC . html #:~:text = A % 20 normal % 20 ejection % 20 fraction % 20 is，fraction % 20 is % 2040% 25% 20 or % 20 less。</em> </a></p><p id="b507" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【7】</em><a class="ae jg" href="https://www.labpedia.net/creatine-kinase-ck-creatine-phosphokinase-cpk/" rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . labpedia . net/肌酸激酶-CK-肌酸磷酸激酶-cpk/ </em> </a></p><p id="7529" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm"/><a class="ae jg" href="https://www.onlinejcf.com/article/S1071-9164(02)25410-X/fulltext#:~:text=We%20believe%20the%20more%20likely,tolerate%20inpatient%20heart%20failure%20treatment." rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . online jcf . com/article/s 1071-9164(02)25410-X/full text #:~:text = We % 20相信% 20更多% 20可能，容忍% 20住院% 20心脏% 20衰竭% 20治疗。</em> </a></p><p id="9c6a" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【9】</em><a class="ae jg" href="https://www.mayoclinic.org/tests-procedures/creatinine-test/about/pac-20384646#:~:text=Results%20of%20the%20creatinine%20blood,and%20women%2C%20and%20by%20age." rel="noopener ugc nofollow" target="_blank"><em class="nm">https://www . mayo clinic . org/tests-procedures/肌酐-test/about/PAC-20384646 #:~:text = Results % 20 of % 20 the % 20肌酐% 20血液，以及% 20 women % 2C % 20和%20by%20age。</em>T11】</a></p><p id="5e1f" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【10】Abebe TB，Gebreyohannes EA，Tefera YG，Bhagavathula AS，Erku DA，Belachew SA等(2018)心力衰竭患者的预后:钠水平是否起显著作用？《公共科学图书馆综合》第13卷第11期:e0207242 </em></p><p id="8860" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><em class="nm">【11】条JY，塞门斯JB，小马萨瑞，劳伦斯-布朗MM。老龄化人口中年龄对血清肌酐水平的影响:与血管外科手术的相关性。心血管外科2002；10(5):445–451.doi:10.1016/s 0967–2109(02)00056-x</em></p><p id="cc84" class="pw-post-body-paragraph lz ma jj mb b mc nh kt me mf ni kw mh mi nj mk ml mm nk mo mp mq nl ms mt mu im bi translated"><a class="ae jg" href="https://doi.org/10.1161/HYPERTENSIONAHA.113.03093" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1161/HYPERTENSIONAHA.113.03093</a></p></div></div>    
</body>
</html>