<html>
<head>
<title>Different Techniques to Read Multiple CSV Files from Local Machine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从本地机器读取多个CSV文件的不同技术</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/programming-85bbfe58b365?source=collection_archive---------1-----------------------#2021-10-18">https://pub.towardsai.net/programming-85bbfe58b365?source=collection_archive---------1-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="47aa" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="f789" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从一个文件夹中读取多个文件的Python示例</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2cc3b1d6dc46ebe7d9dc365cdbe32635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y8dumrn34In3ETW388ygOQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><p id="4129" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本文中，我们将讨论一种不同的方法来读取文件夹中的多个CSV文件。读取操作非常简单，但是读取多个CSV文件有点麻烦。</p><p id="e573" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这里，一些方法被用来读取许多CSV文件，并将它们组合在一个数据帧中。</p><h2 id="9a63" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">iglob方法</h2><p id="3e0a" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">这个函数用于在递归中从路径目录中检索文件。这有点像匹配文件夹中的相同文件。当递归参数为true时，使用路径中的双星(**)。</p><p id="14a9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">文件夹中CSV文件的视图如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi na"><img src="../Images/4047e6371409219cc42f2014f03a7a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*tDTjnupGzHyYuulveIdM-w.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">DWS_1文件夹中的CSV文件。作者的照片</figcaption></figure><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="3dc2" class="md me it nc b gy ng nh l ni nj">#Reading all CSV files and Concatenate Class-wise</span><span id="e67e" class="md me it nc b gy nk nh l ni nj">path = r'C:\Users\Amit\MotionDataset\dws_1\**\*.csv'</span><span id="fdd6" class="md me it nc b gy nk nh l ni nj">dws_1 = pd.concat((pd.read_csv(f) for f in iglob(path,<br/>                   recursive=True)),ignore_index=True)</span><span id="77ab" class="md me it nc b gy nk nh l ni nj">path = r'C:\Users\Amit\MotionDataset\dws_2\**\*.csv'</span><span id="5f37" class="md me it nc b gy nk nh l ni nj">dws_2 = pd.concat((pd.read_csv(f) for f in iglob(path, <br/>                   recursive=True)), ignore_index=True)</span><span id="8742" class="md me it nc b gy nk nh l ni nj">path = r'C:\Users\Amit\MotionDataset\dws_11\**\*.csv'</span><span id="6988" class="md me it nc b gy nk nh l ni nj">dws_11 = pd.concat((pd.read_csv(f) for f in iglob(path,<br/>                    recursive=True)), ignore_index=True)</span><span id="f1ec" class="md me it nc b gy nk nh l ni nj"># Concatenate Down Walking CSV files<br/>dwslist = [dws_1, dws_2, dws_11]  <br/>final_dws = pd.concat(dwslist)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nl"><img src="../Images/014380b06005e990230751cea0fa1fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Evwwtcsvb5PDNZx_0Zs-Kg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h2 id="8b06" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">使用操作系统模块方法的Google Colab</h2><p id="6dfb" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">在这个方法中，我们使用了google colab在线交互式python笔记本，这是一个面向python和数据科学热心学习者的平台即服务(PaaS)。为了从google drive中读取数据，我们需要用下面的代码在colab中挂载这个驱动器。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="5193" class="md me it nc b gy ng nh l ni nj"><strong class="nc jd">from</strong> google.colab <strong class="nc jd">import</strong> drive<br/>drive<strong class="nc jd">.</strong>mount('/content/drive')</span></pre><p id="552f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">此文件检索方法正在使用操作系统模块。os.walk方法是从目录中读取文件的一种非常简单而古老的方法。这将从目录树中的所有文件夹读取并加载所有文件，如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c48efedae9ff863dbea9c3b3b21d7484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*H6evxMKnDTTLIaXsELQ-FQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="b2b7" class="md me it nc b gy ng nh l ni nj"><em class="nu"># Driver function</em><br/><strong class="nc jd">import</strong> pandas <strong class="nc jd">as</strong> pd<br/><strong class="nc jd">import</strong> os<br/><strong class="nc jd">import</strong> seaborn <strong class="nc jd">as</strong> sns<br/>dfmain <strong class="nc jd">=</strong> pd<strong class="nc jd">.</strong>DataFrame()<br/><strong class="nc jd">for</strong> (root,dirs,files) <strong class="nc jd">in</strong> os<strong class="nc jd">.</strong>walk('/content/drive/MyDrive/MotionDataset', topdown<strong class="nc jd">=</strong> <strong class="nc jd">True</strong>):<br/>  <strong class="nc jd">for</strong>  i <strong class="nc jd">in</strong> files:    <br/>    <strong class="nc jd">if</strong> ('.csv' <strong class="nc jd">in</strong> i) <strong class="nc jd">and</strong> ('(1)' <strong class="nc jd">not</strong> <strong class="nc jd">in</strong> i):<br/>      <em class="nu">#print(root,i)</em><br/>      df <strong class="nc jd">=</strong> pd<strong class="nc jd">.</strong>read_csv(f'{root}/{i}')<br/>      df['id'] <strong class="nc jd">=</strong> i<strong class="nc jd">.</strong>split('.')[0]<br/>      df['action'] <strong class="nc jd">=</strong> root<strong class="nc jd">.</strong>split('/')[<strong class="nc jd">-</strong>1]<br/>      df['main_action'] <strong class="nc jd">=</strong> root<strong class="nc jd">.</strong>split('/')[<strong class="nc jd">-</strong>1]<strong class="nc jd">.</strong>split('_')[0]<br/>      dfmain <strong class="nc jd">=</strong> dfmain<strong class="nc jd">.</strong>append(df)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/a6f18a861875a6dade16855d6be000ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhqvj_dKiDF0c9QGx45hiw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h2 id="fae1" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">使用本地机器中的操作系统模块读取文件</h2><p id="dc6c" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">该方法也使用OS模块，但来自本地机器。这是使用os.listdir方法读取当前工作目录中的文件。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="f971" class="md me it nc b gy ng nh l ni nj">dws_1 = pd.DataFrame()<br/>os.chdir(old+'\\dws_1')<br/>for i,file in enumerate(os.listdir(os.getcwd()), start=1):<br/>    if file.endswith('.csv'):<br/>        temp_df = pd.read_csv(file)<br/>        temp_df['subject'] = i<br/>        dws_1 = dws_1.append(temp_df)<br/>        <br/>dws_2 = pd.DataFrame()<br/>os.chdir(old+'\\dws_2')<br/>for i,file in enumerate(os.listdir(os.getcwd()), start=1):<br/>    if file.endswith('.csv'):<br/>        temp_df = pd.read_csv(file)<br/>        temp_df['subject'] = i<br/>        dws_2 = dws_2.append(temp_df)</span><span id="4fbe" class="md me it nc b gy nk nh l ni nj">dws_11 = pd.DataFrame()<br/>os.chdir(old+'\\dws_11')<br/>for i,file in enumerate(os.listdir(os.getcwd()), start=1):<br/>    if file.endswith('.csv'):<br/>        temp_df = pd.read_csv(file)<br/>        temp_df['subject'] = i<br/>        dws_11 = dws_11.append(temp_df)<br/>down_df = pd.concat([dws_1,dws_2,dws_11])<br/>down_df['Action'] = 'downstairs'</span></pre><p id="eb75" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从所有不同文件夹中读取所有文件后，我们可以将所有数据框连接到主数据框，如以下代码所示。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="b2e9" class="md me it nc b gy ng nh l ni nj">final pd<strong class="nc jd">.</strong>concat([down_df,up_df,jog_df,sit_df,walk_df,<br/>                 std_df])<strong class="nc jd">.</strong>drop('Unnamed: 0',1)<br/>final</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/6978a542482d95f092bea5faeb44213b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQzYhWoAI-giybbjQI6u1Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt nx"><a rel="noopener  ugc nofollow" target="_blank" href="/identifying-and-handling-missing-data-in-python-ebe114776f78"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd jd gy z fp oc fr fs od fu fw jc bi translated">在Python中识别和处理缺失数据</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">清理和转换数据</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">pub.towardsai.net</p></div></div><div class="og l"><div class="oh l oi oj ok og ol lb nx"/></div></div></a></div><div class="om on gp gr oo nx"><a rel="noopener  ugc nofollow" target="_blank" href="/10-python-projects-with-description-to-enhance-the-knowledge-cbd37e207418"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd jd gy z fp oc fr fs od fu fw jc bi translated">10个Python项目，通过描述来增强知识</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">初学者使用Python的应用和项目</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">pub.towardsai.net</p></div></div><div class="og l"><div class="op l oi oj ok og ol lb nx"/></div></div></a></div><p id="4216" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">全球方法</strong></p><p id="96cc" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这个方法就像一个从文件夹中读取文件的iglob。在这种方法中，我们读取一种类型的所有CSV文件，并将它们连接到各自的类。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="7081" class="md me it nc b gy ng nh l ni nj"><em class="nu"># Here we are going to create a list of all csv files present in dws_1 folder</em><br/>dws_1_files<strong class="nc jd">=</strong>sorted(glob("D:\\MotionDataset\\dws_1\\sub_*.csv"))<br/>dws_1_files</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/cab6b68d69274146f40cd4735ff350f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*mgd6Xib1iwwcbdFDqGKdMQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><p id="3629" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">合并dws_1文件夹中的所有CSV文件</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="2650" class="md me it nc b gy ng nh l ni nj">dws_1<strong class="nc jd">=</strong>pd<strong class="nc jd">.</strong>concat((pd<strong class="nc jd">.</strong>read_csv(file)<strong class="nc jd">.</strong>assign(Action<strong class="nc jd">=</strong>"downstairs")<br/>          <strong class="nc jd">for</strong>  file <strong class="nc jd">in</strong> dws_1_files),ignore_index<strong class="nc jd">=True</strong>)<br/>dws_1<strong class="nc jd">.</strong>columns</span><span id="399f" class="md me it nc b gy nk nh l ni nj">#output:<br/>Index(['Unnamed: 0', 'attitude.roll', 'attitude.pitch', 'attitude.yaw',<br/>       'gravity.x', 'gravity.y', 'gravity.z', 'rotationRate.x',<br/>       'rotationRate.y', 'rotationRate.z', 'userAcceleration.x',<br/>       'userAcceleration.y', 'userAcceleration.z', 'Action'],<br/>      dtype='object')</span></pre><p id="1f8a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">查看和调整dws类中的数据。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="c5ec" class="md me it nc b gy ng nh l ni nj"><em class="nu">#Dropping the unnamed column from dws_1 dataframe</em><br/>dws_1<strong class="nc jd">.</strong>drop(labels<strong class="nc jd">=</strong>["Unnamed: 0"],axis<strong class="nc jd">=</strong>1,inplace<strong class="nc jd">=True</strong>)</span><span id="5347" class="md me it nc b gy nk nh l ni nj"># <em class="nu">Shape of dws_1 dataframe</em><br/>print("Shape of dws_1 is:",dws_1<strong class="nc jd">.</strong>shape)</span><span id="94ba" class="md me it nc b gy nk nh l ni nj">#output:<br/>Shape of dws_1 is: (50246, 13)</span><span id="3186" class="md me it nc b gy nk nh l ni nj"><em class="nu"># Top 5 rows of dws_1</em><br/>dws_1<strong class="nc jd">.</strong>head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/1652eff2f52fe60b9d9f93a052fe2183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YN-T27QMnwiUrMZouVP0Eg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h2 id="04df" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">结论</h2><p id="7d93" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">这些方法是非常基本的，有助于从不同的文件夹中读取多个文件。</p><p id="06ef" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae os" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae os" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="6f83" class="ot me it bd mf ou ov ow mi ox oy oz ml ki pa kj mo kl pb km mr ko pc kp mu pd bi translated">推荐文章</h1><p id="2ffe" class="pw-post-body-paragraph lh li it lj b lk mv kd lm ln mw kg lp lq mx ls lt lu my lw lx ly mz ma mb mc im bi translated">1.<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/8-active-learning-insights-of-python-collection-module-6c9e0cc16f6b?source=friends_link&amp;sk=4a5c9f9ad552005636ae720a658281b1">8 Python的主动学习见解收集模块</a> <br/> 2。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/numpy-linear-algebra-on-images-ed3180978cdb?source=friends_link&amp;sk=d9afa4a1206971f9b1f64862f6291ac0"> NumPy:图像上的线性代数</a>T5】3。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/exception-handling-concepts-in-python-4d5116decac3?source=friends_link&amp;sk=a0ed49d9fdeaa67925eac34ecb55ea30">Python中的异常处理概念</a> <br/> 4。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/pandas-dealing-with-categorical-data-7547305582ff?source=friends_link&amp;sk=11c6809f6623dd4f6dd74d43727297cf">熊猫:处理分类数据</a> <br/> 5。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/hyper-parameters-randomseachcv-and-gridsearchcv-in-machine-learning-b7d091cf56f4?source=friends_link&amp;sk=cab337083fb09601114a6e466ec59689">超参数:机器学习中的RandomSeachCV和GridSearchCV</a><br/>6。<a class="ae os" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python </a> <br/> 7全面讲解了线性回归。<a class="ae os" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python </a> <br/>充分解释了Logistic回归8。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/data-distribution-using-numpy-with-python-3b64aae6f9d6?source=friends_link&amp;sk=809e75802cbd25ddceb5f0f6496c9803">数据分发使用Numpy与Python </a> <br/> 9。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/decision-trees-vs-random-forests-in-machine-learning-be56c093b0f?source=friends_link&amp;sk=91377248a43b62fe7aeb89a69e590860">机器学习中的决策树vs随机森林</a> <br/> 10。<a class="ae os" rel="noopener ugc nofollow" target="_blank" href="/standardization-in-data-preprocessing-with-python-96ae89d2f658?source=friends_link&amp;sk=f348435582e8fbb47407e9b359787e41">用Python实现数据预处理的标准化</a></p></div></div>    
</body>
</html>