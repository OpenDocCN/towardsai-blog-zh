<html>
<head>
<title>Machine Learning Workflow: A Coding Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习工作流:编码指南</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/machine-learning-workflow-a-coding-guide-c95dedb5b42?source=collection_archive---------3-----------------------#2020-07-20">https://pub.towardsai.net/machine-learning-workflow-a-coding-guide-c95dedb5b42?source=collection_archive---------3-----------------------#2020-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="e27b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="6d24" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">探索人工神经网络模型训练步骤的初学者指南</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/506be35f2105f1688fc9fe525d9e959d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BwQ0MbS6pzHsIei1"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@alvarordesign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿尔瓦罗·雷耶斯</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="888f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated">当我是机器学习的新手时，我不知道从哪里开始，如何开始模型训练？即使我知道所有的关键点，对我来说还是很难进入编码领域，我认为这对每个新手来说都很正常。</p><p id="9e0e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以我决定写ML工作流来解决所谓的困惑。在本文中，我们将使用Keras的内置<strong class="lk jd"> MNIST </strong>影像数据集。那我们开始吧。</p><h1 id="b2d8" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">1.数据准备:</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/4ecc9ef1a5701307bad0ec682838c3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5tn_2kbspnfgkFyj"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@mbaumi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米卡·鲍梅斯特</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h2 id="e24d" class="ng mo it bd mp nh ni dn mt nj nk dp mx lr nl nm mz lv nn no nb lz np nq nd iz bi translated">a)将数据转换成Numpy数组:</h2><ul class=""><li id="3e5b" class="nr ns it lk b ll nt lo nu lr nv lv nw lz nx md ny nz oa ob bi translated">在将数据(图像或文本)输入模型之前，应该先将其转换成Numpy数组。如果您只是从像Keras/Tensorflow 2.0这样的ML库中导入预加载的数据，那就可以了。因为数据已经进入Numpy数组的元组。</li><li id="dcf2" class="nr ns it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">然后，将整个数组数据集分解为<strong class="lk jd">训练</strong>(训练样本+训练标签)<strong class="lk jd">数据集</strong>和<strong class="lk jd">测试</strong>(测试样本+测试标签)<strong class="lk jd">数据集</strong>。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">Numpy返回数组</figcaption></figure><h2 id="d14f" class="ng mo it bd mp nh ni dn mt nj nk dp mx lr nl nm mz lv nn no nb lz np nq nd iz bi translated">b)缩放:</h2><ul class=""><li id="2873" class="nr ns it lk b ll nt lo nu lr nv lv nw lz nx md ny nz oa ob bi translated">在将图像/文本数据转换成一个Numpy数组并将数据分成4个子数据集之后，接下来要做的事情是在[0，1]区间内缩放我们的样本数据。但是我们为什么需要扩展呢？缩放的目标是加快算法的计算速度。它用于将数据集中数值列的值更改为使用通用比例，而不会扭曲值范围的差异或丢失信息。一些算法也需要正确地对数据建模。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">图像的像素值为0-255，这就是将数组除以255.0的原因</figcaption></figure><h2 id="321c" class="ng mo it bd mp nh ni dn mt nj nk dp mx lr nl nm mz lv nn no nb lz np nq nd iz bi translated">c)分类编码:</h2><p id="e4b2" class="pw-post-body-paragraph li lj it lk b ll nt kd ln lo nu kg lq lr oj lt lu lv ok lx ly lz ol mb mc md im bi translated">如果训练和测试标签是字符串，您应该将它们转换为数值。但是，此时您必须在这两种编码方法之间做出选择:</p><ul class=""><li id="6602" class="nr ns it lk b ll lm lo lp lr om lv on lz oo md ny nz oa ob bi translated"><strong class="lk jd">标签编码</strong></li><li id="92a6" class="nr ns it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated"><strong class="lk jd">一键编码</strong></li></ul><p id="25af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你不知道是只做标签编码还是两者都做<a class="op oq ep" href="https://medium.com/u/8978a39fecd0?source=post_page-----c95dedb5b42--------------------------------" rel="noopener" target="_blank"> Raheel Shaikh </a>的文章"<a class="ae lh" href="https://towardsdatascience.com/choosing-the-right-encoding-method-label-vs-onehot-encoder-a4434493149b" rel="noopener" target="_blank">选择正确的编码方法-标签与OneHot编码器</a>"将帮助你做到这一点😃。</p><blockquote class="or os ot"><p id="f34b" class="li lj ou lk b ll lm kd ln lo lp kg lq ov ls lt lu ow lw lx ly ox ma mb mc md im bi translated">对我来说，标签已经是数字了。因此，我不会执行分类编码步骤。</p></blockquote><h1 id="458d" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">2.构建模型:</h1><p id="b6a8" class="pw-post-body-paragraph li lj it lk b ll nt kd ln lo nu kg lq lr oj lt lu lv ok lx ly lz ol mb mc md im bi translated">现在接下来的事情是建立一个模型。当建立一个模型时，你必须考虑你选择的激活函数。一般来说，在分类问题中，<strong class="lk jd"> Relu </strong>在中间层工作得很好，但是在最终的输出层，你要仔细选择激活函数才能得到想要的结果。这里我使用了<strong class="lk jd"> Softmax </strong>，因为我正在处理<strong class="lk jd">多类分类</strong>问题。如果你正在进行<strong class="lk jd">二元类分类，你可以使用<strong class="lk jd"> Sigmoid </strong>。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="3bdc" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">3.编译步骤:</h1><p id="7353" class="pw-post-body-paragraph li lj it lk b ll nt kd ln lo nu kg lq lr oj lt lu lv ok lx ly lz ol mb mc md im bi translated">现在轮到它的编译了。</p><ul class=""><li id="adc8" class="nr ns it lk b ll lm lo lp lr om lv on lz oo md ny nz oa ob bi translated">如果您正在处理回归预测建模问题，可以使用两个最常见的损失函数:MSE <code class="fe oy oz pa pb b">mean_squared_error </code>或MAE <code class="fe oy oz pa pb b">mean_absolute_error</code>。</li><li id="4ea6" class="nr ns it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">在二元分类中，一般使用<code class="fe oy oz pa pb b">binary_crossentropy</code>。然而，<code class="fe oy oz pa pb b">hinge</code>与支持向量机(SVM)模型一起使用。</li><li id="01db" class="nr ns it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">在多类，单标签分类，如果你做标签编码<code class="fe oy oz pa pb b">categorical_crossentropy</code>将被使用。否则，使用<code class="fe oy oz pa pb b">sparse_categorical_crossentropy</code>作为损失函数。</li><li id="e956" class="nr ns it lk b ll oc lo od lr oe lv of lz og md ny nz oa ob bi translated">多类，多标签分类有点不一样。您将使用<code class="fe oy oz pa pb b">binary_crossentropy</code>和<code class="fe oy oz pa pb b">sigmoid</code>作为激活功能。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="4cd3" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">4.训练模型:</h1><p id="0a52" class="pw-post-body-paragraph li lj it lk b ll nt kd ln lo nu kg lq lr oj lt lu lv ok lx ly lz ol mb mc md im bi translated">一旦您完成了数据预处理、构建模型架构和编译，您就可以开始训练您的模型✌️.了</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="d106" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">5.评估培训:</h1><p id="21b7" class="pw-post-body-paragraph li lj it lk b ll nt kd ln lo nu kg lq lr oj lt lu lv ok lx ly lz ol mb mc md im bi translated">在这一步中，您将检查您的训练模型在测试集上是否表现良好。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">输出:10000/1–1s—损耗:0.0386 —精度:0.9771</figcaption></figure><h1 id="998e" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">6.重复步骤2–5:</h1><ul class=""><li id="a4af" class="nr ns it lk b ll nt lo nu lr nv lv nw lz nx md ny nz oa ob bi translated">如果评估结果不令人满意，只需稍加修改即可重复这些步骤。</li></ul><h1 id="0ebd" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">7.预测(可选):</h1><ul class=""><li id="e3e7" class="nr ns it lk b ll nt lo nu lr nv lv nw lz nx md ny nz oa ob bi translated">最后，你可以预测你自己的(或自己创造的)随机数据。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="8ae5" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">8.保存您的模型:</h1><p id="17f1" class="pw-post-body-paragraph li lj it lk b ll nt kd ln lo nu kg lq lr oj lt lu lv ok lx ly lz ol mb mc md im bi translated">此外，建议保存您的模型，以便将来您可以在AI桌面应用程序或web应用程序中使用它。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="685d" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">结论:</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/c4ad960c7dd555daa8b6fd0a269d79e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*irzHcUb7O8KsyWBY"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@aaronburden?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aaron Burden </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="433a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们总结一下到目前为止所学的内容。</p><p id="10d0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ou"> 1。准备数据。</em></p><blockquote class="or os ot"><p id="55d2" class="li lj ou lk b ll lm kd ln lo lp kg lq ov ls lt lu ow lw lx ly ox ma mb mc md im bi translated"><strong class="lk jd"> -加载内置数据；</strong>作为Numpy数组返回。</p><p id="3123" class="li lj ou lk b ll lm kd ln lo lp kg lq ov ls lt lu ow lw lx ly ox ma mb mc md im bi translated"><strong class="lk jd"> -加载下载/自定义数据；</strong>将数据转换成Numpy数组。</p><p id="c61b" class="li lj ou lk b ll lm kd ln lo lp kg lq ov ls lt lu ow lw lx ly ox ma mb mc md im bi translated"><strong class="lk jd"> -缩放。</strong></p><p id="462a" class="li lj ou lk b ll lm kd ln lo lp kg lq ov ls lt lu ow lw lx ly ox ma mb mc md im bi translated"><strong class="lk jd"> -分类编码；</strong>标签编码/一键编码。</p></blockquote><p id="3f06" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">2.构建模型架构。</p><p id="f424" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">3.执行编译步骤。</p><p id="7fe8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">4.训练模型。</p><p id="16ac" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">5.评估训练好的模型。</p><p id="461e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">6.如果你得到不满意的结果，重复这些步骤，直到你得到满意的结果。</p><p id="6b11" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">7.预测。</p><p id="3b80" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">8.保存训练好的模型。</p></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pk"><img src="../Images/6e3a40083d0e652fb0838d4358b3029e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ulvU1-qSwxliJ4bM"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">马库斯·斯皮斯克在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="27c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下一篇文章中，我们将学习如何使用<strong class="lk jd"> Flask开发机器学习Web应用程序。👍</strong></p><p id="a690" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">敬请关注。👋</p></div></div>    
</body>
</html>