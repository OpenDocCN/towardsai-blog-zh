<html>
<head>
<title>Train a Text Classifier using the Amazing Attention Transformers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用惊人的注意力转换器训练文本分类器</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/train-a-text-classifier-using-the-amazing-attention-transformers-175a7c738f77?source=collection_archive---------1-----------------------#2021-03-18">https://pub.towardsai.net/train-a-text-classifier-using-the-amazing-attention-transformers-175a7c738f77?source=collection_archive---------1-----------------------#2021-03-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9c38" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><div class=""><h2 id="dc67" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从头开始建造和训练一个变形金刚</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c888d6af245253ccfce9df8c3558fc34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*00aVgzclEUin-CvutXLPOA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">来源:<a class="ae lh" href="https://pixabay.com/vectors/pixel-cells-techbot-teach-o-bot-3947912/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><p id="aa09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">继续从<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/text-classification-using-transformers-a2c6b3395ce3">最后一部分</a>开始，在这一部分中，我们将着眼于两种不同的技术来训练自我注意力转换网络，以将一段文本<em class="me">(在我们的例子中是一个问题)</em>分类成两个不同的类别，每个类别包含一些类别。我们将使用我们在上一部分中使用的<strong class="lk jd">编码器-解码器<em class="me"> </em> </strong>模块对变压器网络进行编码，然后对其进行训练。</p><h1 id="f864" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">技术— 1: N级磁头分类变压器</h1><p id="68fe" class="pw-post-body-paragraph li lj it lk b ll mx kd ln lo my kg lq lr mz lt lu lv na lx ly lz nb mb mc md im bi translated">我们的最终目标是为给定的问题提供两个不同的类名。这里，我们可以将从自注意转换器的<strong class="lk jd"> <em class="me">编码器-解码器</em> </strong>层提取的特征传递给两个完全连接的线性层；一个预测主类，另一个预测子类。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/2d9fd58a1fd1398e1a9b4ea6fc1a7cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*abf382P7PTn_bZu1QpfLMA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/63c6f2d87a50d04432347771396f4822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2NsyIhsEoRT9L3KrT-VhQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h2 id="21f3" class="ne mg it bd mh nf ng dn ml nh ni dp mp lr nj nk mr lv nl nm mt lz nn no mv iz bi translated">训练模型</h2><ul class=""><li id="d1e4" class="np nq it lk b ll mx lo my lr nr lv ns lz nt md nu nv nw nx bi translated"><em class="me">用于模型训练的数据集类</em></li></ul><p id="38e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们在第一部分中预处理的数据在一个字典列表中，列表中的每个字典以<code class="fe ny nz oa ob b">question-tokens</code>、<code class="fe ny nz oa ob b">question-class</code>和<code class="fe ny nz oa ob b">question-subclass</code>为关键字，表示标记化的问题、问题的类别和问题的子类。在<code class="fe ny nz oa ob b">Dataset</code>对象中，我们将把<code class="fe ny nz oa ob b">question-tokens</code>填充到问题中令牌的最大长度，在我们的例子中，它是100。我们将返回键<code class="fe ny nz oa ob b">source_seq</code>下的填充<code class="fe ny nz oa ob b">question-tokens</code>以及带有标签<code class="fe ny nz oa ob b">class</code>和<code class="fe ny nz oa ob b">subclass</code>的填充序列的类和子类。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/6461b5df2f45d896274298fc8ea8fa0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3J37nC84yWrxW-OWv-IBNw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="6372" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">训练步骤</strong></p><ol class=""><li id="5aa4" class="np nq it lk b ll lm lo lp lr od lv oe lz of md og nv nw nx bi translated">导入、播种和伐木</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/d0ac59f6e2057b88fdd3030888367209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w-86jESnVt_G-Px5POQ3DQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="8a18" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">2.公用事业</p><p id="4bb4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">实用程序部分下的功能包括选择加载模型和数据的设备的功能、计算可训练模型参数的功能、计算批量训练后模型性能的功能以及加载一些pickle文件的功能。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/4e1b0c9d43fb261408098326fd9129d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H7XOfPNpbvjeVa_4g2fs2Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="783e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">3.数据和标记器加载</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/57feba3ce912736157db3e50f243e1ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oaMIOTcCOA2N_8OzsvGgAg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="b372" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">4.模型初始化</p><p id="d97f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将初始化模型参数，如词汇表的大小、填充id、类标签id ( <code class="fe ny nz oa ob b">[CLS]</code>)、每个类别中的类的数量、由数据形成的序列的最大长度、用于训练的批量大小以及用于训练的工人数量。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/d6e86a489c491051c79d9ace0da0a922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wt1hrrtEiu66FxcRFdy2qg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="fde0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">5.数据加载器和优化器</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/b972ab3a8574f88074d2b06d8e787936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cem6jNxOqTqu-u8La05B7A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="effc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">6.以最佳精度训练和保存</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/c2465e755408f93f56cc8b4a1c7266fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r1rMV6Wl4fyRaKfRHt6BvQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="d4b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">培训日志</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/c838b111a2ec4f217d7300bc8978d8fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xBCW612hfR57sEXFU6wlDQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="3a1b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">使用训练好的模型进行推理</strong></p><p id="d976" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于索引列表的子类名称有大约47个值，我已经将它们保存在pickle文件中，所有内容都将在<a class="ae lh" href="https://github.com/vatsalsaglani/QuestionClassification" rel="noopener ugc nofollow" target="_blank"> GitHub </a> repo中可用。</p><ul class=""><li id="d112" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">加载类名细节</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/1e162205784ddd49287222185d558145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQAxOJEMgkTjdpvVESDbOA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="72eb" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">加载子类和细节，以及类的索引和子类的索引</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/59c0bcedf31e668370a78606d4eea166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2j26xCRfoWHI_FQ9cLiAnA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="5ef9" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">预测功能</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/d9603fcf1bf8b0a7197e885d7cbf31f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yC_lb2xuaPp-YgpZ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="1b2d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有了更多关于问题及其类和子类的数据或预训练的transformer模型，可以通过几个时期的微调快速获得更好的性能。但是对于某些用例，很难找到任何预训练的模型，如果没有那么多时间来完成预训练过程和微调，有时可能需要使用大量数据来训练转换器。</p><h1 id="2052" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">技术— 2:一个编码器N解码器分类转换器</h1><p id="63e1" class="pw-post-body-paragraph li lj it lk b ll mx kd ln lo my kg lq lr mz lt lu lv na lx ly lz nb mb mc md im bi translated">在这里，我们将看看另一种利用自我注意力转移模型的方法，将一段文本分成两个不同的类别，每个类别包含一些类别。我们将有两个解码器和一个编码器，其中编码器将提取问题特征并将其传递给具有<code class="fe ny nz oa ob b">[CLS]</code>索引的第一个解码器，然后将编码器特征传递给具有该问题的类别索引的第二个解码器。从两个解码器中提取特征，然后通过两个完全连接的<strong class="lk jd">层；一个获取<strong class="lk jd">类逻辑</strong>，另一个获取<strong class="lk jd">子类逻辑</strong>。</strong></p><p id="6124" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">分类转换器模型看起来像这样，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/cffdce46d4874378955bef7d3200f8bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rpaCLosf45b7c4GT.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="2fe9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当一个<em class="me">子类</em>属于一个父<em class="me">类</em>类别时，可以称之为<strong class="lk jd">一个编码器</strong> <code class="fe ny nz oa ob b"><strong class="lk jd">N</strong></code> <strong class="lk jd"> -解码器</strong>方法。而在先前的模型(<em class="me">技术-1</em>)中，只有一个<em class="me">解码器</em>层，其中模型的输入只是问题；这里，在这个方法中，需要提供<em class="me">问题文本</em>和<em class="me">主类标签</em>。<em class="me">主类标签</em>不会显示给<strong class="lk jd">第一解码器</strong>，只会显示给<strong class="lk jd">第二解码器</strong>。</p><p id="d1de" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">我们来举个例子。假设问题是</em><strong class="lk jd"><em class="me">Google是什么时候创立的</em> </strong> <em class="me">？</em></p><p id="af7a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这个问题，<code class="fe ny nz oa ob b">class</code>是<code class="fe ny nz oa ob b"><strong class="lk jd">NUMERIC</strong></code>，而<code class="fe ny nz oa ob b">subclass</code>是<code class="fe ny nz oa ob b"><strong class="lk jd">date</strong></code>。</p><p id="4f26" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们模型的输入将是<strong class="lk jd">问题文本(<em class="me">Google成立于何时？</em> ) </strong>和<strong class="lk jd">类标签(</strong> <code class="fe ny nz oa ob b"><strong class="lk jd"><em class="me">NUMERIC</em></strong></code> <strong class="lk jd">)。</strong>类标签(<code class="fe ny nz oa ob b">NUMERIC</code>)不会传递给<strong class="lk jd">解码器- 1 </strong>，因为<strong class="lk jd">解码器- 1 </strong>功能将预测<strong class="lk jd">类名。</strong>类别标签(<code class="fe ny nz oa ob b">NUMERIC</code>)将仅被传递给<strong class="lk jd">解码器- 2 </strong>，以便<em class="me">第二解码器</em>了解哪些子类类别可以归入一个类别类别。我知道这很复杂😅。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/95d2e9f53f485723e3fe4383a2e1deb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5jwwc9CJo1zsiLS_.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="0ecb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">编码器和解码器部分将保持不变，但是如上所述，分类转换器将包含两个解码器。您可以检查编码器和解码器代码的前一部分(<em class="me">部分— 1 </em>)。</p><h1 id="8b49" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">分类变压器</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/e73007019b451d6c2ee5c98286a4d807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TafYBm-PLY2UA3-0.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="7525" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集对象也将保持与上述第一种技术相同。</p><p id="2320" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">训练模型</strong></p><ul class=""><li id="28d7" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">导入、播种和记录</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/e292e942698dba50fee6d923d9355006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r3mDvleG_sOBdRZX.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="bb44" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">实用程序</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/54ec7fbc317e2113755da76598f7da6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_iMG9_xhlky9psNv.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="a61f" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">数据和标记器</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/8862aa165757d3180d724a32f8b276d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_L767fab7CHe-NTQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="bd03" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">模型初始化</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/b23cbfca74cc3188d89ad09023adf53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SpaJJZ2gC5sG5Jwh.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="f3a9" class="np nq it lk b ll lm lo lp lr od lv oe lz of md nu nv nw nx bi translated"><em class="me">训练</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/c0edbc7a10de74c1f5c99573948e84e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xSn6vEzoRkrlPcon.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="4834" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">训练日志看起来会像这样</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/fe589a526e125d13bd926fbdad763f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FNRYE9hNcsD_5oED.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><h1 id="e81f" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">推理</h1><p id="f2a4" class="pw-post-body-paragraph li lj it lk b ll mx kd ln lo my kg lq lr mz lt lu lv na lx ly lz nb mb mc md im bi translated">如以上部分所讨论的，模型输入将是<strong class="lk jd">问题文本</strong>和<strong class="lk jd">类别标签</strong>。开始时，我们没有问题文本的<strong class="lk jd">类标签</strong>，所以我们将通过。从<strong class="lk jd">解码器— 1 </strong>获得的特征，并将其传递给解码器— 1 的<strong class="lk jd">全连接层，然后获得<strong class="lk jd">类别标签</strong>。获得类别标签后，问题文本和类别标签将被传递到<strong class="lk jd">解码器-2</strong>，从它们获得的特征将被传递到<strong class="lk jd">解码器-2的全连接层</strong>，并且将获得子类标签。让我们看看代码。</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/93533399ace950290ee302d0f7a180e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e18pPK-uNXqUVUOU.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="c1ab" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">一些推论的例子</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi or"><img src="../Images/073c206a54fdd48fdf638e0e73f5422a.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/0*9iNWbTzMn3Od6DYC.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/9868b013f122c9fedf0355e4c9e2924f.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/0*zpQU49gAuRSGO2L9.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/b084bf0cc8f6f1b6aee505b78db5d733.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*VhtUzEb-iLexzzA3.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</figcaption></figure><p id="d490" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">通过这一部分，我们将结束这个关于使用自我注意力变压器和不同分类技术进行文本分类的博客系列，其中有</em> <code class="fe ny nz oa ob b"><em class="me">N</em></code> <em class="me">类别，每个类别有几个类别。</em></p><p id="f469" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所有零件的代码都可以在<a class="ae lh" href="https://github.com/vatsalsaglani/QuestionClassification" rel="noopener ugc nofollow" target="_blank">这个GitHub repo </a>中找到。</p><p id="8392" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以点击查看模型<a class="ae lh" href="https://classifyquestions.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">的现场版本。</a></p></div></div>    
</body>
</html>