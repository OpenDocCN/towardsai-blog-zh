<html>
<head>
<title>Coffee, Tea &amp; EMD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">咖啡、茶和EMD</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/coffee-tea-emd-19d1c387ea5e?source=collection_archive---------4-----------------------#2020-09-08">https://pub.towardsai.net/coffee-tea-emd-19d1c387ea5e?source=collection_archive---------4-----------------------#2020-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/49905a1a64812674c3440ee14bb946a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kHKygwIJt-OPJIiY"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@asthetik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迈克·肯尼利</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="9508" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="1c98" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">使用经验模式分解来了解我喜欢的饮料的批发价格！</h2></div><h1 id="5138" class="lh li jj bd lj lk ll lm ln lo lp lq lr ky ls kz lt lb lu lc lv le lw lf lx ly bi translated">前言</h1><p id="0fe6" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">我的早晨通常从一杯热气腾腾的黑咖啡开始。不，这不是昂贵的美食，而是速溶咖啡粉让我一上午都精力充沛。</p><p id="dee6" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">我的夜晚通常更醇厚，一杯香浓的印度茶，也许几块饼干。他们提供了适量的咖啡因，可以一直坚持到晚上10点。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="fd53" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">动机</h1><p id="6b0f" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">我最近不得不在工作中使用一个漂亮的信号处理工具——<code class="fe nm nn no np b"><strong class="mb jt">Empirical Mode Decomposition (EMD)</strong></code>——我想这会是一个有趣的帖子！</p><p id="8ee0" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">在这篇文章中，我将使用我最喜欢的饮料的价格来给出EMD的一个高层次的概述，同时也涉及到<code class="fe nm nn no np b"><strong class="mb jt">Fast Fourier Transform (FFT)</strong></code>。</p><p id="8fe8" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">这些技术不限于信号处理领域，可以很容易地用于任何时间序列数据，以获得极其有用的见解！</p><p id="ccf2" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><em class="nq">一如既往，你可以在我的</em><a class="ae jg" href="https://github.com/ani-rudra-chan/Coffee-Tea-EMD-Project.git" rel="noopener ugc nofollow" target="_blank"><em class="nq">GitHub</em></a><em class="nq">资源库中查看完整的代码。</em></p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="a0f7" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">数据源</h1><p id="d1d5" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">印度政府主办的开放数据门户—<a class="ae jg" href="http://www.data.gov.in" rel="noopener ugc nofollow" target="_blank">www.data.gov.in</a>是一个搜索我的需求的好地方。我发现一些商品数据集似乎足够干净，可以使用。有些数据有点过时了，但是对于我的小练习来说，我认为这些数据已经足够了。所以我最终下载了散茶和咖啡粉的数据集。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="1feb" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">关于数据</h1><p id="2a27" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">该数据集包含我提到的商品的每日批发价格信息。价格主要是商品在批发市场上的销售价格。</p><p id="173d" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">松散茶叶的数据集看起来像这样—</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="8767" class="nz li jj np b gy oa ob l oc od">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>DatetimeIndex: 114495 entries, 1997-11-25 to 2015-04-28<br/>Data columns (total 3 columns):<br/> #   Column          Non-Null Count   Dtype  <br/>---  ------          --------------   -----  <br/> 0   Centre_Name     114495 non-null  object <br/> 1   Commodity_Name  114495 non-null  object <br/> 2   Price           114495 non-null  float64<br/>dtypes: float64(1), object(2)<br/>memory usage: 3.5+ MB</span></pre><p id="8de2" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">如你所见，数据集的功能非常有限，但这对我来说很好，因为我想单独查看价格。咖啡粉的数据集看起来像这样—</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="0cf4" class="nz li jj np b gy oa ob l oc od">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>DatetimeIndex: 11515 entries, 2003-01-07 to 2019-12-02<br/>Data columns (total 8 columns):<br/> #   Column       Non-Null Count  Dtype <br/>---  ------       --------------  ----- <br/> 0   state        11515 non-null  object<br/> 1   district     11515 non-null  object<br/> 2   market       11515 non-null  object<br/> 3   commodity    11515 non-null  object<br/> 4   variety      11515 non-null  object<br/> 5   min_price    11515 non-null  int64 <br/> 6   max_price    11515 non-null  int64 <br/> 7   modal_price  11515 non-null  int64 <br/>dtypes: int64(3), object(5)<br/>memory usage: 809.6+ KB</span></pre><p id="f153" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">虽然这个数据集的特性稍微丰富一些，但是为了简单起见，我只使用了模态价格(<em class="nq">一天中最常见的价格)</em>。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="5498" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">数据预处理</h1><p id="c7db" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">经过一点预处理魔术之后，</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="b33d" class="nz li jj np b gy oa ob l oc od"># We select the modal_price for coffee and aggregate over the whole country<br/>data0 = coffee_df.loc['2010':'2014', 'modal_price'].resample('D').mean()<br/># We aggregate over the whole country for the loose tea prices<br/>data1 = tea_df.loc['2010':'2014', 'Price'].resample('D').mean()<br/></span><span id="ba45" class="nz li jj np b gy oe ob l oc od"># We concatenate the data and fill in missing values<br/>comm_df = pd.concat([data0, data1],axis=1)<br/>comm_df.columns = ['coffee','tea']<br/>comm_df = comm_df.dropna()<br/>comm_df = comm_df.fillna(method='ffill')</span></pre><p id="e30c" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">数据准备好了！</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="9520" class="nz li jj np b gy oa ob l oc od">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>DatetimeIndex: 1121 entries, 2010-01-01 to 2014-12-31<br/>Data columns (total 2 columns):<br/> #   Column  Non-Null Count  Dtype  <br/>---  ------  --------------  -----  <br/> 0   coffee  1121 non-null   float64<br/> 1   tea     1121 non-null   float64<br/>dtypes: float64(2)<br/>memory usage: 26.3 KB</span></pre></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="d6c7" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">汇总统计数据</h1><p id="8cb3" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">数据集的常规汇总统计如下所示—</p><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/7a51e468d5c9450c3d5e8b684b861eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*SMYKT2ZRGdxN6suBn3M9pA.png"/></div></figure><ul class=""><li id="77cf" class="og oh jj mb b mc mv mf mw mi oi mm oj mq ok mu ol om on oo bi translated">咖啡:每公担卢比(1公担= 100公斤)</li><li id="3a07" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">散装茶叶:每公担卢比</li></ul><p id="5911" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">从汇总统计数据来看，显然<strong class="mb jt">咖啡</strong>是两者中价格较高的商品，也是多年来波动较大的商品。在印度，茶是两种饮料中更稳定也更便宜的选择。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="9967" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">时间序列分析</h1><h2 id="ed9c" class="nz li jj bd lj ou ov dn ln ow ox dp lr mi oy oz lt mm pa pb lv mq pc pd lx jp bi translated">时间序列图</h2><p id="ccc5" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">首先要做的是将商品价格绘制成一个时间序列，每天的最高价和最低价都包含在内。</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="980a" class="nz li jj np b gy oa ob l oc od">fig, ax = plt.subplots(2,1, sharex=True, figsize=[15,10])</span><span id="f95d" class="nz li jj np b gy oe ob l oc od">for i in range(0,2):<br/>    c = comm_df.iloc[:,i]<br/>    c_low = c.resample('W').min()<br/>    c_high = c.resample('W').max()<br/>    c_mean = c.resample('W').mean()<br/>    <br/>    ax[i].plot(c_low.index, c_low.values, linewidth=2, linestyle='')<br/>    ax[i].plot(c_mean.index, c_mean.values, linewidth=2, color='k')<br/>    ax[i].plot(c_high.index, c_high.values, linewidth=2, linestyle='')<br/>    ax[i].fill_between(c_low.index, c_low.values, c_high.values, alpha=0.5)<br/>    ax[i].set_ylabel(comm_df.columns[i])</span></pre><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pe"><img src="../Images/d034666ad783736af40587be42c2c8ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qTDBvn8sxFf6kHAc-Y4xsw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图1—2010年至2015年咖啡和茶叶价格的时间序列(来源:作者)</figcaption></figure><p id="8572" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><code class="fe nm nn no np b"><strong class="mb jt">Observations:</strong></code></p><ul class=""><li id="5bec" class="og oh jj mb b mc mv mf mw mi oi mm oj mq ok mu ol om on oo bi translated">咖啡价格大幅波动，尤其是在2011年至2012年；</li><li id="e709" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">价格中似乎有一些季节性(<em class="nq">或者换句话说，时间序列中的一些振荡或周期性</em>)；</li><li id="4f70" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">茶叶价格呈现上涨趋势，但咖啡价格的上涨趋势并不明显。</li></ul><p id="6581" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">使用<code class="fe nm nn no np b">seaborn</code>的月度变化图将提供额外的洞察力——</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="b9bd" class="nz li jj np b gy oa ob l oc od">fig,ax = plt.subplots(1,2,figsize=[15,6])<br/>sns.lineplot(comm_df.index.month, comm_df.coffee, color='teal', ax=ax[0])<br/>ax[0].set_xlabel('Month')<br/>ax[0].set_ylabel('Coffee Price (Rs/quintal)')</span><span id="af6d" class="nz li jj np b gy oe ob l oc od">sns.lineplot(comm_df.index.month, comm_df.tea, color='green', ax=ax[1])<br/>ax[1].set_xlabel('Month')<br/>ax[1].set_ylabel('Tea Price (Rs/quintal)')</span></pre><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pe"><img src="../Images/5794439531096850779feb270d7523ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yzkSvG4GA1JglQEjZM_jsQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图2——95%置信区间的月度价格变化(来源:作者)</figcaption></figure><p id="1cda" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><code class="fe nm nn no np b"><strong class="mb jt">Observations:</strong></code></p><ul class=""><li id="01ca" class="og oh jj mb b mc mv mf mw mi oi mm oj mq ok mu ol om on oo bi translated">可以看出，从12月到4月，咖啡价格较低。这是因为印度的<a class="ae jg" href="http://www.agritech.tnau.ac.in/horticulture/horti_plantation%20crops_coffee.html" rel="noopener ugc nofollow" target="_blank">咖啡收获季节</a>发生在这几个月，所以自然地，预计这几个月后商品的价格会更高。</li><li id="631f" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">茶叶价格似乎在年初和年中有所下降。这也许可以用不同茶叶的季节性采摘来解释。</li></ul><p id="c41e" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><em class="nq">那么，如何提取这些趋势和季节性信息呢？</em></p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="384b" class="nz li jj bd lj ou ov dn ln ow ox dp lr mi oy oz lt mm pa pb lv mq pc pd lx jp bi translated">快速傅里叶变换</h2><p id="30c1" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">FFT是离散傅立叶变换方法的算法实现。它是在频域中观察给定时间序列的一种手段。</p><p id="15b9" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">通过计算序列中存在的功率，可以了解时间序列中的主导频率(<em class="nq">和后续时间段</em>)。</p><p id="9dff" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><code class="fe nm nn no np b">scipy</code>中的<code class="fe nm nn no np b">fftpack</code>允许用几行简短的代码实现这个算法</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="7fe5" class="nz li jj np b gy oa ob l oc od">sig = d0.values #Just replace d0: Coffee with d1: tea<br/>time_step = 1 #1 day<br/>sig_fft = fftpack.fft(sig)<br/>sample_freq = fftpack.fftfreq(sig.size, d=time_step)<br/>power = np.abs(sig_fft)**2<br/>    <br/>pos_mask = np.where(sample_freq&gt;0) #Considering only the positive components<br/>freqs = sample_freq[pos_mask]<br/>power = power[pos_mask]</span><span id="0af3" class="nz li jj np b gy oe ob l oc od">fig = plt.subplots(figsize=[15,4])<br/>plt.title('Coffee Price Periodicity')<br/>plt.plot(1/freqs, power, color='teal')<br/>plt.xlim(0,90)<br/>plt.ylim(0,1E12)<br/>plt.xlabel('Time Period (Days)')<br/>plt.ylabel('Power (Amplitude**2)')</span></pre><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pf"><img src="../Images/b737d805ba05fe8a50a09df3572feb0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wA8ApBbSxKAp9-ZuIYGpRg.png"/></div></div></figure><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pg"><img src="../Images/ffa803649cd0f34b92dd872e0bca606b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_WFXg8QdmLmsqpoBj2aag.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图3-咖啡和茶价格的主要时间段(来源:作者)</figcaption></figure><p id="3fd0" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><code class="fe nm nn no np b"><strong class="mb jt">Observations:</strong></code></p><ul class=""><li id="3f0e" class="og oh jj mb b mc mv mf mw mi oi mm oj mq ok mu ol om on oo bi translated">咖啡和茶叶价格的主要周期约为30天。这意味着价格每30天周期性地上涨和下跌；</li><li id="0da4" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">在大约15天和大约10天观察到较小的峰值，这意味着价格中也存在不太为人所知的周期性。</li></ul><h2 id="790c" class="nz li jj bd lj ou ov dn ln ow ox dp lr mi oy oz lt mm pa pb lv mq pc pd lx jp bi translated"><strong class="ak">警告！</strong></h2><p id="0c33" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><em class="nq"> DFT及其扩展FFT，假设信号(也称为时间序列)可以由不同频率的正弦波的线性和组成。这个模型实际上是一个线性模型，严格适用于平稳信号(统计性质不随时间变化的信号)。然而，这一数据中的商品价格显然不是平稳的，似乎是非线性的。所以必须考虑另一种方法来分解时间序列。</em></p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="ccae" class="nz li jj bd lj ou ov dn ln ow ox dp lr mi oy oz lt mm pa pb lv mq pc pd lx jp bi translated">经验模态分解</h2><p id="a0d8" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">EMD是由黄锷在1996年首先提出的一种分解非线性和非平稳信号的方法。当时他在美国国家航空航天局工作，是一名流体力学家。</p><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ph"><img src="../Images/7c5dda4540b34a4e6aec44488f364c08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oGGUqJ1NlfJO7SW5.jpg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://servicetoamericamedals.org/honorees/norden-e-huang/" rel="noopener ugc nofollow" target="_blank">https://servicetoamericamedals.org/honorees/norden-e-huang/</a></figcaption></figure><ul class=""><li id="a34c" class="og oh jj mb b mc mv mf mw mi oi mm oj mq ok mu ol om on oo bi translated">EMD本质上是一种<strong class="mb jt">数据驱动</strong> <strong class="mb jt">自适应</strong>信号分解技术。在精神上，它类似于傅立叶变换。</li><li id="b2a6" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">傅立叶变换试图将信号分解成不同频率的正弦波的简单线性组合。</li><li id="89fa" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">另一方面，EMD不做这种假设，但它需要其固有元件具有本地频率。这使得它在处理非线性信号时非常有用。</li><li id="e17d" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">这些固有成分被称为<strong class="mb jt">固有模式函数(IMF) </strong>，它们代表信号中存在的各种隐藏周期。</li><li id="8f0a" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">这些IMF必须满足两个合格标准:1) <em class="nq">过零点的数量和局部极值的数量最多相差1 </em>和2) <em class="nq">局部均值必须接近零。</em></li><li id="16d4" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">从信号中提取该IMF的过程被称为<strong class="mb jt">筛选</strong>，并且递归地进行，直到满足合适的停止标准。</li></ul><p id="d67e" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">在筛选和合格标准的帮助下，可以将非线性和非平稳信号分解成其固有分量，同时保持时域和频域中的信息。</p><p id="1b6e" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">EMD可以使用最流行的Python库<code class="fe nm nn no np b">PyEMD</code>来实现(<em class="nq">EMD</em>没有多少)。FFT算法也可用于提取分解产生的IMF中的主频率</p><pre class="nr ns nt nu gt nv np nw nx aw ny bi"><span id="958b" class="nz li jj np b gy oa ob l oc od">emd = EMD()<br/>t = np.arange(0,d0.shape[0]) #Just replace d0: Coffee with d1: Tea<br/>imfs = emd(d0.values, t)</span><span id="e03c" class="nz li jj np b gy oe ob l oc od">fig,ax = plt.subplots(imfs.shape[0]+1, 1, sharex=True, figsize=[15,20])<br/>ax[0].plot(t,d0.values, color='teal')<br/>ax[0].set_ylabel('Original Coffee Price')</span><span id="7a9f" class="nz li jj np b gy oe ob l oc od">for i in range(0,imfs.shape[0]):<br/>    ax[i+1].plot(t, imfs[i])<br/>    ax[i+1].set_ylabel('IMF'+str(i))<br/>    <br/>    sig = imfs[i]<br/>    time_step = 1 #1 Day<br/>    sig_fft = fftpack.fft(sig)<br/>    sample_freq = fftpack.fftfreq(sig.size, d=time_step)<br/>    power = np.abs(sig_fft)<br/>    pos = np.where(sample_freq&gt;0)<br/>    power = power[pos]<br/>    sample_period = 1/sample_freq[pos]<br/>    s = sample_period[np.where(power==power.max())][0]<br/>    ax[i+1].set_title('Time Period: {} days'.format(np.round(s)))</span></pre><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pi"><img src="../Images/ad9b5461ab3bd58feef6749096b888a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VGt9P7DCgTszOnfKg5I3bA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图4-咖啡价格的内在模式函数(来源:作者)</figcaption></figure><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/6950e8ee9dee666f2ae20a631bf8f47c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YXAGCqRhoT246DcEq4CRBA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5 —茶叶价格的内在模式函数(来源:作者)</figcaption></figure><p id="c1c7" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated"><code class="fe nm nn no np b"><strong class="mb jt">Observations:</strong></code></p><ul class=""><li id="6daf" class="og oh jj mb b mc mv mf mw mi oi mm oj mq ok mu ol om on oo bi translated">经验模态分解将咖啡价格序列分解成若干个综合模态函数；</li><li id="003b" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">最后一个IMF ( <em class="nq">又称最低阶IMF</em>)称为残差，代表趋势；</li><li id="20d0" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">残留物显示，咖啡价格似乎呈下降趋势，而茶叶价格似乎在上升；</li><li id="7faa" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">每一个IMF都代表了价格中隐藏的周期性；</li><li id="3544" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu ol om on oo bi translated">EMD验证了在初始FFT方法中观察到的主要周期，也带来了一些额外的周期。</li></ul><h2 id="dded" class="nz li jj bd lj ou ov dn ln ow ox dp lr mi oy oz lt mm pa pb lv mq pc pd lx jp bi translated"><strong class="ak">警告！</strong></h2><p id="240b" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><em class="nq">该方法的主要问题是很难将物理意义附加到生成的IMF上。由于提取是数据驱动的，并且是从单个信号中递归完成的，因此没有很好的数学框架来理解所提取的函数。</em></p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="6b92" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">结论</h1><p id="df57" class="pw-post-body-paragraph lz ma jj mb b mc md kt me mf mg kw mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">尽管有缺点，EMD在分解非线性和非平稳信号时非常有用，不会丢失信息(<em class="nq">与FFT不同，FFT仅适用于线性平稳信号，并且仅限于频域</em></p><p id="cfe1" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">我希望这篇文章能让你体会到EMD在时间序列分析中的作用，尤其是当它与FFT结合使用时。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="e771" class="lh li jj bd lj lk nh lm ln lo ni lq lr ky nj kz lt lb nk lc lv le nl lf lx ly bi translated">进一步阅读</h1><ol class=""><li id="5d46" class="og oh jj mb b mc md mf mg mi pk mm pl mq pm mu pn om on oo bi translated"><a class="ae jg" href="https://www.clear.rice.edu/elec301/Projects02/empiricalMode/" rel="noopener ugc nofollow" target="_blank">https://www . clear . rice . edu/elec 301/projects 02/empirical mode/</a></li><li id="53ec" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu pn om on oo bi translated">A.Moghtaderi等人/计算统计和数据分析58(2013)114–126。<strong class="mb jt">doi:10.1016/j . csda . 2011 . 05 . 015</strong></li><li id="8d06" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu pn om on oo bi translated"><a class="ae jg" href="https://towardsdatascience.com/decomposing-signal-using-empirical-mode-decomposition-algorithm-explanation-for-dummy-93a93304c541" rel="noopener" target="_blank">https://towards data science . com/decompositing-signal-using-experimental-mode-decomposition-algorithm-explain-for-dummy-93a 93304 c 541</a></li><li id="78c3" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu pn om on oo bi translated"><a class="ae jg" href="https://github.com/laszukdawid/PyEMD" rel="noopener ugc nofollow" target="_blank">https://github.com/laszukdawid/PyEMD</a></li><li id="a6ae" class="og oh jj mb b mc op mf oq mi or mm os mq ot mu pn om on oo bi translated"><a class="ae jg" href="https://buildmedia.readthedocs.org/media/pdf/pyemd/latest/pyemd.pdf" rel="noopener ugc nofollow" target="_blank">https://build media . readthe docs . org/media/pdf/pye MD/latest/pye MD . pdf</a></li></ol></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><p id="d11e" class="pw-post-body-paragraph lz ma jj mb b mc mv kt me mf mw kw mh mi mx mk ml mm my mo mp mq mz ms mt mu im bi translated">再见！</p></div></div>    
</body>
</html>