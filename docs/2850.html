<html>
<head>
<title>Spark Streaming Part -1 || Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">火花流第1部分|| Python</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/spark-streaming-part-1-python-9658a292005?source=collection_archive---------1-----------------------#2022-06-16">https://pub.towardsai.net/spark-streaming-part-1-python-9658a292005?source=collection_archive---------1-----------------------#2022-06-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f62f31e03f1632eb4c1d1340546702cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TF41GE3B9jE_O9qKeqzdw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">克里斯托夫·高尔在<a class="ae kf" href="https://unsplash.com/s/photos/data-science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="c4ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">在你的房子被闯入后醒来有什么意义？难道你不觉得在大灾难已经重创你之后再警醒自己是没有用的吗？我们需要实时了解这些事情。对吗？？？</p><p id="d085" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有一个非常好的印度语短语</p><blockquote class="ln"><p id="0d13" class="lo lp it bd lq lr ls lt lu lv lw ld dk">“अब पछताये होत क्या जब चिड़ियाँ चुग गई खेत”</p></blockquote><p id="27f1" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">这意味着:- <strong class="ki iu">当鸟儿糟蹋了田野，它们吃掉了种子，什么也没有留下，</strong></p><p id="caae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">为什么现在觉得难过。</strong></p><p id="a7f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个故事的寓意是“及时做好每一件事。”</p><p id="34ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要等到太晚的时候再行动。到时候你会后悔的。</p><p id="2b2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决这些问题，我们推出了“火花流”来帮助您。</p><blockquote class="mc md me"><p id="5f2f" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu"> <em class="it">这篇文章我们要讲什么？</em>T19】</strong></p></blockquote><ul class=""><li id="4812" class="mj mk it ki b kj kk kn ko kr ml kv mm kz mn ld mo mp mq mr bi translated">什么是数据流？</li><li id="9212" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">流式数据的重要性</li><li id="ae77" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">数据流应用面临的挑战</li><li id="174c" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">什么是火花流？</li><li id="9a3d" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">使用Socket || Python的实时数据流</li></ul><p id="6d2c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">我们出发吧！！（🌟)</strong></p><blockquote class="mc md me"><p id="eaa8" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">什么是数据流？</strong></p></blockquote><p id="e077" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">单词“流”用于描述连续的、永不结束的数据流，没有起点和终点，</p><p id="347c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据流是传输称为流的连续数据流的过程，</p><p id="f69f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据流由一系列按时间顺序排列的数据组成。例如，数据流包括传感器数据、交易日志、IOT数据、网络浏览器日志等等。</p><p id="fee1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以将数据流视为一条传送带，它携带数据并将其存储在数据库中，随后可用于实时检测欺诈、监控健康状况、发送警报并实时可视化数据，这非常有帮助。</p><blockquote class="mc md me"><p id="3d4f" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">流数据的重要性:</strong></p></blockquote><p id="351f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天的数据是由无限量的来源生成的，它们可以是IOT数据传感器、网络日志、游戏应用程序、安全日志、服务器等等，几乎不可能控制和管理数据。</p><p id="c2d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以处理数据流的应用程序需要一些功能:存储和数据处理，</p><p id="38fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">存储必须能够处理大量实时数据</p><p id="2aa0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据处理必须能够相应地处理和发送要求</p><blockquote class="mc md me"><p id="2224" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">实时数据流的真实世界示例</strong></p></blockquote><figure class="my mz na nb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mx"><img src="../Images/5c16d53af2e050dbfb5d436a410fc0b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pg6iWOY2T_EBC_V7f9edcw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">拉斯·金勒在<a class="ae kf" href="https://unsplash.com/s/photos/data-streaming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><ul class=""><li id="7c11" class="mj mk it ki b kj kk kn ko kr ml kv mm kz mn ld mo mp mq mr bi translated">欺诈检测</li><li id="3450" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">实时多人游戏</li><li id="ccc2" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">物联网传感器数据</li><li id="9cf5" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">客户活动</li><li id="9be3" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">实时检测仇恨言论(社交媒体)</li><li id="2348" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">社交媒体推送</li><li id="c198" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated">AL/ML实时预测</li></ul><p id="5941" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如此等等，不胜枚举…</p><blockquote class="mc md me"><p id="1597" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">数据流应用面临的挑战</strong></p></blockquote><ul class=""><li id="7c1c" class="mj mk it ki b kj kk kn ko kr ml kv mm kz mn ld mo mp mq mr bi translated"><strong class="ki iu">可扩展性:- </strong>我们需要一个能够根据需要存储和扩展的系统，因为我们有大量的数据。</li><li id="42ed" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated"><strong class="ki iu">容错和数据保证:- </strong>对于来自不同来源、位置、格式和不同速度的数据，为了处理和存储所有这些数据，我们的系统必须具有容错能力，并确保用户发送的任何数据都能被我们的流管道接收，从而确保数据保证。</li><li id="d3d6" class="mj mk it ki b kj ms kn mt kr mu kv mv kz mw ld mo mp mq mr bi translated"><strong class="ki iu">排序:- </strong>由于我们的数据以不同的速度到来，我们需要确保数据有序，否则就没有任何意义，并且我们的流处理管道必须知道数据事务属性。</li></ul><p id="011b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了维护所有这些属性，我们将使用众所周知的“Apache Spark ”,并且我们使用套接字处理实时传入的数据。</p><blockquote class="mc md me"><p id="0e53" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">什么是火花流:- </strong></p></blockquote><figure class="my mz na nb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/06c882769433f0b3833dd9c126d5f892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZFwYYVw7YPmLRz2_Lu-liQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://spark.apache.org/docs/latest/img/streaming-arch.png" rel="noopener ugc nofollow" target="_blank">https://spark.apache.org/docs/latest/img/streaming-arch.png</a></figcaption></figure><p id="b066" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Spark Streaming是处理高列数据的高速引擎，它比谷歌的MapReduce快100倍，原因是它使用分布式数据处理，可以生成小块数据，并在服务器上并行计算。</p><p id="ff7a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Spark Streaming使用Spark Core的快速调度功能来执行流分析。它以小批量的方式接收数据，并对这些小批量的数据执行RDD变换。这种设计使得为批量分析编写的同一组应用程序代码能够用于流分析，从而有助于lambda架构的轻松实现。</p><p id="b481" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，这种便利伴随着等待时间等于小批量持续时间的代价。其他逐事件处理而不是小批量处理的流数据引擎包括Storm和Flink的流组件。Spark Streaming内置了对Kafka、Flume、Twitter、ZeroMQ、Kinesis和TCP/IP套接字消费的支持。[维基]</p><p id="41ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Spark流是大数据最重要的部分之一。其实时地从不同的源接收数据并对其进行处理，并对其应用Al/ML模型和其他功能，以将其存储在数据库中或进行实时操作。</p><blockquote class="mc md me"><p id="0c3b" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">使用Socket || Python的实时数据流</strong></p></blockquote><figure class="my mz na nb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/22a1bdb7d2eed797528dca907b3ec11d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gs24QdA2vsGQ2zPd3OyGUA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">【https://spark.apache.org/docs/latest/img/streaming-flow.png T2】号</figcaption></figure><p id="3f68" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">步骤1:-创建Spark会话:</strong></p><p id="f7ac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Spark session是Spark应用程序的入口点，在这里我们可以定义我们的spark应用程序名称，这个名称应该是唯一的，因为spark根据应用程序名称来识别运行的集群。创建spark会话</p><pre class="my mz na nb gt ne nf ng nh aw ni bi"><span id="68b4" class="nj nk it nf b gy nl nm l nn no"># creating spark session</span><span id="4c80" class="nj nk it nf b gy np nm l nn no">spark = SparkSession.builder.appName(“SocketExample”).master(‘local[*]’).getOrCreate()</span></pre><p id="2ef7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">步骤2:-创建一个从套接字读取数据的函数:- </strong></p><ul class=""><li id="1aa6" class="mj mk it ki b kj kk kn ko kr ml kv mm kz mn ld mo mp mq mr bi translated">需要创建stream_df，它包含来自某个端口和主机名的套接字的数据</li></ul><pre class="my mz na nb gt ne nf ng nh aw ni bi"><span id="736b" class="nj nk it nf b gy nl nm l nn no"># loading/reading data from socket</span><span id="3c8f" class="nj nk it nf b gy np nm l nn no">stream_df = spark.readStream.format(‘socket’).option(“host”,host).option(“port”,port).load()</span></pre><p id="285f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">步骤3:-检查数据是否为流，并打印模式</strong></p><pre class="my mz na nb gt ne nf ng nh aw ni bi"><span id="3126" class="nj nk it nf b gy nl nm l nn no"># check if still streaming</span><span id="edec" class="nj nk it nf b gy np nm l nn no">print(stream_df.isStreaming)<br/>stream_df.printSchema()</span></pre><p id="d5f4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">步骤4:-将接收到的数据写入控制台(我们也可以保存该数据，我们将在后续文章中看到)</strong></p><pre class="my mz na nb gt ne nf ng nh aw ni bi"><span id="26f7" class="nj nk it nf b gy nl nm l nn no"># write stream in console</span><span id="6fe5" class="nj nk it nf b gy np nm l nn no">write_query = stream_df.writeStream.format(‘console’).start()</span></pre><p id="b8aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">步骤5:等待插座关闭</strong></p><pre class="my mz na nb gt ne nf ng nh aw ni bi"><span id="df18" class="nj nk it nf b gy nl nm l nn no">write_query.awaitTermination()</span></pre><p id="7dfb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，现在让我们看看完整的代码</p><blockquote class="mc md me"><p id="0a89" class="kg kh mf ki b kj kk kl km kn ko kp kq mg ks kt ku mh kw kx ky mi la lb lc ld im bi translated"><strong class="ki iu">完整代码:- </strong></p></blockquote><figure class="my mz na nb gt ju"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="66cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，打开两个终端，在一个终端使用“netcat -lk 1100”启动服务器，在另一个服务器上运行“socket_streaming.py”和WALLA！！</p><figure class="my mz na nb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/46754838c9fb14a4894d240c7113a05a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYLUZKDvNbRgqGjUpsrSTw.png"/></div></div></figure><p id="0321" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，我们能够发送数据，并且能够批量实时获取数据。</p><p id="5145" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，在接下来的文章中，我们将了解如何使用触发器来执行某些操作，以及如何实时执行数据转换，等等，敬请关注…</p><p id="6eb5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就这样吧，下一篇文章再见。</p><p id="74ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我已经为那些不属于我的图片提供了图片链接。</p><p id="1b36" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">我们来连线一下</strong><a class="ae kf" href="https://www.linkedin.com/in/iamhimanshu0/" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">Linkedin</strong></a><strong class="ki iu"/><a class="ae kf" href="https://twitter.com/iam_himanshu0" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">Twitter</strong></a><strong class="ki iu"/><a class="ae kf" href="https://instagram.com/iamhimanshu0/" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">insta gram</strong></a><strong class="ki iu"/><a class="ae kf" href="https://github.com/iamhimanshu0" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">Github</strong></a><strong class="ki iu">，以及</strong> <a class="ae kf" href="https://www.facebook.com/iamhimanshu0" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">脸书</strong> </a> <strong class="ki iu">。</strong></p><p id="7598" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">感谢阅读！</strong></p></div></div>    
</body>
</html>