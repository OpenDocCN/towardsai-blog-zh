<html>
<head>
<title>How I Built a Colorectal Cancer Tissue Classifier through Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何通过深度学习构建结直肠癌组织分类器</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-i-built-a-colorectal-cancer-prediction-platform-through-deep-learning-343aeb24d34a?source=collection_archive---------3-----------------------#2020-08-25">https://pub.towardsai.net/how-i-built-a-colorectal-cancer-prediction-platform-through-deep-learning-343aeb24d34a?source=collection_archive---------3-----------------------#2020-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0a2d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/870b03190d063b3b3e1455ac81d90276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PdkDy5VEskLBCxLsdL0_GQ.png"/></div></div></figure><p id="b49e" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我相信人工智能可以<strong class="km jd"> <em class="li">拯救</em> </strong>人类。</p><p id="d067" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">然而具有讽刺意味的是，正如任何普通科幻小说所描绘的那样，任何先进的人工智能都会突然想到<strong class="km jd"> <em class="li">灭绝</em> </strong> <em class="li"> </em>人类是世界和平的解决方案。</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi lj"><img src="../Images/e2efafa7469b69409d6d7eb5f05dc803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*iOfFbHdMC9wurfPqP0zQDg.gif"/></div></div></figure><p id="bc99" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">天网的幻想离实现还有点遥远…至少现在是这样。</p><p id="0fa1" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">开玩笑，与其关注人工智能导致人类毁灭的0.001%的概率，不如考虑人工智能可能对社会非常有益，特别是在医疗保健领域。</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/c2bdb2fd8d65ede7ad5e8a38d99fb436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gz2nsp2lfr49fW0Ux6wXbQ.gif"/></div></figure><p id="43ea" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">人工智能在医疗保健领域的应用是无限的，在精准医疗、健康分析、医疗信息学等领域提供了巨大的潜力。</p><p id="67e2" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">在我的情况下，我试图调查人工智能在肿瘤学领域的潜力。我试图利用深度学习的力量来建立经过训练的神经网络，以更准确和有效地确定结肠直肠组织是否包含肿瘤。</p><h1 id="f90c" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">为什么是Cloudiopsy？</h1><p id="171b" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">仅在2018年，结肠直肠癌就夺去了大约180万人的生命(世卫组织，2018年)。事实上，在菲律宾，结直肠癌被视为头号胃肠癌(Afinidad-Bernardo，2017)。然而，幸运的是，结直肠癌是可以预防的，如果在早期发现，结直肠癌是可以治愈的。</p><p id="72e2" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">因此，Cloudiopsy被设计为结肠直肠癌预测平台，其可以容易地在全国分布，以通过区分正常粘膜组织和上皮腺癌(肿瘤)组织来辅助诊断。这是在菲律宾普及结肠直肠癌预测的一种经济有效的方式，因为该诊断平台在未来可以很容易地在线获得。</p><h1 id="3ed8" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">那是什么？</h1><p id="3254" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">简单来说，<a class="ae ms" href="http://cloudiopsy.github.io" rel="noopener ugc nofollow" target="_blank"> Cloudiopsy </a>平台通过迁移学习，使用<a class="ae ms" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>和在Google Colab上训练的<a class="ae ms" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>后端，并通过<a class="ae ms" href="https://js.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow.js </a>在浏览器中提供预测，通过神经网络模型预测图像输入。</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi mt"><img src="../Images/272835d1a1ffc2a2ceebeb6c77fe976b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BMsXl40kr7xrV7ppbqrAA.png"/></div></div></figure><h1 id="c8ee" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">结直肠癌背后的基本病理学直觉</h1><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/5c48a5af9c278c594e4befc630690bb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*QHJN3oh3qHC58YMm3FVG6A.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">这些是来自组织病理学结肠直肠组织样本数据集的图像，将在下面的部分中简要讨论。</figcaption></figure><p id="c7de" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">左图是一个正常粘膜组织层的例子。可以看出，杯状细胞(粘液分泌细胞)的大小相对相同，并分布于结肠隐窝(一种肠腺，其横截面为椭圆形)。这表明隐窝是健康的，因此，这张照片取自正常粘膜组织。</p><p id="f350" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">与右图相反，杯状细胞在组织内部不再可见，这意味着它已经是肿瘤组织。这种类型的肿瘤具体称为上皮腺癌。如果发送的其他区域样本也被证明含有肿瘤，这可能是结肠直肠癌的指标。</p><p id="efb5" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">给定活检的组织样本的当前分析方法是手动扫描样本，并通过查看组织的结构来寻找癌变区域。然而，扫描整个区域是非常费力的，并且容易出现人为错误。因此，理想的情况是自动完成这一过程，并找到一种方法来创建一个平台，该平台将自动确定补片是正常组织还是癌症组织，并返回预测结果。</p><h1 id="7970" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">神经网络和迁移学习</h1><p id="ac28" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">神经网络是大脑中的一组连接，电信号通过彼此发射来产生思想、想法、情感等。另一方面，当我们学习时，我们重新安排这些神经元之间的这些连接，以学习新的模式和概念。</p><p id="d9ee" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">模仿我们的大脑，神经网络可以通过数学运算转换信息，以获得特定的输出。因此，神经网络有能力将图像或语音等复杂模式转换为数值，并通过乘以权重对这些值进行数学转换，从而对它们进行分类。</p><p id="e309" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">权重只是输入被乘以或变换的值。这些权重被修改，直到产生特定的输出(分类或预测)。</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/fb49580b14963b587037245cf823c7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*A5m3-9ExjvVKwcfpguXFBw.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk translated">一个样本神经网络</figcaption></figure><p id="b07f" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">此外，为了捕获模式并“学习”哪个是肿瘤，哪个是正常的，神经网络中的某些层可能负责学习关于图像的某些特征。初始层可能负责识别诸如边和角的特征，并沿着神经网络移动，一些层经历更高层次的抽象，例如理解形状(圆对椭圆)，以及随后可能理解这些形状之间的距离等。</p><p id="7f2c" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">一种方法是从头开始训练神经网络。然而，在我的项目中，知道较低层可能负责边缘检测和形状检测，我没有从头开始训练，而是使用迁移学习，其中我用来自预训练神经网络的预训练权重来初始化它。具体来说，我在Mobilenet V2模型上进行了预培训。</p><h1 id="effe" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">数据集</h1><p id="e0f6" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">该项目使用的数据集是由Kather、Halama和Marx准备的人类结肠直肠癌和健康组织的100，000张组织学图像。据研究人员称，该数据集由10万张苏木精&amp;曙红(H &amp; E)染色的人类结直肠癌(CRC)和正常组织的组织学图像组成，这些图像是从NCT生物库和UMM病理学档案馆的样本中整理出来的(Kather，Halama &amp; Marx，2016)。</p><h1 id="87b6" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">构建模型</h1><p id="0aa9" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">为了建立神经网络模型，我利用Google Colab对超过4534幅图像(2235幅肿瘤组织图像和2299幅正常组织图像)进行了训练。我有1330张图像用于验证(正常组织656张，肿瘤组织674张)和1653张图像(正常组织810张，肿瘤组织843张)用于测试数据集。</p><p id="dc28" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我已经利用Keras与Tensorflow后端设计的神经网络与那达慕优化器，训练50个时代。</p><p id="a85c" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我的模型的具体架构如下所示:</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0b7521d5fc0616eac4f13acfd4ebbdec.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*nCjVf2_oWG2dJyMA_MaMlg.png"/></div></figure><h1 id="6a43" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">结果</h1><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nb"><img src="../Images/829a7bd73d9355fd37c9dcf81b737ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uayX5uK9dTZEom9pTgONZQ.png"/></div></div></figure><p id="18fa" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">损失函数基于二元交叉熵。该模型的最终测试准确率为98.79%，F1值为0.987。模型的最终大小为75.5 MB。</p><h1 id="8c56" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">使用Tensorflow.js提供服务</h1><p id="915e" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">为了在线提供服务，我使用了tfjs转换器，它将模型转换成model.json文件和shard文件，这些文件将用于加载模型。我编写了一个简单的脚本来加载model.json并通过<a class="ae ms" href="http://cloudiopsy.github.io" rel="noopener ugc nofollow" target="_blank"> cloudiopsy.github.io </a>提供预测。</p><figure class="lk ll lm ln gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/6eda5521b2f49c59c0fb8ddd25372d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yn0kzaFwsSRtC-n_dJdBTQ.png"/></div></div></figure><h1 id="3e98" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">结论</h1><p id="1707" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">这仍然是一项进展中的工作，因为更高的精度更有利于创建一个对病理学家和医疗专业人员非常有用的工具。此外，对临床设置的测试将揭示软件中可能的改进。然而，有一天，Cloudiopsy有望通过更快地分析结肠直肠活检来帮助诊断结肠直肠癌，并帮助全球抗癌倡议。</p><h1 id="77a8" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">感谢</h1><p id="b7f4" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">我要感谢我的导师Martin Gomez先生、Daphne Ang博士以及我的父母Serafin Serapio博士和Cherry Serapio博士，是他们帮助我使这个项目成为可能。</p><h1 id="8f1a" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">参考资料:</h1><p id="a273" class="pw-post-body-paragraph kk kl it km b kn mn kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld mr lf lg lh im bi translated">f . chollet(2016年)。使用非常少的数据构建强大的图像分类模型。检索自<a class="ae ms" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank">https://blog . keras . io/building-powerful-image-class ification-models-using-very-little-data . html</a>。</p><p id="1e3d" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">马丁森，C. (2018)。Keras中的迁移学习和数据扩充。从<a class="ae ms" href="https://craigmartinson.com/post/keras-transfer-learning/" rel="noopener ugc nofollow" target="_blank">https://craigmartinson.com/post/keras-transfer-learning/</a>取回。</p><p id="b923" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">数据集:</p><p id="43b6" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">j . n . kather，n . Halama，Marx，A. (2016)。人类结肠直肠癌和健康组织的100，000张组织学图像。[图像数据集]。从<a class="ae ms" href="https://zenodo.org/record/1214456." rel="noopener ugc nofollow" target="_blank">https://zenodo.org/record/1214456.</a>取回</p></div></div>    
</body>
</html>