<html>
<head>
<title>4 Elegant Ways to Deal With Missing Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理缺失数据的4种优雅方式</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/4-elegant-ways-to-deal-with-missing-data-68951629e2c8?source=collection_archive---------1-----------------------#2022-05-26">https://pub.towardsai.net/4-elegant-ways-to-deal-with-missing-data-68951629e2c8?source=collection_archive---------1-----------------------#2022-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="928d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用4种技术对缺失数据进行插补</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d475503eba509901266dd0cfc4741e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e41A-e-K6h5niEl_"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">艾米丽·莫特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="eafe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有一些现实世界数据分析或数据科学的经验，你会知道<strong class="lb iu"> 80%的工作是关于数据收集和数据准备</strong>。<strong class="lb iu">只有20%是真实数据分析</strong>和建模。即使你没有真实世界的经验，你也可能已经在别处读到过。数据准备的一个主要步骤是处理缺失值。</p><p id="76de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在数据分析领域，很难找到没有丢失值的数据库。如果您发现这些罕见的数据库之一，可能是因为其他人已经清理过数据并为您完成了工作，或者数据集很小，不复杂，易于处理并捕捉缺失条目的真实值。如果您的数据足够大，并且缺失值确实占了数据的很大一部分，您可以简单地删除不完整的观察值。但是，如果您的所有观察值都有价值，您需要应用缺失值插补技术。</p><p id="f14d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们回到现实世界。您已经完成了所有的数据库查询、表合并和连接，以及一些表数据透视，并且您已经有了一个最终的表，其中包含了为分析而选择的数据。然而，你还没有准备好开始你的分析和建立你的机器学习模型，因为你仍然需要解决缺失的数据。</p><p id="36a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将讨论缺失值插补的四种技术，并提供python代码示例。我会使用你可以在Kaggle上轻松免费找到的数据集<a class="ae ky" href="https://www.kaggle.com/datasets/awaiskaggler/insurance-csv" rel="noopener ugc nofollow" target="_blank"> insurance.csv </a>。如果你想了解这个例子，我建议你下载数据集并使用Google Colab。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7d2f" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Import libraries:</strong><br/>import pandas as pd<br/>import numpy as np<br/>import random</span><span id="7565" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">#Import and load dataset:<br/></strong>df = pd.read_csv('/content/insurance.csv')<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/434ea12e9024ce6a637170b4983cbbe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*bvUli4-WSMI3a9kuyw4DdQ.png"/></div></figure><p id="215e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，只有通过目视检查，我们的数据框才没有缺失值。我们可以通过键入以下命令来检查它:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="212c" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Check for NAN values in dataframe:</strong><br/>print(df.isnull().values.any(), df.isnull().sum().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/3c66e672b0b8cbc374da58558075cb66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*ENL1TaIruKVYab36KqjDww.png"/></div></figure><p id="3d38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的数据框没有任何缺失值，因此我们需要人工插入一些值。我们将插入10%的缺失值，同时确保没有任何行或线完全被NAN值填充。记住我们的数据框是一个代数矩阵，有<strong class="lb iu"> <em class="mj"> i </em> </strong>行和<strong class="lb iu"> <em class="mj"> j </em> </strong>列。我们将为矩阵中的行和列创建一个难以处理的变量:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="94ec" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Iteractions with i(rowns) and j(columns):</strong><br/>ij = [(row, col) for row in range(df.shape[0]) for col in range(df.shape[1])]</span></pre><p id="fbce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在在随机位置插入随机NAN:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="648d" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Insert NAN values:</strong><br/>for row, col in random.sample(ij, int(round(.1*len(ij)))):<br/>        df.iat[row, col] = np.nan</span></pre><p id="825f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们再次检查我们的数据框，我们现在会发现大约10%的NAN值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/96add558338ab0c416f10a73bc07f79c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*FqqOQFk-H1mhmtvHW2yVaA.png"/></div></figure><p id="1461" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查整个数据集中的NAN值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="28c4" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Check NAN in data frame:</strong><br/>print(df.isnull().values.any(), df.isnull().sum().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/2eaef7ea60e73bd00a40378a387f8b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*fwgX19QVF4uERjPd9Rg7iw.png"/></div></figure><p id="5bc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查特定列中的NAN值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7432" class="ma mb it lw b gy mc md l me mf">print('Age NAN: ', df['age'].isnull().sum())<br/>print('Sex NAN: ', df['sex'].isnull().sum())<br/>print('BMI NAN: ', df['bmi'].isnull().sum())<br/>print('Children NAN: ', df['children'].isnull().sum())<br/>print('Smoker NAN: ', df['smoker'].isnull().sum())<br/>print('Region NAN: ', df['region'].isnull().sum())<br/>print('Charges NAN: ', df['charges'].isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/0d1da815b54e3c6775cd067a97a39c41.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*aOfWyoUTvtOXm_CgYqPmSg.png"/></div></figure><p id="e40f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了NAN值，我们准备开始用合适的值替换它们。</p><h2 id="5ed6" class="ma mb it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">1.根据分析师知识和问题需求使用一些常数</h2><p id="73b2" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">输入缺失值的一个最简单的方法是根据研究者对所研究问题的了解使用一些常数。在本例中，我们将学习如何用0替换[' <strong class="lb iu"> children </strong> ']列中所有缺失的值(NAN)。这并不一定反映问题知识，这是一个如何将这种技巧应用到日常实践中的例子。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e0ff" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Fill NAN with 0 in children column with pandas:</strong><br/>df['DataFrame Column'] = df['DataFrame Column'].fillna(0)</span><span id="82b6" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">#Fill NAN with 0 in children column with numpy:</strong><br/>df['DataFrame Column'] = df['DataFrame Column'].replace(np.nan, 0)</span></pre><p id="7920" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以使用<strong class="lb iu">熊猫</strong>或<strong class="lb iu"> numpy </strong>图书馆来完成任务。随便选一个。运行代码后，如果再次检查['children']列的NAN值，将得到以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8581b6d62029e735cfb7520e24cde27a.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*oyw-rDviZcSVLmxP4vQ-Vw.png"/></div></figure><p id="afd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在提供的代码中，你可以用任何你想要的值来改变0，只要它是一个常量。</p><h2 id="8b4d" class="ma mb it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">2.估算平均值(数值变量)或众数(分类变量)</h2><p id="d5aa" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">下一项技术是使用mean或mode来输入缺失值，这取决于我们有数值变量还是分类变量。在这个例子中，我将解释这两种情况。我们将为[' <strong class="lb iu"> bmi </strong> '](数字)和[' <strong class="lb iu">区域</strong> '](分类)输入缺失值。</p><p id="3bef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步是获取[' <strong class="lb iu"> bmi </strong> ']列的平均值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9d42" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Get mean for column bmi:</strong><br/>print('Mean BMI is: ', df["bmi"].mean())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/190cf3b21f1213ce09ff97c00f3195f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*jMVuJtaPnb1E1qXAMcEKHw.png"/></div></figure><p id="0b86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们替换NAN值并再次检查NAN:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d697" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Replace NAN values with mean:<br/></strong>df['bmi'] = df['bmi'].fillna(30.62)<br/>print('BMI NAN: ', df['bmi'].isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/b35caac9f99cc74ef694884ec3fbfab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*A2UkM50Lf4QUrazceECuKQ.png"/></div></figure><p id="8c51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要输入分类变量的缺失值，我们需要找到模式:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9807" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Get mode for column region:<br/></strong>print('Mode region is: ', df["region"].mode())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/ac9028e396463aa7949585fae69cb94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*-JIDKspej-ClRQEXi2DpvQ.png"/></div></div></figure><p id="3be1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后相应地填充NAN值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5b59" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Replace NAN values with mode:<br/></strong>df['region'] = df['region'].fillna('southeast')<br/>print('Region NAN: ', df['region'].isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/84bac28f40edefe159f729bc34c0e8c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*-72whgFu5za8SBvf8K2O2g.png"/></div></figure><h2 id="518d" class="ma mb it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">3.估算从观察到的分布中产生的随机值</h2><p id="b3b8" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">我们可以从列分布中生成随机值，并将它们输入到NAN条目中。我们只需要小心我们的列分布是否正常，以便不影响分布。我将针对这两种场景给出两个例子:正态分布和非正态分布。我们将检查年龄变量是否正态分布:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="b745" class="ma mb it lw b gy mc md l me mf">import seaborn as sns</span><span id="fcb3" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">#Build and histogram:</strong><br/>sns.distplot( a=df["age"], hist=True, kde=False, rug=False )</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/6cac2c6c5b8f9c2a28f7a5fba8c289d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*kTRsvXijsi05IBwD_t07kQ.png"/></div></figure><p id="1e41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过直方图，可以看出数据不是正态分布的。</p><blockquote class="np nq nr"><p id="c20b" class="kz la mj lb b lc ld ju le lf lg jx lh ns lj lk ll nt ln lo lp nu lr ls lt lu im bi translated"><strong class="lb iu">非正态分布:</strong></p></blockquote><p id="5004" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分布不是正态的，所以我们不需要担心在我们的缺失值中，我们可以在观测值中生成从最小值到最大值的随机值。第一步是检查列的最大值和最小值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9181" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Get maximum and minimum values:</strong><br/>print('Min age: ', df["age"].min())<br/>print('Max age: ', df["age"].max())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ba363b20acc69a6bfeea7c342b45a53b.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*DEFfmwG2hanDn3Vzs6XdTg.png"/></div></figure><p id="f22d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在创建一个函数来生成18到64之间的值，并用NAN值替换它们:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3b70" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Create a function to generate randon values and replace them in NAN:</strong></span><span id="6b63" class="ma mb it lw b gy mg md l me mf">def fill_missing(value):<br/>    if np.isnan(value) == True:<br/>        value = np.random.randint(18, 64)<br/>    else:<br/>        value = value<br/>    return value</span></pre><p id="d925" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将该函数应用于我们的列:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6ef0" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Replace NAN values with random generated values:<br/></strong>df['age'] = df['age'].apply(fill_missing)<br/>print('Age NAN: ', df['age'].isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/0b2512872adbee58256d07ffea04b573.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*XBYcbQW930LPQ76c8uYy8Q.png"/></div></figure><blockquote class="np nq nr"><p id="afbe" class="kz la mj lb b lc ld ju le lf lg jx lh ns lj lk ll nt ln lo lp nu lr ls lt lu im bi translated"><strong class="lb iu">正态分布数据:</strong></p></blockquote><p id="adcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有正态分布的数据，过程是类似的，但是您需要对生成的值更加小心，并确保它们不会影响分布。我们需要得到平均值和标准差:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2287" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Get mean and st deviation:<br/></strong>mean = df['age'].mean()<br/>std = df['age'].std()<br/>print("Mean is: ", mean)<br/>print("SD is: ", std)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/c91b9afa99c32e628de86886efff9744.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*ZfQEcQCjzQhur6K8biP5_Q.png"/></div></figure><p id="731b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在创建函数:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d5ef" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Create a function to generate randon values and replace them in NAN:</strong><br/>def fill_missing_normal(value):<br/>    if np.isnan(value) == True:<br/>        value = np.random.normal(mean, std, 1)<br/>    else:<br/>        value = value<br/>    return value</span></pre><p id="a20d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一步是应用函数:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9d59" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Replace NAN values with random generated values:<br/></strong>df['age'] = df['age'].apply(fill_missing_normal)<br/>print('Age NAN: ', df['age'].isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/2cede0cdef184c041762c176a2f72e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*HRfCA4DGaWsvSsspyY0SpQ.png"/></div></figure><h2 id="3e78" class="ma mb it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">4.使用线性回归预测连续变量的缺失值</h2><p id="e91f" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">在下一步中，我们将学习如何用连续变量[' <strong class="lb iu">电荷【T1]']的线性回归预测值替换缺失值。第一步是删除数据集中的NAN值，因为我们需要构建一个线性回归模型，它不接受NAN作为输入值。</strong></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="cc0b" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Drop NAN:</strong><br/>df_lm = df.dropna()</span></pre><p id="480a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在创建一个线性回归模型:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d8b9" class="ma mb it lw b gy mc md l me mf">from sklearn.linear_model import LinearRegression</span><span id="148c" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">#Define X and y and drop non-numerical variables:</strong><br/>X = df_lm.drop(['charges', 'sex', 'region', 'smoker'], axis=1)<br/>y = df_lm['charges']</span><span id="6ebe" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu">#Model fit:</strong><br/>lm = LinearRegression().fit(X, y)</span></pre><p id="0d4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，与我们在上一节中所做的类似，我们需要创建一个函数来替换丢失的值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7a64" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Define function:</strong><br/>def fill_missing_lm(value):<br/>    if np.isnan(value) == True:<br/>        value = lm.predict()<br/>   else:<br/>        value = value<br/>   return value</span></pre><p id="97db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并将函数应用于数据:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="139c" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">#Replace NAN values with generated values from linear model:<br/></strong>df[‘charges’] = df[‘charges’].apply(fill_missing_normal)<br/>print(‘Charges NAN: ‘, df[‘charges’].isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f6cdb48304a424ef0bb9e7e848283f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*KCWYyP-QvLxcLGuN1VpDbg.png"/></div></figure><blockquote class="oa"><p id="0593" class="ob oc it bd od oe of og oh oi oj lu dk translated">感谢您的阅读！如果你有建议要添加到这个列表中，请告诉我，不要忘记订阅以接收关于我未来出版物的通知。</p></blockquote><p id="49bd" class="pw-post-body-paragraph kz la it lb b lc ok ju le lf ol jx lh li om lk ll lm on lo lp lq oo ls lt lu im bi translated"><strong class="lb iu">如果:</strong>你喜欢这篇文章，别忘了关注我，这样你就能收到关于新出版物的所有更新。</p><p id="07c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">其他如果:</strong>你想了解更多，你可以通过<a class="ae ky" href="https://cdanielaam.medium.com/membership" rel="noopener">我的推荐链接</a>订阅媒体会员。它不会花你更多的钱，但会支付我一杯咖啡。</p><p id="fbc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">其他:</strong>谢谢！</p></div></div>    
</body>
</html>