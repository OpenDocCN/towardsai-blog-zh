<html>
<head>
<title>Flask Web Application with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的Flask Web应用程序</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/flask-web-application-with-python-4a290c952ba2?source=collection_archive---------0-----------------------#2020-09-01">https://pub.towardsai.net/flask-web-application-with-python-4a290c952ba2?source=collection_archive---------0-----------------------#2020-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7345" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a>、<a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a>、<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="d8c8" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">开发一个卷积神经网络模型，并使用Flask将其部署为web应用程序</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/dda94e55cdee9a9984a2e6b5e204b5bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*sNYQK1-uN4WEf8SS.jpg"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">来源:<a class="ae la" href="https://www.fiverr.com/bhishan/build-api-in-python-flask" rel="noopener ugc nofollow" target="_blank"> Fiverr </a></figcaption></figure><p id="9be8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi lx translated"><span class="l ly lz ma bm mb mc md me mf di"> W </span>随着深度学习模型的训练，我们如何将训练好的模型部署为web应用？进入<strong class="ld ja">Flask</strong>——Python最流行的web应用框架。通过利用Flask的功能，我们可以为全栈应用程序建立一个强大的基础，为更广泛和功能丰富的网站探索新的领域。它使用户能够完全控制网页服务和内部数据流。</p><p id="60f0" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们将处理下面的问题陈述，并探索迁移学习和flask web应用程序在深度学习项目中的使用。</p><h1 id="9116" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">问题陈述:</h1><h2 id="5ace" class="my mh iq bd mi mz na dn mm nb nc dp mq lk nd ne ms lo nf ng mu ls nh ni mw iw bi translated">(I)利用迁移学习开发一个用于鸟类分类的卷积神经网络(CNN)模型。</h2><h2 id="693d" class="my mh iq bd mi mz na dn mm nb nc dp mq lk nd ne ms lo nf ng mu ls nh ni mw iw bi translated">(ii)使用用户界面部署经训练的模型以接受图像用于分类。</h2><p id="f4ba" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">让我们不要从零开始建立一个CNN模型，而是通过建立迁移学习思想来解决问题陈述，正如我在之前的帖子中所讨论的:</p><div class="no np gp gr nq nr"><a href="https://medium.com/towards-artificial-intelligence/transfer-learning-using-a-pre-trained-model-c599e353bbe3" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ja gy z fp nw fr fs nx fu fw iz bi translated">使用预先训练的模型进行迁移学习</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">探索VGG16在图像分类中的应用</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ku nr"/></div></div></a></div></div><div class="ab cl og oh hu oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ij ik il im in"><p id="8e32" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">计算机视觉任务是计算密集型和重复的，它们通常超过CPU的实时能力，几乎没有时间用于更高级别的任务。与CPU相比，GPU旨在同时快速渲染高分辨率图像和视频。</p><p id="d460" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">GPU最大的<strong class="ld ja">优势是能够对多组数据执行并行操作。GPU采用数千个处理器内核同时运行的设计，支持大规模并行处理，每个内核都专注于高效计算。</strong></p><p id="84d7" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">要免费访问现成的GPU，您可以利用<a class="ae la" href="https://colab.research.google.com/notebooks/intro.ipynb#" rel="noopener ugc nofollow" target="_blank"> Colab </a>，这是一个Python开发环境，使用谷歌云在浏览器中运行。然而，请记住它的<a class="ae la" href="https://research.google.com/colaboratory/faq.html#resource-limits" rel="noopener ugc nofollow" target="_blank">资源限制</a>。另一个选择是在你的笔记本电脑上安装CUDA工具包。在继续下一步之前，请检查您的NVIDIA GPU的计算能力。</p><p id="ed18" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这里有一些资源可以帮助您开始:</p><ul class=""><li id="cd74" class="on oo iq ld b le lf lh li lk op lo oq ls or lw os ot ou ov bi translated"><a class="ae la" href="https://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank"> GPU计算能力</a></li><li id="4482" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw os ot ou ov bi translated"><a class="ae la" href="https://docs.nvidia.com/cuda/index.html" rel="noopener ugc nofollow" target="_blank"> CUDA工具包文档版本11.0.3 </a></li><li id="9f22" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw os ot ou ov bi translated"><a class="ae la" href="https://towardsdatascience.com/installing-tensorflow-with-cuda-cudnn-and-gpu-support-on-windows-10-60693e46e781" rel="noopener" target="_blank">在Windows 10上安装支持CUDA、cuDNN和GPU的Tensorflow】</a></li></ul><p id="12b9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">一旦你安装了CUDA工具包，在命令行输入<strong class="ld ja"> nvidia-smi </strong>来报告安装的GPU统计数据。如果安装成功，您应该能够看到类似的GPU统计输出，如下所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pb"><img src="../Images/ddff477a5991b159edac0a49177abde6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qA60ek8EG84lKlv9pnTaIQ.png"/></div></div></figure><h1 id="b39c" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">既然GPU已经可以使用了，我们就来编码吧！</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h1 id="2463" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">数据准备</h1><p id="d7e2" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">读取包含数据集标签的CSV文件，并显示前5行。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/cc012c8dd085bd5fa401d9d438835198.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*VGXQp3j2MaZN5FoEx0w_KA.png"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/b2fd54cfb9661a966fbbc8c1f7b5f80e.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*GMqnhZkv0-FOi3zTOmJaww.png"/></div></figure><p id="7e1a" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">绘制一个条形图，了解图像在数据集中的分布情况。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pk"><img src="../Images/e08a34e4174e7d1943b71394876f00ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E2xi45mlmMYlWXc1jLcKeQ.png"/></div></div></figure><p id="5683" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">观察到不平衡的数据集，其中没有足够的数据来训练网络。一开始，有些班级甚至只有不到10张图片。</p><h1 id="0d6b" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">数据扩充</h1><p id="3499" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">数据扩充可以通过改变图像的大小、方向等从现有图像中人工创建更多图像来解决不平衡数据集的问题。这可以通过使用<a class="ae la" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator" rel="noopener ugc nofollow" target="_blank"><strong class="ld ja">imagedata generator</strong></a>实例在Keras中完成。它包括旋转图像、将图像向左/右/上/下移动一定量、水平或垂直翻转图像、剪切或缩放图像等。</p><p id="1c96" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">根据CSV文件中的标签，将图像加载到每个鸟类分类的相应文件夹中。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="487b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">使用控制台终端，在命令行运行<strong class="ld ja"><em class="pl">generate _ images . py</em></strong>为每个鸟类分类执行数据扩充。</p><p id="5cea" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">目标是确保每个类包含总共100幅图像。因此，选择用于执行数据扩充的图像数量取决于每个类别的要求。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h1 id="0a76" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">使用增强功能加载数据集</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pm"><img src="../Images/7f4fa6ee642d041281a6e414bce3d0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9DkVdygM0PPye0c5KbIHFg.png"/></div></div></figure><p id="5914" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">很明显，我对图形绘制很感兴趣，但是谁说当<a class="ae la" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>出现在画面中时，图形绘制就一定很无聊呢？我们现在已经实现了每班100张图片的同等数量，以启动模型培训。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pm"><img src="../Images/df40b2857f51ecd496483b8f0f7bca7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RjytyFbZ7uus-4WK9UnHA.png"/></div></div></figure><p id="6397" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">由于硬件限制，我们将使用128 X 128的输入图像尺寸，而不是VGG16模型中使用的原始224 X 224。我们将继续阅读、调整和缩放这些图像用于训练。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/9b7563783a573d65bf14da1aa6845df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*0hSJjY8sMdSadft3HQcA6g.png"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">总共7，700张图像，输入尺寸为128 X 128 X 3</figcaption></figure><p id="4bcc" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">加载并拆分数据集，用于CNN模型的训练和测试。使用了0.2 的<strong class="ld ja">测试规模，这意味着数据集的80%将用于训练目的，而剩余的20%用作测试组件。然后，我们使用标签y <em class="pl">、</em>作为类别标签，以<strong class="ld ja">分层</strong>的方式分割数据集。在分割之前，数据集也被<strong class="ld ja">混洗</strong>，以增强概率采样的随机性。<strong class="ld ja">随机状态</strong>控制在应用分割之前应用于数据的混洗。此参数中传递了一个整数，以便在多个函数调用中进行可再现的输出。</strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h1 id="215b" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">利用迁移学习创建CNN模型</h1><p id="9c2a" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">通过冻结模型的“深层”并仅重新训练分类层来应用迁移学习。</p><p id="8670" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们选择使用<a class="ae la" href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ja"> Adam优化</strong> </a>，这是一种基于一阶和二阶矩自适应估计的随机梯度下降方法。</p><p id="477c" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">根据<a class="ae la" href="http://arxiv.org/abs/1412.6980" rel="noopener ugc nofollow" target="_blank"> Kingma et al .，2014 </a>，该方法为</p><blockquote class="po pp pq"><p id="9bda" class="lb lc pl ld b le lf ka lg lh li kd lj pr ll lm ln ps lp lq lr pt lt lu lv lw ij bi translated"><em class="iq">“计算效率高，内存需求小，对梯度的对角线重定标不变，非常适合数据/参数较大的问题。”</em></p></blockquote><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pu"><img src="../Images/68289cdffa09f64287de9ff39735a400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yK7Gt5OK0J5RLZjR4g_fmg.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pv"><img src="../Images/f59726bb85c69ed0e46d4587d9db873a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLWKAtShIN8OIC3bWydI1A.png"/></div></div></figure><h1 id="c064" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">模特培训</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pw"><img src="../Images/1b0149e8049524f6f0a63d87457cba49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggC6kZ-Gak6YY6gKXHMs5w.png"/></div></div></figure><h1 id="77f7" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">学习曲线</h1><p id="2d46" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">学习曲线是模型学习性能随经验或时间变化的曲线图。学习曲线是机器学习中广泛使用的诊断工具，用于从训练数据集增量学习的算法。在训练期间的每次更新之后，可以在训练数据集和验证数据集上评估该模型，并且创建测量的性能的图以反映学习曲线。</p><p id="e2be" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在训练期间检查模型的学习曲线可用于诊断学习的问题，例如欠拟合或过拟合模型，以及训练和验证数据集是否具有适当的代表性。</p><ul class=""><li id="8961" class="on oo iq ld b le lf lh li lk op lo oq ls or lw os ot ou ov bi translated"><strong class="ld ja">训练学习曲线</strong>:从训练数据集中计算出的学习曲线，给出了模型学习情况的概念。</li><li id="5fd7" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw os ot ou ov bi translated"><strong class="ld ja">验证学习曲线</strong>:从验证数据集中计算出的学习曲线，给出了模型泛化能力的概念。</li></ul><p id="cd25" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们绘制训练和验证准确性/损失的学习曲线。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi px"><img src="../Images/8b0be32b74d4953601e21832fa0d6f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQblWIkTJ-aeQmaox54M5A.png"/></div></div></figure><p id="18e9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">从上述学习曲线中，观察到学习算法的良好拟合。一个<strong class="ld ja">良好拟合</strong>通过<strong class="ld ja">一个训练和验证精度/损失来识别，该精度/损失降低到一个稳定点，在两个最终精度/损失值之间有一个最小的</strong> <a class="ae la" href="https://ai.googleblog.com/2019/07/predicting-generalization-gap-in-deep.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ja">泛化间隙</strong> </a> <strong class="ld ja">。</strong>然而，任何良好体能的持续训练都可能导致过度体能。</p><h1 id="3f16" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">使用Flask的模型部署</h1><p id="7087" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">使用训练好的模型定义一个函数来预测图像，其中包含模型要预测的类名列表。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><h1 id="61c4" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">定义烧瓶应用程序</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><p id="9675" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">对于HTML模板的想法，一定要看看<a class="ae la" href="https://html5up.net/" rel="noopener ugc nofollow" target="_blank"> HTML5 UP </a>为你的项目准备的一些漂亮的用户界面模板。</p><h1 id="b1ec" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">运行烧瓶应用程序</h1><p id="a4a3" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">我们将在本地主机上运行flask应用程序，并从互联网上输入一个随机的鸟图像的URL。出于演示目的，我们选择了以下鸟类图像:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi py"><img src="../Images/a22ae4ad20b91d4d024f784cf809dac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HWNRW8SjTQgZ4mMwoAEcA.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">资料来源:<a class="ae la" href="https://baliparafoundation.com/en/blog/white-throated-kingfisher" rel="noopener ugc nofollow" target="_blank">巴里帕拉基金会</a></figcaption></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pg ph l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi pz"><img src="../Images/4b061d83b5aada99e5080cb2e8b1f925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*icyH3PuylzrXj5_wefSYZw.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="pc pd di pe bf pf"><div class="gh gi qa"><img src="../Images/f3d2dd9f843c6e8172762228d5d556a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvsYquehB3ewafap1bfSXQ.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk translated">在本地主机上输出结果</figcaption></figure><p id="c4ec" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">以上结果是以0.94的高概率为白喉翠鸟获得的。这表明在正确地将所讨论的鸟识别到其各自的类别方面，训练的模型表现良好。</p><h1 id="01dc" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">结论</h1><p id="03e9" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">总的来说，使用迁移学习已经成功地建立了用于鸟类分类的CNN模型。flask应用程序是一个非常有用的工具，可以部署训练好的模型来获取一张鸟的图像进行分类。</p><p id="5f52" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">为了进一步提高除了77个种类之外的鸟类品种多样性的准确性水平，可以在用足够大和一般的数据集训练CNN模型的地方进行改进。迁移学习的使用使人们能够利用先前学习的特征图，而不必通过在大数据集上训练大模型而从头开始。</p></div><div class="ab cl og oh hu oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ij ik il im in"><h1 id="da07" class="mg mh iq bd mi mj qb ml mm mn qc mp mq kf qd kg ms ki qe kj mu kl qf km mw mx bi translated">参考</h1><ol class=""><li id="b259" class="on oo iq ld b le nj lh nk lk qg lo qh ls qi lw qj ot ou ov bi translated"><a class="ae la" href="https://www.pyimagesearch.com/2019/07/08/keras-imagedatagenerator-and-data-augmentation/" rel="noopener ugc nofollow" target="_blank"> Keras图像数据生成器和数据扩充</a></li><li id="fa4f" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw qj ot ou ov bi translated"><a class="ae la" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> Scikit学习—训练、测试、分割</a></li><li id="4ea4" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw qj ot ou ov bi translated"><a class="ae la" href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam" rel="noopener ugc nofollow" target="_blank">tensor flow中的亚当优化器</a></li><li id="b927" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw qj ot ou ov bi translated"><a class="ae la" href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/" rel="noopener ugc nofollow" target="_blank">如何利用学习曲线诊断机器学习模型性能</a></li><li id="1f73" class="on oo iq ld b le ow lh ox lk oy lo oz ls pa lw qj ot ou ov bi translated"><a class="ae la" href="https://towardsdatascience.com/everything-from-your-deep-learning-model-to-a-web-app-279cd733f3d4" rel="noopener" target="_blank">将你的深度学习模型训练到web app之后的一切</a></li></ol></div></div>    
</body>
</html>