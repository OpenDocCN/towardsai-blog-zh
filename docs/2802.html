<html>
<head>
<title>Technology Stocks Summary App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">科技股汇总应用</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/technology-stocks-summary-app-254979ffb2d9?source=collection_archive---------4-----------------------#2022-05-30">https://pub.towardsai.net/technology-stocks-summary-app-254979ffb2d9?source=collection_archive---------4-----------------------#2022-05-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="08f9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Docker和Google Cloud构建和部署Python Web应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7156b16f0407f2d4de35fe6d9394ca9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jwfs-mH1p-IzuwnOO-Xg_A.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://www.pexels.com/@gabby-k/" rel="noopener ugc nofollow" target="_blank">蒙特拉</a>在<a class="ae ky" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</figcaption></figure><p id="d749" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> W </span> ant想知道如何把用Python编写的web应用程序部署到云上吗？这个web应用程序使用自然语言处理来总结最新的科技股新闻。</p><h2 id="94c5" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">介绍</h2><p id="7520" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">有时很难挤出足够的时间来跟上所有关于你的投资和投资组合的新闻。<a class="ae ky" href="https://tech-check-7a4imn22oa-uc.a.run.app/" rel="noopener ugc nofollow" target="_blank">这款app </a>可以汇总新闻，找到并整理你的股票的所有提及，并显示你的股票被提及的所有句子的情绪。</p><p id="f98a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将首先展示我制作的应用程序及其功能。然后我会介绍一些我用来制作它的方法。最后，我将包含一些代码，这样您也可以将自己的应用程序部署到云中。</p><h2 id="88af" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">科技股摘要应用程序</h2><p id="c370" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">该应用程序的目标是总结最新的科技股新闻。为此，我使用了美国消费者新闻与商业频道的Youtube频道，他们在那里上传每月的技术检查。</p><p id="1b07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该应用程序显示新闻广播中提到的所有股票:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/942f7412b1aa2b15a295266f30cc36ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U6yGlpyCUv8fqVQsngaKYQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Web应用程序的屏幕截图(图片由作者提供)</figcaption></figure><p id="de9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您选择每只股票时，窗口会展开，向您显示最近的股票活动，以及股票中的所有句子(如中所述)及其情绪。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/fac02fe089d090bdc71c47b2d45763a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRqhF6O_cwr_mbHvT3eWQQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">苹果股票和情绪分析(图片由作者提供)</figcaption></figure><p id="f81a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用程序提供了最近股票活动的良好摘要，可以节省大量时间，而不是试图跟上每只股票的所有新闻。</p><h2 id="475a" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">转录和实体检测</h2><p id="46d0" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">那么这个应用程序是如何工作的呢？该应用程序首先使用语音转文本API (AssemblyAI)转录视频。该API还返回实体检测和情感分析。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/ea896fed59982fe76cd02678caf00d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xiXwZRoPRlaaHLSJe4XKw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="d031" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了将MP3传递给文本，我们还需要找到文本中的所有股票，并为每只股票所在的句子赋予情感。</p><p id="c81f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实体检测查找文本中的名词，并试图识别它们是哪种名词。一些类别包括:“人名”、“政治派别”、“职业”和“组织”。</p><p id="340b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从转写的文字来看，标注为“机构”的名词，多半会是我们感兴趣的股票。所以，首先我把所有标为“组织”的实体(股票)，然后循环通过股票，并发现每只股票的所有句子都提到了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/5d9905276b25477d40796e1995f1e467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R76tddrw1wLVYEG92m8Aiw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</figcaption></figure><p id="fdbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图显示了API返回的实体检测和情感分析。他们俩都在。json格式。实体检测将文本“Apple”归类为“organization”，所以我们知道它是一只股票。“开始”和“结束”给我们一个指示，文本在转录中的位置。</p><p id="7800" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像的第二部分显示了情感分析。这句话表明的是:</p><blockquote class="ng nh ni"><p id="2b7f" class="kz la nj lb b lc ld ju le lf lg jx lh nk lj lk ll nl ln lo lp nm lr ls lt lu im bi translated">那苹果股票出现2020年以来最差的一个月是怎么了？</p></blockquote><p id="027b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个句子显然是否定的。从情感分析中可以看到，该句已经以88%的置信度被标注为否定。句子中包含单词“Apple ”,如您所见，单词Apple (24224，24514)的开始和结束都在句子start和end (23218，26694)中。所以我们知道这句话包含了苹果这个词，这是我们从实体检测中知道的一只股票。既然句子有负面情绪，我们可以给股票赋一个负面情绪。</p><p id="0851" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以对每只股票重复这一过程，这就是最终将在应用程序中显示的内容。</p><h2 id="52d3" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">股票价格显示</h2><p id="22f9" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">为了获得最新的股票价格，我将每只股票映射到其报价器上。我使用了如下的字典来做这件事。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/c025cca6b8a89f910801ddb04c35b92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pg8kA6w5wh6qiKGG8SmwyA.png"/></div></div></figure><p id="7285" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我将股票转换为tickers，我就使用yahoo finance API获取最新的股票价格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/79c291ac7858666a03dbf7b68de94d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHIJiWYUOdsj43RIxIUztg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">雅虎财经的股票价格示例(图片由作者提供)</figcaption></figure><p id="a76a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我将每只股票的市场开盘价绘制成线图。</p><h2 id="4767" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">API使用、简化和应用制作</h2><p id="8c9f" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">到目前为止，我已经展示了该应用程序的外观，以及我如何使用转录和实体检测结果来制作它。</p><p id="a8f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一部分，我想快速介绍一下我用来将视频转录成文本的方法，以及我是如何得到实体检测和情感分析的结果的。为了使用API，我使用了以下代码结构:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="a339" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我首先将MP3文件上传到API端点，然后间歇性地轮询API端点，直到转录完成。</p><p id="9d04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了制作应用程序本身，我使用了Streamlit，这是一个强大的Python库，用于快速制作应用程序原型。该应用程序的结构与我在本文的<a class="ae ky" href="https://towardsdatascience.com/using-ai-to-make-my-own-smart-assistant-app-5ad015449447" rel="noopener" target="_blank">中展示的类似。</a></p><h2 id="9368" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">将Python应用部署到云中</h2><p id="a3c0" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">一旦我完成了应用程序，我想让它通过一个网址，所以你可以通过<a class="ae ky" href="https://tech-check-7a4imn22oa-uc.a.run.app/" rel="noopener ugc nofollow" target="_blank">这个链接</a>访问它。</p><p id="2a08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了部署Streamlit应用程序，我使用了Docker和Google Cloud。我首先构建了一个docker文件:</p><ul class=""><li id="2bab" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">初始化python</li><li id="bccb" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">将所有必要的文件复制到docker映像上</li><li id="1d98" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">将所有必需的库安装到python环境中</li><li id="44b0" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">运行命令以初始化Streamlit应用程序</li></ul><p id="dcea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装docker文件后，我将图像推送到云容器注册中心，并使用Google cloud上的cloud run服务托管图像。</p><p id="f8e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了推送图像，我使用了以下命令:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/ad235a4ac37d985334f677b69001cdc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MMYU22289SCguMPEMnNqeA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">构建Docker图像并将其推送到GCP集装箱注册中心(图像由作者提供)</figcaption></figure><p id="1d08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦映像在容器注册表中，您就可以使用Cloud run托管它，方法是创建一个新服务并选择适当的映像。</p><p id="a1b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，Google Cloud提供的URL应该可供任何人使用。</p><h1 id="0f67" class="og mf it bd mg oh oi oj mj ok ol om mm jz on ka mp kc oo kd ms kf op kg mv oq bi translated">结论</h1><p id="a451" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">学习使用Python制作和部署快捷的小应用程序是一项强大的技能。这篇文章展示了我用来制作<a class="ae ky" href="https://tech-check-7a4imn22oa-uc.a.run.app/" rel="noopener ugc nofollow" target="_blank">这个app </a>的方法。该应用程序使用自然语言处理和人工智能总结了最近的股票活动。在整篇文章中，我介绍了如何使用实体检测和情感分析来找到提到每只股票的句子。我还展示了如何将这些股票映射到tickerss，以及如何使用ticker来获取每只股票的最新股价。最后，我展示了我如何使用Streamlit和Google Cloud在云上托管应用程序，以便任何人都可以访问它。</p><h1 id="aac0" class="og mf it bd mg oh oi oj mj ok ol om mm jz on ka mp kc oo kd ms kf op kg mv oq bi translated">支持我</h1><p id="140b" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">希望这对你有所帮助，如果你喜欢，你可以跟我来<a class="ae ky" href="https://medium.com/@diegounzuetaruedas" rel="noopener"> <strong class="lb iu">！</strong> </a></p><p id="dfda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以使用我的推荐链接成为<a class="ae ky" href="https://diegounzuetaruedas.medium.com/membership" rel="noopener"> <strong class="lb iu">中级会员</strong> </a> <strong class="lb iu"> </strong>，并访问我的所有文章及更多:<a class="ae ky" href="https://diegounzuetaruedas.medium.com/membership" rel="noopener">https://diegounzuetaruedas.medium.com/membership</a></p><h1 id="2bc5" class="og mf it bd mg oh oi oj mj ok ol om mm jz on ka mp kc oo kd ms kf op kg mv oq bi translated">你可能喜欢的其他文章</h1><p id="96cb" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated"><a class="ae ky" href="https://towardsdatascience.com/using-ai-to-make-my-own-smart-assistant-app-5ad015449447" rel="noopener" target="_blank">用AI做自己的智能助手App </a></p><p id="67dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/using-ai-to-analyze-speech-3a3bbf6248ac">利用人工智能分析语音</a></p></div></div>    
</body>
</html>