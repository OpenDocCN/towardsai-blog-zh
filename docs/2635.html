<html>
<head>
<title>Simple Text Classifier With Basic Machine Learning Model (Part-5)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有基本机器学习模型的简单文本分类器(第5部分)</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/simple-text-classifier-with-basic-machine-learning-model-fa414791d26e?source=collection_archive---------1-----------------------#2022-03-24">https://pub.towardsai.net/simple-text-classifier-with-basic-machine-learning-model-fa414791d26e?source=collection_archive---------1-----------------------#2022-03-24</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="c6cd" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">为初学者创建具有基本机器学习模型的文本分类器的最简单方法</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/1f2538fdb15d68bd53054f515128a25c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELXMREVk2aoLuS97gFLNYg.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><h2 id="6648" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">动机</h2><p id="ce9e" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">当我熟悉了数据科学之后，我发现这个领域非常广阔。在我的数据科学之旅中，我首先学习了基本的机器学习算法，并且我有足够的信心在现实世界的应用中实现ML算法。后来我开始了解自然语言处理(NLP)。NLP背后的想法很酷，但一开始对我来说似乎并不容易。在某种程度上，我成功地将NLP与基本的机器学习技术联系起来。我的结论是，NLP只不过是一种现代技术，包括基本的机器学习和一些附加的语言处理技术，通过这些技术，计算机可以实现人类语言。出于对自然语言处理的基本理解，我创建了一个简单的文本分类器，没有使用任何深度学习技术来分类文本。它会让我们对文本分类有一个清晰的认识。</p><p id="e477" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">现在，是时候按照完整的指导方针来构建一个简单的文本分类器了…..T3】</p><h2 id="7def" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">先决条件</h2><p id="a105" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">在开始这个项目之前，我想建议您对以下内容有一个基本的了解—</p><ul class=""><li id="3dff" class="mu mv iu lx b ly mo mb mp li mw lm mx lq my mn mz na nb nc bi translated">标记化</li><li id="1df2" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">词汇化</li><li id="ede9" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">堵塞物</li><li id="918b" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">禁用词</li><li id="3b12" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">命名实体识别</li><li id="5bc1" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">词性标注</li><li id="ea8b" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">一袋单词</li><li id="308c" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">TF-IDF</li></ul><p id="364a" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">如果你不熟悉这些技术，请阅读下面的文章。</p><div class="ni nj gq gs nk nl"><a href="https://towardsdatascience.com/a-complete-guide-to-natural-language-processing-nlp-c91f1cfd3b0c" rel="noopener follow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">自然语言处理完全指南(第三部分)</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">机器如何识别人类语言并据此行动</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz kt nl"/></div></div></a></div><p id="145c" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">为了方便起见，我将在本文中讨论<strong class="lx iv"> <em class="mt">单词包</em> </strong> <em class="mt">和</em> <strong class="lx iv"> <em class="mt"> TF-IDF </em> </strong>，因为这些是构建我们的分类器最重要的概念。我会尽量保持简单和容易。</p><p id="4b7e" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">单词包</em>和<em class="mt"> TF-IDF </em>都是单词嵌入技术。这些单词嵌入系统对于训练用于分类的机器学习模型是重要的。</p><p id="a6b4" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">包话(鞠躬)</strong></p><p id="58d7" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">单词包是一种以数字形式表示文本的简单方法。有了单词包向量，我们就可以表示一串数字的句子组合。出于演示的目的，考虑下面两个句子—</p><ol class=""><li id="ada6" class="mu mv iu lx b ly mo mb mp li mw lm mx lq my mn oa na nb nc bi translated">我喜欢看书。</li><li id="e95b" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn oa na nb nc bi translated">我喜欢玩耍和上学。</li></ol><p id="292e" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">如果我把所有的单词都转换成小写，把句子记号化，会发现下面这些记号<strong class="lx iv"><em class="mt">‘我’，‘喜欢’，‘要’，‘读书’，‘玩’，‘和’，‘去’，‘学校’</em></strong>。在标记化的情况下，我们丢弃标点符号。令牌的总数是9。我们可以用以下方式来表示令牌。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/2e0bb5e0aeccfd8a5e2f3df4ed044e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*to4lwR43qJKkUh9u8Yxkdg.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><p id="df3e" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">这个图像描述了我们如何用单词向量包来表示一个句子。因此——的向量</p><p id="6620" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">第一句:[1 1 1 1 1 0 0 0]</em></p><p id="3ddb" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">第二句:[1 1 2 0 0 1 1 1 1]</em></p><p id="9d73" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">词频-逆文档频率(TF-IDF) </strong></p><p id="aeca" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">让我们从来自<em class="mt">维基百科的正式定义开始。</em></p><blockquote class="oc od oe"><p id="ae83" class="lv lw mt lx b ly mo jv ma mb mp jy md of mq mf mg og mr mi mj oh ms ml mm mn in bi translated"><strong class="lx iv"><em class="iu">TF-IDF</em></strong><em class="iu"/>是一个数字统计量，意在反映一个词对集合或语料库中的文档有多重要[1]。</p></blockquote><p id="9f24" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">现在，试着深入挖掘…</p><p id="44f4" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">什么是词频(TF)？</strong></p><p id="ffad" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">它衡量一个单词/标记/术语在文本中出现的频率。下面的公式表示它。</p><blockquote class="oc od oe"><p id="fd8b" class="lv lw mt lx b ly mo jv ma mb mp jy md of mq mf mg og mr mi mj oh ms ml mm mn in bi translated"><em class="iu"> TF=(文档中术语的频率)/(文档中术语的总数)</em></p></blockquote><p id="e286" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">再次考虑前面两句话。</p><ol class=""><li id="07b4" class="mu mv iu lx b ly mo mb mp li mw lm mx lq my mn oa na nb nc bi translated">我喜欢看书。</li><li id="aacf" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn oa na nb nc bi translated">我喜欢玩耍和上学。</li></ol><p id="c9ce" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">在第一句中，有5个标记或项目—<strong class="lx iv"><em class="mt">‘我’，‘喜欢’，‘到’，‘阅读’，‘书籍’。</em>T25】</strong></p><p id="1832" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">所以，<strong class="lx iv"> TF </strong>对于单词<strong class="lx iv">‘我’</strong>=<em class="mt">(句子1中‘我’出现的次数)/(句子2中的项数)=1/5。</em></p><p id="a722" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">同样的，</p><p id="6481" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">TF(<em class="mt">‘喜欢’</em>)= 1/5</p><p id="3793" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">TF( <em class="mt">'到'【T35])= 1/5</em></p><p id="f00d" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">TF( <em class="mt"> 'read' </em> )=1/5</p><p id="6908" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">TF(<em class="mt">‘书籍’</em>)= 1/5</p><p id="776c" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">句子的TF可以表示如下。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oi"><img src="../Images/d8100ce19d0afef4989a48859ed105bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTv7_OPfkz0feYkKg6PItg.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><p id="bfca" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">什么是逆文档频率(IDF)？</strong></p><p id="982a" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">仅测量术语频率不足以知道一个词/术语是否重要。术语IDF是为了从一堆文档中提取更重要的单词而引入的。IDF通过以下公式计算。</p><blockquote class="oc od oe"><p id="dc87" class="lv lw mt lx b ly mo jv ma mb mp jy md of mq mf mg og mr mi mj oh ms ml mm mn in bi translated"><em class="iu"> IDF = log((文档数)/(具有特定单词或术语的文档数)】</em></p></blockquote><p id="682c" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">我们可以如下计算句子1的IDF</p><p id="e846" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">IDF</strong>for word<strong class="lx iv">‘I’</strong>=<em class="mt">log((文档数=2)/(带有单词‘I’的文档数= 2)) = log(2/2)=0 </em></p><p id="18e3" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">同样的，</p><p id="c3d6" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">IDF('like') = log (2/2)=0</p><p id="4362" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">IDF('to') = log(2/2) =0</p><p id="3f9a" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">IDF('read') = log(2/1)=0.301</p><p id="dd16" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">IDF('书籍')= log(2/1)=0.301</p><p id="a4a2" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">如果我们按照公式计算所有令牌的IDF，我们将获得表中所示的值。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/3a3c768479fc99079a2955a32bb61b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKlNOc-RESpKV_H8HyJ5tg.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><p id="3394" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">因此，TF-IDF可以用下列公式计算:</p><blockquote class="oc od oe"><p id="7d7c" class="lv lw mt lx b ly mo jv ma mb mp jy md of mq mf mg og mr mi mj oh ms ml mm mn in bi translated">TF-IDF = TF x IDF</p></blockquote><p id="e20a" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">如果你计算两个句子的TF-IDF，你会得到下面的结果。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ok"><img src="../Images/157709cfc14f2ef994a69091b53fcfa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ddemTq2kqlYYw8NyGSqOw.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><p id="c365" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">最后，我们成功地计算出了单词/词汇的分数。我们可以得出结论，当IDF和TF值都高时，TF-IDF为不太频繁的词提供高值。从另一个角度来说，如果一个单词在单个文档中频繁出现，但在整个文档中很少出现，那么TF-IDF就很大。</p><p id="f867" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">词袋和TF-IDF的对比分析</strong></p><ol class=""><li id="a05a" class="mu mv iu lx b ly mo mb mp li mw lm mx lq my mn oa na nb nc bi translated">单词包是表示单词在文档中出现的一组向量。另一方面，TF-IDF找出了具有更多信息以及更少信息的单词。</li><li id="ec98" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn oa na nb nc bi translated">词袋矢量非常容易理解和解释。不过TF-IDF有点复杂但是对于机器学习模型非常有效。</li></ol><blockquote class="oc od oe"><p id="3964" class="lv lw mt lx b ly mo jv ma mb mp jy md of mq mf mg og mr mi mj oh ms ml mm mn in bi translated"><strong class="lx iv"> <em class="iu">由于TF-IDF是机器学习模型的最佳选择，我们将在我们的运行项目中使用TF-IDF，而不仅仅是一袋单词。</em> </strong></p></blockquote><p id="3095" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">让我们开始创建简单的文本分类模型… </em></p></div><div class="ab cl ol om hy on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="in io ip iq ir"><h2 id="2581" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">创建文本分类器的步骤</h2><ul class=""><li id="e5cc" class="mu mv iu lx b ly lz mb mc li os lm ot lq ou mn mz na nb nc bi translated">读取文本数据或语料库</li><li id="fcef" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">一些初始预处理</li><li id="e4b8" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">为训练和测试拆分数据</li><li id="6031" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">创建用于向量化数据和机器学习模型的管道</li><li id="65a3" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">训练模型</li><li id="3623" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">用新数据测试模型</li><li id="4a05" class="mu mv iu lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">评估模型</li></ul><h2 id="6dc2" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">读取文本数据或语料库</strong></h2><p id="5b8b" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">读取或加载数据集是每个机器学习模型的第一步。我们将在整个项目中使用python编程语言，我们已经在项目中使用了<code class="fe ov ow ox oy b"><a class="ae oz" href="https://github.com/Zubair063/Simple-Text-Classifier-/blob/main/moviereviews.tsv" rel="noopener ugc nofollow" target="_blank"><strong class="lx iv">moviereviews </strong></a></code>数据集。因此，为了加载数据，我们将使用<code class="fe ov ow ox oy b">pandas </code>库，文本已经被预处理为制表符分隔的文件。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="82d9" class="kz la iu oy b gz pe pf l pg ph">import pandas as pd<br/>df = pd.read_csv('moviereviews.tsv', sep='\t')</span></pre><p id="c21f" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">如果我们想要数据集的前几个实例，我们可以通过<code class="fe ov ow ox oy b">df.head()</code>命令来完成，它给出了下面的结果。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pi"><img src="../Images/70d32d2bbb5131022f50594e5fbe1c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*l1XmedAJwTDX5YYe-mZR2A.png"/></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</figcaption></figure><h2 id="7991" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">初始预处理</strong></h2><p id="ecce" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">在这一步中，我们将尝试找出不包含任何内容的评论。我们需要抛弃这些类型的评论。可能有两种情况，</p><p id="4e69" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt"> i)它可能是一个NaN值(NaN表示不是一个数字，相当于无)</em></p><p id="52fb" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">ii)只包含空白。让我们试着深入了解数据集。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="c1d9" class="kz la iu oy b gz pe pf l pg ph">df.info()</span></pre><p id="8ac8" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">这段代码产生以下结果。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pj"><img src="../Images/380e2f79565f91c835e8195a182f9903.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*y7zz_u1ezTx4SlCSP9nojA.png"/></div></figure><p id="a478" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">它显示总共有2000个实例，一些<strong class="lx iv">评论</strong>无效。我们必须删除没有审核的行。让我们开始吧。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="9348" class="kz la iu oy b gz pe pf l pg ph">df.dropna(inplace=True)</span></pre><p id="46bd" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">现在，检查数据框的信息。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="cb4d" class="kz la iu oy b gz pe pf l pg ph">df.info()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pk"><img src="../Images/f87f361be28fc3d63ae2a5c77cb782ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*2sbd2UmX5UZzXe7sOaeuNQ.png"/></div></figure><p id="fbfd" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">现在看起来还行。所有包含空值的行都已被删除。</p><p id="366b" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">现在，我们将检测并从数据集中删除空字符串。我写了一个函数来检测评论栏的空字符串。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pl pm l"/></div></figure><p id="b57c" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">如果我们将数据帧<code class="fe ov ow ox oy b"><strong class="lx iv">df</strong></code> <strong class="lx iv"> </strong>传入函数，它将返回空字符串行的索引列表。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="3328" class="kz la iu oy b gz pe pf l pg ph">blank_data_index=detect_blank(df)</span></pre><p id="03ca" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><code class="fe ov ow ox oy b">len(blank_data_index)</code>返回27。这表明有27行包含一个空字符串。现在，我们将按照这段代码删除它。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="c63b" class="kz la iu oy b gz pe pf l pg ph">df.drop(blank_data_index, inplace=True)</span></pre><p id="8f6d" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">我们的数据集中没有空白评论，评论总数是1938条。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="0293" class="kz la iu oy b gz pe pf l pg ph">df.label.value_counts()</span></pre><p id="d504" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">标签列的频率。</em></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="b808" class="kz la iu oy b gz pe pf l pg ph">neg    969<br/>pos    969</span></pre><p id="97f4" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">它表明，负面和正面的审查频率是相等的，这是一个平衡的数据集。</p><h2 id="6f07" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">为训练和测试拆分数据</strong></h2><p id="710e" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">对于每一个机器学习模型，我们都需要大量的数据来训练模型，以及一些看不见的数据来评估模型，这些数据称为测试数据。在这个项目中，我们将67%的数据用于训练，33%的数据用于测试(这不是一个固定的参数。可以根据自己的选择进行微调)。</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="5eb6" class="kz la iu oy b gz pe pf l pg ph">from sklearn.model_selection import train_test_split</span><span id="5c57" class="kz la iu oy b gz pn pf l pg ph">X = df['review']<br/>y = df['label']</span><span id="c57a" class="kz la iu oy b gz pn pf l pg ph">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</span></pre><h2 id="e2b4" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">创建向量化数据和机器学习模型的管道</strong></h2><p id="ffe3" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">机器学习管道是一种将自动化工作流程的一系列工作进行编码的方式。在我们的模型中，我们将使用管道执行两项任务。首先，用<strong class="lx iv"> TF-IDF对词汇/标记进行矢量化。</strong>其次，创建机器学习模型。Scikit-learn有很多模块可以让我们的生活更加轻松。因此，我们将使用scikit-learn库进行TF-IDF矢量化和其他机器学习模型。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pl pm l"/></div></figure><p id="2039" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">为此，我们为朴素贝叶斯和线性SVC分类器创建了管道。</p><h2 id="ba63" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">在文本数据上训练模型</strong></h2><p id="5b00" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">我们为朴素贝叶斯分类器和线性SVC模型创建了两个管道。</p><p id="0b66" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">用朴素贝叶斯管道训练</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="c4d6" class="kz la iu oy b gz pe pf l pg ph">text_clf_nb.fit(X_train, y_train)</span></pre><p id="10da" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">管道详情</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj po"><img src="../Images/638e5c4b0891487ad617c36af32ee5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OvsdMFIjYHqRn2wMNB4tLQ.png"/></div></div></figure><h2 id="caad" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">预测测试数据的输出</strong></h2><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="e615" class="kz la iu oy b gz pe pf l pg ph"># Form a prediction set<br/>predictions = text_clf_nb.predict(X_test)</span></pre><p id="c53f" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">为我们的模型绘制混淆矩阵</strong></p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pl pm l"/></div></figure><p id="4c90" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">它会产生以下结果。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pp"><img src="../Images/69143ce7eadea52b8d44e73cbcfd809e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*HHK_w9PHnbSqIOeTAp_g_g.png"/></div></figure><p id="9a75" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">管道分类报告(精度、召回、F1评分、支持)</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="5cfe" class="kz la iu oy b gz pe pf l pg ph"># Print a classification report<br/>print(metrics.classification_report(y_test,predictions))</span></pre><p id="abb1" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">输出</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pq"><img src="../Images/62c20dba9bf30c39a97fdf057b993523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*gnvkccIHJmj8DBAtFz81hA.png"/></div></figure><p id="1d17" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">准确度</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="3479" class="kz la iu oy b gz pe pf l pg ph"># Print the overall accuracy<br/>print(metrics.accuracy_score(y_test,predictions))</span></pre><p id="afbb" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">总准确度</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="08d5" class="kz la iu oy b gz pe pf l pg ph">0.7640625</span></pre><p id="091f" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">带有线性SVC管道的列车</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="627a" class="kz la iu oy b gz pe pf l pg ph">text_clf_lsvc.fit(X_train, y_train)</span></pre><p id="5af8" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">管道详情</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pr"><img src="../Images/6ba263fbf14fda0f03670b476dba858b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sh9g8Hbbz-nrdLxOlxspGA.png"/></div></div></figure><p id="b469" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">预测测试数据的输出</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="b625" class="kz la iu oy b gz pe pf l pg ph"># Form a prediction set<br/>predictions_2 = text_clf_lsvc.predict(X_test)</span></pre><p id="7ec4" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">混淆矩阵</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="798d" class="kz la iu oy b gz pe pf l pg ph"># Report the confusion matrix<br/>from sklearn import metrics<br/>print(metrics.confusion_matrix(y_test,predictions_2))</span></pre><p id="86d0" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">混淆矩阵输出</em></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="94f6" class="kz la iu oy b gz pe pf l pg ph">[[259  49]<br/> [ 49 283]]</span></pre><p id="8a58" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">在这里，我已经展示了第一个管道中混淆的图形表示和第二个管道中的一般表示。你可以根据自己的选择使用任何一种技术。</p><p id="61e2" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">第二管道的分类报告(精确度、召回率、F1得分、支持)</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="61f7" class="kz la iu oy b gz pe pf l pg ph"># Print a classification report<br/>print(metrics.classification_report(y_test,predictions_2))</span></pre><p id="1702" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">输出</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ps"><img src="../Images/6a54b77ad044e6e4a6495425ff66c19a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*LWezTz88yLfbozCek6DRqw.png"/></div></figure><p id="0361" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">第二条管线的精度</strong></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="12c7" class="kz la iu oy b gz pe pf l pg ph"># Print the overall accuracy<br/>print(metrics.accuracy_score(y_test,predictions))</span></pre><p id="1d9a" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><em class="mt">整体精度</em></p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="d7f6" class="kz la iu oy b gz pe pf l pg ph">0.846875</span></pre><p id="e4f2" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">流水线的结果表明第二流水线(线性SVC)在评估度量方面表现更好。因此，我们将使用第二个管道作为首选模型。如果您愿意，您可以使用其他分类算法，并为您的最终模型接受最佳算法。</p><h2 id="8b60" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">预测新复习的类别</strong></h2><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="4d29" class="kz la iu oy b gz pe pf l pg ph">myreview = "A movie I really wanted to love was terrible. \<br/>I'm sure the producers had the best intentions, but the execution was lacking."</span><span id="f980" class="kz la iu oy b gz pn pf l pg ph">print(text_clf_lsvc.predict([myreview]))</span></pre><p id="0e8b" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated">输出</p><pre class="kk kl km kn gu pa oy pb pc aw pd bi"><span id="b648" class="kz la iu oy b gz pe pf l pg ph">['neg']</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pt"><img src="../Images/892065c387e8164be705394cc095d75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pdm-d7lP7L5jxH9d"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">艾蒂安·吉拉尔代在<a class="ae oz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="337f" class="kz la iu bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="b47b" class="pw-post-body-paragraph lv lw iu lx b ly lz jv ma mb mc jy md li me mf mg lm mh mi mj lq mk ml mm mn in bi translated">自然语言处理(NLP)是一项激动人心的技术。本文展示了使用基本机器学习算法构建简单文本分类器的最简单方法。尽管这种类型的模型性能不好，但对于NLP的初学者来说，这可能是一篇有趣的文章。</p><p id="33bd" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv">参考</strong></p><ol class=""><li id="24ad" class="mu mv iu lx b ly mo mb mp li mw lm mx lq my mn oa na nb nc bi translated"><a class="ae oz" href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank">TF–IDF—维基百科</a></li></ol><p id="2521" class="pw-post-body-paragraph lv lw iu lx b ly mo jv ma mb mp jy md li mq mf mg lm mr mi mj lq ms ml mm mn in bi translated"><strong class="lx iv"> <em class="mt">以下文章你可能会感兴趣…… </em> </strong></p><div class="ni nj gq gs nk nl"><a href="https://towardsdatascience.com/tips-and-tricks-to-work-with-text-files-in-python-89f14a755315" rel="noopener follow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">使用Python处理文本文件的技巧和诀窍(第1部分)</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">使用文本文件并熟悉Python中令人惊叹的技术</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="pu l nw nx ny nu nz kt nl"/></div></div></a></div><div class="ni nj gq gs nk nl"><a href="https://towardsdatascience.com/manipulate-pdf-files-extract-information-with-pypdf2-and-regular-expression-39ff697db0ca" rel="noopener follow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">操作PDF文件，使用PyPDF2和正则表达式提取信息(第2部分)</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">使用PyPDF2和正则表达式简化PDF操作任务</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="pv l nw nx ny nu nz kt nl"/></div></div></a></div><div class="ni nj gq gs nk nl"><a href="https://towardsdatascience.com/hands-on-implementation-of-basic-nlp-techniques-nltk-or-spacy-687099e02816" rel="noopener follow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">用spaCy实现基本NLP技术的完整指南(第4部分)</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">了解如何使用Python库实现基本的NLP技术</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="pw l nw nx ny nu nz kt nl"/></div></div></a></div></div></div>    
</body>
</html>