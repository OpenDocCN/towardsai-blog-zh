<html>
<head>
<title>How to train a Topic Tagging model to assign high-quality topics to articles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何训练一个主题标注模型来给文章分配高质量的主题</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-train-a-topic-tagging-model-to-assign-high-quality-topics-to-articles-46b7ebbf0ba8?source=collection_archive---------0-----------------------#2021-11-29">https://pub.towardsai.net/how-to-train-a-topic-tagging-model-to-assign-high-quality-topics-to-articles-46b7ebbf0ba8?source=collection_archive---------0-----------------------#2021-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/af0b68c5e8b50298155963b16507aa69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oei5gQ2k7HBh-AL1wtnYpg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">Gabriel Sollmann 在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h2 id="f6ae" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><div class=""><h2 id="5a0b" class="pw-subtitle-paragraph km jp jg bd b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dk translated">从训练集创建到训练模型</h2></div><p id="8c33" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">主题标记是将主题分配给各种形式的内容的过程，最广泛的是文本。我们通常在报纸上看到作者标记的文章，作为一种组织知识的形式，并使内容更容易被最想要它的读者发现。此外，它可以用来分析大量的文本数据，如互联网博客(每个博客使用不同的标签或根本不使用标签)的文章流或社交帖子。</p><h1 id="6d41" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">抽取式与预测式主题标注</h1><p id="824d" class="pw-post-body-paragraph le lf jg lg b lh ms kq lj lk mt kt lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">我们可以区分两种类型的主题标注。让我们以下面的文字为例:</p><blockquote class="mx my mz"><p id="d1eb" class="le lf na lg b lh li kq lj lk ll kt lm nb lo lp lq nc ls lt lu nd lw lx ly lz ij bi translated">加密货币让你可以购买商品和服务，或者交易获利。下面更多的是什么是加密货币，如何购买，如何保护自己。</p></blockquote><ul class=""><li id="82a9" class="ne nf jg lg b lh li lk ll ln ng lr nh lv ni lz nj nk nl nm bi translated">抽取式主题标记通过检测文本中包含的关键词并使用它们的规范化形式作为主题来工作。通常，这些主题通过使用开源知识库中的类别来丰富，如<a class="ae jd" href="https://www.wikidata.org/wiki/Wikidata:Main_Page" rel="noopener ugc nofollow" target="_blank"> Wiki Data </a>。前面的例子预测的主题可能是像M <em class="na"> oney、Business、Give、工资、价格、帮助、买家、工作、商店、服务</em>这样的东西。</li><li id="f71c" class="ne nf jg lg b lh nn lk no ln np lr nq lv nr lz nj nk nl nm bi translated">预测主题标记通过用每个主题的几个文本示例训练分类模型，与预定义的主题集一起工作。训练集可以从网上搜集，因为每篇带有标签的文章都是潜在的训练样本。该示例预测的主题可能是类似于<em class="na">比特币、加密货币、密码、区块链技术、密码学、贸易、网络安全、信息安全、安全、隐私、区块链、经济学、经济。</em></li></ul><p id="19ad" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下面是对抽取式和预测式主题标记的简要比较，包括优缺点。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ns"><img src="../Images/022571bb61bf8cda4ad6d8188409ef50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xumRY10OONe4o9RyEKXw7A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">抽取式和预测式主题标注比较。图片由作者提供。</figcaption></figure><p id="b0cc" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">由于本文的目标是教授如何预测高质量的主题，我们将重点关注如何执行<strong class="lg jq">预测主题标记</strong>。为了训练主题标注模型，我们需要训练数据。例如，在线发布的文章带有与其作者相关联的标签，这确保了数据具有良好的质量。Medium是这类文章的一个很好的来源，让我们刮Medium来构建一个训练集。完整的代码可以在这个<a class="ae jd" href="https://colab.research.google.com/drive/1GYDTNl5xky340HItg4g2jvrKr5tAgsQ4?usp=sharing" rel="noopener ugc nofollow" target="_blank">实验室</a>中找到。</p><h1 id="33a1" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">抓取媒体以获取训练数据</h1><p id="02c9" class="pw-post-body-paragraph le lf jg lg b lh ms kq lj lk mt kt lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">我们将需要<a class="ae jd" href="https://github.com/codelucas/newspaper" rel="noopener ugc nofollow" target="_blank"> newspaper3k </a>从HTML中提取文章数据，并需要<a class="ae jd" href="https://github.com/Mimino666/langdetect" rel="noopener ugc nofollow" target="_blank"> langdetect </a>只保存英文文章。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="0fd4" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下一步是定义一个函数，该函数从文章的URL中抓取文章，用newspaper3k解析该文章以提取其标题和文本内容，并使用一些启发式方法获取文章标签。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="c343" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">既然我们知道了如何从URL中抓取一篇文章，我们需要一个地方来找到所有带有我们感兴趣的标签的文章。为此，我们可以抓取按标签和日期组织的介质的存档页面。例如，日期为2020年1月15日的主题人工智能的存档页面是<a class="ae jd" href="https://medium.com/tag/artificial-intelligence/archive/2020/01/15" rel="noopener">https://medium . com/tag/Artificial-Intelligence/archive/2020/01/15</a>。我们可以将URL结构概括为<em class="na">https://medium.com/tag/&lt;标签&gt;/存档/ &lt;年&gt; / &lt;月&gt; / &lt;日&gt; </em>并生成一个随机日期的存档页面列表，供特定标签抓取。要从这些归档页面中获取实际的文章URL，我们只需要使用一个有效的CSS选择器。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="48df" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们定义一些标签来刮，我们从这六个开始。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="f36a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在我们可以把所有的片段粘在一起，开始为每个标签收集50篇文章。记住执行温和的刮擦，并在请求之间等待一段时间！</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="fb9c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">最后，我们把刮下来的文章保存在一个熊猫数据框中。在下一节中，训练我们的机器学习模型将会很有用。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="29ef" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">训练主题标记模型</h1><p id="f306" class="pw-post-body-paragraph le lf jg lg b lh ms kq lj lk mt kt lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">我们需要P <a class="ae jd" href="https://github.com/pandas-dev/pandas" rel="noopener ugc nofollow" target="_blank">和as </a>和<a class="ae jd" href="https://github.com/numpy/numpy" rel="noopener ugc nofollow" target="_blank"> NumPy </a>进行数据操作，NLTK进行文本规范化，而<a class="ae jd" href="https://github.com/scikit-learn/scikit-learn" rel="noopener ugc nofollow" target="_blank"> Sklearn </a>用于机器学习模型。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="4359" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这就是我们的数据框架和抓取的数据应该看起来的样子。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nz"><img src="../Images/05f4841ddfba4f18c11f167ada22392a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rhrp8aunb-H5Ww2CHDOUJQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">熊猫数据框包含带标签的文章。图片由作者提供。</figcaption></figure><p id="8b60" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">首先要做的是从抓取的文章中移除我们没有抓取的所有标签(即，我们只保留我们之前定义的六个标签，因为它们是我们有足够数据来训练模型的唯一标签)，并对标签应用<a class="ae jd" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MultiLabelBinarizer.html" rel="noopener ugc nofollow" target="_blank"> MultiLabelBinarizer </a>以将其转换为支持的多标签格式。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="12c9" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了让你有个概念，这是一个MultiLabelBinarizer如何工作的例子，摘自Sklearn文档。</p><pre class="nt nu nv nw gt oa ob oc od aw oe bi"><span id="5302" class="of mb jg ob b gy og oh l oi oj"><strong class="ob jq">&gt;&gt;&gt; </strong>mlb.fit_transform([{'sci-fi', 'thriller'}, {'comedy'}])<br/>array([[0, 1, 1],<br/>       [1, 0, 0]])<br/><strong class="ob jq">&gt;&gt;&gt; </strong>list(mlb.classes_)<br/>['comedy', 'sci-fi', 'thriller']</span></pre><p id="6e98" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们现在可以为我们的模型准备数据了。该模型将从文章的标题和正文中预测主题，我们将标题和正文连接起来。然后，使用标准的文本处理对该文本进行清理，如将其转换为小写字母、替换不良字符以及删除停用词。</p><p id="b31e" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然后，清理后的文本由<a class="ae jd" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" rel="noopener ugc nofollow" target="_blank">tfidf矢量器</a>进行转换。除了通常用于信息检索之外，TF-IDF还被发现用于文档分类。在文档中利用TF-IDF而不是原始记号频率减少了出现非常频繁的记号的影响，因此从经验上讲，比出现在一小部分文档中的记号信息更少。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="795a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在我们已经准备好了训练数据，我们可以训练我们的模型了。我们的问题是一个<a class="ae jd" href="https://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification" rel="noopener ugc nofollow" target="_blank">多标签分类问题</a>，也就是说，我们想要用所有可能标签的子集来标记每个样本。我们可以通过为每个主题训练一个二元分类器来做到这一点，这正是<a class="ae jd" href="https://scikit-learn.org/stable/modules/multiclass.html#multioutputclassifier" rel="noopener ugc nofollow" target="_blank"> MultiOutputClassifier </a>所做的。</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="e316" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们到终点了！让我们用一些模拟句子来试试这个模型。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ok"><img src="../Images/055a1ee98e54ac0cb7d53e91601d4da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-VdfVMhsqXZHINbdWLzHrA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">经过训练的模型成功地预测了人工智能和编程主题。图片由作者提供。</figcaption></figure><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ol"><img src="../Images/b99f771de2af585b3272821ad96256e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9x30coIjQWCh-H7NsdH_9w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">经过训练的模型成功预测了社交媒体话题。图片由作者提供。</figcaption></figure><p id="a387" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">预测的主题与文本输入一致。干得好！</p><h1 id="d8a7" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">可能的改进</h1><p id="91e4" class="pw-post-body-paragraph le lf jg lg b lh ms kq lj lk mt kt lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">在本教程中，我们抓住了重点，但我们忽略了许多方面。</p><ul class=""><li id="85e6" class="ne nf jg lg b lh li lk ll ln ng lr nh lv ni lz nj nk nl nm bi translated"><strong class="lg jq">使用合适的指标评估模型，并训练验证-测试分割数据集。</strong>我们应该评估模型的精确度、召回率和F1值，这样我们才能知道模型的改变是否有益。通常，F1-score用作多标签分类设置中的优化指标，但是您应该根据模型的使用情况来选择指标。例如，如果模型帮助人类为文章分配类别，召回可能比精确度更重要，因为总有人可以修复预测错误。</li><li id="a922" class="ne nf jg lg b lh nn lk no ln np lr nq lv nr lz nj nk nl nm bi translated"><strong class="lg jq">微调每个二元分类器的分类阈值</strong>。记得在验证集上调整这个参数来优化您的度量。</li><li id="bfb2" class="ne nf jg lg b lh nn lk no ln np lr nq lv nr lz nj nk nl nm bi translated"><strong class="lg jq">从多个网站获取训练数据</strong>。在本教程中，我们只收集了中等，但还有许多其他网站可以收集数据。</li><li id="f532" class="ne nf jg lg b lh nn lk no ln np lr nq lv nr lz nj nk nl nm bi translated"><strong class="lg jq">使用分类法更好地准备训练数据</strong>。我们数据科学家倾向于在模型上花太多时间，而在数据质量上花很少时间。我们的训练集由文章和标签组成，这些文章和标签由各自的作者分配，但是作者通常受限于可以分配的标签数量。这意味着作者经常必须根据标签的可见性和它们的特异性的一些逻辑，在许多似乎合理的标签中选择分配哪些标签。因此，我们的训练集是肮脏的，因为有似是而非的标签没有分配给文章！为了解决这个问题，我们可以构建一个主题分类法并用它来清理数据集，每当我们看到分配了更多的特定标签时，就分配更多的通用标签。例如，如果一篇文章的标签是<em class="na">机器学习</em>，我们可以推断它也谈到了<em class="na">人工智能</em>，因为<em class="na">人工智能</em>是<em class="na">机器学习</em>的上位词。</li></ul><h1 id="84c1" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">主题标签的用例示例</h1><p id="a10d" class="pw-post-body-paragraph le lf jg lg b lh ms kq lj lk mt kt lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">在其他文章中，我搜集了著名公司网站的博客部分，并应用主题标签来分析这些公司写了些什么。</p><div class="ip iq gp gr ir om"><a href="https://medium.com/@chiusanofabio94/content-marketing-analysis-with-nlp-github-vs-gitlab-b9ee114d5fb7" rel="noopener follow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd jq gy z fp or fr fs os fu fw jp bi translated">使用NLP的快速内容营销分析:GitHub与GitLab</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">为什么GitHub发布是关于游戏的，GitLab是关于Ux设计的？</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">medium.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ix om"/></div></div></a></div><div class="ip iq gp gr ir om"><a href="https://medium.com/@chiusanofabio94/fast-content-marketing-analysis-with-nlp-pocket-vs-evernote-e0f92d754f72" rel="noopener follow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd jq gy z fp or fr fs os fu fw jp bi translated">使用NLP的快速内容营销分析:Pocket vs Evernote</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">口袋出版有什么Evernote没有的，反之亦然？</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">medium.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa ix om"/></div></div></a></div><h1 id="9b04" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">结论</h1><p id="d64a" class="pw-post-body-paragraph le lf jg lg b lh ms kq lj lk mt kt lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">预测主题标记是一种预测文章高质量主题的解决方案，训练一个质量不错的模型相当容易。然而，根据我的经验，在可能的改进部分中提出的行动极大地提高了最终模型的质量。可能的用例来源于对大量文本的自动分析，如社交媒体分析或竞争对手分析。</p><p id="4ef1" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">感谢您花时间阅读这篇文章。如果你喜欢这篇文章并想看更多，请一定要拍下这篇文章！</p></div><div class="ab cl pc pd hu pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="ij ik il im in"><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/55b765c96cd6a11ac853b3b28dd05565.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*YfhjEMZZ09_U0ZfHfjFamQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">NLPlanet标志。</figcaption></figure><p id="f70c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="na">在</em><a class="ae jd" href="https://www.linkedin.com/company/nlplanet" rel="noopener ugc nofollow" target="_blank"><em class="na">LinkedIn</em></a><em class="na"/><a class="ae jd" href="https://twitter.com/nlplanet_" rel="noopener ugc nofollow" target="_blank"><em class="na">Twitter</em></a><em class="na"/><a class="ae jd" href="https://www.facebook.com/NLPlanet-113393687828458" rel="noopener ugc nofollow" target="_blank"><em class="na">脸书</em> </a> <em class="na">和</em><a class="ae jd" href="https://t.me/nlplanet" rel="noopener ugc nofollow" target="_blank"><em class="na">Telegram</em></a><em class="na">上关注应用自然语言处理的最新故事并加入NLPlanet社区。</em></p></div></div>    
</body>
</html>