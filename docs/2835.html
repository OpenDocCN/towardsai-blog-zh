<html>
<head>
<title>GitHub Actions in MLOps: Automatically Check and Deploy Your ML Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MLOps中的GitHub动作:自动检查和部署您的ML模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/github-actions-in-mlops-automatically-check-and-deploy-your-ml-model-9a281d7f3c84?source=collection_archive---------0-----------------------#2022-06-11">https://pub.towardsai.net/github-actions-in-mlops-automatically-check-and-deploy-your-ml-model-9a281d7f3c84?source=collection_archive---------0-----------------------#2022-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9080" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用GitHub动作自动化您的ML管道</h2></div><h1 id="5cb9" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">动机</h1><p id="65b6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">假设你的公司正在创建一个ML驱动的服务。作为一名数据科学家，您可能会尝试不断改进现有的ML模型。</p><p id="fbeb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">一旦找到了更好的模型，如何确保在部署新模型时服务不会中断？</p><p id="16ca" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果您可以创建一个工作流来:</p><ul class=""><li id="e7cc" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">自动测试来自团队成员的拉请求</li><li id="f832" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">当所有测试都通过时，合并一个拉请求</li><li id="033c" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">将ML模型部署到现有的服务中？</li></ul><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mp"><img src="../Images/3d7d9685c91b972deaf479c012573f09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZLOx6sCq9_Dj1-44mxKOQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="05b6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">在本文中，您将学习如何使用GitHub操作创建这样的工作流。</strong></p><h1 id="702b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">什么是GitHub动作？</h1><p id="b7e7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae nf" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions </a>允许你自动化你的工作流程，更快地构建、测试和部署你的代码。</p><p id="14d5" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">一般来说，工作流看起来类似于下图:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="79b3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">从上面的代码中可以理解3个重要的概念:</p><ul class=""><li id="129f" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">当<em class="ni">事件</em>发生时(如推送或拉取请求)，将触发由一个或多个<em class="ni">作业</em>组成的<em class="ni">工作流</em></li><li id="a00f" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><em class="ni">作业</em>与<strong class="lc iu">相互独立</strong>。每个<em class="ni">作业</em>都是一组<em class="ni">步骤</em>，它们在自己的虚拟机运行器或容器中运行。</li><li id="19c2" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><em class="ni">步骤</em>与<strong class="lc iu">相互依赖</strong>并按顺序执行。</li></ul><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/244c184b97bbbc0f3033b656ccb30e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*sE4nHMwuBhN2bp4gLdUpvA.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="f429" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们在接下来的几节中更深入地研究这些概念。</p><h1 id="f791" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">找到最佳参数</h1><p id="25ce" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">ML项目的第一步包括在非主分支中试验不同的参数和模型。在上一篇文章中，我提到了如何使用<a class="ae nf" href="https://mlflow.org/" rel="noopener ugc nofollow" target="_blank">ml flow</a>+<a class="ae nf" href="https://dagshub.com/" rel="noopener ugc nofollow" target="_blank">DagsHub</a>来记录您的实验。</p><div class="nk nl gp gr nm nn"><a href="https://towardsdatascience.com/dagshub-a-github-supplement-for-data-scientists-and-ml-engineers-9ecaf49cc505" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">Dag shub:GitHub对数据科学家和ML工程师的补充</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">将您的数据、模型、实验和代码保存在一个地方</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob mz nn"/></div></div></a></div><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi oc"><img src="../Images/f686a800e098fed8da801eb611e4af37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVtGMnz8_2K3dOtQAKCTdQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="614f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><a class="ae nf" href="https://dagshub.com/khuyentran1401/employee-future-prediction/experiments/" rel="noopener ugc nofollow" target="_blank"> <em class="ni">链接到上图所示的实验。</em> </a></p><p id="f727" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">一旦我们发现参数和模型的组合比生产中的现有模型具有更好的性能，我们就创建一个pull请求来合并新代码和主分支。</p><h1 id="0e39" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">使用GitHub动作测试代码、ML模型和应用程序</h1><p id="2dbd" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了确保合并新代码不会导致任何错误，我们将创建一个工作流:</p><ul class=""><li id="e2e6" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">自动测试拉取请求</li><li id="ed1c" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">仅允许通过所有测试的拉请求与主分支合并。</li></ul><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi od"><img src="../Images/89e710a76474637d3ad36ffe7fc5a35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYBqiJuqZ7qL0R6CZrRtgA.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="9780" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们将在<code class="fe oe of og oh b">.github/workflows</code>下的YAML文件中编写这个工作流。</p><pre class="mq mr ms mt gt oi oh oj ok aw ol bi"><span id="593f" class="om kj it oh b gy on oo l op oq">.github<br/>└── workflows<br/>    └── test_code.yaml</span></pre><h2 id="148e" class="om kj it bd kk or os dn ko ot ou dp ks lj ov ow ku ln ox oy kw lr oz pa ky pb bi translated">指定事件</h2><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/76ae68445e8199cef7cda2e45bbde32f.png" data-original-src="https://miro.medium.com/v2/resize:fit:242/format:webp/1*22Qe6bkxIED4J2F6f4O7-g.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="fe92" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在这个工作流中，我们使用<code class="fe oe of og oh b">on</code>来指定工作流将只运行:</p><ul class=""><li id="718e" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">如果事件是拉请求。</li><li id="6a8d" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">如果提交文件的路径与某些模式匹配。</li></ul><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="a7c9" class="om kj it bd kk or os dn ko ot ou dp ks lj ov ow ku ln ox oy kw lr oz pa ky pb bi translated">指定步骤</h2><p id="fe24" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">接下来，创建一个名为<code class="fe oe of og oh b">test_code</code>的作业，它由按顺序执行的几个步骤组成。</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="0c3e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">前几个步骤将在运行代码之前设置环境。</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="266a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">上面代码中的语法解释:</p><ul class=""><li id="d48d" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><code class="fe oe of og oh b">name</code>:你脚步的名字</li><li id="e936" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><code class="fe oe of og oh b">uses</code>选择一个<em class="ni">动作，</em>即<em class="ni"> </em>一个执行复杂但频繁重复任务的应用。你可以从<a class="ae nf" href="https://github.com/marketplace?type=actions" rel="noopener ugc nofollow" target="_blank"> GitHub Marketplace </a>上的数千个动作中选择一个动作。</li><li id="7ef9" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><code class="fe oe of og oh b">with</code>插入动作所需的输入参数</li><li id="888e" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><code class="fe oe of og oh b">run</code>使用shell运行命令行程序</li></ul><p id="2d11" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">步骤说明:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pd"><img src="../Images/d7c687aea44ff476e41be36eeb1010a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kce98VX0YywaGtA8mfMhkQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><ul class=""><li id="ce93" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><code class="fe oe of og oh b">Checkout</code>签出您的存储库，以便工作流可以访问存储库中的文件</li><li id="c9b2" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><code class="fe oe of og oh b">Environment setup</code>为您的工作流设置一个Python环境(我选择了Python 3.8)</li><li id="1579" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><code class="fe oe of og oh b">Cache</code>缓存依赖关系，这样您就不需要在每次运行工作流时安装依赖关系</li><li id="3784" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">安装代码成功运行所需的所有依赖项</li><li id="00c9" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><code class="fe oe of og oh b">Pull data</code>验证并从远程存储中提取数据。在这里，我的远程存储是<a class="ae nf" href="https://towardsdatascience.com/dagshub-a-github-supplement-for-data-scientists-and-ml-engineers-9ecaf49cc505#:~:text=DagsHub%20is%20a%20platform%20for,models%2C%20experiments%2C%20and%20code.&amp;text=The%20interface%20of%20your%20new,Notebooks%2C%20DVC%2C%20and%20Git." rel="noopener" target="_blank"> DagsHub </a></li></ul><p id="b3e3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">请注意，将您的用户名和密码放在每个人都能看到的脚本中是有风险的。因此，我们将使用加密的秘密来隐藏这些机密信息。</p><h2 id="6090" class="om kj it bd kk or os dn ko ot ou dp ks lj ov ow ku ln ox oy kw lr oz pa ky pb bi translated">加密的秘密</h2><p id="7c25" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">机密是您在存储库中创建的加密环境变量。要创建一个秘密，进入你的储存库，点击<em class="ni">设置</em> → <em class="ni">秘密</em> → <em class="ni">动作</em> → <em class="ni">新建储存库秘密</em>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pe"><img src="../Images/355f09bdbb19c402be3112f3abbaef8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1IeD3_lYiWVtoa62a4ghnA.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pf"><img src="../Images/3ea48134e29e308b337e5d5394e6ae07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wx2B0GMecHvQjfY3KCZ0HA.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="e222" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">插入您的机密名称以及与此名称相关的值。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/fa8e3207c3441d30e43791b66cc2287d.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*XWj50AopXzQIfT2eE91YKw.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="b55a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在您可以使用<code class="fe oe of og oh b">${{ secrets.DAGSHUB_USERNAME }}</code>来访问秘密<code class="fe oe of og oh b">DAGSHUB_USERNAME</code>。</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="ceba" class="om kj it bd kk or os dn ko ot ou dp ks lj ov ow ku ln ox oy kw lr oz pa ky pb bi translated">运行测试</h2><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pd"><img src="../Images/8988bb55a03ed3643a5a9da904611001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Prnyik5wQ2A5ciZP2NmRhw.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="66ba" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们的代码有两个部分:训练模型和部署模型。我们将编写一些步骤来确保这两个部分都可以无任何错误地运行，并按预期工作。</p><p id="3f7d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">下面是测试训练代码的步骤:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="149f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">具体来说，我们测试处理代码和ML模型。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ph"><img src="../Images/5bd6ccc7b6c8ee70192e324a2e427922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4MjAys5zC0hXvQicGwrRMg.gif"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated"><em class="pi">在这里</em>  <em class="pi">找到所有的测试</em> <a class="ae nf" href="https://github.com/khuyentran1401/employee-future-prediction/tree/master/training/tests" rel="noopener ugc nofollow" target="_blank"> <em class="pi">。</em></a></figcaption></figure><p id="c786" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">测试部署代码的步骤包括:</p><ul class=""><li id="8691" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">将模型保存到BentoML本地商店</li></ul><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><ul class=""><li id="0983" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">在本地运行应用程序，并运行<a class="ae nf" href="https://github.com/khuyentran1401/employee-future-prediction/blob/master/application/tests/test_create_service.py" rel="noopener ugc nofollow" target="_blank">测试</a>以确保应用程序按照我们的预期工作。</li></ul><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="818a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><em class="ni">注意:这里，我们使用BentoML创建了一个ML驱动的应用程序。阅读这篇文章，了解更多关于BentoML的知识:</em></p><div class="nk nl gp gr nm nn"><a href="https://towardsdatascience.com/bentoml-create-an-ml-powered-prediction-service-in-minutes-23d135d6ca76" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">BentoML:在几分钟内创建一个ML驱动的预测服务</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">用Python封装和部署您的ML模型</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pj l ny nz oa nw ob mz nn"/></div></div></a></div><p id="bfad" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">将此工作流添加并提交到GitHub上的主分支。</p><pre class="mq mr ms mt gt oi oh oj ok aw ol bi"><span id="8776" class="om kj it oh b gy on oo l op oq">git add .github<br/>git commit -m 'add workflow'<br/>git push origin master</span></pre><h2 id="04b8" class="om kj it bd kk or os dn ko ot ou dp ks lj ov ow ku ln ox oy kw lr oz pa ky pb bi translated">添加规则</h2><p id="3072" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了确保只有在工作流成功运行时代码才可以被合并<strong class="lc iu">，选择<em class="ni">设置</em> → <em class="ni">分支</em> → <em class="ni">添加规则</em>。</strong></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pk"><img src="../Images/82736a42fcdb0be5153e4caf9a22f921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrkEJHUQnk3vQ6bu_LlaNg.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="2d67" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">添加<code class="fe oe of og oh b">master</code>作为分支名称模式，勾选<code class="fe oe of og oh b">Require status checks to pass before merging</code>，然后在<em class="ni">状态检查下添加需要</em>的工作流名称。最后，点击<em class="ni">保存更改</em>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pl"><img src="../Images/f4b32afcef9988f9f1c6dfc2aa52c690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jfziFo6HMl1qftAQTK22CQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="91cd" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在当你创建一个拉请求时，GitHub Actions会自动运行工作流<code class="fe oe of og oh b">Test new model</code>。如果检查未通过，您将无法合并拉取请求。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pm"><img src="../Images/709ae3ad9270738137624af8fa45f197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IGfW1WktyiNDW3oKBhf8BA.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="2f93" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">点击<em class="ni">详情</em>将显示运行状态。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/bb18d88e0a93cdf77f539f0707eced5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*uX7VPXtVLn3rTlFP7F1Chg.gif"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者GIF</figcaption></figure><p id="c2e7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">测试训练代码的完整代码:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="a93c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">合并后使用GitHub操作部署模型</h1><p id="d130" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在合并拉请求之后，模型应该会自动部署到现有的服务中。让我们创建一个GitHub工作流来做这件事。</p><p id="b174" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">首先创建另一个名为<code class="fe oe of og oh b"><a class="ae nf" href="https://github.com/khuyentran1401/employee-future-prediction/blob/master/.github/workflows/deploy_app.yaml" rel="noopener ugc nofollow" target="_blank">deploy_app.yaml</a></code>的工作流:</p><pre class="mq mr ms mt gt oi oh oj ok aw ol bi"><span id="ddc8" class="om kj it oh b gy on oo l op oq">.github<br/>└── workflows<br/>    ├── deploy_app.yaml<br/>    └── test_model.yaml</span></pre><p id="ee1b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">工作流程的前几个步骤与之前的工作流程相似:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pd"><img src="../Images/d7c687aea44ff476e41be36eeb1010a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kce98VX0YywaGtA8mfMhkQ.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="59f1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们还使用<code class="fe oe of og oh b">env</code>将环境变量添加到工作流中。环境变量将在工作流的某些步骤中使用。</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b5eb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">接下来，我们使用<a class="ae nf" href="https://towardsdatascience.com/bentoml-create-an-ml-powered-prediction-service-in-minutes-23d135d6ca76" rel="noopener" target="_blank"> BentoML </a>将模型打包，然后部署到<a class="ae nf" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi po"><img src="../Images/33e105da164350a8ccc9beacf8bac03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gb37ASDRRILsKJYe3CBFyw.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><blockquote class="pp pq pr"><p id="6a9f" class="la lb ni lc b ld lw ju lf lg lx jx li ps ly ll lm pt lz lp lq pu ma lt lu lv im bi translated"><a class="ae nf" href="https://github.com/khuyentran1401/employee-future-prediction/blob/master/.github/workflows/deploy_app.yaml" rel="noopener ugc nofollow" target="_blank">部署app的完整代码</a>。</p></blockquote><p id="76f2" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">将此工作流添加并提交到GitHub上的主分支。</p><pre class="mq mr ms mt gt oi oh oj ok aw ol bi"><span id="16ab" class="om kj it oh b gy on oo l op oq">git add .github<br/>git commit -m 'add workflow'<br/>git push origin master</span></pre><p id="07e4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，当您合并一个拉取请求时，一个名为<code class="fe oe of og oh b">Deploy App</code>的工作流将会运行。要查看工作流的状态，请单击<em class="ni">操作</em> →最新工作流的名称→ <em class="ni">部署应用程序</em>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pv"><img src="../Images/8aa56491f7f65f54de70cb84943c5741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xn0lBO9RPTLR_OAGH_iamA.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/3bfe170ac8cf48bf114e6ae3279d88ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*swZBvkbKvUCoejcoPVCLDA.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="baa3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，您应该看到您的工作流正在运行:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/95a6f4e2be705139092ab947761c7614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*2w4BtvMh-jTS1LE9kT-4KA.gif"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者GIF</figcaption></figure><p id="638e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">酷！这款应用的网站名为<a class="ae nf" href="https://employee-predict-1.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://employee-predict-1.herokuapp.com/</a>，现已更新。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi px"><img src="../Images/bef6b064a678d540ca57e62b1e042fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R9DjDXg0ahPbsyTWSOGUSw.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者图片</figcaption></figure><p id="2d8e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">由于我的Streamlit应用程序向上面的URL发出POST请求来生成预测，因此该应用程序也进行了更新。</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi py"><img src="../Images/9241cf1b92f97fbe6b199bfbf6bdf82d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*puxBBbPXeg-YEP3UhCL95g.gif"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk translated">作者GIF</figcaption></figure><h1 id="9232" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="24d8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">恭喜你！您刚刚学习了如何使用GitHub操作来创建工作流，该工作流自动测试来自团队成员的pull请求，并将ML模型部署到现有的服务中。我希望这篇文章能给你动力，用GitHub Actions自动化你的任务。</p><p id="6275" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">随意发挥，并在这里叉这篇文章的源代码:</p><div class="nk nl gp gr nm nn"><a href="https://github.com/khuyentran1401/employee-future-prediction" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">GitHub-khuyentran 1401/employee-future-prediction:在MLOps中使用GitHub操作的演示</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">在数据科学团队中，经常会不断尝试找到比生产中现有模型更好的模型。它…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="pz l ny nz oa nw ob mz nn"/></div></div></a></div><p id="7c8d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的数据科学工具。你可以在LinkedIn和Twitter上与我联系。</p><p id="fee3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在Medium上关注我，了解我的最新数据科学文章，例如:</p><div class="nk nl gp gr nm nn"><a href="https://towardsdatascience.com/introduction-to-dvc-data-version-control-tool-for-machine-learning-projects-7cb49c229fe0" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">DVC介绍:机器学习项目的数据版本控制工具</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">就像Git一样，但是有数据！</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="qa l ny nz oa nw ob mz nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://towardsdatascience.com/bentoml-create-an-ml-powered-prediction-service-in-minutes-23d135d6ca76" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">BentoML:在几分钟内创建一个ML驱动的预测服务</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">用Python封装和部署您的ML模型</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="pj l ny nz oa nw ob mz nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://towardsdatascience.com/dagshub-a-github-supplement-for-data-scientists-and-ml-engineers-9ecaf49cc505" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">Dag shub:GitHub对数据科学家和ML工程师的补充</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">将您的数据、模型、实验和代码保存在一个地方</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob mz nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a href="https://towardsdatascience.com/orchestrate-a-data-science-project-in-python-with-prefect-e69c61a49074" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">用Prefect编制Python中的数据科学项目</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">用几行代码优化您的数据科学工作流程</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="qb l ny nz oa nw ob mz nn"/></div></div></a></div><h1 id="fd0f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">参考</strong></h1><p id="a48f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><em class="ni">用Github动作部署到Heroku</em>。显著的标记。(2021年3月12日)。2022年5月31日检索，来自<a class="ae nf" href="https://remarkablemark.org/blog/2021/03/12/github-actions-deploy-to-heroku/" rel="noopener ugc nofollow" target="_blank">https://remarkable mark . org/blog/2021/03/12/github-actions-deploy-to-heroku/</a></p><p id="ad0c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">加尔维斯，J. (2020年8月12日)。<em class="ni">使用Github动作对REST API进行集成测试</em>。中等。2022年5月31日检索，来自<a class="ae nf" href="https://medium.com/weekly-webtips/using-github-actions-for-integration-testing-on-a-rest-api-358991d54a20" rel="noopener">https://medium . com/weekly-web tips/using-github-actions-for-integration-testing-on-a-rest-API-358991d 54 a 20</a></p><p id="9177" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">Ktrnka。(未注明)。<em class="ni"> Ktrnka/MLOPS_EXAMPLE_DVC:使用DVC、S3和Heroku的MLOPS示例</em>。GitHub。于2022年5月31日从<a class="ae nf" href="https://github.com/ktrnka/mlops_example_dvc" rel="noopener ugc nofollow" target="_blank">https://github.com/ktrnka/mlops_example_dvc</a>检索</p><p id="6cab" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">员工未来预测。CC0:公共领域。检索自<a class="ae nf" href="https://www.kaggle.com/datasets/tejashvi14/employee-future-predictio" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/tejashvi 14/employee-future-prediction</a></p></div></div>    
</body>
</html>