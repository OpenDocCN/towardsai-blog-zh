<html>
<head>
<title>Building Bag of Words (BOW) Model from Scratch in NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在NLP中从头开始构建单词袋(BOW)模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/natural-language-processing-a983bc35561?source=collection_archive---------2-----------------------#2021-07-14">https://pub.towardsai.net/natural-language-processing-a983bc35561?source=collection_archive---------2-----------------------#2021-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="cd6d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><div class=""><h2 id="9afc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">自然语言处理中的文本表示模型</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/a4baf3847819a8b3cf872b7457de4f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tEQ_oY6Cf2cLf9r4"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d98f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我们将讨论自然语言处理中的词袋(BOW)模型构建。有时，我们试图找到文本文档中出现的单词，并尝试使用简单的计数方法来搜索一个单词的计数。但是如果我们想知道每个单词在文本文档中的出现及其计数，那么我们使用<strong class="lk jd"> <em class="me">单词包</em> </strong>方法，也称为<strong class="lk jd"> <em class="me">单词嵌入</em> </strong>。</p><p id="7798" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">单词包用于从文本中提取信息，并试图用其字数将它们制作成字典或直方图。</p><p id="d906" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们用下面这句话来举例:</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="8484" class="mk ml it mg b gy mm mn l mo mp">Sentence 1: “Thank you so much for your help.”<br/>Sentence 2: “ Your most welcome.”</span></pre><p id="e131" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这些句子中，我们首先将它们分解成标记，并从句子中删除所有标点和符号，以建立模型，以便用算法进行进一步分析。</p><p id="854e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">用字数做一个矩阵有简单的步骤。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="aa1c" class="mk ml it mg b gy mm mn l mo mp">Step 1: Make tokens from the sentences<br/>Step 2: Lower all words<br/>Step 3: make a matrix or dictionary with word counts</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mq"><img src="../Images/e2b27215f57f0f28ab7818d8c20f6b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IYu2LVQLp8XER2eyct6hxQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">字数统计。作者的照片</figcaption></figure><p id="6afb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的照片中，我们可以清楚地看到，句子1和2中的单词数都显示了它们在句子中的出现次数。</p><p id="7ab6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们实际上要从头开始寻找这个单词包。</p><p id="5bf2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">安装NLTK库和其他用于自然语言处理的库</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="d55c" class="mk ml it mg b gy mm mn l mo mp">import nltk<br/>import re</span></pre><p id="dfcc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们将阅读文本数据示例。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="5f43" class="mk ml it mg b gy mm mn l mo mp">text = """Machine learning and robotic vision system combination<br/>          opens a gateway for precision agriculture and enhances the<br/>          quality of fruit harvesting applications. Study describes<br/>          various challenges in the fruit agricultural process like<br/>          weather, illumination variation and occlusion, etc.. <br/>          Currently fruit harvesting processes are manual with semi-<br/>          advanced machinery. Many approaches use images that<br/>          contain fruits to make more advanced vision system for <br/>          yield estimation analysis."""</span></pre><p id="c81e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">是时候用文字做记号了。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="1a79" class="mk ml it mg b gy mm mn l mo mp">token_data = nltk.sent_tokenize(text)<br/>token_data</span><span id="b578" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>['Machine learning and robotic vision system combination opens a gateway for precision \n           agriculture and enhances the quality of fruit harvesting applications. Study describes \n           various challenges in the fruit agricultural process like weather, illumination variation \n           and occlusion, etc..',<br/> 'Currently fruit harvesting processes are manual with semi-advanced \n           machinery.',<br/> 'Many approaches use images that contain fruits to make more advanced vision system \n           for yield estimation analysis.']</span></pre><p id="7544" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在输出中，很明显输出中有一些杂质和标点符号，我们需要删除它们。</p><p id="f3db" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们还需要找到令牌的长度。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="7314" class="mk ml it mg b gy mm mn l mo mp">len(token_data)</span><span id="3fd4" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>3</span></pre><p id="fd0c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这意味着在原始数据中有3个句子。</p><p id="7b6f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了移除这些，我们需要一个正则表达式(re)库，我们在开始时导入了这个库。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="c763" class="mk ml it mg b gy mm mn l mo mp">#to remove the extra non-words</span><span id="b828" class="mk ml it mg b gy mr mn l mo mp">for i in range(len(token_data)):<br/>    token_data[i] = token_data[i].lower()<br/>    token_data[i] = re.sub(r'\W',' ', token_data[i])<br/>    token_data[i] = re.sub(r'\s+',' ', token_data[i])</span><span id="8796" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>['machine learning and robotic vision system combination opens a gateway for precision agriculture and enhances the quality of fruit harvesting applications study describes various challenges in the fruit agricultural process like weather illumination variation and occlusion etc ','currently fruit harvesting processes are manual with semi advanced machinery ','many approaches use images that contain fruits to make more advanced vision system for yield estimation analysis ']</span></pre><p id="1d9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们得到了更清晰的数据，现在我们将制作这些单词的直方图或词典。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="6816" class="mk ml it mg b gy mm mn l mo mp">#creating the histogram or dictionary<br/>word2count = {}<br/>for data in token_data:<br/>    words = nltk.word_tokenize(data)<br/>    for word in words:<br/>        if word not in word2count.keys():<br/>            word2count[word] = 1<br/>        else:<br/>            word2count[word] += 1</span><span id="0330" class="mk ml it mg b gy mr mn l mo mp">word2count</span><span id="9823" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>{'machine': 1,<br/> 'learning': 1,<br/> 'and': 3,<br/> 'robotic': 1,<br/> 'vision': 2,<br/> 'system': 2,<br/> 'combination': 1,<br/> 'opens': 1,<br/> 'a': 1,<br/>   ...<br/>   ...<br/> 'makemore': 1,<br/> 'yield': 1,<br/> 'estimation': 1,<br/> 'analysis': 1}</span></pre><p id="36a6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如我们所看到的，这是一个小例子，但如果我们必须进行文本分类并对数千个单词进行建模，那么我们必须从所有单词中提取出最常见的单词。</p><p id="5218" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">字数的总长度如下所示:</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="1c11" class="mk ml it mg b gy mm mn l mo mp">len(word2count)</span><span id="fa0b" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>52</span></pre><p id="a01e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了从52个单词中提取前20个最常用的单词，我们使用heapq库。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="d42e" class="mk ml it mg b gy mm mn l mo mp">import heapq</span><span id="1e7d" class="mk ml it mg b gy mr mn l mo mp">freq_words = heapq.nlargest(20, word2count, key = word2count.get)<br/>freq_words</span><span id="6315" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>['and','fruit','vision','system','for','the','harvesting',<br/> 'advanced','machine','learning','robotic','combination','opens',<br/> 'a','gateway','precision','agriculture','enhances','quality','of']</span></pre><p id="4d5d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们得到了文本文档中最常用的20个单词的列表。</p><div class="ms mt gp gr mu mv"><a rel="noopener  ugc nofollow" target="_blank" href="/latest-programming-languages-for-ai-5252d39e1c51"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">最新的人工智能编程语言</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">人工智能未来娱乐它的语言</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">pub.towardsai.net</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj lb mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener  ugc nofollow" target="_blank" href="/natural-language-processing-ea960ba12d42"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">自然语言处理</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">用Python实现自然语言处理中的词干化和词汇化</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">pub.towardsai.net</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj lb mv"/></div></div></a></div><p id="3e23" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将尝试将freq_words与原始数据进行匹配，以制作单词袋模型。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="6c80" class="mk ml it mg b gy mm mn l mo mp">bow = []<br/>for data in text:<br/>    vector = []<br/>    for word in freq_words:<br/>        if word in nltk.word_tokenize(data):<br/>            vector.append(1)<br/>        else:<br/>            vector.append(0)<br/>    bow.append(vector)</span><span id="1b71" class="mk ml it mg b gy mr mn l mo mp">bow</span><span id="dcbb" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],<br/> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],<br/> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],<br/>                        .........<br/> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],<br/> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],<br/> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]]</span></pre><p id="305e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">单词袋模型是一个列表的列表。但是为了我们的算法，我们需要把它做成一个数组矩阵。</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="9c7a" class="mk ml it mg b gy mm mn l mo mp">import numpy as np</span><span id="a64a" class="mk ml it mg b gy mr mn l mo mp">bow = np.asarray(bow)</span><span id="041e" class="mk ml it mg b gy mr mn l mo mp">bow</span><span id="be6d" class="mk ml it mg b gy mr mn l mo mp">#output:<br/>array([[0, 0, 0, ..., 0, 0, 0],<br/>       [0, 0, 0, ..., 0, 0, 0],<br/>       [0, 0, 0, ..., 0, 0, 0],<br/>       ...,<br/>       [0, 0, 0, ..., 0, 0, 0],<br/>       [0, 0, 0, ..., 0, 0, 0],<br/>       [0, 0, 0, ..., 0, 0, 0]])</span></pre><p id="5844" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，这个输出是一个二维数组，对进一步建模很有用。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="caf8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae lh" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="2874" class="ns ml it bd nt nu nv nw nx ny nz oa ob ki oc kj od kl oe km of ko og kp oh oi bi translated">推荐文章</h1><p id="44ae" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated"><a class="ae lh" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener"> 1。NLP —零到英雄用Python </a> <br/> 2。<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a> <br/> 3。<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/exception-handling-concepts-in-python-4d5116decac3?source=friends_link&amp;sk=a0ed49d9fdeaa67925eac34ecb55ea30">Python中的异常处理概念</a> <br/> 4。<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/deep-learning-88e218b74a14?source=friends_link&amp;sk=540bf9088d31859d50dbddab7524ba35">为什么LSTM在深度学习方面比RNN更有用？</a> <br/> 5。<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/neural-networks-the-rise-of-recurrent-neural-networks-df740252da88?source=friends_link&amp;sk=6844935e3de14e478ce00f0b22e419eb">神经网络:递归神经网络的兴起</a> <br/> 6。<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python充分解释了线性回归</a> <br/> 7。<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python </a> <br/>充分解释了Logistic回归8。<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/differences-between-concat-merge-and-join-with-python-1a6541abc08d?source=friends_link&amp;sk=3b37b694fb90db16275059ea752fc16a">concat()、merge()和join()与Python </a> <br/> 9的区别。<a class="ae lh" rel="noopener ugc nofollow" target="_blank" href="/data-wrangling-with-python-part-1-969e3cc81d69?source=friends_link&amp;sk=9c3649cf20f31a5c9ead51c50c89ba0b">与Python的数据角力—第一部分</a>T30】10。<a class="ae lh" href="https://medium.com/analytics-vidhya/confusion-matrix-in-machine-learning-91b6e2b3f9af?source=friends_link&amp;sk=11c6531da0bab7b504d518d02746d4cc" rel="noopener">机器学习中的混淆矩阵</a></p></div></div>    
</body>
</html>