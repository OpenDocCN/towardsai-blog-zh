<html>
<head>
<title>DBT — The One Tool To Rule Them All</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DBT——统治他们的唯一工具</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/one-tool-to-rule-them-all-2083371c1618?source=collection_archive---------1-----------------------#2022-03-25">https://pub.towardsai.net/one-tool-to-rule-them-all-2083371c1618?source=collection_archive---------1-----------------------#2022-03-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="b1b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">数据构建工具(DBT)为您提供更好的数据质量。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/24638ccf3ff1d13f101bcd32c25da8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ca65cnhKLz1isYo8"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">潘卡杰·帕特尔在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="5a10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">找出数据的问题是我的专长。我喜欢它。我不断调查为什么从一个来源到下一个来源的数字不匹配，并从根本上解决问题。不幸的是，或者对我来说幸运的是，有许多数据质量问题。</p><p id="32bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">数据质量差的影响是巨大的。根据Gartner的数据质量市场调查，2017年数据质量差的平均年财务成本约为<strong class="js iu">1500万美元</strong>。但这还不是最糟糕的。根据麻省理工学院斯隆管理学院的研究，知识工作者浪费了高达50%的时间来处理数据质量问题，而对于数据科学家来说，这一数字高达80%，这表明大多数员工因为数据质量问题而无法完成他们的工作。</p><p id="e722" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文将解释什么是糟糕的数据质量，什么是数据构建工具(dbt ),以及最后，dbt如何提供帮助。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="bc86" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">什么是数据质量？</h1><p id="2102" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">数据质量是确保信息准确和完整的过程。它也被称为数据完整性，指的是如何存储和组织信息，即数据适合使用的程度。</p><p id="1ce1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当数据收集或输入不准确或处理、存储或访问不当时，可能会出现数据质量问题。例如，如果文件中的数据不完整，那就是数据质量的问题。如果您不保持记录最新，随着时间的推移，不正确的信息会添加到您的数据库中，并且您的报告的准确性也会受到影响。存储和访问信息时也会出错。</p><p id="4580" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">持续监控数据是任何质量保证过程的基石。目标应该是限制错误的数量，这样，数据质量会变得更好。</p><p id="4b85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">持续的监控过程应该能够减少错误的数量。这不仅能保持高质量的标准，还能很好地表明流程正在按预期运行。对于商业领袖来说，凭借自己的力量让一项产品或服务取得成功已经够难的了，但如果没有不可靠的数据，这就变得更具挑战性了。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="fa34" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated"><strong class="ak">什么是数据构建工具(DBT)？</strong></h1><p id="69ee" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">DBT是数据转换工作的工具。用户可以在他们喜欢的文本编辑器中编写dbt代码，并运行dbt命令。代码被编译成原始SQL，并根据配置的数据仓库执行。</p><ol class=""><li id="ee0a" class="mp mq it js b jt ju jx jy kb mr kf ms kj mt kn mu mv mw mx bi translated">文档— dbt帮助您编写、编辑和共享dbt模型的文档。您可以用纯文本给出每个模型和字段的描述。这些描述，包括像列名和数据类型这样的元数据，可以作为一个网站生成，并与团队的其他成员共享。</li><li id="42f4" class="mp mq it js b jt my jx mz kb na kf nb kj nc kn mu mv mw mx bi translated">测试—dbt可以通过断言每个模型中的SQL应该产生什么结果来检查它们是否有意义。当您从数据集中导入一个现有的模式时，您会得到包括唯一值、对应于另一个模型的值以及特定列表中的值的断言。</li><li id="373d" class="mp mq it js b jt my jx mz kb na kf nb kj nc kn mu mv mw mx bi translated">种子文件加载器—这些文件可以将原始值映射到更易读的值，或者赋予静态数据。</li><li id="700f" class="mp mq it js b jt my jx mz kb na kf nb kj nc kn mu mv mw mx bi translated">快照— dbt提供了一种对某个时间点的原始数据进行快照的机制。</li></ol><p id="d930" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关于这个库的更多信息在他们的 <a class="ae le" href="https://docs.getdbt.com/docs/introduction" rel="noopener ugc nofollow" target="_blank"> <em class="nd">介绍页面。</em>T5】</a></p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="6985" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated"><strong class="ak">是否有其他与dbt集成的软件包可以最大限度地发挥优势？</strong></h1><h2 id="7899" class="ne ln it bd lo nf ng dn ls nh ni dp lw kb nj nk ma kf nl nm me kj nn no mi np bi translated">1.dbt-codegen⁴</h2><p id="dfb3" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">如果您还没有开始设置您的dbt模型，这个库将帮助您完成这项工作！这个包包含三个宏来帮助建立模型。</p><ul class=""><li id="ccb7" class="mp mq it js b jt ju jx jy kb mr kf ms kj mt kn nq mv mw mx bi translated"><em class="nd"> generate_source </em>为源生成轻量级YAML。</li><li id="f863" class="mp mq it js b jt my jx mz kb na kf nb kj nc kn nq mv mw mx bi translated"><em class="nd"> generate_base_model </em>生成基础模型的SQL，粘贴到文件中。</li><li id="be3e" class="mp mq it js b jt my jx mz kb na kf nb kj nc kn nq mv mw mx bi translated"><em class="nd"> generate_model_yaml </em>生成模型的yaml，粘贴到schema.yml文件中。</li></ul><h2 id="b061" class="ne ln it bd lo nf ng dn ls nh ni dp lw kb nj nk ma kf nl nm me kj nn no mi np bi translated">2.dbt-期望值</h2><p id="31b2" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">在python中,“远大前程”是一个共享的、开放的数据质量标准。它帮助数据团队通过数据测试、记录和分析来消除管道债务。”⁵</p><p id="9493" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，除了dbt之外，我们有了相同的库！这给当前的dbt库增加了额外的测试。如果你想看所有的列表，请点击查看！</p><h2 id="e6e7" class="ne ln it bd lo nf ng dn ls nh ni dp lw kb nj nk ma kf nl nm me kj nn no mi np bi translated">3.dbt _度量</h2><p id="9124" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">该宏基于指标生成查询。您可以通过几种不同的方式来完成，包括比较一个时期与另一个时期的指标、平均指标或累计指标，或者累计指标。</p><p id="b789" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nd">这也将很快在dbt服务器上实现，更多信息请访问</em><a class="ae le" href="https://github.com/dbt-labs/dbt_metrics" rel="noopener ugc nofollow" target="_blank"><em class="nd">dbt _ metrics</em></a><em class="nd">。</em></p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="4161" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">设置DBT项目</h1><p id="ba9c" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">我的特定设置将包括三种模式“导入”、“基本”和“聚合”。这些模式中的每一个都有相同的表，dbt将这些标签称为“模型”，将文件夹标记为“模型”文件夹，导入目录、基本目录和聚集目录都位于其中。</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="7593" class="ne ln it ns b gy nw nx l ny nz">.<br/>├── analysis<br/>├── data<br/>├── macros<br/>├── models<br/>│   ├── import<br/>|   ├── base<br/>│   └── aggregated<br/>├── snapshots<br/>└── tests</span></pre><p id="6bb6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将使用由<a class="ae le" href="https://github.com/dbt-labs/dbt-codegen" rel="noopener ugc nofollow" target="_blank"> <em class="nd"> dbt-codegen </em> </a>包提供的命令。您可以使用以下命令轻松设置源文件:</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="07bb" class="ne ln it ns b gy nw nx l ny nz">dbt run-operation generate_source --args 'schema_name: base' &gt; models/import/customers.yml</span></pre><p id="bc46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以添加额外的参数，如database_name、generate_columns(这是我绝对推荐的！)、include_descriptions、table_pattern或exclude。</p><p id="179d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们可以获得模型SQL文件。</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="329d" class="ne ln it ns b gy nw nx l ny nz">dbt run-operation generate_base_model --args '{"source_name": "base", "table_name": "customers"}' &gt; models/base/customers.sql</span></pre><p id="9875" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，是实际的YML模型文件。</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="0dd6" class="ne ln it ns b gy nw nx l ny nz">dbt run-operation generate_model_yaml --args '{"model_name": "customers"}' &gt; models/base/customers.yml</span></pre><p id="cf3c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由此产生的客户。YML看起来会像这样:</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="4a3e" class="ne ln it ns b gy nw nx l ny nz">version: 2<br/><br/>models:<br/>  - name: customers<br/>    columns:<br/>      - name: customer_id<br/>        description: "The Id for customers"<br/>      - name: customer_name<br/>        description: "The actual name of the customer"</span></pre><p id="c6fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们可以添加测试。</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="b5f6" class="ne ln it ns b gy nw nx l ny nz">version: 2<br/><br/>models:<br/>  - name: customers<br/>    columns:<br/>      - name: customer_id<br/>        tests:<br/>          - unique<br/>          - <!-- -->dbt_expectations.expect_column_values_to_be_between:<br/>               min_value: 0<br/>               max_value: 10<br/>      <!-- -->- name: customer_name<br/>        description: "The actual name of the customer</span></pre><p id="73cd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第一个测试是已经作为库的一部分的唯一性测试，而第二个测试是dbt_expectations测试的一部分。</p><p id="3b29" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以实现更多的宏来检查您的数据是否与预期相符。如果这些宏都不能满足您的需要，您可以编写自己的宏。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="6785" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过实现dbt和这些额外的宏，您可以提高洞察力和数据质量。</p><pre class="kp kq kr ks gt nr ns nt nu aw nv bi"><span id="cc25" class="ne ln it ns b gy nw nx l ny nz"><strong class="ns iu">References</strong><br/>1. <a class="ae le" href="https://www.gartner.com/smarterwithgartner/how-to-stop-data-quality-undermining-your-business" rel="noopener ugc nofollow" target="_blank">https://www.gartner.com/smarterwithgartner/how-to-stop-data-quality-undermining-your-business</a><br/>2. <a class="ae le" href="https://sloanreview.mit.edu/article/seizing-opportunity-in-data-quality/#:%7E:text=One%20consequence%20is%20that%20knowledge,go%20as%20high%20as%2080%25.&amp;text=In%20fact%2C%20only%2016%25%20of,use%20to%20make%20important%20decisions" rel="noopener ugc nofollow" target="_blank">https://sloanreview.mit.edu/article/seizing-opportunity-in-data-quality/#:%7E:text=One%20consequence%20is%20that%20knowledge,go%20as%20high%20as%2080%25.&amp;text=In%20fact%2C%20only%2016%25%20of,use%20to%20make%20important%20decisions</a>.<br/>3. <a class="ae le" href="https://docs.getdbt.com/docs/introduction" rel="noopener ugc nofollow" target="_blank">https://docs.getdbt.com/docs/introduction</a><br/>4. <a class="ae le" href="https://github.com/dbt-labs/dbt-codegen" rel="noopener ugc nofollow" target="_blank">https://github.com/dbt-labs/dbt-codegen</a><br/>5. <a class="ae le" href="https://greatexpectations.io/" rel="noopener ugc nofollow" target="_blank">https://greatexpectations.io/</a><br/>6. <a class="ae le" href="https://docs.getre.io/latest/docs/introduction/whatis" rel="noopener ugc nofollow" target="_blank">https://docs.getre.io/latest/docs/introduction/whatis</a></span></pre></div></div>    
</body>
</html>