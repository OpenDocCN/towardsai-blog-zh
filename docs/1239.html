<html>
<head>
<title>Machine Learning with Low Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">低代码的机器学习</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/machine-learning-with-low-code-75d152172e4b?source=collection_archive---------0-----------------------#2020-12-11">https://pub.towardsai.net/machine-learning-with-low-code-75d152172e4b?source=collection_archive---------0-----------------------#2020-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="262e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="e704" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用PyCaret实现房价预测</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ad74dd9c51ac2e436bf871f141c702c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__ryJQAuT1PYMzNUD8rc9w.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@ryland_dean?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">瑞兰德·迪恩</a>在<a class="ae lh" href="https://unsplash.com/s/photos/low-code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="c59f" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="8820" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi mw translated"><span class="l mx my mz bm na nb nc nd ne di"> M </span>有没有人说构建机器学习这么难，用复杂的代码。那绝对不是真的。其实我们可以用一个简单的代码来开发。但在实际情况下，建立机器学习的重要之处在于了解问题并找到解决方案。不知道这个问题，我们就找不到解决办法。编码只是找到解决方案的桥梁。所以我们必须保持心态。因此，作为一名数据科学家，我们有很好的判断力。</p><p id="3e8c" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">这对我们来说是个好消息，我们必须感谢Python的Moez Ali先生作为PyCaret的作者。我们可以用最少的代码构建机器学习，找到与我们的数据集相匹配的最佳算法来解决问题。我们可以用PyCaret构建分类、回归和聚类。但在本节中，我们将练习一个回归问题来预测Kaggle的房价。请下载<a class="ae lh" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank"> <em class="nm">上的数据集本</em> </a> <em class="nm">练习</em>。</p><p id="df76" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">在这里，我们只关注使用Pycaret进行自动预处理和建模机器学习。我们还没有进行探索性数据分析(EDA)。实际上，在建模之前，我们必须让EDA获得一些洞察力，或许获得一些新功能。但在这里，我们只建立模型。我们建议遵循这些要点，以便更好地理解:</p><ol class=""><li id="7de3" class="nn no it mc b md nf mg ng mj np mn nq mr nr mv ns nt nu nv bi translated">定义问题</li><li id="f93c" class="nn no it mc b md nw mg nx mj ny mn nz mr oa mv ns nt nu nv bi translated">需求评估</li><li id="3f20" class="nn no it mc b md nw mg nx mj ny mn nz mr oa mv ns nt nu nv bi translated">用Pycaret预处理</li><li id="dc1d" class="nn no it mc b md nw mg nx mj ny mn nz mr oa mv ns nt nu nv bi translated">建模和评估</li><li id="32eb" class="nn no it mc b md nw mg nx mj ny mn nz mr oa mv ns nt nu nv bi translated">屈服</li></ol><p id="2e05" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">我们走吧…</p><p id="791e" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">我们从大纲开始，一步一步用低编码练习机器学习建模。</p><h1 id="1878" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">讨论</h1><blockquote class="ob oc od"><p id="2016" class="ma mb nm mc b md nf kd mf mg ng kg mi oe nh ml mm of ni mp mq og nj mt mu mv im bi translated">1.定义问题</p></blockquote><p id="f4d6" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">我们曾被一位购房者要求描述他们梦想中的房子，他们可能不会从地下室天花板的高度或靠近东西向铁路开始。但是这个游乐场竞赛的数据集证明，影响价格谈判的远不止卧室的数量或白色尖桩栅栏。</p><p id="b925" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">有79个解释变量描述了(几乎)爱荷华州埃姆斯住宅的每个方面，这个比赛挑战你预测每个家庭的最终价格。</p><p id="59f1" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">从那个问题中，我们发现目标建模就是预测每套房子的价格。因此，我们使用“S <em class="nm"> alePrice" </em>变量作为预测的目标，因为该变量的值定义了每套房屋的价格。</p><blockquote class="ob oc od"><p id="6aef" class="ma mb nm mc b md nf kd mf mg ng kg mi oe nh ml mm of ni mp mq og nj mt mu mv im bi translated">2.需求评估</p></blockquote><blockquote class="oh"><p id="f2e6" class="oi oj it bd ok ol om on oo op oq mv dk translated">a.<a class="ae lh" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview/evaluation" rel="noopener ugc nofollow" target="_blank">预科评估</a> : RMSE</p></blockquote><p id="f3e1" class="pw-post-body-paragraph ma mb it mc b md or kd mf mg os kg mi mj ot ml mm mn ou mp mq mr ov mt mu mv im bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" rel="noopener ugc nofollow" target="_blank">预测值对数和观察销售价格对数之间的均方根误差(RMSE) </a>。(取日志意味着预测贵房子和便宜房子的误差会同等影响结果)。最佳性能是具有最小RMSE分数的模型。因此，在这种情况下，我们选择产生最小RMSE分数的模型。</p><blockquote class="ob oc od"><p id="7dcb" class="ma mb nm mc b md nf kd mf mg ng kg mi oe nh ml mm of ni mp mq og nj mt mu mv im bi translated">3.用Pycaret预处理</p></blockquote><blockquote class="oh"><p id="d1ab" class="oi oj it bd ok ol om on oo op oq mv dk translated">a.从笔记本安装PyCaret</p></blockquote><p id="1bd2" class="pw-post-body-paragraph ma mb it mc b md or kd mf mg os kg mi mj ot ml mm mn ou mp mq mr ov mt mu mv im bi translated">在笔记本上，你可以安装python的库，以“！”开始。</p><pre class="ks kt ku kv gt ow ox oy oz aw pa bi"><span id="6097" class="pb lj it ox b gy pc pd l pe pf">!pip install pycaret</span></pre><blockquote class="oh"><p id="3e13" class="oi oj it bd ok ol om on oo op oq mv dk translated">b.加载数据</p></blockquote><p id="4d90" class="pw-post-body-paragraph ma mb it mc b md or kd mf mg os kg mi mj ot ml mm mn ou mp mq mr ov mt mu mv im bi translated">你可以从这个<a class="ae lh" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">站点</a>下载数据集。下载该数据集后，请使用以下代码加载数据:</p><pre class="ks kt ku kv gt ow ox oy oz aw pa bi"><span id="270c" class="pb lj it ox b gy pc pd l pe pf"># import library all we need</span><span id="9302" class="pb lj it ox b gy pg pd l pe pf">import os </span><span id="89db" class="pb lj it ox b gy pg pd l pe pf">import pandas as pd<br/>from pycaret.regression import *  #we import all package with '*' </span><span id="481e" class="pb lj it ox b gy pg pd l pe pf">os.chdir('D:/dataset') # we process data from "D:/datasets"  </span><span id="9168" class="pb lj it ox b gy pg pd l pe pf">train = pd.read_csv('train.csv')<br/>test = pd.read_csv('test.csv') </span><span id="e799" class="pb lj it ox b gy pg pd l pe pf">print('shape data train',train.shape)<br/>print('shape data test',test.shape) </span><span id="ebe1" class="pb lj it ox b gy pg pd l pe pf">train.head()</span></pre><p id="a851" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">如果你运行上面的代码，你可以看到结果是这样的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/8bdbffafbe0c8ea2b5202d3675c4721b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fdrG_a4WNe0YE3613bAEQw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">按作者列出的结果代码加载数据</figcaption></figure><p id="744a" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">我们有一个1460行81列的列车组。在测试中，我们有1459行和80列。你看到NaN值了吗？</p><p id="3a08" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">是的，我们这里有缺失值，但不能解释NaN值。接下来，我将在数据准备部分编写缺失值的处理。我们只专注于建立一个机器学习模型。</p><blockquote class="oh"><p id="7180" class="oi oj it bd ok ol pi pj pk pl pm mv dk translated">c.预处理数据</p></blockquote><p id="4344" class="pw-post-body-paragraph ma mb it mc b md or kd mf mg os kg mi mj ot ml mm mn ou mp mq mr ov mt mu mv im bi translated">a)自动预处理</p><p id="43f2" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">好的。我们正在完成数据加载。我们已经开始对数据进行自动预处理。让我们遵循这个代码:</p><pre class="ks kt ku kv gt ow ox oy oz aw pa bi"><span id="e7d9" class="pb lj it ox b gy pc pd l pe pf"># our target is SalePrice<br/>sal_clf = setup(train, target='SalePrice')</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/7c83a45d436c43336ad9aadae8c058ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*Efqwiq13FWWkjjXESKctNQ.jpeg"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者自动预处理的结果</figcaption></figure><p id="2595" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">在这里，我们有一个NaN值和一个PyCaret自动句柄。</p><blockquote class="ob oc od"><p id="c005" class="ma mb nm mc b md nf kd mf mg ng kg mi oe nh ml mm of ni mp mq og nj mt mu mv im bi translated">4.建模和评估</p></blockquote><blockquote class="oh"><p id="13d7" class="oi oj it bd ok ol om on oo op oq mv dk translated">a.建模比较</p></blockquote><p id="397d" class="pw-post-body-paragraph ma mb it mc b md or kd mf mg os kg mi mj ot ml mm mn ou mp mq mr ov mt mu mv im bi translated">通过对所有模型进行比较，我们可以找到最佳模型。像这样:</p><pre class="ks kt ku kv gt ow ox oy oz aw pa bi"><span id="ff9c" class="pb lj it ox b gy pc pd l pe pf">compare_models()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi po"><img src="../Images/3d049f5d1c0f28c42e4b053116c852f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DsvUtJvZ9Vl5JW2f5oINWg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者比较模型的结果</figcaption></figure><p id="f6a8" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">好了，我们发现最好的模型是Catboost回归器。因为它的RMSE分数最小。然后我们尝试用catboost进行预测。</p><blockquote class="oh"><p id="33fe" class="oi oj it bd ok ol pi pj pk pl pm mv dk translated">b.创建并预测最佳模型</p></blockquote><p id="9662" class="pw-post-body-paragraph ma mb it mc b md or kd mf mg os kg mi mj ot ml mm mn ou mp mq mr ov mt mu mv im bi translated">我们用交叉验证来制作我们的模型。在PyCaret默认值中，交叉验证是10倍。</p><pre class="ks kt ku kv gt ow ox oy oz aw pa bi"><span id="18e5" class="pb lj it ox b gy pc pd l pe pf">print('result train:')</span><span id="b0c0" class="pb lj it ox b gy pg pd l pe pf">catboost = create_model('catboost', cross_validation = True)</span><span id="2ff6" class="pb lj it ox b gy pg pd l pe pf">print('result predict:')<br/>pred_cb = predict_model(catboost)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/e87b94d32603d96750b250c8ffaa2abf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6sI5PB44rYRMmTtQWmGHg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">创建和预测模型的结果</figcaption></figure><p id="661d" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">太好了！我们用RMSE的得分得到的模型是27262.18，用RMSE的得分得到的预测模型是23446.68。做一个模型很棒，因为不会过度拟合。但这不是最好的模式。而且我又想起来了，你要做数据分析和数据准备。</p><blockquote class="ob oc od"><p id="d1ae" class="ma mb nm mc b md nf kd mf mg ng kg mi oe nh ml mm of ni mp mq og nj mt mu mv im bi translated">5.屈服</p></blockquote><p id="e707" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">要提交，您可以遵循以下代码:</p><pre class="ks kt ku kv gt ow ox oy oz aw pa bi"><span id="e341" class="pb lj it ox b gy pc pd l pe pf">fcb = finalize_model(catboost) #make model to variables </span><span id="3457" class="pb lj it ox b gy pg pd l pe pf">#making <br/>test_predictions = predict_model(fcb, data=test)</span><span id="44af" class="pb lj it ox b gy pg pd l pe pf">submission = test_predictions[['Id', 'Label']]<br/>submission.columns = ['Id','SalePrice']<br/>submission.to_csv('submission.csv', index=False)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pq"><img src="../Images/c7acf7dbf1402563b57e55b8fa9bde8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ct_6KNnbjqMPhL1ByG3KPw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者提交的结果</figcaption></figure><p id="c560" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">那是我的投稿分数。到目前为止，它还没有登上排行榜榜首。这是显而易见的，因为我们还没有进行探索性的数据分析和数据清理。</p><h1 id="4604" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结论</h1><p id="42c8" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这一部分，我们可以得出一些结论，用低代码构建一个机器学习模型是非常可行的。但是，我们得到的性能模型并不是更好。因为我们不做EDA，不做数据预处理，不做特征工程。所以，如果你想改善你的绩效模型，请做那些。</p><p id="dec1" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">我希望我的写作对你有用。</p><p id="1a85" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">谢谢，学习愉快！</p><p id="b85d" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">如果你想要这篇文章的印尼语言版本，请点击这里。</p><h1 id="736f" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">参考</h1><p id="4f87" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">[1] <a class="nk nl ep" href="https://medium.com/u/fba05660b60f?source=post_page-----75d152172e4b--------------------------------" rel="noopener" target="_blank"> Moez Ali </a>，<a class="ae lh" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank"> PyCaret主页</a>，(2020)</p><p id="4614" class="pw-post-body-paragraph ma mb it mc b md nf kd mf mg ng kg mi mj nh ml mm mn ni mp mq mr nj mt mu mv im bi translated">[2] <a class="nk nl ep" href="https://medium.com/u/fba05660b60f?source=post_page-----75d152172e4b--------------------------------" rel="noopener" target="_blank"> Moez Ali </a>，<a class="ae lh" href="https://pycaret.org/regression/" rel="noopener ugc nofollow" target="_blank">回归模块</a>，【2020】</p></div></div>    
</body>
</html>