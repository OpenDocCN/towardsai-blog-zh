<html>
<head>
<title>Understanding the IoU Metric in Object Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解对象检测中的IoU指标</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/understanding-iou-metric-in-object-detection-1e5532f06a76?source=collection_archive---------0-----------------------#2020-06-08">https://pub.towardsai.net/understanding-iou-metric-in-object-detection-1e5532f06a76?source=collection_archive---------0-----------------------#2020-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f7cd" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">计算机视觉</h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/1dd899806e46ffa5ae19a629929f25e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TaC4rJGJnKDTgu31"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated"><a class="ae kl" href="https://images.unsplash.com/photo-1453728013993-6d66e9c9123a?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1950&amp;q=80" rel="noopener ugc nofollow" target="_blank">https://images . unsplash . com/photo-1453728013993-6d 66 e 9 c 9123 a？IX lib = r b-1 . 2 . 1&amp;ixid = eyjhchbfawqiojeymdd 9&amp;auto = format&amp;fit = crop&amp;w = 1950&amp;q = 80</a></figcaption></figure><h1 id="fa3f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">介绍</h1><p id="7cbb" class="pw-post-body-paragraph lk ll iq lm b ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh ij bi translated">在本帖中，我们将讨论用于评估对象检测模型的指标。无论使用RCNN、快速RCNN、快速RCNN、YOLO等算法，度量都是不变的。</p><p id="e110" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">博客将主要分为三个部分，第一部分包括“什么”，“为什么”需要借据。第二个是python实现，最后是通过非最大值抑制在边界框选择环境中的应用。</p><p id="3324" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">一旦你建立了一个物体探测器，下一件事你想知道的是你的模型有多精确。这在所有机器学习项目中都很常见，在实现之前，应该对模型进行评估。在回归问题的情况下，我们有一个类似均方误差(MSE)的度量，类似地，对于分类，可以使用混淆矩阵、f1分数等；详情参见此<a class="ae kl" href="https://medium.com/analytics-vidhya/model-validation-for-classification-5ff4a0373090?source=your_stories_page---------------------------" rel="noopener">博客</a>。</p><p id="9703" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">现在回到我们的问题，物体检测的任务或者物体检测的输出无非是以一定的概率画一个包围盒。</p><figure class="mo mp mq mr gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi mn"><img src="../Images/0094f4c6adf6121df69eda4c9071c13a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoMmo8G_oFDRF9vo5rgwKg.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">样本输出:假设我们正在检测击球手</figcaption></figure><p id="c78b" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">边界框是一组用来定位图像的坐标，它因COCO和Pascal-VOC数据集而异。</p><ul class=""><li id="c397" class="ms mt iq lm b ln mi lr mj lv mu lz mv md mw mh mx my mz na bi translated">COCO: bbox是(左上x位置，左上y位置，宽度，高度)</li><li id="7c4f" class="ms mt iq lm b ln nb lr nc lv nd lz ne md nf mh mx my mz na bi translated">Pascal-VOC:bbox是(<em class="ng">xmin-左上，ymin-左上，xmax-右下，ymax-右下)</em></li></ul><p id="ca35" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">关于这些数据集的更多细节可以在<a class="ae kl" href="https://medium.com/towards-artificial-intelligence/understanding-coco-and-pascal-voc-annotations-for-object-detection-bb8ffbbb36e3" rel="noopener">这里</a>阅读。</p><p id="c715" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">红框:预测的边界框。</p><p id="6a6e" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">黑盒:实际包围盒或地面真相包围盒。</p><p id="feda" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">与准确性、<em class="ng"> f1 </em>得分等其他指标不同，这里我们使用相似度的概念，而不是bbox的点匹配。一种这样的相似性度量是Jaccard指数，或者在计算机视觉的通俗语言中，我们称之为并集上的交集。</p><p id="c1c3" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">假设我们有两组S1和S2，Jaccard指数J定义为</p><p id="84a5" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">J(S1，S2) = |S1 ∩ S2|/ |S1 U S2|</p><p id="cb13" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">IoU =相交面积/并集面积。</p><figure class="mo mp mq mr gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nh"><img src="../Images/abd93b6ac4990e214d7c93c0a5ba318f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNyFPKQM_aIQ5lyRHeeb6g.png"/></div></div></figure><ul class=""><li id="8f88" class="ms mt iq lm b ln mi lr mj lv mu lz mv md mw mh mx my mz na bi translated">IoU评分≥0.5视为良好。</li></ul><p id="8d9f" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated"><strong class="lm ja"> Python实现</strong></p><figure class="mo mp mq mr gt ka"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="mo mp mq mr gt nk nl nm nn aw no bi"><span id="d8da" class="np kn iq nl b gy nq nr l ns nt">box1 = (21, 11, 14, 13)<br/>box2 = (23, 12, 13, 14) <br/>print("iou = " + str(iou(box1, box2)))</span></pre><p id="a0b7" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">输出:iou = 0.417</p><p id="65c9" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated"><strong class="lm ja">IoU指标的其他一些应用。</strong></p><p id="5333" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated"><strong class="lm ja">非最大抑制</strong></p><p id="949f" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">一旦你设置了一个阈值，所有高于这个阈值的边界框都会被过滤掉，但是我们希望图像中的每个物体都有一个单独的边界框。</p><figure class="mo mp mq mr gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nu"><img src="../Images/fcf82f2b2508f18db313e94978825901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldcpQ9RHKMv0taayScK8CQ.png"/></div></div></figure><p id="abf3" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">非最大抑制是如何工作的？</p><p id="0052" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated">给定一组预测的bbox和概率/分数以及阈值，需要提出单个bbox。</p><p id="7760" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated"><em class="ng"> A:概率为</em>的所有预测bbox的集合</p><p id="b136" class="pw-post-body-paragraph lk ll iq lm b ln mi lp lq lr mj lt lu lv mk lx ly lz ml mb mc md mm mf mg mh ij bi translated"><em class="ng"> B:初始空集</em></p><ul class=""><li id="c4ff" class="ms mt iq lm b ln mi lr mj lv mu lz mv md mw mh mx my mz na bi translated">挑选得分最高的一个，推入集合<em class="ng"> B </em></li><li id="9ca3" class="ms mt iq lm b ln nb lr nc lv nd lz ne md nf mh mx my mz na bi translated">把那个从a上放下来。</li><li id="3204" class="ms mt iq lm b ln nb lr nc lv nd lz ne md nf mh mx my mz na bi translated">用选中的一个计算所有其他的IoU，从IoU ≥阈值的A中移除所有预测框。</li><li id="be5b" class="ms mt iq lm b ln nb lr nc lv nd lz ne md nf mh mx my mz na bi translated">重复步骤2和3，直到a中没有bbox。</li></ul></div></div>    
</body>
</html>