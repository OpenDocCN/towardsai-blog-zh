<html>
<head>
<title>How Apple Photos Recognizes People in Private Photos Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apple Photos如何使用机器学习识别私人照片中的人</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-apple-photos-recognizes-people-in-private-photos-using-machine-learning-8c7f4d60f914?source=collection_archive---------3-----------------------#2021-08-03">https://pub.towardsai.net/how-apple-photos-recognizes-people-in-private-photos-using-machine-learning-8c7f4d60f914?source=collection_archive---------3-----------------------#2021-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2ceb" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="61f8" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用多种基于机器学习的算法在你的设备上私下运行，苹果允许你在iOS 15上准确地管理和组织你的图像和视频。</h2></div><blockquote class="kr ks kt"><p id="e8e0" class="ku kv kw kx b ky kz kd la lb lc kg ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">原载于<a class="ae lr" href="https://www.louisbouchard.ai/how-apple-photos-recognizes-people/" rel="noopener ugc nofollow" target="_blank"> louisbouchard.ai </a>，前两天在<a class="ae lr" href="https://www.louisbouchard.ai/how-apple-photos-recognizes-people/" rel="noopener ugc nofollow" target="_blank">我的博客</a>上看到的！</p></blockquote><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/ad8bad63e33628753a53604ca69e5e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k77X-vaM4P0aA9aInnZ5Vg.png"/></div></div></figure><p id="a1cd" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">听听这个故事…</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="1271" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">在最近的一份出版物中，苹果解释了他们如何使用机器学习直接识别iPhones和iPads上私人照片中的人，而无需访问你的图像来训练他们的算法。对于那些使用苹果产品的人，你可以通过照片应用程序中的人进行研究。</p><p id="11c0" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">事实上，使用我将在本文中介绍的多种基于机器学习的算法，在你的设备上私下运行，你可以在iOS 15上准确地管理和组织你的图像和视频。它可以识别不同的人，让你在照片中搜索这个人出现的地方。如果你像我一样有成千上万的照片，你将会有不同的聚类，每个聚类代表不同的人。例如，一个这样的聚类可以是你的朋友John所在的所有照片，这样你可以将其命名为“John ”,然后在你的照片中搜索John的图像，使它们自动出现。它甚至可以识别同一个人频繁出现的照片，即使它不认识这些人或者没有直接受过训练，并使用它来分享记忆，如这里所示的“在一起”功能。这是苹果公司的一个超级酷的内置应用程序，最好的是，它甚至可以在人脸被遮挡或侧身时工作，正如我们将看到的那样。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mj"><img src="../Images/97446cfba3d87d150ce9e031dd9b08a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P96N-6VNhRouhWAv3enBKw.jpeg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">a)左下方显示已识别人员的图片。b)人物相册。c)复合人员查询搜索。d)显示个人特定记忆的记忆窗格。图片来自<a class="ae lr" href="https://machinelearning.apple.com/research/recognizing-people-photos" rel="noopener ugc nofollow" target="_blank">苹果公司，“通过私人设备上的机器学习识别照片中的人”，(2021) </a></figcaption></figure><p id="3ee7" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">就像我说的，这看起来很有效。它完全在你的设备上秘密运行，他们总是在改进算法，但知道它是如何工作的更酷，所以让我们深入了解它！从你自己的照片中识别人物的任务极具挑战性，因为你的照片会有可变性。不同的人，不同的角度，不同的尺度，不同的光线，遮挡，因为你的朋友正在抓一个足球，甚至从其他相机。如果我们严格地以这个人的脸为基础，这将是非常不完整的，因为我们在活动现场拍摄的大多数照片都不是你的朋友在镜头前微笑的完美照片。当您键入John时，您会希望看到John通过接球赢得比赛的这些事件。</p><p id="7218" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">为了解决这个问题，他们首先使用第一种检测算法来定位图像中可见的人的面部和上身。该算法在许多标注了身体和面部位置的人类样本上进行训练。这意味着他们用发送的图像作为输入训练了一个深度神经网络，输出只是带有人的身体或面部的图像的裁剪版本。这是通过向网络提供许多例子来完成的，帮助它显示在哪里用正确识别的部分来集中它的注意力。这样，如果我们在训练过程中给它展示足够多的例子，它可以反复学习自己找到这个身体部位。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mj"><img src="../Images/a8b28aeaf8cca85cd71b09e1683601f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAlebBA7NnjIuMcrjVPksQ.jpeg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">在图像集中识别人物。图片来自<a class="ae lr" href="https://machinelearning.apple.com/research/recognizing-people-photos" rel="noopener ugc nofollow" target="_blank">苹果公司，“通过私人设备上的机器学习识别照片中的人”，(2021) </a></figcaption></figure><p id="7585" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">然后，他们将每个人的身体和面部进行匹配，以获得更多关于这个人的数据，以防两者中只有一个出现在未来的图像中。你可以看到，身体和面部都被发送到一个单独的模型中，该模型对信息进行编码，创建嵌入。这些嵌入仅仅是关于人的面部和身体的最有价值的信息。这里，我们使用另一个网络来编码信息，因为我们希望我们的嵌入对于同一个人是相似的，而对于不同的个人是不同的。这又是用另一个模型完成的，看起来像这样，受移动网络的启发，我在<a class="ae lr" rel="noopener ugc nofollow" target="_blank" href="/state-of-the-art-convolutional-neural-networks-cnns-explained-densenets-451819d32ced">我的卷积神经网络文章</a>中谈到过。这是一个轻量级的卷积神经网络，可以非常高效地运行，是为移动而不是GPU制作的。如果你不熟悉CNN，我强烈邀请你阅读<a class="ae lr" rel="noopener ugc nofollow" target="_blank" href="/how-ai-understand-images-in-simple-terms-957286d3486c">我写的简单解释他们的文章</a>。基本上，它采用裁剪后的图像，并在更小的空间内压缩信息，专注于个人最有趣的细节。这是可能的，因为这种模型是在大量图像上训练出来的，正是为了做到这一点。然后，这些嵌入会被合并并保存在您手机的图库中，除非它们的响应不佳。这些不良反应可能来自不清楚的面部或上身，会被自动过滤掉。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mj"><img src="../Images/3c34052212eef6cc18d19f69e4aedb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JdNAME0COw6S9rTbkW7lNA.jpeg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">人脸嵌入网络架构。图片来自<a class="ae lr" href="https://machinelearning.apple.com/research/recognizing-people-photos" rel="noopener ugc nofollow" target="_blank">苹果，“通过私人设备上的机器学习识别照片中的人”，(2021) </a></figcaption></figure><p id="7f2b" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">对你的所有图片重复这一过程，从这些嵌入中创建聚类。这些集群将是不同的人识别。它将所有相似的嵌入合并成小组，每个小组都是一个特定的个体。这一步，所有约翰被认出的照片都被放入画廊。更酷的是，当你睡觉时手机充电，它会在夜间自动运行，并不断改善你的照片。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mo"><img src="../Images/651a312024c82db28807b2c41a8fa919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-YdgYudEHg51J_SXb9PSA.jpeg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">训练前后人脸嵌入的分布。图片来自<a class="ae lr" href="https://machinelearning.apple.com/research/recognizing-people-photos" rel="noopener ugc nofollow" target="_blank">苹果公司，“通过私人设备上的机器学习识别照片中的人”，(2021) </a></figcaption></figure><p id="2bbb" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">因此，一旦这些集群被创建，你的包含人的新照片被发送到相同的深度网络，以创建图像中每个人的新嵌入。这种新的嵌入将要么加入一个集群，如果他们找到一个匹配，或创建一个新的基于你的手机中的嵌入和新图片的嵌入之间的差异。</p><p id="279d" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">在这里，为了发现是否是同一个人，他们主要关注面部。如果有遮挡或者有侧边，它会使用上半身和我们从面部获得的信息，并考虑照片的时间来衡量衣服是否相同或不同。正如你可能怀疑的那样，上半身并不总是有用的。正如他们所说，“我们已经仔细调整了面部和上身距离阈值的设置，以便在不影响整体准确性的情况下最大限度地利用上身嵌入。”这就是照片如何在你不知情的情况下在应用程序中重组你的朋友！</p><p id="fc33" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">另一个问题是，他们希望为所有苹果用户提供相同的体验，无论摄影对象的肤色、年龄或性别如何。很棒的是，他们不断改进泛化能力，并努力使用尽可能广泛的数据集和数据扩充来消除算法中的这些偏差，从而为训练图像添加变化。如果你有iPhone或iPad，请让我知道你对Photos应用程序中的这个功能有什么看法，以及它的效果如何！</p><p id="7e7b" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">感谢您的阅读！</p><h2 id="e3ec" class="mp mq it bd mr ms mt dn mu mv mw dp mx me my mz na mf nb nc nd mg ne nf ng iz bi translated">观看视频——在YouTube上支持我</h2><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="nh mi l"/></div></figure><p id="fa68" class="pw-post-body-paragraph ku kv it kx b ky kz kd la lb lc kg ld me lf lg lh mf lj lk ll mg ln lo lp lq im bi translated">如果你喜欢我的工作，并想与人工智能保持同步，你绝对应该关注我的其他社交媒体账户(<a class="ae lr" href="https://www.linkedin.com/in/whats-ai/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae lr" href="https://twitter.com/Whats_AI" rel="noopener ugc nofollow" target="_blank"> Twitter </a>)并订阅我的每周人工智能<a class="ae lr" href="http://eepurl.com/huGLT5" rel="noopener ugc nofollow" target="_blank">T5】简讯 </a>！</p><h2 id="8048" class="mp mq it bd mr ms mt dn mu mv mw dp mx me my mz na mf nb nc nd mg ne nf ng iz bi translated">支持我:</h2><ul class=""><li id="337e" class="ni nj it kx b ky nk lb nl me nm mf nn mg no lq np nq nr ns bi translated">支持我的最好方式是成为这个网站<strong class="kx jd"> </strong>的成员，或者如果你喜欢视频格式，在<a class="ae lr" href="https://www.youtube.com/channel/UCUzGQrN-lyyc0BWTYoJM_Sg" rel="noopener ugc nofollow" target="_blank"><strong class="kx jd">YouTube</strong></a><strong class="kx jd"/>上订阅我的频道<strong class="kx jd"> </strong>。</li><li id="5dac" class="ni nj it kx b ky nt lb nu me nv mf nw mg nx lq np nq nr ns bi translated">在经济上支持我在T21的工作</li><li id="3eec" class="ni nj it kx b ky nt lb nu me nv mf nw mg nx lq np nq nr ns bi translated">跟我来这里上<a class="ae lr" href="https://whats-ai.medium.com/" rel="noopener"> <strong class="kx jd">中</strong> </a></li></ul><h2 id="5b53" class="mp mq it bd mr ms mt dn mu mv mw dp mx me my mz na mf nb nc nd mg ne nf ng iz bi translated">参考资料:</h2><ul class=""><li id="14c7" class="ni nj it kx b ky nk lb nl me nm mf nn mg no lq np nq nr ns bi translated">苹果，“通过私人设备上的机器学习识别照片中的人”，(2021)，<a class="ae lr" href="https://machinelearning.apple.com/research/recognizing-people-photos" rel="noopener ugc nofollow" target="_blank">https://Machine Learning . apple . com/research/recognized-People-Photos</a></li></ul><div class="ny nz gp gr oa ob"><a href="https://whats-ai.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd jd gy z fp og fr fs oh fu fw jc bi translated">中等</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">编辑描述</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">whats-ai.medium.com</p></div></div></div></a></div></div></div>    
</body>
</html>