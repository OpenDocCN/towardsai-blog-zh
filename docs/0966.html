<html>
<head>
<title>And Data Asks, “Do I Look Normal to You?”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据会问，“你觉得我看起来正常吗？”</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/normality-tests-for-data-analysis-7c7d775bcfbb?source=collection_archive---------3-----------------------#2020-09-23">https://pub.towardsai.net/normality-tests-for-data-analysis-7c7d775bcfbb?source=collection_archive---------3-----------------------#2020-09-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f907" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="833d" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">数据科学的正态性检验</h2></div><p id="80f8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">作为数据分析师或数据科学家，首先必须评估样本数据，样本数据的来源可以是一手或二手的，但分析数据的性质非常重要。</p><p id="0ef4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们把它放入如下假设中，</p><p id="557c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">零假设</strong>:样本数据平均分布正态</p><p id="2039" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">交替假设:</strong>平均样本数据分布不正态</p><blockquote class="lk ll lm"><p id="40b5" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated">这是什么意思？假设公式</p></blockquote><p id="8d5f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们看看，这里我们将<strong class="kq ja">零假设</strong>作为正态分布的数据，通常它描述了如果数据是正态的，那么<strong class="kq ja">我们将不采取任何行动</strong>，我们将继续构建预测模型。</p><p id="b78b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在<strong class="kq ja">替代假设</strong>的情况下，它描述了如果数据不是正态分布的，那么<strong class="kq ja">我们将不得不在继续构建预测模型之前采取任何行动</strong>,<strong class="kq ja">作为数据科学家的典型行动可以是数据的标准化</strong>一旦采取了该纠正行动，那么只有他或她将继续构建预测模型。</p><blockquote class="lk ll lm"><p id="72b0" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated">检验数据正态性的策略</p></blockquote><p id="01ff" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在为了检验样本数据是否正常，我们将首先决定如下策略:</p><h1 id="a9e2" class="lr ls iq bd lt lu lv lw lx ly lz ma mb kf mc kg md ki me kj mf kl mg km mh mi bi translated">数据可视化方法:</h1><p id="9f9a" class="pw-post-body-paragraph ko kp iq kq b kr mj ka kt ku mk kd kw kx ml kz la lb mm ld le lf mn lh li lj ij bi translated">这将使数据的性质可视化，但不能量化。</p><ol class=""><li id="be49" class="mo mp iq kq b kr ks ku kv kx mq lb mr lf ms lj mt mu mv mw bi translated"><strong class="kq ja">绘制直方图</strong>，图形显示范围内的频率分布</li><li id="8512" class="mo mp iq kq b kr mx ku my kx mz lb na lf nb lj mt mu mv mw bi translated"><strong class="kq ja">绘制Q-Q图</strong>，一种比较概率分布的图形方法。</li></ol><h1 id="37f8" class="lr ls iq bd lt lu lv lw lx ly lz ma mb kf mc kg md ki me kj mf kl mg km mh mi bi translated">统计测试/方法:</h1><ol class=""><li id="d4fa" class="mo mp iq kq b kr mj ku mk kx nc lb nd lf ne lj mt mu mv mw bi translated">根据<strong class="kq ja">达戈斯蒂诺的K正态性检验</strong>计算p值</li><li id="8093" class="mo mp iq kq b kr mx ku my kx mz lb na lf nb lj mt mu mv mw bi translated">基于<strong class="kq ja">夏皮罗-维尔克(S-W)正态性检验</strong>计算p值</li></ol><blockquote class="lk ll lm"><p id="6dbe" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated"><strong class="kq ja">我们的假设</strong></p></blockquote><p id="5f26" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">请注意，我们已经考虑了以下值，</p><p id="ccb5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">置信度为95%，</strong>这意味着我们有95%的信心，我们的决定不会出错。<br/> <strong class="kq ja">显著性水平为5%，</strong>这意味着我们的决策有5%的几率会出错。</p><p id="66d4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">行业标准/规范认为置信度为95%，<br/>这意味着5%的误差是允许的。</p><blockquote class="lk ll lm"><p id="6f51" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated">进行实验以检验假设</p></blockquote><h1 id="9860" class="lr ls iq bd lt lu lv lw lx ly lz ma mb kf mc kg md ki me kj mf kl mg km mh mi bi translated">策略1: <strong class="ak">绘制直方图</strong></h1><p id="0056" class="pw-post-body-paragraph ko kp iq kq b kr mj ka kt ku mk kd kw kx ml kz la lb mm ld le lf mn lh li lj ij bi translated">分析数据分布的最常见的可视化工具是直方图。其中数据被分成预定义的一组仓。在图的Y轴上，我们总是在一个条柱内有值的频率或出现。<br/>这些容器在图的X轴上按升序排列。</p><p id="0fab" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了检查样本数据分布的正态性，可以基于直方图主观推断样本数据是否遵循正态分布(换句话说，<strong class="kq ja">数据分布是否遵循钟形曲线</strong>)。</p><p id="c434" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们使用R编程环境[R-studio]来实现</p><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/f2850fa63478a25b9520d7f0b3182738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*uEo7Dv4YrSxUkKLpt981_g.png"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">样本数据分布</figcaption></figure><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nr"><img src="../Images/bfaef74f334da27766d0d0bcc52280e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bCO0TTyA1ARWxOW9gdzUA.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">样本数据分布直方图</figcaption></figure><p id="6a80" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">根据上面的直方图，可以推断出<strong class="kq ja">数据正态分布在</strong>值的范围内，但是如果没有统计方法的帮助，一个<strong class="kq ja">不能定量地证明</strong>。</p><h1 id="e5db" class="lr ls iq bd lt lu lv lw lx ly lz ma mb kf mc kg md ki me kj mf kl mg km mh mi bi translated">策略2: <strong class="ak">绘制Q-Q图</strong></h1><p id="1d2b" class="pw-post-body-paragraph ko kp iq kq b kr mj ka kt ku mk kd kw kx ml kz la lb mm ld le lf mn lh li lj ij bi translated">Q-Q图是一个典型的散点图，它允许我们比较各个数据分布的分位数(x对y)。我们将使用Q-Q图的变体，即<strong class="kq ja">正态Q-Q图</strong>，它将标准正态分布(x轴)的分位数与样本数据分布(y轴)进行比较。如果一个图给出了一条相当直的线，那么我们可以从主观上确认样本数据来自正态分布总体，即它的正态分布数据。</p><p id="2285" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我们使用R编程环境[R-studio]来实现</p><figure class="ng nh ni nj gt nk gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nr"><img src="../Images/3cd9828f7f6c6d6d91d09c3c2d1cc14f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hOhi4aafvVjyZPpY6W97Wg.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">正常Q-Q图</figcaption></figure><p id="03a5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在上面的q-q图中，我们可以很容易地发现绘制的点大约分散在直线<strong class="kq ja">上，这证实了数据很大程度上遵循正态分布</strong>，但是我们的主张同样无法从数量上得到证明。</p><h1 id="3515" class="lr ls iq bd lt lu lv lw lx ly lz ma mb kf mc kg md ki me kj mf kl mg km mh mi bi translated">策略3: <strong class="ak">达戈斯蒂诺的K正态性检验</strong></h1><p id="bd5b" class="pw-post-body-paragraph ko kp iq kq b kr mj ka kt ku mk kd kw kx ml kz la lb mm ld le lf mn lh li lj ij bi translated">这种统计检验允许我们在数据分布中找到一个显著的偏态分量。<strong class="kq ja">偏斜度是数据分布中不对称度的度量</strong>。</p><p id="34fa" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">该测试主要给出两个值，</p><blockquote class="lk ll lm"><p id="c3b1" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated"><strong class="kq ja">统计</strong> : s +k，其中<code class="fe nw nx ny nz b">s</code>为<code class="fe nw nx ny nz b"><a class="ae oa" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.skewtest.html#scipy.stats.skewtest" rel="noopener ugc nofollow" target="_blank"><strong class="kq ja">skewtest</strong></a></code>返回的z值，<code class="fe nw nx ny nz b">k</code>为<code class="fe nw nx ny nz b"><a class="ae oa" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.kurtosistest.html#scipy.stats.kurtosistest" rel="noopener ugc nofollow" target="_blank"><strong class="kq ja">kurtosistest</strong></a></code>返回的z值。</p><p id="4cc5" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated"><strong class="kq ja"> p值</strong>:介于0和1之间，是给定统计模型在零假设为真时的计算概率。</p><p id="c0c1" class="ko kp ln kq b kr ks ka kt ku kv kd kw lo ky kz la lp lc ld le lq lg lh li lj ij bi translated">重要考虑</p></blockquote><p id="60a8" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">人们应该注意以下接受/拒绝零假设的规则，</p><p id="9577" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">如果p高，NULL将飞</strong>(接受零假设/数据未能拒绝零假设)</p><p id="b628" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">如果p较低，NULL将变为</strong>(拒绝零假设/接受替代假设)</p><p id="f563" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这里的<strong class="kq ja"> p </strong>是指统计检验得到的<strong class="kq ja"> p值</strong>。</p><pre class="ng nh ni nj gt ob nz oc od aw oe bi"><span id="721f" class="of ls iq nz b gy og oh l oi oj">import numpy as np</span><span id="605a" class="of ls iq nz b gy ok oh l oi oj">import scipy.stats as sc</span><span id="19a7" class="of ls iq nz b gy ok oh l oi oj">#generate random seed</span><span id="9d29" class="of ls iq nz b gy ok oh l oi oj">np.random.seed(1)</span><span id="64c6" class="of ls iq nz b gy ok oh l oi oj">#generate random set of numbers</span><span id="c90e" class="of ls iq nz b gy ok oh l oi oj">value=15+7*np.random.randn(50)</span><span id="c7a8" class="of ls iq nz b gy ok oh l oi oj">print("Size of univariate observations-:",len(value))</span><span id="11b1" class="of ls iq nz b gy ok oh l oi oj">statval,pval=<strong class="nz ja">sc.normaltest(value)</strong></span><span id="e3c3" class="of ls iq nz b gy ok oh l oi oj">print("Statistics: ",statval)</span><span id="1905" class="of ls iq nz b gy ok oh l oi oj">print("P-value: ",pval)</span><span id="2e5a" class="of ls iq nz b gy ok oh l oi oj">alpha=0.05</span><span id="e847" class="of ls iq nz b gy ok oh l oi oj">if(pval&gt;alpha):</span><span id="92a2" class="of ls iq nz b gy ok oh l oi oj">   print("Null Hypothesis: Data Distribution is Normal, Wins!!!")</span><span id="b2f7" class="of ls iq nz b gy ok oh l oi oj">else:</span><span id="167c" class="of ls iq nz b gy ok oh l oi oj">   print("Alt Hypothesis: Data Distribution is not Normal, Wins!!!")</span></pre><p id="074f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">上述代码片段的输出是:</p><p id="54c4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">单变量观察值大小-: 50 <br/>统计量:0.44153052875099047 <br/> P值:0.801904893845168 <br/>零假设:数据分布正态，胜！！！</strong></p><h1 id="e1a9" class="lr ls iq bd lt lu lv lw lx ly lz ma mb kf mc kg md ki me kj mf kl mg km mh mi bi translated">策略4:夏皮罗-维尔克正态性检验</h1><p id="e008" class="pw-post-body-paragraph ko kp iq kq b kr mj ka kt ku mk kd kw kx ml kz la lb mm ld le lf mn lh li lj ij bi translated">该测试验证一组数据值，并试图确定数据集是否具有正态分布。</p><p id="073e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在实践中，夏皮罗-维尔克检验被认为是一种可靠的正态性检验，尽管有一些建议认为该检验可能适用于较小的数据样本，例如数千个或更少的观察值。</p><p id="6978" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><a class="ae oa" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.shapiro.html" rel="noopener ugc nofollow" target="_blank"> Shapiro() SciPy </a>函数将计算给定数据集的夏皮罗-维尔克。该函数返回由测试计算的W统计量和p值。</p><p id="f30a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">下面列出了对数据集执行夏皮罗-维尔克测试的完整示例。</p><pre class="ng nh ni nj gt ob nz oc od aw oe bi"><span id="592c" class="of ls iq nz b gy og oh l oi oj">import numpy as np</span><span id="c240" class="of ls iq nz b gy ok oh l oi oj">import scipy.stats as sc</span><span id="9a8e" class="of ls iq nz b gy ok oh l oi oj">#generate random seed</span><span id="231e" class="of ls iq nz b gy ok oh l oi oj">np.random.seed(1)</span><span id="89ea" class="of ls iq nz b gy ok oh l oi oj">#generate random set of numbers</span><span id="0203" class="of ls iq nz b gy ok oh l oi oj">value=15+7*np.random.randn(50)</span><span id="76c3" class="of ls iq nz b gy ok oh l oi oj">print("Size of univariate observations-:",len(value))</span><span id="5420" class="of ls iq nz b gy ok oh l oi oj">statval,pval=<strong class="nz ja">sc.shapiro(value)</strong></span><span id="1b44" class="of ls iq nz b gy ok oh l oi oj">print("Statistics: ",statval)</span><span id="dfd1" class="of ls iq nz b gy ok oh l oi oj">print("P-value: ",pval)</span><span id="e468" class="of ls iq nz b gy ok oh l oi oj">alpha=0.05</span><span id="0a39" class="of ls iq nz b gy ok oh l oi oj">if(pval&gt;alpha):<br/>   print("Null Hypothesis: Data Distribution is Normal, Wins!!!")</span><span id="a6bc" class="of ls iq nz b gy ok oh l oi oj">else:<br/>   print("Alt Hypothesis: Data Distribution is not Normal, Wins!!!")</span></pre><p id="1db0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">上述代码片段的输出是:</p><p id="a296" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">单变量观察值大小-: 50 <br/>统计量:0.9704716205596924 <br/> P值:0.24187302589416504 <br/>零假设:数据分布正态，胜！！！</strong></p></div></div>    
</body>
</html>