<html>
<head>
<title>Soccer and Data Science: Decision Tree explained by Ibra and Muriqi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">足球和数据科学:由Ibra和Muriqi解释的决策树</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/soccer-and-data-science-decision-tree-explained-by-ibra-and-muriqi-c4d498109c41?source=collection_archive---------5-----------------------#2022-12-06">https://pub.towardsai.net/soccer-and-data-science-decision-tree-explained-by-ibra-and-muriqi-c4d498109c41?source=collection_archive---------5-----------------------#2022-12-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="cd24" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">是时候开始新的冒险了:作为意甲数据科学家的第一天刚刚开始！</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/187034d39fc4bd62c72acb3539e7ccdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zf7o3aw7EIt_CjESDFkduQ.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">足球场上基于树的算法</figcaption></figure><p id="9e71" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">当人群在外面疯狂的时候，在办公室里，我们必须开始工作…嗯…让我们做一些重要的事情…</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="508f" class="mb mc iu lx b be md me l mf mg">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>from sklearn import datasets, svm<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.inspection import DecisionBoundaryDisplay<br/>from sklearn.metrics import accuracy_score</span></pre><p id="c614" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">今天对我们来说是糟糕的一天:美国老板刚刚盛况空前地到来，宣布他们将在3年内赢得联赛冠军。</p><p id="fadf" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated"><strong class="lb iv">如何？</strong> == &gt;他们不知道……但他们需要创造期望。</p><p id="1790" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">节目结束后，他们来找我们，他们新雇佣的数据科学家…！他们带着装在公文包里的4000万美元的嫁妆，带着实现飞跃所需的清晰而极其详细的想法进行投资。</p><blockquote class="mh mi mj"><p id="68eb" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">美国人:&lt;&lt;&lt; <em class="iu">我们买个前锋吧！&gt;T32&gt;T5】</em></p><p id="2bfd" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated"><em class="iu">DS</em>:“…什么样的前锋？”</p><p id="a485" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">美国人:&lt;&lt;&lt; <em class="iu">我们买前锋吧！&gt;T35&gt;T9】</em></p><p id="eabb" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">DS :“嗯……我们明白了，但是……一个中锋？边锋？？快？？？强大？？？？你知道吗……”</p><p id="a3c1" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">美国人:“&lt;&lt;&lt;<em class="iu">我们什么都知道！&gt; &gt; &gt;一群专家告诉我们一切只需71百万美元。他们给了我们一份数千名球员的大名单，关于射门、传球、技术、盯人… &lt; &lt; &lt;的数据，我们什么都知道！&gt; &gt; &gt; </em></p><p id="2ea1" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated"><em class="iu"> DS </em> : "…一份我们想象中的骗子名单…"</p><p id="5679" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">美国人:&lt;&lt;&lt; … <em class="iu">我们买前锋吧！&gt; &gt; &gt; </em></p><p id="a993" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated"><em class="iu"> DS </em>:“好的，知道了！！！有了7100万英镑，我们知道欧洲现有的每个球员的生活和对T21的看法，但我们不知道哪些是前锋……”</p></blockquote><p id="4962" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">…(尴尬的沉默)…</p><blockquote class="mh mi mj"><p id="43f5" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">美国人:“…你告诉我们…今晚之前…否则你们都会被解雇，明白吗？！拜托，这没什么大不了的……”</p></blockquote><p id="711d" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">(呼吸)</p><p id="b760" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">“<em class="lv">我们必须有外交手腕……</em>”——我告诉住在我体内的小海盗，他是我的向导——“<em class="lv">……小心选择你的下一句话，维达。他们可能是你在这家公司的最后一个人了……</em>”</p><p id="c7d5" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">(呼吸)</p><h1 id="f79a" class="mn mc iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">“……你把被征服的国王的王冠和头颅带到我的城市的台阶上！你侮辱了我的科学。你用奴役和解雇来威胁我的人民！哦，美国人，我用词很谨慎。也许你也应该这样做。”</h1><blockquote class="mh mi mj"><p id="abf5" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated"><em class="iu">美国人:“</em>这是亵渎神明！这太疯狂了！”</p></blockquote><h1 id="ff0b" class="mn mc iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">“癫狂？！…"</h1><p id="63f5" class="pw-post-body-paragraph kz la iu lb b lc ne jv le lf nf jy lh li ng lk ll lm nh lo lp lq ni ls lt lu in bi translated">…我的精神向导为了戏剧效果停顿了一下，然后用科索沃语、意大利语和西班牙语混合发出一声令人毛骨悚然的尖叫:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nj"><img src="../Images/8b0c090a34786130b36f9685fb407324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CWSnEhWnCVxhNtJU.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae nk" href="https://www.goal.com/it/notizie/maiorca-muriqi-goal-decisivo-atletico-madrid/blt181fd44f6e23c1e0" rel="noopener ugc nofollow" target="_blank">https://www . goal . com/it/not izie/maior ca-muri qi-goal-decisivo-Atletico-Madrid/BLT 181 FD 44 f 6 e 23 C1 e 0</a></figcaption></figure><p id="f9de" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">(呼吸…回到现实。)</p><blockquote class="mh mi mj"><p id="1ee6" class="kz la lv lb b lc ld jv le lf lg jy lh mk lj lk ll ml ln lo lp mm lr ls lt lu in bi translated">美国人:“……否则你们都会被解雇，明白吗？！…"</p></blockquote><p id="a969" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">白日梦结束了，当Vedat在我脑海中尖叫，美国人满意地离开时，我的大脑开始想起几天前我在网上找到的一个数据集，它可能会帮助我们。时间不多了，我们直接从那里开始读吧:</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="f9ae" class="mb mc iu lx b be md me l mf mg">link = "https://raw.githubusercontent.com/ianni-phd/Datasets/main/2022-12-05_soccer-players.csv"<br/>df = pd.read_csv(link, sep=';', decimal=',')<br/>df.head(11)</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nl"><img src="../Images/27937d18b11d057b04690fad8c41e60c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dPsQD_iNR7ZVE1kENjCd_w.png"/></div></div></figure><p id="0f52" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">…没有那么多数据，但它们是<em class="lv">完整的</em>(而且比7100万便宜很多):对于每个球员，我都知道特征，知道他是后卫(“D”)、中场(“C”)还是……是的，也是前锋(“A”)！！！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nm"><img src="../Images/be7706b013b5f8b58a35ed98cd3db487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ji9t_oDTkl2vrD1tsxJgVA.png"/></div></div></figure><p id="4a19" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以分析数据并设计一个基于阈值的系统，但是没有时间了！只有一条出路:</p><ul class=""><li id="3d10" class="nn no iu lb b lc ld lf lg li np lm nq lq nr lu ns nt nu nv bi translated">[ <strong class="lb iv"> FIT </strong>根据我们掌握的少量数据训练模型；</li><li id="3032" class="nn no iu lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated">[ <strong class="lb iv">预测</strong> ]要求模型预测成千上万名欧洲球员中每一个人的角色！</li></ul><p id="a88a" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">它可以工作。我们要选择哪些特征？所有人？</p><h1 id="0d05" class="mn mc iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">“显然……！每个人都知道同情是罢工的一个非常明显的特点……”</h1><p id="10f8" class="pw-post-body-paragraph kz la iu lb b lc ne jv le lf nf jy lh li ng lk ll lm nh lo lp lq ni ls lt lu in bi translated">…等等，韦达！现在让我们用两个试试！<strong class="lb iv">拍摄</strong>和<strong class="lb iv">标记</strong>似乎是对分离角色有意义的两个特征。</p><p id="918d" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以尽量简化模型，将类的数量从3个减少到<strong class="lb iv"><em class="lv">n _ classes = 2</em></strong>:<em class="lv">Strickers</em>vs<em class="lv">其余的世界</em>。让我们使用方法<strong class="lb iv"> pd.factorize() </strong>来获取一个分类变量，并将其转换为一列整数(同样的方法<em class="lv">返回</em>按正确顺序排列的类别……非常有用！):</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="b570" class="mb mc iu lx b be md me l mf mg">dict_2_classes = {"D":"other", "C":"other", "A":"strickers"}<br/>df["Classe"] = df["Classe"].apply(lambda x: dict_2_classes[x])<br/>classes_labels = list(pd.factorize(df["Classe"])[1])<br/>df["Classe"] = pd.factorize(df["Classe"])[0]<br/>n_classes = len(classes_labels)</span></pre><p id="da06" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">好了，现在我们可以记住我们之前已经确定的特征对(<em class="lv">对</em></p><ul class=""><li id="e6bf" class="nn no iu lb b lc ld lf lg li np lm nq lq nr lu ns nt nu nv bi translated"><strong class="lb iv"> df </strong>是一个数据帧…模型无法消化！</li><li id="87c6" class="nn no iu lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated">df<strong class="lb iv">【pair】</strong>仍然是一个数据帧…模型无法消化！</li><li id="fbe8" class="nn no iu lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated">df【对】<strong class="lb iv">。values </strong>终于是np.array了！！</li></ul><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="4b84" class="mb mc iu lx b be md me l mf mg">pair = ["Shoot","Marking"]<br/>X_2_cols = df[pair].values<br/><br/>print(X_2_cols.shape)<br/>X_2_cols</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/504d7e7dee80a1a2edb7d4902705be74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DIlOkoT3RcOa8V1r.png"/></div></div></figure><p id="e4a9" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">现在呢？定义谁是前锋和谁不是前锋的两个特征…简单来说，我们可以说:</p><blockquote class="oc"><p id="a48d" class="od oe iu bd of og oh oi oj ok ol lu dk translated"><if you="" have="" a="" good="" shot="" and="" are="" very="" bad="" at="" marking="" maybe="" stricker=""/></p></blockquote><p id="69da" class="pw-post-body-paragraph kz la iu lb b lc om jv le lf on jy lh li oo lk ll lm op lo lp lq oq ls lt lu in bi translated">另外，一个球员不可能投篮和盯人都很差…</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/135f56b0eebf4091f7a8867babbf1028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lwQsKSiAZFTcGHlG.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae nk" href="https://www.asroma.com/it/team/players-and-staff/gianluca-mancini#tab_player-stats=distribution&amp;tab_player=profile" rel="noopener ugc nofollow" target="_blank">https://www.asroma.com/it/team/players-and-staff</a></figcaption></figure><p id="0bb3" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">…嗯，也许我们应该忘记手动规则:让我们结束这一切，让我们让模型负责…我们亲爱的-明智的-老树！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj os"><img src="../Images/c9a70d4c6ab3e0560aebd18cb29592f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yxu2hyeSdNIAa4ynZQugqg.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">通过人工智能生成的图像</figcaption></figure><p id="0042" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们为每个玩家提供射门和盯人(<strong class="lb iv"> X_2_cols </strong>)，我们说这个玩家是不是前锋(<strong class="lb iv"> y </strong> )…然后它会做剩下的事情。也许我们还可以设置一些参数…不，请不要做那些表情，我知道:“我们在赶时间”！</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="09a2" class="mb mc iu lx b be md me l mf mg"># definition of the model (without defining parameters...!!!)<br/>clf = DecisionTreeClassifier()<br/># training of the model<br/>clf.fit(X_2_cols, y)</span></pre><p id="0fec" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">只需要一次发作，我们就掌握了权力。不管他们会给我们多少球员，从射门和盯防我们的树会告诉我们他是一个前锋还是我们必须让他马上消失。你知道，我们的神谕是绝对可靠的！…不是吗？</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="7c4a" class="mb mc iu lx b be md me l mf mg"># prediction on the training data<br/>y_prev = clf.predict(X_2_cols)<br/># accuracy on the training data<br/>accuracy = accuracy_score(y_prev, y)<br/>accuracy</span></pre><pre class="ot lw lx ou ov aw ow bi"><span id="e245" class="ox mc iu lx b gz oy oz l pa mg">100,0%</span></pre><p id="aa5b" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">看那蓝色100%多好啊…让我翻译一下那个小数字:我们的树是完美的。故事结束。文章写完了，我们是最棒的。</p><p id="474b" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">撒谎。我们的树是不会出错的，但是在玩家身上，它已经被研究过了！嗯…我们是忠实的信徒，所以我们相信在未知的玩家身上也会有完美的表现。我们试试吧！我们选一个中场，等他们的回应！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pb"><img src="../Images/d61ff29b1cacdd7becd3bcde663cf4bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AC3-dK-UiIjMfG5RCwBQWw.png"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae nk" href="https://www.footyrenders.com/serie-a/juventus/adrien-rabiot-17/" rel="noopener ugc nofollow" target="_blank">https://www . footy renders . com/serie-a/尤文图斯/阿德里安-拉比奥特-17/ </a></figcaption></figure><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="2fde" class="mb mc iu lx b be md me l mf mg"># Forecast Rabiot<br/>print("Rabiot:")<br/>rabiot_shoot_marking = np.array((64,64)).reshape(1,2)<br/>y_prev_rabiot = clf.predict(rabiot_shoot_marking)<br/>print("Features: ", rabiot_shoot_marking)<br/>print("Model prediction: ", y_prev_rabiot)</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/c395a26ec2be04fed92f233441614133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ybaamzs3SGkVwRF7.png"/></div></div></figure><p id="dc58" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">坏消息，一个中前卫是我们树的贴纸(！！！)…嗯，我们得开始收拾行李了:明天早上，我们得修改我们的简历，然后到处发布。</p><p id="e543" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">…是的，但只是为了给这一天的结束一个感觉…模型到底是如何创建边界的？？！我敢肯定，有一种方法揭示了边界曲线(<strong class="lb iv">决策边界显示</strong>)，幸运的是，我们在二维。</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="8258" class="mb mc iu lx b be md me l mf mg"># creating a palette of colors<br/>import matplotlib.colors<br/>cmap_yg_gr_lb = matplotlib.colors.ListedColormap(["yellow", "green", "lightblue"])<br/>cmap_yg_gr_lb</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/48fcb6064c67717726f54c9d3193c342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ss9IS-S1YBNBJ5rH.png"/></div></div></figure><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="e7e7" class="mb mc iu lx b be md me l mf mg">DecisionBoundaryDisplay.from_estimator(<br/>    clf,<br/>    X_2_cols,<br/>    cmap=cmap_yg_gr_lb, <br/>    response_method="predict",<br/>    xlabel=pair[0],<br/>    ylabel=pair[1],<br/>)</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pc"><img src="../Images/d9fdf141e802c47e0b8f48a019d38e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p53KMzVB4QRWlIWdRau0aQ.png"/></div></div></figure><p id="b975" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">显然，这是一个不容易解释的方法来区分蓝色和黄色…尤其是考虑到大多数贴纸都在右下角区域。但是…为什么树要制定这些奇怪的规则呢？它是否过于关注训练数据？！他是不是学习太深入了？！？……有人<em class="lv">把它拿走了吗？！…世卫组织呢？！？！？</em></p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="c27d" class="mb mc iu lx b be md me l mf mg">DecisionBoundaryDisplay.from_estimator(<br/>    clf,<br/>    X_2_cols,<br/>    cmap=cmap_yg_gr_lb, <br/>    response_method="predict",<br/>)<br/><br/># Plot the training points<br/>for i, color in zip(range(n_classes), plot_colors):<br/>    print(i)<br/>    print(color)<br/>    idx = np.where(y == i)<br/>    plt.title("Accuracy on training: "+str(accuracy))<br/>    plt.scatter(<br/>        X_2_cols[idx, 0],<br/>        X_2_cols[idx, 1],<br/>        c=color,<br/>        label=classes_labels[i],<br/>    )<br/>plt.legend()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nl"><img src="../Images/13d04b47178877798a8c1b08e9927b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nenrvuVtLsIrf86__j5yhw.png"/></div></div></figure><p id="638f" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">什么？？？我的海盗！！！！！</p><p id="6561" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">尽管如此，韦达特并不是唯一对左边的蓝色区域感到内疚的人:菲利普·安德森和他在一起，他的投篮能力比他的同事低…</p><p id="f548" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">是的但是..费利佩是个stricker吗？！数据通常代表现实的简化。如果你想一想，足球场上的实际角色可能不止11个，我们将他们全部归类为“贴纸”和“其他”。菲利普·安德森在前锋和中场之间扮演着一个角色，并被归类为stricker，这一事实代表了大多数真正问题中的生理“噪音”。</p><p id="9659" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这种“噪音”和我们的海盗的异常特征迫使模型在左侧创建蓝色区域。然而，它们并不是唯一的异常现象。</p><p id="0851" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在他的同事之上，其实还有穆里尔，他的盯人能力高于其他前锋。然后是Ibra，那个…那个… Ibra只是做他想做的，算法ssssshhhhhh..！</p><p id="a08f" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">很明显，数据有其独特性，算法过于依赖于此，创建了看起来有点不合理的<em class="lv">规则</em>。</p><p id="8a9a" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在Ibra的批准下，我们必须努力帮助算法，试图在非常特殊的情况下避免它陷入困境。不管怎样，我们必须限制它的学习能力，以防止它…夸大其词！所以我们强加了</p><h2 id="92b0" class="ox mc iu bd mo pd pe dn ms pf pg dp mw li ph pi my lm pj pk na lq pl pm nc pn bi translated">规则A:只有当子组包含至少两个玩家时，模型才能创建子组(叶子)。</h2><p id="dd27" class="pw-post-body-paragraph kz la iu lb b lc ne jv le lf nf jy lh li ng lk ll lm nh lo lp lq ni ls lt lu in bi translated">我们可以通过参数<strong class="lb iv"> min_samples_leaf </strong>轻松做到这一点。</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="eebe" class="mb mc iu lx b be md me l mf mg">clf = DecisionTreeClassifier(min_samples_leaf=2)<br/>clf.fit(X_2_cols, y)</span></pre><p id="0ea3" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">模型在已知数据(训练集)上的表现不如以前<em class="lv">完美</em></p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="c15a" class="mb mc iu lx b be md me l mf mg">y_prev = clf.predict(X_2_cols)<br/>accuracy = accuracy_score(y_prev, y)<br/>accuracy</span></pre><pre class="ot lw lx ou ov aw ow bi"><span id="4704" class="ox mc iu lx b gz oy oz l pa mg">95,7%</span></pre><p id="9937" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">…但是看一下模型边界，似乎“它做得更好”。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/aaea972231b1d18c694a3b4647a2ba02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*buN4koqjrIgxHFtf.png"/></div></div></figure><p id="d38e" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在挑战了Ibra之后，我们开始觉得自己无所不能:我们朝着更有效的泛化能力又迈进了一步，我们利用另一个参数来避免模型学习过深。所以我们强加了</p><h2 id="abe8" class="ox mc iu bd mo pd pe dn ms pf pg dp mw li ph pi my lm pj pk na lq pl pm nc pn bi translated">规则B:模型在深度上不能有太多的“层次”。</h2><p id="a3ae" class="pw-post-body-paragraph kz la iu lb b lc ne jv le lf nf jy lh li ng lk ll lm nh lo lp lq ni ls lt lu in bi translated">所以我们可以用<strong class="lb iv"> max_depth </strong>来限制模型的“学习能力”。</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="08a8" class="mb mc iu lx b be md me l mf mg">clf = DecisionTreeClassifier( min_samples_leaf = 2, <br/>                              max_depth = 4<br/>)<br/>clf.fit(X_2_cols, y)</span></pre><p id="76e3" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">该模型在已知数据上恶化得更多，达到低于95%的准确度:</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="3ea9" class="mb mc iu lx b be md me l mf mg">y_prev = clf.predict(X_2_cols)<br/>accuracy = accuracy_score(y_prev, y)<br/>accuracy</span></pre><pre class="ot lw lx ou ov aw ow bi"><span id="bb3e" class="ox mc iu lx b gz oy oz l pa mg">94,2%</span></pre><p id="20a3" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">另一方面，我们对下一个玩家持乐观态度，因为<em class="lv">分离模式</em>似乎比以前更容易解释:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj po"><img src="../Images/0086d7b8c1abd454fdbb4d92ec488983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QQDGqtHCGGU98wvWt2fQ1Q.png"/></div></div></figure><p id="ad7d" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">好吧，我们只使用了两个功能…如果我们也尝试所有其他功能呢！？！！</p><pre class="kk kl km kn gu lw lx ly bn lz ma bi"><span id="e3aa" class="mb mc iu lx b be md me l mf mg">import numpy as np<br/>import matplotlib.pyplot as plt<br/>from sklearn.datasets import load_iris<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.inspection import DecisionBoundaryDisplay<br/># reading the datasdet<br/>df = pd.read_csv("https://raw.githubusercontent.com/ianni-phd/Datasets/main/2022-12-05_soccer-players.csv", sep=';', decimal=',')<br/># defining the classes<br/>dict_2_classes = {"D":"other", "C":"other", "A":"strickers"}<br/>df["Class"] = df["Class"].apply(lambda x: dict_2_classes[x])<br/>classes_labels = list(pd.factorize(df["Class"])[1])<br/>df["Class"] = pd.factorize(df["Class"])[0]<br/>n_classes = len(classes_labels)<br/>features = ["Pass","Marking","Shoot","Control"]<br/>target = ["Class"]<br/>X = df[features].values<br/>y = df["Class"].values<br/># Parameters<br/>plot_colors = ["ygb" if n_classes==3 else "yb"][0]<br/># Define the size and aspect of the final plot<br/>fig, ax = plt.subplots(2, 3, figsize=(12, 8))<br/>fig.tight_layout(h_pad=0.5, w_pad=0.5, pad=2.5)<br/># deciding the features to compare<br/>pairs_to_focus = [["Shoot","Pass"], ["Shoot","Control"], <br/>                  ["Shoot","Sympathy"], ["Control","Marking"],<br/>                  ["Shoot","Marking"], ["Marking","Pass"]]<br/>for pairidx, pair in enumerate(pairs_to_focus):<br/>    # We only take the two corresponding features<br/>    X_2_cols = df[pair].values<br/>    # Train and result on train (accuracy)<br/>    clf = DecisionTreeClassifier(max_depth=4).fit(X_2_cols, y)<br/>    y_prev = clf.predict(X_2_cols)<br/>    accuracy = np.round(accuracy_score(y_prev, y),3)<br/>    # Plot the decision boundary<br/>    ax = plt.subplot(2, 3, pairidx + 1)<br/>    plt.tight_layout(h_pad=1.5, w_pad=1.5, pad=2.5)<br/>    DecisionBoundaryDisplay.from_estimator(<br/>        clf,<br/>        X_2_cols,<br/>        cmap=cmap_yg_gr_lb,<br/>        response_method="predict",<br/>        ax=ax,<br/>        xlabel=pair[0],<br/>        ylabel=pair[1],<br/>    )<br/>    # Plot the training points<br/>    for i, color in zip(range(n_classes), plot_colors):<br/>        idx = np.where(y == i)<br/>        plt.title("Accuracy: "+str(accuracy))<br/>        plt.scatter(<br/>            X_2_cols[idx, 0],<br/>            X_2_cols[idx, 1],<br/>            c=color,<br/>            label=classes_labels[i],<br/>            edgecolor="black",<br/>            s=15,<br/>        )<br/>plt.suptitle("Decision surface of decision trees trained on pairs of features on the Players dataset")<br/>plt.legend(loc="lower right", borderpad=0, handletextpad=0)<br/>_ = plt.axis("tight")</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pp"><img src="../Images/1dcefafa7266f081c17777149aefafcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2yb4GxCRitMxFKLH.png"/></div></div></figure><p id="4da2" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以注意到，看到精度，<strong class="lb iv">拍摄</strong>和<strong class="lb iv">控制</strong>不足以区分贴纸……为什么？因为有很多射门和控球都很出色的中场球员！嗯，我们遗漏了一些东西…比如说<strong class="lb iv">通道，</strong>通道，那将会是非常完美的区分方式。</p><p id="bd1d" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们最终会非常惊讶于这样一个事实:同情并没有很大的帮助…！:)</p><p id="5a12" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">尽管出于可视化的原因，我们需要使用两个特征，考虑3个或更多特征将使算法对于我们的分类目的更有效。如果我们要保住我们的工作，直到下一集，我们将看到如何做到这一点…！！！</p></div></div>    
</body>
</html>