<html>
<head>
<title>Clustering using Social Graph Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用社会图网络的聚类</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/extracting-communities-from-social-graph-network-d9213ed9d25a?source=collection_archive---------0-----------------------#2022-01-29">https://pub.towardsai.net/extracting-communities-from-social-graph-network-d9213ed9d25a?source=collection_archive---------0-----------------------#2022-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b61e" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><p id="b938" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">当实体(节点——如人或组织)之间存在一组连接以及它们之间的交互(边——如友谊、契约)时，可以形成社交图网络。在当今世界，有许多社交网络存在——其中一个著名的是脸书的朋友网络。然而，只要我们可以在各种实体之间建立联系，我们就可以将我们周围的许多事情表示为一个社会网络或一个图表</p><p id="8edd" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">社交图网络的好处</strong></p><p id="f17c" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">可以从这些图中为每个节点生成诸如度中心性、特征向量中心性的影响度量。图中节点与其他节点共享的连接或边也可以使用诸如Node2Vec的方法表示为向量，并且这些向量可以用作聚类的特征或者甚至是监督学习模型的特征。</p><p id="5665" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">通过在监督学习模型中使用这些向量，目标将是提高性能，而在聚类中使用它们将是找到在整个社交网络中共享相似子图结构的节点组。然后，这些组可用于推荐、客户细分、欺诈检测等。</p><p id="a353" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">什么是node2vec嵌入？</strong></p><p id="04ba" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">Node2Vec是Aditya Grover和Jure Leskovec开发的一种算法，以向量的形式表示图中的节点。节点的向量表示基于图中的随机游走。该算法从word2vec的工作方式中获得灵感。然后，这些向量可以用于其他机器学习任务，如监督或无监督学习中的特征。算法的更多细节可以在这里找到<a class="ae ku" href="https://arxiv.org/pdf/1607.00653.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1607.00653.pdf</a></p><p id="12c7" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">社交网络图上node2vec的实现</strong></p><p id="5044" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在本文中，node2vec算法是在一个网络图上实现的，该网络图是从快照数据集脸书Gemsec数据集生成的。<a class="ae ku" href="https://snap.stanford.edu/data/gemsec-Facebook.html" rel="noopener ugc nofollow" target="_blank">https://snap.stanford.edu/data/gemsec-Facebook.html</a>。这个数据集代表不同运动员的蓝色验证的脸书页面网络。节点代表运动员的页面，边代表运动员之间的相互喜欢。</p><p id="22c2" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">步骤1:导入必要的包并将数据读入pandas数据框</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/cf2f7019a00000e0badb3146fac2aead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_m9HbAXrZk00D2Zugc2Q2A.png"/></div></div></figure><p id="1d35" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">它们之间有13K个节点和86K条边。</p><p id="dd39" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">步骤2:在从pandas数据帧中提取的边缘列表上运行Node2Vec。边是连接节点的关系。从这个边列表创建一个图形对象。为了创建图形对象，我们使用networkx包。</p><p id="a396" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">以下命令将生成64维嵌入，这是一个可以优化的参数。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lh"><img src="../Images/1ef76fb3f63a510b03b4b019712f25e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54fP1Kq7sN-2t8mQt4hBWg.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/259ca6a31a5eb118c2596885d05f48a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9G7CcngD5-RgDgQZQTWDg.png"/></div></div></figure><p id="fb76" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">步骤3:图中所有节点的嵌入被提取并存储在pandas数据帧中</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/95153c75639f72ec4fda2c7db415f4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lw-g0bsJKNilkzjliAPIFQ.png"/></div></div></figure><p id="ba9d" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">步骤4:聚类:在运行K-Means聚类时，我们得到不同的聚类/社区，稍后我们将使用它们来可视化这些嵌入。对于本文，我们假设5个聚类，但是，有一些方法，如scree plot，可以确定K-Means的最佳聚类数。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/704180b92d861c7c410efbc23923c292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGo063OHmyixHGi-LEEtfQ.png"/></div></div></figure><p id="c153" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated"><strong class="jy ja">可视化嵌入和聚类结果:</strong></p><p id="fca5" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">为了获得所生成嵌入的视觉视角，我们使用主成分分析(PCA)来降低维度，并将所生成的维度与来自上述步骤的聚类相结合。确保在运行PCA之前删除集群列。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/8d10eddfeb2b6247793c565d04415e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxBxG-xCZFXwIKlnH1dj2g.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/9a6ab5461032afec4f076d5c2cabf56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CwmBuSg2z2s_56eCIOKKg.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi li"><img src="../Images/2a2f11fca7a340a3ee8455f6ffaa439f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnXPjXEEQJhbs-c2CMrv0g.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/c1faf78013a6d7d948d601f9da743bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*05F2t0VQ_kk5WWH9BTtr7A.png"/></div></figure><p id="7085" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">从上面的图中，我们可以看到5个不同的集群或社区，它们可以通过从图形网络中生成嵌入向量来提取。这些集群现在可用于进一步深入执行客户细分等任务。</p></div></div>    
</body>
</html>