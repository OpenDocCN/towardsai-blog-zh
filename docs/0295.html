<html>
<head>
<title>Sentiment Prediction of Google Play Store Reviews with Tensorflow 2.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Tensorflow 2.0的谷歌Play商店评论情感预测</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/sentiment-prediction-of-google-play-store-reviews-with-tensorflow-2-0-4357d3b561c9?source=collection_archive---------2-----------------------#2020-01-30">https://pub.towardsai.net/sentiment-prediction-of-google-play-store-reviews-with-tensorflow-2-0-4357d3b561c9?source=collection_archive---------2-----------------------#2020-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/f18572dbda0b6a8ae89b9d76f43aeed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GUIeSFCMvgedlRI8"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae jd" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</figcaption></figure><div class=""/><div class=""><h2 id="c061" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">如何训练你自己的算法，从零开始对你的应用的评论进行情绪分类</h2></div><p id="b4e0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你花了很多时间来创建你的应用程序，最后，你决定发布你的应用程序，以便让世界享受你不可思议的应用程序，但是你怎么知道你的客户是否真的喜欢你的应用程序呢？嗯，今天是你的幸运日，你手中有解决方案。</p><p id="2e91" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为你的应用程序创建客户评论的情感预测。</p><h1 id="50a9" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">步骤:</h1><ol class=""><li id="7d45" class="mj mk jg kx b ky ml lb mm le mn li mo lm mp lq mq mr ms mt bi translated">获取数据</li><li id="92c9" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">预处理数据</li><li id="3e41" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">预处理文本</li><li id="d6cd" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">向量化数据</li><li id="d954" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">创建模型</li><li id="8051" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">训练模型</li></ol><h1 id="983c" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">获取数据:</h1><p id="4200" class="pw-post-body-paragraph kv kw jg kx b ky ml kh la lb mm kk ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">对于这种分析，我们将使用一个数据集，该数据集包含play store的不同应用程序(1074个不同的应用程序)的不同评论以及由人类分类的不同评论的情感。这种分类被分为三类:积极的、中性的和消极的。</p><p id="ad20" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">数据集总共包含五列，你可以从<a class="ae jd" href="https://www.kaggle.com/lava18/google-play-store-apps/version/5#googleplaystore_user_reviews.csv" rel="noopener ugc nofollow" target="_blank">这里</a>得到。</p><h1 id="3900" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">预处理数据:</h1><p id="63fd" class="pw-post-body-paragraph kv kw jg kx b ky ml kh la lb mm kk ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">第一步是查看数据作为数据框加载后的样子:</p><figure class="nd ne nf ng gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/48583fdedda6684d011e0b9c767a323e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EP05tAuR9ZdvC0shW2ms5w.png"/></div></div></figure><p id="a42e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看数据的时候可以看到有NaN值，所以需要删除这样的数据。对于我们项目的主要目标，我们只需要两列，一列是“Translated_Review”，另一列是“perspective”</p><h1 id="d262" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">预处理文本</h1><p id="5490" class="pw-post-body-paragraph kv kw jg kx b ky ml kh la lb mm kk ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">我们需要做一些转换，使我们的数据能够被我们的神经网络理解；我们必须应用三个主要的变换来达到这个目的。第一步是将所有的文本都用小写字母表示，第二步是删除所有的标点符号，并将所有在一起的单词转换成单独的单词，最后一步是删除所有的停用词；这些词本身没有意义，比如连词或介词；为此，我们将使用库链接。</p><p id="ddce" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于这个转换，我们创建一个函数调用preprocess_text:</p><p id="86f7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们用这个函数创建一个lambda方法，用apply函数应用于“Translated_Review”列。</p><p id="a1ad" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">注意:</strong>理解并能够使用正则表达式是执行任何自然语言处理任务的先决条件。如果你不熟悉它们，也许可以从这里开始:<a class="ae jd" href="https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285" rel="noopener">正则表达式教程</a></p><h1 id="2830" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">向量化数据:</h1><p id="7ea8" class="pw-post-body-paragraph kv kw jg kx b ky ml kh la lb mm kk ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">本节的目的是将文本字符串转换成向量，以便神经网络可以处理它。首先，为了生成训练集和验证集，我们将数据框分成两个独立变量，以便我们可以分别处理它们，在此函数中，我们可以定义是要处理三个类(多类分类问题)还是只处理两个主要类(二分类任务):</p><h1 id="51c6" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">创建模型:</h1><p id="8d68" class="pw-post-body-paragraph kv kw jg kx b ky ml kh la lb mm kk ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">最后，有趣的部分，模型。首先，为了能够评估我们的模型，我们需要将我们的数据分成训练集和验证集。我们将使用<strong class="kx jh">sk learn</strong>“train _ test _ split”的函数来实现这一点。我们定义了20%数据的验证规模。</p><p id="b868" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，在创建我们的网络之前，我们需要标记数据，记住模型通常只接收数字，所以我们首先需要将文本转换成数字。为此，我们将使用Keras的函数“Tokenizer”。在这一部分，我们需要定义我们要分析的评论的最大长度，以及我们要标记的字数。最后一个预处理步骤是用零填充生僻字；这种技术被称为“填充”</p><p id="3ecc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们需要定义我们的模型，我们知道对于这类问题，最常用的算法是递归神经网络，特别是一种叫LSTM的RNN。使用这种层是因为它们在数据中识别长模式的能力，而文本问题需要分析每个单词之间的所有关系。我们需要编译我们的模型，所以我们定义了三件事:</p><ol class=""><li id="f438" class="mj mk jg kx b ky kz lb lc le nh li ni lm nj lq mq mr ms mt bi translated">损失函数:我们将使用“稀疏分类交叉熵”,因为我们有各种类。</li><li id="5665" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">优化器:在这种情况下，我们使用<strong class="kx jh"> <em class="nk"> rmsprop </em> </strong>，因为它在这类问题上有很好的表现。</li><li id="bd1f" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">度量:我们将通过准确性来评估我们的模型。</li></ol><p id="caeb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们只需要训练我们的模型，将我们的训练数据作为输入，通过三次(3个时期)运行模型，并选择每个时期128个示例的批量大小。</p><p id="7c27" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最终注释:</p><ul class=""><li id="8998" class="mj mk jg kx b ky kz lb lc le nh li ni lm nj lq nl mr ms mt bi translated">感谢Marc Munar为我们展示了如何在真实案例中应用LSTM，感谢Juan Gabriel Gomila Salas 为我们展示了他精彩的课程</li><li id="21e1" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq nl mr ms mt bi translated">本教程中使用的所有代码以及补充代码都可以在这个<a class="ae jd" href="https://colab.research.google.com/drive/1YboQjFPc2An8QSXXtHQEY4Y-cNLcF4Nq" rel="noopener ugc nofollow" target="_blank"> Google Colab中找到。</a></li><li id="a21a" class="mj mk jg kx b ky mu lb mv le mw li mx lm my lq nl mr ms mt bi translated">如果你有任何问题或意见，请发电子邮件给我jmcirot@unal.edu.co</li></ul><h1 id="1e41" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">感谢阅读</h1></div></div>    
</body>
</html>