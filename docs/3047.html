<html>
<head>
<title>A Complete End-to-End Machine Learning Based Recommendation Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个完整的基于端到端机器学习的推荐项目</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/step-by-step-approach-to-building-a-recommendation-system-a65be5a54045?source=collection_archive---------1-----------------------#2022-08-17">https://pub.towardsai.net/step-by-step-approach-to-building-a-recommendation-system-a65be5a54045?source=collection_archive---------1-----------------------#2022-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="155d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基于协同过滤和流行度过滤的机器学习推荐方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/41c90daf4cc71d2428c461c9ffacefbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoADHkyw6g5viqUJVYYPSA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自Unsplash，由Toa Heftiba上传</figcaption></figure><h2 id="3e15" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是推荐系统？</h2><p id="57bd" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">每当我们去购物中心购买一双新鞋或衣服时，我们都会找到一个专注的人，他会根据我们的喜好帮助我们选择应该购买的产品，并让我们的工作变得更简单。简单来说，他就是一个推荐系统。但在这个现代世界，一切都是在线的，互联网上有如此多的内容，Youtube上有大量的视频，亚马逊上有大量的产品，这让用户很难选择。推荐系统出现了，它通过推荐下一个要观看的视频或要购买的类似产品，让用户的生活变得简单。</p><p id="c080" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">推荐系统是一段足够智能的代码，可以理解用户的偏好，并根据他/她的兴趣推荐东西，目标是增加利润。例如，Youtube和网飞希望你在他们的平台上花更多的时间，所以他们根据用户的喜好推荐视频。亚马逊希望你从他们的网站上购买产品，这样他们可以获得更多利润。</p><div class="mp mq gp gr mr ms"><a href="https://medium.com/@gowthamsr37/pattern-programming-in-python-23d5af04211e" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">用Python编写复杂模式的简单方法，仅需4分钟。</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">用python编写复杂模式程序的简单方法</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">medium.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng kp ms"/></div></div></a></div><h2 id="be47" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">推荐系统的类型:</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/1e2fc8426afabe74390e436717751d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMXSyWRYyBfFoUaqy6QFRA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="5a56" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">基于人气的</strong>:向每个用户推荐他们网站上的顶级产品。这种方法不会考虑用户的兴趣。例如，Youtube上的趋势部分，IMDB 250大电影。</p><p id="4bb3" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">基于内容的</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/21538a51d4882cd52f739f78e52d6bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*bdXrbenn9uW2ZI8l4Gb5ag.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="f61f" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">这是基于产品之间的相似性。例如，如果用户已经观看了一部电影并且喜欢它，他可能喜欢在将来观看类似的电影。这可以基于类型、男演员、女演员或导演。</p><div class="mp mq gp gr mr ms"><a href="https://medium.com/@gowthamsr37/how-to-build-a-content-based-recommendation-system-f7d881a53e9a" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">基于内容的推荐系统的实际实现</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">一个完整的端到端的基于内容的推荐系统，根据用户的输入推荐相似的电影。</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">medium.com</p></div></div><div class="nb l"><div class="nj l nd ne nf nb ng kp ms"/></div></div></a></div><p id="16dc" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">协同过滤</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e6494c3b3d141d08ca12db1d4e2b3a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*eu8huDt4ICLg6n1RFG42GQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="5b08" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">这是基于用户的相似性。例如，如果人A和B已经观看并喜欢电影M，接下来如果人A观看了电影Z并喜欢它，我们可以向人B推荐电影Z，因为A和B是相似的用户。</p><p id="1c15" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">混合滤波</strong>:利用上述全部或部分方法形成混合模型。</p><h1 id="3273" class="nl kw iq bd kx nm nn no la np nq nr ld jw ns jx lh jz nt ka ll kc nu kd lp nv bi translated"><strong class="ak">建立图书推荐系统:</strong></h1><p id="4e45" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">让我们看看如何建立一个基于流行度和基于协同过滤的图书推荐系统。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/2e1f4e97b85452189de1808c118d04f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zx1eyNq1zdXnCYpAS5KzuQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="bdb5" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">基于流行度的过滤</strong>:</p><p id="dc75" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">让我们导入基本库，读取数据集并创建数据框。数据集可以从这个链接下载— <a class="ae nx" href="https://www.kaggle.com/datasets/arashnic/book-recommendation-dataset" rel="noopener ugc nofollow" target="_blank">数据集</a>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="509d" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">书籍-“书籍”数据框有两列ISBN(每本书的唯一ID)和书名。</p><p id="4094" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">用户—“用户”数据框有3列用户ID、位置和年龄。</p><p id="1430" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">评级——“评级”数据框有3列:用户ID、ISBN和图书评级。</p><p id="a689" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">让我们看看每个数据帧的前5行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/7b7a7a8ae4941d95fd9f00b2ff2e1f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3iH0ubiW3LF4oP1gOzufhw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="a506" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">下一步是合并‘ISBN’列上的图书和评级，合并‘USER-ID’列上的用户和评级。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/a87bd3379ddba389751572599479bc62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*RdqWTahuNecoU6-ETujA3g.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="3c49" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">让我们制作两个新的数据帧，它们将具有每本书的多个评级和平均评级，并将它们命名为<strong class="lt ir"> book_num_ratings </strong>和<strong class="lt ir"> book_avg_ratings </strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="ec28" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir"> final_rating </strong>数据帧通过合并两个数据帧book_avg_ratings和book_num_ratings创建</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/33e4c7ed7a44636d7f492c92e68a9d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*vdHYIegR7KTp2iHEL3zifQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="1d65" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">为了实现基于流行度的过滤，让我们只选择那些评级超过250的书籍，</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="d8e5" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">现在，我们已经成功地构建了一个基于流行度的推荐系统，从我们的数据集中筛选出了前50本书。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/16ea0838f027039d8273a1683853cbcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*JBth-VZvd_jV36490lRObg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="7b76" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">协同过滤:</strong></p><p id="91b8" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">为了建立一个基于协同过滤的推荐系统，我们将只考虑那些对超过200本书评分的用户和那些至少有50本评分的书。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="98a7" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我们有一个最终的数据框架，其中只有那些至少有50个评级的书籍和至少有200个评级的用户。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/99a88269e15b4aeccfc1a79e40970b35.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*hUdKH4iyK7oiv09bC7pX8Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="460d" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">下一步是创建一个数据透视表，将“Book-Title”作为索引，“User-ID”作为列，“Book-Rating”作为值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/491c1217214c0dfed6d469c4f42ec01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrAOE_D_-ilieoreUGtxuw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="ac44" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我们将使用cosine_similarity函数计算每本书之间的相似性得分。相似度得分最高的5本书将被推荐如下图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="c69f" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">下面是基于我们的推荐模型的一些结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/0484f5cfa1dccabd96014af7456eee5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-lMASLEiNVDbs62LdSLeEQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/e0c4388570bda397acd9ea826244db70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*61brZHU_NLbrXTreh3KP_w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="6743" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">现在我们已经成功构建了一个基于流行度和基于协同过滤的推荐系统。让我们使用flask部署这些模型。</p><p id="0ad3" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated"><strong class="lt ir">部署模型:</strong></p><p id="9761" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">让我们使用flask框架来部署模型。我们需要创建一个python文件app.py，它将链接到HTML文件。</p><p id="0fe9" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我们应该创建一个名为模板的文件夹，HTML文件index.html和recommend.html将被放置在那里。</p><p id="1695" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我们需要在项目文件夹中放置pickle文件popularity.pkl，similarity.pkl，books.pkl，pt.pkl。</p><p id="ce15" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">完整的代码可以在<a class="ae nx" href="https://github.com/gowthamsr37/Book-Recommendation-system" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>上找到</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="1cf6" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">基于流行度的过滤:我们的应用程序的主页将显示我们的数据集中的前50本书，以及封面、作者、平均评级和总投票数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/b798479ae37f379e3623c858fba8dcdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlCytOdwdw3Oczv76NU0tg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="9dd3" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">协同过滤:当用户点击推荐图标时，他将被提示到下面的页面，用户可以选择他需要推荐的书，一旦提交，类似的书以及封面和作者将被显示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/d39f48f58517d9359382a56bb6af2d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IkvqNNdz4AYv0gGsQ8FvCg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/fcddd49c7a10071fbc9cf16417370395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwr0kj6ihi0-QMf1P6FGxQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</figcaption></figure><p id="f330" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">因此，我们已经成功完成了部署部分。你可以试着在这个周末实施这个项目。</p><p id="a4ae" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">谢谢你。</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ms"><a href="https://medium.com/@gowthamsr37/why-multicollinearity-is-a-problem-4c273d1d1f2e" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">为什么多重共线性是一个问题？</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">什么是多重共线性？为什么我们要在创建机器学习模型之前处理多重共线性？</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">medium.com</p></div></div><div class="nb l"><div class="or l nd ne nf nb ng kp ms"/></div></div></a></div><div class="mp mq gp gr mr ms"><a rel="noopener  ugc nofollow" target="_blank" href="/which-feature-scaling-technique-to-use-standardization-vs-normalization-9dcf8eafdf8c"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">标准化与规范化相比，哪种扩展技术更有特色</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">特征缩放是强制性的吗？什么时候使用标准化？何时使用规范化？会发生什么……</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">pub.towardsai.net</p></div></div><div class="nb l"><div class="os l nd ne nf nb ng kp ms"/></div></div></a></div></div></div>    
</body>
</html>