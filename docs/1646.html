<html>
<head>
<title>Beginners Guide: Predict the Stock Market</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新手指南:预测股市</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/beginners-guide-predict-the-stock-market-38f55f33380?source=collection_archive---------4-----------------------#2021-03-09">https://pub.towardsai.net/beginners-guide-predict-the-stock-market-38f55f33380?source=collection_archive---------4-----------------------#2021-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2527" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/a1bf760b5c44a01f1822b3bcf126bbee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYAZfV0QnSgSZZ20qZCNjA.jpeg"/></div></div></figure><p id="4a00" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们将向您展示如何创建能够预测股票价格的模型。我们的方法是使用历史数据，更具体地说，是股票最近10天的收盘价。</p><p id="4db1" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><strong class="km jd">警告</strong>:股市价格高度不可预测。这个项目完全是为了研究目的！不要在它上面放任何钱！</p><p id="1fa0" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">为了获得我们的数据，我们将使用<a class="ae li" href="https://pypi.org/project/yfinance/" rel="noopener ugc nofollow" target="_blank">雅虎！金融市场下载器</a>。对于我们的第一个预测，我们将获得特斯拉股票。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="6723" class="ls lt it lo b gy lu lv l lw lx">import pandas as pd<br/>import yfinance as yf<br/>import datetime<br/>import numpy as np</span><span id="afe9" class="ls lt it lo b gy ly lv l lw lx">df=yf.download('TSLA',start='2020-01-07', end='2021-01-07',progress=False)[['Close']] df.head()</span></pre><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/bdbea2f0d1f9764a81766258de94354b.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/0*hD7Y3D8CCrArd9Cd.jpg"/></div></figure><p id="cb45" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们只需要列<strong class="km jd"> Close </strong>就是我们想要预测的值。我们现在的目标是转换数据，以便我们可以将它们输入到我们的机器学习模型中。我们希望以最近10个收盘价为特征。最简单的方法就是使用<strong class="km jd">熊猫</strong>的<strong class="km jd">换挡</strong>功能。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="ad09" class="ls lt it lo b gy lu lv l lw lx">df=pd.concat([df, df.shift(), df.shift(2),df.shift(3),df.shift(4),df.shift(5),<br/>           df.shift(6),df.shift(7),df.shift(8),df.shift(9),df.shift(10)], axis=1).dropna()<br/><br/>df.columns=list(range(0,11))<br/>df.rename(columns={0:'actual_stock_price'},inplace=True)</span></pre><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ma"><img src="../Images/27951a7ac5edb53a60aac9c93e5d85f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tPWwyS_G2mOQI3N0.png"/></div></div></figure><h1 id="998f" class="mb lt it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">预测第二天的股价</h1><p id="1520" class="pw-post-body-paragraph kk kl it km b kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld nc lf lg lh im bi translated">首先，我们将保留最近10天，以便将预测值与实际值进行比较。对于这种方法，我们将预测第二天的价格，这意味着我们将使用实际的股票价格，而不是预测的价格来计算接下来几天的测试。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="db6c" class="ls lt it lo b gy lu lv l lw lx">#split data into train and test. We will try to predict the last 10 days<br/><br/>train=df.head(len(df)-10)<br/>test=df.tail(10)<br/><br/>from sklearn.linear_model import LinearRegression<br/>lr=LinearRegression()<br/>lr.fit(train[list(range(1,11))],train['actual_stock_price'])<br/><br/>test['predictions']=lr.predict(test[list(range(1,11))])<br/><br/>ax=test[['actual_stock_price','predictions']].plot(figsize=(15,12))</span></pre><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/7908f5e36140e992a99a31bf81df5622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fwRRnp8R_-_2AcFR.jpeg"/></div></div></figure><h1 id="f77a" class="mb lt it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">预测未来10天的股票价格</h1><p id="06ac" class="pw-post-body-paragraph kk kl it km b kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld nc lf lg lh im bi translated">在这种方法中，我们将预测未来10天的价格。这意味着我们将使用我们的预测来继续和预测接下来的日子。</p><p id="1e58" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">一个非常方便的方法是我们可以用DateTime添加天数。在这段代码中，我正在进行预测，并将第二天的新预测连接到训练数据集。然后使用for循环，我重复了10次。让我们通过向我们的训练数据集添加一个新值来看看它是如何工作的。我们将添加<strong class="km jd"> 100 </strong>的值。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="5c45" class="ls lt it lo b gy lu lv l lw lx">df=yf.download('TSLA',start='2020-01-07',  end='2021-01-07',progress=False)[['Close']]<br/>train=df.head(len(df)-10)<br/>test=df.tail(10)<br/><br/>train =pd.concat([train ,pd.DataFrame( {'Close':100},index=[train.tail(1).index[0]+datetime.timedelta(days=1)])])<br/>train.tail()</span></pre><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f98e41035c7595fbfda36bb8328a7973.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/0*7iPwP76ZYWbj5I3E.jpg"/></div></figure><p id="71cf" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">如您所见，新值在<strong class="km jd">2020–12–21</strong>的第二天添加到索引为的数据集中。使用这个代码，我们现在将预测未来10天。让我们看看进展如何。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="98d4" class="ls lt it lo b gy lu lv l lw lx">df=yf.download('TSLA',start='2020-01-07',  end='2021-01-07',progress=False)[['Close']]<br/><br/>train=df.head(len(df)-10)<br/>test=df.tail(10)<br/><br/>predictions=[]<br/>for i in range(0,10):<br/>    x=pd.concat([train, train.shift(), train.shift(2),train.shift(3),train.shift(4),train.shift(5),<br/>               train.shift(6),train.shift(7),train.shift(8),train.shift(9)], axis=1).dropna().tail(1)<br/>    x.columns=range(1,11)<br/>    pred=lr.predict(x)<br/><br/>    predictions.append(pred[0])<br/>    train =pd.concat([train ,pd.DataFrame( {'Close':pred},index=[train.tail(1).index[0]+datetime.timedelta(days=1)])])<br/>    <br/>test['predictions']=predictions<br/><br/>test.plot(figsize=(15,12))</span></pre><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/5ba8fb7e233ccb33b23691ffced5576b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7vdmYbb9iEJPjab2.jpeg"/></div></div></figure><p id="1fbb" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">不错吧？这只是一个简单的例子，说明我们如何通过转换一些数据并使用简单的线性回归来预测股票价格。我们可以学到很多东西，所以开始尝试吧！如果你想感觉像华尔街之狼，你可以用虚拟货币来测试你的模型。</p><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/45ef9377b7b47950954c13c96ad26e69.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/0*g-eBQByJdGaGXMPG.gif"/></div></figure><h1 id="b85f" class="mb lt it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">奖金:“预测股市”功能</h1><p id="b912" class="pw-post-body-paragraph kk kl it km b kn my kp kq kr mz kt ku kv na kx ky kz nb lb lc ld nc lf lg lh im bi translated">让我们用第一种方法创建一个函数，看看我们的模型在其他股票上的表现如何。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="6ae7" class="ls lt it lo b gy lu lv l lw lx">def predictnextday(symbol):<br/>    df=yf.download(symbol,start='2020-01-07',  end='2021-01-07',progress=False)[['Close']]<br/>    df=pd.concat([df, df.shift(), df.shift(2),df.shift(3),df.shift(4),df.shift(5),<br/>               df.shift(6),df.shift(7),df.shift(8),df.shift(9),df.shift(10)], axis=1).dropna()<br/><br/>    df.columns=list(range(0,11))<br/>    df.rename(columns={0:'actual_stock_price'},inplace=True)<br/>    train=df.head(len(df)-10)<br/>    test=df.tail(10)<br/><br/>    from sklearn.linear_model import LinearRegression<br/>    lr=LinearRegression()<br/>    lr.fit(train[list(range(1,11))],train['actual_stock_price'])<br/><br/>    test['predictions']=lr.predict(test.tail(10)[list(range(1,11))])<br/><br/>    ax=test[['actual_stock_price','predictions']].plot(figsize=(15,12))<br/>    return(ax)</span></pre><h1 id="b499" class="mb lt it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">AMZN</h1><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/bd9dc420d182da8ceb7ed3e89d611459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*my1c6axu6sjmuRTv.jpeg"/></div></div></figure><h1 id="fcec" class="mb lt it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">尼奥</h1><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/2c7c8163c6c4a05e10e15976ac54fe8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Sr41yMYaWevosT3R.jpeg"/></div></div></figure><h1 id="1373" class="mb lt it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">贝宝</h1><figure class="lj lk ll lm gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/cb615e7d614e3295b7d613f327490543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9XE7wOLSfle4wvGG.jpeg"/></div></div></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="6892" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><em class="nm">原载于https://predictivehacks.com</em><a class="ae li" href="https://predictivehacks.com/beginners-guide-predict-the-stock-market/" rel="noopener ugc nofollow" target="_blank"><em class="nm"/></a><em class="nm">。</em></p></div></div>    
</body>
</html>