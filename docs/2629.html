<html>
<head>
<title>All About Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于逻辑回归的一切</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/all-about-logistic-regression-f7d961ebb9ad?source=collection_archive---------2-----------------------#2022-03-22">https://pub.towardsai.net/all-about-logistic-regression-f7d961ebb9ad?source=collection_archive---------2-----------------------#2022-03-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f755" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将了解逻辑回归并尝试回答以下问题:</p><ul class=""><li id="1c26" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">什么是逻辑回归？</li><li id="af57" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">为什么不是线性回归？</li><li id="bd90" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">为什么是逻辑回归？</li><li id="0574" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">什么时候逻辑回归？</li><li id="1442" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">如何进行逻辑回归？</li></ul><h1 id="9538" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">什么是逻辑回归？</strong></h1><p id="4daf" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">逻辑回归是一种受监督的机器学习算法，用于分类问题，其中我们必须通过使用自变量来区分两个或更多类别或类之间的因变量。</p><p id="fdd9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/489e211895e2f1e48214ce81e2dfcfd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*8eYjAjoAjN15DKpghXdMug.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">鸢尾花数据集</figcaption></figure><p id="7705" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">考虑上表，其中因变量是“物种”，自变量是“花瓣宽度”。物种分为两类,“0”代表鸢尾花,“1”代表杂色鸢尾花。</p><p id="7d83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑回归将使用花的花瓣宽度给出相应类别的概率。</p><h1 id="4755" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">为什么不是线性回归？</h1><p id="bb26" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">主要有两个原因:</p><ol class=""><li id="f551" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mo kr ks kt bi translated">线性回归处理连续或定量值，而在分类问题中，我们处理离散或概率值。</li><li id="c9ff" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mo kr ks kt bi translated">如果我们以某种方式将线性回归线拟合到数据集，如下所示:</li></ol><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/22ba4d43ef4054039f3c854a509d9c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*OxQpPoiXA_CVSTTohGJ0GQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">具有线性回归的虹膜数据集图表</figcaption></figure><p id="7d43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们取阈值0.5，在这种情况下，线性线似乎做得很好，但如果我们在数据集中引入一些异常值。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/791a06af66c363309c910e090445a150.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*1XtGpaQYO99LBAUesF7OuA.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">具有线性回归的Iris数据集(具有异常值)的图表</figcaption></figure><p id="fea8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以看到线条斜率从原始位置波动了多少。因此，当引入新的数据点时，我们无法承受这种给出不同答案的模型。另一个需要注意的小点是，结果的范围不在我们想要的范围内，这是预测概率在0到1的范围之外。</p><p id="e410" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要了解更多关于线性回归的信息，请点击下面的链接:</p><div class="mr ms gp gr mt mu"><a href="https://medium.com/@akashdawari202/all-about-linear-regression-358ee3a11d86" rel="noopener follow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">关于线性回归的一切</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">在本文中，我们将探讨线性回归，并尝试回答以下问题:</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">medium.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni mi mu"/></div></div></a></div><p id="23bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">为什么是逻辑回归？</strong></p><ul class=""><li id="29be" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">正如我们在上面的问题中讨论的，当引入新的数据点时，线性回归会波动。逻辑回归通过引入额外的函数将最佳拟合直线弯曲成如下所示的曲线来解决这个问题。</li></ul><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/cf30821f2269daf7ce93e1b25e2b4112.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*TYKHTtHnBK_ph8wTzM9bfQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">使用逻辑回归的Iris数据集图表</figcaption></figure><ul class=""><li id="e598" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">逻辑回归易于理解、实现，并且训练起来非常有效。</li><li id="13af" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">逻辑回归在小数据集上工作良好，并且在对未知记录进行分类时非常快。</li><li id="6ebe" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">逻辑回归的核心概念进一步用于人工神经网络。</li></ul><h1 id="826c" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">什么时候的逻辑回归？</strong></h1><p id="d01c" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">当逻辑回归满足以下要求时:</p><ul class=""><li id="89a9" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">因变量必须是分类数据，要么是二进制数据类，要么是有序数据类。</li><li id="8f50" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">独立变量的观察不得重复或匹配，因为逻辑回归对过度拟合敏感。</li><li id="ff22" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">独立变量之间不应存在多重共线性</li><li id="f4bb" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">逻辑回归通常需要大样本量。</li></ul><blockquote class="nk nl nm"><p id="09ed" class="jn jo nn jp b jq jr js jt ju jv jw jx no jz ka kb np kd ke kf nq kh ki kj kk ij bi translated"><strong class="jp ir">注:</strong>以上几点也被称为“逻辑回归的假设”。</p></blockquote><h1 id="d4bf" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">如何进行逻辑回归？</strong></h1><p id="4df0" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">理解逻辑回归有两种方法。</p><ol class=""><li id="3715" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mo kr ks kt bi translated">概率直觉</li><li id="03ae" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mo kr ks kt bi translated">几何直觉</li></ol><p id="f81a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们将去概率直觉，因为几何直觉将再次涵盖在SVM(支持向量机)。</p><p id="95c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们上面讨论的，逻辑回归使用一个函数来挤压或弯曲线性线，该函数可以是任何数学函数，如tan、Sigmoid、ReLu等</p><h2 id="2616" class="nr la iq bd lb ns nt dn lf nu nv dp lj jy nw nx ln kc ny nz lr kg oa ob lv oc bi translated"><strong class="ak">s形函数</strong></h2><p id="39aa" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">逻辑回归大多使用sigmoid函数，因为-</p><ol class=""><li id="312c" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mo kr ks kt bi translated">sigmoid函数返回0到1范围内的结果，这非常适合逻辑回归，因为我们正在预测结果的概率。</li><li id="adcd" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mo kr ks kt bi translated">与梯度下降过程中使用的其他函数相比，Sigmoid函数导数更容易计算。</li></ol><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi od"><img src="../Images/f9c4542f5a425a6026b818787a7b81e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*ab6BvKgjdH5826lnVTibBQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">Sigmoid函数</figcaption></figure><p id="4969" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看结果概率和线性直线方程之间的一些关系，以便更好地理解线性回归和逻辑回归之间的关系:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/bb8db8039b940b95e294073f2dc83bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-fL3sUYMJDnEQsW4ZrSxw.jpeg"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">逻辑回归中的Logit函数</figcaption></figure><p id="25b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，作为大多数监督机器学习算法，逻辑回归也有三个主要步骤:假设，成本函数，一种优化技术。</p><p id="18dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设:在这里，我们假设自变量和因变量之间存在某种数学关系。在逻辑回归中，我们使用Sigmoid函数来建立关系。</p><p id="3e15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">成本函数:</strong>该函数用于找出我们预测值的误差。在逻辑回归中，我们使用对数损失函数。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oj"><img src="../Images/3de23258d97a7a3a07e98e76118aa485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2MoKTPlKteBw_8EnUFF3DA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">对数损失函数</figcaption></figure><p id="9f59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">优化技术</strong>:在这一步，我们试图使用一些数学技术来减少误差。在逻辑回归中，我们将使用梯度下降来实现。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/2b8840db6d914c633c989fd7ca741e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*wHvMe93NFJORWigH1jY7Uw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">梯度下降</figcaption></figure><p id="7371" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中，对数损失函数的导数为:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/2f2b91dd2104f782383946e5b61aaa9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*hI0hxlb8ZC4ZFIvuKOtXNA.png"/></div></figure><h2 id="125d" class="nr la iq bd lb ns nt dn lf nu nv dp lj jy nw nx ln kc ny nz lr kg oa ob lv oc bi translated">从头开始使用Python编写逻辑回归的代码示例:</h2><p id="4c13" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">步骤1:准备数据集</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi om"><img src="../Images/a4ddfd1eabdda7619bbbd315d043d7a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiyyAe-H6d0MveG1zNVpxQ.png"/></div></div></figure><p id="9c6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤2:创建一个函数，该函数执行梯度下降并返回与每个独立变量相关联的权重值。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi on"><img src="../Images/c62508a6dbe0abcd6602d0ae96677653.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*Zmg97Lt00wGc2PooaZoaew.png"/></div></figure><p id="7a0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤4:创建一个使用权重预测结果的函数。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/0c9e13733e89c4c7eeb59e3dd36909d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*i4yTLZJQG4rmWjEy7wmfaQ.png"/></div></figure><p id="8b9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第五步:调用函数并预测结果。</p><h2 id="af3e" class="nr la iq bd lb ns nt dn lf nu nv dp lj jy nw nx ln kc ny nz lr kg oa ob lv oc bi translated">我们如何知道预测的得分或准确性？</h2><p id="c46b" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">在分类问题中，我们使用混淆矩阵、准确度分数、精确度、召回率或F1分数来衡量模型的准确度。</p><p id="fdd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">混淆矩阵</strong>:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi op"><img src="../Images/60abfe6b5c1a263b4a3ae5509e258f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*jqP2CBfdI_ni_riaplex_Q.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">混淆矩阵</figcaption></figure><p id="1164" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中，<br/> <strong class="jp ir">真阳性(TP) </strong>:被分类模型预测为阳性且也为阳性的结果<br/> <strong class="jp ir">真阴性(TN): </strong>被分类模型预测为阴性且也为阴性的结果<br/> <strong class="jp ir">假阳性(FP): </strong>被分类模型预测为阳性但实际为阴性的结果<br/> <strong class="jp ir">假阴性(FN): </strong>被分类模型预测为阴性但实际为阳性的结果。<br/>模型的可信度取决于模型做出了多少正确的预测。</p><p id="db1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">准确率:T </strong>正确分类总数除以分类总数。</p><p id="909c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">精度:这是对所有正面预测中，有多少是真实的正面预测的一种度量</p><p id="9da8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">回想一下</strong>:这是一个衡量标准:从阳性结果的总数中，有多少阳性结果被模型正确预测。</p><p id="4bcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> F1得分</strong>:定义为精确度和召回率的调和平均值。</p><blockquote class="nk nl nm"><p id="0791" class="jn jo nn jp b jq jr js jt ju jv jw jx no jz ka kb np kd ke kf nq kh ki kj kk ij bi translated">本文中使用的笔记本的链接:</p></blockquote><div class="mr ms gp gr mt mu"><a href="https://github.com/Akashdawari/Articles_Blogs_Content/blob/main/All_About_Logistic_Regression.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">articles _ Blogs _ Content/All _ About _ Logistic _ regression . ipynb at main…</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">这个知识库包含了jupyter关于发表在博客上的文章的笔记本。…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">github.com</p></div></div><div class="nd l"><div class="oq l nf ng nh nd ni mi mu"/></div></div></a></div><p id="d655" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">喜欢并分享如果你觉得这篇文章有帮助。还有，关注我的medium，了解更多机器学习和深度学习相关的内容。</p></div></div>    
</body>
</html>