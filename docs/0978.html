<html>
<head>
<title>Detecting Marine Creatures using the Monk Object Detection Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Monk对象检测库检测海洋生物</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/detecting-marine-creatures-using-monk-object-detection-62ea2f8460e6?source=collection_archive---------4-----------------------#2020-09-26">https://pub.towardsai.net/detecting-marine-creatures-using-monk-object-detection-62ea2f8460e6?source=collection_archive---------4-----------------------#2020-09-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7da0" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><div class=""><h2 id="b3bb" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">Monk对象检测库是一个低代码库，可以非常容易和有效地执行对象检测。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/fee68e5b6fa16d8e386ea61a9dbbf537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZQKsiYlrNDYMqdCw"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源:<a class="ae le" href="https://unsplash.com/photos/9y7y26C-l4Y" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><h1 id="7492" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">关于项目:</h1><p id="d7cd" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">世界各地的人们都食用像鱼、蟹、虾这样的咸水生物。捕捞这些生物的渔民倾向于过度捕捞，这引起了海洋生物学家和科学家的关注。因为许多海洋生物正濒临灭绝。但是如果我们有一个探测器，可以探测到这些生物。这肯定会降低过度捕捞的风险，并帮助这些物种免于濒临灭绝。</p><p id="b726" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">使用Monk对象检测，我们可以非常容易地构建它。所以让我们开始做吧！！</p><h1 id="6458" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">关于数据集:</h1><p id="057a" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">训练任何模型，首先需要的是数据。用于此目的的数据集名为“半咸水数据集”，可在Kaggle中获得。该数据集包含在咸水中发现的海洋生物的视频。现在，我们需要将视频转换为帧图像，以便我们的模型进行训练和检测。</p><h2 id="bd8c" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">创建训练、验证和测试数据集:</h2><p id="eee7" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">现在，一旦我们准备好了帧图像，我们就可以开始创建数据集了。为此，数据集本身包含。txt文件，分别包含训练、验证和测试数据集的图像名称列表。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="64a9" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">我写了一个小函数，它将图像文件夹路径、目标路径和文本文件路径作为参数。一旦我们传递了它，它就将文本文件读入一个pandas数据帧，并使用“shutil”将文件中名称可用的图像从源目录移动到目标目录。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">呼唤列车图像</figcaption></figure><p id="76ae" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">我已经处理了图像，并执行了训练测试分割，因此数据可以直接使用。数据集包含大约11，000张训练图像，有6种不同的生物。</p><p id="3eaa" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">数据集链接:<a class="ae le" href="https://drive.google.com/drive/folders/1E7LZQlC_zR7Yvy4CJ3yyWTB1PZ0Rz5RS?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://drive . Google . com/drive/folders/1e 7 lzqlc _ Zr 7 yvy 4 CJ 3 yywtb 1 pz 0 rz 5 RS？usp =分享</a></p><h2 id="c550" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">创建注释文件:</h2><p id="821b" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">Monk对象检测库支持各种管道，并支持可可和YOLO注释。对于这个项目，我将使用带有COCO注释的“mmdnet”管道。</p><p id="5de2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">我还直接包含了注释文件。但是，所有的数据预处理代码都可以在Github存储库中找到。</p><p id="23b0" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">批注文件链接:<a class="ae le" href="https://drive.google.com/drive/folders/1EU9KDI9lN1hUFZ3WEuUWac6Alh9GhgBR?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://drive . Google . com/drive/folders/1 eu 9 kdi 9 ln 1 hufz 3 weuuwac 6 al h 9 GHG br？usp =分享</a></p><h1 id="bea3" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">训练模型:</h1><p id="fc73" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">我们已经准备好数据，现在我们必须训练模型。如前所述，为此我使用了Monk对象检测库。</p><h2 id="2171" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">安装和设置库:</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="5817" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这样，我们就克隆了存储库。一旦库被克隆，我们需要为我们的“mmdnet”管道安装需求，以便为我们的代码使用库。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="76e5" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这通常需要5-6分钟，一旦安装了每个依赖项，我们就可以设置库以供使用了。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="fd8f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在我们导入检测器函数，它用于训练一个对象检测器。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="30b7" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">加载数据:</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="3516" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这里加载了列车图像，以及注释文件和类名文件。类似地，我们也将加载验证集。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="cef5" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">设置参数:</h2><p id="ae14" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">现在，我们需要为我们的项目设置超参数、纪元数量和模型。为此，我选择了“faster _ rcnn _ x101 _ 64x4d _ fpn”型号。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="374b" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">训练模型:</h2><p id="b306" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">现在剩下的唯一步骤是训练模型及其最简单的部分。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="7fcd" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这将开始训练，在标准GPU上需要一点时间。所以耐心点，当模型训练的时候。</p><h1 id="8860" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">测试模型:</h1><p id="102c" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">训练需要在标准GPU上进行5-6小时，你训练模型越多，它的表现就越好。</p><p id="3260" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">一旦训练完成，我们需要测试模型性能。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="22bc" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">我们称之为“推断”法，以检验模型性能。</p><h2 id="8bd4" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">加载训练好的模型，并在测试图像上进行测试:</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="4d19" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">我们加载训练好的模型，用于测试。现在我们通过一个测试图像，来检查性能。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nj nk l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nl"><img src="../Images/e39d9217e73023566e3c88532092a2c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-5kg5NSRgOl06mgeM4codw.png"/></div></div></figure><p id="4ae7" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这个输出显示图像被保存为“test1.png ”,现在让我们看看它是什么样子。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/3b258ed7941c2e02525afd2cd9a1b693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JNlhtSzvbIoRM7rsiFHcKA.png"/></div></div></figure><p id="8003" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">可以清楚地看到，我们的模型成功地检测到了图像中检测到的所有海洋生物。</p><p id="7fc2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">所以你可以非常容易地训练你自己的物体检测模型。我还链接了包含完整代码的存储库。</p><h1 id="8fed" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">资源:</h1><p id="7f09" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">存储库链接:<a class="ae le" href="https://github.com/Tessellate-Imaging/Monk_Object_Detection/blob/master/application_model_zoo/Example%20-%20Brackish%20Water%20Creatures%20Identification.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Tessellate-Imaging/Monk _ Object _ Detection/blob/master/application _ model _ zoo/Example % 20-% 20 brackish % 20 water % 20 creatures % 20 identificati on . ipynb</a></p><p id="076e" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">僧库:【https://github.com/Tessellate-Imaging/Monk_Object_Detection T2】</p><p id="4988" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">原始数据集:【https://www.kaggle.com/aalborguniversity/brackish-dataset T4】</p></div></div>    
</body>
</html>