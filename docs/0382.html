<html>
<head>
<title>GANs using MNIST Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用MNIST数据集的甘斯</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/gans-using-mnist-dataset-7a11fd254a53?source=collection_archive---------0-----------------------#2020-03-31">https://pub.towardsai.net/gans-using-mnist-dataset-7a11fd254a53?source=collection_archive---------0-----------------------#2020-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="07b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Keras API生成类似MNIST的角色图像</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/76e214ee65149cdd5419842ef77f35cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9-f6d9JZHX6zGo0ENk6OIg.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated"><a class="ae lb" href="https://pixabay.com/illustrations/monalisa-mona-lisa-corona-virus-4893660/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h2 id="dba7" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">“生成对抗网络是过去10年机器学习中最有趣的想法”——<strong class="ak">Yann le Cun</strong>。</h2></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="9748" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mc translated">自2018年初以来，世代对立网络(GANs)变得极为流行。GANs是关于创建、设计和操作输入图像的，这些图像与数据集图像相似，但又不完全相同。</p><p id="ee8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GANs由两部分组成:</p><ol class=""><li id="de35" class="ml mm iq jp b jq jr ju jv jy mn kc mo kg mp kk mq mr ms mt bi translated">发电机</li><li id="0403" class="ml mm iq jp b jq mu ju mv jy mw kc mx kg my kk mq mr ms mt bi translated">鉴别器</li></ol><p id="defd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它主要是一个无监督的计算机视觉网络，其中发生器的输出与鉴别器进行比较。一旦整个网络经过训练和评估，我们就可以使用生成器模块来生成新的图像。</p><blockquote class="mz na nb"><p id="5d94" class="jn jo nc jp b jq jr js jt ju jv jw jx nd jz ka kb ne kd ke kf nf kh ki kj kk ij bi translated"><strong class="jp ir">简单的直觉</strong> - <strong class="jp ir">生成器就像一个小贩试图创造新的葡萄酒样本，而鉴别器则像一个品酒师团队一样努力寻找已经创造出来的样本。生成器和鉴别器都试图超越对方。此外，发生器和鉴别器都有一个多层感知器(MLP)结构。</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ng"><img src="../Images/e80670fa8748a16205b256f6918b4051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBVfgE30tBs8CZ58efnaQQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">生成对抗网络</figcaption></figure><p id="0d4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">生成器的工作是创建与数据集相似的新图像，该数据集应该不能被鉴别器网络区分。</p><p id="32a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">鉴别器网络考虑两个输出，即来自真实数据集的图像和来自生成器网络的图像。鉴别器网络作为二元分类器工作，并且对给定图像是生成的图像还是真实的图像进行分类。</p><h1 id="2d3a" class="nh ld iq bd le ni nj nk lh nl nm nn lk no np nq ln nr ns nt lq nu nv nw lt nx bi translated">训练GAN</h1><p id="8006" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">对于这个示例博客，我们将使用MNIST数据集并创建新的角色图像。我们会一个接一个地理解这个模型的细节和复杂性。训练GAN包括以下步骤:</p><h2 id="b99a" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">第一步:加载数据集</em> </strong></h2><p id="4a74" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">在这一步中，我们加载数据集。对于这个博客，我们将使用MNIST数据集，它是数据集中每个数据点的(28，28)维图像。它们被展平成(784，1)维向量。数据集中总共有60，000幅图像。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi og"><img src="../Images/eeb5e996a38e34aa478cc9085a9678cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/format:webp/1*5zpnQuDn_9l6Ion3bbPfvA.jpeg"/></div></figure><h2 id="b243" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">第二步:定义优化器参数</em> </strong></h2><p id="0894" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">我们使用给定的参数定义adam优化器。</p><p id="a026" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">学习率=0.02</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="d8cf" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">第三步:定义发电机模型架构</em> </strong></h2><p id="8757" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">发电机模型是一个MLP架构，一层堆叠在另一层之上。它接受一个100维的随机噪声，并返回一个784维的输出向量。必须注意，最终输出层具有'<em class="nc"> tan h' </em>激活，而不是'<em class="nc"> sigmoid </em>激活。使用tan h而不是sigmoid的原因超出了本博客的范围。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">发电机网络</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/769ba2b63538be652e0374397952b511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*t2NekDyUwySRuTug26MGYw.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">发电机网络概述</figcaption></figure><h2 id="f61c" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">第四步:定义鉴别器模型</em> </strong></h2><p id="973c" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">像发电机模型一样，鉴别器模型也是一种MLP架构。它从数据和生成器网络中获取784维输入。它返回单个值输出，这是分类生成图像和真实图像时的输出分数(概率)。与发生器不同，它在最终输出层中具有s形激活，而不是tan h激活层。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">鉴别器网络</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/74467eecf710bc46071917802389a9bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*URm8VKzOhQum3FT7bvLkzg.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">鉴频器网络概述</figcaption></figure><h2 id="acc2" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">第五步:定义GAN模型</em> </strong></h2><p id="7ddc" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">到目前为止，我们已经加载了MNIST数据集，并定义了生成器和鉴别器网络。现在，我们将结合发生器和鉴别器模型来定义GAN模型。</p><p id="30b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将一个100维随机噪声馈入发生器网络，其输出馈入鉴别器网络。很难同时训练鉴别器和发生器网络。在神经网络术语中，同时训练两个网络的挑战在于它们可能无法收敛。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">开始</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/adbbeb81ed180e275e5da430445d0887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*X-HK6aVLMBQF5QcIaDKhRg.jpeg"/></div></figure><h2 id="bd95" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">步骤6:定义函数从发生器输出</em> </strong>创建图像</h2><p id="b172" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">到目前为止，很明显，生成器网络给出的输出是784维向量，而MNIST数据集中的图像大小为(28，28)。因此，一旦生成器模型给出了它的预测，它就被整形为(28，28)矩阵。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="9915" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak"> <em class="od">第七步:训练网络</em> </strong></h2><p id="df36" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">在这一步中，我们定义一个批处理(比如batch_size=128)。然后我们定义发电机网络。一旦确定了发生器，就给网络一些随机噪声，用它来预测输出。现在，来自真实的和生成的数据集的批量数据被提供给鉴别器。现在，我们将使鉴频器重量可训练，发电机重量冻结。我们通过交替冻结生成器和鉴别器模型的权重来训练GAN。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oe of l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">对128和500个时期的批量进行培训</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e692ee1302b5d9336a0b0bd731a6fb9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*Y1yyt7ywhzOUQJublOr-lg.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">这就是最初的纪元训练的样子</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/a9c0cd6f3b120f3be6f83959b1bb9991.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*ZcOCNNl_O7XymH6UwXgF8w.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">这就是最终纪元训练的样子。</figcaption></figure><p id="d946" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多参考，试试这个<a class="ae lb" href="https://colab.research.google.com/drive/1PErY9XmsMTGOYApgh1xmErXkmXbMSNjY" rel="noopener ugc nofollow" target="_blank"> colab </a>笔记本或者这个<a class="ae lb" href="https://github.com/sawarn69/GANs" rel="noopener ugc nofollow" target="_blank"> Github </a>链接。</p><h2 id="a6f3" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">输出</strong></h2><p id="24cd" class="pw-post-body-paragraph jn jo iq jp b jq ny js jt ju nz jw jx jy oa ka kb kc ob ke kf kg oc ki kj kk ij bi translated">初始时期(少于20)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi om"><img src="../Images/10dadffcbea0a321b5c205a72bdbaee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGEhrra3Ci1vS3derqXLcg.jpeg"/></div></div></figure><p id="2b9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终纪元(450年到500年之间)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi on"><img src="../Images/4c309f3630c72e3ec6a9f4f52737cd1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*x--sXtY8K_eOjs9sYVf0Rg.jpeg"/></div></figure></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><div class="km kn ko kp gt oo"><a href="https://medium.com/@jonathan_hui/gan-whats-generative-adversarial-networks-and-its-application-f39ed278ef09" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd ir gy z fp ot fr fs ou fu fw ip bi translated">什么是生成性对抗网络？</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">从无到有创造一些东西是最伟大的感觉之一，...简直是天堂。</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc kv oo"/></div></div></a></div></div></div>    
</body>
</html>