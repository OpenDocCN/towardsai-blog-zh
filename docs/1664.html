<html>
<head>
<title>Imbalanced Data and How to Balance It</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不平衡数据及其平衡方法</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/imbalanced-data-and-how-to-balance-it-d7c85321d3cb?source=collection_archive---------8-----------------------#2021-03-12">https://pub.towardsai.net/imbalanced-data-and-how-to-balance-it-d7c85321d3cb?source=collection_archive---------8-----------------------#2021-03-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f028" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">机器学习</h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/aa51e28bc59a9a477e84258cb8f1c0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKsLrGqIOdOjfuHNsKc8iw.jpeg"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">图像由罗马卡夫在Unsplash</figcaption></figure><p id="78bd" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">最近，考虑到大部分时间都花在清理和预处理数据上，处理数据已经成为一项乏味的工作。现实世界中的数据通常不符合我们的预期。它有很多不规则性，处理这样的数据很有挑战性。处理这些数据的一个主要障碍是数据不平衡。值得注意的是，数据的结构是这样的，目标特征(特别是分类问题)在一个类中占大多数，而第二个类中几乎没有训练样本。第二，对于多类分类问题，在目标特征中，某一类的训练样本比其他类的样本在很大程度上超出。这妨碍了模型的性能。下面列出了一些方法，可以避免这种问题，并确保您的模型能够有效地处理您的数据。</p><ol class=""><li id="e7c2" class="lj lk iq kn b ko kp ks kt kw ll la lm le ln li lo lp lq lr bi translated">欠采样</li><li id="941d" class="lj lk iq kn b ko ls ks lt kw lu la lv le lw li lo lp lq lr bi translated">过采样</li><li id="1a43" class="lj lk iq kn b ko ls ks lt kw lu la lv le lw li lo lp lq lr bi translated">设置模型的权重超参数。</li><li id="7523" class="lj lk iq kn b ko ls ks lt kw lu la lv le lw li lo lp lq lr bi translated">将训练测试分割设置为分层属性。</li></ol></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="eb06" class="me mf iq bd mg mh mi dn mj mk ml dp mm kw mn mo mp la mq mr ms le mt mu mv iw bi translated">欠采样</h2><p id="f4a0" class="pw-post-body-paragraph kl km iq kn b ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li ij bi translated">欠采样指的是从属于目标特征类别的数据中移除训练样本，该目标特征类别在其他类别中占多数。然而，这种方法有它的优点和缺点。优点:您可以加快模型的训练速度，因为模型需要训练的样本相对较少，数据集也同样均衡。缺点是，随着训练样本数量的减少，模型(高效模型)将无法对未知数据进行很好的概括，有时可能会导致过度拟合。正如所言，模型看到的数据越多，它对未知数据的预测就越准确。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="f25c" class="me mf iq bd mg mh mi dn mj mk ml dp mm kw mn mo mp la mq mr ms le mt mu mv iw bi translated">过采样</h2><figure class="nc nd ne nf gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nb"><img src="../Images/8159652eee7b47ed72226b1e3b466290.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*653pagoYap70U9vp6K4eKA.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">作者图片</figcaption></figure><p id="5d5e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">过采样是一种技术，其中少数类的训练样本的数量增加，以便平衡多数类和少数类的样本数量。这只适用于只有两个类的二元分类问题。在多类分类的情况下，增加少数类的样本数。用于过采样的关键技术之一称为SMOTE(合成少数过采样技术)。</p><p id="1ec1" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在该方法中，从少数类中选择随机训练样本，并使用K-最近邻，将最接近所选样本(通常k=5)的训练样本考虑在内。从这些选择的样本中，选择一个随机样本。考虑到这个样本和属于少数类的样本，使用SMOTE方法生成合成训练样本。通过应用过采样，您的模型可能能够很好地对新数据进行归纳。要考虑的一个缺点是，具有大量训练样本的数据集不是过采样的好选择。这是因为大量的样本减缓了手头模型的训练过程。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="59e7" class="me mf iq bd mg mh mi dn mj mk ml dp mm kw mn mo mp la mq mr ms le mt mu mv iw bi translated">设置模型的“权重”超参数。</h2><p id="4ae7" class="pw-post-body-paragraph kl km iq kn b ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li ij bi translated">一般来说，如果你考虑一个像随机森林分类器这样的初级机器学习模型，你可以微调一个称为<code class="fe ng nh ni nj b">sample_weight</code>的超参数。例如，在二元分类问题中，如果目标类别1超过目标类别0的3倍，那么您可以将这个超参数设置为<code class="fe ng nh ni nj b">sample_weight=[np.array[3 if i==0 else 1 if i==1]</code>。类似地，对于Catboost分类器，我们有<code class="fe ng nh ni nj b">class_weights</code>超参数，它可以根据我们的类分布来设置。在这个方法中，你需要确定每个类的比例。例如，如果类0贡献了70%的训练样本，剩余的30%属于类1，那么您可以设置类似<code class="fe ng nh ni nj b">class_weights=[0.3,0.7]</code>的参数。由此，我们推断，由于类0具有70 %的训练样本，因此我们将值0.3赋给它，以使比率相等，从而使数据平衡。第1类样品的情况也是如此。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="9d91" class="me mf iq bd mg mh mi dn mj mk ml dp mm kw mn mo mp la mq mr ms le mt mu mv iw bi translated">设置train_test_split分层属性。</h2><figure class="nc nd ne nf gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nk"><img src="../Images/167bd83b1ea94e19c1d5bc81eb9fbefb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htUC-UzmOSarujuAavgoFQ.jpeg"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">图片由Alexandre Van Thuan在Unsplash上提供</figcaption></figure><p id="4955" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这里，让我们来看看一个直接而简单的方法，通过它来平衡数据是尽可能简单的。在将数据集拆分为定型集和测试集的过程中，可以指定函数的“分层”属性，以平衡不平衡的数据集。使用此属性，train_test_split以这样一种方式拆分原始数据集，即在定型集和验证集中保留两个类(二元分类)的比例。例如，如果您以80:20的比例分发原始数据，<code class="fe ng nh ni nj b">train_test_split(X,y,test_size=0.2,stratify=y)</code>它将在训练集和测试集中保持80:20的比例。这是一个简单的方法；然而，您可以使用任何方法，这反过来有助于模型的整体性能。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="d30d" class="me mf iq bd mg mh mi dn mj mk ml dp mm kw mn mo mp la mq mr ms le mt mu mv iw bi translated">参考</h2><p id="a822" class="pw-post-body-paragraph kl km iq kn b ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li ij bi translated">Scikit学习官方文档。作者图片。图片来自Unsplash。</p><h2 id="154f" class="me mf iq bd mg mh mi dn mj mk ml dp mm kw mn mo mp la mq mr ms le mt mu mv iw bi translated">结论</h2><p id="319e" class="pw-post-body-paragraph kl km iq kn b ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li ij bi translated">现实世界的数据通常是非结构化的和不平衡的。因此，处理数据不平衡是数据预处理过程中应该考虑的主要问题之一。我希望已经提供了关于不平衡数据集处理的有价值的信息。最后，最近一个处理不平衡的方法是Andreas Mueller的<a class="ae nl" href="https://amueller.github.io/ml-training-advanced/slides/04-imbalanced-data.html#15" rel="noopener ugc nofollow" target="_blank">集合重采样方法</a>。请随意查看这些和上面的数据处理方法。</p></div></div>    
</body>
</html>