<html>
<head>
<title>Banking Market Customer Analysis in Big Data Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大数据项目中的银行市场客户分析</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/banking-market-customer-analysis-in-big-data-project-387ec95b56e5?source=collection_archive---------0-----------------------#2021-01-11">https://pub.towardsai.net/banking-market-customer-analysis-in-big-data-project-387ec95b56e5?source=collection_archive---------0-----------------------#2021-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b799" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-analysis" rel="noopener ugc nofollow" target="_blank">数据分析</a></h2><div class=""/><div class=""><h2 id="c4b9" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">这个分析中使用的工具和语言是spark和scala</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/564ea9e52121cae1254112b5fa9798f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KXTfJer6tul4vVzS"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@franki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">弗兰基·查马基</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="6cb0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">通过使用scala语言，银行领域的大数据分析项目非常有趣。许多银行给全国各地的许多人打电话，说服他们投资银行计划。嗯，我也接到很多电话。他们试图解释他们想推销的计划的好处。</p><p id="14b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">活动结束后，该银行获得了一个愿意投资他们银行的好客户。总数据集包含订阅了存款期限和没有订阅的客户的所有记录。</p><p id="99cd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集变量是年龄、工作、婚姻、违约、住房、贷款、联系人、月份、星期几、持续时间、活动、天数、以前、结果和y。</p><p id="7da9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据这些数据集，目标变量是“y”，即以二进制“是”和“否”表示的定期存款认购人或认购人。其他剩余特征是独立变量。</p><p id="fb29" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">从我的观察，我觉得有两个重要的特点。“持续时间”和“y”，持续时间很重要，因为打电话的时间越长，说明这个人对这个计划感兴趣，而“y”本身就是一个因变量。</p><p id="17fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集名称为banking，我们将使用spark工具和scala语言进行分析。原始数据如下所示，用分号分隔。</p><h2 id="b58a" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">步骤1:加载数据并制作数据框。</h2><p id="4e9c" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">为此，我们需要读取CSV文件并选择delimiter选项，以便用分号分隔各个特性。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="60a8" class="me mf it nc b gy ng nh l ni nj">scala&gt; val mydf= spark.read.format("csv").option("header","true").<br/>                  option("delimiter",";").load("banking.csv")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/b80f988707acbf4347261a32bbb4d9e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUq8Fd_6l0Y2M_3JOi_uEw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">数据变量获得了数据集的特征。作者图片</figcaption></figure><p id="0411" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在获得变量“mydf”中的数据后，我们可以使用“printSchema”方法查看列的名称。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="ef1d" class="me mf it nc b gy ng nh l ni nj">scala&gt; data.printSchema</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/af7b06f30188eac013eb1a0bf9814769.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*p-xth0khevqGNIhQCB-pcA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">所有列名的视图。作者图片</figcaption></figure><h2 id="67de" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第二步:成功率</h2><p id="d539" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">成功率由订阅该方案的人占记录总数的百分比来定义。为此，我们需要计算订阅记录和总条目的总数。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="2dac" class="me mf it nc b gy ng nh l ni nj">scala&gt; val totalcount = mydf.count().toDouble</span><span id="b8ee" class="me mf it nc b gy nm nh l ni nj">#output: <br/>totalcount: Double = 45211.0</span><span id="1867" class="me mf it nc b gy nm nh l ni nj">scala&gt; val subscribed = mydf.filter($"y" === "yes").count().toDouble</span><span id="4015" class="me mf it nc b gy nm nh l ni nj">#output:<br/>subscribed = Double = 5289.0</span><span id="62df" class="me mf it nc b gy nm nh l ni nj">scala&gt; val success_rate = subscribed/totalcount</span><span id="1f32" class="me mf it nc b gy nm nh l ni nj">#output:<br/>success_rate: Double = 0.1169</span></pre><p id="0420" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">成功率在11.5%左右。</p><h2 id="06b1" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第三步:失败率</h2><p id="b077" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">失败率由未订阅该方案的人占记录总数的百分比来定义。为此，我们需要计算未订阅记录的总数和总条目数。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="81fa" class="me mf it nc b gy ng nh l ni nj">scala&gt; val not_subscribed = mydf.filter($"n" === <br/>                                        "no").count().toDouble</span><span id="2acd" class="me mf it nc b gy nm nh l ni nj">#output:<br/>not_subscribed = Double = 39922.0</span><span id="4ba9" class="me mf it nc b gy nm nh l ni nj">scala&gt; val failure_rate = not_subscribed/totalcount</span><span id="532b" class="me mf it nc b gy nm nh l ni nj">#output:<br/>failure_rate: Double = 0.8830</span></pre><p id="5344" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">失败率在88.3%左右。</p><h2 id="63d3" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">步骤4:找出人们的最小、最大和平均年龄</h2><p id="7b1c" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">有时我们使用SQL操作，要以表格的形式制作数据框，我们必须使用如下所示的相同方法:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="f075" class="me mf it nc b gy ng nh l ni nj">scala&gt; mydf.createOrReplaceTempView("banking")</span><span id="bc54" class="me mf it nc b gy nm nh l ni nj">scala&gt; sql("select min(age), avg(age), max(age) from banking").show</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/918948b66c274c4d7bd8f11c43fd0881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*Q7h150f1JhNPCtubX8UM3Q.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">获得关于年龄的结果。作者的照片</figcaption></figure><h2 id="4288" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第五步:通过客户的银行余额来观察他们</h2><p id="be86" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">分析师总是试图从不同的特征中发现洞见，以便进行分析和可视化。通过检查客户的银行余额进行分析。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="9265" class="me mf it nc b gy ng nh l ni nj">scala&gt; sql("select avg(balance), percentile_approx(balance, 0.5)<br/>                        from banking").show</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi no"><img src="../Images/81435fa2fb027d3814d985df8b38e177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-laea3TEIJKrcqYn1rDg3A.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">输出。作者的照片</figcaption></figure><h2 id="df6d" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第6步:按客户年龄查找订阅该计划的人数</h2><p id="b62a" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">非常重要的一点是，要知道哪些年龄组的人更多地参与了这项计划。结果只显示前20行。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="a908" class="me mf it nc b gy ng nh l ni nj">scala&gt; sql("select age, count(*) as age_count from banking where<br/>          y = 'yes' group by age order by age_count desc").show</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi np"><img src="../Images/5f0207db1e03a5ab9418dcc49ce3473d.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*rIfSPp_2uuaBiDFl_0IFVw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">按年龄计数输出。作者的照片</figcaption></figure><h2 id="bea0" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第七步:了解婚姻状况统计类别</h2><p id="0196" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">婚姻状况是每个数据集中的一个类别特征。scala中的这个查询给出了婚姻状况中所有类别的计数。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="6267" class="me mf it nc b gy ng nh l ni nj">scala&gt; sql("select marital, count(*) as count from banking where<br/>          y = 'yes' group by marital order by count desc").show</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/5637926b0897f6fcebae0fa298ea7a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/format:webp/1*FvmBq4ilYqkQLRElKmRdYA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">婚姻类别的计数。作者的照片</figcaption></figure><h2 id="3efa" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第八步:年龄和婚姻状况的共同影响</h2><p id="c149" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">年龄和婚姻状况的结合如何提供订阅与否的洞察力。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="420a" class="me mf it nc b gy ng nh l ni nj">scala&gt; sql("select age, marital, count(*) as subscription from <br/>            banking where y ='yes' group by age, marital order by <br/>            subscription desc").show</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/4a06a213ef4ce2cf6f9d09f690d0e60e.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*vmrP0qT6va3tVLMpR8Vr_w.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">显示前20行计数。作者的照片</figcaption></figure><h2 id="384c" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">第九步:做一点功能工程，找到订阅的正确年龄</h2><p id="5aaa" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">了解订阅客户的正确年龄，并找出订阅更多的年龄组。</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="ffee" class="me mf it nc b gy ng nh l ni nj">scala&gt; sql("select case when age&lt;25 then 'Young' when age between 25<br/>            and 60 then 'Middle age' when age &gt;=60 then 'Old' end as<br/>           age_category,count(1) from banking where y='yes' group by<br/>           age_category order by 2 desc").show</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/de1a48a0f3e58bb87cb173eee623b7b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*3upyUVU5aw8ixqb7Cn_pAw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">年龄组计数。作者的照片</figcaption></figure><p id="c32e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">年龄组的总数等于预订客户的总数。从这个问题中，我们观察到中年组的人订阅最多。</p><blockquote class="nt nu nv"><p id="a0da" class="li lj nw lk b ll lm kd ln lo lp kg lq nx ls lt lu ny lw lx ly nz ma mb mc md im bi translated"><strong class="lk jd"> <em class="it">结论:</em> </strong></p></blockquote><p id="e033" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个项目是给scala语言的基本查询。这个大数据项目包含非常好的数据，在这些数据中，我们分析了一些细微的见解以获得预测。</p><p id="0f72" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae lh" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="d375" class="oa mf it bd mg ob oc od mj oe of og mm ki oh kj mp kl oi km ms ko oj kp mv ok bi translated">推荐文章</h1><ol class=""><li id="15ee" class="ol om it lk b ll mw lo mx lr on lv oo lz op md oq or os ot bi translated"><a class="ae lh" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener"> NLP —用Python从零到英雄</a></li></ol><p id="fa02" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">2.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a></p><p id="a31a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">3.<a class="ae lh" href="https://medium.com/towards-artificial-intelligence/mysql-zero-to-hero-with-syntax-of-all-topics-92e700762c7b?source=friends_link&amp;sk=35a3f8dc1cf1ebd1c4d5008a5d12d6a3" rel="noopener"> MySQL:零到英雄</a></p></div></div>    
</body>
</html>