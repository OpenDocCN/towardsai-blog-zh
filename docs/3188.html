<html>
<head>
<title>ROC and AUC for Model Evaluation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模型评估的ROC和AUC</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/roc-and-auc-for-model-evaluation-2b4997ca6469?source=collection_archive---------0-----------------------#2022-10-07">https://pub.towardsai.net/roc-and-auc-for-model-evaluation-2b4997ca6469?source=collection_archive---------0-----------------------#2022-10-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d7a0" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">模型评估</h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/74906e15c7fe4715a7a4826fbea2d64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BBVTCOWvFqfcx4T1xpt_g.png"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">作者图片</figcaption></figure><p id="8d09" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">ROC或受试者操作特征曲线是评估二元或多类分类模型最常用的工具。与其他指标不同，它是基于类似<a class="ae lj" rel="noopener ugc nofollow" target="_blank" href="/precision-recall-curve-26f9e7984add"> <strong class="kn ja">精确召回曲线</strong> </a> <strong class="kn ja"> </strong>的预测分数而不是预测类别来计算的。在我之前的<a class="ae lj" rel="noopener ugc nofollow" target="_blank" href="/precision-recall-curve-26f9e7984add"> <strong class="kn ja">帖子</strong> </a>中，精确召回曲线的重要性被强调为如何为多类分类绘图。</p><p id="4155" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">为了理解ROC曲线，让我们通过参考混淆矩阵来快速刷新我们对二元分类问题中可能结果的记忆。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi lk"><img src="../Images/959c017ff28a75d36d84b127a0056f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JizS3zyhher-Ruwv.jpeg"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">困惑矩阵|作者图片</figcaption></figure><p id="04e8" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">ROC曲线是在不同阈值下，相对于<strong class="kn ja">假阳性率(FPR) </strong>绘制的<strong class="kn ja">真阳性率(TPR) </strong>的图。它有助于直观地了解阈值是如何影响分类器性能的。</p><p id="7fb0" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ja">真阳性率(TPR) </strong>是指某一特定类别的样本中，已经被模型预测为属于该类别的样本所占的比例。也被称为<strong class="kn ja">召回</strong>或<strong class="kn ja">灵敏度</strong>。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/4e6cbf39a1b5a35630f45c7d35cca100.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/0*-n5cfOhGYR7jVn6X.jpeg"/></div></figure><p id="bca5" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">其中TP和FN分别是真阳性和假阴性。</p><p id="e768" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ja">假阳性率(FPR): </strong>它是一个没有患病的人检测呈阳性的概率。它也被称为<strong class="kn ja">脱落率</strong>。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/7804a96599b1ac2332933638cddee960.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/0*be-jjMcTdAbMfx1C.jpeg"/></div></figure><p id="327e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">其中FP是假阳性的数量，TN是真阴性的数量。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/8b642738475c472b42764dcb4abfd055.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/0*k4dVTwXtArtVzFQT.png"/></div></figure><p id="c616" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ja"> ROC曲线</strong>也可以定义为<strong class="kn ja">灵敏度对1特异性</strong>图。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/1559a80689535c14af3d34abf99251a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/0*Q2b1ICwwMTduZO7n.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">ROC曲线|作者图片</figcaption></figure><p id="3b8f" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们来看看二元分类的ROC曲线。</p><pre class="ll lm ln lo gt lt lu lv lw aw lx bi"><span id="54d0" class="ly lz iq lu b gy ma mb l mc md">from sklearn.datasets import make_classification<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.metrics import roc_curve<br/>from sklearn.metrics import RocCurveDisplay<br/>X, y = make_classification(n_samples=500, n_classes=2,<br/>                           random_state=1)<br/>X_train, X_test, y_train, y_test = train_test_split(X, y,<br/>                                                    test_size=.2, <br/>                                                    random_state=2)<br/>lr = LogisticRegression()<br/>lr.fit(X_train, y_train)<br/>y_pred = lr.predict(X_test)<br/>y_pred_prob = lr.predict_proba(X_test)<br/>y_pred_prob = y_pred_prob[:,1]<br/>fpr, tpr, threshold = roc_curve(y_test, y_pred_prob)<br/>plt = RocCurveDisplay(fpr=fpr, tpr=tpr)<br/>plt.plot()</span></pre><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi me"><img src="../Images/f016b4c2413a4bc05fb6ccd8affad757.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/0*0EoJzjK6oSx9s84O.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">ROC曲线|作者图片</figcaption></figure><p id="992a" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ja"> AUC得分</strong></p><p id="f970" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">AUC代表“曲线下面积”，它是通过任何图下面积计算的梯形规则计算的。它将ROC曲线总结为二元分类和多类别模型中每个类别的单一指标。然而，为了将多类总结为单个度量，可以使用微观、宏观和加权AUC。</p><p id="f3b3" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">AUC越高，分类器越好。其值在0(最差模型)和1(理想模型)之间波动。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/eafaa3eb709f79d49403577d9ada8be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/0*j0VBYWz2fRk9hAuF.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">ROC AUC |作者图片</figcaption></figure><pre class="ll lm ln lo gt lt lu lv lw aw lx bi"><span id="de40" class="ly lz iq lu b gy ma mb l mc md">from sklearn.metrics import roc_auc_score<br/>auc = roc_auc_score(y_test, y_pred_prob)<br/>print(auc)</span><span id="f418" class="ly lz iq lu b gy mg mb l mc md"><strong class="lu ja">Output:<br/></strong>0.9727017262143718</span></pre><p id="9659" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们看看如何使用sklearn库在随机分类数据集上绘制ROC曲线和计算AUC分数。</p><pre class="ll lm ln lo gt lt lu lv lw aw lx bi"><span id="810a" class="ly lz iq lu b gy ma mb l mc md">plt = RocCurveDisplay(fpr=fpr, tpr=tpr, roc_auc=auc)<br/>plt.plot()</span></pre><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/907739db5c4ddad85037832e94374090.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/0*bT3ViF1GV1bgbttm.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">带AUC的ROC曲线|图片由作者提供</figcaption></figure><p id="4a04" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ja">为什么是ROC曲线？</strong></p><p id="159b" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">ROC是根据精度分数计算的，而许多度量标准(如准确度和精度)都是根据预测类来计算的。这是在<strong class="kn ja">敏感性(TPR) </strong>和<strong class="kn ja">1-特异性(FPR)</strong>之间的权衡，允许人们选择在TPR和FPR之间保持平衡的阈值，这适合特定的问题。</p><p id="488f" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">绘制ROC曲线对二元问题来说是小菜一碟。然而，计算多类分类令专业人员望而却步。以下是绘制多类ROC和AUC的方法。</p><p id="ccb8" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><em class="mi">下面是为多类分类问题创建和绘制ROC和AUC的python代码。</em></p><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="mj mk l"/></div></figure><pre class="ll lm ln lo gt lt lu lv lw aw lx bi"><span id="a418" class="ly lz iq lu b gy ma mb l mc md">from sklearn.datasets import make_classification<br/>from sklearn.preprocessing import label_binarize<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.multiclass import OneVsRestClassifier</span><span id="aa27" class="ly lz iq lu b gy mg mb l mc md"># Load Dataset<br/>X, y = make_classification(n_samples=500, n_classes=3,<br/>                           random_state=1, n_informative=3)<br/>y = label_binarize(y, classes=[0,1,2])<br/>X_train, X_test, y_train, y_test = train_test_split(X, y,<br/>                                                    test_size=.5,<br/>                                                    random_state=1)<br/>lr = LogisticRegression()<br/>ovr = OneVsRestClassifier(lr)<br/>ovr.fit(X_train, y_train)<br/>y_pred = ovr.predict(X_test)<br/>y_pred_prob = ovr.predict_proba(X_test)<br/>fpr, tpr, threshold, auc, labels = roc_auc_curve(y_test,<br/>                                                 y_pred_prob, <br/>                                                 labels=[0,1,2])<br/>roc_auc_curve_plot(fpr, tpr, threshold, auc, labels)</span></pre><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/2a3b271880e80d827702117465725be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/0*UxlcakQsbATdoLR-.png"/></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk translated">作者多类|图像的ROC曲线</figcaption></figure><p id="04e7" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ja">参考文献:</strong></p><p id="0d13" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">[1] ROC曲线。<a class="ae lj" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . metrics . roc _ curve . html</a></p><p id="452b" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">[2] AUC。<a class="ae lj" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.auc.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . metrics . AUC . html</a></p><p id="ce5e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">[3]精确召回曲线。<a class="ae lj" rel="noopener ugc nofollow" target="_blank" href="/precision-recall-curve-26f9e7984add">https://pub . toward sai . net/precision-recall-curve-26f9e 7984 add</a></p></div></div>    
</body>
</html>