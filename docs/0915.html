<html>
<head>
<title>Survival Analysis with Python Tutorial — How, What, When, and Why</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python生存分析教程-方法、内容、时间和原因</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/survival-analysis-with-python-tutorial-how-what-when-and-why-19a5cfb3c312?source=collection_archive---------0-----------------------#2020-09-11">https://pub.towardsai.net/survival-analysis-with-python-tutorial-how-what-when-and-why-19a5cfb3c312?source=collection_archive---------0-----------------------#2020-09-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/66ec52d694701cb0421384037a398eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YdXg2XF7u7AX2AkaI4x_KQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://unsplash.com/photos/rHfsPolwIgk" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><h2 id="99f7" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，<a class="ae ep" href="https://towardsai.net/p/category/editorial" rel="noopener ugc nofollow" target="_blank">编辑</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a>，<a class="ae ep" href="https://towardsai.net/p/category/statistics" rel="noopener ugc nofollow" target="_blank">统计</a></h2><div class=""/><div class=""><h2 id="ca9b" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">使用Python进行生存分析Python是一个统计分支，用于预测和计算一个或多个重大事件发生的预期持续时间。</h2></div><p id="8398" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">作者:</strong> <a class="ae jg" href="https://www.linkedin.com/in/pratik-shukla28/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jt">普拉蒂克·舒克拉</strong> </a></p><p id="a68e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后更新，2021年1月8日</p><div class="is it gp gr iu md"><a href="https://members.towardsai.net/" rel="noopener  ugc nofollow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jt gy z fp mi fr fs mj fu fw js bi translated">加入我们吧↓ |面向人工智能成员|数据驱动的社区</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">加入人工智能，成为会员，你将不仅支持人工智能，但你将有机会…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">members.towardsai.net</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr ja md"/></div></div></a></div><p id="a197" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi ms translated"><span class="l mt mu mv bm mw mx my mz na di"> T </span>这篇文章广泛回顾了如何执行统计生存分析的详细步骤和代码，统计生存分析用于调查某个事件发生所需的时间，例如新冠肺炎疫情期间的患者生存时间、工程产品的故障时间，甚至是首次联系客户后完成销售的时间。</p><p id="8bf2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">本教程的代码可在</strong><a class="ae jg" href="https://github.com/towardsai/tutorials/tree/master/survival_analysis_in_python" rel="noopener ugc nofollow" target="_blank"><strong class="lj jt">Github</strong></a><strong class="lj jt">上获得，其完整实现可在</strong><a class="ae jg" href="https://colab.research.google.com/drive/1zc6uf91Gw3bkrieJCzfDAzya16qvOHOV?usp=sharing" rel="noopener ugc nofollow" target="_blank"><strong class="lj jt">Google Colab</strong></a><strong class="lj jt">上获得。</strong></p><h2 id="e3f6" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">目录:</h2><ol class=""><li id="248b" class="nt nu jj lj b lk nv ln nw lq nx lu ny ly nz mc oa ob oc od bi translated">生存分析基础</li><li id="011f" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">卡普兰-迈耶钳工理论与实例。</li><li id="ed21" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">尼尔森-艾伦钳工理论与实例。</li><li id="8ee0" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">基于不同群体的卡普兰-迈耶钳工。</li><li id="dfa2" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">对数秩检验及实例。</li><li id="c6dd" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">Cox回归分析及实例。</li><li id="7ae0" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">资源。</li></ol><blockquote class="oj"><p id="4b11" class="ok ol jj bd om on oo op oq or os mc dk translated">📚查看我们用Python编写的<a class="ae jg" href="https://towardsai.net/p/machine-learning/monte-carlo-simulation-an-in-depth-tutorial-with-python-bcf6eb7856c8" rel="noopener ugc nofollow" target="_blank">蒙特卡洛模拟教程</a>📚</p></blockquote></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="7a03" class="pa nc jj bd nd pb pc pd ng pe pf pg nj ky ph kz nm lb pi lc np le pj lf ns pk bi translated">1.生存分析基础:</h1><p id="ba65" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated"><strong class="lj jt">生存分析</strong>是一套统计方法，用于确定感兴趣的事件发生所需的时间。我们使用生存分析来研究某个有趣的<strong class="lj jt">事件</strong>发生之前的<strong class="lj jt">时间</strong>。时间通常以年、月、周、日和其他时间度量单位来度量。感兴趣的事件可以是任何感兴趣的事情。可能是真正的死亡，出生，退休，还有其他的。</p><p id="3a6e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">例如，生存分析如何有助于分析正在进行的新冠肺炎疫情数据？</strong></p><ol class=""><li id="68db" class="nt nu jj lj b lk ll ln lo lq po lu pp ly pq mc oa ob oc od bi translated">我们可以找到病人出现新冠肺炎症状的天数。</li><li id="e7b7" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">我们可以发现哪个年龄段的人更容易死亡。</li><li id="ed28" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">我们可以找到哪种治疗方法的生存概率最高。</li><li id="bcf8" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">我们可以发现一个人的性别是否对他们的生存时间有显著影响？</li><li id="50ad" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">我们可以找到病人存活天数的中位数。</li><li id="075c" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">我们可以发现哪个因素对患者的存活率影响更大。</li></ol><p id="02f3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本教程中，我们将对<strong class="lj jt">肺癌患者进行全面分析。如果看起来很复杂，不要担心。一旦我们通过了背后的逻辑，我们将有能力对任何数据集进行生存分析。<strong class="lj jt">激动人心！不是吗？</strong></strong></p><p id="2fec" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">生存分析</strong>用于各种领域，例如:</p><ul class=""><li id="946a" class="nt nu jj lj b lk ll ln lo lq po lu pp ly pq mc pr ob oc od bi translated">癌症研究对患者生存时间的分析。</li><li id="3f6f" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">社会学<em class="ps"> </em>为“事件历史分析”</li><li id="97b3" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">工程中的“故障时间分析”</li><li id="2724" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">产品失效前的时间。</li><li id="661f" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">保修索赔前的时间。</li><li id="0fa0" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">流程达到临界水平的时间。</li><li id="3312" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">从最初的销售接触到销售的时间。</li><li id="7aa0" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">从雇用员工到解雇或辞职的时间。</li><li id="766c" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc pr ob oc od bi translated">从销售人员受雇到第一次销售的时间。</li></ul><p id="dcab" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在<strong class="lj jt">癌症研究</strong>中，典型的研究问题是:</p><ol class=""><li id="ff89" class="nt nu jj lj b lk ll ln lo lq po lu pp ly pq mc oa ob oc od bi translated">特定的临床特征对患者的存活率有什么影响？比如血糖偏高的人和不偏高的人有区别吗？</li><li id="5d04" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">一个人存活特定时间(年、月、天)的概率是多少？例如，给定一组癌症患者，我们会告诉，如果在癌症诊断通过300天后，那么那个人当时活着的概率将是0.7。</li><li id="8042" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">不同组患者的存活率有差异吗？例如，假设有两组人被诊断患有癌症。这两组人接受了两种不同的治疗。我们在这里的目标将是找出基于他们被给予的治疗，这两个不同组的存活时间之间是否有显著差异。</li></ol><h2 id="6d4e" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">目标</h2><p id="c42d" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">在本教程中，我们将详细看到以下生存分析方法:</p><p id="1754" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="ps"> 1) </em> <strong class="lj jt"> <em class="ps">卡普兰-迈耶图</em> </strong>可视化生存曲线。</p><p id="45fd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> <em class="ps"> 2)尼尔森-艾伦图</em> </strong>可视化累积危害。</p><p id="71c8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> <em class="ps"> 3)对数秩检验</em> </strong>比较两组或多组的生存曲线</p><p id="75d9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> <em class="ps"> 4) Cox比例风险回归</em> </strong>找出年龄、性别、体重等不同变量对生存的影响。</p><h2 id="c4e3" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">基本概念</h2><p id="cac4" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">我们将从理解一些与生存分析相关的基本定义和概念开始本教程。</p><h2 id="0d11" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">癌症研究中的存活时间和事件类型</h2><p id="0e66" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated"><strong class="lj jt">存活时间:</strong>通常指受试者存活或积极参与调查的时间。</p><p id="a320" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在生存分析中有三种主要的事件类型:</p><p id="5332" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 1)复发:</strong>复发被定义为受试者的健康状态在暂时改善后恶化。</p><p id="5df7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)进展:</strong>进展定义为逐渐向更高级状态发展或移动的过程。它基本上意味着被观察对象的健康状况正在改善。</p><p id="a3d3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)死亡:</strong>死亡定义为某物的毁灭或永久终结。在我们的例子中，死亡将是我们感兴趣的事件。</p><h2 id="34f4" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">审查</h2><p id="3109" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">正如我们上面讨论的，生存分析集中在感兴趣的事件的发生上。感兴趣的事件可以是任何事情，如出生、死亡或退休。然而，我们感兴趣的事件仍有可能不会发生。这种观察被称为截尾观察。</p><p id="621a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有三种类型的审查:</p><ol class=""><li id="8b2d" class="nt nu jj lj b lk ll ln lo lq po lu pp ly pq mc oa ob oc od bi translated">权利审查:被审查对象还活着。在这种情况下，当我们感兴趣的事件(死亡)发生时，我们不能有我们的时间。</li><li id="06cb" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated"><strong class="lj jt">左删截:</strong>在这种删截类型中，事件由于某种原因无法观察到。它也可能包括实验开始前发生的事件，比如孩子从出生开始走路的天数。</li><li id="442d" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated"><strong class="lj jt">区间删截:</strong>在这种类型的数据删截中，我们只有特定区间的数据，因此有可能感兴趣的事件在那段时间没有发生。</li></ol><p id="1ec4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在以下情况下可能会进行审查:</p><ol class=""><li id="6b72" class="nt nu jj lj b lk ll ln lo lq po lu pp ly pq mc oa ob oc od bi translated">患者在一段时间内(尚未)经历感兴趣的事件(死亡或复发)。</li><li id="ca22" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">一个病人不再被跟踪。</li><li id="82b8" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">如果患者搬到另一个城市，那么医院工作人员可能无法进行随访。</li><li id="eb83" class="nt nu jj lj b lk oe ln of lq og lu oh ly oi mc oa ob oc od bi translated">我们只有特定时间段的数据。</li></ol><h2 id="5e03" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">生存和危险函数</h2><p id="5362" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">我们通常使用两个相关的概率来分析受试者的生存数据。</p><p id="114e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">1)生存函数</p><p id="ee45" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">2)危险函数(H)</p><p id="17a8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了找到受试者的生存概率，我们将使用生存函数S(t)，Kaplan-Meier估计量。存活函数被定义为个体(受试者)从时间起点(疾病诊断)存活到指定的未来时间t的概率。请注意，时间可以是各种形式，如分钟、天、周、月或年。例如，S(200)=0.7表示200天后，受试者的存活概率为0.7。在许多致命疾病中，存活概率随着周期的增加而降低。如果受试者在实验结束时还活着，那么数据将被审查。</p><p id="cfdf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">用H(t)表示的危险概率是在时间t被观察的个体(受试者)在该时间发生事件(死亡)的概率。例如，如果h(200) = 0.7，表示200天后或第200天，死亡的概率为0.7。这里需要记住的一点是，风险函数给出了累积概率。我们将在本教程的后面详细讨论这一点。</p><p id="c518" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">请注意，与关注受试者生存的生存函数相比，风险函数给出了受试者在给定时间死亡的概率。我们可以注意到，较高的生存概率和较低的危险概率对受试者的健康有益。</p><h2 id="0886" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">让我们前进到酷的编码部分！</h2><blockquote class="oj"><p id="4b29" class="ok ol jj bd om on pt pu pv pw px mc dk translated">从<a class="ae jg" href="http://www-eio.upc.edu/~pau/cms/rdata/datasets.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> UPC </strong> </a>下载公共数据集。</p></blockquote><h2 id="9e10" class="nb nc jj bd nd ne py dn ng nh pz dp nj lq qa nl nm lu qb no np ly qc nr ns jp bi translated">数据描述:</h2><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qd"><img src="../Images/a5d9d576d86c391b2ea99f1096f19070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ugUZd0upXtV0tkqw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图1:数据描述值。</figcaption></figure><h1 id="782b" class="pa nc jj bd nd pb qi pd ng pe qj pg nj ky qk kz nm lb ql lc np le qm lf ns pk bi translated">2.卡普兰-迈耶估计理论与实例</h1><p id="883f" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated"><strong class="lj jt">卡普兰-迈耶估计量</strong>是一种非参数统计，用于根据生命周期数据估计生存函数(一个人存活的概率)。在医学研究中，它通常用于测量患者在治疗或诊断后存活特定时间的比例。例如:计算特定患者在被诊断患有癌症或开始治疗后的存活时间(年、月、日)。估计者以爱德华·l·卡普兰和保罗·梅尔的名字命名，他们向美国统计协会杂志提交了类似的手稿。</p><p id="4b75" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">用S(ti)表示的时间ti的生存概率计算如下:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qn"><img src="../Images/4a52a8d8b87d20f44e527a17832cfb8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*V6RQL-kU3hGbJocq.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图2:计算t1时刻生存概率的公式。</figcaption></figure><p id="239a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们也可以将上面的等式写成如下的简单形式:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/392bb02deb530fd6257ad12814137f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*JrQdEAFQE2rzGFjp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图3:简单形式的生存时间概率S(ti)。</figcaption></figure><p id="748d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><p id="5a85" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 1)时间t=1时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/7403aa7632b9010c6a2516e60508958e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/0*AM-Y6-iZh4YfeBC2.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图4:t = 1时的生存概率公式</figcaption></figure><p id="ae24" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)时间t=2时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qq"><img src="../Images/32524795c2602e14e75e70d8e52f4873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*9pgHU3_-9psIWt7w.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图5:t = 2时的生存概率公式</figcaption></figure><p id="56b4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)时间t=3时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qn"><img src="../Images/c5ab11a45fc7a31e6be1cdb899dd6e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*AXH3_HT8d3zP8zQi.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图6:t = 3时的生存概率公式</figcaption></figure><p id="9ba7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在更一般的情况下，特定时间的生存概率由下式给出。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/b8321593a86f8fe2535117780af3f3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*QxM7JLZo_UrVQnSO.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图7:特定时间内生存概率的通用公式。</figcaption></figure><p id="401c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从上面的等式，我们可以自信地说。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qs"><img src="../Images/d13ed50859e76980ab8d551230ce6f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/0*iCQaabrQj1FI9t7y.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图8:表达生存泛化。</figcaption></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h2 id="4501" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">卡普兰-迈耶估计量(无任何分组)</h2><p id="b55f" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated"><strong class="lj jt"> 1)导入所需的库:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qt"><img src="../Images/61e843ce8dd56ecb625bdcb040948780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/0*kbDkcXH8-22jNG2R.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图9:导入熊猫、numpty、matplotlib.pyplot和生命线。</figcaption></figure><p id="9f93" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)读取数据集:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qu"><img src="../Images/ce1672a73fd4392eca42c28472a92bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*raFjrpMpbwF5h1dC.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图10:读取数据集。</figcaption></figure><p id="5497" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)打印数据集中的列:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/5cc17f57f71382d97d0535fdb90ab3b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/0*5IgyvsxXUdAtXRmR.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图11:打印数据列。</figcaption></figure><p id="9eaa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 4)获取关于数据集的附加信息:</strong></p><p id="4daa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">它为我们提供了关于列的数据类型及其空值计数器的信息。对于一些生存分析方法，我们需要删除具有空值的行。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qw"><img src="../Images/00c487b33c5ff0d5cc18386ea350d59b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7QuEOqdeAOzbQoXa.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图12:关于我们数据集的附加信息。</figcaption></figure><p id="4a13" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 5)获取数据集的统计信息:</strong></p><p id="f237" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">它为我们提供了一些统计信息，如总行数、平均值、标准偏差、最小值、第25个百分点、第50个百分点、第75个百分点以及每列的最大值。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qx"><img src="../Images/49855ca49b54a0771496eaf4611df1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FkBnm8ZGBlp1UKKg.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图13:获取数据集的统计信息。</figcaption></figure><p id="998d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 6)使用直方图找出性别分布:</strong></p><p id="a935" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这让我们对我们的数据是如何分布的有了一个大致的概念。在下图中，我们可以看到大约139个值的状态为1，大约90个值的状态为2，这意味着在我们的数据集中有139名男性和大约90名女性。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qy"><img src="../Images/00fa0c88ed0638294bd48f5a04fe8f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/0*_5fFtvO5WCDgKJBt.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图14:绘制患者性别的直方图。</figcaption></figure><p id="3203" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 7)为卡普兰-迈耶-钳工创建一个对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qz"><img src="../Images/2f15fbf92b0b724b2dd08ee5fa0c14ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/0*xNnmy9-4H9YD0CVS.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图15:为Kaplan-Meier-Fitter创建一个对象。</figcaption></figure><p id="a2d1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 8)组织数据:</strong></p><p id="2497" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在我们需要组织我们的数据。我们将在数据集中添加一个名为“dead”的新列它存储了关于作为我们实验一部分的人是死是活的数据(基于状态值)。如果我们的状态值是1，那么这个人还活着，如果我们的状态值是2，那么这个人已经死了。这是我们下一步需要做的关键一步，因为我们将把我们的数据存储在名为审查和观察的列中。其中，观察数据存储特定时间线内死亡人员的值，而删截数据存储活着的人或我们不打算调查的人的值。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ra"><img src="../Images/9753b1ed1335eb4660fa90a83c4b4427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aDoK-cEhmPsKfy8z.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图16:组织我们的数据。</figcaption></figure><p id="8ebe" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 9)将我们的数据放入一个对象:</strong></p><p id="85ae" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这里，我们的目标是找出病人在死亡前存活的天数。我们感兴趣的事件将是“死亡”，它存储在“死亡”列中。第一个参数是我们实验的时间表。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rb"><img src="../Images/f7893e29944fb28060473390e9f2a897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7QSva6gxDEtVZasw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图17:在我们的对象中拟合参数值。</figcaption></figure><p id="c620" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 10)生成事件表:</strong></p><p id="1640" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">kmf对象最重要的方法之一是“event_table”它为我们的生存分析提供了各种信息。让我们一栏一栏地看一下。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rc"><img src="../Images/e845d08b6c0ef8de85f7c87f07723820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MgQArAfcI48OYh9P.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图18:打印事件表。</figcaption></figure><p id="d884" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">a) event_at: 它为我们的数据集存储时间线的值。即在我们的实验中观察患者的时间或进行实验的时间。它可以是几分钟、几天、几个月、几年等等。在我们的情况下，这将是很多天。它存储了受试者的存活天数。</p><p id="0189" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b) at_risk: </strong>存储当前正在观察的患者数量。开始时，这将是我们在实验中要观察的病人总数。如果在特定的时间增加了新的患者，那么我们必须相应地增加他们的价值。因此:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rd"><img src="../Images/75f96ee0359ba1625b37bd4c4f6b2a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/0*GP3KDMNvEGNJrY-F.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图19:风险变量公式。</figcaption></figure><p id="efd0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> c)入口:</strong>存储给定时间线内新患者的值。有可能在做实验的同时，其他患者也被诊断出患有这种疾病。为了说明这一点，我们有入口栏。</p><p id="092f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们的最终目标是找到病人的生存概率。在实验结束时，如果这个人还活着，我们会把他/她加入到审查类别中。我们已经讨论了审查的类型。</p><p id="280b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> e)观察:</strong>存储实验过程中死亡的受试者人数的值。从广泛的角度来看，这些人遇到了我们感兴趣的事件。</p><p id="f49a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> f)已删除:</strong>它存储不再是我们实验一部分的患者的值。如果一个人死了或者被审查了，那么他/她就属于这一类。简而言之，它是观察数据和删失数据的补充。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi re"><img src="../Images/d808055c0c1f34b5be1a59c4a5ea9c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/0*KKEvs8UlER8gDHLe.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图20:移除变量公式。</figcaption></figure><p id="d44b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 11)计算各个时间线的生存概率:</strong></p><p id="8648" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们先来看特定人在给定时间的生存计算公式。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rf"><img src="../Images/542b340f3912802d4442d8e383db4d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*D_vw1mZ133xmyiSU.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图21:计算个体时间线的存活概率。</figcaption></figure><p id="508c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> a)仅在t=0时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rg"><img src="../Images/6391bff4305c23cae73e7afc1b5c837b.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/0*hMf8AV0KIrqdElTn.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图22:计算t=0的生存概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rd"><img src="../Images/7f34135f9ab245e7247bd069cf22ce43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/0*zyv55butF345EyFF.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图23:计算给定时间和t=0的生存概率。</figcaption></figure><p id="e0ca" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b)仅在t=5时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rh"><img src="../Images/44498f1fdb61c0cdc12325fd6735aae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/0*Ue8DnWkV40yifyWl.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图24:t = 5的生存概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ri"><img src="../Images/dd83cc1b4c43e80e268feaa42889097b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*EBlSwXHujLppHi2c.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图25:计算给定时间内的生存概率。</figcaption></figure><p id="2e85" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> c)仅在t=11时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rj"><img src="../Images/7e5c26ac4537ea263476ef72f79dd020.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/0*DxaDE14eQLgnk4Bl.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图26:t = 11时的生存概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rk"><img src="../Images/9f01b4b7a688e5f25b0d9b90793faced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*c-kOobq3INagmcWa.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图27:计算给定时间的生存概率。</figcaption></figure><p id="baa6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在我们发现的是特定时间的概率。我们想要的是病人在整个时间内的概率。即患者在所有实验中存活的概率。</p><p id="8148" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">简而言之，我们想知道一个人在被诊断后存活的概率。我们刚刚发现的只是一个特定实验的概率。</p><p id="3301" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们举一个简单的例子来理解条件概率的概念。例如，我们在一个不透明的盒子里总共有15个球。在15个球中，我们有7个黑球，5个红球和3个绿球。这是一个图示。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rl"><img src="../Images/0e83e2ed0ea59eb4bc7f20a4c89fa0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/0*AGvyWaoSn46XJT8e.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图28:球图形示例。</figcaption></figure><p id="3787" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> a)选择红球的概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/c4fbbbad242d0a67ffef0ef7eb5d53cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*hX7sHrpNipeylsUS.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图29:选择红球的概率。</figcaption></figure><p id="5c11" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b)选择第二个红球的概率:</strong></p><p id="0f72" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">因为我们拿走了一个红色的球，所以红色球的总数是4，球的总数是14。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/fa9f49238b24c313bddb48a8dfc092f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*nsrrq4-4vJmE7tPj.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图30:选择第二个红球的概率。</figcaption></figure><p id="dd73" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果我们的问题是找出两个球都是红色的概率，我们将乘以它，这正是我们在生存分析中要做的。我们知道一个病人在第一个时间间隔内存活了下来，假设他在第一个时间间隔内存活了下来，我们想知道他在第二个时间间隔内存活的概率。我在这里的观点是，我们不希望只找到第二个时间间隔的概率。我们想知道他在整个过程中存活的总概率。</p><p id="7003" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们的例子中，两个球都是红色的概率如下:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/e4738acbe72f312b4b0c190e86b910ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*2Bme43OBPJk_1agG.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图31:计算两个球都是红色的概率。</figcaption></figure><p id="e360" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在生存分析中，我们可以把公式写成如下:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rm"><img src="../Images/51a956808ccf3b3bd0741457658769e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*J0ItPyNiWo7vUbAR.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图32:计算S(n)。</figcaption></figure><p id="e16c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 12)寻找生存概率:</strong></p><p id="5442" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们想找出一个病人在所有时间线中存活到现在的概率。现在我们需要找到病人的实际存活概率。</p><p id="8b9f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">a)t = 0时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rm"><img src="../Images/ed37bee015fca1661b2bbc4321e06e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*v_AyiR7V_-yaa0N0.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图33:计算t=0的生存概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rn"><img src="../Images/977946c50252c0558103154f8711f90a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/0*mwZ7_-vqHF_KJgxC.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图34:计算给定时间的实际生存概率。</figcaption></figure><p id="3f75" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">b)t = 5时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qr"><img src="../Images/0a481e9226a59a427a4a1871688205f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/0*gwDTUane_9yI8fHP.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图35:计算t=5的生存概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ro"><img src="../Images/ee8f137b920750991384bfeb4d1d35e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/0*F7-QNRy01K2vinMf.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图36:</figcaption></figure><p id="5721" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">c)t = 11时的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/5ff3ab41eb14402376545b0537941acd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*4CQCfPMgjXY1-bd3.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图37:计算t=11的生存概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rp"><img src="../Images/50e3f0e1fa791ef48202a944ba8cf04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/0*27t3M-BgDQ4niEXm.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图38:计算给定时间的实际生存概率。</figcaption></figure><p id="a452" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 13)预测概率:</strong></p><p id="ab7d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在kmf对象的预测函数为我们做了所有这些工作。然而，了解其背后的逻辑始终是一种很好的做法。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rq"><img src="../Images/810cdb065686714b2c425fe5633edc85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/0*ORgQwaLDgICHLz4g.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图39:以简单的方式显示概率值。</figcaption></figure><p id="4886" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 14)寻找时间线数组的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qq"><img src="../Images/d99e7fde69395198382612f07657b971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*J8z33enPcWoWkfWx.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图40:预测一组值的生存概率。</figcaption></figure><p id="4c8e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 15)获取整个时间线的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rr"><img src="../Images/890162879527af9a0898752b1469557c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/0*v9yOaZg7_YcPRmHV.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图41:获得整个时间线的生存概率。</figcaption></figure><p id="e155" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">患者在时间线0的生存概率是1。抓住我们的想法，然后我们得出一个人在确诊的第一天死亡的概率接近等于0。所以我们可以说生存概率越大越好。随着时间线的增加，患者的存活概率降低。</p><p id="3796" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 16)绘制图表:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qw"><img src="../Images/61491140fb952c06005bdc8c92e77d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IOAuvTpySORPj2lV.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图42:绘制生存概率。</figcaption></figure><p id="59a6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 17)存活天数中位数:</strong></p><p id="b531" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">它提供了平均50%的患者存活的天数。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rs"><img src="../Images/e06c6b6a208b781cf33ee5d7b0558b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/0*lj1woUNVUn86a18_.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图43:显示平均天数。</figcaption></figure><p id="9efa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从上面的代码，我们可以说，平均来说，一个人在确诊后活了310天。</p><p id="8ed3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 18)有置信区间的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rr"><img src="../Images/dd4b0632511cc3cf70e1f5b9f92e22e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/0*-KuPLFs7J7c7o982.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图44:用置信区间估计生存概率。</figcaption></figure><p id="a994" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 19)有置信区间的生存概率图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qz"><img src="../Images/0a9444b9a08ba46e5c2f30ec89efe73d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/0*uflsOnndjb7iU-HK.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图45:用置信区间绘制生存函数。</figcaption></figure><p id="7c48" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在我们所有的信息都是为了一个人的生存。现在我们来看看一个人在特定时间线死亡的概率是多少。这里注意，较高的生存概率适合一个人，但较高的累积密度(一个人死亡的概率)就不那么好了！</p><p id="c476" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 20)一个人死亡的概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rt"><img src="../Images/a811047c16d30d828ca76f19880f57fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/0*Ka7vE2WMqxEGUILy.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图46:一个人死亡的概率。</figcaption></figure><p id="e3bd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">此处，前一行中的分母值有风险。</p><p id="0683" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">累积密度的公式:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/228a96571f734c02d828aa9af16411be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*80GyCe7nPSeUL1ud.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图47:累积密度的公式。</figcaption></figure><p id="0239" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">a)一个人在t=0时死亡的概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qo"><img src="../Images/b4abf4f8ee71fe2aeea669ea54d5838a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*89bKH8682ryxuceU.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图48:一个人在t=0时死亡的概率。</figcaption></figure><p id="f70a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">b)一个人在t=5时死亡的概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ru"><img src="../Images/ebdf39d91b7f03584d8a9a4a2d3d937b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/0*vfAtW35-CFGdaLW4.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图49:一个人在t=5时死亡的概率。</figcaption></figure><p id="3f79" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">c)一个人在t=11时死亡的概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rv"><img src="../Images/a19ad267a65ea361fbb5c53fa4b1e0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*PZsmDg5V1KKcPlJi.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图50:一个人在t=11时死亡的概率。</figcaption></figure><p id="6430" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">求累积密度:</p><p id="d86a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">d)t = 0时的累积密度:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rw"><img src="../Images/bdf3297930371f0ab4837988655799a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LF5PMnOH14LnLVqQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图51:计算t=0时的累积密度。</figcaption></figure><p id="471b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">e)t = 5时的累积密度:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qd"><img src="../Images/7663fda08b0b5dd14c5a9a623df3f3ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SAP2EuLc88DVN5Tp.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图52:计算t=5时的累积密度。</figcaption></figure><p id="b48f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">f)t = 11时的累积密度:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rx"><img src="../Images/073c061fc67bbae7d45d82610a83a943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Y_GkeMxMRX--Tnm3.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图53:计算t=11时的累积密度。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rd"><img src="../Images/a628bedbf5f007ef855741c422e0f351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/0*4Nr0N36pgy6_HxX6.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图54:显示受试者死亡的概率。</figcaption></figure><p id="c7d9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 21)绘制累积密度图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ry"><img src="../Images/5936b20cfa013a7003610604765961bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CKOpIDzo2xr4Kqbo.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图55:绘制累积密度。</figcaption></figure><p id="812c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">请注意，随着存活天数的增加，一个人死亡的概率也会增加。</p><p id="f336" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 22)具有置信区间的累积密度:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rz"><img src="../Images/ebbb5cc39cfd1c6315332398844e92d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/0*UwODl1v8AjJYu6bk.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图56:用置信区间计算累积密度。</figcaption></figure><p id="a857" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 23)带有置信区间的累积密度图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sa"><img src="../Images/46c4eabe0724d4cec7591bf72bfeb8f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cj-e8c7ZyeD-dToO.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图57:用置信区间绘制累积密度。</figcaption></figure><p id="00fe" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 24)获取特定一天的累积密度:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sb"><img src="../Images/079eb8ea50526eb8ebd11747f5ad4228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3RQ11BcM_F2PsLKH.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图58:找出特定时间的累积密度。</figcaption></figure><p id="c444" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 25)事件的平均时间:</strong></p><p id="05da" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以从平均存活时间得到剩余的时间。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sc"><img src="../Images/1042f3000c92940fe0114ec541cfeb32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vd0f-AMqexXRxALg.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图59:计算感兴趣事件的条件中值时间。</figcaption></figure><p id="4a3c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 26)事件中值时间图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rw"><img src="../Images/f7dd1d9f80bb997a8ff256c8045f2573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EDi__g0oaoJqwlvk.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图60:绘制事件的中值时间图。</figcaption></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="deaf" class="pa nc jj bd nd pb pc pd ng pe pf pg nj ky ph kz nm lb pi lc np le pj lf ns pk bi translated">3.使用Nelson-Aalen评估风险率</h1><h2 id="4084" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">危险函数H(t):</h2><p id="444c" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">到目前为止，我们讨论了卡普兰-迈耶生存函数。利用这一点，我们可以得到感兴趣的事件(在我们的例子中是死亡)到那时不发生的概率。生存函数是总结和可视化生存数据集的好方法；然而，这不是唯一的方法。我们可以使用Nelson-Aalen风险函数h(t)来可视化关于存活率的总体信息。风险函数h(t)给出了在时间t接受观察的对象在该时间发生感兴趣的事件(死亡)的概率。为了得到关于风险函数的信息，我们不能转换Kaplan-Meier估计量。为此，<em class="ps">累积</em>风险函数有一个合适的非参数估计量:</p><p id="c80f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">累积危险函数:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ro"><img src="../Images/48cf1e5144befa36c2257ae65e9855c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/0*HWZQDWmqbS2m7dAj.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图61:累积风险函数的计算公式。</figcaption></figure><p id="ef95" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 1)导入所需库:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sd"><img src="../Images/f548d17e56701eaf920879bf7e6f0baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/0*u1SYUH1o6bAjJFXp.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图62:从生命线导入NelsonAalenFitter。</figcaption></figure><p id="8306" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)创建一个尼尔森-艾伦-菲特的对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi se"><img src="../Images/b79abf92efd18a42f48dd2bde7dd1e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/0*6F20gnOH2r-EpzGv.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图63:创建一个Nelson-Aalen-Fitter对象。</figcaption></figure><p id="30bd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)拟合数据:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sf"><img src="../Images/48df3a125d9d64d188d0d333a5c9b9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fl6aIAphekw3UD11.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图64:将数据放入对象中。</figcaption></figure><p id="f3dd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 4)寻找累积危险:</strong></p><p id="e22b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，我们将使用上一部分中生成的事件表来理解hazard函数实际上是如何工作的。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sg"><img src="../Images/567bf342536a5a83ac4bc38272337c6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/0*A7huTbwoSfPgVhjy.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图65:寻找累积危险。</figcaption></figure><p id="d54d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面是计算特定时间非累积风险概率的公式:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sh"><img src="../Images/20bd04732ffe3891a97d035979095da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ywBrMV_dOz1WbKLi.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图66:计算特定时间非累积危险概率的公式。</figcaption></figure><p id="c041" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">a)找出t=0时的危险概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sh"><img src="../Images/08feb99a19d5042d1b4a50f1103e0436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KFLNRz9a6AnWA2ya.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图67:找出t=0时的危险概率。</figcaption></figure><p id="2408" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">b)找出t=5时的危险概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rx"><img src="../Images/c61858b04600e3ea425115f0356819f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*seH-z66xTFTD23ac.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图68:找出t=5时的危险概率。</figcaption></figure><p id="a5dd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">c)找出t=11时的危险概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rx"><img src="../Images/821e38726ea7d864bf569e4a7d51de9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yLYjkVKccJgyiqz_.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图69:寻找t-11的危险概率。</figcaption></figure><p id="f1f7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">d)找出t=0时的累积危险概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi qd"><img src="../Images/c9f8858a03323d45134ad1d6bb0a2766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZFWeAyQApj-kbIP4.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图70:寻找t=0时的累积危险概率。</figcaption></figure><p id="3626" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">e)找出t=5时的累积危险概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi si"><img src="../Images/13b14f9fbf6a3905b4fd3eaa99722e8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kyvwZ7ECbMxFvNkL.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图71:找出t=5时的累积危险概率。</figcaption></figure><p id="0615" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">f)找出t=11时的累积危险概率:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sh"><img src="../Images/6f690a65a525ca1cb17a7ae22724c2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8TOYAyNetKr39mEg.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图72:寻找t=11时的累积危险概率。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sj"><img src="../Images/2f07d1e29c316d9f2de957a520d36fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/0*8cSjQvOe4JVJDrZK.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图73:显示累积危险。</figcaption></figure><p id="01f6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 5)绘制累积危险图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sk"><img src="../Images/f989764aba730b907184b346c9e8c321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/0*yLX6Q1EiwOUSwXU8.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图74:绘制累积危害图。</figcaption></figure><p id="df46" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">累积风险的理解不如生存函数清晰，但风险函数基于更先进的生存分析技术。</p><p id="951a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 6)预测一个值:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sl"><img src="../Images/d02157b70c847697d80ed16f62f07d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PJctOlgfmkAmfP6z.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图75:预测某一点的值。</figcaption></figure><p id="274f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 7)带置信区间的累积危险概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sm"><img src="../Images/839731a00e62cab50e9754af401a9907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/0*g-CJ99bOhybPDc-y.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图76:用置信区间计算累积危险概率。</figcaption></figure><p id="d52d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 8)带置信区间的累积危险概率图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sl"><img src="../Images/69a9c63f50dfd8e71133f333d8f7ef2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fneb3xGjTXTE0iPe.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图77:绘制置信区间。</figcaption></figure><p id="d921" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 9)累积危害与累积密度:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sn"><img src="../Images/ef7496b387d4907da9bec452e7552ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/0*PlVos27z2zfSfmb0.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图78:绘制累积危害和累积密度</figcaption></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="bd6a" class="pa nc jj bd nd pb pc pd ng pe pf pg nj ky ph kz nm lb pi lc np le pj lf ns pk bi translated">4.带群的Kaplan-Meier估计量</h1><p id="92e2" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">到目前为止，我们看到了如何找到我们所有观测的生存概率和风险概率。现在是时候对我们的数据进行一些分析，以确定如果我们根据具体特征将数据分组，存活概率是否有任何差异。让我们根据性别将数据分为两组:男性和女性。我们的目标是检查如果我们根据性别划分数据集，存活率是否有显著差异。在本教程的后面，我们将会看到我们在什么基础上将数据分组。</p><p id="659f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 1)导入所需库:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi so"><img src="../Images/38dd4ff89321d25ccb51a1c69264981a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/0*haIo3uIo6wd1lyTu.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图79:从Python中的生命线导入pandas、numpy、matplotlib.pyplot和KaplanMeierFitter。</figcaption></figure><p id="468b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)读取数据集:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sp"><img src="../Images/2416fe15a05e5689bfa8cdad67941528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Nmid4Jmlgt9BNLvG.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图80:读取数据集。</figcaption></figure><p id="28f4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)组织我们的数据:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sq"><img src="../Images/9a27a2a9077c1bd9d41d8ba130d53ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-ZeHGFxE_vQzDZyf.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图81:组织数据。</figcaption></figure><p id="e569" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 4)创建Kaplan-Meier-Fitter()的两个对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sr"><img src="../Images/58c13bebd553476cb42e5c362d5e83a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/0*kjz_4tFf_BdYuIUb.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图82:创建Kaplan-Meier-Fitter的两个对象。</figcaption></figure><p id="8c31" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 5)将数据分组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ss"><img src="../Images/3a8e071f9bf98e8a4e876cff4c58822b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/0*_FROd5XbD8yVQtt3.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图83:将数据分组。</figcaption></figure><p id="1057" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 6)男性数据:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi st"><img src="../Images/44bddc4ad70b0114fe3d6be0eda285a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*puMQXYvvcWyLTMhO.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图84:查看男性组的数据。</figcaption></figure><p id="9059" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 7)女性数据:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi su"><img src="../Images/223beeb0e2cafc6d51e4efa3e2b68f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Aui83Zbxx9lh7QXI.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图85:显示女性组的数据。</figcaption></figure><p id="e9ac" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 8)将数据放入我们的对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sv"><img src="../Images/6233085c7104a6b976c28776c9e1328c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5nVqWsZbf3cH4-Os.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图86:将男性和女性数据放入对象中。</figcaption></figure><p id="b273" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">9)男子组项目表:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sw"><img src="../Images/72a4330743409e57a27f619224f6c683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/0*7rYnI25LgdXusetu.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图87:男性组的事件表。</figcaption></figure><p id="0c5c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 10)女子组项目表:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sx"><img src="../Images/31db155f25c6c7c677f461b4ee55184c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/0*MdeDTgB3Q_aHID-W.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图88:女性组的事件表。</figcaption></figure><p id="4f2d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 11)预测生存概率:</strong></p><p id="a671" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在我们可以预测两组的生存概率。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sy"><img src="../Images/5e2b8980471daa84b1280ecc20c5eacd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yfarM2GB7N_H8Q5J.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图89:基于时间预测值。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sz"><img src="../Images/aab4fa2c05d103422d3027716b2f7f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZL4x0o2vqXO8KrQ5.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图90:基于时间预测值。</figcaption></figure><p id="6291" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">获得生存概率的完整列表</p><p id="edda" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> a)男性群体的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sr"><img src="../Images/a33ca26328fbe4842c04d4b82f6b1f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/0*627CxQozMBzjvAGT.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图91:获得男性群体生存函数的完整数据。</figcaption></figure><p id="6075" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b)女性组的存活概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ta"><img src="../Images/65c0a302158876c6c9693afd60721866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/0*kXeryDOyqw8KbQ1M.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图92:获得男性群体生存函数的完整数据。</figcaption></figure><p id="dc59" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">绘制生存概率图:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi tb"><img src="../Images/4075b6f7effb633eed8b4cf04b3587ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XXI8KaTHCYV34FiH.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图93:绘制生存概率图。</figcaption></figure><p id="8e98" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里我们可以注意到，女性肺癌存活的概率高于男性。因此，从这个数据中，我们可以说，医学研究者应该更多地关注导致男性患者生存率差的因素。</p><p id="210c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 14)得到累积密度:</strong></p><p id="9bfa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> a)男子组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tc"><img src="../Images/9ebc007957f915074bc8146e645ebb13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/0*lb0VMBKzhiIcFsxG.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图94:男性群体的累积密度。</figcaption></figure><p id="4b6a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b)女子组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi td"><img src="../Images/4f8315d4843a524c0f6887912b3eec64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/0*Bu3yQi0vI4iZLydd.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图95:女性群体的累积密度。</figcaption></figure><p id="f59a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 15)绘制累积密度图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi sn"><img src="../Images/631fa6cc944af0042e97c4bd39188aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/0*F-wCOb5lmoi9ngqf.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图96:绘制两组的累积密度图。</figcaption></figure><p id="3b03" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 16)危险功能:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rx"><img src="../Images/5d98d1efc0e0f01bf0451c29b3346eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XSnSJLpiTzqxQkft.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图97:导入NelsonAalenFitter。</figcaption></figure><p id="60cf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 17)将数据放入我们的对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi te"><img src="../Images/c5765423e20c7b96c6dc644a5da9fc7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SEOu-qm2l7IVaVad.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图98:将数据放入我们的对象中。</figcaption></figure><p id="51dc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 18)累积危险概率:</strong></p><p id="cc34" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> a)男性组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rm"><img src="../Images/50c984bb5d12118be0395c4c60c3068a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*-6_QBWoJTqK9ww4e.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图99:男性群体的累积危害。</figcaption></figure><p id="6245" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b)女性组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tf"><img src="../Images/f1e159fa58e40908fdcf54aab4a4a27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/0*qILAsScGyycDFJez.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图100:女性群体的累积危害。</figcaption></figure><p id="9585" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 19)绘制累积危险概率图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi qs"><img src="../Images/605a5cd73925f9c93ee6736a39bdcb0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/0*H9Tv254Y1k0Pgcf6.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图101:绘制累积危害图。</figcaption></figure><p id="d9d0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 20)男性组的平均事件时间:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tg"><img src="../Images/ed36a26c36510f8f8d8a9d8b5b6a3142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/0*xXlGc8LE3DCJsEMr.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图102:寻找感兴趣事件的条件中位数。</figcaption></figure><p id="6c95" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 21)男性组的中位事件时间图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tc"><img src="../Images/47e6a37a515dbf98f1d8c8bd1fdeb956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/0*nD7-UZYdP9r9JLLM.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图103:绘制男性组的条件事件时间。</figcaption></figure><p id="d1d2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 22)女性组的中位事件时间:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi th"><img src="../Images/903493251680a143408f8975ecb93764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/0*sDs2pWQVhHp_7Njf.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图104:为女性组寻找感兴趣事件的条件中值时间。</figcaption></figure><p id="d3b9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 23)女性组的中位事件时间图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tg"><img src="../Images/d8cb74490c10033057757870369c1ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/0*wijUi5x4ilNpvYfk.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图105:女性组事件的条件中值剩余时间。</figcaption></figure><p id="eed7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 24)男性组具有置信区间的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rk"><img src="../Images/a9978cf2afed5507da23ea25b8064e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*duSxL3mo4Nx6lCPA.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图106:用置信区间计算男性组的生存概率。</figcaption></figure><p id="d80d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 25)男性组具有置信区间的生存概率图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ti"><img src="../Images/94d3f198d363a666a598ea0ac13b8881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gYZTNu5EKE77aTu1.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图107:男性组的置信生存函数和置信区间图。</figcaption></figure><p id="cc72" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 26)女性组具有置信区间的生存概率:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tj"><img src="../Images/5ebcb91846eb03ce1d3349dcf9df2043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/0*Sad_H8FqzzYe8qRz.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图108:女性组有置信区间的生存概率。</figcaption></figure><p id="5cec" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 27)女性组的具有置信区间的生存概率图:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tk"><img src="../Images/8a0caf957fc68e4911553ee8e923a552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/0*BCXPU9FNvEOHoo11.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图109:用置信区间绘制女性组的生存函数。</figcaption></figure><p id="94d7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 28)累积密度与累积危险的比较:</strong></p><p id="df9f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> a)男性组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rn"><img src="../Images/5517365fcf41d2092085bb978181e53e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/0*vQqsoT_CVbMd_XbX.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图110:绘制累积危害和累积密度。</figcaption></figure><p id="ddf4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> b)对于女性组:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tl"><img src="../Images/d9867265b62fc078e1b5227adf1d7913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/0*Wqn43O5ESKDLRVfm.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图111:绘制累积危害和累积密度。</figcaption></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="5a27" class="pa nc jj bd nd pb pc pd ng pe pf pg nj ky ph kz nm lb pi lc np le pj lf ns pk bi translated">5.对数秩检验:</h1><p id="b9f4" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">对数秩检验是一种假设检验，用于比较两个样本的生存分布。</p><p id="b6d0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">目标:我们的目标是看看被比较的组之间是否有任何显著的差异。</p><p id="2f72" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">无效假设</strong>:无效假设表示被研究的两组之间没有显著差异。如果这些组之间有显著差异，那么我们必须拒绝我们的零假设。</p><p id="c230" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">我们怎么说有显著差异呢？</strong></p><p id="bc48" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">介于0和1之间的p值表示统计显著性。p值越小，被研究组之间的统计差异越显著。请注意，我们的目标是找出我们正在比较的组之间是否有任何差异。如果是的话，我们可以根据各种信息，比如他们的饮食、生活方式和其他信息，对为什么某个特定群体的存活率较低进行更多的研究。</p><p id="53c4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">小于(5% = 0.05) P值</strong>表示我们比较的各组之间存在显著差异。我们可以根据性别、年龄、种族、治疗方法等对我们的小组进行划分。</p><p id="17fc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">这个测试是为了找出p的值</strong></p><p id="70f8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 1)获取对数秩检验的变量:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tm"><img src="../Images/824b080ed19d839151fdee651267e7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/0*tzkpbYZPmBjjGX-U.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图112:定义对数秩检验的变量。</figcaption></figure><p id="6ef8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)执行对数秩检验:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi tn"><img src="../Images/47db04dbfb18a6df24589616bf0aac7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xoacik1DOQI4g3bG.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图113:执行对数秩测试。</figcaption></figure><p id="3606" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)打印p值:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi to"><img src="../Images/4ad35da169224e92f4d6d3ad78bfa3f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IzQUYE0ZAs6drGgh.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图114:打印p值。</figcaption></figure><p id="3806" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们使用著名的统计方法，对数秩检验，比较了两个不同组的生存分布。这里我们可以注意到两组的p值是0.00131(&lt;0.005)，这表明我们必须拒绝零假设并承认两组的生存函数有显著差异。p值给了我们有力的证据，证明“性别”与存活天数有关。简而言之，我们可以说，一个人的“性别”对生存概率有显著影响。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="e95e" class="pa nc jj bd nd pb pc pd ng pe pf pg nj ky ph kz nm lb pi lc np le pj lf ns pk bi translated">6.Cox比例风险模型</h1><p id="8366" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">cox比例风险模型是医学研究人员通常使用的回归模型，用于确定受试者的存活时间与一个或多个预测变量之间的关系。简而言之，我们想找出不同的参数如年龄、性别、体重、身高如何影响受试者的存活时间。</p><p id="5f9b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在上一节中，我们看到了卡普兰-迈耶、纳尔逊-阿伦和Log-Rank-Test。然而，在这种情况下，我们一次只能考虑一个变量，还有一点需要注意的是，我们只对性别、地位等分类变量进行运算。它不能用于年龄、体重或身高等非分类数据。作为一个解决方案，我们使用Cox比例风险回归分析，<strong class="lj jt">，它对定量预测非分类变量和分类变量都有效。</strong></p><h2 id="e283" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">我们为什么需要它？</h2><p id="8532" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">在医学研究中，我们通常会考虑多个因素来诊断一个人的健康状况或存活时间。也就是说，我们通常利用他们的性别、年龄、血压和血糖来发现不同组之间是否有任何显著差异。例如，如果我们根据一个人的年龄对我们的数据进行分组，我们的目标将是确定哪个年龄组有更高的生存机会。那是儿童组、成人组还是老年人组？现在我们需要发现的是我们在什么基础上组成一个团体？为了找到这一点，我们使用cox回归并找到不同参数的系数。让我们看看它是如何工作的！</p><h2 id="7c20" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">Cox比例风险法的基础</h2><p id="e49a" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">cox比例风险方法的最终目的是注意我们数据集中的不同因素如何影响感兴趣的事件。</p><p id="10e5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">危险功能:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ti"><img src="../Images/09a8df22bca7d74c1b320f37a3c9efdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UDHDFdapKzYrxILz.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图115:危险函数公式。</figcaption></figure><p id="654e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">exp(bi)的值称为危险比(HR)。我们举个例子就明白这一点了。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tp"><img src="../Images/71a1a3688dba29ba0a9b0f4eb5f48d0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*FjJ7hUlGpIFgkM2d.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图116:定义危险比。</figcaption></figure><h2 id="869e" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">让我们编码:</h2><p id="a482" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated"><strong class="lj jt"> 1)导入所需库:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tq"><img src="../Images/99ed4819127c4382be257ae7e2bba20e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/0*2aSoe-d2WyUG4NDy.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图117:用Python导入所需的库。</figcaption></figure><p id="14eb" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 2)读取CSV文件:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tr"><img src="../Images/d0d505a755dbb46e18f44aa353763224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/0*croZEc6jDEU-bA3A.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图118:读取CSV文件。</figcaption></figure><p id="495a" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 3)删除包含空值的行:</strong></p><p id="5c34" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">接下来，我们需要删除具有空值的行。我们的模型不能处理包含空值的行。如果我们不预处理我们的数据，那么我们可能会得到一个错误。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ts"><img src="../Images/e40eac002471cb21432234b9c6c5da4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xUfalDoLmb5s2-Ac.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图119:删除空值行。</figcaption></figure><p id="cecc" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 4)为KapanMeierFitter创建一个对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi sw"><img src="../Images/3c6524f36c467555b2ff44ffca182091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/0*ChMcIJjccMUfnlnW.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图120:为KapanMeierFitter创建一个对象。</figcaption></figure><p id="5503" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 5)组织数据:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tt"><img src="../Images/88fcf5736495adc134dd114e36719df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/0*4izOMdoO3MTRNzVF.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图121:组织数据。</figcaption></figure><p id="d5cd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 6)将数据放入一个对象:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi tu"><img src="../Images/3951e8191815a03f94ff5a4695536eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f834x2fcDmZzV1fM.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图122:使数据适合一个对象。</figcaption></figure><p id="c1bb" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 7)生成事件表:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tv"><img src="../Images/b2168b6447dbbf126b84e814d136adb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/0*QPOsfsh9sBrBXPVN.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图123:生成事件表。</figcaption></figure><p id="c7ca" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 8)获取所需的列:</strong></p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi tw"><img src="../Images/471c1349397f4c23dee6d0dde88d45bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/0*Moiyvu1sUcm1lHbb.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图124:从数据中获取所需的列。</figcaption></figure><p id="724f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">9)拟合数据并打印摘要:</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tx"><img src="../Images/cbf830df449c0fdc743fdc404e612665.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/0*F2qU06bGe2xb9-_n.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图125:使用CoxPHFitter获得摘要。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ty"><img src="../Images/10dca41114a940c45bd18005a00bb239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m2PjKcWvbnv1JCBd.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图126:显示数据。</figcaption></figure><p id="7ef0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在上图中，请注意我们数据集中每一列的p值。接下来，我们知道p值&lt;0.05 is considered statistically significant. Here we can see that “sex” and “ph.ecog” have p-values less than 0.05. So we can say that while grouping our data for analysis, we should focus on dividing the data based on these two factors.</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi rx"><img src="../Images/8f5dc1a7418837cc35d1cd312c8d2797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yjxWuMa4hAhaKpj-.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">Figure 127: Hazard Ratio formula.</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi tp"><img src="../Images/4753217068930bc3a6a54b7ed9fc40bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*rlfOHUPkhhKDvq3-.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">Figure 128: Hazard Ratio values.</figcaption></figure><p id="e531" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Here notice the p-value for “sex” is 0.01, and the Hazard Ratio(HR) is 0.57, which indicates a strong relationship between the patients’ sex and decreased risk of death. For example, holding the other covariates constant,<strong class="lj jt">为女性(性别=2)会将风险降低0.57倍，即43%。这意味着雌性有更高的生存机会。接下来，ph.ecog的p值为&lt; 0.005，风险比(HR)为2.09，这表明ph.ecog值与死亡风险增加之间存在密切关系。保持其他协变量不变，ph.ecog值越高，存活率越低。<strong class="lj jt">这里ph.ecog值高的人死亡风险高109%。</strong>所以，简而言之，我们可以说，医生应该通过提供相关药物来尽量降低患者的ph.ecog值。接下来，注意年龄的风险比(HR)是1.01，表明年龄越大，风险比只增加1%。所以我们可以说，不同年龄段之间没有显著差异。</strong></p><p id="a67f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt"> 10)从图表中检查哪个因素影响最大:</strong></p><p id="f87c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在下图中，我们可以注意到“性别”和“ph.ecog”数据的差异。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi tz"><img src="../Images/473bff04b01cdd7642fc430c4b33c4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MhauAR240SFeWYA0.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图129:在图表上绘制结果。</figcaption></figure><p id="fc90" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">用真实的观察来检验我们的理论:</p><p id="7c83" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们用我们观察到的真实数据来检验我们的结论。</p><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi rq"><img src="../Images/10fc0c526843f96e8420eeb1b431e072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/0*QQgb7msKTNtTohIZ.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图130:结论表。</figcaption></figure><figure class="qe qf qg qh gt iv gh gi paragraph-image"><div class="gh gi ua"><img src="../Images/c54fa98c89a8b7319ca6522d2bb2f0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*haP3G3yAZYYKLe7f.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">图131:绘制我们的数据。</figcaption></figure><p id="65e9" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在上图中，我们可以看到，23号人物的生存几率最高，17号人物的生存几率最低。通过检查主表，我们可以注意到ph.ecog值的显著变化。我们还可以看到，21岁和23岁的人有更高的生存机会，因为他们的ph.ecog值最低。</p><p id="1aa2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">好了，这就是本教程的内容。感谢您的阅读。我们随时欢迎您的反馈。</p><p id="098d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是发表在<a class="ae jg" href="https://www.kdnuggets.com/2020/07/complete-guide-survival-analysis-python-part1.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jt"> KDNuggets </strong> </a>上的原始文章的修改版。</p><blockquote class="oj"><p id="c881" class="ok ol jj bd om on pt pu pv pw px mc dk translated">📚如果你喜欢这篇文章，看看我们的<a class="ae jg" href="https://towardsai.net/neural-networks-with-python" rel="noopener ugc nofollow" target="_blank">神经网络教程</a>从头开始，详细介绍Python代码和数学。📚</p></blockquote></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><figure class="qe qf qg qh gt iv gh gi paragraph-image"><a href="https://www.buymeacoffee.com/pratu"><div class="gh gi ub"><img src="../Images/2093d0f16d94a8942508624035f676b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCQqlZr6doDP-cszzpaSpw.png"/></div></a><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">给普拉蒂克买杯咖啡！</figcaption></figure><p id="da89" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">免责声明:</strong>本文表达的观点为作者个人观点，不代表卡内基梅隆大学的观点。这些文章并不打算成为最终产品，而是当前思想的反映，同时也是讨论和改进的催化剂。</p><p id="4ad6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">通过<a class="ae jg" href="https://towardsai.net/" rel="noopener ugc nofollow" target="_blank">向艾</a>发布</p><h2 id="91d1" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">引用</h2><p id="86cc" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">对于学术背景下的归属，请引用该工作为:</p><pre class="qe qf qg qh gt uc ud ue uf aw ug bi"><span id="5538" class="nb nc jj ud b gy uh ui l uj uk">Shukla, et al., “Survival Analysis with Python Tutorial - How, What, When, and Why”, Towards AI, 2020</span></pre><h2 id="28c8" class="nb nc jj bd nd ne nf dn ng nh ni dp nj lq nk nl nm lu nn no np ly nq nr ns jp bi translated">BibTex引文:</h2><pre class="qe qf qg qh gt uc ud ue uf aw ug bi"><span id="ce86" class="nb nc jj ud b gy uh ui l uj uk">@article{pratik_iriondo_2020, <br/> title={Survival Analysis with Python Tutorial - How, What, When, and Why}, <br/> url={<a class="ae jg" href="https://towardsai.net/survival-analysis-with-python" rel="noopener ugc nofollow" target="_blank">https://towardsai.net/survival-analysis-with-python</a>}, <br/> journal={Towards AI}, <br/> publisher={Towards AI Co.}, <br/> author={Pratik, Shukla}, <br/> editor={Iriondo, Roberto}, <br/> year={2020}, <br/> month={Sep}<br/>}</span></pre><h1 id="e35b" class="pa nc jj bd nd pb qi pd ng pe qj pg nj ky qk kz nm lb ql lc np le qm lf ns pk bi translated">7.资源</h1><p id="8040" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated"><a class="ae jg" href="https://colab.research.google.com/drive/1zc6uf91Gw3bkrieJCzfDAzya16qvOHOV?usp=sharing" rel="noopener ugc nofollow" target="_blank">谷歌Colab实现</a></p><p id="ba30" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><a class="ae jg" href="https://github.com/towardsai/tutorials/tree/master/survival_analysis_in_python" rel="noopener ugc nofollow" target="_blank"> Github库</a></p><h1 id="996f" class="pa nc jj bd nd pb qi pd ng pe qj pg nj ky qk kz nm lb ql lc np le qm lf ns pk bi translated"><strong class="ak"> 8。参考文献:</strong></h1><p id="fcca" class="pw-post-body-paragraph lh li jj lj b lk nv kt lm ln nw kw lp lq pl ls lt lu pm lw lx ly pn ma mb mc im bi translated">[1]生命线的例子，<a class="ae jg" href="https://lifelines.readthedocs.io/en/latest/Examples.html" rel="noopener ugc nofollow" target="_blank">https://lifelines.readthedocs.io/en/latest/Examples.html</a></p><p id="5116" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[2] Kaplan — Meier Estimator，维基百科，<a class="ae jg" href="https://en.wikipedia.org/wiki/Kaplan%E2%80%93Meier_estimator" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Kaplan % E2 % 80% 93 Meier _ Estimator</a></p><p id="5f28" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[3]生命线，单变量NelsonAalenFilter，<a class="ae jg" href="https://lifelines.readthedocs.io/en/latest/fitters/univariate/NelsonAalenFitter.html" rel="noopener ugc nofollow" target="_blank">https://Lifelines . readthe docs . io/en/latest/fitters/Univariate/NelsonAalenFilter . html</a></p><p id="447b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[4] STHDA，高通量数据分析的统计工具，<a class="ae jg" href="http://www.sthda.com/english/wiki/cox-proportional-hazards-model" rel="noopener ugc nofollow" target="_blank">http://www . sth da . com/English/wiki/Cox-proportional-hazards-model</a></p></div></div>    
</body>
</html>