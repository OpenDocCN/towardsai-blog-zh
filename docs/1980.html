<html>
<head>
<title>ELO Merchant Category Recommendation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ELO商户类别推荐</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/elo-merchant-category-recommendation-6c15049f76d5?source=collection_archive---------2-----------------------#2021-07-12">https://pub.towardsai.net/elo-merchant-category-recommendation-6c15049f76d5?source=collection_archive---------2-----------------------#2021-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a49c" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/bc297adc9fcf6be11b38877f544707ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rzi9ajo5VnL9hSLO1733Kg.jpeg"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">由<a class="ae ko" href="https://unsplash.com/@claybanks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">粘土银行</a>在<a class="ae ko" href="https://unsplash.com/s/photos/credit-card?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="0f85" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">概观</h1><p id="feb0" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">巴西最大的支付品牌之一Elo与商家建立了合作关系，为持卡人提供促销或折扣。Elo建立了机器学习模型，以了解客户生命周期中最重要的方面和偏好，从食品到购物。但到目前为止，没有一个是专门为个人或个人资料定制的。因此，Elo有了一个新的目标，那就是建立一个提供个性化推荐的模型。该模式旨在改善客户的生活，帮助Elo减少不必要的活动，为客户创造正确的体验。</p><h1 id="d36d" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">商业问题</h1><p id="c3ed" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">该项目旨在建立一个机器学习模型，通过预测每个支付卡id的忠诚度得分来揭示客户忠诚度指标，从而识别和提供与个人最相关的机会。对应于每个卡id的忠诚度得分是类别标签，其值使用实数表示。由于它更像是一个回归问题，因此用于评估模型性能的度量是均方根误差(RMSE)。数据集包括卡细节、商户细节、旧交易和新交易细节。关键特征是对应的卡id，我们必须预测忠诚度得分。卡详细信息由卡id和卡的其他详细信息组成。商家详细信息由关于商家的附加信息组成。旧交易和新交易包括每个卡id 3个月和2个月的交易。市场上已经存在一些解决方案，但是没有一个是针对个人简档偏好定制的。该项目致力于向持卡人提供与产品折扣相关的个性化建议，以增强客户体验。推荐是基于顾客从食物到购物的个人喜好。</p><h1 id="7ac5" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">问题陈述:机器学习的视角</h1><h2 id="e9a9" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">第1部分:作为一个回归问题</h2><p id="b18f" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">这个项目背后的想法非常简单。给定卡的详细信息、一系列关于卡的交易详细信息以及一些与交易相关的商家详细信息，我们需要找到一个忠诚度得分。这个忠诚度得分是一个实数，因此是一个回归问题。</p><p id="16a7" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated"><strong class="lp jd">性能指标:</strong></p><p id="f40e" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated">根据均方根误差对提交的内容进行评分。RMSE被定义为:</p><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/30c1291d47eeb585c7f5587513bb0946.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*f_4I0czgW01t53kPCA9MiA.png"/></div></figure><p id="8ca5" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated">其中，ŷ是每个card_id的预测忠诚度得分，y是分配给card_id的实际忠诚度得分。</p><h2 id="0480" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">第2部分:作为一个分类问题</h2><p id="2d7d" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">作为下一步，这个问题也可以作为一个分类任务。给定相似的数据集，现在的目标是对客户是否忠诚进行分类。目标类是二进制的，因此是一个分类问题。</p><h1 id="591e" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">数据来源</h1><p id="f8c5" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">本案例研究中使用的所有数据集均来自Kaggle竞赛。完整的数据集可以从<a class="ae ko" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/data" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中找到。使用的每个数据集的基本描述如下。</p><h2 id="e4ab" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">文件描述:</strong></h2><ul class=""><li id="ffdb" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated"><strong class="lp jd"> train.csv </strong> —训练集。</li><li id="75c9" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd"> test.csv </strong> —测试集。</li><li id="2ac9" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd">sample _ submission . CSV</strong>——一个格式正确的样本提交文件——包含所有您期望预测的card _ ids。</li><li id="22be" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd">historical _ transactions . CSV</strong>—每个card_id最多3个月的历史交易。</li><li id="194f" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd"> merchants.csv </strong> —数据集中所有商家/merchant _ id的附加信息。</li><li id="0de1" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd">new _ merchant _ transactions . CSV</strong>—每个card_id的两个月的数据，包含card_id在merchant _ ids购买的所有商品，这些商品在历史数据中没有被访问过。</li></ul><p id="e95b" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated">数据集train.csv和test.csv文件包含我们将用于训练和预测的card _ ids。训练和测试数据集分别被重命名为card_details_train和card_details_test。</p><h2 id="ec16" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集1: card_details_train </strong></h2><pre class="nc nd ne nf gt nu nv nw nx aw ny bi"><span id="a787" class="ml kq it nv b gy nz oa l ob oc"><strong class="nv jd">FEATURES</strong>             | <strong class="nv jd">DESCRIPTIONS</strong><em class="od"><br/></em>---------------------|--------------------------------------------<br/>- card_id            | Unique card identifier<br/>- first_active_month | ‘YYYY-MM’, month of first purchase<br/>- feature_1          | Anonymized card categorical feature<br/>- feature_2          | Anonymized card categorical feature<br/>- feature_3          | Anonymized card categorical feature<br/>- target             | Loyalty numerical score calculated 2 months   after historical and evaluation period</span></pre><h2 id="2cfd" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集2: card_details_test </strong></h2><pre class="nc nd ne nf gt nu nv nw nx aw ny bi"><span id="907a" class="ml kq it nv b gy nz oa l ob oc"><strong class="nv jd">FEATURES</strong>             | <strong class="nv jd">DESCRIPTIONS</strong><br/>---------------------|------------------------------------<br/>- card_id            | Unique card identifier<br/>- first_active_month | 'YYYY-MM', month of first purchase<br/>- feature_1          | Anonymized card categorical feature<br/>- feature_2          | Anonymized card categorical feature<br/>- feature_3          | Anonymized card categorical feature</span></pre><p id="fd06" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated">数据集merchants.csv包含数据集中表示的每个merchant_id的聚合信息。该商家的数据集被重命名为merchant_details。</p><h2 id="01bf" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集3:商家_详情</strong></h2><pre class="nc nd ne nf gt nu nv nw nx aw ny bi"><span id="e8f4" class="ml kq it nv b gy nz oa l ob oc"><strong class="nv jd">FEATURES </strong>                     | <strong class="nv jd">DESCRIPTIONS</strong><br/>------------------------------|------------------------------------- - merchant_id                 | Unique merchant identifier<br/>- merchant_group_id           | Merchant group (anonymized )<br/>- merchant_category_id        | Unique identifier for merchant category(anonymized )<br/>- subsector_id                | Merchant category group(anonymized )<br/>- numerical_1                 | anonymized measure<br/>- numerical_2                 | anonymized measure<br/>- category_1                  | anonymized category<br/>- category_2                  | anonymized category<br/>- category_4                  | anonymized category<br/>- city_id                     | City identifier (anonymized )<br/>- state_id                    | State identifier (anonymized )<br/>- most_recent_sales_range     | Range of revenue (monetary units) in last active month --&gt; A &gt; B &gt; C &gt; D &gt; E<br/>- most_recent_purchases_range | Range of quantity of transactions in last active month --&gt; A &gt; B &gt; C &gt; D &gt; E<br/>- avg_sales_lag3              | Monthly average of revenue in last 3 months divided by revenue in last active month<br/>- avg_purchases_lag3          | Monthly average of transactions in last 3 months divided by transactions in last active month<br/>- active_months_lag3          | Quantity of active months within last 3 months<br/>- avg_sales_lag6              | Monthly average of revenue in last 6 months divided by revenue in last active month<br/>- avg_purchases_lag6          | Monthly average of transactions in last 6 months divided by transactions in last active month<br/>- active_months_lag6          | Quantity of active months within last 6 months<br/>- avg_sales_lag12             | Monthly average of revenue in last 12 months divided by revenue in last active month<br/>- avg_purchases_lag12         | Monthly average of transactions in last 12 months divided by transactions in last active month<br/>- active_months_lag12         | Quantity of active months within last 12 months</span></pre><p id="3b0b" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated">historical_transactions.csv和new_merchant_transactions.csv文件包含每张卡的交易信息。historical_transactions.csv包含任何所提供的merchant _ ids的每张卡最多3个月的交易。数据集new_merchant_transactions.csv包含两个月内新商户(此特定card_id尚未访问的merchant _ ids)的交易。historical_transactions和new_merchant_transactions分别被重命名为old_transactions和new_transactions。</p><h2 id="91dd" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集4:旧交易&amp;数据集5:新交易</strong></h2><pre class="nc nd ne nf gt nu nv nw nx aw ny bi"><span id="0a96" class="ml kq it nv b gy nz oa l ob oc"><strong class="nv jd">FEATURES  </strong>             | <strong class="nv jd">DESCRIPTIONS</strong><br/>-----------------------|-------------------------------------------<br/>- card_id              | Card identifier<br/>- merchant_id          | Merchant identifier (anonymized)<br/>- merchant_category_id | Merchant category identifier (anonymized )<br/>- subsector_id         | Merchant category group identifier (anonymized )<br/>- category_1           | anonymized category<br/>- category_2           | anonymized category<br/>- category_3           | anonymized category<br/>- city_id              | City identifier (anonymized )<br/>- state_id             | State identifier (anonymized )<br/>- month_lag            | month lag to reference date<br/>- authorized_flag      | Y' if approved, 'N' if denied<br/>- installments         | number of installments of purchase<br/>- purchase_amount      | Normalized purchase amount<br/>- purchase_date        | Purchase date</span></pre><h1 id="4863" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">探索性数据分析</h1><p id="2c01" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">在统计学中，探索性数据分析是一种分析数据集以总结其主要特征的方法，通常使用统计图形和其他数据可视化方法。</p><h2 id="fcb0" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集1:卡片_详细信息_列车</strong> &amp; <strong class="ak">数据集2:卡片_详细信息_测试</strong></h2><h2 id="b585" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 1。目标</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oe"><img src="../Images/0c4ca6245010a077b1011a3444b83b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tc8-cFKq2kjge1IkUS9KCw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">忠诚度得分分布(按作者分类的图片)</figcaption></figure><h2 id="6c3a" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="2462" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">列车组中的大多数'<em class="od"> card_id </em>'的'<em class="od"> target </em>'值在-10和10之间，大多数值为0。</li><li id="2982" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">card_id总数的<strong class="lp jd">199605(98.85%)</strong>左右有这样一个目标值。</li><li id="29f1" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">数据集的一小部分还包含小于-30的目标值，这样的点可以被认为是异常值。</li><li id="ea76" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">在'<em class="od"> card_id </em>'总数的<strong class="lp jd">2207(1.09%)</strong>左右有这样一个目标值。</li></ul><h2 id="0161" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 2。活跃年份</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi of"><img src="../Images/017d4e3f79d6bf5ddddd57f3ed9194fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*lXVbujMTJ9hc6jUHUxNq8Q.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_train中的年份分布(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi og"><img src="../Images/f9745e51a0ce56e3a83c6d1f62641adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*I1WZW3-hw54_STlzB5nDGA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_test中的年份分布(图片由作者提供)</figcaption></figure><h2 id="491f" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">意见:</strong></h2><ul class=""><li id="74ed" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">训练集和测试集中的年分布几乎相同。</li><li id="0338" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">该数据集包含从2011年11月1日到2018年2月1日的记录。</li><li id="b6ef" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">很大一部分交易发生在2017年，其次是2016年和2015年。</li><li id="15dd" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">2011年和2018年几乎没有交易发生。</li></ul><h2 id="0177" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 3。特点</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d2076ac67a2489c5e7d4ecc7b84a0a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*6wWrMx7WvEX8sGFC3SQvrA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_train中的特征分布(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/a9f482a6a7a9b9d9d7883a6d72cbe79c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*ZtWfAbYTkUPcsCYicAN1SA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_test中的特征分布(图片由作者提供)</figcaption></figure><h2 id="0e10" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="350d" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">训练集和测试集中的分类特征在每个类别中也具有相似的分布。</li><li id="f94a" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">对于'<em class="od"> feature_1 </em>'，该值介于1到5之间，其中值3具有最大计数。</li><li id="d28d" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">对于'<em class="od"> feature_2 </em>'，该值介于1到3之间，其中值1具有最大计数。</li><li id="1ca5" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">对于'<em class="od">feature _ 3</em>'，该值介于0和1之间，其中值1具有最大计数。</li></ul><h2 id="06e5" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 4。单个特征如何影响目标</strong></h2><div class="nc nd ne nf gt ab cb"><figure class="oi kd oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><img src="../Images/a5e3db7ed45403b552f21c2b9410c06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*r2pL4TICHgQliNt7y7322w.png"/></div></figure><figure class="oi kd oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><img src="../Images/e861573c22e1d93a5ad3c42cbb67fc4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*kfd9MhXntjsFSFAkdzjTrg.png"/></div></figure><figure class="oi kd oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><img src="../Images/830720a2c43926bd1c893f7555ed97a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*6TN-qBXvDRnxdzX2hk2qQg.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk oo di op oq translated">单特征wrt目标在card_details_train中的分布(图片由作者提供)</figcaption></figure></div><h2 id="70ec" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="70eb" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">'<em class="od"> feature_1 </em>'、<em class="od"> feature_2 </em>'、<em class="od"> feature_3 </em>、【wrt】、<em class="od"> target </em>的分布对于所有分类值来说看起来几乎是相似的。</li></ul><h2 id="fc8e" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 5。多重特征如何影响目标</strong></h2><div class="nc nd ne nf gt ab cb"><figure class="oi kd oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><img src="../Images/5eb169d230c26734844ce7dc3abcd5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Cqnv4ofL1OdBRBuDu9r7vQ.png"/></div></figure><figure class="oi kd oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><img src="../Images/f155cc934f6477fd66ba1b741f805688.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*FoVYktnMP_-ruMgNCzVgFg.png"/></div></figure><figure class="oi kd oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><img src="../Images/8dc5f65ff88aa16ba7a756d097c87e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*hYlU6HMrtyak-QdWBKVZqg.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk oo di op oq translated">card_details_train中多个特征wrt目标的分布(图片由作者提供)</figcaption></figure></div><h2 id="806d" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="29e3" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">在'<em class="od"> feature_1 </em>和'<em class="od"> feature_2 </em>以及'<em class="od"> target </em>'之间没有太多明显的区别。</li><li id="9b16" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">在'<em class="od"> feature_2 </em>'和'<em class="od"> feature_3 </em>'以及'<em class="od"> target </em>'之间可以描绘出稍微好一点的分离。</li><li id="8935" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">在'<em class="od">特征_1 </em>'和'<em class="od">特征_3 </em>'以及'<em class="od">目标</em>'之间可以描绘出更好的分离。</li></ul><h2 id="c4ec" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 6。first_active_month如何影响卡的数量</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi or"><img src="../Images/4543a25eef12d53617866780f9869500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WjfPUl0mFeMBgDbEOP41pQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_train中第一个_active_month wrt卡数的分布(图片由作者提供)</figcaption></figure><h2 id="d332" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="0d30" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">发行的信用卡数量逐年增加。</li><li id="e5c2" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">大量的交易发生在过去的几年里。</li><li id="4efa" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">大部分信用卡在2017年7月至2017年11月期间有效。</li></ul><h2 id="8223" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集3: merchant_details </strong></h2><h2 id="e3a8" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 1。最新销售范围</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi os"><img src="../Images/f07ad5d6c53e2055d0b03859310ceb94.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*qbLoAdEgIU7c8pNgpfCS3A.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">最新销售系列(图片由作者提供)</figcaption></figure><h2 id="54c9" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 2。最近购买范围</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/daa7abcb0ccba44d9db041f7f393aefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*R6uFaLAxYOusjsFz9EoCOQ.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">最近的购买范围(图片由作者提供)</figcaption></figure><h2 id="1fc5" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="f95a" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">E类的'<em class="od"> recent_sales_range </em>'(最后一个活跃月)是最大的范围，商户数为177104。</li><li id="fcb7" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">E类的'<em class="od"> recent_purchase_range </em>'(最后一个活跃月)范围最大，商户数为175309。</li></ul><h2 id="511d" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集4:旧事务</strong></h2><h2 id="4552" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 1。分期付款</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a3ef75979e39d94968139ac38c609ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*R5VdWgxkMPEZ7d147tqRAw.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">分期付款的分布(作者图片)</figcaption></figure><h2 id="4f7e" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 2。第1类</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c9bd7a8b22b3c0109f6ea49e26763ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*GcrmSME--I6gPWRa0EPikg.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">类别1的分布(按作者分类的图片)</figcaption></figure><h2 id="e774" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 3。类别2 </strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/85cff2aaf5503125f5eb169b96a5b7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*2t72yP1IfPxmVtp0ichaxQ.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">类别2的分布(按作者分类的图片)</figcaption></figure><h2 id="eddb" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 4。类别3 </strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/9aea3ac06a0994052456bf454b49ad10.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*pVu5Ib0JTi-cS8OG0LAe6A.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">类别3的分布(按作者分类的图片)</figcaption></figure><h2 id="cd1d" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集5:新交易</strong></h2><h2 id="263d" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 1。分期付款</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/eb4d6a29934fd59ff0f0f82256a2467d.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*o0-pni3gB0MxVMWjy2gAQw.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">分期付款的分布(作者图片)</figcaption></figure><h2 id="498d" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 2。类别1 </strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/244e74ac748f0aed87c0a075806795ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*dH3VLD66YVhFvnFbw3GPPQ.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">类别1的分布(按作者分类的图片)</figcaption></figure><h2 id="6c94" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 3。类别2 </strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/258abf9685e3d6a77bc5579e0ff87857.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*74j0kC9tClG0L_e86lGXUw.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">类别2的分布(按作者分类的图片)</figcaption></figure><h2 id="0a9b" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 4。类别3 </strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2096355c549290fc4ed06d5ebda8e1a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ybg8EcXj379rZP8NVPye0g.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">类别3的分布(按作者分类的图片)</figcaption></figure><h2 id="8e01" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">观察结果:</strong></h2><ul class=""><li id="d129" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">在分期付款功能中，有一些不常见的值-1和999以及前导值0和1。</li><li id="433e" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">历史交易和新交易都有类别1、类别2和类别3，它们具有相似的分布。</li></ul><h1 id="8e11" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">预处理</h1><p id="6052" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">数据预处理是建立任何基于机器学习的模型的基本步骤。它通过消除冗余、不必要的数据，帮助我们将原始数据转换成可读的格式。这样的数据只能应用于建立任何模型。还通过应用某些数据清理步骤对可用数据进行预处理。这些步骤包括:</p><ul class=""><li id="0875" class="ng nh it lp b lq mw lu mx ly ox mc oy mg oz mk nl nm nn no bi translated">查找重复行。</li><li id="e845" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">寻找每个特征的无限值的数量。</li><li id="774f" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">查找每个要素的缺失值。</li><li id="742d" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">使用最大计数值的缺失值插补。</li><li id="cd46" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">用nan值替换inf和-inf值-存在具有无限值的列，这些值需要用nan值替换，然后所有缺失值(nan)都要用各自要素的最大计数值进行估算。</li><li id="1740" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">数据集中的分类特征包含字母形式的值，需要使用数值进行编码。</li></ul><h1 id="461e" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">特征相关性</h1><h2 id="931c" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">皮尔逊相关:</strong></h2><p id="0b24" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">在统计学中，皮尔逊相关系数是两组数据之间线性相关性的度量。它是两个变量的协方差，除以它们的标准差的乘积。它有助于在两个连续变量之间进行统计检验。</p><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/00ae9a67ec3d498d86061de03d367b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*IDvns9jChbcbppC7BRqNMA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_train中特征之间的相关性(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pb"><img src="../Images/7c8d7d0b691ecd7d98500a3eb71aab8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*Mg54mQawmM05W9QfdXXXiQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">old_transactions中特征之间的相关性(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pb"><img src="../Images/acdb46bd84931b6bc27a894550e8dbef.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*1FcC9unYIVHIGU5hP4ApSA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">new_transactions中特征之间的相关性(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pc"><img src="../Images/801c19b9efeb6e49b9f1af327ba75a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Nks6RJg7-eSQqBFyJaWQg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">merchant_details中特征之间的相关性(图片由作者提供)</figcaption></figure><h2 id="04a9" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">卡方检验:</strong></h2><p id="703b" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">卡方统计是显示两个分类变量之间关系的一种方式。它有助于在两个分类变量之间进行统计检验。独立性卡方检验的假设如下:</p><ul class=""><li id="976d" class="ng nh it lp b lq mw lu mx ly ox mc oy mg oz mk nl nm nn no bi translated"><strong class="lp jd">零假设:</strong>两个分类变量是独立的(两个变量之间没有关联)(H0: Oi = Ei)</li><li id="7718" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd">替代假设:</strong>两个分类变量是相关的(两个变量之间有关联)(H1: Oi ≠ Ei)</li></ul><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pd"><img src="../Images/b6e21626238e64d23b87a50be5efad1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fa29Czs7qJ4VxdXC2BrmVA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_train卡方检验汇总(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pe"><img src="../Images/05b8dad0e080eed25ac55724bbc60077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hiOEm-69GVmvG0lDa36QEA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">卡方检验总结_详情_检验(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pf"><img src="../Images/195ef312335bbecae93199bbde684c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0T2jOCmveDDOJevgEl7JQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">old_transactions的卡方检验总结(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pg"><img src="../Images/38c19078459ea5905ef1ae8ddc9ff75e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJ43lz08HAhk1UMqjXu6Ww.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">new_transactions卡方检验总结(图片由作者提供)</figcaption></figure><h2 id="d35a" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">方差分析检验:</strong></h2><p id="dd8d" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">方差分析(ANOVA)是一种统计技术，用于检查两个或多个组的平均值是否存在显著差异。它有助于在一个连续变量和另一个分类变量之间进行统计检验。方差分析假设可以表述为:</p><ul class=""><li id="f5c1" class="ng nh it lp b lq mw lu mx ly ox mc oy mg oz mk nl nm nn no bi translated"><strong class="lp jd">无效假设:</strong>各组均数相等(各组均数无差异)。(H0: μ1=μ2=…=μp)</li><li id="ef7a" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><strong class="lp jd">备选假设:</strong>至少，一组的均值与其他组不同。(H1:所有μ不相等)</li></ul><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ph"><img src="../Images/c71e425f4e6fd4af6185a53442823397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2v-5Mh9J6CM-43T2XZJbFg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">card_details_train方差分析测试总结(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pi"><img src="../Images/845f437791bf63ac27def72b04d05650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-XnsJ-TVnw1fecMpSp5Nw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">old_transactions方差分析测试总结(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pj"><img src="../Images/ebb985f5e768123c9d33576b3d31d5fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K-gN0NeCAFh-BXNPojzFxA.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">new_transactions方差分析检验总结(图片由作者提供)</figcaption></figure><h1 id="c208" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">特征工程</h1><p id="8765" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">特征工程是利用领域知识从原始数据中提取特征(特性、性质、属性)的过程。特征是由独立单元共享的属性，对其进行分析或预测。预测模型使用特征并影响结果。应用非常基本的特征工程从每个数据集中提取一些有用的特征。</p><h2 id="4221" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集1:卡_细节_列车&amp;数据集2:卡_细节_测试</strong></h2><p id="22f5" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">由于card_details_train和card_details_test数据集的特征相同，我们对这两个数据集应用了相似的特征工程。</p><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="fe4a" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集4:旧事务&amp;数据集5:新事务</strong></h2><p id="179b" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">由于old_transactions和new_transactions数据集的特征是相同的，我们对这两个数据集应用了相似的特征工程。使用现有要素创建某些新要素，然后对所有创建的要素应用聚合操作。</p><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="22ab" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">观察结果:</h2><ul class=""><li id="1d55" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">使用基本特征工程方法总共创建了32个特征。</li></ul><h1 id="dcc5" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">特征可视化</h1><p id="7f33" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">将学习到的特征显式化的方法称为特征可视化。一些识别的特征相对于目标特征被绘制，以识别它们对目标变量的分布影响。</p><h2 id="db5c" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">旧采购的数量如何影响目标</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pm"><img src="../Images/4378197d1f51a917219ca31fe6b5329b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IqSDjm_Ok-L2BXzJ--n_1g.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">old_transactions中旧采购wrt目标的计数分布(按作者分类的图像)</figcaption></figure><h2 id="fb95" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">旧采购金额的总和如何影响目标</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pm"><img src="../Images/7edfd88d9d7d769d9fd5a26df39c3a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vq3y3Xc9CkLuva-N1bHE3g.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">old_transactions中旧采购总额wrt目标的分布(按作者分类的图像)</figcaption></figure><h2 id="6a37" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">新采购数量如何影响目标</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pm"><img src="../Images/002d9be1fb14f6032feff89c89d12bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0G1Fwpe0dawT2AWvUVXMw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">new_transactions中新采购wrt目标的计数分布(按作者分类的图像)</figcaption></figure><h2 id="d6a7" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">新采购金额之和如何影响目标</strong></h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pm"><img src="../Images/faf71beda90c776a5596dea83d80302c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FGrnHCwPAMNaRRcbLtALbw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">new_transactions中新采购总额wrt目标的分布(按作者分类的图像)</figcaption></figure><h2 id="78b8" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">观察结果:</h2><ul class=""><li id="bcde" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">忠诚度得分似乎随着旧交易次数的增加而降低。</li><li id="5574" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">忠诚度得分似乎随着旧购买总额的增加而增加。</li><li id="fbf0" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">忠诚度得分似乎随着总新购买量的增加而降低，但是忠诚度得分的最小分布也可以在最后一个框中看到。随着新购买总量的增加，可以看到更多的负忠诚度得分。</li><li id="4129" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">忠诚度得分似乎随着新购买总量的增加而增加。在最后的箱中可以观察到更多的负得分。</li></ul><h1 id="8f4a" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">第一次切割溶液</h1><p id="f5e2" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">作为第一个解决方案，我们试图使用一些传统算法建立一个非常基本的机器学习模型。这些模型通过使用一些基本的特征工程方法在上述简单特征上被训练。这些步骤包括:</p><ul class=""><li id="fead" class="ng nh it lp b lq mw lu mx ly ox mc oy mg oz mk nl nm nn no bi translated">将数据分割为要素和标注。</li><li id="690e" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">将数据分为训练集和验证集。</li><li id="0790" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">选择模型。</li><li id="c515" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">超参数调整，调整模型参数以提高性能。</li><li id="4932" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">尽可能经常地训练模型以做出正确的预测。</li><li id="b766" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">使用测试集数据进行预测，该测试集数据在此之前从模型中保留(并且其类别标签是已知的)，用于测试模型；更好地模拟模型在现实世界中的表现。</li></ul><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pn"><img src="../Images/590312da91011f3953afa28b9702da00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WA90lpmzdye7n9-bK0nrg.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">ML步骤(图片由作者提供)</figcaption></figure><h2 id="7789" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">基线模型</h2><p id="5ec8" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">在构建非常基本的模型之前，我们使用目标变量的平均值创建了一个基线模型。这个简单的模型得出的RMSE为3.856821。给出了第一次切割模型预期结果的合理范围。我们相信我们会取得比这更好的成绩。</p><h2 id="92cf" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">模型结构</h2><p id="322c" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">每个基本特征被合并，然后应用于训练传统的机器学习模型。这些功能也与测试集合并，以进一步评估模型在看不见的数据上的性能。最后，捕捉每个训练模型的RMSE分数。</p><h2 id="84ab" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 1。线性回归</strong></h2><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="1362" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak"> 2。支持向量回归机</strong></h2><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="c8c1" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">3.随机森林回归量</h2><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="f32a" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">4.轻型GBM回归器</h2><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="f26f" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">5.带LGBM的自动编码器</h2><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h1 id="59ad" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">高级特征工程</h1><p id="e805" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">应用非常基本的特征工程从每个数据集中提取一些有用的特征。这些特性不足以提高我们模型的性能。需要提取更多相关的和改进的特性，这些特性有可能改进性能指标。从每个数据集中提取了更高级的特征。这些特征最终被合并以构建模型。</p><h2 id="de6b" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集1:卡_细节_火车&amp;数据集2:卡_细节_测试</strong></h2><p id="9441" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">由于card_details_train和card_details_test数据集的特征相同，我们对这两个数据集应用了相似的特征工程。</p><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="5134" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">数据集4:旧事务&amp;数据集5:新事务</strong></h2><p id="cf2e" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">由于old_transactions和new_transactions数据集的特征是相同的，我们对这两个数据集应用了相似的特征工程。使用现有特征创建更有用的新特征，然后对所有创建的特征应用聚合操作。</p><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="b085" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">观察结果:</h2><ul class=""><li id="3ac7" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">所有提取的特征被合并以建立最终的训练和测试集。该训练和测试集用于构建模型。</li><li id="a3c8" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">使用高级特征工程方法，分别为训练集和测试集创建了总共168个和166个特征。</li></ul><h1 id="031e" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">改进的解决方案</h1><p id="d3e2" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">通过适当的分析将数据的复杂性可视化，我们得出的结论是，基于树的模型比任何其他传统模型都要好得多。Google Colab使用基于GPU的设置来训练LGB模型，测试集用于测试模型性能。最后，每次迭代都返回RMSE分数，并最终获得最佳结果。</p><h2 id="0198" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">带KFold的LGB车型</strong></h2><p id="7cb0" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">为了获得最佳性能，需要执行超参数调整。我们使用了<a class="ae ko" href="https://optuna.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> <em class="od"> Optuna </em> </a>来完成这个任务。<em class="od"> Optuna </em>是一个软件框架，用于自动化这些超参数的优化过程。它通过使用不同的采样器，如网格搜索、随机、贝叶斯和进化算法，自动找到最佳超参数值。获得的超参数用于训练具有KFold的LGB模型。</p><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h2 id="4732" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated"><strong class="ak">重复KFold的LGB模型</strong></h2><p id="61be" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">将类似的超参数调谐方法应用于具有重复KFold的LGB模型。因此，获得的最佳超参数也用于训练具有重复KFold的LGB模型。</p><figure class="nc nd ne nf gt kd"><div class="bz fp l di"><div class="pk pl l"/></div></figure><h1 id="9a74" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">模型比较</h1><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi po"><img src="../Images/2d0a182516bc6fab55dd9be665f3becf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*p2DHwd0C4uAkqmW6Ccvojg.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">首次切割解决方案摘要(图片由作者提供)</figcaption></figure><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/219def615777271e6d110e3fdfc2240a.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*xP_8UHUFWHblxsXx5mmWhg.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">改进解决方案摘要(图片由作者提供)</figcaption></figure><p id="7202" class="pw-post-body-paragraph ln lo it lp b lq mw ls lt lu mx lw lx ly my ma mb mc mz me mf mg na mi mj mk im bi translated">上面列出了各型号性能的对比总结。线性模型不足以处理复杂的数据。配备LGBM的AutoEncoder比配备基本功能的其他型号性能稍好，尽管这也是因为我们在AutoEncoder中使用了较少的基本功能。具有高级特征基于树的模型优于具有基本特征的其他传统模型。LGB与反复KFold已经取得了最好的验证RMSE 3.59。</p><h1 id="c704" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">Kaggle分数</h1><h2 id="30d0" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">第一次切割溶液</h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pq"><img src="../Images/24d30a17de917d258c10400066a4197b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKAC0aPWnUqRafAuIK9Xnw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">首款解决方案的排行榜得分(图片由作者提供)</figcaption></figure><h2 id="fe1e" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">改进的解决方案</h2><figure class="nc nd ne nf gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi pr"><img src="../Images/fc752173f6c37f6e6bd9c03b7e44dd1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKdAGrk9BUnQ_2rDg_sTsQ.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk translated">改进解决方案的排行榜得分(图片由作者提供)</figcaption></figure><h1 id="1a92" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论和未来工作</h1><ul class=""><li id="69f0" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated">特征工程在决定模型性能方面发挥了重要作用。可以实现和应用更多的高级和相关特征来增加模型分数。</li><li id="7d3a" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">也可以应用像堆叠这样的集合模型来提高模型的效率。</li><li id="40a8" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated">作为未来的工作，这个案例研究也可以被框定为一个分类问题，目标是对客户是否忠诚进行分类。</li></ul><h1 id="9f2a" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">参考</h1><ul class=""><li id="9a63" class="ng nh it lp b lq lr lu lv ly ni mc nj mg nk mk nl nm nn no bi translated"><a class="ae ko" href="https://www.kaggle.com/c/elo-merchant-category-recommendation" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/elo-merchant-category-推荐</a></li><li id="4d01" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><a class="ae ko" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/code" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/elo-merchant-category-re commendation/code</a></li><li id="a441" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><a class="ae ko" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/discussion" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/elo-merchant-category-推荐/讨论</a></li><li id="f36a" class="ng nh it lp b lq np lu nq ly nr mc ns mg nt mk nl nm nn no bi translated"><a class="ae ko" href="https://en.wikipedia.org/wiki/Main_Page" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/</a></li></ul></div><div class="ab cl ps pt hx pu" role="separator"><span class="pv bw bk pw px py"/><span class="pv bw bk pw px py"/><span class="pv bw bk pw px"/></div><div class="im in io ip iq"><h2 id="dfcc" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">现场演示:</h2><p id="972f" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><a class="ae ko" href="https://share.streamlit.io/shekhartz/elo-app" rel="noopener ugc nofollow" target="_blank">https://share.streamlit.io/shekhartz/elo-app</a></p><h2 id="c668" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">Github:</h2><p id="1fed" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><a class="ae ko" href="https://github.com/shekhartz/elo" rel="noopener ugc nofollow" target="_blank">https://github.com/shekhartz/elo</a></p><h2 id="89ea" class="ml kq it bd kr mm mn dn kv mo mp dp kz ly mq mr ld mc ms mt lh mg mu mv ll iz bi translated">LinkedIn:</h2><p id="d6da" class="pw-post-body-paragraph ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><a class="ae ko" href="https://www.linkedin.com/in/shekhartz/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/shekhartz/</a></p></div></div>    
</body>
</html>