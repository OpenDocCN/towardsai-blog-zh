# 我尝试了语义分割，下面是我学到的东西

> 原文：<https://pub.towardsai.net/i-tried-semantic-segmentation-and-here-is-what-i-learned-c5f49d8913f?source=collection_archive---------2----------------------->

![](img/349547ff9d30d108cba5a6bf38369fb8.png)

图片来源:Cogito

# 介绍

语义分割是一种基于像素的分类任务，具有许多有价值的应用，例如对象检测和图像检索。尽管语义分割很有用，但它很难取得好的效果。在这篇博文中，我将分享我第一次尝试语义分割的经历以及从中得到的教训。

# 什么是语义切分？

语义分割是一种允许识别图像中的对象的计算机视觉技术。这是通过给图像中的每个像素分配一个类别标签来实现的，该类别标签表示在该特定位置存在什么对象。

例如，在包含人和狗的图像中，语义分割将识别对应于属于“人”类的人的像素和对应于属于“狗”类的狗的像素。

语义分割有许多潜在的应用。一个例子是自动驾驶汽车，它需要能够准确识别道路上的物体，以避免事故。另一个例子是医学成像，其中语义分割可以自动识别不同类型的组织(例如，癌性与非癌性)。

我决定尝试语义分割，因为我对探索它在医学成像中的潜在应用感兴趣。我的目标是学习如何使用深度学习实现语义分割，并看看它是否可以用于从 MRI 扫描中准确识别不同类型的组织。

# 为什么我决定尝试语义分割

出于几个原因，我决定尝试语义分段:

> 我想更好地理解这项技术的工作原理及其潜在的应用。
> 
> 我很想看看我是否能改进传统图像分割方法的结果。
> 
> 我想用一个不同于我以前使用的数据集进行实验，看看结果是否会有所不同。

为了实现这些目标，我使用了 CamVid 数据集**(http://mi . eng . cam . AC . uk/research/projects/VideoRec/cam vid/)**。这个数据集包含城市场景的图像，我认为分割这些图像会很有趣。此外，CamVid 数据集附带了每个图像的预先计算的标签，这使得评估我的结果更加容易。

# 我是如何实现语义分割的。

语义分割是一种计算机视觉技术，它将图像中的每个像素分类到预定义的类别中。这不同于传统的图像分类，传统的图像分类只给整个图像分配一个标签。传统的图像分类模型是有限的，因为它们不能提供关于图像的细粒度信息。语义分割通过标记每个像素来实现对图像的更精细理解，从而在对象检测和场景理解任务中做出更好的决策并提高性能。

我决定尝试语义分割有两个原因:

首先，为了更好地理解这项技术，其次，看看它是否能改进我的对象检测模型的结果。我的数据集由汽车、自行车和行人的图像组成，这些图像来自安装在车辆上的摄像机。我使用这个数据集是因为它足够小，便于管理，但又足够大，可以表示真实世界的数据。

数据的预处理相对简单；我必须调整图像的大小，并将它们分成训练集、验证集和测试集。构建语义分割模型更加复杂；我必须决定使用哪种架构(我选择了 U-Net)以及什么损失函数最合适(我选择了交叉熵)。训练模型也很有挑战性；在确定 Adam 的学习率为 0.001 之前，我必须试验不同的优化器和学习率。

总的来说，我发现语义切分没有我预想的那么难。最困难的部分是选择正确的超参数，但一旦我掌握了窍门，即使是这样也不算太糟。我的实验结果很有希望；在我的验证集上，我的模型获得了 0.87 的 IoU 分数，考虑到语义分割是出了名的棘手，这已经很不错了。

# 我的语义分割实验的结果。

**评估指标**

在训练模型之后，我在测试集上使用两个指标对它进行了评估:平均交集/并集(mIOU)和像素精度。mIOU 度量测量预测分割图和基本事实分割图之间的平均重叠。相比之下，像素精度衡量正确分类的像素的百分比。

**定性结果**

总的来说，我对我的语义分割实验的定性结果很满意。在许多情况下，该模型可以正确识别具有多个实体的复杂场景中的对象。

也有一些情况下，模型会出现问题，例如当图像中有明显的遮挡或者对象很小时。

**吸取的教训**

我从这个实验中学到的一个主要教训是，语义切分是一个复杂的问题，还有很大的改进空间。此外，我发现即使是模型架构或训练过程的小变化也会显著影响结果。

总的来说，我发现[语义切分](https://www.cogitotech.com/blog/what-is-semantic-image-segmentation-types)是一个迷人且具有挑战性的问题，我希望在未来继续探索。

# 结论

总的来说，我发现语义分割是一个有价值的工具，有许多潜在的应用。它相对容易实施，并产生了良好的效果。如果你在经营一家企业，那么有几个像 Cogito Tech，Anolytics 这样的公司。AI 和其他提供语义分割服务的软件。仍然有一些需要改进的地方，但是我为我所看到的感到鼓舞。

我期待着在这一领域看到更多的进展。