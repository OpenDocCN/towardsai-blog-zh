<html>
<head>
<title>AI, Sustainability Tweets: Sentiment Analysis Using Pre-trained Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AI，可持续发展推文:使用预先训练的模型进行情绪分析</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/ai-sustainability-tweets-sentiment-analysis-using-pre-trained-models-8669f8ba70ed?source=collection_archive---------0-----------------------#2020-06-11">https://pub.towardsai.net/ai-sustainability-tweets-sentiment-analysis-using-pre-trained-models-8669f8ba70ed?source=collection_archive---------0-----------------------#2020-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="989f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a></h2><div class=""/><div class=""><h2 id="6539" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">完整的代码<a class="ae kr" href="https://github.com/arditoibryan/Projects/tree/master/20200609_Sustainability_Sentiment_Analysis" rel="noopener ugc nofollow" target="_blank">可在我的Github回购</a></h2></div><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/f14c103f1bd85ab203395ddf8bb0e983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xygjOrYZ_regKYnoaLBJDg.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">【https://gurushots.com/michelangiolo.mazzeschi/photos T4】</figcaption></figure><p id="fb02" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在过去的几天里，我一直在关注NLP的潜力，特别是进行情感分析:</p><ul class=""><li id="f0ff" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae kr" href="https://medium.com/towards-artificial-intelligence/sentiment-analysis-on-tweets-with-nlp-achieving-96-accuracy-8b63f0bcee99" rel="noopener">在推特上</a></li><li id="dc7e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae kr" href="https://medium.com/towards-artificial-intelligence/sentiment-analysis-on-movie-reviews-with-nlp-achieving-95-accuracy-91eef597e0f7" rel="noopener">关于电影</a></li></ul><p id="69fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">到目前为止，我已经在我拥有的数据集的一部分上执行了模型的训练(基本上是为了标准实践)。然而，NLP是如此庞大和复杂，以至于要在人类语言上表现良好，它需要在比10k标签样本更大的数据集上训练。</p><h2 id="de47" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">预训练模型</h2><p id="5e0c" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">现代机器学习库不仅提供从头创建模型的工具。他们还为特定用途提供了大量的模型。在这个具体的例子中，我将挖掘包含以下标签的15k条推文:#sustainable和#sustainability。</p><h1 id="9ec1" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">步伐</h1><ol class=""><li id="5d91" class="me mf it lk b ll nk lo nl lr oa lv ob lz oc md od mk ml mm bi translated">采矿推特</li><li id="d130" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md od mk ml mm bi translated">导入模块</li><li id="e769" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md od mk ml mm bi translated">预处理</li><li id="33bc" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md od mk ml mm bi translated">预训练模型</li><li id="4660" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md od mk ml mm bi translated">情感分析</li><li id="600a" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md od mk ml mm bi translated">看看结果</li></ol><h1 id="f124" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">1.采矿推特</h1><h2 id="7a12" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">特温特</h2><p id="23b0" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">twint是python的官方模块，在时间和容量方面没有官方Twitter API的限制。</p><p id="ae4a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">* * *使用该工具时要小心，因为你可能会违反Twitter服务条款。我会明智地使用它，在指定的时间限制内只下载最小量(仅15，000条推文)，以遵守服务条款。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="1089" class="ms mt it of b gy oj ok l ol om">!pip3 install twint</span><span id="b7fe" class="ms mt it of b gy on ok l ol om">import twint</span><span id="451a" class="ms mt it of b gy on ok l ol om">#configure<br/>c = twint.Config()<br/>c.Search = '#sustainable', '#sustainability'<br/>c.Store_csv = True<br/>c.Limit = 10000 #appears not to be working<br/>c.Output = "data.csv"</span></pre><p id="eee5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在设置了研究的主要参数之后，我可以调用配置并开始将tweets存储在data.csv数据集中。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="0091" class="ms mt it of b gy oj ok l ol om"># Run<br/>twint.run.Search(c)</span></pre><h1 id="a5ef" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">2.导入模块</h1><h2 id="bbbb" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">nltk</h2><p id="07d5" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我现在需要为NLP选择一个库。由于它的灵活性和优点，我将使用nltk。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="9e7b" class="ms mt it of b gy oj ok l ol om">!pip install nltk<br/>import nltk<br/>nltk.download('punkt')</span></pre><h1 id="7d18" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">3.预处理</h1><h2 id="b6f7" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">推特数据集</h2><p id="e521" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">* * *出于隐私原因，我从数据集中删除了推文、姓名和用户名的链接。默认情况下，您可以使用twint下载它们。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="9748" class="ms mt it of b gy oj ok l ol om">import pandas as pd<br/>total = pd.read_csv('/content/data.csv')<br/>total = pd.DataFrame(total['tweet'])<br/>total</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/9c3e1fb3f7ecd5c49ea6d8a3f51e039a.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*kAZ-ZBPoT9ohyqeUaXGoDg.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">推特数据集的样本</figcaption></figure><h1 id="78cf" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">4.预训练模型</h1><p id="6075" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">有一个巨大的模型库，你可以通过这个链接下载特定的NLP问题。查列表，最适应我要解决的问题的模型叫做<strong class="lk jd"> VADER情感词典</strong>，标识为<strong class="lk jd">维德_词典</strong> id。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="ac86" class="ms mt it of b gy oj ok l ol om">#nltk.download()<br/>import nltk<br/>nltk.download('vader_lexicon')</span><span id="05fa" class="ms mt it of b gy on ok l ol om">from nltk.sentiment.vader import SentimentIntensityAnalyzer<br/>sid = SentimentIntensityAnalyzer()</span></pre><p id="d5e0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我运行一个例子来展示情感分析的输出:</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="f521" class="ms mt it of b gy oj ok l ol om">sid.polarity_scores('you are hateful')<br/>{'compound': -0.4939, 'neg': 0.615, 'neu': 0.385, 'pos': 0.0}</span></pre><p id="f087" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">‘你是可恨的’这句话被给了一个负值，分值为-.49。到目前为止，我已经评估了模型的有效性(可以这么说)。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="1dd5" class="ms mt it of b gy oj ok l ol om">def dict_converter(dict1):<br/>  dictlist = list()<br/>  for key, value in dict1.items():<br/>    temp = [key,value]<br/>    dictlist.append(temp)<br/>  return dictlist</span><span id="6952" class="ms mt it of b gy on ok l ol om">#example<br/>dict_converter({'neg': 0.0, 'neu': 1.0, 'pos': 0.0, 'compound': 0.0})</span></pre><p id="0e32" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因为输出将是一个字典，我需要使用上面的函数将它转换成一个列表。</p><h1 id="3f72" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">5.情感分析</h1><p id="7432" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我有我需要的一切:数据和一个训练有素的模型。对于数据集中的每条推文，我会在右边的栏中附上情感分析得分。然后，我将把结果列表转换成熊猫数据帧。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="a791" class="ms mt it of b gy oj ok l ol om">tweets = list()<br/>for g in total['tweet']:<br/>  dict_res = dict_converter(sid.polarity_scores(g))<br/>  #nltk.sentiment.util.demo_vader_instance(_)<br/>  tweets.append([g, dict_res[0][1], dict_res[1][1], dict_res[2][1], dict_res[3][1]])<br/>import pandas as pd<br/>tweets = pd.DataFrame(tweets)<br/>tweets.columns = ['text', 'neg', 'neu', 'pos', 'compound']<br/>tweets</span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi op"><img src="../Images/03bf3cfc7163ea8ca8fcc936bd6bc45e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*45Oueos1WwLZQVHMB-M_qQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">完整数据集的样本</figcaption></figure><p id="acef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我已经执行了分析，不幸的是，我没有办法评估模型的性能，因为我的所有数据从一开始就没有标记。</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="97a9" class="ms mt it of b gy oj ok l ol om">tweets.shape<br/>(14756, 5)</span></pre><h2 id="961f" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">消除重复</h2><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="a293" class="ms mt it of b gy oj ok l ol om">tweets = tweets.drop_duplicates()<br/>tweets.shape<br/>(6582, 5)</span></pre><p id="091c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我现在将从最积极到最消极对推文进行评分。我可以看到熊猫的结果，但我也可以下载我的数据集并用Excel打开它:</p><pre class="kt ku kv kw gt oe of og oh aw oi bi"><span id="1e6e" class="ms mt it of b gy oj ok l ol om">tweets = tweets.sort_values(['compound'], ascending=False)<br/>tweets.to_csv('tweets.csv')</span></pre><h1 id="e800" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">6.看看结果</h1><p id="37b9" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我进行的情感分析无法让我了解人们是支持还是反对可持续发展(如果他们使用#可持续发展标签，我们可以假设发推文的人是支持它的)，但它让我们能够识别写推文时使用的语气。一些人可能会以积极的方式回应可持续发展的号召，而另一些人可能会觉得表达自己的愤怒是表达意见的最佳选择。</p><h2 id="38b4" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">正面和负面的推文</h2><p id="6f59" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">数据的分数范围在[-.88，. 97]内，其中-1表示非常负面，0表示中性，+1表示非常正面。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi oq"><img src="../Images/e56a5c5159f2038381aa8a4c308b2800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ROiidxTICfc0pPjxGtDW0A.png"/></div></div></figure><p id="c55e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">* * *鉴于一些推文的侮辱性质，我不希望使用图片。它们是随机选择的，因此我无法指责或控制我正在下载的内容。</p><p id="2384" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该数据集总共统计了6583条推文:</p><ul class=""><li id="e5a5" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">3184条正面推文</li><li id="9027" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">2938条中性推文</li><li id="a6a7" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">461条负面推文</li></ul><p id="1b08" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以推断，写可持续发展的人对它持积极态度。</p><h1 id="7db9" class="np mt it bd mu nq nr ns mx nt nu nv na ki nw kj nd kl nx km ng ko ny kp nj nz bi translated">例子</h1><p id="89c6" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我选择了分布两端的两条推文向大家展示:</p><h2 id="497e" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">正面推文:. 96</h2><p id="6bfc" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">希望倡导可持续发展协会全体成员祝您地球日快乐！多么美好的一天来庆祝我们这个美丽的星球。#可持续发展#地球日2020 #可持续发展#户外#户外#地球日# HC _ Green @ hopephisplant @ HopeCollegeSAC '</p><h2 id="d762" class="ms mt it bd mu mv mw dn mx my mz dp na lr nb nc nd lv ne nf ng lz nh ni nj iz bi translated">负面推文:-.78</h2><p id="ae0f" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">200年来，我们一直在征服自然。现在我们要把它打死。——汤姆·麦克米兰</p></div></div>    
</body>
</html>