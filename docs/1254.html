<html>
<head>
<title>Fully Explained Linear Regression with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python全面解释线性回归</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/fully-explained-linear-regression-with-python-fe2b313f32f3?source=collection_archive---------0-----------------------#2020-12-14">https://pub.towardsai.net/fully-explained-linear-regression-with-python-fe2b313f32f3?source=collection_archive---------0-----------------------#2020-12-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ec14" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，<a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><div class=""><h2 id="f2ed" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如何用一个真实的例子解决回归问题。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi kr"><img src="../Images/533c9556d8979d73aee475ea174bc178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*lGdH8VA3gRmERTKdopVSkA.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">以最小误差拟合到最佳位置。作者图片</figcaption></figure><p id="25f2" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">简单线性回归用于预测分析和做出推断。在这种类型中，有一个自变量和一个因变量。每当建模中出现因果关系时，我们就会进行回归分析。当我们使用因子分析技术时，性能在实时分析中更精确。监督机器学习中的回归分析基础。这里需要注意三件重要的事情:</p><ul class=""><li id="34ce" class="lz ma it lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated">我们需要数据来进行分析，对于整个人口来说，这是一项非常繁琐的任务，所以我们需要样本数据来进行分析。</li><li id="4a33" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">获得数据后，我们需要设计一个模型，使其适用于所有人群。</li><li id="65f8" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">建模后，我们可以对人口进行预测。</li></ul><div class="mn mo gp gr mp mq"><a href="https://medium.com/towards-artificial-intelligence/rust-zero-to-hero-basic-introduction-in-a-new-programming-language-part-1-3-d7fe175f190e" rel="noopener follow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd jd gy z fp mv fr fs mw fu fw jc bi translated">RUST:新编程语言入门(第1/3部分)</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">一种非常适合安全和控制的语言</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">medium.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne kx mq"/></div></div></a></div><p id="0422" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">前面，我们注意到它是因果型建模。我们得到了线性回归。线性意味着随着原因的增加，结果也在增加，所以两者是平行变化的。我们需要一些数学方法来得到线性预测。所以我们用一条直线的方程来得到一条直线的性质。</p><p id="3d59" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">直线的方程式是</p><blockquote class="nf"><p id="84da" class="ng nh it bd ni nj nk nl nm nn no ly dk translated">y = mx + b</p></blockquote><p id="6cdb" class="pw-post-body-paragraph ld le it lf b lg np kd li lj nq kg ll lm nr lo lp lq ns ls lt lu nt lw lx ly im bi translated">这里，</p><p id="073e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> Y </strong>是因变量(结果)或预测变量。</p><p id="9257" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> X </strong>是一个<strong class="lf jd"> </strong>自变量。</p><p id="1ac8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> M </strong>是一个斜率，或者我们可以说是梯度。</p><p id="27ca" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> B </strong>是y轴上的截距值。</p><p id="b996" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">Y是x的函数。回归模型是线性近似。为了一个好的预测，我们需要找到<strong class="lf jd"> B </strong>和<strong class="lf jd"> M. </strong></p><p id="4895" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">示例:</p><p id="b36a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">假设我们有能量和公里数的健康数据。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/621412c197f9e9e029595a58c33313eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*LoyLcERlvvXp85yUTPvGmw.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</figcaption></figure><p id="85cd" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们需要找到B<strong class="lf jd">和M</strong>和<strong class="lf jd">T21。下面给出了计算这些值的公式:</strong></p><p id="7740" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">M =样本数* ( XY总和- X总和*Y总和)/样本数* (X平方和- X总和的平方)</p><p id="ffda" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">B = Y总和- M * X总和/样本数</p><p id="1c33" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">图像显示了这些值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/d995bdfd338b96b8cb77d83c5e9fa74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*VuJPmneFarud34i37cQ4hg.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</figcaption></figure><p id="3028" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">算完值，M得出1.89，B得出0.667。根据这些值，我们可以从公式中得到一个预测值。</p><blockquote class="nf"><p id="8e89" class="ng nh it bd ni nj nk nl nm nn no ly dk translated">Y = 1.89*X + 0.667</p></blockquote><p id="c0e8" class="pw-post-body-paragraph ld le it lf b lg np kd li lj nq kg ll lm nr lo lp lq ns ls lt lu nt lw lx ly im bi translated">在检查一些X值来预测公里数之后。下面显示了一个示例:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/71daabc4bab73e6481d2827e4b00a05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68BV_etT_F06q1YN5mOmHA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">基于新X值的预测公里数。作者图片</figcaption></figure><p id="1417" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们得到了我们的模型，但一个简单的技术。让我们用python检查一下我们是否得到相同的值。</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="2468" class="og oh it oc b gy oi oj l ok ol">#import all the libraries</span><span id="3e87" class="og oh it oc b gy om oj l ok ol">import numpy as np <br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import statsmodels.api as sm</span></pre><p id="08ae" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">读取excel文件</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="c677" class="og oh it oc b gy oi oj l ok ol">df = pd.read_excel("fitness.xlsx")</span></pre><p id="d07e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">使用describe函数查看统计数据。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi on"><img src="../Images/73590cd0630b2532f603a92f0b5c3621.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*NqWVUgBZrOQb_XZBhvUwLg.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</figcaption></figure><p id="1403" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">把数据分割成x和y。</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="b5c8" class="og oh it oc b gy oi oj l ok ol">y = df['Y1']<br/>x = df['X1']</span><span id="66c0" class="og oh it oc b gy om oj l ok ol">#plot the scatter plot between them</span><span id="d64c" class="og oh it oc b gy om oj l ok ol">plt.scatter(x,y)<br/>plt.xlabel('Energy', fontsize =20)<br/>plt.ylabel('Kms Covered', fontsize =20)<br/>plt.show()</span></pre><p id="9589" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们几乎得到一个线性相关。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/d9760303ba7af2265d7daa80400091e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*X2bmzxlqifrSh9UwLGzKdg.png"/></div></figure><p id="aea6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在根据我们的数据拟合OLS模型。</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="d4d5" class="og oh it oc b gy oi oj l ok ol">x_new = sm.add_constant(x)<br/>output = sm.OLS(y, x_new).fit()<br/>output.summary()</span><span id="01fd" class="og oh it oc b gy om oj l ok ol">#output:</span><span id="9b88" class="og oh it oc b gy om oj l ok ol">                coef        <br/>---------------------------------<br/>const          0.667   <br/>x1             1.89</span></pre><p id="5bda" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在得到摘要之后，我们得到相同的值。这里我们使用statsmodels，它是一个优秀的统计和推理库。</p><p id="58ee" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">拟合后，OLS模型让我们用拟合的线检查散点图。</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="0029" class="og oh it oc b gy oi oj l ok ol">plt.scatter(x1,y)<br/>y_pred = 1.89*X + 0.667<br/>fig = plt.plot(x1, y_pred, lw = 5, c='red', label='regression line' </span><span id="fcd4" class="og oh it oc b gy om oj l ok ol">plt.xlabel('Energy', fontsize =20)<br/>plt.ylabel('Kms Covered', fontsize =20)<br/>plt.show()</span></pre><p id="6cd1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是最佳直线拟合后的散点图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi op"><img src="../Images/df9ece21a50def9bccc2ef0558bda3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*GVTPrxoZAsBdvhcIGiA-KA.png"/></div></figure><p id="72ca" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">结论:</p><p id="7ac7" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">OLS提供了一个简单的线性回归近似值，而statsmodel提供了对数据统计的精彩见解。</p><p id="2479" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae oq" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae oq" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="b1e7" class="or oh it bd os ot ou ov ow ox oy oz pa ki pb kj pc kl pd km pe ko pf kp pg ph bi translated">推荐文章</h1><p id="1c58" class="pw-post-body-paragraph ld le it lf b lg pi kd li lj pj kg ll lm pk lo lp lq pl ls lt lu pm lw lx ly im bi translated">1.<a class="ae oq" rel="noopener ugc nofollow" target="_blank" href="/15-most-usable-numpy-methods-with-python-4d20eb93e149?sk=911d2bebf042b148be8f366b907af158">Python最有用的15种NumPy方法</a> <br/> 2。<a class="ae oq" rel="noopener ugc nofollow" target="_blank" href="/numpy-linear-algebra-on-images-ed3180978cdb?source=friends_link&amp;sk=d9afa4a1206971f9b1f64862f6291ac0"> NumPy:图像上的线性代数</a>T5】3。<a class="ae oq" rel="noopener ugc nofollow" target="_blank" href="/exception-handling-concepts-in-python-4d5116decac3?source=friends_link&amp;sk=a0ed49d9fdeaa67925eac34ecb55ea30">Python中的异常处理概念</a> <br/> 4。<a class="ae oq" rel="noopener ugc nofollow" target="_blank" href="/pandas-dealing-with-categorical-data-7547305582ff?source=friends_link&amp;sk=11c6809f6623dd4f6dd74d43727297cf">熊猫:处理分类数据</a> <br/> 5。<a class="ae oq" rel="noopener ugc nofollow" target="_blank" href="/hyper-parameters-randomseachcv-and-gridsearchcv-in-machine-learning-b7d091cf56f4?source=friends_link&amp;sk=cab337083fb09601114a6e466ec59689">超参数:机器学习中的RandomSeachCV和GridSearchCV</a><br/>6。<a class="ae oq" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python </a> <br/> 7全面讲解了线性回归。<a class="ae oq" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python </a> <br/>充分解释了Logistic回归8。<a class="ae oq" rel="noopener ugc nofollow" target="_blank" href="/data-distribution-using-numpy-with-python-3b64aae6f9d6?source=friends_link&amp;sk=809e75802cbd25ddceb5f0f6496c9803">数据分发使用Numpy与Python </a> <br/> 9。<a class="ae oq" href="https://medium.com/pythoneers/40-most-insanely-usable-methods-in-python-a983c78f5bfd?sk=07df9058ea3e8c2fce4318a73cd8fce9" rel="noopener"> 40种Python中最疯狂可用的方法</a> <br/> 10。<a class="ae oq" href="https://medium.com/pythoneers/20-most-usable-pandas-shortcut-methods-in-python-c9bc065ce11e?sk=1faf673d0cdfb46234975cbdeed12beb" rel="noopener">Python中最常用的20种熊猫快捷方式</a></p></div></div>    
</body>
</html>