<html>
<head>
<title>Teaching an AI Rock, Paper, Scissors!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教安AI石头剪刀布！</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/teaching-an-ai-rock-paper-scissors-6c49fd9173a8?source=collection_archive---------0-----------------------#2021-08-16">https://pub.towardsai.net/teaching-an-ai-rock-paper-scissors-6c49fd9173a8?source=collection_archive---------0-----------------------#2021-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b636" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="34be" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用机器学习方法来教人工智能在两个石头、布、剪刀玩家做出选择时谁会赢。全湾可用<a class="ae kr" href="https://github.com/arditoibryan/Projects/tree/master/20210215_Rock_Papaer_Scissors" rel="noopener ugc nofollow" target="_blank">在我的回购</a>。</h2></div><p id="3fa4" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">在这篇文章中，我将创建一个非常简单的分类软件，能够通过例子学习石头、布、剪刀的规则。这不是一个传统的ML模型，我下载了一个数据集作为例子，将它分成训练和测试分区，然后训练模型以获得准确性分数。因为ML可以很容易地记忆数据集(这种做法被称为过拟合，是训练ML模型时的主要问题)，所以我会通过例子让这个AI过拟合数据集来记忆它的规则。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/0c5d3131b122a612ad63c84eafc9797a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*shEoKdwkjV2j2Zfn6WLnnQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">石头、剪刀、布的最高级版本:Kontrappali和Sheldon玩石头、剪刀、布、蜥蜴、斯波克、大爆炸理论</figcaption></figure><p id="15dd" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">如果您已经知道如何用python编程，您会注意到您可以使用一个简单的If语句来模拟相同的过程。这篇文章的重点，不要被误解，不是集中在一个复杂的算法来解释，而是采取一个非常简单的问题，如石头，布，剪刀，并找到另一种方法来解决它。如果你是机器学习的新手，这可能会帮助你更好地理解分类。</p><h1 id="106f" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">导入库</h1><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="7222" class="nb mf it mx b gy nc nd l ne nf">import itertools<br/>import pandas as pd<br/>import numpy as np</span></pre><p id="19db" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">我要做的第一件事是创建所有可能的石头、剪子、布比赛中每个玩家的所有可能的选择组合。</p><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="7675" class="nb mf it mx b gy nc nd l ne nf">#permutation with repetitions<br/>df = pd.DataFrame([p for p in itertools.product(['Rock', 'Paper', 'Scissor'], repeat=2)])<br/>df</span></pre><p id="c41c" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">然后，我将添加Player1的结果分数，并将这一列值用作标签。1表示赢，0表示平，-1表示输。例如，当玩家1选择石头，玩家2选择纸时，玩家1获胜，因此相应的标签为1。</p><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="1c80" class="nb mf it mx b gy nc nd l ne nf">#add results after index based encoding<br/>df['result'] = ['0', '-1', '1', '1', '0', '-1', '-1', '1', '0']</span></pre><h2 id="7c61" class="nb mf it bd mg ng nh dn mk ni nj dp mo lb nk nl mq lf nm nn ms lj no np mu iz bi translated">One_hot编码</h2><p id="1ac8" class="pw-post-body-paragraph ks kt it ku b kv nq kd kx ky nr kg la lb ns ld le lf nt lh li lj nu ll lm ln im bi translated">现在，我需要对数据执行one_hot编码。如果我没有遵循这一步，模型可能会将数据解释为连续的。</p><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="f253" class="nb mf it mx b gy nc nd l ne nf">#perform one_hot on players (otherwise the data is interpreted as sequential)<br/>from sklearn.preprocessing import OneHotEncoder</span><span id="d0ca" class="nb mf it mx b gy nv nd l ne nf">def one_hot(df, partitions):<br/>  #togliamo le colonne da X<br/>  for col in partitions:<br/>    k = df.pop(col)<br/>    k = pd.get_dummies(k, prefix=col)<br/>    df = pd.concat([df, k] , axis=1)<br/>  return df</span><span id="d800" class="nb mf it mx b gy nv nd l ne nf">df = one_hot(df, df.columns[:-1])<br/>df</span></pre><h2 id="e8a4" class="nb mf it bd mg ng nh dn mk ni nj dp mo lb nk nl mq lf nm nn ms lj no np mu iz bi translated">提取要素和标注</h2><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="7008" class="nb mf it mx b gy nc nd l ne nf">#extract features<br/>X = df[df.columns[1:7]]<br/>X</span><span id="ba3c" class="nb mf it mx b gy nv nd l ne nf">#extract labels<br/>y = df[df.columns[0]]<br/>y</span></pre><h2 id="a3f0" class="nb mf it bd mg ng nh dn mk ni nj dp mo lb nk nl mq lf nm nn ms lj no np mu iz bi translated">训练模型</h2><p id="b8bc" class="pw-post-body-paragraph ks kt it ku b kv nq kd kx ky nr kg la lb ns ld le lf nt lh li lj nu ll lm ln im bi translated">现在是时候使用一个非常简单(并且非常不灵活)的分类模型来训练模型了。我选择使用支持向量机作为主要模型。</p><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="a8da" class="nb mf it mx b gy nc nd l ne nf">#classification model<br/>from sklearn import svm</span><span id="5c14" class="nb mf it mx b gy nv nd l ne nf">clf = svm.SVC(probability=True)<br/>clf.fit(X, y)</span></pre><h2 id="0498" class="nb mf it bd mg ng nh dn mk ni nj dp mo lb nk nl mq lf nm nn ms lj no np mu iz bi translated">用预测做实验</h2><p id="f9b0" class="pw-post-body-paragraph ks kt it ku b kv nq kd kx ky nr kg la lb ns ld le lf nt lh li lj nu ll lm ln im bi translated">现在模型完成了！人工智能是否正确地学习了石头、布、剪刀的规则？让我们来测试一下:如果两个玩家都使用Rock ([0，1，0，0，1，0])，结果是0，到目前为止工作得很好！</p><pre class="lp lq lr ls gt mw mx my mz aw na bi"><span id="6887" class="nb mf it mx b gy nc nd l ne nf">#predict output<br/>#0_Paper 0_Rock 0_Scissor 1_Paper 1_Rock 1_Scissor<br/>clf.predict([[0, 1, 0, 0, 1, 0]])<br/>clf.predict_proba([[0, 1, 0, 0, 1, 0]])</span></pre><h2 id="2d47" class="nb mf it bd mg ng nh dn mk ni nj dp mo lb nk nl mq lf nm nn ms lj no np mu iz bi translated">下一步是什么？</h2><p id="5cf7" class="pw-post-body-paragraph ks kt it ku b kv nq kd kx ky nr kg la lb ns ld le lf nt lh li lj nu ll lm ln im bi translated">显然，石头、剪刀、布的最高级版本仍然需要以人工智能的形式来设计，那就是石头、剪刀、布、蜥蜴、斯波克！！！</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/088a815673a245ce653ddf059970f819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*tPLmarcjTiD6sUV7"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">石头剪刀布蜥蜴史波克逻辑</figcaption></figure></div></div>    
</body>
</html>