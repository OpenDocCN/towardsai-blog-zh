<html>
<head>
<title>Quantify the Performance of Classifiers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">量化分类器的性能</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/quantify-the-performance-of-classifiers-f73c33199631?source=collection_archive---------2-----------------------#2022-06-26">https://pub.towardsai.net/quantify-the-performance-of-classifiers-f73c33199631?source=collection_archive---------2-----------------------#2022-06-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d997c693fdcc16090a727854322d45ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*crDZaNzaDshIrTSo.jpg"/></div></div></figure><p id="d3ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我们将讨论下面的问题，并试图找到答案。</p><ul class=""><li id="81e6" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">文章的题目是什么意思？</li><li id="c6c4" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">什么是混淆矩阵？</li><li id="231e" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">什么是准确度、精确度和召回率？</li><li id="af51" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">F1-score是什么？</li><li id="4200" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">ROC和AOC分别代表什么？</li><li id="a7df" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">如何用python实现这些东西？</li></ul><h1 id="c8e7" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">文章的题目是什么意思？</h1><p id="6597" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">在机器学习中，在用训练数据集训练模型之后，我们现在必须用测试数据评估训练好的模型。在回归模型中，我们有不同的度量标准，如R平方得分、均方误差等。度量在回归问题中，精确度通常用实际值和预测值之间的差异来衡量。在分类问题中，使用所生成的混淆矩阵来测量模型的可信度，即预测真阳性和真阴性的准确程度。那么，现在让我们来理解混淆矩阵。</p><h1 id="49fb" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">什么是混淆矩阵？</h1><p id="42f8" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">它是一个矩阵，用于评估任何分类器的性能。换句话说，混淆矩阵可视化并总结了分类算法的性能。让我们来做一个简单的二进制分类，然后混淆矩阵会看起来像下面的图片。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/0ed8a9d5a3abb38b70acb5cc2ae5b224.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*6MnwiP1_RNFE_dWM2i0VfA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">二元混淆矩阵</figcaption></figure><p id="4869" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">真阳性(TP): </strong>被分类模型预测为阳性并且也是阳性的结果</p><p id="204b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">真阴性(TN): </strong>被分类模型预测为阴性并且也是阴性的结果</p><p id="2d0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">假阳性(FP): </strong>分类模型预测为阳性但实际为阴性的结果</p><p id="768e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">假阴性(FN): </strong>被分类模型预测为阴性但实际为阳性的结果。</p><h1 id="b502" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">什么是精确度和召回？</h1><h2 id="c540" class="mw ll iq bd lm mx my dn lq mz na dp lu kj nb nc ly kn nd ne mc kr nf ng mg nh bi translated">精确度:</h2><p id="ec33" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">准确度可以说是定义为正确分类的总数除以分类的总数。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/fbe44133d032a3d3eb9c04fb515f9f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*ceM0AquYNeUp7y9jZ8wrGw.png"/></div></figure><h2 id="a800" class="mw ll iq bd lm mx my dn lq mz na dp lu kj nb nc ly kn nd ne mc kr nf ng mg nh bi translated">精度:</h2><p id="e9f7" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">精确度是在所有积极的预测中，有多少实际上是积极的。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/f0d394c4515eee48b800e092621bfe6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*BmTXBTXlNHOZ_Z-bwdPsbA.png"/></div></figure><p id="c2a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经看到了公式和精度的定义，但为了更好地理解，让我们举个例子。假设我们有一个问题陈述，我们必须对一个人是否有罪进行分类。因此，在这种情况下，我们必须建立一个模型，专注于准确预测真正的阳性(即他/她有罪)。通过这样做，模型可能会丢失一些真正有罪的人。因为如果我们认为释放一个犯了罪的人比释放一个没有犯罪企图但被判有罪的人更好。因此，通过使用精度，我们可以测量模型如何在实际的阳性和假阳性中预测真阳性。</p><h2 id="6e2e" class="mw ll iq bd lm mx my dn lq mz na dp lu kj nb nc ly kn nd ne mc kr nf ng mg nh bi translated">回忆:</h2><p id="fd3d" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">召回率是对阳性结果总数和模型正确预测的阳性结果数量的衡量。它显示了该模型仅在正面结果方面的相关性。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1809cb0ba1ab5ede4cde0f794551d97d.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*38qfZrIuhtQj4o6GXqcQjA.png"/></div></figure><p id="89a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经看到了回忆的公式和定义，但为了更好地理解，让我们举个例子。假设我们有一个问题陈述，我们必须对患者是否患有癌症进行分类。因此，在这种情况下，我们必须建立一个模型，专注于预测尽可能多的癌症患者。在这个过程中，该模型可能预测患者没有患癌症为真。但是，如果我们认为，预测一个患有癌症的患者比不预测一个实际上患有癌症的患者更好。</p><h2 id="7029" class="mw ll iq bd lm mx my dn lq mz na dp lu kj nb nc ly kn nd ne mc kr nf ng mg nh bi translated">精确度和召回率之间的权衡</h2><p id="9606" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">精确度和召回率显示了它们之间的一种奇怪的关系，就好像你想要达到精确度，那么模型的召回率就会下降，反之亦然。让我们举一个例子来想象一个场景，其中的要求是模型召回所有没有还贷的违约者。假设有10个这样的违约者，回想这10个违约者，模型给你20个结果，其中只有10个是真正的违约者。现在，模型的召回率是100%，但准确率下降到50%。</p><p id="11b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以在下图中观察到这种行为。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/3912fa37aad7a32a951a902e30aa2567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*UI7pGDXZlKCt9lo15TaG1g.png"/></div></figure><p id="d5b7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们可以观察到的，如果我们提高召回率，那么精确度就会急剧下降。因此，问题来了，我们如何选择什么是正确的度量标准来评估我们的模型。所以，最简单的答案是，这取决于问题陈述。如果你预测癌症，你需要100 %的回忆。但是假设你在预测一个人是否无辜，你需要100%的精度。但另一个问题是，我们如何衡量模型的整体性能。所以答案就是F1的分数，我们接下来会理解。</p><h1 id="8c3f" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">F1-score是什么？</h1><p id="b655" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">很明显，我们需要一个同时考虑精确度和召回率的指标来评估一个模型。一个这样的指标是F1分数。F1分数被定义为精确度和召回率的调和平均值。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/bd4493abf1cbd44cd1242afd9ba92f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*U0GvBzTO1NZvTuwe7ndCFg.png"/></div></figure><h1 id="e302" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">ROC和AOC分别代表什么？</h1><p id="7d27" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">在我们跳到了解ROC和AOC之前。我们首先明白我们为什么需要它们。所以，如果我们观察到大多数分类模型给我们一个类的概率，它不会给出像0和1这样的硬值。这就有了门槛的概念。设定一个阈值，任何低于阈值的概率值都是负面结果，任何高于阈值的都是有利或正面结果。</p><p id="acf3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在的问题是，理想的阈值应该是多少？要回答这个问题，我们先来了解ROC。</p><h2 id="fb40" class="mw ll iq bd lm mx my dn lq mz na dp lu kj nb nc ly kn nd ne mc kr nf ng mg nh bi translated">受试者工作特性曲线</h2><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/8301c405fc723ea5ef417cd56c176592.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*qD4lkJj6p9I1RD4nMMZ3sg.png"/></div></figure><p id="d16a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在数学上，它代表了不同阈值的不同混淆矩阵。每个黑点是一个混淆矩阵。绿色虚线表示真阳性率等于假阳性率的情况。从曲线中可以明显看出，当我们从最右边的点向左移动时，在某个阈值之后，假阳性率降低。一段时间后，假阳性率变为零。用绿色圈出的点是最好的点，因为它正确地预测了所有的值，并将误报率保持在最低。但这不是经验法则。根据要求，我们需要选择一个阈值点。ROC曲线回答了我们选择哪个阈值的问题。</p><p id="1a9d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我们使用了不同的分类算法，并且已经绘制了相应算法的不同roc。问题是:现在选择哪种算法？要回答这个问题，我们先来理解AOC。</p><h2 id="65cb" class="mw ll iq bd lm mx my dn lq mz na dp lu kj nb nc ly kn nd ne mc kr nf ng mg nh bi translated">曲线下面积</h2><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b539bb0ac5368704bca49d666130a968.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*PXUn8FSo1YMl7r-OGXBmDA.png"/></div></figure><p id="5ad5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">AOC帮助我们在绘制ROC曲线的模型中选择最佳模型。最好的模型是包含其下最大面积的模型。</p><h1 id="88b1" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">如何用python实现这些东西？</h1><p id="efb8" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">现在，我们已经从理论上学习了所有的东西，让我们来写一些代码。</p><p id="8867" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从python导入基本模块和包。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/9b092ec0db9afe436c5684941acd0739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*5yfCJmR9wt75VwadYBsaTw.png"/></div></figure><p id="bd6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从sklearn加载玩具数据集。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/cb7a139ff188e1d1c05246f6e4dae862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6xnPv7UoNwraJ27cbbFu4Q.png"/></div></div></figure><p id="d5fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，训练测试分成两部分，因为我们关注的是准确性、F1分数等。因此，我们不会对数据集进行预处理或执行任何EDA。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/4d65fbb70a0478d6848f6ae464e3378e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*87zF5pwQVOKg4hmkCGjAsQ.png"/></div></div></figure><p id="ec97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">训练和预测数据。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/a607c8cde12fa599b65eec9dc07a7b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*9xtyDyY-GiJ_0B9sa1vp4Q.png"/></div></figure><p id="f519" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们将评估您的分类器的性能。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/07ce5da17b0b99e9f921decbec67e3b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*o6RFx4nVcMr2OoODJBYWYw.png"/></div></figure><p id="bb62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">精确度:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/5b546cad753efc889dad5801a1fd418b.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*r229_J6jh7lpuYkmbFvj5g.png"/></div></figure><p id="3ab4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">精确度和召回率:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/848c143f8521be6562745b7b6b47d06e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*6RYLQVMWIbJX9URJ603SXg.png"/></div></figure><p id="c20c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">F1分数:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/35266a92152f02486598fa3ed163ab14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*qLFQ7MK28TVcTJoq24C-iw.png"/></div></figure><blockquote class="nw nx ny"><p id="9b8e" class="jy jz nz ka b kb kc kd ke kf kg kh ki oa kk kl km ob ko kp kq oc ks kt ku kv ij bi translated"><em class="iq">本文使用的笔记本链接:</em></p></blockquote><div class="od oe gp gr of og"><a href="https://github.com/Akashdawari/Articles_Blogs_Content/blob/main/Quantify%20the%20Performance%20of%20Classifiers.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">articles _ Blogs _ Content/量化分类器的性能。ipynb at main …</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">这个知识库包含了jupyter关于发表在博客上的文章的笔记本。…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">github.com</p></div></div><div class="op l"><div class="oq l or os ot op ou jw og"/></div></div></a></div><p id="6634" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">喜欢并分享如果你觉得这篇文章有帮助。还有，关注我的medium，了解更多机器学习和深度学习相关的内容。</p></div></div>    
</body>
</html>