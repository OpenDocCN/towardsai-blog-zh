<html>
<head>
<title>Understand Time Series Components with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python理解时间序列组件</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/understand-time-series-components-with-python-4bc3e2ba1189?source=collection_archive---------0-----------------------#2021-04-11">https://pub.towardsai.net/understand-time-series-components-with-python-4bc3e2ba1189?source=collection_archive---------0-----------------------#2021-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="edfe" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-visualization" rel="noopener ugc nofollow" target="_blank">数据可视化</a></h2><div class=""/><div class=""><h2 id="923a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">机器学习中预测模型的基本概念及实例</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c25dfb1837f042cb94e8f1695f577ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSFv31DstyNGdBRdRjW-pw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">一堆时间序列术语。作者的照片</figcaption></figure><p id="0342" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本文中，我们将通过处理数据中时间成分的机器学习示例来讨论时间序列概念。</p><p id="a7db" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">预测在银行业、天气、人口预测以及许多直接处理现实生活问题的领域都非常重要。</p><p id="6c2e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">时间序列模型是基于时间的函数。测量以规则的时间间隔进行，其中时间是建模的独立变量。</p><p id="a7cb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> Z = f(t) </strong></p><p id="501c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> Z </strong>是Z1，Z2……Zn的值，“<strong class="lj jd"> t </strong>是T1，T2……的时间。Tn个区间。</p><h2 id="7595" class="md me it bd mf mg mh dn mi mj mk dp ml lq mm mn mo lu mp mq mr ly ms mt mu iz bi translated">涵盖的主题:</h2><ol class=""><li id="ed14" class="mv mw it lj b lk mx ln my lq mz lu na ly nb mc nc nd ne nf bi translated"><strong class="lj jd">时间序列的组成部分</strong></li><li id="c702" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc nc nd ne nf bi translated"><strong class="lj jd">白噪声</strong></li><li id="eea6" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc nc nd ne nf bi translated"><strong class="lj jd">静止和非静止</strong></li><li id="db1d" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc nc nd ne nf bi translated"><strong class="lj jd">滚动统计和Dickey-Fuller检验</strong></li><li id="bc29" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc nc nd ne nf bi translated"><strong class="lj jd">差分和分解</strong></li><li id="7594" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc nc nd ne nf bi translated"><strong class="lj jd"> AR、MA、ARMA、ARIMA模型</strong></li><li id="a0d8" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc nc nd ne nf bi translated"><strong class="lj jd"> ACF和PACF </strong></li></ol><p id="db4b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">时间序列分析的应用例如:每日汽油价格、公司利润、季度房屋销售。</p><p id="a57d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">时间序列分析的能力</p><ul class=""><li id="3009" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated">这是预测决策的有效方法。</li><li id="e814" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc no nd ne nf bi translated">它们被用来预测不确定的未来以帮助组织。</li><li id="205b" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc no nd ne nf bi translated">当与数据挖掘技术结合使用时，它用于分析数据的行为。</li></ul><blockquote class="np nq nr"><p id="8133" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it">时间序列的组成</em> </strong></p></blockquote><p id="f4c8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们开始对时间序列数据建模之前，有一些基本的定义和概念。主要地，在时间序列中主要有四种类型的成分，如下所述:</p><ul class=""><li id="f8db" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd">趋势:</strong></li></ul><p id="c8e4" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">它是随着时间减少或增加的数据值的移动。任何数据序列都可能有上升趋势和下降趋势。</p><p id="7a78" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上升趋势是那些随着时间而增加的趋势。下降趋势是那些随着时间而减少的趋势。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/b689560e42c2db8282c7934fc11b0370.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*jnPFDtShRTmusY0Tmp37fA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">趋势的运动。作者的照片</figcaption></figure><p id="b406" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Python的例子:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="488f" class="md me it ny b gy oc od l oe of">#to make a month column with added day<br/>data['Month'] = data['Month'].apply(lambda x: dt(int(x[:4]),<br/>                                                   int(x[5:]), 15))</span><span id="7ca6" class="md me it ny b gy og od l oe of">data = data.set_index('Month')<br/>data.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/241e965a256b4f1e239202ab0e0b3a95.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*o6fOmNcyi_pBhsWt8W-jhg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作为索引的月份。作者的照片</figcaption></figure><p id="74b0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在，绘制折线图来看趋势。</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="42ca" class="md me it ny b gy oc od l oe of">ts = data['#Passengers']<br/>plt.plot(ts)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/f82d9da65e5242b2e1c9dd87f8c35fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*PvLyTU7Bx1kcW5HaRwOk8Q.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">数据的趋势。作者的照片</figcaption></figure><p id="421b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有时，当索引不是日期-时间数据类型时，有必要将日期-时间作为索引列，以便所有特征都成为时间的函数。</p><p id="c10b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="03e9" class="md me it ny b gy oc od l oe of">df.month = pd.to_datetime(df.month)<br/>df.set_index('month', inplace=True)</span></pre><ul class=""><li id="287f" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd">季节性和周期:</strong></li></ul><p id="7c2d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">季节性是数据在固定时间间隔内的重复行为。这意味着，在一段时间间隔之后，有一些模式会重复出现，我们称之为季节性。</p><p id="385c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如，在上面的图中，下行峰值和上行峰值以规则的时间间隔出现。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/0b2d5911f9c3bcb628751fcb77aa09ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*NEOWjmjixbH9oSp98p6Fjw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">数据的季节性。作者的照片</figcaption></figure><p id="edab" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">季节性和周期性的区别在于，季节性总是有一个固定的和已知的频率。周期也有上升和下降高峰，但没有固定的频率或至少两年的持续时间。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/d7ac5b168a9516ab16d932f98fbba67d.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*_BkteNzT1fph79TJeq4oRw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">数据中的循环模式。作者的照片</figcaption></figure><ul class=""><li id="2087" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd">变化和不规则:</strong></li></ul><p id="e757" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">变化和不规则模式不是固定的频率模式，而是持续时间短且不重复的模式。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/e939e9307a23969af8d194f01a56bfcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*Gf4F9GE_hP8jjnG2lN26gA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">随机变化和不规则。作者的照片</figcaption></figure><blockquote class="np nq nr"><p id="4b36" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it">白噪音</em> </strong></p></blockquote><p id="3727" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">白噪声是一个属于时间序列中模式部分的术语，其中我们不能进行预测/预报，因为下一个值与前一个值没有相关性，该模式部分具有零均值和恒定方差。</p><p id="0844" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里要注意的要点是，白噪声具有零均值和恒定方差，因此，这意味着数据点将是具有标准正态分布的高斯白噪声。但是当我研究各种链接时，我注意到白噪声可以是均匀分布而不是正态分布。</p><p id="34a5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="b842" class="md me it ny b gy oc od l oe of">import numpy<br/>import matplotlib.pyplot as plt</span><span id="a065" class="md me it ny b gy og od l oe of">mean_value = 0<br/>std_dev = 1 <br/>no_of_samples = 500<br/>time_data = numpy.random.normal(mean_value, std_dev, size=no_of_samples)</span><span id="17f7" class="md me it ny b gy og od l oe of">plt.plot(time_data)<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/839cda20b22fc8122dccb93e6ed4bf63.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*FX-aJFFSJD4c1kzapU91pw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">时间序列中的白噪声。作者的照片</figcaption></figure><p id="6bf5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">同样正确的是，白噪声是具有不同频率的随机数据，因此它可以是任何分布。另一方面，正态分布在离散过程中受到连续白噪声的影响。</p><p id="d167" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="564a" class="md me it ny b gy oc od l oe of">import numpy as np<br/>import seaborn as sns</span><span id="dc6f" class="md me it ny b gy og od l oe of">#mean value and standard deviation value<br/>mean, std = 0, 1</span><span id="118f" class="md me it ny b gy og od l oe of">#Normal distribution with 5000 samples<br/>samples = np.random.normal(mean, std, size=5000)</span><span id="1065" class="md me it ny b gy og od l oe of">#plotting normal distribution with seaborn library<br/>sns.distplot(samples, bins=20, hist_kws={'edgecolor':'red'})</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/d9d3262331b81a3d5203ff9592c56920.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*3fus5sORQbId41DoXrbjSA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">白噪声的正态分布。作者的照片</figcaption></figure><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/diabetes-classification-model-with-svm-and-knn-models-3e8570747ef5"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd jd gy z fp ov fr fs ow fu fw jc bi translated">糖尿病分类模型有SVM模型和KNN模型</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">预测糖尿病的二元分类</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">pub.towardsai.net</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe lb oq"/></div></div></a></div><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/z-statistics-t-statistics-p-statistics-are-still-confusing-you-87557047e20a"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd jd gy z fp ov fr fs ow fu fw jc bi translated">Z-统计量，T-统计量，P-统计量还在迷惑你？</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">机器学习统计学中的定义和概念</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">pub.towardsai.net</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe lb oq"/></div></div></a></div><blockquote class="np nq nr"><p id="bc0a" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it">静止与非静止</em> </strong></p></blockquote><p id="0f8e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">平稳时间序列是一个时间周期，其平均值不变，方差不变，自相关性也不随时间变化。这些是制作模型必须满足的标准。</p><p id="038c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">非平稳时间序列是均值、方差和自相关随时间变化的一段时间。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/39717f07084fc80622f2cd46cecc5028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dw4hq_YqOTJHHkfzp8yviw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><p id="446a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果序列不是平稳的，那么我们用某种方法或测试使数据是平稳的。</p><p id="3fdb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">变换后达到平稳的点如下图:</strong></p><ul class=""><li id="3a8d" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated">如果数据不是稳定的，那么我们可以在新的序列中减去一个点。</li><li id="d34c" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc no nd ne nf bi translated">如果数据显示一个趋势，那么我们可以用另一条曲线与数据进行卷积，并取出残差。</li><li id="41f0" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc no nd ne nf bi translated">如果方差是时变的，那么我们可以用平方根或对数来稳定方差。</li></ul><blockquote class="np nq nr"><p id="e278" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it">滚动统计和Dickey-Fuller检验</em> </strong></p></blockquote><p id="5620" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">执行这两个测试是为了检查时间序列的平稳性。</p><p id="8082" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">滚动统计就是检验序列的移动均值和移动方差是否随时间变化。这是一种视觉类型测试结果。</p><p id="2fc6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Dickey-Fuller检验是一种假设检验，其中检验统计值小于p值，那么我们将拒绝零假设。这个时间序列的零假设是非平稳的。</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="181e" class="md me it ny b gy oc od l oe of">def test_stationarity(timeseries):<br/>    <br/>    #Determing rolling statistics<br/>    rolmean = timeseries.rolling(window=52,center=False).mean() <br/>    rolstd = timeseries.rolling(window=52,center=False).std()</span><span id="4306" class="md me it ny b gy og od l oe of">    #Plot rolling statistics:<br/>    orig = plt.plot(timeseries, color='blue',label='Original')<br/>    mean = plt.plot(rolmean, color='red', label='Rolling Mean')<br/>    std = plt.plot(rolstd, color='black', label = 'Rolling Std')<br/>    plt.legend(loc='best')<br/>    plt.title('Rolling Mean &amp; Standard Deviation')<br/>    plt.show(block=False)<br/>    <br/>    #Perform Dickey-Fuller test:<br/>    print ('Results of Dickey-Fuller Test:')<br/>    dftest = adfuller(timeseries, autolag='AIC')<br/>    dfoutput = pd.Series(dftest[0:4], index=['Test Statistic','<br/>            p-value','#Lags Used','Number of Observations Used'])<br/>    for key,value in dftest[4].items():<br/>        dfoutput['Critical Value (%s)'%key] = value<br/>    print (dfoutput)</span><span id="dafb" class="md me it ny b gy og od l oe of">test_stationarity(data['#Passengers']</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/3a1ca9256a64769365869bddcf4716a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*FHCO11N9VnxNJTPZVNhp3w.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">两个检验来检查平稳性。作者的照片</figcaption></figure><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/hypothesis-testing-in-statistics-with-examples-844d698d99d5"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd jd gy z fp ov fr fs ow fu fw jc bi translated">统计学中的假设检验及实例</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">数据驱动决策的统计学概念</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">pub.towardsai.net</p></div></div><div class="oz l"><div class="pi l pb pc pd oz pe lb oq"/></div></div></a></div><blockquote class="np nq nr"><p id="9769" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it">求差分解</em> </strong></p></blockquote><p id="c7e5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">假设我们发现我们的时间序列是非平稳的，那么有两种技术可以使我们的数据成为大量平稳的时间序列。</p><ul class=""><li id="642a" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd">差分:</strong>用于将趋势、非平稳序列转化为平稳序列，并控制自相关性。它用于计算过去值与当前值之间的差值。</li></ul><p id="d7ff" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">差异过大的序列会产生不准确的估计。所以，这并不代表所有的情况。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/cfdd382b46463ad1380706507f8a686b.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*vv93twEovlw_V3NjnEd5MA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><ul class=""><li id="1129" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd">分解:</strong>通过回归序列并从回归中提取残差，对序列执行分解。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/b3b933d2063669233c86d5589e4fb418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*3fn3pILgA00tqAcYuNIQIg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><blockquote class="np nq nr"><p id="19a9" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it"> AR，MA，ARMA，</em> </strong></p></blockquote><p id="95fe" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在建模中有不同的模型来拟合时间序列数据。</p><ul class=""><li id="5b6e" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd"> AR模型:</strong>基于过去值的加权和预测未来值的自回归模型。</li></ul><p id="a8ab" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当时间序列中的值与前一个和后一个值之间存在相关性时，它用于预测。</p><ul class=""><li id="f0f1" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd"> MA模型:</strong>是一种移动平均模型，用于预测一个仅依赖于随机误差项的时间序列的未来值。</li></ul><p id="e407" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="7b6a" class="md me it ny b gy oc od l oe of">#transformation<br/>ts_log = np.log(ts)</span><span id="f65b" class="md me it ny b gy og od l oe of">plt.plot(ts_log)</span><span id="e9a0" class="md me it ny b gy og od l oe of">#calculating moving average <br/>MA = ts_log.rolling(window=12).mean()<br/>movingSTD = ts_log.rolling(window=12).std()<br/>plt.plot(ts_log)<br/>plt.plot(MA, color='red')</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/3b1496d26806de301bb0e198952c469a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*yjtfNlyriLPLl1vVQKY7-A.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><ul class=""><li id="390b" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd"> ARMA模型:</strong>它是一种自回归和移动平均模型，用于使用过去的数据和误差项来预测未来的值。自回归模型告诉我们交易市场的均值和动量。MA部分记录了在白噪声条件下观察到的冲击效应。</li><li id="56f2" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc no nd ne nf bi translated">ARIMA模型:它是一种自回归综合移动平均模型，是一类用于预测和分析时间序列数据的统计模型。它有助于做出巧妙的时间序列预测。它是简单ARMA模型的推广，增加了积分的概念。</li></ul><p id="7994" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在ARIMA模型之前，我们可以用移动平均线来区分。如果没有差异(d=0)，那么该模型通常被称为ARMA模型。</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="b89f" class="md me it ny b gy oc od l oe of">ts_log_mv_diff = ts_log - MA</span></pre><blockquote class="np nq nr"><p id="9037" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it"> ACF和PACF </em> </strong></p></blockquote><ul class=""><li id="3529" class="mv mw it lj b lk ll ln lo lq nl lu nm ly nn mc no nd ne nf bi translated"><strong class="lj jd"> ACF: </strong>它是时间序列的自相关函数，用于识别MA过程的阶数。它是当前时间点的值和滞后p点的值之间的相关系数。</li><li id="c533" class="mv mw it lj b lk ng ln nh lq ni lu nj ly nk mc no nd ne nf bi translated"><strong class="lj jd"> PACF: </strong>它是一个偏相关函数，用来识别AR过程的阶数。</li></ul><p id="4ad8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如对于ACF:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="3db4" class="md me it ny b gy oc od l oe of">plt.plot(np.arange(0,11), acf(ts_log_mv_diff, nlags = 10))<br/>plt.axhline(y=0,linestyle='--',color='gray')<br/>plt.axhline(y=-7.96/np.sqrt(len(ts_log_mv_diff)),linestyle='--<br/>            ',color='gray')</span><span id="13aa" class="md me it ny b gy og od l oe of">plt.axhline(y=7.96/np.sqrt(len(ts_log_mv_diff)),linestyle='--<br/>            ',color='gray')</span><span id="90c5" class="md me it ny b gy og od l oe of">plt.title('Autocorrelation Function')<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/f8eff25e842464737a9fff2ab7bed318.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*k2_sPN7w9QUozNW1W229ig.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><p id="960e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当滞后值在0和1之间时，ACF曲线穿过置信上限。因此，" 0 "或" 1 "是ARIMA模型的一个最佳值。</p><p id="5eec" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以PACF为例:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="71c4" class="md me it ny b gy oc od l oe of">plt.plot(np.arange(0,11), pacf(ts_log_mv_diff, nlags = 10))<br/>plt.axhline(y=0,linestyle='--',color='gray')<br/>plt.axhline(y=-7.96/np.sqrt(len(ts_log_mv_diff)),linestyle='--<br/>            ',color='gray')</span><span id="190a" class="md me it ny b gy og od l oe of">plt.axhline(y=7.96/np.sqrt(len(ts_log_mv_diff)),linestyle='--<br/>            ',color='gray')</span><span id="12ef" class="md me it ny b gy og od l oe of">plt.title('Partial Autocorrelation Function')<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/ecd7a71ac0550fe4eaff8227ac7850fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*HrToNsDTsPwWtkwyhisfwQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><p id="3d6a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在滞后值1和2之间，PACF曲线下降到0。因此，" 0 "或" 1 "是ARIMA模型的一个最佳值。</p><p id="9a3d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">要符合ARIMA模型，如下例所示:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="cb00" class="md me it ny b gy oc od l oe of">model = ARIMA(ts_log, order=(1, 1, 0))  <br/>results_ARIMA = model.fit(disp=-1)  <br/>plt.plot(ts_log_mv_diff)<br/>plt.plot(results_ARIMA.fittedvalues, color='red')<br/>plt.title('RSS: %.4f'% sum((results_ARIMA.fittedvalues[1:] - ts_log_mv_diff)**2))</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi po"><img src="../Images/9a790c88fc41f2655b75e3a94e8f4164.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*VHAoOGXVKyu_sC8ozR8LXw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者的照片</figcaption></figure><p id="ec20" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">要查找ARIMA时间序列中的预测，示例如下所示:</p><pre class="ks kt ku kv gt nx ny nz oa aw ob bi"><span id="9372" class="md me it ny b gy oc od l oe of">predictions_ARIMA_diff = pd.Series(results_ARIMA.fittedvalues, copy=True)</span><span id="b446" class="md me it ny b gy og od l oe of">predictions_ARIMA_diff_cumsum = predictions_ARIMA_diff.cumsum()</span><span id="2dc8" class="md me it ny b gy og od l oe of">predictions_ARIMA_log = pd.Series(ts_log.ix[0], index=ts_log.index)</span><span id="9674" class="md me it ny b gy og od l oe of">predictions_ARIMA_log = predictions_ARIMA_log.add(predictions_ARIMA_diff_cumsum,fill_value=0)</span><span id="19c3" class="md me it ny b gy og od l oe of">predictions_ARIMA = np.exp(predictions_ARIMA_log)<br/>plt.plot(ts)<br/>plt.plot(predictions_ARIMA)<br/>plt.title('RMSE: %.4f'% np.sqrt(sum((predictions_ARIMA-ts)**2)/len(ts)))</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/7d57963b7be41325b3a8932150afde84.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*g1b3NySJMnxydiwQX2PTPg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">ARIMA模型预测实例</figcaption></figure><p id="ca6a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">橙色曲线是我们的预测。</p><blockquote class="np nq nr"><p id="845b" class="lh li ns lj b lk ll kd lm ln lo kg lp nt lr ls lt nu lv lw lx nv lz ma mb mc im bi translated"><strong class="lj jd"> <em class="it">结论:</em> </strong></p></blockquote><p id="a601" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当我们做时间序列建模时，有时模型在预测趋势方面很好，但在季节性方面却失败了。本文是为初学者编写的，目的是学习时间序列的基本概念，没有合适的建模，但有一个python示例。</p><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/functions-and-its-concepts-in-python-df08138fbca2"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd jd gy z fp ov fr fs ow fu fw jc bi translated">Python中的函数及其概念</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">函数中参数的组成和类型</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">pub.towardsai.net</p></div></div><div class="oz l"><div class="pq l pb pc pd oz pe lb oq"/></div></div></a></div><p id="b898" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae pr" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae pr" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="0a6e" class="ps me it bd mf pt pu pv mi pw px py ml ki pz kj mo kl qa km mr ko qb kp mu qc bi translated">推荐文章</h1><p id="3585" class="pw-post-body-paragraph lh li it lj b lk mx kd lm ln my kg lp lq qd ls lt lu qe lw lx ly qf ma mb mc im bi translated"><a class="ae pr" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener"> 1。NLP —零到英雄与Python </a> <br/> 2。<a class="ae pr" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a>T5】3 .<a class="ae pr" rel="noopener ugc nofollow" target="_blank" href="/exception-handling-concepts-in-python-4d5116decac3?source=friends_link&amp;sk=a0ed49d9fdeaa67925eac34ecb55ea30">Python中的异常处理概念</a> <br/> 4。<a class="ae pr" rel="noopener ugc nofollow" target="_blank" href="/principal-component-analysis-in-dimensionality-reduction-with-python-1a613006d531?source=friends_link&amp;sk=3ed0671fdc04ba395dd36478bcea8a55">用Python进行主成分分析降维</a> <br/> 5。<a class="ae pr" href="https://medium.com/towards-artificial-intelligence/fully-explained-k-means-clustering-with-python-e7caa573176a?source=friends_link&amp;sk=9c5c613ceb10f2d203712634f3b6fb28" rel="noopener">用Python全面讲解K-means聚类</a> <br/> 6。<a class="ae pr" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python </a> <br/> 7全面讲解了线性回归。<a class="ae pr" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python </a> <br/>充分解释了Logistic回归8。<a class="ae pr" href="https://medium.com/towards-artificial-intelligence/basic-of-time-series-with-python-a2f7cb451a76?source=friends_link&amp;sk=09d77be2d6b8779973e41ab54ebcf6c5" rel="noopener">用Python实现时间序列的基础知识</a> <br/> 9。<a class="ae pr" rel="noopener ugc nofollow" target="_blank" href="/data-wrangling-with-python-part-1-969e3cc81d69?source=friends_link&amp;sk=9c3649cf20f31a5c9ead51c50c89ba0b">与Python的数据角力—第一部分</a> <br/> 10。<a class="ae pr" href="https://medium.com/analytics-vidhya/confusion-matrix-in-machine-learning-91b6e2b3f9af?source=friends_link&amp;sk=11c6531da0bab7b504d518d02746d4cc" rel="noopener">机器学习中的混淆矩阵</a></p></div></div>    
</body>
</html>