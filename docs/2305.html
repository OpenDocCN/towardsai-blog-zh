<html>
<head>
<title>[DBT] Add Query comments for better debugging [Tip-3]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[DBT]添加查询注释以便更好地调试[提示3]</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/dbt-add-query-comments-for-better-debugging-tip-3-255f02a848dd?source=collection_archive---------3-----------------------#2021-11-07">https://pub.towardsai.net/dbt-add-query-comments-for-better-debugging-tip-3-255f02a848dd?source=collection_archive---------3-----------------------#2021-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7e1b" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/software-engineering" rel="noopener ugc nofollow" target="_blank">软件工程</a></h2><div class=""/><p id="c617" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">定制从dbt触发的每个查询中的查询注释</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ku"><img src="../Images/81a6f37a8b912634e62d923736afb5e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hx2Q3-40j9PbdQBFnmibcg.png"/></div></div></figure><p id="6773" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">在dbt中使用<code class="fe lg lh li lj b">query_comment</code>,我们可以定制注释以注入到每个由dbt触发的查询中。比如查询由哪个<code class="fe lg lh li lj b">user/role</code>，在哪个<code class="fe lg lh li lj b">warehouse</code>和什么<code class="fe lg lh li lj b">profile</code>上运行等。</p><h2 id="d284" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kh lt lu lv kl lw lx ly kp lz ma mb iw bi translated">dbt的默认注释</h2><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mc"><img src="../Images/02eeaf89ae7bbbf561fcbf7b6f5bf2d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-0JRyTZqewuulXeZZV-ZbA.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">来源:<a class="ae mh" href="https://docs.getdbt.com/reference/project-configs/query-comment" rel="noopener ugc nofollow" target="_blank">https://docs . get dbt . com/reference/project-configs/query-comment</a></figcaption></figure><p id="c86a" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">默认情况下，注释将被添加到查询的前面，以防您希望注释位于查询的末尾。在<code class="fe lg lh li lj b">dbt_project.yml</code>中设置<code class="fe lg lh li lj b">append</code>模式</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi mi"><img src="../Images/1079e11b7b14c7e62ffb4269f95c7ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U8UhCjG9hW2Bqi60gOWB4Q.png"/></div></div></figure><h2 id="acee" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kh lt lu lv kl lw lx ly kp lz ma mb iw bi translated">使用宏自定义注释</h2><p id="6533" class="pw-post-body-paragraph jw jx iq jy b jz mj kb kc kd mk kf kg kh ml kj kk kl mm kn ko kp mn kr ks kt ij bi translated">在dbt项目的宏部分下的<code class="fe lg lh li lj b">query_comment.sql</code>中添加下面的宏</p><figure class="kv kw kx ky gt kz"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="deff" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">并将宏添加到<code class="fe lg lh li lj b">dbt_project.yml</code></p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d36457236321153ebc9b410c91435b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*-lA9eylvZDGU43sP-BQK7w.png"/></div></figure><p id="059b" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">下面的注释将被附加到从dbt触发的所有查询中。您可以在雪花历史选项卡的查询历史下看到这一点。</p><pre class="kv kw kx ky gt mr lj ms mt aw mu bi"><span id="e1dd" class="lk ll iq lj b gy mv mw l mx my">/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "transformer_profile", "target_name": "dev", "target_database": "silver", "target_warehouse": "transform_wh", "target_user": "transform_user", "target_role": "transformer", "target_account": "dev-account", "file": "models/silver/fin/silver__fin__invest.sql", "node_id": "model.transformer.silver__fin__invest", "node_name": "silver__fin__invest", "resource_type": "model", "package_name": "transformer", "relation": {"database": "silver", "schema": "fin", "identifier": "invest"}} */</span></pre><p id="9aaf" class="pw-post-body-paragraph jw jx iq jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ij bi translated">上面相同的代码也维护在这个不断增长的git存储库中。</p><div class="mz na gp gr nb nc"><a href="https://github.com/karthikeyan-sivabaskaran/dbt-tips-and-tricks-series" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ja gy z fp nh fr fs ni fu fw iz bi translated">GitHub-karthikeyan-sivabaskaran/dbt-tips-and-tricks-series:这个回购将继续增长以演示…</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq le nc"/></div></div></a></div><blockquote class="nr ns nt"><p id="2a5d" class="jw jx nu jy b jz ka kb kc kd ke kf kg nv ki kj kk nw km kn ko nx kq kr ks kt ij bi translated">我希望这篇文章能帮助你定制查询注释。如果你喜欢这个博客，请分享给你的队友，朋友，鼓掌👏在1到50英寸的范围内。<a class="ae mh" href="https://help.medium.com/hc/en-us/articles/115011350967-Claps" rel="noopener">每篇帖子最多可以鼓掌50次</a>。</p></blockquote><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ny"><img src="../Images/33419286c9e8c4432ef3e1df155ebbde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Uu5mGXSt_liYo3eE"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">照片由威尔·麦克马汉在<a class="ae mh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><blockquote class="nr ns nt"><p id="b236" class="jw jx nu jy b jz ka kb kc kd ke kf kg nv ki kj kk nw km kn ko nx kq kr ks kt ij bi translated"><strong class="jy ja">快乐评论！</strong></p><p id="8b8d" class="jw jx nu jy b jz ka kb kc kd ke kf kg nv ki kj kk nw km kn ko nx kq kr ks kt ij bi translated">这篇文章是DBT提示和技巧系列的一部分。以前的文章如下:</p></blockquote><div class="mz na gp gr nb nc"><a href="https://medium.com/@kar9475/dbt-override-default-schema-with-custom-schema-name-tip-1-2e6ec59141b7" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ja gy z fp nh fr fs ni fu fw iz bi translated">[DBT]用自定义模式名覆盖默认模式[提示-1]</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">问题</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="nz l nn no np nl nq le nc"/></div></div></a></div><div class="mz na gp gr nb nc"><a href="https://medium.com/@kar9475/dbt-set-snowflake-query-tag-for-each-dbt-model-tip-2-665a3e557d6e" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ja gy z fp nh fr fs ni fu fw iz bi translated">[DBT]为每个DBT模型设置雪花查询标签[提示-2]</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">DBT的查询标记特性是一种特定于数据库的配置。在本文中，让我们看看如何为…定制它</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="oa l nn no np nl nq le nc"/></div></div></a></div></div></div>    
</body>
</html>