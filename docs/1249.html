<html>
<head>
<title>Web Scraping With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行Web抓取</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/web-scraping-with-python-6d01f5e9378f?source=collection_archive---------0-----------------------#2020-12-13">https://pub.towardsai.net/web-scraping-with-python-6d01f5e9378f?source=collection_archive---------0-----------------------#2020-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="377f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a>，<a class="ae ep" href="https://towardsai.net/p/category/web-scraping" rel="noopener ugc nofollow" target="_blank">网页抓取</a></h2><div class=""/><div class=""><h2 id="48aa" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如何在Python中使用漂亮的soup和请求库进行网页抓取</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/cf1cca906d0ad81d027dd7ca57aa1161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8DBKuamC7hyOC7-x"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="70fb" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><strong class="lr jd"> <em class="ml">免责声明:</em> </strong> <em class="ml">本文仅出于教育目的。我们不鼓励任何人抓取网站，尤其是那些可能有条款和条件反对此类行为的网站。</em></p><p id="3bcf" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">网上有大量的数据可供访问。知道如何检索和分析这些数据是一项非常有用的技能。在本教程中，我们将使用python请求和漂亮的Soup库来快速抓取这些数据。在本教程结束时，您将能够使用请求库请求一个网页，使用漂亮的Soup库解析它，然后使用pandas的库创建一个包含抓取数据的dataframe。我们将使用jupyter笔记本记录代码。</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h2 id="e939" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">什么是网页抓取？</h2><p id="2d2f" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">Web抓取是从网站收集或提取数据的过程。这个过程可以分为两个主要步骤:使用requests库从指定的源(比如网站)发出HTTP请求，然后使用Beautiful Soup库解析这个请求。在本教程中，我们将通过这个<a class="ae lh" href="https://stats.espncricinfo.com/ci/engine/records/averages/batting.html?class=2;current=2;id=6;type=team" rel="noopener ugc nofollow" target="_blank">链接</a>收集印度国际板球队的击球率。</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h2 id="00a2" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">发出HTTP请求</h2><p id="2098" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">首先，我们将使用requests库从一个网站发出一个HTTP请求，目的是从一个网页获取数据，比如它的源代码。</p><p id="0c09" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">首先，我们需要确保安装了请求库。您可以使用以下命令来完成此操作:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="4535" class="mm mn it nk b gy no np l nq nr">pip install requests</span></pre><p id="e498" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">然后，我们必须在您的代码中导入请求模块:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="cd5b" class="mm mn it nk b gy no np l nq nr">import requests</span></pre><p id="d695" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">接下来，我们将使用get方法获取一个网页。对于这种方法，我们必须包括我们想要从其请求网页的任何内容的URL:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="958b" class="mm mn it nk b gy no np l nq nr">source = requests.get('<a class="ae lh" href="https://stats.espncricinfo.com/ci/engine/records/averages/batting.html?class=2;current=2;id=6;type=team" rel="noopener ugc nofollow" target="_blank">https://stats.espncricinfo.com/ci/engine/records/averages/batting.html?class=2;current=2;id=6;type=team</a>')</span></pre><p id="6da6" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">get方法返回一个我们保存到源变量的响应对象。这个响应对象是服务器对我们的HTTP请求的响应。</p><p id="93eb" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果我们只是打印这个对象，我们得到这个输出:<response>。这告诉我们它是一个HTTP状态代码为200的响应对象。HTTP状态代码200告诉我们这个HTTP请求是成功的。</response></p><p id="374e" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">要查看该对象(或任何python对象)的不同属性和方法，可以使用dir函数。help函数为我们提供了关于这些属性和方法的更多信息。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="abb2" class="mm mn it nk b gy no np l nq nr">dir(source)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/b2c73d8634fcd60aa2174ab05e60d663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-IVcSQKjVBYaznpCtZRF2g.png"/></div></div></figure><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="755b" class="mm mn it nk b gy no np l nq nr">help(source)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nt"><img src="../Images/903e5a3f5aa167f8ba0c52e079bc87c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TUTnp8nyqRSPycB3UmHnIg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">我们的源对象的一些方法</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/d33c8d46ef609f1a56957860bdb32ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*nBYV73RNhIxFBW76VBQjRA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">我们的源对象的属性</figcaption></figure><p id="82fc" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如您所见，status_code是这个对象的属性之一。与任何对象一样，可以使用点运算符来访问属性。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="dae2" class="mm mn it nk b gy no np l nq nr">source.status_code</span></pre><p id="d5cf" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">同样，由于这个HTTP请求成功，我们得到状态代码200。我们还可以使用ok属性来确保这个HTTP请求是成功的。如果我们的请求返回一个小于400的状态代码，那么它返回True，因为一个400或500的状态代码分别意味着我们有一个客户端错误或服务器错误。否则，它返回False。</p><p id="edc5" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">要访问这个对象的内容(Unicode格式)，我们可以访问这个响应对象的text属性:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="3b78" class="mm mn it nk b gy no np l nq nr">source.text</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/4b51141905bfae0044cec4425a76e864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D98InEm0x9tlHxNZBFE56Q.png"/></div></div></figure><p id="1882" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">注意，响应对象也有一个内容属性。这将返回以字节而不是Unicode表示的响应内容。因为在这个例子中，我们的响应对象是由文本组成的，所以我们将使用text属性。但是，如果我们的响应对象包含非文本内容，比如图像，那么我们将使用content属性。</em></p><p id="6ee0" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">请注意，我们可以结合上述步骤来获取响应对象的文本属性，并使用以下代码将其保存到源变量中:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="b532" class="mm mn it nk b gy no np l nq nr">source = requests.get('<a class="ae lh" href="https://stats.espncricinfo.com/ci/engine/records/averages/batting.html?class=2;current=2;id=6;type=team" rel="noopener ugc nofollow" target="_blank">https://stats.espncricinfo.com/ci/engine/records/averages/batting.html?class=2;current=2;id=6;type=team</a>').text</span></pre><p id="0526" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">你可以认为这是我们网页的源代码。它是服务器用Unicode对我们的HTTP请求的响应内容。</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h2 id="17cf" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">美味的汤</h2><p id="ee1d" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">现在，我们将使用漂亮的Soup库来解析来自HTTP请求的响应，并检索板球运动员的击球率。然后，我们将根据这些信息制作一个熊猫数据帧，然后将数据帧保存到一个CSV文件中。</p><h2 id="f8a3" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">安装漂亮的汤库:</h2><p id="9a9c" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">在我们继续之前，我们必须用下面的命令安装漂亮的汤库:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="3fba" class="mm mn it nk b gy no np l nq nr">pip install beautifulsoup4</span></pre><h2 id="d532" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">安装HTML解析器:</h2><p id="d7b8" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">然后，我们必须安装一个解析器来解析从HTTP请求中获取的HTML。我们将使用以下命令安装LXML解析器:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="a083" class="mm mn it nk b gy no np l nq nr">pip install lxml</span></pre><h2 id="2b19" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">导入漂亮的汤库:</h2><p id="0a07" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">然后，我们将导入漂亮的汤库:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="7da2" class="mm mn it nk b gy no np l nq nr">from bs4 import BeautifulSoup</span></pre><h2 id="2a49" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">创建一个漂亮的汤对象:</h2><p id="d23c" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">现在我们已经有了上面的源变量，我们可以将它传递给我们的BeautifulSoup构造函数来创建下面的BeautifulSoup对象:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="4e9f" class="mm mn it nk b gy no np l nq nr">soup = BeautifulSoup(source, 'lxml')</span></pre><p id="46e1" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">注意:我们传入了从响应对象的文本属性中获取的HTML和HTML解析器。然后，我们将这个BeautifulSoup实例分配给变量Soup。</em></p><p id="d0b6" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果我们打印这个soup对象，我们将从网页上看到HTML。但是，要将其格式化为可读性更强的格式，我们可以使用prettify方法:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="083c" class="mm mn it nk b gy no np l nq nr">print(soup.prettify())</span></pre><p id="a301" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">注意，我们现在可以清楚地看到哪些HTML标签相互嵌套。</em></p><h2 id="179d" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">访问漂亮的Soup对象中的标签:</h2><p id="13ca" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">HTML被组织成标签。有两种方法可以从我们创建的soup对象中访问标记及其内容:1)使用点运算符(类似于访问对象的属性)，或者2)使用find方法。</p><p id="ba2c" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">使用点运算符:<br/> </em>例如，如果我们想从我们的网页中访问body标签中的所有内容，我们将使用以下内容:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="a830" class="mm mn it nk b gy no np l nq nr">soup.body</span></pre><p id="39e5" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">注意:这将返回标签和标签中的内容。</em></p><p id="9b3f" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">然而，使用点操作符的问题是，它只会返回它在HTML中遇到的第一个带有指定标记名的标记。例如，如果我们使用soup.div，它将返回第一个div标签及其内容。因此，在使用点运算符后，很难指定我们是哪个标签及其内容。这就是find方法的用武之地。</p><p id="b224" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">使用find方法:<br/> </em>对于find方法，我们能够传递多个参数，这些参数将通过使用标签属性(如id或class)来准确指定我们要查找的标签。我们首先传入标签的名称，然后我们可以指定标签的属性，比如HTML标签的特定类或id。例如，如果我们想要网页中包含击球平均数表的标签，我们可以右键单击该表，单击inspect，然后看到我们的表包含在class属性等于engineTable的表标签中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/091d0b1fcbea51b5f29d166f93426c02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egnQg7NxPAekSVd8KeoU9Q.png"/></div></div></figure><p id="5657" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">因此，要访问第一次出现的带有engineTable类的表标记，我们可以使用:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="f125" class="mm mn it nk b gy no np l nq nr">soup.find('table', class_='engineTable')</span></pre><p id="d9d9" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">这将返回第一个出现的带有engineTable类的表标签及其所有内容。注意，我们使用了class_ parameter(而不是class ),因为class是一个python关键字。</em></p><p id="4db5" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">为了找到具有指定属性的标签的所有实例，而不仅仅是第一次出现，我们需要使用find_all方法。find_all方法将返回与我们的参数匹配的所有标签的列表。然后我们可以遍历列表，从中提取特定的信息。然而，在我们的例子中，find方法是有效的，因为我们只对带有特定类的标签的第一个实例感兴趣。</p><h2 id="4016" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">正在检索信息:</h2><p id="51ef" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">对于本教程，我们将改为以tbody标记为目标来检索击球率，因为这样会更清楚一些。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/c32e1bd1dfafbeffaee53cb297586ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dA8qaHfpezOrDQ0RceL8fQ.png"/></div></div></figure><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="9800" class="mm mn it nk b gy no np l nq nr">table_body = soup.find('tbody').text</span></pre><p id="6df4" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated"><em class="ml">注意:我们使用text属性只提取没有HTML标签的文本，并将其赋给变量table_body。</em></p><h2 id="568f" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">清理我们的字符串:</h2><p id="c356" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">如果我们查看我们的table_body变量，我们可以看到它是一个非常大的字符串，包含了来自soup对象的第一个tbody标记的内容。至此，我们基本上完成了网页抓取过程。我们将使用我们的字符串方法知识把这个字符串对象转换成我们可以输入到熊猫数据帧中的东西。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/b667541ff3bffdc9292dd5c050d34a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLuAeX4S4y8SQUU_-_qEUQ.png"/></div></div></figure><p id="44e6" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">\n表示换行符。我们可以看到，在字符串的开头和结尾有两个换行符，即\n\n。我们还可以看到，表中每一行的条目都由一个换行符分隔，即\n。最后，我们可以看到每一行都由三个换行符分隔，即\n\n\n。使用这一知识，我们将能够将此字符串对象转换为另一个对象，然后我们可以将该对象输入到pandas dataframe方法中，以创建pandas dataframe。这个对象可以是一个列表列表，每个内部列表代表数据帧中的一行。</p><p id="0936" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">首先，让我们使用切片符号删除字符串开头和结尾的两个换行符。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="1b2c" class="mm mn it nk b gy no np l nq nr">table_body = table_body[2:-2]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/44ea7e3930618c3158df43f9b62088cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*He4OPdyqzvnjRnAXibeG9g.png"/></div></div></figure><p id="9c1e" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">然后，我们将使用string split方法并在三个换行符处进行拆分(\n\n\n)以将我们的字符串分成一个字符串列表，列表中的每个字符串或元素对应一行中的条目。我们将把这个列表赋给变量table_list。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="069e" class="mm mn it nk b gy no np l nq nr">table_list = table_body.split('\n\n\n')</span></pre><p id="fa2c" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">table_list的输出现在是一个字符串列表:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/f5eb435c13cfb1a697a895e713919f71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPwnPPLT_Sa22mSTVFD5qw.png"/></div></div></figure><p id="f7a0" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">我们现在可以遍历这个字符串列表，并对列表中的每个元素/字符串应用split方法，在一个换行符(\n)处进行拆分，创建一个列表列表。每个列表将包含一整行的值，每个元素对应一列的条目。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="7632" class="mm mn it nk b gy no np l nq nr">for index, element in enumerate(table_list):<br/> table_list[index] = element.split('\n')</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/dd43955156359939c86518db69de55cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ea-8kJHxu4YTQbnHROn6jQ.png"/></div></div></figure></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><div class="ks kt ku kv gt oa"><a href="https://towardsdatascience.com/json-and-apis-with-python-fba329ef6ef0" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">使用Python的JSON和API</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">使用Python的JSON和API介绍</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo lb oa"/></div></div></a></div></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h2 id="201b" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">创建熊猫数据框架</h2><p id="6ba7" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">我们的table_list现在是一个列表的列表，每个列表的元素包含一行的条目。我们现在可以将这个列表传递给我们的pandas dataframe构造函数，以创建一个包含这些信息的dataframe。我们还将指定列名作为参数，因为我们的table_list从第一行开始，而不是从列名开始。</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="d731" class="mm mn it nk b gy no np l nq nr">batting_avg_df = pd.DataFrame(data=table_list, columns=['Player', 'Span', 'Mat', 'Inns', 'NO', 'Runs', 'HS', 'Ave', 'BF', 'SR', '100', '50', '0', '4s', '6s'])</span></pre><p id="7dfb" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">然后，我们可以使用head方法查看该数据帧的前10行:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/956a68b6fd1c8cd37b4183001050a0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bBrTo0jQXHMD5-jrFrAIA.png"/></div></div></figure><p id="ed85" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">注意我们的指数是如何从0开始的。如果我们希望索引从1开始而不是从0开始，我们可以在上面的DataFrame构造函数中使用index参数来指定，或者我们可以在代码的不同行中将索引设置为从1开始:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="da2d" class="mm mn it nk b gy no np l nq nr">batting_avg_df.index += 1</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/2ac0743afe7849f6e48da18c41ca3a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ufw7VUF7WyOkHUjreMlJFw.png"/></div></div></figure><p id="2dbd" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">现在我们的指数从1开始。</p><h2 id="0c67" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">拯救我们的熊猫数据框架</h2><p id="4747" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">如果我们想将数据帧保存到csv文件，我们可以使用dataframe to_csv方法，如下所示:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="34b2" class="mm mn it nk b gy no np l nq nr">batting_avg_df.to_csv('batting_avg_csv')</span></pre><p id="eff2" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">这将在python代码所在的目录下创建一个名为batting_avg_csv的csv文件。</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="e05d" class="pw-post-body-paragraph lp lq it lr b ls lt kd lu lv lw kg lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，考虑注册成为一名媒体会员。每月5美元，你可以无限制地阅读媒体上的故事。如果你用我的 <a class="ae lh" href="https://lmatalka90.medium.com/membership" rel="noopener"> <em class="ml">链接</em> </a> <em class="ml">注册，我会赚一小笔佣金。</em></p><div class="op oq gp gr or oa"><a href="https://lmatalka90.medium.com/membership" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">通过我的推荐链接加入媒体——卢艾·马塔尔卡</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">阅读卢艾·马塔尔卡的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">lmatalka90.medium.com</p></div></div><div class="oj l"><div class="os l ol om on oj oo lb oa"/></div></div></a></div></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><h2 id="50b3" class="mm mn it bd mo mp mq dn mr ms mt dp mu ly mv mw mx mc my mz na mg nb nc nd iz bi translated">结论</h2><p id="af99" class="pw-post-body-paragraph lp lq it lr b ls ne kd lu lv nf kg lx ly ng ma mb mc nh me mf mg ni mi mj mk im bi translated">所以在本教程中，我们学习了如何使用请求和漂亮的汤库用python来抓取网页。然后，我们使用pandas库创建了一个pandas数据帧，其中包含了我们搜集的信息，然后将我们的数据帧保存到一个csv文件中。</p></div></div>    
</body>
</html>