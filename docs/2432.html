<html>
<head>
<title>Bayesian Inference in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的贝叶斯推理</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/an-introduction-to-bayesian-inference-88a1550f9040?source=collection_archive---------0-----------------------#2021-12-18">https://pub.towardsai.net/an-introduction-to-bayesian-inference-88a1550f9040?source=collection_archive---------0-----------------------#2021-12-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7bd6" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/probability" rel="noopener ugc nofollow" target="_blank">概率</a></h2><div class=""/><div class=""><h2 id="9a9c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">发现频率主义者和贝叶斯方法之间的区别。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5f2b5348a1f1fe3ade48a150e9fb94ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCMQ_8QO2LbWSW3uiAcZkw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图片由<a class="ae le" href="https://pixabay.com/users/alexas_fotos-686414/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5244001" rel="noopener ugc nofollow" target="_blank">此时此地</a>来自<a class="ae le" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5244001" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><blockquote class="lf lg lh"><p id="9fbf" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">不确定性是唯一存在的确定性，知道如何在不确定性中生活是唯一的安全——约翰·艾伦·保罗斯</p></blockquote><p id="ad79" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">人生是不确定的，统计学可以通过应用概率和推理的概念，帮助我们在这个不确定的世界中量化确定性。然而，有两种主要的推理方法:</p><ul class=""><li id="b6a0" class="mi mj iq ll b lm ln lp lq mf mk mg ml mh mm me mn mo mp mq bi translated"><strong class="ll ja">常客(古典)</strong></li><li id="2a96" class="mi mj iq ll b lm mr lp ms mf mt mg mu mh mv me mn mo mp mq bi translated"><strong class="ll ja">贝叶斯</strong></li></ul><p id="ea46" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们用众所周知的简单的<strong class="ll ja">抛硬币</strong>的例子来看看这两者。</p><p id="9b9e" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated"><strong class="ll ja">一枚硬币抛10次，观察1头9尾，我们能说什么公平？</strong></p><p id="b42f" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">虽然10是确定硬币公平性的小样本量，但我选择它是因为在现实生活中收集大量样本可能很困难，尤其是在风险和机会成本很高的情况下。</p><h1 id="bc0b" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">频繁主义者推论:</h1><p id="bf65" class="pw-post-body-paragraph li lj iq ll b lm no ka lo lp np kd lr mf nq lu lv mg nr ly lz mh ns mc md me ij bi translated">这是大学里经常教的，工业界也经常使用的，但也不是没有批评。</p><p id="1d6f" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated"><strong class="ll ja">基本思想:</strong>frequent ist方法计算p值，p值是在假设零假设为真的情况下，观察到至少与我们观察到的数据一样极端的结果的<strong class="ll ja">概率。</strong></p><p id="2763" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">在这种情况下，无效和替代假设将是:<br/> <strong class="ll ja"> H0 </strong>:硬币是公平的<br/><strong class="ll ja"/>:硬币是有偏见的</p><p id="7727" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">假设硬币是公平的，我们计算出看到像1个头这样极端的东西的概率。也就是1个头，0个头，另一边9个头，10个头。将四者相加的结果是概率为0.021。</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="133a" class="ny mx iq nu b gy nz oa l ob oc">from scipy.stats import binom</span><span id="71dc" class="ny mx iq nu b gy od oa l ob oc">binom.pmf(k=9, n=10, p=0.5)  + binom.pmf(k=10, n=10, p=0.5) +binom.pmf(k=0, n=10, p=0.5)+binom.pmf(k=1, n=10, p=0.5)</span></pre><p id="a695" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">因此，在5%的显著性下，我们可以自信地拒绝零假设，并以95%的确定性得出结论，硬币是有偏差的。</p><p id="aa58" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">目前看来一切正常，我们已经确定硬币是有偏差的。那么，问题是什么？</p><p id="7cfb" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">假设观察者对答案不满意，并继续用同一枚硬币观察另外十个样品。他会对硬币做出同样的推断吗？不一定。这一次，他可以看到5个正面和5个反面，并得出结论认为硬币没有偏向。因此，我们很难在相同的条件下重现相同的结果。</p><p id="5983" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">此外，我们永远也不会理解<strong class="ll ja">我们的零假设</strong>有多合理，因为我们假设它是真的——你可以提出一个荒谬的主张，然后设计一个实验来拒绝或接受零假设。</p><p id="ff12" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">那么，我们有没有其他健壮的方法可以克服这些限制呢？</p><h1 id="b68a" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated"><strong class="ak">贝叶斯推断:</strong></h1><p id="2611" class="pw-post-body-paragraph li lj iq ll b lm no ka lo lp np kd lr mf nq lu lv mg nr ly lz mh ns mc md me ij bi translated">贝叶斯推理采用了与频率主义方法非常不同的观点，不是从观察到的数据中估计单个总体参数，而是用代表我们的知识和不确定性的整个概率分布来表征它们。</p><p id="c6a7" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们从先验概率开始，先验概率代表我们在看到数据之前对参数的了解，然后我们进行观察，根据观察结果，我们使用贝叶斯规则将先验更新为后验。</p><p id="ef3b" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们从贝叶斯法则开始:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/247441c4024e15e96acb2484f9d5ef34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGfUUl9bpJYcQRpPlrsBkg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">贝叶斯定理</figcaption></figure><p id="5c5e" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">方程中的θ是实验的成功，这里的数据是从实验中观察到的数据，让我们理解方程中的每一项</p><p id="c125" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">p(theta)——也叫<strong class="ll ja">先验</strong>——是在看到数据之前成功的概率，这个来了</p><p id="f896" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">p(theta | Data)-也称为<strong class="ll ja">后验</strong>-是考虑观察数据后假设为真的概率</p><p id="0a29" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">P(Data | theta) —也称为<strong class="ll ja">似然度</strong> —它是数据提供的关于假设的证据</p><p id="7ddb" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">p(数据)——也称为<strong class="ll ja">归一化</strong>——是考虑所有可能假设的数据的总概率</p><p id="7aad" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">对一个事件的推断有三种方式。</p><ol class=""><li id="1b0b" class="mi mj iq ll b lm ln lp lq mf mk mg ml mh mm me of mo mp mq bi translated">完全基于你以前的经验，没有任何观察到的数据，即基于p(theta)a . k . a .<strong class="ll ja">previous</strong>，这是一种非统计学家的方法。</li><li id="67cf" class="mi mj iq ll b lm mr lp ms mf mt mg mu mh mv me of mo mp mq bi translated">第二种方法是频率主义方法，在这种方法中，我们预计如果假设为真，观察到这种结果的可能性有多小，即p(data | theta)又名<strong class="ll ja">可能性</strong>，这意味着我们只是依赖于观察到的数据，而不是其他任何东西。</li><li id="d327" class="mi mj iq ll b lm mr lp ms mf mt mg mu mh mv me of mo mp mq bi translated">最后，我们有贝叶斯推理，它使用<strong class="ll ja">我们的先验知识p(theta)和我们的观测数据来构建概率后验分布。所以频率主义者和贝叶斯推理的一个关键区别是我们的先验知识，即p (theta)。</strong></li></ol><p id="75a0" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">因此，在贝叶斯推理中，我们从先验信念开始。然后我们检查观察到的数据，让每一个数据稍微改变我们先前的理解。我们观察的数据越多，我们就离最初的信念越远。这一过程最终导致后验信念。</p><p id="2b0a" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">但是有一个问题:如果先验指的是我们之前的理解，这不是增加了实验者的偏见吗？如果我们因为不同的前科而得到不同的结果呢？这些都是公平的问题，然而，先验是贝叶斯推理的重要组成部分，人们应该确保他的先验是相关的。</p><p id="8efe" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">因此，为了精确计算后验概率，我们需要假设的先验和似然，但是在大多数实验中，假设的先验概率是未知的。在这种情况下，我们可以假设prob(theta)在0和1之间均匀分布。</p><p id="86df" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们回到掷硬币的例子:</p><p id="2fb3" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">p(theta) —成功的概率(正面)—在看到数据之前，成功的概率是多少—由于我们对硬币没有任何先验知识，我们假设它均匀分布在0和1之间。</p><p id="099a" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们从贝叶斯分析开始——后验概率可以用几种方法计算。在这种情况下，我使用网格近似来估计它。</p><p id="d27a" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">假设观察值为[T，T，T，T，T，T，T，T，T，T，T，H]</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="23d6" class="ny mx iq nu b gy nz oa l ob oc">#Lets import required packages<br/>import numpy as np <br/>import matplotlib.pyplot as plt<br/></span><span id="649c" class="ny mx iq nu b gy od oa l ob oc">#Taking a grid of 1000 points between 0 and 1<br/>probability_grid = np.linspace(0,1,num= 1000)</span><span id="84db" class="ny mx iq nu b gy od oa l ob oc">#As we have assumed a uniform distribution between 0 and 1 (i.e. uniform distribution across all 1000 grid points)<br/>prior_probability = np.ones(1000)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/7155e26d81c3cc634f3957e5944d5d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSEkP_c3qW3xm1OPiaw6hw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">先验分布0尾，0和1之间的均匀分布</figcaption></figure><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="5a89" class="ny mx iq nu b gy nz oa l ob oc">#Now lets toss the coin once, and we observed a tail<br/>probability_data = binom.cdf(k=0, n=1, p=probability_grid)<br/>posterior = prior_probability * probability_data <br/>posterior = (posterior/sum(posterior))*1000</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/ee1503b12e109efd4901187537a2fb60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ul8qtQFpoMIOEMxtuNva8w.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">1次跟踪后的后部</figcaption></figure><p id="4219" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">必须对所有10次试验重复后验更新过程，每次试验后的后验如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/b7669847a5b4ad28abf17bed3f0c0dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6JsXdm5ieNxSTFCDI9ZhQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">每次试验后的后验概率</figcaption></figure><p id="0945" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我分别遍历了所有的路径来演示这个过程。我们可以使用Pymc3包一次性完成。</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="a5c4" class="ny mx iq nu b gy nz oa l ob oc">#Import required packages<br/>import pymc3 as pm<br/>import arviz as az<br/>tosses_output = [ 0,0,0,0,0,0,0,0,0,1]</span><span id="c00f" class="ny mx iq nu b gy od oa l ob oc">with pm.Model() as model:<br/>    # lets define the prior<br/>    hypo = pm.Beta('hypo', 2, 2)<br/>    <br/>    # define probability<br/>    data = pm.Bernoulli('data', hypo, observed=tosses)<br/>    <br/>    # sample<br/>    trace = pm.sample(return_inferencedata=True)</span><span id="28ff" class="ny mx iq nu b gy od oa l ob oc"># visualize<br/>az.plot_posterior(trace, hdi_prob=0.95)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/2b6ae26fbd68b530f51aea6611a2fd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOqrQB6vbfrhUFGZQP7dtg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">正面概率的95%置信区间</figcaption></figure><p id="9963" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">那么，我们完成了什么？我们不是简单地说明硬币是否有偏差，而是获得了成功的整个分布，从中我们可以回答一些问题，如正面最可能的概率，正面的置信区间。</p><p id="7427" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我将用一幅漫画来结束这篇文章，帮助你记住贝叶斯思维和频率主义思维的区别。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/f799e444b6bff465db1b27a219dc4124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJHUF87cQNkxxPbeyEgHig.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源:<a class="ae le" href="https://xkcd.com/1132/" rel="noopener ugc nofollow" target="_blank"> XKCD </a></figcaption></figure><p id="d57c" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">频率主义者的推论没有考虑到太阳爆炸的“先验”概率，因为它仅仅基于观测数据，一个纯粹的频率主义者的方法可能会遇到问题。Frequentist根据零假设检查发现的可能性，但它不考虑假设是否先验地更不可信。</p><h1 id="67c5" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">参考资料和补充阅读</h1><p id="531d" class="pw-post-body-paragraph li lj iq ll b lm no ka lo lp np kd lr mf nq lu lv mg nr ly lz mh ns mc md me ij bi translated">[1] <a class="ae le" href="https://www.probabilisticworld.com/frequentist-bayesian-approaches-inferential-statistics/" rel="noopener ugc nofollow" target="_blank">统计学中的频率主义和贝叶斯方法</a></p><p id="3f73" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">[2] <a class="ae le" href="https://ocw.mit.edu/courses/mathematics/18-05-introduction-to-probability-and-statistics-spring-2014/readings/MIT18_05S14_Reading20.pdf" rel="noopener ugc nofollow" target="_blank">频率主义者和贝叶斯推理的比较</a></p><p id="f806" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">【3】<a class="ae le" href="https://www.penguinrandomhouse.com/books/305826/the-signal-and-the-noise-by-nate-silver/" rel="noopener ugc nofollow" target="_blank">信号和噪声</a></p><p id="ceca" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">[4] <a class="ae le" href="https://365datascience.com/bayesian-vs-frequentist-approach/" rel="noopener ugc nofollow" target="_blank">贝叶斯vs频率主义方法</a></p><p id="9926" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">【5】<a class="ae le" href="https://towardsdatascience.com/probability-concepts-explained-bayesian-inference-for-parameter-estimation-90e8930e5348" rel="noopener" target="_blank">概率概念讲解:参数估计的贝叶斯推断。</a></p><p id="bc4d" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">[6] <a class="ae le" href="https://www.youtube.com/watch?v=AkWmyE3kQ9k" rel="noopener ugc nofollow" target="_blank">安德烈·舒马赫在DTC上的讲话</a></p><p id="9ddd" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated"><a class="ae le" href="https://www.youtube.com/playlist?list=PLDcUM9US4XdNM4Edgs7weiyIguLSToZRI" rel="noopener ugc nofollow" target="_blank">【7】Richard McElreath统计反思讲座2019 </a></p></div></div>    
</body>
</html>