<html>
<head>
<title>Understand and Building N-gram Model in NLP with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python理解和构建自然语言处理中N元语法模型</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/understand-and-building-n-gram-model-in-nlp-with-python-addddbdb71fc?source=collection_archive---------1-----------------------#2021-05-18">https://pub.towardsai.net/understand-and-building-n-gram-model-in-nlp-with-python-addddbdb71fc?source=collection_archive---------1-----------------------#2021-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aaa8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自然语言处理中的文本建模技术</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/83db6d75df13a96e7fede02378ddf522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e_C5gdSQBBn6pEnp"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">洛根·韦弗在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="31e6" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">T5】简介T7】</strong></h2><p id="b11f" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me li mf mg mh lm mi mj mk lq ml mm mn mo im bi translated">本文向您介绍了自然语言处理中N元语法技术的基本建模。这里，N是指文本的不完整部分，即一系列字符、单词或句子等。状态的不同部分可以表述为马尔可夫链。</p><p id="0766" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">马尔可夫链用于基于序列进行预测的情况，即在遗传学中是DNA序列，在通信中是数据序列，等等。这是一个基于当前状态预测/预报值的过程。马尔可夫链中的状态根据概率规则变化。</p><p id="e2ee" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">例如:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="000e" class="kz la it mv b gy mz na l nb nc"><strong class="mv iu">X</strong> is a state and <strong class="mv iu">Y</strong> is also a state.</span><span id="b764" class="kz la it mv b gy nd na l nb nc">These states are based on probability rules:<br/>1. State <strong class="mv iu">X</strong> to state <strong class="mv iu">X</strong> only - 50% probability<br/>2. State <strong class="mv iu">X</strong> to state <strong class="mv iu">Y</strong> only - 50% probability<br/>3. State <strong class="mv iu">Y</strong> to state <strong class="mv iu">X</strong> only - 50% probability<br/>4. State <strong class="mv iu">Y</strong> to state <strong class="mv iu">Y</strong> only - 50% probability</span><span id="0bdf" class="kz la it mv b gy nd na l nb nc">let's assume the initial state is <strong class="mv iu">X</strong> does to <strong class="mv iu">X</strong> itself then goes to <strong class="mv iu">Y</strong> and then goes to <strong class="mv iu">X</strong>.</span><span id="3701" class="kz la it mv b gy nd na l nb nc"><strong class="mv iu">XXYX</strong> - we made a sequence based on rules.</span></pre><div class="ne nf gp gr ng nh"><a href="https://medium.com/analytics-vidhya/understand-nlp-model-building-approach-with-python-b9c2d7ef8577" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">了解使用Python构建NLP模型的方法</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">所有NLP分析技术的便捷概念</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ks nh"/></div></div></a></div><h2 id="0f23" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">双字母和三字母</h2><ul class=""><li id="3970" class="nw nx it ly b lz ma mc md li ny lm nz lq oa mo ob oc od oe bi translated">二元语法:当文本中的部分是2时，n的平均值。</li><li id="b826" class="nw nx it ly b lz of mc og li oh lm oi lq oj mo ob oc od oe bi translated">三元组:当文本中的部分是3时，表示n的值。</li></ul><p id="a413" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">我们举个例子。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="fa75" class="kz la it mv b gy mz na l nb nc">India is a beautiful country.</span><span id="479e" class="kz la it mv b gy nd na l nb nc">Finding the grams in the text.</span><span id="fb07" class="kz la it mv b gy nd na l nb nc">When N=2 <br/>Bi-grams = 'In', 'nd', 'di', 'ia', 'a ', ' i', 'is', 's ', etc</span><span id="6537" class="kz la it mv b gy nd na l nb nc">When N=3<br/>Tri-grams = 'Ind', 'ndi', 'dia', 'ia ', 'a i', ' is', etc.</span></pre><p id="98e8" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">在二字格和三字格中，空格是作为字符包含在内的。</p><p id="44e8" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">就文字而言</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="ab17" class="kz la it mv b gy mz na l nb nc">When N = 2<br/>Bi-grams = 'India is', 'is a', 'a beautiful', etc</span><span id="76cb" class="kz la it mv b gy nd na l nb nc">When N = 3<br/>Tri-grams = 'India is a', 'is a beautiful', etc </span></pre><p id="87c0" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">现在，实现N-gram</p><p id="9ae3" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">导入随机库</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="d334" class="kz la it mv b gy mz na l nb nc">import random </span></pre><p id="8c47" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">现在，获取样本文本数据</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="7500" class="kz la it mv b gy mz na l nb nc">text = """Fruits are important among common cultivation crops around<br/>          the world because of its significance of good nutrition<br/>          and health benefits"""</span></pre><p id="2f6f" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">现在，从样本数据中创建N-grams</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="49ed" class="kz la it mv b gy mz na l nb nc">n = 3</span><span id="fb1b" class="kz la it mv b gy nd na l nb nc">ngrams = {}</span><span id="f8c0" class="kz la it mv b gy nd na l nb nc">#creating ngrams<br/>for i in range(len(text) - n):<br/>    gram = text[i:i+n]<br/>    if gram not in ngrams.keys():<br/>        ngrams[gram] = []<br/>    ngrams[gram].append(text[i+n])</span></pre><p id="c477" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">查看数据的N元模型</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="fe19" class="kz la it mv b gy mz na l nb nc">ngrams</span><span id="4be6" class="kz la it mv b gy nd na l nb nc">#Output:</span><span id="4693" class="kz la it mv b gy nd na l nb nc">{'Fruit': ['s'],<br/> 'ruits': [' '],<br/> 'uits ': ['a'],<br/> 'its a': ['r'],<br/> 'ts ar': ['e'],<br/> 's are': [' '],<br/>        .<br/>        .<br/>        .<br/> 'h ben': ['e'],<br/> ' bene': ['f'],<br/> 'benef': ['i'],<br/> 'enefi': ['t'],<br/> 'nefit': ['s']}</span></pre><p id="0f6b" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">现在，是时候测试我们的模型来生成有意义的句子了</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="5648" class="kz la it mv b gy mz na l nb nc">#testing ngram model<br/>current_gram = text[0:n]<br/>result = current_gram<br/>for i in range(100):<br/>    if current_gram not in ngrams.keys():<br/>        break<br/>    possibilities = ngrams[current_gram]<br/>    next_item = possibilities[random.randrange(len(possibilities))]<br/>    result = result + next_item<br/>    current_gram = result[len(result) - n:len(result)]</span><span id="7c19" class="kz la it mv b gy nd na l nb nc">print(result)</span></pre><p id="19ce" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">“n”值的数量不同，结果也不同</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="5ca9" class="kz la it mv b gy mz na l nb nc">#result with n = 3</span><span id="8b94" class="kz la it mv b gy nd na l nb nc">Fruits around the world because<br/>   of its are important among common cultivation cultivation and the</span><span id="a3c4" class="kz la it mv b gy nd na l nb nc">#result with n = 5</span><span id="6f3e" class="kz la it mv b gy nd na l nb nc">Fruits are important among common cultivation and health benefits</span></pre><div class="ne nf gp gr ng nh"><a rel="noopener  ugc nofollow" target="_blank" href="/word-cloud-with-python-82e833d8c636"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">使用Python的词云</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">文本注释转换为词云可视化</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">pub.towardsai.net</p></div></div><div class="nq l"><div class="ok l ns nt nu nq nv ks nh"/></div></div></a></div><h2 id="68fc" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论:</h2><p id="70c8" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me li mf mg mh lm mi mj mk lq ml mm mn mo im bi translated">本文给出了自然语言处理领域中N元语法的基本概念。</p><p id="600a" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me li mr mg mh lm ms mj mk lq mt mm mn mo im bi translated">我希望你喜欢这篇文章。通过我的<a class="ae ky" href="https://www.linkedin.com/in/data-scientist-95040a1ab/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae ky" href="https://twitter.com/amitprius" rel="noopener ugc nofollow" target="_blank"> twitter </a>联系我。</p><h1 id="a7bc" class="ol la it bd lb om on oo le op oq or lh jz os ka ll kc ot kd lp kf ou kg lt ov bi translated">推荐文章</h1><p id="69e0" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me li mf mg mh lm mi mj mk lq ml mm mn mo im bi translated"><a class="ae ky" href="https://medium.com/towards-artificial-intelligence/nlp-zero-to-hero-with-python-2df6fcebff6e?sk=2231d868766e96b13d1e9d7db6064df1" rel="noopener"> 1。NLP —零到英雄与Python </a> <br/> 2。<a class="ae ky" href="https://medium.com/towards-artificial-intelligence/python-data-structures-data-types-and-objects-244d0a86c3cf?sk=42f4b462499f3fc3a160b21e2c94dba6" rel="noopener"> Python数据结构数据类型和对象</a>T5】3 .<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/exception-handling-concepts-in-python-4d5116decac3?source=friends_link&amp;sk=a0ed49d9fdeaa67925eac34ecb55ea30">Python中的异常处理概念</a> <br/> 4。<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/principal-component-analysis-in-dimensionality-reduction-with-python-1a613006d531?source=friends_link&amp;sk=3ed0671fdc04ba395dd36478bcea8a55">用Python进行主成分分析降维</a> <br/> 5。<a class="ae ky" href="https://medium.com/towards-artificial-intelligence/fully-explained-k-means-clustering-with-python-e7caa573176a?source=friends_link&amp;sk=9c5c613ceb10f2d203712634f3b6fb28" rel="noopener">用Python全面讲解K-means聚类</a> <br/> 6。<a class="ae ky" href="https://medium.com/towards-artificial-intelligence/fully-explained-linear-regression-with-python-fe2b313f32f3?source=friends_link&amp;sk=53c91a2a51347ec2d93f8222c0e06402" rel="noopener">用Python </a> <br/> 7全面讲解了线性回归。<a class="ae ky" href="https://medium.com/towards-artificial-intelligence/fully-explained-logistic-regression-with-python-f4a16413ddcd?source=friends_link&amp;sk=528181f15a44e48ea38fdd9579241a78" rel="noopener">用Python </a> <br/>充分解释了Logistic回归8。<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/differences-between-concat-merge-and-join-with-python-1a6541abc08d?source=friends_link&amp;sk=3b37b694fb90db16275059ea752fc16a">concat()、merge()和join()与Python </a> <br/>的区别9。<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/data-wrangling-with-python-part-1-969e3cc81d69?source=friends_link&amp;sk=9c3649cf20f31a5c9ead51c50c89ba0b">与Python的数据角力—第一部分</a> <br/> 10。<a class="ae ky" href="https://medium.com/analytics-vidhya/confusion-matrix-in-machine-learning-91b6e2b3f9af?source=friends_link&amp;sk=11c6531da0bab7b504d518d02746d4cc" rel="noopener">机器学习中的混淆矩阵</a></p></div></div>    
</body>
</html>