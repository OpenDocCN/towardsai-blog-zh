<html>
<head>
<title>YOLO V5 — Explained and Demystified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">YOLO V5——已解释和非神秘化</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/yolo-v5-explained-and-demystified-4e4719891d69?source=collection_archive---------1-----------------------#2020-06-30">https://pub.towardsai.net/yolo-v5-explained-and-demystified-4e4719891d69?source=collection_archive---------1-----------------------#2020-06-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6b9f" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><div class=""><h2 id="e6ae" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">YOLO V5 —模型架构和技术细节说明</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/14bea3ce1bb52287440fa2234cbfe6b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0UDSCePRh94f0XIXpw0pw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源:https://pixabay.com/<a class="ae le" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="8613" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated"><span class="l mc md me bm mf mg mh mi mj di"> F </span>从我上一篇关于<a class="ae le" href="https://towardsdatascience.com/yolo-v5-is-here-b668ce2a4908" rel="noopener" target="_blank"> YOLOv5 </a>的文章中，我收到了许多关于YOLOv5有何不同的信息和疑问，以及其他相关的技术疑问。</p><p id="04b5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以，我决定再写一篇文章，解释一下YOLOv5中用到的一些技术细节。</p><p id="76a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">由于YOLO v5总共有4个版本，我将涵盖' s '版本。但是如果你仔细查阅，你会发现在其他版本中，除了模型层/架构和一些参数之外，没有什么大的变化。</p><p id="d57c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本文中，我将涵盖以下YOLOv5实现中使用的最重要的细节和方面。</p><ul class=""><li id="be7a" class="mk ml iq lh b li lj ll lm lo mm ls mn lw mo ma mp mq mr ms bi translated">YOLO v5模型架构</li><li id="8989" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma mp mq mr ms bi translated">激活功能</li><li id="4c0a" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma mp mq mr ms bi translated">优化功能</li><li id="08c0" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma mp mq mr ms bi translated">成本函数或损失函数</li><li id="67fa" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma mp mq mr ms bi translated">权重、偏差、参数、梯度和最终模型总结</li></ul><blockquote class="my mz na"><p id="f02a" class="lf lg nb lh b li lj ka lk ll lm kd ln nc lp lq lr nd lt lu lv ne lx ly lz ma ij bi translated">注意:由于YOLO v5仍处于开发阶段，我们经常收到来自<a class="ae le" href="https://www.ultralytics.com/" rel="noopener ugc nofollow" target="_blank"> ultralytics </a>的更新，未来开发者可能会改变某些方面。所以本文只针对YOLOv5的初始版本。不过，我也会尝试为后续版本更新/添加文章。</p></blockquote><p id="21e9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们转到技术讨论。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h2 id="a7e3" class="nm nn iq bd no np nq dn nr ns nt dp nu lo nv nw nx ls ny nz oa lw ob oc od iw bi translated">YOLO v5模型架构</h2><p id="90d6" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">由于YOLO v5是一个单级物体探测器，它像任何其他单级物体探测器一样有三个重要部分。</p><ol class=""><li id="9918" class="mk ml iq lh b li lj ll lm lo mm ls mn lw mo ma oj mq mr ms bi translated">模型主干</li><li id="042b" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma oj mq mr ms bi translated">模特脖子</li><li id="05e0" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma oj mq mr ms bi translated">模型头</li></ol><p id="dc61" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">模型主干主要用于从给定的输入图像中提取重要特征。在YOLO v5中，<a class="ae le" href="https://arxiv.org/abs/1911.11929" rel="noopener ugc nofollow" target="_blank">CSP——跨级局部网络</a>被用作主干，以从输入图像中提取丰富的信息特征。</p><p id="740b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">CSPNet在处理深度更深的网络时显示出显著的改进。参考下图，有关CSPNet的更多信息，请访问<a class="ae le" href="https://github.com/WongKinYiu/CrossStagePartialNetworks" rel="noopener ugc nofollow" target="_blank"> Github repo </a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/b49e89add32ce7344b029a9615ceb956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYeL7Bpi21SM_W13ThMOHg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源:<a class="ae le" href="https://github.com/WongKinYiu/CrossStagePartialNetworks/blob/master/fig/cmp3.png" rel="noopener ugc nofollow" target="_blank">https://github . com/WongKinYiu/CrossStagePartialNetworks/blob/master/fig/CMP 3 . png</a></figcaption></figure><p id="772f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">模型颈部主要用于生成特征金字塔。特征金字塔有助于模型更好地概括对象缩放。它有助于识别不同大小和比例的同一物体。</p><p id="694a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">要素金字塔非常有用，有助于模型更好地处理看不见的数据。还有其他模型使用不同类型的特征金字塔技术，如<a class="ae le" href="https://arxiv.org/abs/1708.02002" rel="noopener ugc nofollow" target="_blank"> FPN </a>、<a class="ae le" href="https://arxiv.org/abs/1911.09070" rel="noopener ugc nofollow" target="_blank">比夫恩</a>、<a class="ae le" href="https://arxiv.org/abs/1803.01534" rel="noopener ugc nofollow" target="_blank">帕内特</a>等。</p><p id="4564" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在YOLO v5 <a class="ae le" href="https://arxiv.org/abs/1803.01534" rel="noopener ugc nofollow" target="_blank">面板</a>被用作颈部以获得特征金字塔。有关要素金字塔的详细信息，请参考以下链接。</p><div class="ol om gp gr on oo"><a href="https://medium.com/@jonathan_hui/understanding-feature-pyramid-networks-for-object-detection-fpn-45b227b9106c" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd ja gy z fp ot fr fs ou fu fw iz bi translated">理解用于目标检测的特征金字塔网络(FPN)</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">检测不同尺度的物体是具有挑战性的，尤其是对于小物体。我们可以用同样的金字塔…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ky oo"/></div></div></a></div><p id="edd1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">模型头主要用于执行最终检测部分。它在特征上应用锚框，并生成具有类别概率、客观分数和边界框的最终输出向量。</p><p id="8837" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在YOLO，v5模型的头部与之前的YOLO V3和V4版本相同。</p><p id="c543" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">此外，我附上YOLO v5的最终模型架构-一个小版本。你可以在这里找到<a class="ae le" href="https://gist.github.com/mihir135/2e5113265515450c8da934e15d97fc6b" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="cee8" class="nm nn iq bd no np nq dn nr ns nt dp nu lo nv nw nx ls ny nz oa lw ob oc od iw bi translated">激活功能</h2><p id="1eea" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">在任何深度神经网络中，激活函数的选择都是最关键的。最近推出了许多激活功能，如<a class="ae le" href="https://arxiv.org/abs/1505.00853" rel="noopener ugc nofollow" target="_blank"> Leaky ReLU </a>、<a class="ae le" href="https://arxiv.org/abs/1908.08681" rel="noopener ugc nofollow" target="_blank"> mish </a>、<a class="ae le" href="https://www.researchgate.net/publication/320464797_Swish_a_Self-Gated_Activation_Function" rel="noopener ugc nofollow" target="_blank"> swish </a>等。</p><p id="9c1a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">YOLO v5的作者决定使用泄漏ReLU和<a class="ae le" href="https://en.wikipedia.org/wiki/Sigmoid_function" rel="noopener ugc nofollow" target="_blank"> Sigmoid </a>激活函数。</p><p id="c6a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在YOLO v5中，泄漏ReLU激活函数用于中间/隐藏层，而sigmoid激活函数用于最终检测层。你可以在这里验证一下<a class="ae le" href="https://gist.github.com/mihir135/2e5113265515450c8da934e15d97fc6b" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="c234" class="nm nn iq bd no np nq dn nr ns nt dp nu lo nv nw nx ls ny nz oa lw ob oc od iw bi translated">优化功能</h2><p id="8290" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">对于YOLO v5中的优化功能，我们有两个选项</p><ol class=""><li id="a23a" class="mk ml iq lh b li lj ll lm lo mm ls mn lw mo ma oj mq mr ms bi translated">新币</li><li id="bb5f" class="mk ml iq lh b li mt ll mu lo mv ls mw lw mx ma oj mq mr ms bi translated"><a class="ae le" href="https://arxiv.org/abs/1412.6980" rel="noopener ugc nofollow" target="_blank">亚当</a></li></ol><p id="72d7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在YOLO v5中，用于训练的默认优化函数是SGD。</p><p id="fcb8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是，您可以使用“<em class="nb">———Adam</em>”命令行参数将其更改为Adam。</p><h2 id="4444" class="nm nn iq bd no np nq dn nr ns nt dp nu lo nv nw nx ls ny nz oa lw ob oc od iw bi translated">成本函数或损失函数</h2><p id="cc47" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">在YOLO家族中，有一种复合损失是基于对象得分、类概率得分和包围盒回归得分来计算的。</p><p id="f190" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Ultralytics使用PyTorch的<a class="ae le" href="https://pytorch.org/docs/master/generated/torch.nn.BCEWithLogitsLoss.html" rel="noopener ugc nofollow" target="_blank">二进制交叉熵和Logits Loss </a>函数来计算类别概率和对象分数的损失。</p><p id="0deb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们也可以选择<a class="ae le" href="https://arxiv.org/abs/1708.02002" rel="noopener ugc nofollow" target="_blank">聚焦损失</a>函数来计算损失。您可以选择使用fl_gamma超参数进行失焦训练。</p><h2 id="cb88" class="nm nn iq bd no np nq dn nr ns nt dp nu lo nv nw nx ls ny nz oa lw ob oc od iw bi translated">权重、偏差、参数、梯度和最终模型总结</h2><p id="f7a0" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">要仔细查看YOLOv5-small模型中各层的权重、偏差、形状和参数，请参考以下信息。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pd pe l"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">来源:<a class="ae le" href="https://gist.github.com/mihir135/969d78149b724b7684e327a1672da667" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mihir 135/969d 78149 b 724 b 7684 e 327 a 1672 da 667</a></figcaption></figure><p id="117c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">另外，你也可以参考下面对YOLO V5——小车型的简要总结。</p><pre class="kp kq kr ks gt pf pg ph pi aw pj bi"><span id="287f" class="nm nn iq pg b gy pk pl l pm pn">Model Summary: 191 layers, 7.46816e+06 parameters, 7.46816e+06 gradients</span></pre></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="eafe" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">希望这能帮助你更好地理解YOLO v5。在结尾的笔记里，感谢大家的阅读。</p><p id="4db3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如有任何疑问/疑问/建议，请随时联系我。</p><p id="2d51" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">参考文献:</strong></p><p id="f2df" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[1]<a class="ae le" href="https://github.com/ultralytics/yolov5" rel="noopener ugc nofollow" target="_blank">https://github.com/ultralytics/yolov5</a></p><p id="7d35" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[2]<a class="ae le" href="https://github.com/WongKinYiu/CrossStagePartialNetworks" rel="noopener ugc nofollow" target="_blank">https://github.com/WongKinYiu/CrossStagePartialNetworks</a></p><p id="f96e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">投稿:</strong></p><p id="29de" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">马约·帕特尔</p><p id="fbda" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">随意连接:</strong></p><blockquote class="my mz na"><p id="1ba2" class="lf lg nb lh b li lj ka lk ll lm kd ln nc lp lq lr nd lt lu lv ne lx ly lz ma ij bi translated"><em class="iq">领英:</em>T22】https://www.linkedin.com/in/mihir-rajput/</p><p id="4cc8" class="lf lg nb lh b li lj ka lk ll lm kd ln nc lp lq lr nd lt lu lv ne lx ly lz ma ij bi translated"><em class="iq">insta gram:</em><a class="ae le" href="https://www.instagram.com/ai_dev_/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/ai_dev_/</a></p><p id="710c" class="lf lg nb lh b li lj ka lk ll lm kd ln nc lp lq lr nd lt lu lv ne lx ly lz ma ij bi translated"><em class="iq">Github:</em>T30】https://github.com/mihir135/</p><p id="cda8" class="lf lg nb lh b li lj ka lk ll lm kd ln nc lp lq lr nd lt lu lv ne lx ly lz ma ij bi translated">谢谢，干杯！</p></blockquote></div></div>    
</body>
</html>