<html>
<head>
<title>FastAPI — Create and Deploy Hot Dog Detector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FastAPI —创建和部署热狗检测器</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/fastapi-create-and-deploy-hot-dog-detector-cf89d9b51a3c?source=collection_archive---------0-----------------------#2021-06-03">https://pub.towardsai.net/fastapi-create-and-deploy-hot-dog-detector-cf89d9b51a3c?source=collection_archive---------0-----------------------#2021-06-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f8cd" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/computer-vision" rel="noopener ugc nofollow" target="_blank">计算机视觉</a></h2><div class=""/><div class=""><h2 id="473c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">并学习使用Docker将其容器化</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/34f97d51822786f52d0b433f64fed075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MazZ79L6XAj-Kjf-"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@mateusz_feliksik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马特乌斯·菲利克斯克</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><blockquote class="lf"><p id="d9d5" class="lg lh iq bd li lj lk ll lm ln lo lp dk translated">我不抽烟，除了特殊场合——杨坚</p></blockquote><p id="ba59" class="pw-post-body-paragraph lq lr iq ls b lt lu ka lv lw lx kd ly lz ma mb mc md me mf mg mh mi mj mk lp ij bi translated">对于那些熟悉热播电视剧<a class="ae le" href="https://www.imdb.com/title/tt2575988/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja">硅谷</strong> </a>的人来说，你应该已经猜到了这篇文章的灵感来源。</p><p id="caf1" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">欧阳万成在硅谷的角色<a class="ae le" href="https://www.youtube.com/watch?v=vIci3C4JkL0" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja">开发了一个应用</strong> </a>，它使用计算机视觉来检测照片是否是热狗。</p><p id="9423" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">今天，我们将看看如何使用FastAPI和Docker来复制和部署这样一个API。</p><p id="6e39" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">FastAPI是发展最快的web框架之一，用于在Python中构建API。</p><blockquote class="mq mr ms"><p id="1336" class="lq lr mt ls b lt ml ka lv lw mm kd ly mu mn mb mc mv mo mf mg mw mp mj mk lp ij bi translated"><strong class="ls ja"><em class="iq">TL；</em> </strong> <a class="ae le" href="https://github.com/Sayar1106/HotOrNotHotDog" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja"> <em class="iq"> Github库</em> </strong> </a></p></blockquote></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="f2e0" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">资料组📊</h1><p id="7a5e" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">我将使用的数据集来自Kaggle。你可以在这里找到<a class="ae le" href="https://www.kaggle.com/c/hotdogornot" rel="noopener ugc nofollow" target="_blank"><strong class="ls ja"/></a>。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="4fe1" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">训练模型🏃</h1><p id="d4d1" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">为了训练我们的计算机视觉模型，我决定使用杰瑞米·霍华德著名的Fastai库。</p><p id="5bf0" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">简而言之，Fastai是Pytorch库之上的一个包装器，它使开发人员能够快速开发机器学习模型。</p><p id="7703" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">为了训练我们的热狗分类器，我们使用了一个预先训练好的<strong class="ls ja"> Resnet34 </strong>模型。</p><p id="5e14" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">为了更好的了解培训过程中还有哪些选择，可以参考<strong class="ls ja">谷歌Colab笔记本</strong>这里<a class="ae le" href="https://github.com/Sayar1106/HotOrNotHotDog/blob/master/HotDogOrNot.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja">可以找到</strong> </a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/1aec7b34e9ccf2a1d342a5c4abfa4cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hM-jz-Tc626mgjI8iPW-ow.png"/></div></div></figure><p id="ff7a" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">正如你所看到的，经过一个时期的训练，我们的模型在验证集上达到了95%的准确率。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/a4c18837fb9f1fa95f686c3d370f36a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBoacd8312B9od3aN5knlg.png"/></div></div></figure><p id="c98d" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">我们看到我们的模型对于从我们的测试集中获取的样本图像工作得相当好。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="37d4" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">创建API💻</h1><p id="086f" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">在本节中，我们将构建一个API来将我们训练过的hotdog检测器模型部署到生产中。</p><h2 id="6e16" class="od nf iq bd ng oe of dn nk og oh dp no lz oi oj nq md ok ol ns mh om on nu iw bi translated">项目结构</h2><pre class="kp kq kr ks gt oo op oq or aw os bi"><span id="ce58" class="od nf iq op b gy ot ou l ov ow">.<br/>├── LICENSE<br/>├── README.md<br/>├── app<br/>│   ├── __init__.py<br/>│   ├── json_models<br/>│   │   ├── __init__.py<br/>│   │   └── request.py<br/>│   ├── main.py<br/>│   ├── models<br/>│   │   ├── __init__.py<br/>│   │   └── model.pkl<br/>│   └── utils.py<br/>├── notebooks<br/>│   └── HotDogOrNot.ipynb<br/>└── requirements.txt</span></pre><p id="aede" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">大多数相关代码都位于<code class="fe ox oy oz op b">app</code>目录中。请注意，我们已经创建了一个名为<code class="fe ox oy oz op b">models</code>的目录来存储我们的训练模型文件。</p><p id="6938" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">在我们开始之前，请确保通过从父目录运行以下命令来安装所有要求:</p><pre class="kp kq kr ks gt oo op oq or aw os bi"><span id="4e8a" class="od nf iq op b gy ot ou l ov ow">$ pip3 install -r requirements.txt</span></pre><p id="94de" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">让我们看看我们的代码。</p><h2 id="873d" class="od nf iq bd ng oe of dn nk og oh dp no lz oi oj nq md ok ol ns mh om on nu iw bi translated">utils.py</h2><p id="2fc0" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">我们的<code class="fe ox oy oz op b">utils.py</code>文件包含三个函数。这三种功能各有不同的用途:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="788e" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated"><code class="fe ox oy oz op b">read_image</code>相当自明。该功能有助于从请求中以字节形式读取图像数据，并将其转换为<strong class="ls ja">适当的格式</strong>，以便输入模型进行预测。</p><p id="0494" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated"><code class="fe ox oy oz op b">is_hotdog</code>是一个更加细致入微的功能。这个函数实际上是由我们的<code class="fe ox oy oz op b">fastai</code> <strong class="ls ja">数据加载器</strong>使用的，用于适当地为我们的模型提供数据。</p><p id="20d0" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">虽然我们的模型在训练后被存储在一个<code class="fe ox oy oz op b">.pkl</code>文件中，但它并没有整体存储<code class="fe ox oy oz op b">is_hotdog</code>函数。</p><p id="7cf5" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">相反，它<strong class="ls ja">在文件中存储对函数的引用</strong>。因此，我们在我们的utils文件中编写函数，以便当模型被加载时，它能够成功地搜索到<code class="fe ox oy oz op b">is_hotdog</code>函数，并且能够按照预期进行操作。</p><p id="bfd5" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">更多关于这个和<code class="fe ox oy oz op b">ImageDataLoaders</code>的信息，可以阅读官方<a class="ae le" href="https://docs.fast.ai/vision.data.html#ImageDataLoaders" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja"> Fastai docs </strong> </a>和本<a class="ae le" href="https://forums.fast.ai/t/loading-custom-databunch-fails-with-attribute-error/70789/2" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja">论坛线程</strong> </a>。</p><p id="1656" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">最后，我们的<code class="fe ox oy oz op b">predict_hotdog</code>函数加载我们的模型，该模型将利用<code class="fe ox oy oz op b">is_hotdog</code>函数并提供预测。该函数返回一个<strong class="ls ja">字典</strong>，它将作为我们的API的响应。</p><h2 id="0db4" class="od nf iq bd ng oe of dn nk og oh dp no lz oi oj nq md ok ol ns mh om on nu iw bi translated">响应. py</h2><p id="d989" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">这个位于<code class="fe ox oy oz op b">json_models</code>目录中的文件包含一个用于API响应模型的<code class="fe ox oy oz op b">Pydantic</code>类。</p><p id="9e81" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">简而言之，<strong class="ls ja"> Pydantic </strong>是一个很棒的库，它在运行时使用python类型注释提供了<strong class="ls ja">数据验证</strong>。</p><p id="cc25" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">这个库对于构建API特别有用，并且与FastAPI有极好的互操作性。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="58a5" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">正如我们所看到的，我们的<code class="fe ox oy oz op b">Response</code>类的属性与我们的<code class="fe ox oy oz op b">predict_hotdog</code>函数的键具有相同的名称。</p><p id="300d" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated"><strong class="ls ja"> main.py </strong></p><p id="8c98" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">最后，这是我们的应用程序将在生产中运行的文件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="8e24" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">首先，我们创建一个<code class="fe ox oy oz op b">FastAPI</code>类对象。然后，我们使用这个类对象来装饰我们的<code class="fe ox oy oz op b">predict</code>函数。<code class="fe ox oy oz op b">@app.post</code>表示我们的请求将是一个post请求，后跟API的路径<code class="fe ox oy oz op b">/predict/</code>。</p><p id="9c99" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">这里我们还有一个名为<code class="fe ox oy oz op b">response_model</code>的参数，它接受我们的Pydantic模型作为输入。该参数用于在运行时验证我们的响应。</p><p id="43ce" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">最后，我们的<code class="fe ox oy oz op b">predict</code>函数有一个名为<code class="fe ox oy oz op b">myfile</code>的查询参数，类型为<code class="fe ox oy oz op b">UploadFile</code>，它将用于读取API中的图像文件。</p><p id="82aa" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">这个变量被传递到我们之前看到的<code class="fe ox oy oz op b">read_image</code>函数中，该函数将以字节为单位将我们的图像数据转换成一个<code class="fe ox oy oz op b">PILImage</code>对象，我们可以很容易地使用该对象来填充我们的FastAI模型。</p><p id="f3eb" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">最后，图像被传递给我们的<code class="fe ox oy oz op b">predict_hotdog</code>函数，该函数提供预测并返回一个dictionary对象作为响应。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="302a" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">测试📝</h1><p id="a1cf" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">为了手动测试API，您必须首先运行它。</p><p id="6d36" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">转到repo中的<code class="fe ox oy oz op b">app</code>目录，键入以下命令:</p><pre class="kp kq kr ks gt oo op oq or aw os bi"><span id="efe5" class="od nf iq op b gy ot ou l ov ow">$ uvicorn main:app --reload </span></pre><p id="a4e4" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated"><em class="mt">注:以下节选直接摘自</em> <a class="ae le" href="https://fastapi.tiangolo.com/tutorial/first-steps/" rel="noopener ugc nofollow" target="_blank"> <em class="mt"> FastAPI文档</em> </a> <em class="mt">。</em></p><p id="6412" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">命令<code class="fe ox oy oz op b">uvicorn main:app</code>是指:</p><ul class=""><li id="7cef" class="pc pd iq ls b lt ml lw mm lz pe md pf mh pg lp ph pi pj pk bi translated"><code class="fe ox oy oz op b">main</code>:文件<code class="fe ox oy oz op b">main.py</code>(Python“模块”)。</li><li id="bd29" class="pc pd iq ls b lt pl lw pm lz pn md po mh pp lp ph pi pj pk bi translated"><code class="fe ox oy oz op b">app</code>:用行<code class="fe ox oy oz op b">app = FastAPI()</code>在<code class="fe ox oy oz op b">main.py</code>内创建的对象。</li><li id="1630" class="pc pd iq ls b lt pl lw pm lz pn md po mh pp lp ph pi pj pk bi translated"><code class="fe ox oy oz op b">--reload</code>:修改代码后重启服务器。仅用于开发。</li></ul><p id="aa36" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">在您的终端上，您应该看到以下行:</p><p id="c32e" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated"><code class="fe ox oy oz op b">INFO: Uvicorn running on <a class="ae le" href="http://127.0.0.1:8000" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000</a> (Press CTRL+C to quit</code></p><p id="daa3" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">在您选择的浏览器上打开<code class="fe ox oy oz op b">http://127.0.0.1:8000/docs</code>。</p><p id="f08b" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">你应该看到类似这样的东西，这就是<a class="ae le" href="https://swagger.io/tools/swagger-ui/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja"> Swagger文档UI </strong> </a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pq"><img src="../Images/eb06bd536f0daebc01fe89c9d82d3a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gt5L6HWJ8lqvBV7bxsbSdg.png"/></div></div></figure><p id="ab6d" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">如果您单击POST的下拉列表，您应该能够看到以下内容:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pr"><img src="../Images/5c601d9e39abb0f6b77a0e87afd256a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0UTDOYeTpptwS2-COHPYA.png"/></div></div></figure><p id="5c15" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">点击<strong class="ls ja"> <em class="mt">尝试一下</em> </strong> <em class="mt"> </em>，之后会提示你上传你的图片。一旦你这样做了，点击<strong class="ls ja"> <em class="mt">执行</em> </strong> <em class="mt"> </em>，你将得到如下:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ps"><img src="../Images/20843f2688af1ee4d1ebe0831bc9f337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WADIm9MfQyWiFLYY9SP6gQ.png"/></div></div></figure><p id="0d7d" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">请注意，除了响应之外，UI还会生成一个定制的curl命令，供您在终端上使用。很漂亮吧？</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="1e3d" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">归档📦</h1><p id="4ef4" class="pw-post-body-paragraph lq lr iq ls b lt nw ka lv lw nx kd ly lz ny mb mc md nz mf mg mh oa mj mk lp ij bi translated">到目前为止，我们已经看到了如何成功地在本地部署hotdog检测器模型。然而，在实践中，人们希望能够在任何机器上部署这样的应用程序。</p><p id="a5b6" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">因此，最好的方法是使用Docker将应用程序容器化。</p><p id="5fab" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">继续之前，请确保您的系统上安装了Docker。可以从<a class="ae le" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja">这里</strong> </a>安装。</p><p id="86b8" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">我们可以利用FastAPI创建者创建的<a class="ae le" href="https://github.com/tiangolo/uvicorn-gunicorn-fastapi-docker" rel="noopener ugc nofollow" target="_blank"> <strong class="ls ja">官方Docker图像</strong> </a>来建立我们的本地图像。让我们看看我们的docker文件:</p><pre class="kp kq kr ks gt oo op oq or aw os bi"><span id="50a7" class="od nf iq op b gy ot ou l ov ow">FROM tiangolo/uvicorn-gunicorn-fastapi:python3.7 </span><span id="0ab4" class="od nf iq op b gy pt ou l ov ow">COPY ./app /app </span><span id="cfbf" class="od nf iq op b gy pt ou l ov ow">COPY requirements.txt requirements.txt </span><span id="b98d" class="od nf iq op b gy pt ou l ov ow">RUN pip3 install -r requirements.txt</span></pre><p id="af9a" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">在终端中运行以下命令以创建映像:</p><pre class="kp kq kr ks gt oo op oq or aw os bi"><span id="aed2" class="od nf iq op b gy ot ou l ov ow">$ docker build -t fastimage .</span></pre><p id="1720" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">此后，您可以在容器中运行映像，如下所示:</p><pre class="kp kq kr ks gt oo op oq or aw os bi"><span id="8eb4" class="od nf iq op b gy ot ou l ov ow">$ docker run -d --name fastcontainer -p 80:80 fastimage</span></pre><p id="13f4" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">如果在浏览器上打开<code class="fe ox oy oz op b">localhost/docs</code>，应该能看到霸气的UI。</p><p id="7ec0" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">因此，现在我们已经创建了Docker映像，现在可以将它推送到<strong class="ls ja"> Docker Hub </strong>或任何其他<strong class="ls ja">容器注册表</strong>以用于生产。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="94a8" class="pw-post-body-paragraph lq lr iq ls b lt ml ka lv lw mm kd ly lz mn mb mc md mo mf mg mh mp mj mk lp ij bi translated">恭喜你！您已到达这篇文章的结尾。我希望你喜欢读它。我会留下一些资源来学习更多关于FastAPI、FastAI和Docker的知识。下次见！✋</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="47c9" class="ne nf iq bd ng nh ni nj nk nl nm nn no kf np kg nq ki nr kj ns kl nt km nu nv bi translated">资源📚</h1><ul class=""><li id="5c2e" class="pc pd iq ls b lt nw lw nx lz pu md pv mh pw lp ph pi pj pk bi translated"><a class="ae le" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank">https://fastapi.tiangolo.com/</a></li><li id="14b3" class="pc pd iq ls b lt pl lw pm lz pn md po mh pp lp ph pi pj pk bi translated"><a class="ae le" href="https://docs.fast.ai/" rel="noopener ugc nofollow" target="_blank">https://docs.fast.ai/</a></li><li id="a170" class="pc pd iq ls b lt pl lw pm lz pn md po mh pp lp ph pi pj pk bi translated"><a class="ae le" href="https://docs.docker.com/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/</a></li><li id="f4fe" class="pc pd iq ls b lt pl lw pm lz pn md po mh pp lp ph pi pj pk bi translated"><a class="ae le" href="https://www.tutorialspoint.com/docker/index.htm" rel="noopener ugc nofollow" target="_blank">https://www.tutorialspoint.com/docker/index.htm</a></li><li id="78b3" class="pc pd iq ls b lt pl lw pm lz pn md po mh pp lp ph pi pj pk bi translated"><a class="ae le" href="https://docs.fast.ai/tutorial.vision" rel="noopener ugc nofollow" target="_blank">https://docs.fast.ai/tutorial.vision</a></li></ul></div></div>    
</body>
</html>