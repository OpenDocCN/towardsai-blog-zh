<html>
<head>
<title>How to Combine Multiple Datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何组合多个数据集</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-combine-multiple-datasets-e78c7e1433b3?source=collection_archive---------1-----------------------#2021-12-22">https://pub.towardsai.net/how-to-combine-multiple-datasets-e78c7e1433b3?source=collection_archive---------1-----------------------#2021-12-22</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="8cfa" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/software-engineering" rel="noopener ugc nofollow" target="_blank">软件工程</a></h2><div class=""/><div class=""><h2 id="5cf6" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">对追加和连接策略的描述，以及SQL中的实际例子。</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/73f143e8f09a53c9faae3fdf41b09132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ETkoyXl-ZFKI1bPq"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">由<a class="ae lk" href="https://unsplash.com/@tekton_tools?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">泰克顿</a>在<a class="ae lk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="bde8" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我们有多少次面对两个数据集进行组合或集成？也许我们的数据集包含相同的信息，但涉及不同的年份。或者我们必须合并有一些共同点，但包含不同信息的数据集。</p><blockquote class="mh"><p id="1fce" class="mi mj iw bd mk ml mm mn mo mp mq mg dk translated">那么，如何组合两个或多个数据集呢？</p></blockquote><p id="9fae" class="pw-post-body-paragraph ll lm iw ln b lo mr kg lq lr ms kj lt lu mt lw lx ly mu ma mb mc mv me mf mg ip bi translated">存在许多策略。在本文中，我将重点介绍数据集组合的两种策略:</p><ul class=""><li id="3198" class="mw mx iw ln b lo lp lr ls lu my ly mz mc na mg nb nc nd ne bi translated"><strong class="ln jg">追加</strong></li><li id="2ee4" class="mw mx iw ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated"><strong class="ln jg">加入</strong></li></ul><p id="3fa7" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我还提供了两个如何在SQL中执行这两种组合的实际例子。</p><h1 id="8bed" class="nk nl iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">1附加或垂直组合</h1><p id="01b7" class="pw-post-body-paragraph ll lm iw ln b lo oc kg lq lr od kj lt lu oe lw lx ly of ma mb mc og me mf mg ip bi translated">让我们假设我们有两个具有相同列的数据集<strong class="ln jg">。可能会发生两种不同的情况:</strong></p><ul class=""><li id="97bb" class="mw mx iw ln b lo lp lr ls lu my ly mz mc na mg nb nc nd ne bi translated"><strong class="ln jg">列相同，行不同</strong>:两个数据集中的所有行都不同</li><li id="0d08" class="mw mx iw ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated"><strong class="ln jg">相同的列，部分不同的行</strong>:两个数据集中至少有一列有相同的行值。</li></ul><h2 id="11aa" class="oh nl iw bd nm oi oj dn nq ok ol dp nu lu om on nw ly oo op ny mc oq or oa jc bi translated">1.1相同列不同行</h2><p id="c044" class="pw-post-body-paragraph ll lm iw ln b lo oc kg lq lr od kj lt lu oe lw lx ly of ma mb mc og me mf mg ip bi translated">追加操作包括构建一个新表，可通过以下步骤获得:</p><ul class=""><li id="48b9" class="mw mx iw ln b lo lp lr ls lu my ly mz mc na mg nb nc nd ne bi translated">复制新表中的第一个数据集</li><li id="f6b5" class="mw mx iw ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated">在新表中复制第一个数据集之后的第二个数据集。</li></ul><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj os"><img src="../Images/7e4ba3d79e67b42b2121f627c2028e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_V1wZFDb54yCBkIBYY4DQ.png"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</figcaption></figure><p id="993e" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">就SQL而言，新表可以按如下方式创建:</p><pre class="kv kw kx ky gu ot ou ov ow aw ox bi"><span id="0e78" class="oh nl iw ou b gz oy oz l pa pb"><strong class="ou jg">CREATE TABLE</strong> append_dataset <strong class="ou jg">AS</strong></span><span id="2fe8" class="oh nl iw ou b gz pc oz l pa pb">(<strong class="ou jg">SELECT</strong> State, Sex, AverageScore <br/> <strong class="ou jg">FROM</strong> dataset_A)</span><span id="877c" class="oh nl iw ou b gz pc oz l pa pb"><strong class="ou jg">UNION</strong><br/> <br/>(<strong class="ou jg">SELECT</strong> State, Sex, AverageScore<br/> <strong class="ou jg">FROM</strong> dataset_B)</span></pre><p id="63af" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">使用<code class="fe pd pe pf ou b">UNION</code>语句可以删除所有的重复项。如果想保留副本，必须使用<code class="fe pd pe pf ou b">UNION ALL</code>。</p><h2 id="1fe1" class="oh nl iw bd nm oi oj dn nq ok ol dp nu lu om on nw ly oo op ny mc oq or oa jc bi translated">1.2相同的列，部分不同的行</h2><p id="7e51" class="pw-post-body-paragraph ll lm iw ln b lo oc kg lq lr od kj lt lu oe lw lx ly of ma mb mc og me mf mg ip bi translated">让我们假设有两个数据集，包含相同定义的州的平均分数，并涉及不同的年份。这两个数据集包含相同的列名。此外，它们包含相同的列状态单元值，但包含不同的列平均得分值。</p><p id="1b2a" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在这种情况下，追加通过以下步骤完成:</p><ul class=""><li id="4ab2" class="mw mx iw ln b lo lp lr ls lu my ly mz mc na mg nb nc nd ne bi translated">复制新表中的第一个数据集，并添加一个名为Year的列</li><li id="917c" class="mw mx iw ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated">为第一个数据集的所有行添加相同的年份值(例如2021)</li><li id="5f15" class="mw mx iw ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated">在新表中，将第二个数据集追加到第一个数据集的末尾</li><li id="bc04" class="mw mx iw ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated">为第二个数据集的所有行添加相同的年份值(例如2020)。</li></ul><p id="fba5" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我写的东西是不是太难理解了？别担心...试着看一下下图:一切都会更简单！</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj os"><img src="../Images/f3cb444e9e0bbc23a9c5955ceca1eae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1eWtTW8e_hek_hEryPxnA.jpeg"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</figcaption></figure><p id="fd57" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">就SQL而言，新表可以按如下方式创建:</p><pre class="kv kw kx ky gu ot ou ov ow aw ox bi"><span id="6a94" class="oh nl iw ou b gz oy oz l pa pb"><strong class="ou jg">CREATE TABLE</strong> append_dataset <strong class="ou jg">AS</strong></span><span id="710c" class="oh nl iw ou b gz pc oz l pa pb">(<strong class="ou jg">SELECT</strong> '2021' <strong class="ou jg">AS</strong> Year, State, Sex, AverageScore <br/> <strong class="ou jg">FROM</strong> dataset_A_2021)</span><span id="3174" class="oh nl iw ou b gz pc oz l pa pb"><strong class="ou jg">UNION</strong><br/> <br/>(<strong class="ou jg">SELECT</strong> '2020' <strong class="ou jg">AS</strong> Year, State, Sex, AverageScore<br/> <strong class="ou jg">FROM</strong> dataset_A_2020)</span></pre><h1 id="9114" class="nk nl iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">2连接或水平组合</h1><p id="b93e" class="pw-post-body-paragraph ll lm iw ln b lo oc kg lq lr od kj lt lu oe lw lx ly of ma mb mc og me mf mg ip bi translated">当两个数据集共享至少一列时，连接或水平组合完成<strong class="ln jg">。通常，两个数据集具有相同的行数，但是当行数不同时也可以进行连接。</strong></p><p id="e04a" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">下图说明了如何连接两个数据集:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj os"><img src="../Images/3012f39653a2767914f71b1e10db8a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g1tA39X3IP0wl9kh7SjQQ.jpeg"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</figcaption></figure><p id="3bd6" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">就SQL而言，新表可以按如下方式创建:</p><pre class="kv kw kx ky gu ot ou ov ow aw ox bi"><span id="6f00" class="oh nl iw ou b gz oy oz l pa pb"><strong class="ou jg">CREATE TABLE</strong> join_dataset AS<br/><strong class="ou jg">SELECT</strong> * from dataset_a <br/><strong class="ou jg">JOIN</strong> dataset_b <br/><strong class="ou jg">ON</strong> dataset_a.State = dataset_b.State</span></pre><p id="6488" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">存在多种类型的联接(例如内部联接或外部联接)。</p><h1 id="e1b9" class="nk nl iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">摘要</h1><p id="f29a" class="pw-post-body-paragraph ll lm iw ln b lo oc kg lq lr od kj lt lu oe lw lx ly of ma mb mc og me mf mg ip bi translated">恭喜你！您刚刚学习了如何合并两个或多个数据集！</p><p id="0f22" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">总而言之，当两个数据集具有相同的列时，可以使用追加或垂直组合，而当两个数据集至少有一列相同时，可以使用连接或垂直组合。</p><p id="0b0a" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在本文中，我描述了如何在SQL中执行追加和连接。关于如何用Python Pandas执行相同操作的更多细节，你可以参考<a class="ae lk" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.06-concat-and-append.html" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><p id="e6a1" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你已经走了这么远来阅读，对我来说今天已经很多了。谢谢！你可以在<a class="ae lk" href="https://alod83.medium.com/which-topics-would-you-like-to-read-c68314dc6813" rel="noopener">这篇文章</a>中读到更多关于我的信息。</p><h1 id="d10f" class="nk nl iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">相关文章</h1><div class="pg ph gq gs pi pj"><a href="https://alod83.medium.com/how-to-represent-and-query-hierarchical-data-in-sql-69b6b77577e8" rel="noopener follow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jg gz z fq po fs ft pp fv fx jf bi translated">如何在SQL中表示和查询层次数据</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">关于如何使用关系数据库构建和查询分层表的教程。</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">alod83.medium.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px le pj"/></div></div></a></div><div class="pg ph gq gs pi pj"><a href="https://towardsdatascience.com/my-journey-to-connect-mariadb-to-mysql-workbench-2d7e599a8a26" rel="noopener follow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jg gz z fq po fs ft pp fv fx jf bi translated">我将MariaDB连接到MySQL Workbench的旅程</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">我的老板向我要一个保存在MariaDB中的模式的ER图。</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="py l pu pv pw ps px le pj"/></div></div></a></div><div class="pg ph gq gs pi pj"><a href="https://medium.datadriveninvestor.com/a-brief-introduction-to-the-concept-of-data-7b593587e0cf" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fp"><div class="pl ab pm cl cj pn"><h2 class="bd jg gz z fq po fs ft pp fv fx jf bi translated">数据概念简介</h2><div class="pq l"><h3 class="bd b gz z fq po fs ft pp fv fx dk translated">每个有抱负的数据科学家都必须知道数据的概念以及他们可以运行的分析类型。这篇文章…</h3></div><div class="pr l"><p class="bd b dl z fq po fs ft pp fv fx dk translated">medium.datadriveninvestor.com</p></div></div><div class="ps l"><div class="pz l pu pv pw ps px le pj"/></div></div></a></div><h1 id="03f3" class="nk nl iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">参考</h1><ul class=""><li id="4276" class="mw mx iw ln b lo oc lr od lu qa ly qb mc qc mg nb nc nd ne bi translated"><a class="ae lk" href="https://www.baooytra.com/knowledge/articles/32670/combining-multiple-streams-of-data.html?smartspace=fanouts" rel="noopener ugc nofollow" target="_blank">https://www . baoytra . com/knowledge/articles/32670/combining-multiple-streams-of-data . html？智能空间=扇出</a></li></ul><h1 id="c970" class="nk nl iw bd nm nn no np nq nr ns nt nu kl nv km nw ko nx kp ny kr nz ks oa ob bi translated">额外奖金</h1><p id="c904" class="pw-post-body-paragraph ll lm iw ln b lo oc kg lq lr od kj lt lu oe lw lx ly of ma mb mc og me mf mg ip bi translated">事实上，第三种策略可以用来组合两个数据集，通过创建<strong class="ln jg">相关数据集</strong>。在这个策略中，没有表被创建为输出。相反，两个原始数据集中至少有一个维护对另一个数据集的引用。该<em class="qd">引用</em>允许相关记录。</p><p id="7ea6" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">下图显示了相关数据集的示例:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj os"><img src="../Images/0ebca9eecc8e2868a904d94e73ece8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9z4xTAt685V1bVm_VEEg_g.jpeg"/></div></div><figcaption class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</figcaption></figure></div></div>    
</body>
</html>