<html>
<head>
<title>Deep Learning for Weather Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于天气分类的深度学习</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/deep-learning-for-weather-classification-fe877cdc721c?source=collection_archive---------2-----------------------#2020-09-13">https://pub.towardsai.net/deep-learning-for-weather-classification-fe877cdc721c?source=collection_archive---------2-----------------------#2020-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7622" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a></h2><div class=""/><div class=""><h2 id="ad9e" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">在不同的天气状态之间分类！</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0194fd934643c306613466443d7f6e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NV8_qo3QWhZouWSr"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@noaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> NOAA </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="89d7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">被困在付费墙后面？点击<a class="ae le" href="https://medium.com/@D3nii/deep-learning-for-weather-classification-fe877cdc721c?sk=34216c1b9b4ed199feda20c7510d76f3" rel="noopener">这里</a>阅读完整故事与我的朋友链接！</p><p id="dd60" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">谁不喜欢日落？但你有没有想过，它们为什么这么美？是什么让那些云突然显得超级好看？仅仅是那团巨大的热物质发出的光束吗？嗯，这篇文章不是要回答这个问题，而是试图根据提供的图片对不同的天气状况进行分类。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="5450" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">概观</h1><p id="ec87" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">这个项目的主要目的是制作一个模型，在它看到的图像上正确地分类天气状态。</p><p id="b1d8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这看起来很简单，但是模型面临的主要挑战是它不需要了解图像中物体的形状，例如云等等。相反，它需要了解图像中天空的颜色。但是它也需要知道哪里的云实际上代表了多云的天气或者只是在那里。</p><h1 id="ed56" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">密码？</h1><p id="9692" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">该项目可在<a class="ae le" href="https://github.com/D3nii/Keras-Projects/tree/master/Whether%20Classification" rel="noopener ugc nofollow" target="_blank"> my Github Repo </a>上获得。</p><h1 id="8ba8" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">环境和工具</h1><ul class=""><li id="c282" class="nk nl iq lh b li na ll nb lo nm ls nn lw no ma np nq nr ns bi translated"><a class="ae le" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a></li><li id="51c4" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a></li><li id="907b" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.numpy.org/" rel="noopener ugc nofollow" target="_blank">数字价格</a></li><li id="860b" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a></li><li id="86e0" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a></li></ul><h1 id="82c6" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">数据</h1><p id="6d57" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">所以，第一步是看一下数据集。</p><p id="a2bd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">本项目使用的数据集是<a class="ae le" href="https://data.mendeley.com/datasets/4drtyfjtfy/1" rel="noopener ugc nofollow" target="_blank">多类天气数据集</a>。</p><blockquote class="ny nz oa"><p id="764a" class="lf lg ob lh b li lj ka lk ll lm kd ln oc lp lq lr od lt lu lv oe lx ly lz ma ij bi translated">用于图像分类的多类天气数据集(MWD)是一个有价值的数据集，用于题为“使用非均匀集成方法从静止图像进行多类天气识别”的研究论文中。该数据集通过提取各种特征来识别不同的天气条件，从而为户外天气分析提供了一个平台。</p></blockquote><h1 id="53b3" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">导入库</h1><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="338e" class="ok mj iq og b gy ol om l on oo"><strong class="og ja">import</strong> <strong class="og ja">os</strong><br/><strong class="og ja">import</strong> <strong class="og ja">sys</strong><br/><strong class="og ja">import</strong> <strong class="og ja">keras</strong><br/><strong class="og ja">import</strong> <strong class="og ja">tarfile</strong><br/><strong class="og ja">import</strong> <strong class="og ja">numpy</strong> <strong class="og ja">as</strong> <strong class="og ja">np</strong><br/><strong class="og ja">import</strong> <strong class="og ja">tensorflow</strong> <strong class="og ja">as</strong> <strong class="og ja">tf</strong><br/><strong class="og ja">import</strong> <strong class="og ja">urllib.request</strong> <strong class="og ja">as</strong> <strong class="og ja">urllib</strong><br/><strong class="og ja">import</strong> <strong class="og ja">matplotlib.pyplot</strong> <strong class="og ja">as</strong> <strong class="og ja">plt</strong><br/><strong class="og ja">from</strong> <strong class="og ja">keras.regularizers</strong> <strong class="og ja">import</strong> l2<br/><strong class="og ja">from</strong> <strong class="og ja">keras.models</strong> <strong class="og ja">import</strong> Sequential<br/><strong class="og ja">from</strong> <strong class="og ja">keras.optimizers</strong> <strong class="og ja">import</strong> Adam, SGD<br/><strong class="og ja">from</strong> <strong class="og ja">keras.engine.training</strong> <strong class="og ja">import</strong> Model<br/><strong class="og ja">from</strong> <strong class="og ja">keras</strong> <strong class="og ja">import</strong> backend <strong class="og ja">as</strong> K, regularizers<br/><strong class="og ja">from</strong> <strong class="og ja">keras.callbacks</strong> <strong class="og ja">import</strong> LearningRateScheduler<br/><strong class="og ja">from</strong> <strong class="og ja">keras.preprocessing.image</strong> <strong class="og ja">import</strong> ImageDataGenerator<br/><strong class="og ja">from</strong> <strong class="og ja">keras.layers</strong> <strong class="og ja">import</strong> Add, Conv2D, MaxPooling2D, Dropout, Flatten, Dense, BatchNormalization, Activation</span></pre><h1 id="7bfe" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">数据预处理</h1><p id="66bd" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">共有2631幅图像，分属7种类型。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="544e" class="ok mj iq og b gy ol om l on oo"><strong class="og ja">from</strong> <strong class="og ja">PIL</strong> <strong class="og ja">import</strong> Image<br/><strong class="og ja">import</strong> <strong class="og ja">os</strong>, <strong class="og ja">glob</strong><br/><strong class="og ja">import</strong> <strong class="og ja">numpy</strong> <strong class="og ja">as</strong> <strong class="og ja">np</strong><br/><strong class="og ja">from</strong> <strong class="og ja">sklearn.model_selection</strong> <strong class="og ja">import</strong> train_test_split</span><span id="1a2e" class="ok mj iq og b gy op om l on oo">dir = '/content/gdrive/My Drive/Temp/Whether/dataset'<br/>categories = sorted(os.listdir(dir))<br/>nb_classes = len(categories)</span><span id="2172" class="ok mj iq og b gy op om l on oo">X = []<br/>Y = []<br/>image_w = 64<br/>image_h = 64</span><span id="d134" class="ok mj iq og b gy op om l on oo"><strong class="og ja">for</strong> idx, f <strong class="og ja">in</strong> enumerate(categories):<br/>    label = [0 <strong class="og ja">for</strong> i <strong class="og ja">in</strong> range(nb_classes)] <br/>    label[idx] = 1<br/>    image_dir = dir + "/" + f <br/>    files = glob.glob(image_dir + "/*.jpg")</span><span id="b17d" class="ok mj iq og b gy op om l on oo"><strong class="og ja">for</strong> i, fname <strong class="og ja">in</strong> enumerate(files):<br/>        img = Image.open(fname)<br/>        img = img.convert("RGB")<br/>        img = img.resize((image_w, image_h))<br/>        data = np.asarray(img)<br/>        X.append(data)<br/>        Y.append(label)<br/>          <br/><strong class="og ja">for</strong> ang <strong class="og ja">in</strong> range(-20, 20, 5):<br/>    img2 = img.rotate(ang)<br/>    data = np.asarray(img2) <br/>    X.append(data)<br/>    Y.append(label)</span><span id="099c" class="ok mj iq og b gy op om l on oo">img2 = img2.transpose(Image.FLIP_LEFT_RIGHT)<br/>    data = np.asarray(img2) <br/>    X.append(data)<br/>    Y.append(label)</span></pre><p id="2630" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，让我们将数据转换为测试和训练分割。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="2111" class="ok mj iq og b gy ol om l on oo">X = np.array(X)<br/>Y = np.array(Y)</span><span id="323b" class="ok mj iq og b gy op om l on oo">x_train, x_test, y_train, y_test = train_test_split(X, Y)</span></pre><p id="3e13" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，标准化数据。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="01c2" class="ok mj iq og b gy ol om l on oo">x_train = x_train.astype("float32") / 255.0<br/>x_test = x_test.astype("float32") / 255.0</span><span id="e9d8" class="ok mj iq og b gy op om l on oo">print('X_train shape: ', x_train.shape[0]) # X_train shape: 1973<br/>print('Y_train shape: ', y_train.shape)    # Y_train shape:(1973, 7)</span></pre><p id="893c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们来看看数据集。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="809f" class="ok mj iq og b gy ol om l on oo"><strong class="og ja">from</strong> <strong class="og ja">matplotlib</strong> <strong class="og ja">import</strong> pyplot</span><span id="bbc0" class="ok mj iq og b gy op om l on oo"><em class="ob"># summarize loaded dataset</em><br/>print('Train: X=<strong class="og ja">%s</strong>, y=<strong class="og ja">%s</strong>' % (x_train.shape, y_train.shape))<br/>print('Test: X=<strong class="og ja">%s</strong>, y=<strong class="og ja">%s</strong>' % (x_test.shape, y_test.shape))</span><span id="9edf" class="ok mj iq og b gy op om l on oo"><em class="ob"># plot first few images</em><br/><strong class="og ja">for</strong> i <strong class="og ja">in</strong> range(9):<br/>	<em class="ob"># define subplot</em><br/>	pyplot.subplot(330 + 1 + i)</span><span id="59be" class="ok mj iq og b gy op om l on oo"><em class="ob"># plot raw pixel data</em><br/>	pyplot.imshow(x_train[i], cmap=pyplot.get_cmap('gray'))</span><span id="ad68" class="ok mj iq og b gy op om l on oo"><em class="ob"># show the figure</em><br/>pyplot.show()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/fb374c7ca3aef89cf9357ac76d12297e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*bjYJmK4VHJARPhuMUmh5WA.png"/></div></figure><h1 id="b37a" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">图像增强</h1><p id="4cfd" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">我们将稍微改变一些图像，以获得更好的概括和更好的整体效果。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="338f" class="ok mj iq og b gy ol om l on oo"><em class="ob"># applying transformation to image</em> <br/>train_gen = ImageDataGenerator(         <br/>rotation_range=20,           <br/>zoom_range = 0.15,           <br/>width_shift_range=0.5,          <br/>height_shift_range=0.5,         <br/>brightness_range=[0.25,1.5],         <br/>horizontal_flip=<strong class="og ja">True</strong>, )</span><span id="585d" class="ok mj iq og b gy op om l on oo"><em class="ob"># test_gen = ImageDataGenerator()</em></span><span id="f101" class="ok mj iq og b gy op om l on oo">train_gen.fit(x_train)  <br/>test_set = train_gen.flow(x_test, y_test, batch_size=256)</span></pre><h1 id="5ace" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">模型架构</h1><p id="d75e" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">有趣的部分来了！我在这里设计的架构由6个<a class="ae le" href="https://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积</a>模块组成！</p><p id="f1a3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我使用卷积层:</p><ul class=""><li id="d203" class="nk nl iq lh b li lj ll lm lo or ls os lw ot ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjWmNaWlP_qAhXC3YUKHZ5EDIIQFjAXegQIAhAB&amp;url=https%3A%2F%2Fwww.sciencedirect.com%2Ftopics%2Fengineering%2Fkernel-size&amp;usg=AOvVaw2o-WRxmZrPtY0R_gavIhr3" rel="noopener ugc nofollow" target="_blank">内核大小</a> : 3</li><li id="a85b" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://keras.io/api/layers/initializers/" rel="noopener ugc nofollow" target="_blank">内核初始化器</a>:<a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjN2-SNlf_qAhXFxoUKHaNACgUQFjAAegQIARAB&amp;url=https%3A%2F%2Fwww.tensorflow.org%2Fapi_docs%2Fpython%2Ftf%2Fkeras%2Finitializers%2FHeUniform&amp;usg=AOvVaw3JZZwRf8N4yIseWbjODgD6" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="ob">he _ uniform</em></strong></a></li><li id="ceaa" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://keras.io/api/layers/regularizers/" rel="noopener ugc nofollow" target="_blank">内核正则化</a>:<a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwir55LFlP_qAhUK9IUKHWuEDTkQFjABegQIBRAB&amp;url=https%3A%2F%2Farxiv.org%2Fpdf%2F1205.2653&amp;usg=AOvVaw2tza0OEnBAIJ19HrSEfM6m" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="ob">L2</em></strong></a></li><li id="ddfc" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjX9Lr4lP_qAhXHxYUKHfy9DFQQFjAIegQIAhAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FActivation_function&amp;usg=AOvVaw1mbqcQWcxK0bwZ0LpjldIN" rel="noopener ugc nofollow" target="_blank">激活</a> : <a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjU1-mBlf_qAhUCy4UKHb5eCuEQFjAGegQIARAB&amp;url=https%3A%2F%2Fsefiks.com%2F2018%2F01%2F02%2Felu-as-a-neural-networks-activation-function%2F&amp;usg=AOvVaw3OnGX-Nu0Z-iPbWFQMBt3t" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja"> <em class="ob">埃鲁</em> </strong> </a></li><li id="3fee" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjj6r-elf_qAhUIfBoKHZ8GAm0QFjAAegQIBRAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Flayers%2Fpooling_layers%2Fmax_pooling2d%2F&amp;usg=AOvVaw0lrhZz3TwYno3YFpazYe5U" rel="noopener ugc nofollow" target="_blank">最大池</a> : (2，2)</li><li id="faca" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi__uTLlf_qAhVKzoUKHcMKAvMQFjAAegQIARAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Flayers%2Fnormalization_layers%2Fbatch_normalization%2F&amp;usg=AOvVaw2NT_Zm_P4hYX3yYxWZvzEb" rel="noopener ugc nofollow" target="_blank">批量正常化</a></li></ul><p id="6bf7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然后是两层<a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwim8uz8lf_qAhXQy4UKHZJaDBYQFjAZegQIDBAQ&amp;url=https%3A%2F%2Fwww.tutorialspoint.com%2Fkeras%2Fkeras_dense_layer.htm&amp;usg=AOvVaw0URJwEDmeThpxsnyoLRBA-" rel="noopener ugc nofollow" target="_blank">密密麻麻的</a>跟:</p><ul class=""><li id="1bce" class="nk nl iq lh b li lj ll lm lo or ls os lw ot ma np nq nr ns bi translated"><a class="ae le" href="https://keras.io/api/layers/regularizers/" rel="noopener ugc nofollow" target="_blank">内核正则化</a>:<a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwir55LFlP_qAhUK9IUKHWuEDTkQFjABegQIBRAB&amp;url=https%3A%2F%2Farxiv.org%2Fpdf%2F1205.2653&amp;usg=AOvVaw2tza0OEnBAIJ19HrSEfM6m" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="ob">L2</em></strong></a></li><li id="98d8" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjX9Lr4lP_qAhXHxYUKHfy9DFQQFjAIegQIAhAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FActivation_function&amp;usg=AOvVaw1mbqcQWcxK0bwZ0LpjldIN" rel="noopener ugc nofollow" target="_blank">激活</a>:<a class="ae le" href="https://r.search.yahoo.com/_ylt=AwrIAX5sRVlfq4IAiw53Bwx.;_ylu=X3oDMTByaW11dnNvBGNvbG8DaXIyBHBvcwMxBHZ0aWQDBHNlYwNzcg--/RV=2/RE=1599714797/RO=10/RU=https%3a%2f%2fmachinelearningmastery.com%2frectified-linear-activation-function-for-deep-learning-neural-networks%2f/RK=2/RS=eOa0gUzVvFwrRiCWJFRlne7fxU0-" rel="noopener ugc nofollow" target="_blank">r<strong class="lh ja"><em class="ob">elu</em></strong></a></li><li id="8f80" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi__uTLlf_qAhVKzoUKHcMKAvMQFjAAegQIARAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Flayers%2Fnormalization_layers%2Fbatch_normalization%2F&amp;usg=AOvVaw2NT_Zm_P4hYX3yYxWZvzEb" rel="noopener ugc nofollow" target="_blank">批量正常化</a>` 1</li></ul><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="782f" class="ok mj iq og b gy ol om l on oo">model = Sequential()  </span><span id="14ef" class="ok mj iq og b gy op om l on oo"><em class="ob"># Block 1<br/></em>model.add(Conv2D(32, kernel_size=3, kernel_initializer='he_uniform', kernel_regularizer=l2(0.0005), padding='same', input_shape=(64, 64, 3))) <br/>model.add(Activation('elu')) <br/>model.add(BatchNormalization()) <br/>model.add(MaxPooling2D(2, 2))</span><span id="ce5a" class="ok mj iq og b gy op om l on oo"><em class="ob"># Block 2</em> <br/>model.add(Conv2D(64, kernel_size=3, kernel_initializer='he_uniform', kernel_regularizer=l2(0.0005), padding='same')) model.add(Activation('elu')) <br/>model.add(BatchNormalization()) <br/><em class="ob"># model.add(MaxPooling2D(2, 2))</em></span><span id="ece1" class="ok mj iq og b gy op om l on oo"><em class="ob"># Block 3</em> <br/>model.add(Conv2D(128, kernel_size=3, kernel_initializer='he_uniform', kernel_regularizer=l2(0.0005), padding='same')) <br/>model.add(Activation('elu')) model.add(BatchNormalization()) <br/>model.add(MaxPooling2D(2, 2))</span><span id="b760" class="ok mj iq og b gy op om l on oo"><em class="ob"># Block 4</em> <br/>model.add(Conv2D(256, kernel_size=3, kernel_initializer='he_uniform', kernel_regularizer=l2(0.0005), padding='same')) <br/>model.add(Activation('elu')) <br/>model.add(BatchNormalization()) <br/><em class="ob"># model.add(MaxPooling2D(2, 2))</em></span><span id="7b0b" class="ok mj iq og b gy op om l on oo"><em class="ob"># Block 5</em> <br/>model.add(Conv2D(512, kernel_size=3, kernel_initializer='he_uniform', kernel_regularizer=l2(0.0005), padding='same')) <br/>model.add(Activation('elu')) <br/>model.add(BatchNormalization()) <br/>model.add(MaxPooling2D(2, 2))</span><span id="ff0d" class="ok mj iq og b gy op om l on oo"><em class="ob"># Block 6</em> <br/>model.add(Conv2D(1024, kernel_size=3, kernel_initializer='he_uniform', kernel_regularizer=l2(0.0005), padding='same')) <br/>model.add(Activation('elu')) <br/>model.add(BatchNormalization()) <br/><em class="ob"># model.add(MaxPooling2D(2, 2))</em></span><span id="e1c5" class="ok mj iq og b gy op om l on oo">model.add(Flatten())</span><span id="494a" class="ok mj iq og b gy op om l on oo"><em class="ob"># Dense 1</em> model.add(Dense(1400, kernel_regularizer=l2(0.0005))) model.add(Activation('relu')) <br/>model.add(BatchNormalization())</span><span id="a9a1" class="ok mj iq og b gy op om l on oo"><em class="ob"># Dense 2</em> <br/>model.add(Dense(7, kernel_regularizer=l2(0.0005), activation='softmax'))</span><span id="bd68" class="ok mj iq og b gy op om l on oo"><em class="ob"># Visualize Model</em> <br/>model.summary()</span></pre><h1 id="4122" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">超级参数设置</h1><blockquote class="ny nz oa"><p id="b8c4" class="lf lg ob lh b li lj ka lk ll lm kd ln oc lp lq lr od lt lu lv oe lx ly lz ma ij bi translated"><em class="iq">在机器学习中，</em> <strong class="lh ja"> <em class="iq">超参数</em> </strong> <em class="iq">优化或调优就是为一个学习算法选择一个</em> <strong class="lh ja"> <em class="iq">集合</em> </strong> <em class="iq">的最优超参数的问题。一个</em> <strong class="lh ja"> <em class="iq">超参数</em> </strong> <em class="iq">是一个</em> <strong class="lh ja"> <em class="iq">参数</em> </strong> <em class="iq">，其值用于控制学习过程。相比之下，学习其他</em> <strong class="lh ja"> <em class="iq">参数</em> </strong> <em class="iq">(通常为节点权重)的值。[3] </em></p></blockquote><p id="e06a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我使用了一个定制的学习率修改函数:initial_lr = 1e-2</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="80ec" class="ok mj iq og b gy ol om l on oo"><strong class="og ja">def</strong> lr_scheduler(epoch):<br/>    <strong class="og ja">if</strong> epoch &lt; 20:<br/>        <strong class="og ja">return</strong> initial_lr<br/>    <strong class="og ja">elif</strong> epoch &lt; 40:<br/>        <strong class="og ja">return</strong> initial_lr / 20<br/>    <strong class="og ja">elif</strong> epoch &lt; 50:<br/>        <strong class="og ja">return</strong> initial_lr / 40<br/>    <strong class="og ja">elif</strong> epoch &lt; 60:<br/>        <strong class="og ja">return</strong> initial_lr / 80<br/>    <strong class="og ja">elif</strong> epoch &lt; 70:<br/>        <strong class="og ja">return</strong> initial_lr / 160<br/>    <strong class="og ja">elif</strong> epoch &lt; 80:<br/>        <strong class="og ja">return</strong> initial_lr / 320<br/>    <strong class="og ja">elif</strong> epoch &lt; 90:<br/>        <strong class="og ja">return</strong> initial_lr / 640<br/>    <strong class="og ja">else</strong>:<br/>        <strong class="og ja">return</strong> initial_lr / 1280</span><span id="4f87" class="ok mj iq og b gy op om l on oo">model.compile(<br/>    loss = 'categorical_crossentropy',<br/>    optimizer = Adam(initial_lr),<br/>    metrics = ['accuracy']<br/>)</span></pre><p id="0752" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">参数:</p><ul class=""><li id="d7eb" class="nk nl iq lh b li lj ll lm lo or ls os lw ot ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi1h4DPmP_qAhVlyoUKHYa3DGIQFjAAegQIAxAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FLoss_function&amp;usg=AOvVaw3ExpvDmdNsYsL2BHwgxNrI" rel="noopener ugc nofollow" target="_blank">损失函数</a> : <a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi5msTomP_qAhXoxoUKHYQADVsQFjACegQIAxAB&amp;url=https%3A%2F%2Fpeltarion.com%2Fknowledge-center%2Fdocumentation%2Fmodeling-view%2Fbuild-an-ai-model%2Floss-functions%2Fcategorical-crossentropy&amp;usg=AOvVaw2Jn0FaQesQ8uuPWqlUrhHU" rel="noopener ugc nofollow" target="_blank">分类交叉熵</a></li><li id="068c" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjXwoGow__qAhU98uAKHVJLDxwQFjABegQIARAB&amp;url=https%3A%2F%2Fkeras.io%2Fapi%2Foptimizers%2F&amp;usg=AOvVaw0FAGroezYYk-tZ5VFEZDDa" rel="noopener ugc nofollow" target="_blank">优化器</a> : <a class="ae le" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjzrfC1w__qAhVN4eAKHaGkDu8QFjAQegQICxAR&amp;url=https%3A%2F%2Fmachinelearningmastery.com%2Fadam-optimization-algorithm-for-deep-learning%2F&amp;usg=AOvVaw3DyIH6zRqOJ31iqVVAy1z-" rel="noopener ugc nofollow" target="_blank">亚当</a></li><li id="da88" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated">度量= ['准确性']</li></ul><h1 id="2156" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">培养</h1><p id="774e" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">所以，我训练了300个纪元的网络。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="dbe3" class="ok mj iq og b gy ol om l on oo">history = model.fit(   <br/>x_train, y_train,   <br/>epochs=300,   <br/>verbose=1,   <br/>validation_data=(x_test, y_test),   <br/>callbacks=[keras.callbacks.LearningRateScheduler(lr_scheduler)],   shuffle=<strong class="og ja">True</strong> <br/>)</span></pre><h1 id="6f03" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">失败</h1><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="2d92" class="ok mj iq og b gy ol om l on oo">score = model.evaluate(x_test, y_test, verbose=0)<br/>print(f'Test loss: <strong class="og ja">{score[0]}</strong> / Test accuracy: {score[1]*100}')</span><span id="4210" class="ok mj iq og b gy op om l on oo"><em class="ob"># Visualize history</em><br/><em class="ob"># Plot history: Loss</em><br/>plt.plot(history.history['val_loss'])<br/>plt.title('Validation loss history')<br/>plt.ylabel('Loss value')<br/>plt.xlabel('No. epoch')<br/>plt.show()</span><span id="d79e" class="ok mj iq og b gy op om l on oo"><em class="ob"># Plot history: Accuracy</em><br/>plt.plot(history.history['val_accuracy'])<br/>plt.title('Validation accuracy history')<br/>plt.ylabel('Accuracy value (%)')<br/>plt.xlabel('No. epoch')<br/>plt.show()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/04b20362781e83046f9c9c0c38911358.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*ttlYiJOArHBDVNsaVYSjYQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">验证损失</figcaption></figure><p id="2e67" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">很明显，该模型在第一个&lt;50 epochs.</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/5d2af584aa4932725def1c5da55dfcd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*IBh-ymZBtjaTzyG6o_-8Pw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Validation Accuracy</figcaption></figure><p id="c8cc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">But we see a different trend in the Accuracy side of things. Here, the model started to get to 90% in the later 70–80 epochs.</p><h1 id="1152" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">Results &amp; Conclusion</h1><p id="b6cd" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">So, after all this, we reached <strong class="lh ja"><em class="ob"/></strong>中迅速将损失值降低到几乎为零94.52%准确度，老实说，因为有7个不同的类别，但训练图像的数量很少，该模型做得相当好。</p><h1 id="0572" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">可以做出的改进</h1><p id="40cb" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">我试图用一个较低的学习率来训练这个模型，但是一无所获。我得出的结论是，数据集比得到合理结果所需的要少得多。</p><p id="f479" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">好了，我希望这篇文章能帮助你。我们上<a class="ae le" href="https://www.linkedin.com/in/d3ni/" rel="noopener ugc nofollow" target="_blank"> <em class="ob"> Linkedin </em> </a>连线吧！</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="d2a4" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">进一步阅读</h1><div class="ow ox gp gr oy oz"><a href="https://medium.com/towards-artificial-intelligence/deep-learning-for-dog-breed-classification-7a6752e02f23" rel="noopener follow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ja gy z fp pe fr fs pf fu fw iz bi translated">用于狗品种分类的深度学习</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">一步一步的指南来分类115个品种的狗图片！</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">medium.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ky oz"/></div></div></a></div><div class="ow ox gp gr oy oz"><a href="https://medium.com/@D3nii/convolution-neural-network-9320fa32fe9c" rel="noopener follow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ja gy z fp pe fr fs pf fu fw iz bi translated">卷积神经网络？</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">欢迎大家！这是我在一个月内完成深度学习Nanodegree的旅程中的第六篇写作！我已经…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">medium.com</p></div></div><div class="pi l"><div class="po l pk pl pm pi pn ky oz"/></div></div></a></div><div class="ow ox gp gr oy oz"><a href="https://medium.com/@D3nii/tackling-common-neural-network-problems-e08b30775100" rel="noopener follow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ja gy z fp pe fr fs pf fu fw iz bi translated">解决常见的神经网络问题</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">大家好！这是我开始攻读纳米学位并完成第一个学位后的第四篇文章</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">medium.com</p></div></div><div class="pi l"><div class="pp l pk pl pm pi pn ky oz"/></div></div></a></div><h1 id="2ad4" class="mi mj iq bd mk ml nf mn mo mp ng mr ms kf nh kg mu ki ni kj mw kl nj km my mz bi translated">联系人</h1><p id="09f4" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">如果你想了解我最新的文章和项目<a class="ae le" href="https://medium.com/@D3nii" rel="noopener">，请关注我的媒体</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="1c33" class="nk nl iq lh b li lj ll lm lo or ls os lw ot ma np nq nr ns bi translated"><a class="ae le" href="https://www.linkedin.com/in/d3ni/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="9b92" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://github.com/D3nii?tab=repositories" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="1588" class="nk nl iq lh b li nt ll nu lo nv ls nw lw nx ma np nq nr ns bi translated"><a class="ae le" href="https://twitter.com/danyal0_o" rel="noopener ugc nofollow" target="_blank">推特</a></li></ul><blockquote class="pq"><p id="9520" class="pr ps iq bd pt pu pv pw px py pz ma dk translated">快乐学习。:)</p></blockquote></div></div>    
</body>
</html>