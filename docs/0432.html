<html>
<head>
<title>Beginners Guide to Machine Learning: Data Pre-processing using Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习初学者指南:使用Python进行数据预处理。</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/beginners-guide-to-machine-learning-data-pre-processing-using-python-da6a21274620?source=collection_archive---------0-----------------------#2020-04-25">https://pub.towardsai.net/beginners-guide-to-machine-learning-data-pre-processing-using-python-da6a21274620?source=collection_archive---------0-----------------------#2020-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/26ec8d38f6d39c149c77336eaca5a44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQBDxp-1O7gfh4A05aZnWA.png"/></div></div></figure><p id="b7b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">学习机器学习的旅程超级漫长，但却非常令人兴奋！</p><p id="38d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你是一个初学者，这个博客正是你所需要的，让你有一个良好的开端！数据处理是你作为机器学习从业者学习的第一个工具。我们开始吧！</p><h2 id="babb" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">目录:</h2><ol class=""><li id="6b34" class="lp lq iq ka b kb lr kf ls kj lt kn lu kr lv kv lw lx ly lz bi translated">介绍</li><li id="b766" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">导入库</li><li id="41cc" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">导入数据集</li><li id="4c8e" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">处理缺失数据</li><li id="5abd" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">编码分类值</li><li id="0f9a" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">将数据集分为训练数据和测试数据。</li></ol></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="87be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据预处理是这一旅程中必不可少的一部分，随着您的深入，您将会认识到数据预处理在准确构建、训练和测试您的模型中所起的关键作用。</p><p id="8d9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有必要以正确的方式预处理您的数据，以便您将构建的机器学习模型可以使用该数据以正确的方式进行训练！在开始时，这似乎不是一个不寻常的步骤。然而，一旦你学会有效地做这件事，你就能迅速掌握机器学习(ML)的各个分支。</p><h2 id="1326" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">步骤1]导入库</h2><h2 id="cbcc" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">什么是图书馆？</h2><p id="e742" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">Python中的库是一个相当大的工具、函数和模块的集合体，有助于使期望的任务更容易。</p><p id="454b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mp">熊猫库</em> </strong>:允许我们读取和检索数据集。</p><p id="b735" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mp"> Numpy库</em> </strong>:处理数学和高级2D数组。</p><p id="db7a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mp"> Matplotlib库</em> </strong>:帮助我们以条形图、折线图、饼状图等形式可视化数据。</p><p id="da04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了方便地调用上面的库函数，我们使用像“np”、“pd”、“plt”这样的短语法来重命名这些库。"</p><p id="7f5b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些库可以通过以下步骤导入，如下面的代码片段所示:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="4531" class="kw kx iq mv b gy mz na l nb nc">import numpy as np</span><span id="1979" class="kw kx iq mv b gy nd na l nb nc">import pandas as pd</span><span id="af37" class="kw kx iq mv b gy nd na l nb nc">import matplotlib.pyplot as plt</span></pre><h2 id="50b0" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">步骤2]导入数据集</h2><h2 id="cb90" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">什么是数据集？</h2><p id="faa0" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated"><strong class="ka ir">数据集</strong>是包含我们所有数据的集合，帮助我们设计和训练我们的机器学习模型。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/4ee003daee842fa302c688f638acbafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*aN8WsLQ2YPzyzlK7T9smpg.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk translated">来自Udemy的数据集。Data.csv</figcaption></figure><p id="5f7b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上述数据集有3个<strong class="ka ir"> <em class="mp">自变量或特征</em> </strong>:国家、年龄、工资，以及1个<strong class="ka ir"> <em class="mp">因变量或目标变量</em> </strong>:购买的产品，可以有二进制输出:是或否，取决于自变量。</p><p id="810e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了导入数据集，我们需要pandas库函数。</p><p id="935f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先要做的是创建一个包含数据集的变量，并创建其数据框。</p><p id="64ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后声明两个变量，分别包含特性和目标。下面的代码片段显示了如何导入数据集。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="5937" class="kw kx iq mv b gy mz na l nb nc">dataset=pd.read_csv("Path of your csv file location") <br/>#read_csv is function of pandas which helps in retrieving data in form of data frame.</span><span id="5404" class="kw kx iq mv b gy nd na l nb nc">X=dataset.iloc[:,:-1].values #X stores features<br/>#iloc is a function of pandas which helps us split dataset based on its index location.</span><span id="b307" class="kw kx iq mv b gy nd na l nb nc">y=dataset.iloc[:,-1].values #y stores target</span></pre><h2 id="aaa6" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">步骤3]处理缺失的数据</h2><p id="fbbc" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">正如您所观察到的，上面的数据集在列Age和salary中有一些缺失数据，如果不进行处理，这些数据可能会成为模型定型时出现错误的原因。因此，有必要注意数据集中缺失的数据值。</p><p id="cc0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在大型数据集的情况下，具有缺失数据的条目可以被忽略或直接移除。但是，如果您的数据集是紧凑的或受限制的，则需要处理缺失的数据。</p><p id="5112" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，可用于处理缺失数据的方法是对具有缺失数据的列中的所有条目取平均值。为此，我们导入了一个著名的ML库，名为<strong class="ka ir"> <em class="mp"> sci-kit-learn </em> </strong>。它包含处理缺失值的数据预处理工具。我们将使用类<strong class="ka ir"> <em class="mp">估算器</em> </strong>来处理缺失值。</p><p id="febc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码片段:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="a772" class="kw kx iq mv b gy mz na l nb nc">from sklearn.impute import SimpleImputer</span><span id="0da9" class="kw kx iq mv b gy nd na l nb nc">imputer = SimpleImputer(missing_values = np.nan, strategy='mean')</span><span id="03a2" class="kw kx iq mv b gy nd na l nb nc">imputer.fit(X[:,1:3])// enter columns which contain real numbers</span><span id="3836" class="kw kx iq mv b gy nd na l nb nc">X[:,1:3]= imputer.transform(X[:,1:3])</span><span id="5cac" class="kw kx iq mv b gy nd na l nb nc">print(X)</span></pre><h2 id="7d27" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">步骤4]编码分类数据</h2><p id="93cd" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">几乎所有数据集都包含分类数据列。这一列字符串需要处理并转换成实数。线性排列类别可能会造成数据之间存在关系的错误印象，从而导致模型中的错误。</p><p id="a5c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们将使用<strong class="ka ir"> <em class="mp"> one-hot-encoding方法</em> </strong>将分类数据转换为数值数据。但是，我们会将包含<strong class="ka ir"> <em class="mp"> yes和</em></strong>no的目标变量的分类数据分别转换为<strong class="ka ir"> 1 </strong>和<strong class="ka ir"> 0、</strong>。不会损害未来数据的准确性。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="975c" class="kw kx iq mv b gy mz na l nb nc">#Encoding Independent variable</span><span id="03b9" class="kw kx iq mv b gy nd na l nb nc">from sklearn.compose import ColumnTransformer</span><span id="3f27" class="kw kx iq mv b gy nd na l nb nc">from sklearn.preprocessing import OneHotEncoder</span><span id="bfc8" class="kw kx iq mv b gy nd na l nb nc">ct = ColumnTransformer(transformers=[('encoder',OneHotEncoder(),[0])], remainder='passthrough')</span><span id="18b5" class="kw kx iq mv b gy nd na l nb nc">X= np.array(ct.fit_transform(X))</span><span id="df56" class="kw kx iq mv b gy nd na l nb nc">print(X)</span><span id="1736" class="kw kx iq mv b gy nd na l nb nc">#Encoding Dependent Variable</span><span id="2d5c" class="kw kx iq mv b gy nd na l nb nc">from sklearn.preprocessing import LabelEncoder</span><span id="1832" class="kw kx iq mv b gy nd na l nb nc">le=LabelEncoder()</span><span id="bdbf" class="kw kx iq mv b gy nd na l nb nc">y= le.fit_transform(y)</span><span id="8548" class="kw kx iq mv b gy nd na l nb nc">print(y)</span></pre><p id="9cd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如上面的代码片段所示，为了对独立的分类数据进行编码，使用了OneHotEncoder，并将余数设置为“passthrough ”,以便不会抵消剩余的特征。使用NumPy将结果转换为数组。</p><p id="88e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于因变量编码，使用scikit-learn模块中的LabelEncoder。</p><h2 id="4d33" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">步骤5]特征缩放</h2><p id="9a38" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">特征缩放有助于将独立变量或特征的值放在同一范围内。并非总是需要对所有模型应用特征缩放。一些型号使用流量系数自动补偿高值。</p><p id="11cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用的两种技术是<strong class="ka ir">标准化和规范化。</strong></p><p id="6f97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将使用标准化。(使用任何技术，都不会引起输出的任何显著变化。)</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="2aac" class="kw kx iq mv b gy mz na l nb nc"># Formula of Standardization <br/># Xstand = [x- mean(x)]/standard_deviation(x)</span><span id="8da5" class="kw kx iq mv b gy nd na l nb nc">from sklearn.preprocessing import StandardScaler</span><span id="7877" class="kw kx iq mv b gy nd na l nb nc">sc = StandardScaler()</span><span id="ed39" class="kw kx iq mv b gy nd na l nb nc">X=sc.fit_transform(X)</span><span id="2470" class="kw kx iq mv b gy nd na l nb nc">print(X)</span></pre><p id="b753" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要素缩放返回在相同范围内缩放的输出。</p><p id="109d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤6】将数据集分为训练集和测试集</strong></p><p id="d9b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是重要的一步。我们总是需要将数据分为训练集和测试集，以分别训练和测试我们的模型。通常情况下，<strong class="ka ir"> 80% </strong>的数据用于训练数据，<strong class="ka ir"> 20% </strong>用于在未来的测试数据上测试模型。</p><p id="75f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了避免过度拟合，数据应该根据有限的测试数据进行训练。但是，当训练集不足时，模型会对测试集产生错误。因此，应该适当地进行选择和分割。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="11e0" class="kw kx iq mv b gy mz na l nb nc">from sklearn.model_selection import train_test_split</span><span id="73f1" class="kw kx iq mv b gy nd na l nb nc">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0 )</span></pre><p id="49f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这概括了处理数据所需的所有工具。对于几乎所有的模型，我们将需要导入库，导入数据集，并将数据分成训练集和测试集。我们有时可能需要其他提到的工具。</p></div></div>    
</body>
</html>