<html>
<head>
<title>NeuralProphet For Time-Series Forecasting: Predicting Stock Prices Using Facebook’s New Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测的神经网络:用脸书的新模型预测股票价格</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/neuralprophet-for-time-series-forecasting-predicting-stock-prices-using-facebooks-new-model-c5c191ed4eb8?source=collection_archive---------0-----------------------#2021-12-20">https://pub.towardsai.net/neuralprophet-for-time-series-forecasting-predicting-stock-prices-using-facebooks-new-model-c5c191ed4eb8?source=collection_archive---------0-----------------------#2021-12-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1de3" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a></h2><div class=""/><div class=""><h2 id="98d1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在这篇文章中，我将向您展示如何使用一种新的预测模型来预测时间序列，这种模型可以从脸书数据科学团队公开获得:著名的NeuralProphet！</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3628221d0468d64fe9ab8b056ac12e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNkiX6WzYsRAledP8FKisA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">作者使用模型制作的图形。</figcaption></figure><h1 id="cf6e" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">1.介绍</h1><p id="62e0" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">在之前的帖子中，我解释并展示了脸书的先知模型是如何工作的。如果你错过了，看看这里的<a class="ae mv" href="https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5?sk=ddaac7a1a51ef0422da24a0c47e301a6" rel="noopener" target="_blank"/>。</p><p id="b4d7" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">近日，脸书数据科学团队发布了该模型的新版本<a class="ae mv" href="https://github.com/ourownstory/neural_prophet" rel="noopener ugc nofollow" target="_blank"><strong class="mb jd">NeuralProphet</strong></a><strong class="mb jd">。</strong></p><p id="78d7" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd">免责声明</strong>(在我们继续之前):已经有人尝试使用时间序列分析算法来预测股票价格，尽管它们仍然不能用于在真实市场中下注。这只是一篇教程文章，并不打算以任何方式“指导”人们购买股票。</p><p id="b810" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">让我们开始吧。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="95a8" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">如果您想在交互式路线图和活跃的学习社区的支持下自学数据科学，请查看以下资源:<a class="ae mv" href="https://aigents.co/learn" rel="noopener ugc nofollow" target="_blank">https://aigents.co/learn</a></p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h2 id="5f31" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">1.1.时间序列和预测模型</h2><p id="dfb2" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">传统上，大多数机器学习(ML)模型使用一些观察值(样本/例子)作为输入特征，但是在数据中没有<strong class="mb jd">时间</strong>维度<strong class="mb jd">维度</strong>。</p><p id="f306" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd">时间序列预测</strong>模型是能够根据<strong class="mb jd">先前</strong> <strong class="mb jd">观测</strong> <strong class="mb jd">值</strong>预测 <strong class="mb jd">未来值</strong>的模型。时间序列预测广泛用于<strong class="mb jd">非平稳数据</strong>。<strong class="mb jd">非平稳数据</strong>被称为其统计属性(例如，平均值和标准偏差)不随时间保持不变，而是随时间变化的数据。</p><p id="636f" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这些非平稳输入数据(用作这些模型的输入)通常被称为<strong class="mb jd">时间序列。</strong>时间序列的一些例子包括随时间变化的温度值、随时间变化的股票价格、随时间变化的房屋价格等。因此，输入是一个<strong class="mb jd">信号</strong>(时间序列),它是由在时间中连续进行的观察所定义的<strong class="mb jd">。</strong></p><blockquote class="nt"><p id="1b1c" class="nu nv it bd nw nx ny nz oa ob oc mu dk translated">时间序列是按时间顺序进行的一系列观察。</p></blockquote><figure class="oe of og oh oi kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/c1f817b09e401ba3c29023c4fddd2e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SULcaLxjHsAVmhxG7Xo0cA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">时间序列的一个例子。剧情是作者用Python创作的。</figcaption></figure><p id="24f6" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd">观察:时序</strong>数据被记录在一个<strong class="mb jd">离散</strong> <strong class="mb jd">时间</strong> <strong class="mb jd">刻度</strong>上。</p><h2 id="3e17" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">1.2旧的预测模型:脸书的先知</h2><p id="31f6" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">预测预测最常用的模型是<a class="ae mv" href="https://en.wikipedia.org/wiki/Autoregressive_model" rel="noopener ugc nofollow" target="_blank"> <strong class="mb jd">自回归</strong> </a>模型。简而言之，自回归模型规定输出变量线性依赖于它自己以前的值和一个随机项(一个不完全可预测的项)。</p><p id="41c9" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">最近，为了开发一个可以在时间序列数据中捕捉<strong class="mb jd">季节性</strong>的模型，<strong class="mb jd">脸书</strong>开发了著名的<strong class="mb jd"> Prophet </strong>模型，每个人都可以公开获得。预言者能够通过实现<a class="ae mv" href="https://en.wikipedia.org/wiki/Additive_model" rel="noopener ugc nofollow" target="_blank"> <strong class="mb jd">加性回归</strong> </a> <strong class="mb jd">模型来捕捉<strong class="mb jd">每日</strong>、<strong class="mb jd">每周</strong>和<strong class="mb jd">每年的季节性</strong>以及<strong class="mb jd">假日</strong> <strong class="mb jd">影响</strong>。</strong></p><p id="bf9c" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">Prophet模型背后的数学方程式定义为:</p><blockquote class="nt"><p id="a153" class="nu nv it bd nw nx ny nz oa ob oc mu dk translated">y(t) = g(t) + s(t) + h(t) + e(t)</p></blockquote><ul class=""><li id="1fa5" class="oj ok it mb b mc ol mf om mi on mm oo mq op mu oq or os ot bi translated">其中，g(t)代表趋势。Prophet使用分段线性模型进行趋势预测。</li><li id="c367" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">s(t)代表周期性变化(每周、每月、每年)。</li><li id="6405" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">h(t)代表假期的影响(回想一下:假期影响业务)。</li><li id="f287" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">e(t)是误差项。</li></ul><p id="426a" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">Prophet模型拟合过程通常非常快(即使对于成千上万的观察)，并且不需要任何数据预处理。它还处理缺失数据和异常值。</p><h2 id="3873" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">1.3新的预测模型:脸书的<a class="ae mv" href="https://github.com/ourownstory/neural_prophet" rel="noopener ugc nofollow" target="_blank">神经营养因子</a></h2><p id="9976" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">最近，脸书数据科学团队发布了该模型的新版本<a class="ae mv" href="https://github.com/ourownstory/neural_prophet" rel="noopener ugc nofollow" target="_blank"><strong class="mb jd"/></a><strong class="mb jd">。</strong><a class="ae mv" href="https://github.com/ourownstory/neural_prophet" rel="noopener ugc nofollow" target="_blank"><strong class="mb jd">NeuralProphet</strong></a><strong class="mb jd">是基于神经网络的时间序列数据模型。</strong></p><h2 id="e617" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">1.4 NeuralProphet vs. Prophet</h2><p id="a828" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">与旧的Prophet模型相比的主要差异总结如下:</p><ul class=""><li id="402f" class="oj ok it mb b mc mw mf mx mi oz mm pa mq pb mu oq or os ot bi translated">通过使用PyTorch作为后端进行优化的梯度下降。</li><li id="7ef6" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">基于AR-Net的时间序列自相关建模</li><li id="7f61" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">使用独立的前馈神经网络建模滞后回归量。</li><li id="fbad" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">FFNNs的可配置非线性深层。</li><li id="9233" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">可调整到特定的预测范围(大于1)。</li><li id="24fb" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated">自定义损失和指标。</li></ul><p id="7bcf" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">来源:https://neuralprophet.com/changes-from-prophet/<a class="ae mv" href="https://neuralprophet.com/changes-from-prophet/" rel="noopener ugc nofollow" target="_blank"/></p><p id="5cc7" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">现在让我们开始吧！</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="7f0f" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">2.获取股票价格历史数据</h1><p id="363a" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">感谢<strong class="mb jd">雅虎财经，</strong>我们可以免费获得<strong class="mb jd">的数据</strong>。使用以下链接获取谷歌过去5年的股价历史:<a class="ae mv" href="https://finance.yahoo.com/quote/GOOG/history?period1=1464998400&amp;period2=1622764800&amp;interval=1d&amp;filter=history&amp;frequency=1d&amp;includeAdjustedClose=true" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/GOOG/history?周期1=1433548800 &amp;周期2=1591833600 &amp;间隔=1d &amp;过滤器=历史&amp;频率=1d </a></p><p id="7588" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">您应该看到以下内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/3b44db676ada004f3c04370ae81ec011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJ4DeUsFDluaG8K7xZfevQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">如何下载数据。</figcaption></figure><p id="0d37" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">点击<strong class="mb jd">下载</strong>并保存<strong class="mb jd">。csv </strong>文件本地保存在您的计算机上。数据是从<strong class="mb jd"> 2016 </strong>到现在(<strong class="mb jd"> 2021 </strong>)！</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="703e" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">3.Python工作示例</h1><p id="1927" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">现在有了数据，就来考察数据，建立模型，预测股价吧！</p><p id="572b" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd"> 3.0安装python模块</strong></p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="fd47" class="ni li it pj b gy pn po l pp pq">pip install neuralprophet</span></pre><p id="72e1" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd"> 3.1。加载&amp;检查数据</strong></p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="8aa0" class="ni li it pj b gy pn po l pp pq">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span><span id="6d3f" class="ni li it pj b gy pr po l pp pq"># Load the dataset using pandas<br/>data = pd.read_csv("/Users/loukas/Downloads/GOOG.csv") <br/>data.head(5)</span></pre><p id="4b59" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">上面的代码应该打印出以下内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ps"><img src="../Images/3e84eade2ff9c1ffaf59e90103213bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UzKyLCvJ1ljFIk6_qIl7Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">数据集的前5行。</figcaption></figure><p id="1510" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">现在，让我们打印一些<strong class="mb jd">统计数据</strong>，例如上述特征(列)的平均值、中值、最小值、最大值和标准偏差值。</p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="5f41" class="ni li it pj b gy pn po l pp pq">data.describe()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pt"><img src="../Images/b777238dc6527ea272fd41150b0e832a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VRNJlpJlpJYRbPB9GUYw5w.png"/></div></div></figure><p id="83d4" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">在过去的5年里(2016-2021)，在<strong class="mb jd">收盘</strong>时<strong class="mb jd">的平均</strong>股价为1207.9美元！真的很高！</p><p id="6ece" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">现在让我们继续建模。我们将<strong class="mb jd">仅</strong>使用<strong class="mb jd">日期</strong>和<strong class="mb jd">收盘</strong>价格<strong class="mb jd">作为我们模型的特征。</strong></p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="ec05" class="ni li it pj b gy pn po l pp pq"># Select only the important features i.e. the date and price<br/>data = data[["Date","Close"]] # select Date and Price</span><span id="b4c6" class="ni li it pj b gy pr po l pp pq"># Rename the features: These names are NEEDED for the model fitting<br/>data = data.rename(columns = {"Date":"ds","Close":"y"}) #renaming the columns of the dataset</span><span id="47b4" class="ni li it pj b gy pr po l pp pq">data.head(5)</span></pre><p id="a23f" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">最后一个python命令应该返回数据集的前5行。您应该会看到类似这样的内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pu"><img src="../Images/dc7c985a72666d4a92eb5c285f09c967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VNG3nPK-4jCbBjnS1xWy3A.png"/></div></div></figure><p id="e6d9" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这里，<code class="fe pv pw px pj b">ds</code>是日期，<code class="fe pv pw px pj b">y</code>是<strong class="mb jd">谷歌</strong> <strong class="mb jd">股票</strong>价格。</p><p id="947a" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">在本教程中，我们不会将数据拆分为<strong class="mb jd">训练</strong>和<strong class="mb jd">测试</strong>集，而是使用所有数据来拟合模型，然后要求模型预测未来值，即2022年的股价。</p><p id="fecf" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">通常，人们将数据分为训练和测试，因为他们不想在测试集上训练模型。如果我们隐藏一个测试集，那么模型将会预测看不见的数据的值。在这种情况下，我们也能够测量模型的误差。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="766b" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd"> 3.2。建立预测模型(简单版)</strong></p><p id="a6c5" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">接下来，我们从<code class="fe pv pw px pj b">neuralprophet</code>模块导入<code class="fe pv pw px pj b">NeuralProphet</code>类，然后创建一个<code class="fe pv pw px pj b">NeuralProphet</code>类的对象。</p><p id="692c" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这个数据集的一个简单模型<code class="fe pv pw px pj b">neural_prophet</code>可以通过如下创建一个<code class="fe pv pw px pj b">NeuralProphet</code>类的对象并调用fit函数来拟合。这将使模型符合模型中的默认设置。有关这些默认设置的更多详情，请参考<a class="ae mv" href="https://neuralprophet.com/hyperparameter-selection/" rel="noopener ugc nofollow" target="_blank">超参数选择</a>一节。</p><p id="098b" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">为了预测GOOGLE价格，我们可以训练一个模型，使用过去2天的股票价格来预测未来3天的价格。这些参数由下面代码中的<strong class="mb jd"> n_lags </strong>和<strong class="mb jd"> n_forecasts </strong>参数指定。点击阅读更多<a class="ae mv" href="https://neuralprophet.com/model/auto-regression/" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="19e6" class="ni li it pj b gy pn po l pp pq">from neuralprophet import NeuralProphet</span><span id="e508" class="ni li it pj b gy pr po l pp pq"># m = NeuralProphet() # default model</span><span id="02c1" class="ni li it pj b gy pr po l pp pq"># our model</span><span id="10fd" class="ni li it pj b gy pr po l pp pq">m = NeuralProphet(<br/>    n_forecasts=60,<br/>    n_lags=60,<br/>    n_changepoints=50,<br/>    yearly_seasonality=True,<br/>    weekly_seasonality=False,<br/>    daily_seasonality=False,<br/>    batch_size=64,<br/>    epochs=100,<br/>    learning_rate=1.0,<br/>)</span><span id="d812" class="ni li it pj b gy pr po l pp pq">metrics = m.fit(data, freq="D") <!-- --> # fit the model using all data</span><span id="36bf" class="ni li it pj b gy pr po l pp pq"># with cross-validation<br/># metrics <!-- -->= m.fit(data, <br/>#                 freq="D",<br/>#                 valid_p=0.2, # validation proportion of data (20%)<br/>#                 epochs=100)</span></pre><p id="8277" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">要检查所有参数，请使用:</p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="0fd2" class="ni li it pj b gy pn po l pp pq">help(NeuralProphet)</span></pre><p id="9894" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">试衣可能需要3-4分钟。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="5cc4" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd"> 3.3。进行预测并绘制预测图</strong></p><p id="9f1e" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">现在，对于最后一步，我们将要求模型预测未来值，然后将预测可视化。</p><p id="1111" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">一旦模型被拟合，我们就可以使用拟合的模型进行预测。为此，我们首先需要创建一个未来数据框架，其中包含我们需要预测的未来时间步长。<code class="fe pv pw px pj b">NeuralProphet</code>为此提供了助手功能<code class="fe pv pw px pj b">make_future_dataframe</code>。</p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="6cd6" class="ni li it pj b gy pn po l pp pq"># Predictions<br/>future = m.make_future_dataframe(data, periods=60, <!-- -->n_historic_predictions<!-- -->=len(data))<!-- --> #we need to specify the number of days in future<br/>prediction<!-- --> = m.predict(future)</span><span id="016b" class="ni li it pj b gy pr po l pp pq"># Plotting<br/>forecast = m.plot(prediction)</span><span id="d4d0" class="ni li it pj b gy pr po l pp pq">plt.title("Prediction of the Google Stock Price using <!-- -->NeuralProphet <!-- -->for the next 60 days")<br/>plt.xlabel("Date")<br/>plt.ylabel("Close Stock Price")<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3628221d0468d64fe9ab8b056ac12e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNkiX6WzYsRAledP8FKisA.png"/></div></div></figure><h2 id="4666" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">该模型使用所有数据进行训练(黑点)，并预测从2021年6月到未来90天的未来股票价格。</h2><p id="c5b6" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><strong class="mb jd">侧</strong> <strong class="mb jd">注</strong>:在这种情况下，<strong class="mb jd">我们无法测量模型</strong>的误差。如果有人想这样做，那么他们应该将数据分为训练集和测试集，仅使用训练集拟合模型，预测测试集的价格，然后使用测试集的基本真实价格值来衡量误差。另请参见处的验证指南<a class="ae mv" href="https://neuralprophet.com/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="de85" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><strong class="mb jd">观察结果</strong>:2020年3月，由于新冠肺炎的封锁，股价大幅下跌，但此后又大幅增长。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h2 id="4b38" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">-我的邮件列表只需5秒:<a class="ae mv" href="https://seralouk.medium.com/subscribe" rel="noopener">https://seralouk.medium.com/subscribe</a></h2><h2 id="d38d" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">-成为会员支持我:【https://seralouk.medium.com/membership】T2</h2></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="cdc4" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">奖金</h1><p id="f2ed" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated"><strong class="mb jd"> 3.4。绘制趋势图、周图、季图、年图和日图</strong></p><p id="5e09" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">如果您想要查看预测组件，即<strong class="mb jd">趋势、每周、季节性、每年和每日组件</strong>，那么您可以使用以下命令来完成。</p><p id="5de9" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><em class="py">警告</em>:以下命令需要一段时间来显示图形。</p><pre class="ks kt ku kv gt pi pj pk pl aw pm bi"><span id="829d" class="ni li it pj b gy pn po l pp pq">m.plot_components(prediction)<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pz"><img src="../Images/43b3b86792126b5c95a43a9db6a15af2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9H5yZj94PUXU6WXKA7yjg.png"/></div></div></figure><h1 id="384c" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">结论</h1><p id="21a1" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">NeuralProphet是新脸书的Prophet更新版本，允许用户使用简单但强大的深度学习模型，如AR-Net进行预测任务。NeuralProphet的独特之处在于它能够在生成预测和拟合时将趋势、季节性和重复事件等附加信息纳入考虑。</p><p id="61a2" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">要了解更多信息，请访问<a class="ae mv" href="https://neuralprophet.com/model-overview/" rel="noopener ugc nofollow" target="_blank">这个</a>网站。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="412d" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">就这些了，伙计们！我希望你喜欢这篇文章！</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h2 id="f505" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">也可以看看我最近用LSTM模型写的文章:</h2><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/lstm-time-series-forecasting-predicting-stock-prices-using-an-lstm-model-6223e9644a2f" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">LSTM时间序列预测:使用LSTM模型预测股票价格</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我将向你展示如何使用预测LSTM模型来预测股票价格</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="qn l qo qp qq qm qr lb qd"/></div></div></a></div><h2 id="2788" class="ni li it bd lj nj nk dn ln nl nm dp lr mi nn no lt mm np nq lv mq nr ns lx iz bi translated">也可以看看我最近用ARIMA模型写的文章:</h2><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/time-series-forecasting-predicting-stock-prices-using-an-arima-model-2e3b3080bd70" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">时间序列预测:使用ARIMA模型预测股票价格</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我将向你展示如何使用预测ARIMA模型来预测特斯拉的股票价格</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="qs l qo qp qq qm qr lb qd"/></div></div></a></div></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="8779" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">参考</h1><p id="04f2" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">[1]<a class="ae mv" href="https://facebook.github.io/prophet/docs/quick_start.html#python-api" rel="noopener ugc nofollow" target="_blank">https://Facebook . github . io/prophet/docs/quick _ start . html # python-API</a></p><p id="0758" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><a class="ae mv" href="https://en.wikipedia.org/wiki/Additive_model" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Additive_model</a></p><p id="2540" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">[3]<a class="ae mv" href="https://neuralprophet.com/" rel="noopener ugc nofollow" target="_blank">https://neuralprophet.com/</a></p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="d4cf" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">敬请关注并支持这一努力</h1><p id="db8b" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">如果你喜欢这篇文章并觉得它有用，请关注我，这样你就可以看到我所有的新帖子。</p><p id="032c" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">有问题吗？把它们作为评论贴出来，我会尽快回复。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="98d4" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">和我联系</h1><ul class=""><li id="45ab" class="oj ok it mb b mc md mf mg mi qt mm qu mq qv mu oq or os ot bi translated"><strong class="mb jd">领英</strong>:<a class="ae mv" href="https://www.linkedin.com/in/serafeim-loukas/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/serafeim-loukas/</a></li><li id="2786" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated"><strong class="mb jd">推特</strong>:<a class="ae mv" href="https://twitter.com/LoukasSerafeim" rel="noopener ugc nofollow" target="_blank">https://twitter.com/LoukasSerafeim</a></li><li id="5962" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated"><strong class="mb jd">研究门</strong>:【https://www.researchgate.net/profile/Serafeim_Loukas T2】</li><li id="2a52" class="oj ok it mb b mc ou mf ov mi ow mm ox mq oy mu oq or os ot bi translated"><strong class="mb jd">栈</strong>溢出:<a class="ae mv" href="https://stackoverflow.com/users/5025009/seralouk" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/users/5025009/seralouk</a></li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="1048" class="lh li it bd lj lk pc lm ln lo pd lq lr ki pe kj lt kl pf km lv ko pg kp lx ly bi translated">最新帖子</h1><div class="qa qb gp gr qc qd"><a href="https://medium.com/@seralouk/the-best-free-data-science-resources-free-books-online-courses-9c4a2df194e5" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">最佳免费数据科学资源:免费书籍和在线课程</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">最有用的免费书籍和在线课程，适合想了解更多数据科学知识的人。</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">medium.com</p></div></div><div class="qm l"><div class="qw l qo qp qq qm qr lb qd"/></div></div></a></div><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/roc-curve-explained-using-a-covid-19-hypothetical-example-binary-multi-class-classification-bab188ea869c" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">用新冠肺炎假设的例子解释ROC曲线:二分类和多分类…</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我清楚地解释了什么是ROC曲线以及如何阅读它。我用一个新冠肺炎的例子来说明我的观点，我…</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="qx l qo qp qq qm qr lb qd"/></div></div></a></div><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/support-vector-machines-svm-clearly-explained-a-python-tutorial-for-classification-problems-29c539f3ad8" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">支持向量机(SVM)解释清楚:分类问题的python教程…</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我解释了支持向量机的核心，为什么以及如何使用它们。此外，我还展示了如何绘制支持…</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="qy l qo qp qq qm qr lb qd"/></div></div></a></div><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/pca-clearly-explained-how-when-why-to-use-it-and-feature-importance-a-guide-in-python-7c274582c37e" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">PCA清楚地解释了——如何、何时、为什么使用它以及特性的重要性:Python指南</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我解释了什么是PCA，何时以及为什么使用它，以及如何使用scikit-learn在Python中实现它。还有…</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="qz l qo qp qq qm qr lb qd"/></div></div></a></div><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">关于Python中的最小-最大规范化，您需要知道的一切</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我解释了什么是最小-最大缩放，何时使用它，以及如何使用scikit-learn在Python中实现它</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="ra l qo qp qq qm qr lb qd"/></div></div></a></div><div class="qa qb gp gr qc qd"><a href="https://towardsdatascience.com/how-and-why-to-standardize-your-data-996926c2c832" rel="noopener follow" target="_blank"><div class="qe ab fo"><div class="qf ab qg cl cj qh"><h2 class="bd jd gy z fp qi fr fs qj fu fw jc bi translated">Scikit-Learn的标准定标器如何工作</h2><div class="qk l"><h3 class="bd b gy z fp qi fr fs qj fu fw dk translated">在这篇文章中，我将解释为什么以及如何使用scikit-learn应用标准化</h3></div><div class="ql l"><p class="bd b dl z fp qi fr fs qj fu fw dk translated">towardsdatascience.com</p></div></div><div class="qm l"><div class="rb l qo qp qq qm qr lb qd"/></div></div></a></div></div></div>    
</body>
</html>