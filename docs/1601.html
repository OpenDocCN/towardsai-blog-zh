<html>
<head>
<title>How to Create a Powerful TF-IDF Keyword Research Tool in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python创建一个强大的TF-IDF关键词研究工具</h1>
<blockquote>原文：<a href="https://pub.towardsai.net/how-to-create-a-powerful-tf-idf-keyword-research-tool-in-python-f23c8265279e?source=collection_archive---------2-----------------------#2021-03-02">https://pub.towardsai.net/how-to-create-a-powerful-tf-idf-keyword-research-tool-in-python-f23c8265279e?source=collection_archive---------2-----------------------#2021-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6f64" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/programming" rel="noopener ugc nofollow" target="_blank">编程</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/0c5605aca3497e588ba9b5d2d14189c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGWJ9JEVgDgEQJJtQs2lkw.jpeg"/></div></div></figure><p id="9e65" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们正处于数字营销的时代，现在<strong class="km jd">这个词</strong>比以往任何时候都更重要。数字营销最成功的技术之一是竞争分析和关键词研究。换句话说，我们的竞争对手在谈论什么。这是最有用的搜索引擎优化，但也为博客帖子的想法等。</p><h1 id="fae5" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第一步:从网站上获取文本</h1><p id="e14b" class="pw-post-body-paragraph kk kl it km b kn mg kp kq kr mh kt ku kv mi kx ky kz mj lb lc ld mk lf lg lh im bi translated">在这一章中，我们将创建一个从URL中提取干净文本的函数，这样我们可以在以后的分析中使用它。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="7949" class="mu lj it mq b gy mv mw l mx my">import pandas as pd<br/>import numpy as np<br/>import urllib<br/>from fake_useragent import UserAgent<br/>import requests<br/>import re<br/>from urllib.request import Request, urlopen<br/>from sklearn.feature_extraction.text import TfidfVectorizer<br/>from sklearn.feature_extraction.text import CountVectorizer<br/>import math<br/>from nltk.corpus import stopwords<br/>stopWords = list(set(stopwords.words('english')))<br/>from bs4 import BeautifulSoup<br/><br/><br/><br/>def get_text(url):<br/>    try:<br/>        req = Request(url , headers={'User-Agent': 'Mozilla/5.0'})<br/>        webpage = urlopen(req,timeout=5).read()<br/>        soup = BeautifulSoup(webpage, "html.parser")<br/>        texts = soup.findAll(text=True)<br/>        res=u" ".join(t.strip() for t in texts if t.parent.name not in ['style', 'script', 'head', 'title', 'meta', '[document]'])<br/>        return(res)<br/>    except:<br/>        return False</span></pre><p id="0d89" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们来举个例子。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="58f5" class="mu lj it mq b gy mv mw l mx my">get_text('https://en.wikipedia.org/wiki/Machine_learning')[0:500]<br/>#It will return the first 500 characters<br/></span><span id="83f3" class="mu lj it mq b gy mz mw l mx my">CentralNotice Machine learning From Wikipedia, the free encyclopedia Jump to navigation Jump to search For the journal, see Machine Learning (journal) . "Statistical learning" redirects here. For statistical learning in linguistics, see statistical learning in language acquisition . Scientific study of algorithms and statistical models that computer systems use to perform tasks without explicit instructions Part of a series on Machine learning and data mining Problems Class'</span></pre><p id="75b0" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">成功！现在我们可以从网站上获得干净的文本！但是我们到底该如何使用它呢？让我们进入下一章。</p><h1 id="569a" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第二步:获取竞争对手的网址</h1><p id="f76c" class="pw-post-body-paragraph kk kl it km b kn mg kp kq kr mh kt ku kv mi kx ky kz mj lb lc ld mk lf lg lh im bi translated">找到最佳竞争对手的最好方法是在谷歌搜索中获得我们感兴趣的关键词的顶部结果。我们将使用前一篇文章中的代码，<a class="ae na" href="https://predictivehacks.com/how-to-scrape-google-results-for-free-using-python/" rel="noopener ugc nofollow" target="_blank">如何使用Python </a>免费抓取谷歌结果。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="9745" class="mu lj it mq b gy mv mw l mx my">def google_results(keyword, n_results):<br/>    query = keyword<br/>    query = urllib.parse.quote_plus(query) # Format into URL encoding<br/>    number_result = n_results<br/>    ua = UserAgent()<br/>    google_url = "https://www.google.com/search?q=" + query + "&amp;num=" + str(number_result)<br/>    response = requests.get(google_url, {"User-Agent": ua.random})<br/>    soup = BeautifulSoup(response.text, "html.parser")<br/>    result_div = soup.find_all('div', attrs = {'class': 'ZINbbc'})<br/>    results=[re.search('\/url\?q\=(.*)\&amp;sa',str(i.find('a', href = True)['href'])) for i in result_div if "url" in str(i)]<br/>    links=[i.group(1) for i in results if i != None]<br/>    return (links)</span></pre><p id="3ed0" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">比方说，我们希望看到“机器学习博客”这个关键词的“竞争对手”。让我们使用google results函数来获取排名靠前的URL，其中第一个变量是关键字，第二个变量是结果的数量。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="c939" class="mu lj it mq b gy mv mw l mx my">google_results('machine learning blog',10)</span><span id="1797" class="mu lj it mq b gy mz mw l mx my">['https://towardsai.net/p/machine-learning/best-machine-learning-blogs-6730ea2df3bd', 'https://machinelearningmastery.com/blog/', 'https://towardsdatascience.com/how-to-start-a-machine-learning-blog-in-a-month-7eaf84692df9', 'http://ai.googleblog.com/', 'https://www.springboard.com/blog/machine-learning-blog/', 'https://blog.ml.cmu.edu/', 'https://blog.feedspot.com/machine_learning_blogs/', 'https://aws.amazon.com/blogs/machine-learning/', 'https://neptune.ai/blog/the-best-regularly-updated-machine-learning-blogs-or-resources', 'https://www.stxnext.com/blog/best-machine-learning-blogs-resources/']</span></pre><h1 id="cf6c" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第三步:分析课文，找出最重要的单词。</h1><p id="2404" class="pw-post-body-paragraph kk kl it km b kn mg kp kq kr mh kt ku kv mi kx ky kz mj lb lc ld mk lf lg lh im bi translated">让我们想想。最重要的词是什么？在我们的分析中，我们将使用3个指标。<strong class="km jd">平均TF-IDF、最大TF-IDF </strong>和<strong class="km jd">频率。</strong>管道如下。我们将获得每个网站的文本(在我们的例子中是前12个结果),并将它们用作TF-IDF矢量器的语料库。然后从这个矩阵中，我们将得到每个单词的平均和最大TF-IDF分数。然后，我们可以很容易地从TF-IDF矩阵中获得频率，方法是说如果这个词在这一行中不等于零，它就包含在URL中，我们正在计算它的百分比。完整的函数如下。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="c5c0" class="mu lj it mq b gy mv mw l mx my">def tf_idf_analysis(keyword):<br/>    links=google_results(keyword,12)<br/>    text=[]<br/>    for i in links:<br/>        t=get_text(i)<br/>        if t:<br/>            text.append(t)<br/>            <br/>    v = TfidfVectorizer(min_df=2,analyzer='word',ngram_range=(1,2),stop_words=stopWords)<br/>    x = v.fit_transform(text)<br/><br/>    f = pd.DataFrame(x.toarray(), columns = v.get_feature_names())<br/>    d=pd.concat([pd.DataFrame(f.mean(axis=0)),pd.DataFrame(f.max(axis=0))],axis=1)<br/>    <br/>    <br/>    tf=pd.DataFrame((f&gt;0).sum(axis=0))<br/><br/><br/>    d=d.reset_index().merge(tf.reset_index(),on='index',how='left')<br/><br/>    d.columns=['word','average_tfidf','max_tfidf','frequency']<br/><br/>#you can comment the following part if you want the number of URLs #that the word occurs. The percentage makes sense<br/>#when we have a lot of URLs to check<br/><br/>    d['frequency']=round((d['frequency']/len(text))*100)<br/><br/>    return(d)</span></pre><p id="e01f" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">现在我们的最终函数已经准备好了，让我们通过使用<strong class="km jd">机器学习博客</strong>关键字来看看我们在机器学习方面的竞争对手。</p><figure class="ml mm mn mo gt kd gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/0586950f38efcea9ebbe04b06efd9046.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/0*pwr-AnCQ1__JvMew.gif"/></div></figure><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="dd17" class="mu lj it mq b gy mv mw l mx my">x= tf_idf_analysis('machine learning blog')<br/><br/>#remove the numbers and sort by max tfidf and get the top20 words<br/>x[x['word'].str.isalpha()].sort_values('max_tfidf',ascending=False).head(20)</span><span id="2109" class="mu lj it mq b gy mz mw l mx my">word  average_tfidf  max_tfidf  frequency<br/>929      google       0.098790   0.626160       67.0<br/>254         aws       0.052512   0.550785       25.0<br/>171      amazon       0.060131   0.537993       33.0<br/>1472      model       0.058276   0.521179       33.0<br/>307        blog       0.131429   0.385008      100.0<br/>133          ai       0.109516   0.358522       83.0<br/>1222   learning       0.191090   0.352528      100.0<br/>717         end       0.036682   0.304649       58.0<br/>1332    machine       0.158022   0.295191      100.0<br/>525     cookies       0.023013   0.263509       17.0<br/>1980        see       0.030134   0.255031       58.0<br/>439         cmu       0.028235   0.253162       17.0<br/>2242    towards       0.035054   0.245614       42.0<br/>862   followers       0.022837   0.245576       17.0<br/>1949    science       0.057179   0.240060       58.0<br/>670      domain       0.021410   0.236214       25.0<br/>739       entry       0.022586   0.233097       17.0<br/>944    gradient       0.019838   0.233097       17.0<br/>377    brownlee       0.021105   0.226498       25.0<br/>537     courses       0.024935   0.218224       25.0</span></pre><p id="e2e4" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我们可以看到，其中一个热门词汇是亚马逊AWS。嗯，也许我们也应该写点什么😉。这可能是数字营销的一个强大工具，有许多付费服务正在这样做。所以开始尝试吧！</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="02aa" class="pw-post-body-paragraph kk kl it km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><em class="nj">原载于</em><a class="ae na" href="https://predictivehacks.com/how-to-create-a-powerful-tf-idf-keyword-research-tool/" rel="noopener ugc nofollow" target="_blank"><em class="nj">https://predictivehacks.com</em></a><em class="nj">。</em></p></div></div>    
</body>
</html>